{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/core/alphabet.js","webpack:///./src/calc/formulajs/lib/utils.js","webpack:///./src/calc/RawValue.js","webpack:///./src/calc/exec_formula.js","webpack:///./src/calc/expression_builder.js","webpack:///./src/calc/Exp.js","webpack:///./src/calc/UserFnExecutor.js","webpack:///./src/calc/UserRawFnExecutor.js","webpack:///./src/calc/formulajs/lib/compatibility.js","webpack:///./src/core/helper.js","webpack:///./src/calc/formulajs/lib/math-trig.js","webpack:///./src/calc/formulajs/lib/expression.js","webpack:///./src/calc/formulajs/lib/database.js","webpack:///./src/calc/formulajs/lib/logical.js","webpack:///./src/calc/formulajs/lib/financial.js","webpack:///./src/calc/formulajs/lib/lookup-reference.js","webpack:///./src/calc/formulajs/lib/custom.js","webpack:///./src/calc/formulas-raw.js","webpack:///./src/calc/Calculator.js","webpack:///./src/calc/CalcCell.js","webpack:///./src/calc/formulajs/lib/statistical.js","webpack:///./src/calc/CalcWorkBook.js","webpack:///./src/calc/index.js","webpack:///./src/calc/utils.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/calc/int_2_col_str.js","webpack:///./src/component/element.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/formula.js","webpack:///./src/core/cell_range.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/recast.js","webpack:///./src/core/paste_proxy.js","webpack:///./src/core/cell_proxy.js","webpack:///./src/model/cell_prop.js","webpack:///./src/model/cell.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/event/move.js","webpack:///./src/component/event.js","webpack:///./src/config.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector_cell.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/suggest_content.js","webpack:///./src/component/selector_move.js","webpack:///./src/component/selector_copy.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/formula_editor.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/utils/number_util.js","webpack:///./src/canvas/draw.js","webpack:///./src/utils/test.js","webpack:///./src/component/table.js","webpack:///./src/component/editor_text.js","webpack:///./src/component/editor.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/core/format.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/history_border.js","webpack:///./src/component/dropdown_action.js","webpack:///./src/component/toolbar.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/button.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/advice.js","webpack:///./src/event/copy.js","webpack:///./src/component/website.js","webpack:///./src/core/special_formula_process.js","webpack:///./src/component/error_pop_up.js","webpack:///./src/core/rect_proxy.js","webpack:///./src/model/Timer.js","webpack:///./src/model/pre_action.js","webpack:///./src/component/sheet.js","webpack:///./src/external/drag.js","webpack:///./src/external/resize.js","webpack:///./src/core/table_proxy.js","webpack:///./src/event/paste.js","webpack:///./src/utils/date.js","webpack:///./src/core/multi_pre_action.js","webpack:///./src/model/paint_format.js","webpack:///./src/core/data_proxy.js","webpack:///./src/locale/zh-cn.js","webpack:///./src/log/log_proxy.js","webpack:///./src/log/debugout.js","webpack:///./src/index.js","webpack:///./src/calc/col_str_2_int.js","webpack:///./src/calc/Range.js","webpack:///./src/calc/formulajs/lib/text.js","webpack:///./src/calc/formulajs/lib/information.js","webpack:///./src/calc/formulajs/lib/date-time.js","webpack:///./src/calc/getSanitizedSheetName.js","webpack:///./src/calc/str_2_val.js","webpack:///./src/calc/RefValue.js","webpack:///./src/calc/formulajs/index.js","webpack:///./src/calc/formulajs/lib/miscellaneous.js","webpack:///./src/calc/formulajs/lib/engineering.js","webpack:///./src/calc/find_all_cells_with_formulas.js","webpack:///./src/calc/formula_check.js","webpack:///./src/calc/formulajs/lib/error.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","alphabets","stringAt","index","str","cindex","parseInt","last","indexAt","ret","charCodeAt","exponet","expr2xy","src","x","y","charAt","xy2expr","ab","error","require","flattenShallow","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","isFlat","parse","Error","arr","flatten","argsToArray","arguments","args","numbers","possibleNumbers","filter","el","flattenNum","div0","undefined","cleanFloat","number","Math","round","parseBool","bool","up","toUpperCase","Date","isNaN","parseNumber","string","parseFloat","parseNumberArray","len","parsed","parseMatrix","matrix","pnarr","d1900","parse_arg","arg","replace","parseDate","date","num","getTime","Copy","obj","copy","setTime","clone","attr","strToMatrix","split","toString","indexOf","ExcelDateToJSDate","utils","issue","isNumber","val","test","parseDateArray","this","anyIsError","arrayValuesToNumbers","rest","idx","initial","setValue","v","calc","expression_builder","xlsx_Fx","xlsx_raw_Fx","import_raw_functions","functions","opts","import_functions","formulajs","prefix","override","my_assign","dest","source","JSON","stringify","k","build_expression","formula","exec_formula","update_cell_value","set_fx","fn","exec_fx","localizeFunctions","dic","newName","oldName","Exp","RawValue","UserFnExecutor","UserRawFnExecutor","common_operations","status","root_exp","str_formula","cell","f","substr","exp_obj","buffer","was_string","fn_stack","exp","char","state","start","single_quote","stack","trim_buffer","trim","special","special_raw","sheet_name","ini_parentheses","pop","position_i","Range","str_2_val","MS_PER_DAY","exp_id","last_arg","self","isEmpty","checkVariable","exec","op","as","e","id","errorValues","message","w","sheet","str_expression","datedifference","exec_minus","pow","toLowerCase","user_function","map","mathTrig","statistical","engineering","dateTime","set","root","BETADIST","BETA","DIST","BETAINV","INV","BINOMDIST","BINOM","CEILING","ISOCEILING","MATH","CEILINGMATH","CEILINGPRECISE","PRECISE","CHIDIST","CHISQ","CHIDISTRT","RT","CHIINV","CHIINVRT","CHITEST","TEST","CONFIDENCE","NORM","COVAR","COVARIANCE","P","COVARIANCEP","COVARIANCES","S","CRITBINOM","EXPONDIST","EXPON","ERFCPRECISE","ERFC","ERFPRECISE","ERF","FDIST","F","FDISTRT","FINVRT","FINV","FLOORMATH","FLOORPRECISE","FLOORPRACE","FTEST","GAMMADIST","GAMMA","GAMMAINV","GAMMALNPRECISE","GAMMALN","HYPGEOMDIST","HYPGEOM","LOGINV","LOGNORM","LOGNORMINV","LOGNORMDIST","MODE","SNGL","MODEMULT","MULT","MODESNGL","NEGBINOMDIST","NEGBINOM","NETWORKDAYSINTL","NORMDIST","NORMINV","NORMSDIST","NORMSINV","PERCENTILE","EXC","PERCENTILEEXC","PERCENTILEINC","INC","PERCENTRANK","PERCENTRANKEXC","PERCENTRANKINC","POISSON","POISSONDIST","QUARTILE","QUARTILEEXC","QUARTILEINC","RANK","EQ","RANKAVG","AVG","RANKEQ","SKEWP","SKEW","STDEV","STDEVP","STDEVS","TDIST","T","TDISTRT","TINV","TTEST","VARP","VAR","VARS","WEIBULL","WEIBULLDIST","WORKDAYINTL","ZTEST","Z","_XLFN","FLOOR","mergeDeep","sources","forEach","keys","find","isOusideViewRange","dy","dx","orien","isHave","param","inputData","cloneDeep","merge","equals","obj1","obj2","v1","v2","ai","arrayEquals","a1","a2","sum","objOrAry","cb","total","size","rangeSum","min","max","getv","rangeReduceIf","inits","initv","ifv","numeric","information","ABS","abs","ACOS","acos","ACOSH","log","sqrt","ACOT","atan","ACOTH","AGGREGATE","function_num","options","ref1","ref2","AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","SUM","MEDIAN","LARGE","SMALL","ARABIC","text","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","join","significance","precision","floor","ROUND","ceil","COMBIN","number_chosen","FACT","COMBINA","COS","cos","COSH","COT","tan","COTH","e2","CSC","sin","CSCH","DECIMAL","DEGREES","PI","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","places","GCD","range","r0","ri","INT","ISO","LCM","LN","LOG","base","LOG10","MDETERM","det","MINVERSE","inv","MMULT","matrix1","matrix2","console","dot","MOD","dividend","divisor","modulus","MROUND","multiple","MULTINOMIAL","MUNIT","dimension","identity","ODD","temp","POWER","power","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","top","ROMAN","digits","String","roman","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","function_code","ADD","num1","num2","na","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","value1","value2","NE","POW","exponent","argsKeys","elt","SUMIF","criteria","eval","SUMIFS","s_arr","compareValue","lastIndexOf","resultArr","enter","SUMPRODUCT","product","_i","_ij","arrays","SUMSQ","ISNUMBER","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","defaultOperator","validSymbols","TOKEN_TYPE_OPERATOR","TOKEN_TYPE_LITERAL","SUPPORTED_TOKENS","createToken","type","analyzeTokens","tokens","literalValue","analyzedTokens","token","unshift","expression","expressionLength","cursorIndex","processedValue","processedSymbol","tokenizeExpression","compute","operator","values","evaluate","stats","maths","compact","find_result_idx","database","valid_arr","filter_arr","valid_str","result_idx","is_valid","get_values","resultIndexes","field","field_idx","FINDFIELD","title","DAVERAGE","targetValues","DCOUNT","DCOUNTA","DGET","DMAX","DMIN","DPRODUCT","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","AND","CHOOSE","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","ISERROR","IFNA","value_if_na","NOT","logical","OR","TRUE","XOR","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","validDate","ACCRINT","first","settlement","rate","par","frequency","basis","YEARFRAC","ACCRINTM","AMORDEGRC","cost","date_purchased","first_period","salvage","period","AMORLINC","COUPDAYBS","maturity","COUPDAYS","COUPDAYSNC","COUPNCD","numerror","COUPNUM","COUPPCD","CUMIPMT","periods","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","life","month","toFixed","current","ceiling","DDB","factor","DISC","pr","redemption","DAYS","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","coupon","yld","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","investment","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","negative","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","den","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","day","discount","PRICEDISC","PRICEMAT","dsm","PV","RATE","iter","close","t1","t2","Number","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","DAYS360","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","match_less_than_or_equal","lookupValue","indexValue","match_exactly_string","match_exactly_non_string","match_greater_than_or_equal","MATCH","matchType","VLOOKUP","return_index","cumulative","HLOOKUP","needle","table","exactmatch","row","City","url","PQUERY","absArr","o1","sort","val1","val2","items","count","a4","city","area","HYPERLINK","lianjia","lianJiaUrl","woaiwojia","woaiwojiaUrl","fangtianxia","fangtianxiaUrl","int_2_col_str","col_str_2_int","RefValue","cell_ref","rows","columns","height","width","ref_value","parsed_ref","parseRef","col","cell_name","col_str","end_range","onerrorvalue","Infinity","condition","_then","_else","find_all_cells_with_formulas","Calculator","workbook","expressions","variables","formulas","calcNames","var_name","variable","setVarOfExpression","vars","Workbook","Names","item","getRef","Ref","Name","ref_name","formula_ref","wb","checker","CalcCell","formulas_i","match","fml","reg","RegExp","rep","strim","trans_formula","trans_params","jStat","misc","evalExpression","AVEDEV","subtract","mean","AVERAGEA","AVERAGEIF","average_range","average_count","isWildcard","tokenizedCriteria","filter_criteria","AVERAGEIFS","criteriaLength","isMeetCondition","computedResult","average","alpha","beta","A","B","cdf","pdf","probability","successes","trials","binomial","chisquare","observed","expected","tmp","dof","xsqr","Pi","ChiSq","COLUMN","col_list","COLUMNS","cols","sd","normalci","tci","IFS","cond","CORREL","array1","array2","corrcoeff","COUNTBLANK","COUNTIN","element","blanks","COUNTIF","matches","COUNTIFS","results","COUNTUNIQUE","UNIQUE","mean1","mean2","covariance","DEVSQ","lambda","exponential","d1","d2","centralF","sumOfSquares","x1","x2","FISHER","FISHERINV","e2y","FORECAST","data_y","data_x","xmean","ymean","FREQUENCY","bins","gammafn","gamma","gammaln","GAUSS","z","normal","GEOMEAN","geomean","GROWTH","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","HARMEAN","N","INTERCEPT","KURT","sigma","stdev","LINEST","LOGEST","lognormal","MAXA","arr2","median","MINA","currentItem","maxItems","negbin","PEARSON","den1","den2","fl","uniques","PERMUT","PERMUTATIONA","PHI","poisson","PROB","lower","upper","sorted","quart","order","ROW","ROWS","RSQ","m2","m3","SLOPE","STANDARDIZE","STDEVA","VARA","STDEVPA","VARPA","STEYX","lft","TRANSPOSE","transpose","df","studentt","mean_x","mean_y","s_x","s_y","TREND","new_data_x","linest","TRIMMEAN","percent","CalcWorkBook","tileArr","need_calc_cells","findAllNeedCalcCell","zb","getCell","Sheets","multivalueRefsCell","source_v","setCell","cell_v","cell_zb","cell_x","cell_y","expr","clean_matrix","ref","clean_all_flag","process_arr","process_matrix","find_all_need_calc_cell","helper","mymodule","Calc_WorkBook","get_workbook","calc_cell","valid_res","check_valid","trans_sheet","recover_formula","recover_sheet","is_muti_cell","deal_muti_cell","calcDoneToSetCells","calculator","XLSX_CALC","Rows2Workbook","cells","_","ci","webpackContext","req","webpackContextResolve","code","resolve","modulo","columnName","guard","fromCharCode","Element","tag","className","document","createElement","eventNames","handler","fen","oen","eventName","navigator","userAgent","addEventListener","evt","button","stopPropagation","css","offsetTop","left","offsetLeft","offsetHeight","offsetWidth","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","childNodes","ele","child","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","removeChild","getComputedStyle","h","$lang","$messages","en","toolbar","undo","redo","paintformat","clearformat","format","font","fontSize","fontBold","fontItalic","underline","strike","textColor","fillColor","border","align","valign","textwrap","freeze","autofilter","more","flexible","throwFormula","comeBack","contextmenu","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteRow","deleteColumn","deleteCell","deleteCellText","validation","recover","rmb","usd","time","datetime","duration","date_formula","wland","wfr","rtd","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","pasteForMergedCell","calendar","weeks","months","cancel","save","ok","desc","asc","empty","dataValidation","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","spreadsheet","tf","locale","lang","baseFormulas","render","ary","deepCopy","formulaCalc","formulam","CellRange","sri","sci","eri","eci","refs","rowFilter","other","pos","addRet","dsr","dsc","der","dec","sarr","darr","each","Selector","Scroll","Clipboard","cellRange","Filter","includes","Sort","AutoFilter","filters","flex","fitlers","it","getData","getFilter","hrange","exceptRowSet","rir","ix","set_total","cic","rset","Set","fset","ctext","valueOf","Merges","cr","within","intersects","union","deleteWithin","cbWithin","rn","cn","it1","merges","recast","Recast","ast","preProcess","PasteProxy","srcCellRange","dstCellRange","srcOneDRange","dstOneDRange","dsri","dsci","deri","deci","drn","dcn","use","isLeftRight","isDown","getRangeByWay","line","way","offset","isAdd","diffValue","last2","CellProxy","nrindex","cellText","formatInfo","tryParseToNum","isDate","ncell","nA","isFormula","search","str2Re","datePattern2","CellProp","depend","Cell","formatText","calcUtils","otherAutoFilter","direction","what","dri","getCellByTopCell","iText","calcFormulaCellByTopCell","calcCellByTopCell","numberAutoFilter","calcNumberCellByTopCell","dateAutoFilter","diff","calcDateCellByTopCell","Rows","pasteProxy","getOrNew","exceptSet","has","getHeight","sumHeight","isSheetVale","_cell","to_calc_num","getDependCell","setFormatText","cutStr","mergeCellExpr","mergeArr","distinct","refCell","isAbsoluteValue","e1","getCellOrNew","arr3","s1","changeFormula","ca","setCellAll","value2absolute","es","s3","s2","re","cellStyle","isValid","isInsert","ds","dei","dci","isRows","cellProp","bad","newStr","getCellTextIsAdd","ds1","ds2","sp","und","getCellDataType","last1","formatMoney","copyRender","strList","splitStr","getRangeByTopCell","getCellTextByShift","updateCellReferenceByShift","word","dayjs","getCellByCell","setSrcAndDstCellRange","autoFilterDirection","upOrDown","getOneDRangeObj","getAllDataType","getLocationArray","leftOrRight","calcDiff","nri","nci","srcCell","eachCells","ndata","rndata","entries","isReferOtherSheet","out","rowsInit","init","change","timeEnd","assign","Cols","indexWidth","minWidth","getWidth","sumWidth","rules","returnMessage","Validator","parseValue","Validation","validator","nrefs","difference","Validations","errors","Map","validate","getByValidator","addRef","Moved","removeEvent","target","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","createEvent","keyCode","metaKey","buttons","event","initEvent","eventType","dispatchEvent","bindClickoutside","detail","hide","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","cssPrefix","look","Resizer","vertical","minDistance","moving","children","hoverEl","on","mousedownHandler","lineEl","cRect","finishedFn","rect","show","startEvt","distance","movementX","movementY","Scrollbar","moveFn","contentEl","scroll","contentDistance","cssKey","SelectorCell","getRect","setOffset","includeByRiCi","setData","selectorHeightBorderWidth","startZIndex","SelectorElement","selector","cornerEl","_selector","moveEvent","clickCopyPaste","boxinner","areaEl","clipboardEl","autofillEl","setTimeout","_cellRange","selectorMoveEl","container","setBoxinner","getCellRectByXY","layerX","layerY","move","getMoveRect","setMove","movedCell","movedCell2","cutPaste","indexes","moveIndexes","selectCell","moveChange","selectorMoveReset","pointer","calBRAreaOffset","ftwidth","freezeTotalWidth","ftheight","freezeTotalHeight","left0","top0","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","sc","areaOffset","arange","lastri","lastci","longTimeBefore","setCss","resetSelectOffset","freezeHeight","freezeWidth","getSelectedRect","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","cri","cci","setIndexes","resetAreaOffset","calSelectedRangeByEnd","setEnd","drisc","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","preventDefault","filterItems","itemIndex","scrollHeight","inputMoveNext","inputEnter","click","inputKeydownHandler","ctrlKey","Suggest","itemClick","editor","cssRemoveKeys","parent","startsWith","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","prev","next","week","selectChange","buildHeaderLeft","buildBody","getFullYear","trs","year","cdate","startDate","datess","disabled","getDate","monthDays","tds","Datepicker","calendarPattern","variableElement","txt","ct","SuggestContent","helpFormula","exampleName","example","item2","cha","SelectorMove","dict","timer","_move_selectors","selectors","msri","msci","meri","meci","clearTimeout","inputText","editorText","getText","_erpx","cuttingByPos","cuttingByPosEnd","erpx","setCursorPos","move2","color","lockCells","selectorMove","SelectorCopy","srn","ern","ecn","themeColorPlaceHolders","themeColors","selectColors","selectorColor","standardColors","buildTd","bgcolor","ColorPalette","isAb","offsetX","offsetY","cellRect","mousedownIndex","es1","es2","isCors","substring","setText","operation","setLock","makeSelector","judgeText","cutFirst","setMouseDownIndex","filterSelectors","selectors_delete","selectors_new","removeEl","div2span","cutting","cutting2","i2","mergeSelector","index2","selectorsEl","clearSelectors","editingSelectors","selectors_valid","enterCode","notTrueValue","prx","lax","prx_index","lax_index","findBracketLeft","begin","stop","findBracketRight","suggestContent","right","cutcolor","spanArr","spanEl","mount2span","baseFonts","fontSizes","pt","px","getFontSizePxByPt","evalFormula","rule","sheetbook","formulaMap","getCellText","isMinus","dpr","devicePixelRatio","thinLineWidth","npx","npxLine","drawFlexFalse","ctx","sx","sy","beginPath","fillStyle","moveTo","lineTo","stroke","strokeRect","clip","fill","restore","drawFlexTrue","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","getContext","resize","scale","cxc","indent","vIndent","canvasContext","clearRect","fillRect","fillText","box","textLine","innerWidth","selfAdaptionOneTxtWidth","italic","bold","measureText","textWrap","ignore","textx","textAlign","textBaseline","strokeStyle","txtWidth","selfAdaptionTxtWidth","selfAdaptionHeight","texty","lineWidth","setLineDash","y1","topxys","rightxys","bottomxys","leftxys","closePath","dtextcb","testValid","valid","assert","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","getChangeDataToCalc","changeData","changeDataForCalc","parseCell","renderCell","draw","sortedRowMap","getCellStyleOrDefault","dbox","setBorders","strokeBorders","showEquation","rect2","renderFormat","settings","minus","specialStyle","validations","getError","renderFlexible","autoFilter","s_t","dropUp","renderAutofilter","viewRange","afRange","dropdown","renderContent","fw","fh","filteredTranslateFunc","eachMergesInView","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","rowHeight","ii","colEach","colWidth","renderFixedLeftTopCell","renderContentGrid","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","viewWidth","theight","viewHeight","Table","autoAdaptList","getCellTextOrDefault","clear","fri","fci","vr","freezeViewRange","EditorText","oldCell","getOldCell","cuttingByPosEnd2","text_b","resetTextareaSize","textlineEl","textEl","tlineWidth","maxWidth","viewFn","h1","getCursortPosition","getSelection","rangeCount","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","startContainer","startOffset","exist","findBracket","spanLeft","spanRight","suggest","set_focus","savedSel","charIndex","createRange","setStart","collapse","node","nodeStack","foundStart","nodeType","nextCharIndex","sel","removeAllRanges","addRange","mouseDownEventHandler","parse2","setOldCell","isDisplay","inputEventHandler","inputType","chinese","showEditor","innerText","nodeValue","changed","changeText","cutValue","cuttingByPos2","keyDownEventHandler","which","opacity","setTextareaRange","blur","suggestItemClick","resetSuggestContentItems","resetSuggestItems","setItems","Editor","rowWidth","display","lock","datepicker","dateFormat","setCellEnd","getSelectedCellRiCi","currentTarget","key_num","f4ShortcutKey","bindInputEvents","clp","originalEvent","clipboardData","newNode","insertNode","selection","pasteHTML","execCommand","textFormat","off","focus","setRiCi","insertBefore","suggestPosition","elOffset","sOffset","menuItems","buildMenuItem","buildMenu","ContextMenu","isHide","menus","view","Dropdown","showArrow","placement","arrowChange","historyBorder","headerEl","DropdownFont","nfonts","setTitle","DropdownFontSize","nfontSizes","formatStringRender","formatNumberRender","fixed","baseFormats","multiply","a_s","toInteger","floatNum","times","isNegative","strfi","dotPos","intNum","o2","n1","n2","formatm","DropdownFormat","nformats","DropdownFormula","nformulas","DropdownColor","iconName","icon","colorPalette","DropdownAlign","aligns","naligns","setName","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","HistoryBorder","history","els","action","DropdownAction","buildButton","tooltipdata","elBox","tooltip","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","undoEl","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","widthFn","btns","moreEl","ddMore","sumWidth2","list1","list2","Toolbar","defaultStyle","redoEl","paintformatEl","clearformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","freezeEl","addEl","closeEl","autofilterEl","throwFormulaEl","reset","getSelectedCellStyle","getSelectedCell","canUndo","canRedo","canUnmerge","canAutofilter","equationIsActive","freezeIsActive","Modal","open","dimmer","documentElement","clientHeight","clientWidth","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","labelWidth","tip","pattern","Button","fieldLabelWidth","ModalValidation","mf","rf","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","attrs","isShow","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","cnt","filterClick","resetFilterHeader","filterhEl","checked","SortFilter","tindex","sortAscEl","sortDescEl","sortDesc","from","findIndex","xtoast","Advice","saveCheck","textCheck","setCellRange","reference","tableProxy","sheetReset","mountCopy","choose","getChooseImg","parseDom","img2","sheetCopy","plain","pasteDirectionsArr","styles","tbody","tr","td","hidden","tmpNode","cloneNode","Website","tableEl","timer2","isDisplay2","td2","td3","td4","td5","isSpecialWebsite","screenX","screenY","ErrorPopUp","RectProxy","ex","ey","clientX","clientY","positionAngle","Timer","clearInterval","getCellDepend","PreAction","oldData","newData","oldStep","newCell","newMergesData","oldMergesData","changeArr","isRedo","setCellText","_data","_cells","setHeight","setWidth","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","fsw","fsh","selectorSet","render_timer","editorSetOffset","overlayerMousemove","rowResizer","colResizer","website","tRect","overlayerMousescroll","autoLoad","delta","deltaY","overlayerTouch","verticalScrollbarSet","totalHeight","horizontalScrollbarSet","totalWidth","sheetFreeze","fwidth","fheight","setFreezeLengths","overlayerEl","overlayerCEl","tOffset","vRect","renderAutoAdapt","autoRowResizer","toolbarChangeSelectorCell","clearClipboard","msg","toolbarChangePaintformatPaste","paintformatActive","paintFormatChange","paintformatToggle","dropDown","isAutofillEl","dstRect","getCellRectByXYWithNotTotalResult","dropGetPos","rpos","continueMove","shiftKey","getMovePos","selectorBeyondMove","rectProxy","isLocInside","getUpDownLeftRight","scrollTo","overlayerMousedown","sortFilter","advice","hideDirectionArr","includes2","getSet","getSort","point","offsetParent","getPoint","clearStopTimer","continueDropDown","autofill","autofillNext","stopTimer","stopTimer2","setInterval","loadFormula","firstRowToWidth","colResizerFinished","adviceSetOffset","pictureSetOffset","pictureOffsetLeft","pictureOffsetTop","img","sPosition","selectorsSetOffset","resetSelectorBRLAreaOffset","hasEditor","editorSet","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","viewRange2","autoAdapt","ignoreRi","getCellTextContent","getCellTextStyle","_ignore","cellWidth","record_rc","r_h","record_h","c_h","clickSelectorChangeRiCi","rowResizerFinished","setRowHeight","setColWidth","errorPop","errorPopUp","selectorCellText","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","insert","toolbarChange","setContent","historyList","getMax","mri","mci","eachRange","showFreeze","setSelectedCellAttr","borderResSet","sortFilterChange","setAutoFilter","afterSelector","getLock","pasteEvent","mountPaste","sheetInitEvents","startx","starty","contextMenu","modalValidation","xyInSelectedRect","setPosition","touches","pageX","pageY","changedTouches","itext","editorChangeToHistory","getRICI","setSelectedCell","addValidation","removeValidation","getSelectedValidation","reload","addPic","pictures","deleteImg","trigger","Sheet","targetEl","showToolbar","showContextmenu","recalc","clickAutofill","styleBool","setFreeze","Drag","register","onBegin","cursor","nl","nt","onmousemove","nx","ny","onDrag","onmouseup","onEnd","Resize","directionsArr","directions","div","onResize","querySelector","onmousedown","ox","oy","ow","oh","ol","ot","isResize","fun","mappers","ee","setLeft","setTop","se","nw","ws","ne","TableProxy","fontWeight","background","tableDom","colLen","defaultView","isHaveStyle","maxRi","maxCi","rii","cij","resizeOption","dragOption","lastCi","lastRi","spanDomPackage","spanDom","textArr","process","styleDom","GetInfoFromTable","cbd","kind","getAsString","textDom","imgDom","getElementsByTagName","mountImg","getAsFile","reader","FileReader","onload","readAsDataURL","getMaxCoord","nextLeft","nextTop","image","Image","containerHandlerEvent","direction_new","direction_delete","newX","tableObj","extend","dealColSpan","dealStyle","dealReference","parseTableCellRange","formatDate","calcDecimals","beginDate","beginDate2","second","fix","dateDiff","datePattern","operationItem","preAction","undoItems","redoItems","MultiPreAction","expr1","expr2","does","getItems","actionItems","actionType","PaintFormat","selectorRange","dstRange","dType","sType","getType","pArr","recordRi","rowIndex","_darr","changeDarrToDoubleArr","defaultSettings","canPaste","dst","scn","copyPaste","deleteCells","cleard","clipboard","setStyleBorder","bss","cstyle","addStyle","event_type","description","isLegal","processPasteDirectionsArr","newItem","clickCopyPasteHelp","lci","lri","lcell","setStyleBorders","isSignleSelected","mergeIndexes","mrl","mcl","getCellMerge","getCellRowByY","scrollOffsety","frset","getCellColByX","scrollOffsetx","makeFormatCell","symbol","position","cText","getCellStyle","getCellStyleConvert","changeFormat","useOne","DataProxy","methods","hyperlinks","comments","multiPreAction","moved","unsortedRowMap","cell2","cell3","makeCellPropArr","setCellByCellProp","paintFormat","paintType","getPaintType","makePaintArr","srcRange","getFirstIncludes","unmerge","nfont","resetAutoFilter","getStepType","oc","nc","addStep","isClear","autoFilterRef","addFilter","setSort","filteredRows","fary","oldAry","si","rsize","csize","filterIntersects","frary","nstyle","lastStep","changeToHistory","addFiexRows","revision","bugout","realTimeLoggingOn","useTimestamps","useLocalStorage","recordLogs","autoTrim","maxLines","tailNumLines","logFilename","depth","parentSizes","currentResult","startTime","output","version","getLog","retrievalTime","saved","localStorage","getItem","lastLog","formatSessionDuration","tail","numLines","tailLines","trimLog","lines","rgx","matched","addr","getSlice","lineNumber","downloadLog","file","logFile","encodeURIComponent","href","download","clearTime","saveObject","setItem","determineType","addition","logTime","formatTimestamp","typeResult","formatType","objectSize","prop","indentsForDepth","subtype","subresult","endTime","msec","hh","hrs","mm","mins","ss","timestamp","getHours","getMinutes","getSeconds","Spreadsheet","alias","zhCN","rootEl","loadData","getCellByExpr","jsSpreadsheet","drag","colstr","getSanitizedSheetName","possition_i","range_expression","start_pst","end_pst","aux","range_start_pst","max_row","min_row","str_max_row","min_col","max_col","cell_full_name","numeral","num2e","allzero","decimalsToFractional","decimals","formatDecimals","recursion","isInteger","ASC","BAHTTEXT","CHAR","CLEAN","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","EXACT","text1","text2","FIND","find_text","within_text","FIXED","no_commas","HTML2TEXT","INDEX","row_num","column_num","LEFT","LEN","LOWER","MID","NUMBERVALUE","decimal_separator","group_separator","PRONETIC","PROPER","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","REPT","RIGHT","SEARCH","foundAt","SPLIT","separator","SUBSTITUTE","old_text","occurrence","TEXT","Formulas","AllFormulas","fmt","TRIM","UNICHAR","UNICODE","UPPER","VALUE","unformat","CELL","ERROR","TYPE","error_val","nil","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISODD","ISREF","ISTEXT","NA","SHEET","SHEETS","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","isLeapYear","daysBetween","start_date","end_date","serial","DATE","DATEVALUE","date_text","DAY","serial_number","method","ed","sm","em","smd","emd","EDATE","EOMONTH","HOUR","INTERVAL","hour","sec","ISOWEEKNUM","setHours","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","weekend","NETWORKDAYS$INTL","days","getTimezoneOffset","getUTCDay","holiday","INTL","NOW","SECOND","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","week_start","jan","inc","WORKDAY","YEAR","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","quotedMatch","resolved_ref","ref_cell","categories","category","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","path","opening","JOIN","NUMBERS","NUMERAL","bessel","isValidBinaryNumber","trans_num","inumber","BESSELI","besseli","BESSELJ","besselj","BESSELK","besselk","BESSELY","bessely","BIN2DEC","stringified","BIN2HEX","BIN2OCT","BITAND","number1","number2","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","Y","E","G","u","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","lower_bound","upper_bound","erf","erfc","GESTEP","HEX2BIN","decimal","HEX2DEC","HEX2OCT","IMABS","IMREAL","IMAGINARY","plus","unit","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","trans_dict"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([257,2,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nexport function stringAt(index) {\n  let str = '';\n  let cindex = index;\n  while (cindex >= alphabets.length) {\n    cindex /= alphabets.length;\n    cindex -= 1;\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\n  }\n  const last = index % alphabets.length;\n  str += alphabets[last];\n  return str;\n}\n\nexport function  indexAt(str) {\n  let ret = 0;\n  for (let i = 0; i < str.length - 1; i += 1) {\n    const cindex = str.charCodeAt(i) - 65;\n    const exponet = str.length - 1 - i;\n    ret += (alphabets.length ** exponet) + (alphabets.length * cindex);\n  }\n  ret += str.charCodeAt(str.length - 1) - 65;\n  return ret;\n}\n\n// B10 => x,y\nexport function expr2xy(src) {\n  let x = '';\n  let y = '';\n  for (let i = 0; i < src.length; i += 1) {\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n      y += src.charAt(i);\n    } else {\n      x += src.charAt(i);\n    }\n  }\n  return [indexAt(x), parseInt(y, 10) - 1];\n}\n\n// export function expr2expr(src, xn, yn) {\n//   const [x, y] = expr2xy(src);\n//   return stringAt(x + xn) + (y + yn);\n// }\n\n// x,y => B10  x ci y ri\nexport function xy2expr(x, y, ab = 0) {\n  x = x * 1;\n  y = y * 1;\n  if(ab === 2) {\n    return `${stringAt(x)}$${y + 1}`;\n  } else if(ab === 1) {\n      return `$${stringAt(x)}${y + 1}`;\n  }\n  return `${stringAt(x)}${y + 1}`;\n}\n\nexport default {\n  expr2xy,\n  xy2expr,\n};\n","var error = require('./error');\n\nfunction flattenShallow(array) {\n  if (!array || !array.reduce) { return array; }\n  return array.reduce(function(a, b) {\n    var aIsArray = Array.isArray(a);\n    var bIsArray = Array.isArray(b);\n    if (aIsArray && bIsArray ) {\n      return a.concat(b);\n    }\n    if (aIsArray) {\n      a.push(b);\n      return a;\n    }\n    if (bIsArray) {\n      return [a].concat(b);\n    }\n    return [a, b];\n  });\n}\n\nfunction isFlat(array) {\n  if (!array) { return false; }\n  for (var i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexports.flatten = function() {\n  var result = exports.argsToArray.apply(null, arguments);\n  while (!isFlat(result)) {\n    result = flattenShallow(result);\n  }\n  return result;\n};\n\nexports.argsToArray = function(args) {\n  return Array.prototype.slice.call(args, 0);\n};\n\nexports.numbers = function() {\n\n  return possibleNumbers.filter(function(el) {\n    return typeof el === 'number';\n  });\n};\n//XW: default0\nfunction parse(a){\n  if (a instanceof Error){\n    return a\n  }\n  if (a instanceof Array){\n    var arr = []\n    for (var i=0;i<a.length;i++){\n      if (typeof a[i][0] === 'string' && a[i][0] !== 'default_0'){\n        return error.name\n      }\n      if (typeof a[i][0] === 'number'){\n        arr.push(a[i][0])\n      }\n      if (a[i][0] instanceof Object){\n        return error.name\n      }\n    }\n    return arr\n  }\n  if (typeof a === 'string'){\n    if (a === 'default_0'){\n      return 'pass'\n    }else{\n      return error.name\n    }\n  }\n  if (typeof a === 'number'){\n    return a\n  }\n}\nexports.flattenNum = function(args) {\n  try{\n    if (args.length === 1 && args[0][0] === 'default_0'){\n      return error.div0\n    }\n    var arr = []\n    for( var i=0;i<args.length;i++){\n      var p = parse(args[i])\n      if (p === undefined){\n        return error.name\n      }\n      if (p instanceof Error){\n        return p\n      }else if(p !== 'pass'){\n        if (p instanceof Array){\n          for (var n=0; n < p.length;n++){\n            arr.push(p[n])\n          }\n        }else{\n          arr.push(p)\n        }\n      }\n    }\n    return arr\n  }catch{\n    return error.name\n  }\n};\n//XW:end\n\nexports.cleanFloat = function(number) {\n  var power = 1e14;\n  return Math.round(number * power) / power;\n};\n\nexports.parseBool = function(bool) {\n  if (bool === undefined){\n    return true\n  }\n  if (typeof bool === 'boolean') {\n    return bool;\n  }\n\n  if (bool instanceof Error) {\n    return bool;\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0;\n  }\n\n  if (typeof bool === 'string') {\n    var up = bool.toUpperCase();\n    if (up === 'TRUE') {\n      return true;\n    }\n\n    if (up === 'FALSE') {\n      return false;\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true;\n  }\n\n  return error.value;\n};\n\nexports.parseNumber = function(string) {\n  if (string === undefined || string === '') {\n    return error.value;\n  }\n  if (!isNaN(string)) {\n    return parseFloat(string);\n  }\n  return error.value;\n};\n\nexports.parseNumberArray = function(arr) {\n  var len;\n  if (!arr || (len = arr.length) === 0) {\n    return error.value;\n  }\n  var parsed;\n  while (len--) {\n    parsed = exports.parseNumber(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.parseMatrix = function(matrix) {\n  var n;\n  if (!matrix || (n = matrix.length) === 0) {\n    return error.value;\n  }\n  var pnarr;\n  for (var i = 0; i < matrix.length; i++) {\n    pnarr = exports.parseNumberArray(matrix[i]);\n    matrix[i] = pnarr;\n    if (pnarr instanceof Error) {\n      return pnarr;\n    }\n  }\n  return matrix;\n};\n\nvar d1900 = new Date(1900, 0, 1);\nexports.parseDate = function(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date);\n    }\n    var d = parseInt(date, 10);\n    if (d < 0) {\n      return error.num;\n    }\n    if (d <= 60) {\n      return new Date(d1900.getTime() + (d - 1) * 86400000);\n    }\n    return new Date(d1900.getTime() + (d - 2) * 86400000);\n  }\n  if (typeof date === 'string') {\n    date = new Date(date);\n    if (!isNaN(date)) {\n      return date;\n    }\n  }\n  return error.value;\n};\nexports.Copy =  function (obj) {\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n  // Handle Date\n  if (obj instanceof Date) {\n    var copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n  // Handle Array\n  if (obj instanceof Array) {\n    var copy = [];\n    for (var i = 0; i < obj.length; ++i) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n  // Handle Object\n  if (obj instanceof Object) {\n    var copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n//XW:{},{1,2,34,5,6}\nfunction parse_arg(arg) {\n  if(!isNaN(parseInt(arg))){\n    return parseInt(arg)\n  }\n  return arg.replace('\"', '').replace('\"', '')\n}\nexports.strToMatrix = function (str) {\n  var arg = str.slice(2,str.length-2).split(',')\n  var matrix = [];\n  var arr = []\n  for (var i=0; i < arg.length; i++){\n    var num = arg[i].toString()\n    if (num.indexOf(';') > 0) {\n      arr.push(parse_arg(num.split(';')[0]))\n      matrix.push(arr)\n      arr = [parse_arg(num.split(';')[1])]\n    }else{\n      arr.push(parse_arg(num))\n    }\n  }\n  matrix.push(arr)\n  return matrix\n}\n//XW: end\n//XWexceljs\nexports.ExcelDateToJSDate = function (date) {\n  if (typeof date == 'string'){\n    date = utils.parseDate(issue)\n  }\n  return (date instanceof Date) ? date : new Date(Math.round((date - 25569)*86400*1000));\n}\n//XWend\n//XW\nexports.isNumber = function (val) {\n  var regPos = /^\\d+(\\.\\d+)?$/; //\n  var regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //\n  if(regPos.test(val) || regNeg.test(val)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n//XWend\nexports.parseDateArray = function(arr) {\n  var len = arr.length;\n  var parsed;\n  while (len--) {\n    parsed = this.parseDate(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.anyIsError = function() {\n  var n = arguments.length;\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexports.arrayValuesToNumbers = function(arr) {\n  var n = arr.length;\n  var el;\n  while (n--) {\n    el = arr[n];\n    if (typeof el === 'number') {\n      continue;\n    }\n    if (el === true) {\n      arr[n] = 1;\n      continue;\n    }\n    if (el === false) {\n      arr[n] = 0;\n      continue;\n    }\n    if (typeof el === 'string') {\n      var number = this.parseNumber(el);\n      if (number instanceof Error) {\n        arr[n] = 0;\n      } else {\n        arr[n] = number;\n      }\n    }\n  }\n  return arr;\n};\n\nexports.rest = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(idx);\n};\n\nexports.initial = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(0, array.length - idx);\n};\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","\"use strict\";\n\nconst expression_builder = require('./expression_builder.js');\n\nlet xlsx_Fx = {};\nlet xlsx_raw_Fx = {};\n\nimport_functions(require('.//formulajs/index'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            if (opts.override || !xlsx_Fx[prefix + key]) {\n                xlsx_Fx[prefix + key] = obj;\n            }\n            // else {\n            //     console.log(prefix + key, 'already exists.');\n            //     console.log('  to override:');\n            //     console.log('    XLSX_CALC.import_functions(yourlib, {override: true})');\n            // }\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    return expression_builder(formula, {xlsx_Fx: xlsx_Fx, xlsx_raw_Fx: xlsx_raw_Fx});\n    // xlsx_raw_Fx = {AND, IF, IFERROR, OFFSET}\n    // xlsx_Fx = {FLOOR, AVERGAE ... }\n}\n\nfunction exec_formula(formula) { // formula.cell.f = \"Average(1,2,3,4,5)\n    let root_exp = build_expression(formula);\n    root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.localizeFunctions = function(dic) {\n    for (let newName in dic) {\n        let oldName = dic[newName];\n        if (xlsx_Fx[oldName]) {\n            xlsx_Fx[newName] = xlsx_Fx[oldName];\n        }\n        if (xlsx_raw_Fx[oldName]) {\n            xlsx_raw_Fx[newName] = xlsx_raw_Fx[oldName];\n        }\n    }\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nexec_formula.xlsx_Fx = xlsx_Fx;\nmodule.exports = exec_formula;\n","const Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nmodule.exports = function expression_builder(formula, opts) { // \n    formula.status = 'working';\n\n    var xlsx_Fx = opts.xlsx_Fx || {};\n    var xlsx_raw_Fx = opts.xlsx_raw_Fx || {};\n\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1); // =adsf adsf\n    }\n    var exp_obj = root_exp = new Exp(formula);  // \n    var buffer = '',\n        was_string = false;\n    var fn_stack = [{ // \n        exp: exp_obj\n    }];\n\n    /**\n     * state pattern in functional way\n     */\n    function string(char) {\n        if (char === '\"') {\n            exp_obj.push(new RawValue(buffer));\n            was_string = true;\n            buffer = '';\n            state = start;\n        } else {\n            buffer += char;\n        }\n    }\n\n    function single_quote(char) {\n        if (char === \"'\") {\n            state = start;\n        }\n        buffer += char;\n    }\n\n    function ini_parentheses() {\n        var o, trim_buffer = buffer.trim(),\n            special = xlsx_Fx[trim_buffer];\n        var special_raw = xlsx_raw_Fx[trim_buffer];\n        if (special_raw) {\n            special = new UserRawFnExecutor(special_raw, formula);\n        }\n        else if (special) {\n            special = new UserFnExecutor(special, formula);\n        }\n        else if (trim_buffer) {\n            //Error: \"Worksheet 1\"!D145: Function INDEX not found\n            throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n        }\n        o = new Exp(formula);\n        fn_stack.push({\n            exp: o,\n            special: special\n        });\n        exp_obj = o;\n        buffer = '';\n    }\n\n    function end_parentheses() {\n        var v, stack = fn_stack.pop();\n        exp_obj = stack.exp;\n        exp_obj.push(buffer,position_i);\n        v = exp_obj;\n        buffer = '';\n        exp_obj = fn_stack[fn_stack.length - 1].exp;\n        if (stack.special) {\n            stack.special.push(v);\n            exp_obj.push(stack.special, position_i);\n        }\n        else {\n            exp_obj.push(v, position_i);\n        }\n    }\n\n    function add_operation(char) {\n        if (!was_string) {\n            exp_obj.push(buffer, position_i);\n        }\n        was_string = false;\n        exp_obj.push(char, position_i);\n        buffer = '';\n    }\n\n    function start(char) {\n        if (char === '\"') {\n            state = string;\n            buffer = \"\";\n        } else if (char === \"'\") {\n            state = single_quote;\n            buffer = \"'\";\n        } else if (char === '(') {\n            ini_parentheses();\n        } else if (char === ')') {\n            end_parentheses();\n        } else if (common_operations[char]) {\n            add_operation(char);\n        } else if (char === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer, position_i);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        } else {\n            buffer += char;\n        }\n    }\n\n    var state = start;\n    var position_i = 0;\n\n    for (; position_i < str_formula.length; position_i++) {\n        state(str_formula[position_i]); // \n    }\n    root_exp.push(buffer, position_i); // root_exp ExpExp\n    return root_exp;\n\n}\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst str_2_val = require('./str_2_val.js');\n//XW\nvar error = require('./formulajs/lib/error');\n//XWend\n\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\nvar exp_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;   // id root_expid1\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n\n    function update_cell_value() {\n        try {\n            if (Array.isArray(self.args)\n                    && self.args.length === 1\n                    && self.args[0] instanceof Range) {\n                throw error.value;\n            }\n            formula.cell.v = self.calc();\n\n            if (typeof(formula.cell.v) === 'string') {\n                formula.cell.t = 's';\n            }\n            else if (typeof(formula.cell.v) === 'number') {\n                formula.cell.t = 'n';\n            }\n        }\n        catch (e) {\n            var errorValues = {\n                '#NULL!': 0x00,\n                '#DIV/0!': 0x07,\n                '#VALUE!': 0x0F,\n                '#REF!': 0x17,\n                '#NAME?': 0x1D,\n                '#NUM!': 0x24,\n                '#N/A': 0x2A,\n                '#GETTING_DATA': 0x2B\n            };\n            if (errorValues[e.message] !== undefined) {\n                formula.cell.t = 'e';\n                formula.cell.w = e.message;\n                formula.cell.v = errorValues[e.message];\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            formula.status = 'done';\n        }\n    }\n    function isEmpty(value) {\n        return value === undefined || value === null || value === \"\";\n    }\n\n    function checkVariable(obj) {\n        if (typeof obj.calc !== 'function') {\n            return 0;\n        }\n        return 1;\n    }\n\n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    if (i === 0 && op === '+') {\n                        let as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = args[i + 1].calc();\n                        args.splice(i, 2, new RawValue(r));\n                    } else {\n                        let as = checkVariable(args[i - 1]);\n                        if (!as)\n                            break;\n                        as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = fn(args[i - 1].calc(), args[i + 1].calc());\n                        args.splice(i - 1, 3, new RawValue(r));\n                        i--;\n                    }\n                }\n                catch (e) {\n                    // console.log('[Exp.js] - ' + formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                checkVariable(args[i + 1]);\n                var b = args[i + 1].calc();\n                if (i > 0 && typeof args[i - 1] !== 'string') {\n                    args.splice(i, 1, '+');\n                    if (b instanceof Date) {\n                        b = Date.parse(b);\n                        checkVariable(args[i - 1]);\n                        var a = args[i - 1].calc();\n                        if (a instanceof Date) {\n                            a = Date.parse(a) / MS_PER_DAY;\n                            b = b / MS_PER_DAY;\n                            args.splice(i - 1, 1, new RawValue(a));\n                        }\n                    }\n                    args.splice(i + 1, 1, new RawValue(-b));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(-b));\n                }\n            }\n        }\n    }\n    self.calc = function() {\n        let args = self.args.concat();\n        //XW: \n        try{\n            for (var i=0;i<args.length;i++){\n                if (args[i].name == 'RefValue'){\n                    var sheet = args[i].formula.sheet\n                    //fdefault_0\n                    if (sheet[args[i].str_expression] === undefined){\n                        args[i].formula.sheet[args[i].str_expression] = {v: 'default_0'}\n                    }\n                    //=A0\n                    if (args[i].str_expression.slice(1, args[i].str_expression.length) == '0'){\n                        return error.name;\n                    }\n                }\n            }\n        }catch (e) {\n        }\n        try{\n            //201910192019-10-19\n            if (args[0].name == 'RefValue' && args[1] == '-' && args[2].name == 'RefValue'){\n                var sheet = args[0].formula.sheet\n                var a = sheet[args[0].str_expression].v\n                var b = sheet[args[2].str_expression].v\n                var a = a.replace('', '-').replace('', '-').replace('', '')\n                var b = b.replace('', '-').replace('', '-').replace('', '')\n                return datedifference(a, b)\n            }\n        }catch (e) {\n        }\n        //XWend\n        exec_minus(args);\n        exec('^', args, function(a, b) {\n            return Math.pow(+a, +b);\n        });\n        exec('/', args, function(a, b) {\n            if (b == 0) {\n                throw error.div0;\n            }\n            return (+a) / (+b);\n        });\n        exec('*', args, function(a, b) {\n            return (+a) * (+b);\n        });\n        exec('+', args, function(a, b) {\n            if (a instanceof Date && typeof b === 'number') {\n                b = b * MS_PER_DAY;\n            }\n            return (+a) + (+b);\n        });\n        exec('&', args, function(a, b) {\n            return '' + a + b;\n        });\n        exec('<', args, function(a, b) {\n            return a < b;\n        });\n        exec('>', args, function(a, b) {\n            return a > b;\n        });\n        exec('>=', args, function(a, b) {\n            return a >= b;\n        });\n        exec('<=', args, function(a, b) {\n            return a <= b;\n        });\n        exec('<>', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() !== b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return false;\n            }\n            return a != b;\n        });\n        exec('=', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return true;\n            }\n            if ((a == null && b === 0) || (a === 0 && b == null)) {\n                return true;\n            }\n            if (typeof a === 'string' && typeof b === 'string' && a.toLowerCase() === b.toLowerCase()) {\n                return true;\n            }\n            return a == b;\n        });\n        if (args.length == 1) {\n            if (typeof(args[0].calc) !== 'function') {\n                return args[0];\n            }\n            else {\n                return args[0].calc();\n            }\n        }\n    };\n\n    var last_arg;\n    self.push = function(buffer, position_i) {\n        if (buffer) {\n            var v = str_2_val(buffer, formula, position_i);\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};\n","\"use strict\";\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    self.calc = function() {\n        var errorValues = {\n            '#NULL!': 0x00,\n            '#DIV/0!': 0x07,\n            '#VALUE!': 0x0F,\n            '#REF!': 0x17,\n            '#NAME?': 0x1D,\n            '#NUM!': 0x24,\n            '#N/A': 0x2A,\n            '#GETTING_DATA': 0x2B\n        }, result;\n        try {\n            result = user_function.apply(self, self.args.map(f=>f.calc()));\n        } catch (e) {\n            if (user_function.name === 'is_blank'\n                && errorValues[e.message] !== undefined) {\n                // is_blank applied to an error cell doesn't propagate the error\n                result = 0;\n            }\n            else if (user_function.name === 'iserror'\n                && errorValues[e.message] !== undefined) {\n                // iserror applied to an error doesn't propagate the error and returns true\n                result = true;\n            }\n            else {\n                throw e;\n            }\n        }\n        return result;\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","var mathTrig = require('./math-trig');\nvar statistical = require('./statistical');\nvar engineering = require('./engineering');\nvar dateTime = require('./date-time');\n\nfunction set(fn, root) {\n  if (root) {\n    for (var i in root) {\n      fn[i] = root[i];\n    }\n  }\n  return fn;\n}\n\nexports.BETADIST = statistical.BETA.DIST;\nexports.BETAINV = statistical.BETA.INV;\nexports.BINOMDIST = statistical.BINOM.DIST;\nexports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);\nexports.CEILINGMATH = mathTrig.CEILING.MATH;\nexports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;\nexports.CHIDIST = statistical.CHISQ.DIST;\nexports.CHIDISTRT = statistical.CHISQ.DIST.RT;\nexports.CHIINV = statistical.CHISQ.INV;\nexports.CHIINVRT = statistical.CHISQ.INV.RT;\nexports.CHITEST = statistical.CHISQ.TEST;\nexports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);\nexports.COVAR = statistical.COVARIANCE.P;\nexports.COVARIANCEP = statistical.COVARIANCE.P;\nexports.COVARIANCES = statistical.COVARIANCE.S;\nexports.CRITBINOM = statistical.BINOM.INV;\nexports.EXPONDIST = statistical.EXPON.DIST;\nexports.ERFCPRECISE = engineering.ERFC.PRECISE;\nexports.ERFPRECISE = engineering.ERF.PRECISE;\nexports.FDIST = statistical.F.DIST;\nexports.FDISTRT = statistical.F.DIST.RT;\nexports.FINVRT = statistical.F.INV.RT;\nexports.FINV = statistical.F.INV;\n// XWFLOOR\n// exports.FLOOR = set(mathTrig.FLOORMATH, mathTrig.FLOOR);//11.5-\nexports.FLOORMATH = mathTrig.FLOORMATH;\nexports.FLOORPRECISE = mathTrig.FLOORPRACE;\n//XWend\nexports.FTEST = statistical.F.TEST;\nexports.GAMMADIST = statistical.GAMMA.DIST;\nexports.GAMMAINV = statistical.GAMMA.INV;\nexports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;\nexports.HYPGEOMDIST = statistical.HYPGEOM.DIST;\nexports.LOGINV = statistical.LOGNORM.INV;\nexports.LOGNORMINV = statistical.LOGNORM.INV;\nexports.LOGNORMDIST = statistical.LOGNORM.DIST;\nexports.MODE = set(statistical.MODE.SNGL, statistical.MODE);\nexports.MODEMULT = statistical.MODE.MULT;\nexports.MODESNGL = statistical.MODE.SNGL;\nexports.NEGBINOMDIST = statistical.NEGBINOM.DIST;\nexports.NETWORKDAYSINTL = dateTime.NETWORKDAYSINTL;\nexports.NORMDIST = statistical.NORM.DIST;\nexports.NORMINV = statistical.NORM.INV;\nexports.NORMSDIST = statistical.NORM.S.DIST;\nexports.NORMSINV = statistical.NORM.S.INV;\nexports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);\nexports.PERCENTILEEXC = statistical.PERCENTILE.EXC;\nexports.PERCENTILEINC = statistical.PERCENTILE.INC;\nexports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);\nexports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;\nexports.PERCENTRANKINC = statistical.PERCENTRANK.INC;\nexports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);\nexports.POISSONDIST = statistical.POISSON.DIST;\nexports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);\nexports.QUARTILEEXC = statistical.QUARTILE.EXC;\nexports.QUARTILEINC = statistical.QUARTILE.INC;\nexports.RANK = set(statistical.RANK.EQ, statistical.RANK);\nexports.RANKAVG = statistical.RANK.AVG;\nexports.RANKEQ = statistical.RANK.EQ;\nexports.SKEWP = statistical.SKEW.P;\nexports.STDEV = set(statistical.STDEV.S, statistical.STDEV);\nexports.STDEVP = statistical.STDEV.P;\nexports.STDEVS = statistical.STDEV.S;\nexports.TDIST = statistical.T.DIST;\nexports.TDISTRT = statistical.T.DIST.RT;\nexports.TINV = statistical.T.INV;\nexports.TTEST = statistical.T.TEST;\n// exports.VAR = set(statistical.VAR.S, statistical.VAR);\nexports.VARP = statistical.VAR.P;\nexports.VARS = statistical.VAR.S;\nexports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);\nexports.WEIBULLDIST = statistical.WEIBULL.DIST;\nexports.WORKDAYINTL = dateTime.WORKDAYINTL;\nexports.ZTEST = statistical.Z.TEST;\n//XW: _XLFN\nexports._XLFN = set(mathTrig.FLOOR.MATH, statistical.COVARIANCE.P, statistical.NORM.INV, statistical.VAR.P)\n// exports._XLFN.FLOOR = mathTrig.FLOOR\n// exports._XLFN.COVARIANCE = statistical.COVARIANCE\n// exports._XLFN.NORM = statistical.NORM\n// exports._XLFN.VAR = statistical.VAR\n//XWend","/* eslint-disable no-param-reassign */\nfunction cloneDeep(obj) {\n\n    return JSON.parse(JSON.stringify(obj));\n}\n\n// export function isEqual(v1, v2) {\n//     v1 = v1 + \"\";\n//     v2 = v2 + \"\";\n//     v1 = v1.toUpperCase();\n//     v2 = v2.toUpperCase();\n//\n//     return v1 === v2;\n// }\n\nconst mergeDeep = (object = {}, ...sources) => {\n    sources.forEach((source) => {\n        if (source != null && source !== undefined) {\n            Object.keys(source).forEach((key) => {\n                const v = source[key];\n                // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\n                if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n                    object[key] = v;\n                } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\n                    object[key] = object[key] || {};\n                    mergeDeep(object[key], v);\n                } else {\n                    object[key] = v;\n                }\n            });\n        }\n    });\n    // console.log('::', object);\n    return object;\n};\n\nfunction find(arr, str) {\n    for (let i = 0; i < arr.length; i++) {\n        if (str.indexOf(arr[i]) !== -1) {\n            return true;\n        }\n    }\n    return false;\n}\n\n\nfunction isOusideViewRange(y, x, dy, dx, orien) {\n    if (orien === 44 && dy - y + 100 > 0) {\n        return true;\n    } else if (orien === 11 && dx - 100 < 0) {\n        return true;\n    } else if (orien === 33 && dx - x + 100 > 0) {\n        return true;\n    } else if (orien === 22 && dy - 100 < 0) {\n        return true;\n    }\n    return false;\n}\n\nfunction equals(obj1, obj2) {\n    const keys = Object.keys(obj1);\n    if (keys.length !== Object.keys(obj2).length) return false;\n    for (let i = 0; i < keys.length; i += 1) {\n        const k = keys[i];\n        const v1 = obj1[k];\n        const v2 = obj2[k];\n        if (v2 === undefined) return false;\n        if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\n            if (v1 !== v2) return false;\n        } else if (Array.isArray(v1)) {\n            if (v1.length !== v2.length) return false;\n            for (let ai = 0; ai < v1.length; ai += 1) {\n                if (!equals(v1[ai], v2[ai])) return false;\n            }\n        } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\n            if (!equals(v1, v2)) return false;\n        }\n    }\n    return true;\n}\n\nfunction isHave(param) {\n    if (typeof param === \"undefined\") {\n        return false;\n    }\n\n    // if (param === null) {\n    //     return false;\n    // }\n\n    return param !== null;\n}\n\n/*\n  objOrAry: obejct or Array\n  cb: (value, index | key) => { return value }\n*/\nconst sum = (objOrAry, cb = value => value) => {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n        total += cb(objOrAry[key], key);\n        size += 1;\n    });\n    return [total, size];\n};\n\n// function deleteProperty(obj, property) {\n//     const oldv = obj[`${property}`];\n//     delete obj[`${property}`];\n//     return oldv;\n// }\n\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\n    let s = inits;\n    let v = initv;\n    let i = min;\n    for (; i < max; i += 1) {\n        if (s > ifv) break;\n        v = getv(i);\n        s += v;\n    }\n    return [i, s - v, v];\n}\n\nfunction rangeSum(min, max, getv) {\n    let s = 0;\n    for (let i = min; i < max; i += 1) {\n        s += getv(i);\n    }\n    return s;\n}\n\nfunction isNumber(inputData) {\n    // if (parseFloat(inputData).toString() === \"NaN\") {\n    //     return false;\n    // } else {\n    //     return parseFloat(inputData).toString() === \"NaN\";\n    // }\n    return parseFloat(inputData).toString() !== \"NaN\";\n}\n\n// function rangeEach(min, max, cb) {\n//     for (let i = min; i < max; i += 1) {\n//         cb(i);\n//     }\n// }\n\nfunction arrayEquals(a1, a2) {\n    if (a1.length === a2.length) {\n        for (let i = 0; i < a1.length; i += 1) {\n            if (a1[i] !== a2[i]) return false;\n        }\n    } else return false;\n    return true;\n}\n\nexport default {\n    cloneDeep,\n    merge: (...sources) => mergeDeep({}, ...sources),\n    equals,\n    arrayEquals,\n    sum,\n     rangeSum,\n    rangeReduceIf,\n\n};\n\nexport {\n    isNumber,\n    isOusideViewRange,\n    find,\n    isHave,\n}","var numeric = require('numeric');\nvar utils = require('./utils');\nvar error = require('./error');\nvar statistical = require('./statistical');\nvar information = require('./information');\n\nexports.ABS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.abs(utils.parseNumber(number));\n};\n\nexports.ACOS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.acos(number);\n};\n\nexports.ACOSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number - 1));\n};\n\nexports.ACOT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(1 / number);\n};\n\nexports.ACOTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 0.5 * Math.log((number + 1) / (number - 1));\n};\n\n//TODO: use options\nexports.AGGREGATE = function(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num);\n  options = utils.parseNumber(options);\n  //XW: \n  if (typeof ref1 == 'string') {\n    return error.value\n  }//XW:end\n  if (utils.anyIsError(function_num, options)) {\n    return error.value;\n  }\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n    case 12:\n      return statistical.MEDIAN(ref1, ref2);\n    case 13:\n      return statistical.MODE.SNGL(ref1);\n    case 14:\n      return statistical.LARGE(ref1, ref2);\n    case 15:\n      if (ref2 == undefined){\n        return error.value\n      }\n      return statistical.SMALL(ref1, ref2);\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2);\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2);\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2);\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2);\n  }\n};\n\nexports.ARABIC = function(text) {\n  // Credits: Rafa? Kukawski\n  text = text.toUpperCase()\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value;\n  }\n  var r = 0;\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i];\n  });\n  return r;\n};\n\nexports.ASIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.asin(number);\n};\n\nexports.ASINH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number + 1));\n};\n\nexports.ATAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(number);\n};\n\nexports.ATAN2 = function(number_x, number_y) {\n  number_x = utils.parseNumber(number_x);\n  number_y = utils.parseNumber(number_y);\n  if (utils.anyIsError(number_x, number_y)) {\n    return error.value;\n  }\n  return Math.atan2(number_x, number_y);\n};\n\nexports.ATANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log((1 + number) / (1 - number)) / 2;\n};\n\nexports.BASE = function(number, radix, min_length) {\n  min_length = min_length || 0;\n\n  number = utils.parseNumber(number);\n  radix = utils.parseNumber(radix);\n  min_length = utils.parseNumber(min_length);\n  if (utils.anyIsError(number, radix, min_length)) {\n    return error.value;\n  }\n  min_length = (min_length === undefined) ? 0 : min_length;\n  var result = number.toString(radix);\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n};\n\nexports.CEILING = function(number, significance, mode) {\n  significance = (significance === undefined) ? 1 : Math.abs(significance);\n  mode = mode || 0;\n\n  number = utils.parseNumber(number);\n  significance = utils.parseNumber(significance);\n  mode = utils.parseNumber(mode);\n  if (utils.anyIsError(number, significance, mode)) {\n    return error.value;\n  }\n  if (significance === 0) {\n    return 0;\n  }\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return exports.ROUND(Math.ceil(number / significance) * significance, precision);\n  } else {\n    if (mode === 0) {\n      return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n    } else {\n      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n    }\n  }\n};\n\nexports.CEILING.MATH = exports.CEILING;\n\nexports.CEILING.PRECISE = exports.CEILING;\n\nexports.COMBIN = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n};\n\nexports.COMBINA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n};\n\nexports.COS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.cos(number);\n};\n\nexports.COSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return (Math.exp(number) + Math.exp(-number)) / 2;\n};\n\nexports.COT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.tan(number);\n};\n\nexports.COTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 + 1) / (e2 - 1);\n};\n\nexports.CSC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.sin(number);\n};\n\nexports.CSCH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) - Math.exp(-number));\n};\n\nexports.DECIMAL = function(number, radix) {\n  if (arguments.length < 1) {\n    return error.value;\n  }\n\n\n  return parseInt(number, radix);\n};\n\nexports.DEGREES = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * 180 / Math.PI;\n};\n\nexports.EVEN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return exports.CEILING(number, -2, -1);\n};\n\nexports.EXP = Math.exp;\n\nvar MEMOIZED_FACT = [];\nexports.FACT = function (number) {\n  number = utils.parseNumber(number);\n  if (number < 0){\n    return error.num\n  }\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n === 0 || n === 1) {\n    return 1;\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n];\n  } else {\n    MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n    return MEMOIZED_FACT[n];\n  }\n};\n\nexports.FACTDOUBLE = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n <= 0) {\n    return 1;\n  } else {\n    return n * exports.FACTDOUBLE(n - 2);\n  }\n};\n\n//TODO: Verify\n// XW: \nexports.FLOOR = {};\nvar ROUND = function (value, places) {\n  var n = value;\n  var d = places;\n  return Math.round(n * Math.pow(10, d)) / Math.pow(10, d);\n};\nexports.FLOORMATH = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number>0&&significance<0){\n    return error.num\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\nexports.FLOORPRACE = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\n\n// Deprecated\nexports.FLOOR.MATH = exports.FLOORMATH;\nexports.FLOOR.PRECISE = exports.FLOORPRACE;\n//XW: end\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexports.GCD = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var r0 = range[0];\n  var x = r0 < 0 ? -r0 : r0;\n  for (var i = 1; i < n; i++) {\n    var ri = range[i];\n    var y = ri < 0 ? -ri : ri;\n    while (x && y) {\n      if (x > y) {\n        x %= y;\n      } else {\n        y %= x;\n      }\n    }\n    x += y;\n  }\n  return x;\n};\n\n\nexports.INT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.floor(number);\n};\n\n//TODO: verify\nexports.ISO = {\n  CEILING: exports.CEILING\n};\n\nexports.LCM = function() {\n  // Credits: Jonas Raoni Soares Silva\n  var o = utils.parseNumberArray(utils.flatten(arguments));\n  if (o instanceof Error) {\n    return o;\n  }\n  for (var i, j, n, d, r = 1;\n    (n = o.pop()) !== undefined;) {\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          //empty\n        }\n        d = (i <= j) ? i : n;\n      } else {\n        d = 2;\n      }\n      for (n /= d, r *= d, i = o.length; i;\n        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        //empty\n      }\n    }\n  }\n  return r;\n};\n\nexports.LN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number);\n};\n\nexports.LOG = function (number, base) {\n  number = utils.parseNumber(number);\n  base = utils.parseNumber(base);\n  if (utils.anyIsError(base)) {\n    base = 10\n  }\n  base = (base === undefined) ? 10 : base;\n  return Math.log(number) / Math.log(base);\n};\n\nexports.LOG10 = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number) / Math.log(10);\n};\n\nexports.MDETERM = function(matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix);\n  }\n  try{\n    return numeric.det(matrix);\n  }catch (e) {\n    return error.value\n  }\n};\n\nexports.MINVERSE = function(matrix) {\n  matrix = utils.parseMatrix(matrix);\n  if (matrix instanceof Error) {\n    return matrix;\n  }\n  return numeric.inv(matrix);\n};\n\nexports.MMULT = function(matrix1, matrix2) {\n  matrix1 = utils.parseMatrix(matrix1);\n  matrix2 = utils.parseMatrix(matrix2);\n  if (utils.anyIsError(matrix1, matrix2)) {\n    return error.value;\n  }\n  console.log(numeric.dot(matrix1, matrix2))\n  return numeric.dot(matrix1, matrix2);\n};\n\nexports.MOD = function(dividend, divisor) {\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n  if (divisor === 0) {\n    return error.div0;\n  }\n  var modulus = Math.abs(dividend % divisor);\n  return (divisor > 0) ? modulus : -modulus;\n};\n\n  exports.MROUND = function(number, multiple) {\n  number = utils.parseNumber(number);\n  multiple = utils.parseNumber(multiple);\n  if (utils.anyIsError(number, multiple)) {\n    return error.value;\n  }\n  if (number * multiple < 0) {\n    return error.num;\n  }\n\n  return Math.round(number / multiple) * multiple;\n};\n\nexports.MULTINOMIAL = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var sum = 0;\n  var divisor = 1;\n  for (var i = 0; i < args.length; i++) {\n    sum += args[i];\n    divisor *= exports.FACT(args[i]);\n  }\n  return exports.FACT(sum) / divisor;\n};\n\nexports.MUNIT = function(dimension) {\n  dimension = utils.parseNumber(dimension);\n  if (dimension instanceof Error) {\n    return dimension;\n  }\n  return numeric.identity(dimension);\n};\n\nexports.ODD = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var temp = Math.ceil(Math.abs(number));\n  temp = (temp & 1) ? temp : temp + 1;\n  return (number > 0) ? temp : -temp;\n};\n\nexports.PI = function() {\n  return Math.PI;\n};\n\nexports.POWER = function(number, power) {\n  number = utils.parseNumber(number);\n  power = utils.parseNumber(power);\n  if (utils.anyIsError(number, power)) {\n    return error.value;\n  }\n  var result = Math.pow(number, power);\n  if (isNaN(result)) {\n    return error.num;\n  }\n\n  return result;\n};\n\nexports.PRODUCT = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var result = 1;\n  for (var i = 0; i < args.length; i++) {\n    result *= args[i];\n  }\n  return result;\n};\n\nexports.QUOTIENT = function(numerator, denominator) {\n  numerator = utils.parseNumber(numerator);\n  denominator = utils.parseNumber(denominator);\n  if (utils.anyIsError(numerator, denominator)) {\n    return error.value;\n  }\n  return parseInt(numerator / denominator, 10);\n};\n\nexports.RADIANS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * Math.PI / 180;\n};\n\nexports.RAND = function() {\n  if (arguments.length > 0 && arguments[0] !== undefined){\n    return error.value\n  }\n  return Math.random();\n};\n\nexports.RANDBETWEEN = function(bottom, top) {\n  bottom = utils.parseNumber(bottom);\n  top = utils.parseNumber(top);\n  if (utils.anyIsError(bottom, top)) {\n    return error.value;\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n};\n\n// TODO\nexports.ROMAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  var digits = String(number).split('');\n  var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];\n  var roman = '';\n  var i = 3;\n  while (i--) {\n    roman = (key[+digits.pop() + (i * 10)] || '') + roman;\n  }\n  return new Array(+digits.join('') + 1).join('M') + roman;\n};\n\nexports.ROUND = function (number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  if (number < 0){\n    number = 0-number\n    return 0-Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n  }\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n};\n\nexports.ROUNDDOWN = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.ROUNDUP = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.SEC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.cos(number);\n};\n\nexports.SECH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) + Math.exp(-number));\n};\n\nexports.SERIESSUM = function(x, n, m, coefficients) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  m = utils.parseNumber(m);\n  coefficients = utils.parseNumberArray(coefficients);\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value;\n  }\n  var result = coefficients[0] * Math.pow(x, n);\n  for (var i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m);\n  }\n  return result;\n};\n\nexports.SIGN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  if (number < 0) {\n    return -1;\n  } else if (number === 0) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\nexports.SIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.sin(number);\n};\n\n  exports.SINH = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return (Math.exp(number) - Math.exp(-number)) / 2;\n  };\n\n  exports.SQRT = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    if (number < 0) {\n      return error.num;\n    }\n    return Math.sqrt(number);\n  };\n\n  exports.SQRTPI = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return Math.sqrt(number * Math.PI);\n  };\n\nexports.SUBTOTAL = function(function_code, ref1) {\n  function_code = utils.parseNumber(function_code);\n  if (function_code instanceof Error) {\n    return function_code;\n  }\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n      // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1);\n    case 102:\n      return statistical.COUNT(ref1);\n    case 103:\n      return statistical.COUNTA(ref1);\n    case 104:\n      return statistical.MAX(ref1);\n    case 105:\n      return statistical.MIN(ref1);\n    case 106:\n      return exports.PRODUCT(ref1);\n    case 107:\n      return statistical.STDEV.S(ref1);\n    case 108:\n      return statistical.STDEV.P(ref1);\n    case 109:\n      return exports.SUM(ref1);\n    case 110:\n      return statistical.VAR.S(ref1);\n    case 111:\n      return statistical.VAR.P(ref1);\n\n  }\n};\n\nexports.ADD = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.name;\n  }\n\n  return num1 + num2;\n};\n\nexports.MINUS = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.value;\n  }\n\n  return num1 - num2;\n};\n\nexports.DIVIDE = function (dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n\n  if (divisor === 0) {\n    return error.div0;\n  }\n\n  return dividend / divisor;\n};\n\nexports.MULTIPLY = function (factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  factor1 = utils.parseNumber(factor1);\n  factor2 = utils.parseNumber(factor2);\n  if (utils.anyIsError(factor1, factor2)) {\n    return error.value;\n  }\n\n  return factor1 * factor2;\n};\n\nexports.GTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 >= num2;\n};\n\nexports.LT = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 < num2;\n};\n\n\nexports.LTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 <= num2;\n};\n\nexports.EQ = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 === value2;\n};\n\nexports.NE = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 !== value2;\n};\n\nexports.POW = function (base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  base = utils.parseNumber(base);\n  exponent = utils.parseNumber(exponent);\n  if (utils.anyIsError(base, exponent)) {\n    return error.error;\n  }\n\n  return exports.POWER(base, exponent);\n};\n\nexports.SUM = function() {\n  var result = 0;\n  var argsKeys = Object.keys(arguments);\n  for (var i = 0; i < argsKeys.length; ++i) {\n    var elt = arguments[argsKeys[i]];\n    if (typeof elt === 'number') {\n      result += elt;\n    } else if (typeof elt === 'string') {\n      var parsed = parseFloat(elt);\n      !isNaN(parsed) && (result += parsed);\n    } else if (Array.isArray(elt)) {\n      result += exports.SUM.apply(null, elt);\n    }\n  }\n  return result;\n};\n\nexports.SUMIF = function(range, criteria) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (range instanceof Error) {\n    return range;\n  }\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\n  }\n  return result;\n};\n//XW SUMIFS\nexports.SUMIFS = function() {\n  var args = utils.argsToArray(arguments);\n  var range = utils.flatten(args.shift());\n  if (range instanceof Error) {\n    return range;\n  }\n  if (args.length % 2 !== 0) {\n    return error.value;\n  }\n  for (let i = 0; i < args.length; i += 2) {\n    if (args[i].length !== range.length || !args[i + 1]) {\n      return error.value;\n    }\n  }\n  let arr = [];\n  var result = 0;\n  for (let i = 0; i < args.length; i += 2) {\n    let s_arr = [];\n    for (let j = 0; j < args[i].length; j++) {\n      let compareValue = args[i + 1] + \"\";\n      if (compareValue.lastIndexOf(\">=\") == 0) {\n        compareValue = compareValue.replace(/>=/, \"\");\n        if (isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 <= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }else if (compareValue.lastIndexOf(\"<=\") == 0) {\n        compareValue = compareValue.replace(/<=/, \"\");\n        if(isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 >= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }\n      compareValue = compareValue.replace(\"=\", \"\");\n      if (compareValue.lastIndexOf(\"<>\") == 0) {\n        compareValue = compareValue.replace(/<>/, \"\");\n        if (compareValue !== args[i][j][0]) {\n          s_arr.push(j);\n        }\n      } else {\n        let str = false;\n        if (compareValue.lastIndexOf(\"<\") == 0) {\n          compareValue = compareValue.replace(/</, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 > args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else if (compareValue.lastIndexOf(\">\") == 0) {\n          compareValue = compareValue.replace(/>/, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 < args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else {\n          if (compareValue.indexOf('*') > 0){\n            var v = compareValue\n            v = v.replace('*', '')\n            if (typeof args[i][j][0] == 'string' && args[i][j][0].indexOf(v) >= 0){\n              s_arr.push(j);\n            }\n          }\n          if(isNaN(compareValue)) {\n            if(compareValue === args[i][j][0]) {\n              s_arr.push(j);\n            }\n          } else {\n            if(compareValue * 1 === args[i][j][0]) {\n              s_arr.push(j);\n            }\n\n          }\n        }\n        if(str) {\n          return error.value;\n        }\n      }\n\n    }\n    arr.push(s_arr);\n  }\n\n  let resultArr = [];\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = 0; j < arr[i].length; j++) {\n      let value = arr[i][j];\n      let enter = 1;\n      for (let k = 0; enter !== 3 && k < arr.length; k++) {\n        if (k !== i && arr[k].indexOf(value) != -1) {\n          enter = 2;\n        } else if (k !== i) {\n          enter = 3;\n        }\n      }\n      if (enter == 1 && arr.length > 1) {\n        enter = 3;\n      } else if (enter == 1 && arr.length === 1) {\n        enter = 2;\n      }\n      if (enter == 2 && resultArr.indexOf(value) == -1) {\n        resultArr.push(value);\n      }\n    }\n  }\n\n  if (arr.length <= 0) {\n    return error.value;\n  }\n\n  for (let i = 0; i < resultArr.length; i++) {\n    let a = range[resultArr[i]];\n    if (a && !isNaN(a)) {\n      result += a;\n    } else {\n      return 0;\n    }\n  }\n\n  return result;\n};\n//XWend\n\nexports.SUMPRODUCT = function() {\n  if (!arguments || arguments.length === 0) {\n    return error.value;\n  }\n  var arrays = arguments.length + 1;\n  var result = 0;\n  var product;\n  var k;\n  var _i;\n  var _ij;\n  for (var i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1;\n      for (k = 1; k < arrays; k++) {\n        _i = utils.parseNumber(arguments[k - 1][i]);\n        if (_i instanceof Error) {\n          return _i;\n        }\n        product *= _i;\n      }\n      result += product;\n    } else {\n      for (var j = 0; j < arguments[0][i].length; j++) {\n        product = 1;\n        for (k = 1; k < arrays; k++) {\n          _ij = utils.parseNumber(arguments[k - 1][i][j]);\n          if (_ij instanceof Error) {\n            return _ij;\n          }\n          product *= _ij;\n        }\n        result += product;\n      }\n    }\n  }\n  return result;\n};\n\nexports.SUMSQ = function() {\n  var numbers = utils.parseNumberArray(utils.flatten(arguments));\n  if (numbers instanceof Error) {\n    return numbers;\n  }\n  var result = 0;\n  var length = numbers.length;\n  for (var i = 0; i < length; i++) {\n    result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\n  }\n  return result;\n};\n\nexports.SUMX2MY2 = function (array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMX2PY2 = function (array_x, array_y) {\n  //XW: \n  if (typeof array_x == \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y == \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  //XWend\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMXMY2 = function(array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.flatten(array_x);\n  array_y = utils.flatten(array_y);\n  for (var i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2);\n  }\n  return result;\n};\n\nexports.TAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.tan(number);\n};\n\nexports.TANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 - 1) / (e2 + 1);\n};\n\nexports.TRUNC = function(number, digits) {\n  digits = (digits === undefined) ? 0 : digits;\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};","var defaultOperator = '=';\nvar validSymbols = ['>', '>=', '<', '<=', '=', '<>'];\nvar TOKEN_TYPE_OPERATOR = 'operator';\nvar TOKEN_TYPE_LITERAL = 'literal';\nvar SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];\n\nexports.TOKEN_TYPE_OPERATOR = TOKEN_TYPE_OPERATOR;\nexports.TOKEN_TYPE_LITERAL = TOKEN_TYPE_LITERAL;\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @return {Object}\n */\nfunction createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type);\n  }\n\n  return {\n    value: value,\n    type: type,\n  };\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @return {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);\n  }\n\n  return value;\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @return {String[]}\n */\nfunction tokenizeExpression(expression) {\n  var expressionLength = expression.length;\n  var tokens = [];\n  var cursorIndex = 0;\n  var processedValue = '';\n  var processedSymbol = '';\n\n  while (cursorIndex < expressionLength) {\n    var char = expression.charAt(cursorIndex);\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char;\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue);\n          processedValue = '';\n        }\n        break;\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol);\n          processedSymbol = '';\n        }\n\n        processedValue = processedValue + char;\n        break;\n    }\n    cursorIndex++;\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue);\n  }\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol);\n  }\n\n  return tokens;\n};\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @return {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  var literalValue = '';\n  var analyzedTokens = [];\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));\n    } else {\n      literalValue += token;\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));\n  }\n\n  return analyzedTokens;\n};\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @return {Boolean}\n */\nfunction computeExpression(tokens) {\n  var values = [];\n  var operator;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value;\n        break;\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value);\n        break;\n    }\n  }\n\n  return evaluate(values, operator);\n};\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @return {Boolean}\n */\nfunction evaluate(values, operator) {\n  var result = false;\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1];\n      break;\n    case '>=':\n      result = values[0] >= values[1];\n      break;\n    case '<':\n      result = values[0] < values[1];\n      break;\n    case '<=':\n      result = values[0] <= values[1];\n      break;\n    case '=':\n      result = values[0] == values[1];\n      break;\n    case '<>':\n      result = values[0] != values[1];\n      break;\n  }\n\n  return result;\n}\n\nexports.parse = function(expression) {\n  return analyzeTokens(tokenizeExpression(expression));\n};\nexports.createToken = createToken;\nexports.compute = computeExpression;","var error = require('./error');\nvar stats = require('./statistical');\nvar maths = require('./math-trig');\nvar utils = require('./utils');\n\nfunction compact(array) {\n  if (!array) { return array; }\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    if (!array[i]) { continue; }\n    result.push(array[i]);\n  }\n  return result;\n}\n\nexports.FINDFIELD = function(database, title) {\n  var index = null;\n  for (var i = 0; i < database.length; i++) {\n    if (database[i][0] === title) {\n      index = i;\n      break;\n    }\n  }\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value;\n  }\n  return index;\n};\n\n//XW: \nfunction find_result_idx(database, criteria){\n  var valid_arr = []\n  var filter_arr = []\n  for (var i=0; i < criteria[0].length; i++) {\n    filter_arr.push(criteria[0][i])\n  }\n  for (var i=1; i < criteria.length; i++){\n    var arr = criteria[i]\n    var valid_str = []\n    for (var j=0; j < filter_arr.length; j++){\n      if (arr[j] != null){\n        valid_str.push(database[0].indexOf(criteria[0][j]) + '-' + arr[j])\n      }\n    }\n    valid_arr.push(valid_str)\n  }\n  var result_idx = []\n  for (var i=1; i < database.length; i++){\n    var data = database[i]\n    for(var j=0;j<valid_arr.length;j++){\n      var is_valid = true\n      for(var k=0;k<valid_arr[j].length;k++){\n        var a = data[parseInt(valid_arr[j][k].split('-')[0])]\n        var b = valid_arr[j][k].split('-')[1]\n        if (b.indexOf('=') >= 0){\n          is_valid = (a == b.replace('=', ''))\n        }else if(!eval(a+b)){\n          is_valid = false\n        }\n      }\n      if(is_valid){\n        result_idx.push(i)\n      }\n    }\n  }\n  return result_idx\n}\nfunction get_values(resultIndexes, database, field){\n  if (typeof field == 'number'){\n    var field_idx = field - 1\n  }else{\n    var field_idx = database[0].indexOf(field)\n  }\n  var values= []\n  for (var i=0; i< resultIndexes.length; i++){\n    values.push(database[resultIndexes[i]][field_idx])\n  }\n  return values\n}\n// Database functions\nexports.DAVERAGE = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  if (typeof field == 'number'){\n    var resultIndexes = [];\n    for (var i=1;i<database.length;i++){\n      resultIndexes.push(i)\n    }\n  }else{\n    var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  var sum = 0\n  for (var i=0; i < targetValues.length; i++){\n    sum += targetValues[i]\n  }\n  return resultIndexes.length === 0 ? error.div0 : sum / targetValues.length;\n};\nexports.DCOUNT = function(database, field, criteria) {\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNT(targetValues);\n};\n\nexports.DCOUNTA = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNTA(targetValues);\n};\n\nexports.DGET = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  if (resultIndexes.length > 1){\n    return error.num\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  return targetValues[0];\n};\n\nexports.DMAX = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var max = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] > max){\n      max = targetValues[i]\n    }\n  }\n  return max\n};\n\nexports.DMIN = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var min = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] < min){\n      min = targetValues[i]\n    }\n  }\n  return min\n};\n\nexports.DPRODUCT = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var result = 1;\n  for (var i=0; i < targetValues.length; i++){\n    result *= targetValues[i]\n  }\n  return result;\n};\n\nexports.DSTDEV = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.S(targetValues);\n};\n\nexports.DSTDEVP = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.P(targetValues);\n};\n\nexports.DSUM = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return maths.SUM(targetValues);\n};\n\nexports.DVAR = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.S(targetValues);\n};\n\nexports.DVARP = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.P(targetValues);\n};\n//XWend\n","var error = require('./error');\nvar utils = require('./utils');\nvar information = require('./information');\n\nexports.AND = function() {\n  var args = utils.flatten(arguments);\n  var result = true;\n  for (var i = 0; i < args.length; i++) {\n    if (!args[i]) {\n      result = false;\n    }\n  }\n  return result;\n};\n\nexports.CHOOSE = function() {\n  if (arguments.length < 2) {\n    return error.na;\n  }\n\n  var index = arguments[0];\n  if (index < 1 || index > 254) {\n    return error.value;\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value;\n  }\n\n  return arguments[index];\n};\n\nexports.FALSE = function() {\n  return false;\n};\n\nexports.IF = function(test, then_value, otherwise_value) {\n  return test ? then_value : otherwise_value;\n};\n\nexports.IFERROR = function(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError;\n  }\n  return value;\n};\n\nexports.IFNA = function(value, value_if_na) {\n  return value === error.na ? value_if_na : value;\n};\n\nexports.NOT = function(logical) {\n  return !logical;\n};\n\nexports.OR = function() {\n  var args = utils.flatten(arguments);\n  var result = false;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result = true;\n    }\n  }\n  return result;\n};\n\nexports.TRUE = function() {\n  return true;\n};\n\nexports.XOR = function() {\n  var args = utils.flatten(arguments);\n  var result = 0;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result++;\n    }\n  }\n  return (Math.floor(Math.abs(result)) & 1) ? true : false;\n};\n\nexports.SWITCH = function () {\n  var result;\n  if (arguments.length > 0) {\n    var targetValue = arguments[0];\n    var argc = arguments.length - 1;\n    var switchCount = Math.floor(argc / 2);\n    var switchSatisfied = false;\n    var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n    if (switchCount) {\n      for (var index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2];\n          switchSatisfied = true;\n          break;\n        }\n      }\n    }\n\n    if (!switchSatisfied && defaultClause) {\n      result = defaultClause;\n    }\n  }\n  if (result == undefined){\n    return error.na\n  }\n  return result;\n};\n","var error = require('./error');\nvar dateTime = require('./date-time');\nvar utils = require('./utils');\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime());\n}\n\nfunction ensureDate(d) {\n  return (d instanceof Date)?d:new Date(d);\n}\n\nexports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\n  if (typeof issue=='string'){\n    issue = utils.parseDate(issue)\n  }\n  //XW: \n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    first = utils.ExcelDateToJSDate(first);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XWend\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value;\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n};\n\n// XW: ACCRINTM\nexports.ACCRINTM = function(issue, settlement, rate, par, basis) {\n  //XW: \n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XWend\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  var result = par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n  if (isNaN(result)){\n    return error.value;\n  }else{\n    return result\n  }\n};\n//XW: end\n\n// TODO\n//XW: \nexports.AMORDEGRC = function (cost, date_purchased, first_period, salvage, period, rate, basis) {\n  if (!validDate(issue) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n};\n\n// TODO\nexports.AMORLINC = function() {\n throw new Error('AMORLINC is not implemented');\n};\n\n// TODO\nexports.COUPDAYBS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement >= maturity) {\n    return error.num;\n  }\n};\n\nexports.COUPDAYS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPDAYSNC = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.numerror.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNUM = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPPCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n//XWend\n\nexports.CUMIPMT = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  // Requires exports.FV() and exports.PMT() from exports.js [http://stoic.com/exports/]\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative interest\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var interest = 0;\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value;\n      start++;\n    }\n  }\n\n  for (var i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n    } else {\n      interest += exports.FV(rate, i - 1, payment, value, 0);\n    }\n  }\n  interest *= rate;\n\n  // Return cumulative interest\n  return interest;\n};\n\nexports.CUMPRINC = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative principal\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var principal = 0;\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate;\n    } else {\n      principal = payment;\n    }\n    start++;\n  }\n  for (var i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n    } else {\n      principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n    }\n  }\n\n  // Return cumulative principal\n  return principal;\n};\n\nexports.DB = function(cost, salvage, life, period, month) {\n  // Initialize month\n  month = (month === undefined) ? 12 : month;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  month = utils.parseNumber(month);\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num;\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Rate is rounded to three decimals places\n  var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\n\n  // Compute initial depreciation\n  var initial = cost * rate * month / 12;\n\n  // Compute total depreciation\n  var total = initial;\n  var current = 0;\n  var ceiling = (period === life) ? life - 1 : period;\n  for (var i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate;\n    total += current;\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial;\n  } else if (period === life) {\n    // Last period\n    return (cost - total) * rate;\n  } else {\n    return current;\n  }\n};\n\nexports.DDB = function(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = (factor === undefined) ? 2 : factor;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  factor = utils.parseNumber(factor);\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Compute depreciation\n  var total = 0;\n  var current = 0;\n  for (var i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\n    total += current;\n  }\n\n  // Return depreciation\n  return current;\n};\n\n// TODO\nexports.DISC = function (settlement,maturity,pr,redemption,basis) {\n  if (pr<=0 || redemption<=0){\n    return error.num\n  }\n  if (basis<0 || basis >4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 360\n  var DSM = Math.abs(dateTime.DAYS(maturity, settlement, false))\n  return (redemption-pr)/pr * B /DSM\n};\n\nexports.DOLLARDE = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\n\n  // Round result\n  var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n  result = Math.round(result * power) / power;\n\n  // Return converted dollar price\n  return result;\n};\n\nexports.DOLLARFR = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\n\n  // Return converted dollar price\n  return result;\n};\n\n// TODO\n//XW\nexports.DURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n};\n//XWend\n\nexports.EFFECT = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1;\n};\n\nexports.FV = function(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  value = value || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  value = utils.parseNumber(value);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value;\n  }\n\n  // Return future value\n  var result;\n  if (rate === 0) {\n    result = value + payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = value * term + payment * (1 + rate) * (term - 1) / rate;\n    } else {\n      result = value * term + payment * (term - 1) / rate;\n    }\n  }\n  return -result;\n};\n\nexports.FVSCHEDULE = function (principal, schedule) {\n  principal = utils.parseNumber(principal);\n  if (typeof schedule === 'string'){\n    schedule = utils.strToMatrix(schedule)\n  }\n  schedule = utils.parseNumberArray(utils.flatten(schedule));\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value;\n  }\n\n  var n = schedule.length;\n  var future = principal;\n\n  // Apply all interests in schedule\n  for (var i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i];\n  }\n\n  // Return future value\n  return future;\n};\n\n// XWINTRATE\nexports.INTRATE = function (settlement, maturity, investment, redemption, basis) {\n  //https://support.office.com/zh-cn/article/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f\n  if (investment<=0 || redemption<=0){\n    return error.value\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 1//\n  var DIM = 2// \n  return (redemption-investment)/investment *(B/DIM)\n};\n//XWend\n\nexports.IPMT = function(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Compute payment\n  var payment = exports.PMT(rate, periods, present, future, type);\n\n  // Compute interest\n  var interest;\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0;\n    } else {\n      interest = -present;\n    }\n  } else {\n    if (type === 1) {\n      interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n    } else {\n      interest = exports.FV(rate, period - 1, payment, present, 0);\n    }\n  }\n\n  // Return interest\n  return interest * rate;\n};\n\nexports.IRR = function(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  guess = guess || 0;\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = (dates[i] - dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  var dates = [];\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = (guess === undefined) ? 0.1 : guess;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.ISPMT = function(rate, period, periods, value) {\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value;\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1);\n};\n\n// XW\nexports.MDURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  if (coupon < 0 || yld < 0){\n    return error.num\n  }\n  if (basis < 0 || basis > 4){\n    return error.num\n  }\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n};\n//xW:end\n\nexports.MIRR = function(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values));\n  finance_rate = utils.parseNumber(finance_rate);\n  reinvest_rate = utils.parseNumber(reinvest_rate);\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value;\n  }\n\n  // Initialize number of values\n  var n = values.length;\n\n  // Lookup payments (negative values) and incomes (positive values)\n  var payments = [];\n  var incomes = [];\n  for (var i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i]);\n    } else {\n      incomes.push(values[i]);\n    }\n  }\n\n  // Return modified internal rate of return\n  var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n  var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n  return Math.pow(num / den, 1 / (n - 1)) - 1;\n};\n\nexports.NOMINAL = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n};\n\nexports.NPER = function(rate, payment, present, future, type) {\n  type = (type === undefined) ? 0 : type;\n  future = (future === undefined) ? 0 : future;\n\n  rate = utils.parseNumber(rate);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value;\n  }\n\n  // Return number of periods\n  var num = payment * (1 + rate * type) - future * rate;\n  var den = (present * rate + payment * (1 + rate * type));\n  return Math.log(num / den) / Math.log(1 + rate);\n};\n\nexports.NPV = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n\n  // Lookup rate\n  var rate = args[0];\n\n  // Initialize net present value\n  var value = 0;\n\n  // Loop on all values\n  for (var j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j);\n  }\n\n  // Return net present value\n  return value;\n};\n\n// XW:\nexports.ODDFPRICE = function() {\n throw new Error('ODDFPRICE is not implemented');\n};\n\n// TODO\nexports.ODDFYIELD = function() {\n throw new Error('ODDFYIELD is not implemented');\n};\n\n// TODO\nexports.ODDLPRICE = function() {\n throw new Error('ODDLPRICE is not implemented');\n};\n\n// TODO\nexports.ODDLYIELD = function() {\n throw new Error('ODDLYIELD is not implemented');\n};\n//XWend\nexports.PDURATION = function(rate, present, future) {\n  rate = utils.parseNumber(rate);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num;\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n};\n\nexports.PMT = function(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Return payment\n  var result;\n  if (rate === 0) {\n    result = (present + future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n    } else {\n      result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n    }\n  }\n  return -result;\n};\n\nexports.PPMT = function(rate, period, periods, present, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n};\n//XW\nexports.PRICE = function (settlement, maturity, rate, yld, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEDISC = function (settlement, maturity, discount, redemption, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEMAT = function (settlement, maturity, issue, rate, yld, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  issue = utils.parseDate(issue);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var dsm = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  var dim = Math.abs(dateTime.DAYS(maturity, issue, false))\n  var B = 360\n  var A = Math.abs(dateTime.DAYS(issue, settlement, false))\n  var result = (100 + ((dim/B)*rate*100))/(1+(dsm/B)*yld)-(A/B)*rate*100\n  return result\n};\n//XWend\nexports.PV = function(rate, periods, payment, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value;\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future;\n  } else {\n    return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n  }\n};\n\nexports.RATE = function(periods, payment, present, future, type, guess) {\n  // Credits: rabugento\n\n  guess = (guess === undefined) ? 0.01 : guess;\n  future = (future === undefined) ? 0 : future;\n  type = (type === undefined) ? 0 : type;\n\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value;\n  }\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-6;\n\n  // Set maximum number of iterations\n  var iterMax = 100;\n  var iter = 0;\n  var close = false;\n  var rate = guess;\n\n  while (iter < iterMax && !close) {\n    var t1 = Math.pow(rate + 1, periods);\n    var t2 = Math.pow(rate + 1, periods - 1);\n\n    var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n    var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\n    var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n\n    var newRate = rate - f1 / (f2 + f3);\n\n    if (Math.abs(newRate - rate) < epsMax) close = true;\n    iter++\n    rate = newRate;\n  }\n\n  if (!close) return Number.NaN + rate;\n  return rate;\n};\n//XW\nexports.RECEIVED = function (settlement, maturity, investment, discount, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (investment <= 0 || discount <= 0){\n    return error.na\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return investment/(1-(discount*day/360))\n};\n//XWend\n\nexports.RRI = function(periods, present, future) {\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value;\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num;\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1;\n};\n\nexports.SLN = function(cost, salvage, life) {\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life;\n};\n\nexports.SYD = function(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num;\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10);\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\n};\n\nexports.TBILLEQ = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));\n};\n\nexports.TBILLPRICE = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);\n};\n\nexports.TBILLYIELD = function(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  price = utils.parseNumber(price);\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value;\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));\n};\n\n// XW\nexports.VDB = function() {\n throw new Error('VDB is not implemented');\n};\n//XWend\n\n\nexports.XIRR = function(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = dateTime.DAYS(dates[i], dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Check that values contains at least one positive value and one negative value\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.XNPV = function(rate, values, dates) {\n  rate = utils.parseNumber(rate);\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value;\n  }\n\n  var result = 0;\n  for (var i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);\n  }\n  return result;\n};\n\n// XW\nexports.YIELD = function (settlement, maturity, rate, pr, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if(rate <= 0){\n    return error.num;\n  }\n  // Return error if price is lower than or equal to zero\n  if (pr <= 0) {\n    return error.num;\n  }\n  if (redemption <= 0){\n    return error.num\n  }\n  // Return error if settlement is greater than maturity\n  if (settlement >= maturity  ) {\n    return error.num;\n  }\n  var A = Math.abs(dateTime.DAYS(settlement, maturity, false))\n\n};\n\n\n// TODO\nexports.YIELDDISC = function() {\n throw new Error('YIELDDISC is not implemented');\n};\n\n// TODO\nexports.YIELDMAT = function() {\n throw new Error('YIELDMAT is not implemented');\n};\n//XWend","var error = require('./error');\nvar utils = require('./utils');\nfunction match_less_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] < lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] > indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\n\nfunction match_exactly_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    lookupValue = lookupValue.replace(/\\?/g, '.');\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1\n        && typeof matrix[idx][0] === 'string') {\n        if (matrix[idx][0].toLowerCase() === lookupValue.toLowerCase()) {\n          return idx + 1;\n        }\n      }\n    } else if (typeof matrix[idx] === 'string') {\n      if (matrix[idx].toLowerCase() === lookupValue.toLowerCase()) {\n        return idx + 1;\n      }\n    }\n\n  }\n  return error.na;\n}\n\nfunction match_exactly_non_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1) {\n        if (matrix[idx][0] === lookupValue) {\n          return idx + 1;\n        }\n      }\n    } else if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    }\n  }\n  //XW:\n  return error.na;\n  //XWend\n}\n\nfunction match_greater_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] > lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] < indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\nexports.MATCH = function (lookupValue, matrix, matchType) {\n  if (Array.isArray(matrix)\n    && matrix.length === 1\n    && Array.isArray(matrix[0])) {\n    matrix = matrix[0];\n  }\n  if (!lookupValue && !matrix) {\n    return error.na;\n  }\n  if (arguments.length === 2) {\n    matchType = 1;\n  }\n  if (!(matrix instanceof Array)) {\n    return error.na;\n  }\n  if (matchType === 0) {\n    if (typeof lookupValue === 'string') {\n      return match_exactly_string(matrix, lookupValue);\n    } else {\n      return match_exactly_non_string(matrix, lookupValue);\n    }\n  } else if (matchType === 1) {\n    return match_less_than_or_equal(matrix, lookupValue);\n  } else if (matchType === -1) {\n    var a = matrix[0][0]\n    for (var i=1;i<matrix.length;i++){\n      if (matrix[i][0] > a){\n        return error.na;\n      }\n    }\n    return match_greater_than_or_equal(matrix, lookupValue);\n  } else {\n    return error.na;\n  }\n}\n//XW: vlookup\nexports.VLOOKUP = function (key, matrix, return_index, cumulative) {\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value;\n  }\n  if (cumulative == 'FALSE') {\n    cumulative = false\n  }else{\n    cumulative = true\n  }\n  for (var i = 0; i < matrix.length; i++) {\n    if (matrix[i][0] == key) {\n      return matrix[i][return_index - 1];\n    }\n  }\n  return error.na;\n};\n//XWend\n\n\n//XW:hlookup\nexports.HLOOKUP = function (needle, table, index, exactmatch) {\n  if (exactmatch == 'TRUE'){\n    exactmatch = true\n  }\n  if (exactmatch == 'FALSE'){\n    exactmatch = false\n  }\n  if (typeof table == 'string' && table.indexOf('{') >=0){\n    table = utils.strToMatrix(table)\n  }\n  if (typeof needle === \"undefined\" || table[0].indexOf(needle) < 0) {\n    return error.na;\n  }\n\n  index = index || 0;\n  let row = table[0];\n\n  for (let i = 0; i < row.length; i++) {\n    if (exactmatch && row[i] === needle || row[i].toString().toLowerCase().indexOf(needle.toString().toLowerCase()) !== -1) {\n      return index < table.length + 1 ? table[index - 1][i] : table[0][i];\n    }\n  }\n\n  return error.na;\n}\n//XWend\n","var error = require('./error');\n//XW: \nexports.PQUERY = function () {\n  if (arguments.length !== 5) {\n    return error.error;\n  }\n\n  if (arguments[0].length !== arguments[1].length) {\n    return error.error;\n  }\n\n  if (arguments[1].length !== arguments[3].length) {\n    return error.error;\n  }\n\n  // \n  let absArr = [];\n  let o1 = arguments[4];\n  for (let i = 0; i < arguments[3].length; i++) {\n    arguments[3][i] = parseFloat(arguments[3][i]);\n    if (!isNaN(arguments[3][i])) {\n      absArr.push({\n        number: i,\n        value: Math.abs(arguments[3][i] - o1)\n      });\n    }\n  }\n  absArr = absArr.sort((obj1, obj2) => {\n    var val1 = obj1.value;\n    var val2 = obj2.value;\n    if (val1 < val2) {\n      return -1;\n    } else if (val1 > val2) {\n      return 1;\n    } else {\n      return 0;\n    }\n  });\n\n\n  let items = [];\n  let count = 1;\n  for (let i = 0; i < absArr.length; i++) {\n    let {number, value} = absArr[i];\n    let a1 = arguments[0][number][0];\n    let a2 = arguments[1][number][0];\n    let a4 = arguments[3][number];\n\n    if (a2 === arguments[2]) {\n      items.push({\n        number: count,\n        name: a1,\n        city: a2,\n        area: a4,\n        value: value\n      });\n      count = count + 1;\n    }\n  }\n\n  return '**!' + JSON.stringify(items);\n};\n\nexports.HYPERLINK = function () {\n  console.log(arguments);\n  if (!arguments || !arguments[0] || !arguments[1]) {\n    return error.na;\n  }\n  let url = arguments[0];\n  if (url.substr(0, 7).toLowerCase() == \"http://\" || url.substr(0, 8).toLowerCase() == \"https://\") {\n    url = url;\n  } else {\n    url = \"http://\" + url;\n  }\n\n  let cell = {\n    \"text\": arguments[1],\n    \"url\": url\n  }\n  return \"*HYPERLINK*!\" + JSON.stringify(cell) + \" \";\n}\n\nfunction City(name, type, url) {\n  this.name = name;\n  this.type = type;\n  this.url = url;\n}\n\nfunction lianJiaUrl(lianjia) {\n  lianjia.push(new City(\"\", 0, \"https://hf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://aq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cz.fang.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://mas.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://bj.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://quanzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xm.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhangzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hui.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jiangmen.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhanjiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fcg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://liuzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nn.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://lz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://ez.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://huangshi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yichang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://changde.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhuzhou.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://lf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qhd.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sjz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ts.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zjk.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bt.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cm.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hk.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://lg.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ld.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ls.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qh.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://san.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wzs.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wc.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://kf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://luoyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xinxiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://kf.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://changzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ha.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ks.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nj.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://nt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://su.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cc.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://jl.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://ganzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jiujiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jian.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sr.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://dl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://hhht.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://sh.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dy.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dazhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://leshan.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://liangshan.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://mianyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ms.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nanchong.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://jn.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://linyi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://weihai.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zb.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://baoji.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hanzhong.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xa.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xianyang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://jz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ty.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://tj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://dali.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://km.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xsbn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://hz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://huzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nb.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://taizhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wz.lianjia.comditu\"));\n}\n\nfunction woaiwojiaUrl(woaiwojia) {\n  woaiwojia.push(new City(\"\", 0, \"https://bj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://hz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://qd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://tj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://cd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://cs.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nc.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nn.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://sh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://sz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://wh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://wx.5i5j.com/map\"));\n}\n\nfunction fangtianxiaUrl(fangtianxia) {\n  fangtianxia.push(new City(\"\", 0, \"https://www1.fang.com\"));\n}\n\nfunction find(name, arr, str = true) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i].name === name || (typeof name === 'string' && str === false)) {\n      let {url} = arr[i];\n      return url;\n    }\n  }\n\n  return \"\";\n}\n\nlet lianjia = [];\nlianJiaUrl(lianjia);\nlet woaiwojia = [];\nwoaiwojiaUrl(woaiwojia);\nlet fangtianxia = [];\nfangtianxiaUrl(fangtianxia);","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    try {\n        var value = cell_ref.calc();\n        if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n            return onerrorvalue.calc();\n        }\n        return value;\n    } catch(e) {\n        return onerrorvalue.calc();\n    }\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition.calc()) {\n        return _then.calc();\n    }\n    else {\n        return _else.calc();\n    }\n}\n\nfunction and() {\n    for (var i = 0; i < arguments.length; i++) {\n        if(!arguments[i].calc()) return false;\n    }\n    return true;\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror,\n    'IF': _if,\n    'AND': and\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst str_2_val = require('./str_2_val.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator { // \n\n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        this.formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = this.formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(this.formulas[i]);\n            this.expressions.push(exp);\n        }\n        this.calcNames();\n    }\n\n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n\n    getVars() {\n        let vars = {};\n        for (let k in this.variables) {\n            vars[k] = this.variables[k].calc();\n        }\n        return vars;\n    }\n\n    calcNames() {\n        if (!this.workbook || !this.workbook.Workbook || !this.workbook.Workbook.Names) {\n            return;\n        }\n        this.workbook.Workbook.Names.forEach(item => {\n            let val = this.getRef(item.Ref);\n            this.variables[item.Name] = val;\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, item.Name);\n            });\n        });\n    }\n\n    getRef(ref_name) {\n        if (!this.formulas.length) {\n            throw new Error(\"No formula found.\");\n        }\n        let first_formula = this.formulas[0];\n        let formula_ref = first_formula.formula_ref;\n        let formula = {\n            formula_ref: formula_ref,\n            wb: this.workbook,\n            exec_formula: this.exec_formula\n        };\n        return str_2_val(ref_name, formula);\n    }\n\n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n\n    execute() {\n        this.expressions.forEach(exp => {\n            exp.update_cell_value();\n        });\n    }\n}\n\nmodule.exports = Calculator;\n","const checker = require('./formula_check.js');\nconst error = require('./formulajs/lib/error');\nclass CalcCell { // cell,\n  constructor(formulas_i, rows) {\n    this.cell = formulas_i.cell\n    this.rows = rows\n    this.f = formulas_i.cell.f\n    this.name = formulas_i.name\n    this.sheet = formulas_i.sheet\n  }\n\n  //\n  check_valid() {\n    var text = this.f\n    //==A1\n    if (text[1] === '='){\n      return error.name\n    }\n    var params = text.match('=[a-z|A-Z]{2,100}')\n    if (params != null && this.f.indexOf('(') <0 && this.f.indexOf(')')<0){\n      return error.name\n    }\n    // \"\" \"\"\n    if (this.f.indexOf('\"\"') >= 1 && this.f.indexOf('(') < 0 && this.f.indexOf(')') < 0) {\n      return this.f.slice(2, this.f.length - 1).replace('\"\"', '\"')\n    }\n    return true\n  }\n\n  //{}''\n  trans_params(fml) {\n    var reg = new RegExp('\\{(.*?)\\}', 'g')\n    var arg = fml.match(reg)\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i]\n        var rep = \"'\" + param + \"'\"\n        fml = fml.replace(param, rep)\n      }\n    }\n    return fml\n  }\n\n  //\n  trans_formula() {\n    var fml = this.f\n    //\n    fml = checker.strim(fml)\n    //\n    fml = checker.trans_formula(fml)\n    if (fml.indexOf('{') >= 0 && fml.indexOf('}') >= 0 && fml.indexOf(\"'{\") < 0) {// XW: \n      fml = this.trans_params(fml)\n    }\n    return fml\n  }\n\n  //\n  recover_formula() {\n    return checker.strim(this.f)\n  }\n}\n\nmodule.exports = CalcCell;","var mathTrig = require('./math-trig');\nvar text = require('./text');\nvar jStat = require('jStat').jStat;\nvar utils = require('./utils');\nvar error = require('./error');\nvar misc = require('./miscellaneous');\nvar evalExpression = require('./expression')\nvar SQRT2PI = 2.5066282746310002;\n\nexports.AVEDEV = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length;\n};\n\nexports.AVERAGE = function() {\n  var range = utils.flattenNum(arguments);\n  if (range instanceof Error) {\n    return range;\n  }\n  if (range.length === 0){\n    return error.div0\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    sum += range[i];\n    count += 1;\n  }\n  return sum / count;\n};\n\nexports.AVERAGEA = function() {\n  var range = utils.flattenNum(arguments);\n  if (range.length == 1 && isNaN(range[0])){\n    return error.value\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sum += el;\n    }\n    if (el === true) {\n      sum++;\n    }\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sum / count;\n};\n\nexports.AVERAGEIF = function (range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na;\n  }\n  average_range = average_range || range;\n  range = utils.flatten(range);\n  average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n  if (average_range instanceof Error) {\n    return average_range;\n  }\n  var average_count = 0;\n  var result = 0;\n  var isWildcard = criteria === void 0 || criteria === '*';\n  var tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '');\n  var filter_criteria = criteria.replace('=', '').replace('*', '').replace('<>', '')\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n\n    if (isWildcard) {\n      result += average_range[i];\n      average_count++;\n    } else {\n      var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n      if (criteria.indexOf('<>') >= 0){\n        if (value.indexOf(filter_criteria) < 0) {\n          result += average_range[i];\n          average_count++;\n        }\n      }else if (evalExpression.compute(tokens) || value.toString().indexOf(filter_criteria) >= 0) {\n        result += average_range[i];\n        average_count++;\n      }\n    }\n  }\n  if (average_count == 0){\n    return error.div0\n  }\n  return result / average_count;\n};\n\nexports.AVERAGEIFS = function () {\n  // Does not work with multi dimensional ranges yet!\n  //http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  var args = utils.argsToArray(arguments);\n  var criteriaLength = (args.length - 1) / 2;\n  var range = utils.flatten(args[0]);\n  var count = 0;\n  var result = 0;\n\n  for (var i = 0; i < range.length; i++) {\n    var isMeetCondition = false;\n\n    for (var j = 0; j < criteriaLength; j++) {\n      var value = args[2 * j + 1][i];\n      var criteria = args[2 * j + 2];\n      var isWildcard = criteria === void 0 || criteria === '*';\n      var computedResult = false;\n\n      if (isWildcard) {\n        computedResult = true;\n      } else {\n        var tokenizedCriteria = evalExpression.parse(criteria + '');\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n        computedResult = evalExpression.compute(tokens);\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false;\n        break;\n      }\n\n      isMeetCondition = true;\n    }\n\n    if (isMeetCondition) {\n      result += range[i];\n      count++;\n    }\n  }\n\n  var average = result / count;\n\n  if (isNaN(average)) {\n    return error.div0;\n  } else {\n    return average;\n  }\n};\n\nexports.BETA = {};\n\nexports.BETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value;\n  }\n\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value;\n  }\n  cumulative = utils.parseBool(cumulative)\n  x = (x - A) / (B - A);\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)/2;\n};\n\nexports.BETA.INV = function(probability, alpha, beta, A, B) {\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value;\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A;\n};\n\nexports.BINOM = {};\n\nexports.BINOM.DIST = function (successes, trials, probability, cumulative) {\n  successes = utils.parseNumber(successes);\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  cumulative = utils.parseBool(cumulative)\n  cumulative = utils.parseNumber(cumulative);\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.binomial.cdf(successes, trials, probability) : jStat.binomial.pdf(successes, trials, probability);\n};\n\nexports.BINOM.INV = function(trials, probability, alpha) {\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value;\n  }\n\n  var x = 0;\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x;\n    }\n    x++;\n  }\n};\n\nexports.CHISQ = {};\n\nexports.CHISQ.DIST = function(x, k, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (x < 0){\n    return error.num\n  }\n  x = utils.parseNumber(x);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(x, k)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k);\n};\n\nexports.CHISQ.DIST.RT = function(x, k) {\n  if (!x | !k) {\n    return error.na;\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return 1 -  jStat.chisquare.cdf(x, k);\n};\n\nexports.CHISQ.INV = function(probability, k) {\n  probability = utils.parseNumber(probability);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(probability, k)) {\n    return error.value;\n  }\n  return jStat.chisquare.inv(probability, k);\n};\n\nexports.CHISQ.INV.RT = function(p, k) {\n  if (!p | !k) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k);\n};\n\nexports.CHISQ.TEST = function(observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {\n    return error.value;\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value;\n  }\n\n  if (observed[0] && expected[0] &&\n      observed[0].length !== expected[0].length) {\n    return error.value;\n  }\n\n  var row = observed.length;\n  var tmp, i, j;\n\n  // Convert single-dimension array into two-dimension array\n  for (i = 0; i < row; i ++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i];\n      observed[i] = [];\n      observed[i].push(tmp);\n    }\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i];\n      expected[i] = [];\n      expected[i].push(tmp);\n    }\n  }\n\n  var col = observed[0].length;\n  var dof = (col === 1) ? row-1 : (row-1)*(col-1);\n  var xsqr = 0;\n  var Pi =Math.PI;\n\n  for (i = 0; i < row; i ++) {\n    for (j = 0; j < col; j ++) {\n      xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    var p = Math.exp(-0.5 * xsqr);\n    if((dof%2) === 1) {\n      p = p * Math.sqrt(2 * xsqr/Pi);\n    }\n    var k = dof;\n    while(k >= 2) {\n      p = p * xsqr/k;\n      k = k - 2;\n    }\n    var t = p;\n    var a = dof;\n    while (t > 0.0000000001*p) {\n      a = a + 2;\n      t = t * xsqr/a;\n      p = p + t;\n    }\n    return 1-p;\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;\n};\n\nexports.COLUMN = function() {\n  col_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n  cell_name = this.args[0].formula.name\n  cell_name = cell_name.replace(/\\d+/g,'')\n  return col_list.indexOf(cell_name)+1\n};\n\nexports.COLUMNS = function(matrix) {\n  if (typeof matrix === 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.cols(matrix);\n};\n\nexports.CONFIDENCE = {};\n\nexports.CONFIDENCE.NORM = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.normalci(1, alpha, sd, n)[1] - 1;\n};\n\nexports.CONFIDENCE.T = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.tci(1, alpha, sd, n)[1] - 1;\n};\nexports.IFS = function() {\n  for (var i = 0; i + 1 < arguments.length; i += 2) {\n    var cond = arguments[i];\n    var val = arguments[i + 1];\n    if (cond) {\n      return val;\n    }\n  }\n  return error.na;\n}\nexports.CORREL = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.corrcoeff(array1, array2);\n};\n\nexports.COUNT = function() {\n  return utils.numbers(utils.flatten(arguments)).length;\n};\n\nexports.COUNTA = function() {\n  var range = utils.flatten(arguments);\n  return range.length - exports.COUNTBLANK(range);\n};\n\nexports.COUNTIN = function (range, value) {\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++;\n    }\n  }\n  return result;\n};\n\n\nexports.COUNTBLANK = function() {\n  var range = utils.flatten(arguments);\n  var blanks = 0;\n  var element;\n  for (var i = 0; i < range.length; i++) {\n    element = range[i];\n    if (element === null || element === '') {\n      blanks++;\n    }\n  }\n  return blanks;\n};\n\nexports.COUNTIF = function (range, criteria) {\n  range = utils.flatten(range);\n  if (criteria === undefined) {\n    return error.value;\n  }\n  var isWildcard = criteria === void 0 || criteria === '*';\n\n  if (isWildcard) {\n    return range.length;\n  }\n\n  var matches = 0;\n  var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n    var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n    if (evalExpression.compute(tokens)) {\n      matches++;\n    }\n  }\n\n  return matches;\n};\n\nexports.COUNTIFS = function () {\n  var args = utils.argsToArray(arguments);\n  var results = new Array(utils.flatten(args[0]).length);\n\n  for (var i = 0; i < results.length; i++) {\n    results[i] = true;\n  }\n  for (i = 0; i < args.length; i += 2) {\n    var range = utils.flatten(args[i]);\n    var criteria = args[i + 1];\n    var isWildcard = criteria === void 0 || criteria === '*';\n\n    if (!isWildcard) {\n      var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n      for (var j = 0; j < range.length; j++) {\n        var value = range[j];\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n        results[j] = results[j] && evalExpression.compute(tokens);\n      }\n    }\n  }\n  var result = 0;\n  for (i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++;\n    }\n  }\n  return result;\n};\n\nexports.COUNTUNIQUE = function () {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length;\n};\n\nexports.COVARIANCE = {};\n\nexports.COVARIANCE.P = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  var mean1 = jStat.mean(array1);\n  var mean2 = jStat.mean(array2);\n  var result = 0;\n  var n = array1.length;\n  for (var i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2);\n  }\n  return result / n;\n};\n\nexports.COVARIANCE.S = function(array1, array2) {\n  if (typeof array1 == \"string\") {\n    array1 = utils.strToMatrix(array1);\n  }\n  if (typeof array2 == \"string\") {\n    array2 = utils.strToMatrix(array2);\n  }\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.covariance(array1, array2);\n};\n\nexports.DEVSQ = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += Math.pow((range[i] - mean), 2);\n  }\n  return result;\n};\n\nexports.EXPON = {};\n\nexports.EXPON.DIST = function(x, lambda, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  lambda = utils.parseNumber(lambda);\n  if (utils.anyIsError(x, lambda)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda);\n};\n\nexports.F = {};\n\nexports.F.DIST = function (x, d1, d2, cumulative) {\n  x = utils.parseNumber(x);\n  d1 = utils.parseNumber(d1);\n  d2 = utils.parseNumber(d2);\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value;\n  }\n  if (cumulative == undefined){\n    cumulative = true\n  }\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value\n  }\n  if (cumulative == 'FALSE'){\n    cumulative = false\n  }\n  return (cumulative) ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2);\n};\n\nexports.F.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2);\n};\n\nexports.F.INV = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.TEST = function (array1, array2) {\n  if (!array1 || !array2) {\n    return error.na;\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na;\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0;\n  }\n\n  var sumOfSquares = function (values, x1) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n      sum += Math.pow((values[i] - x1), 2);\n    }\n    return sum;\n  };\n\n  var x1 = mathTrig.SUM(array1) / array1.length;\n  var x2 = mathTrig.SUM(array2) / array2.length;\n  var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);\n  var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);\n\n  return sum1 / sum2;\n};\n\nexports.FISHER = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return x;\n  }\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n\nexports.FISHERINV = function(y) {\n  y = utils.parseNumber(y);\n  if (y instanceof Error) {\n    return y;\n  }\n  var e2y = Math.exp(2 * y);\n  return (e2y - 1) / (e2y + 1);\n};\n\nexports.FORECAST = function(x, data_y, data_x) {\n  x = utils.parseNumber(x);\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var b = num / den;\n  var a = ymean - b * xmean;\n  return a + b * x;\n};\n\nexports.FREQUENCY = function(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data));\n  bins = utils.parseNumberArray(utils.flatten(bins));\n  if (utils.anyIsError(data, bins)) {\n    return error.value;\n  }\n  var n = data.length;\n  var b = bins.length;\n  var r = [];\n  for (var i = 0; i <= b; i++) {\n    r[i] = 0;\n    for (var j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1;\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1;\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1;\n        }\n      }\n    }\n  }\n  return r;\n};\n\n\nexports.GAMMA = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  if (number === 0) {\n    return error.num;\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num;\n  }\n\n  return jStat.gammafn(number);\n};\n\nexports.GAMMA.DIST = function(value, alpha, beta, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (arguments.length !== 4) {\n    return error.na;\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value;\n  }\n\n  if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false);\n};\n\nexports.GAMMA.INV = function(probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num;\n  }\n\n  if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta);\n};\n\nexports.GAMMALN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return jStat.gammaln(number);\n};\n\nexports.GAMMALN.PRECISE = function(x) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (x <= 0) {\n    return error.num;\n  }\n\n  if (typeof x !== 'number') {\n    return error.value;\n  }\n\n  return jStat.gammaln(x);\n};\n\nexports.GAUSS = function(z) {\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return z;\n  }\n  return jStat.normal.cdf(z, 0, 1) - 0.5;\n};\n\nexports.GEOMEAN = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  return jStat.geomean(args);\n};\n\nexports.GROWTH = function(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n\n  known_y = utils.parseNumberArray(known_y);\n  if (known_y instanceof Error) {\n    return known_y;\n  }\n\n  // Default values for optional parameters:\n  var i;\n  if (known_x === undefined) {\n    known_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i);\n    }\n  }\n  if (new_x === undefined) {\n    new_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i);\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x);\n  new_x = utils.parseNumberArray(new_x);\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value;\n  }\n\n\n  if (use_const === undefined) {\n    use_const = true;\n  }\n\n  // Calculate sums over the data:\n  var n = known_y.length;\n  var avg_x = 0;\n  var avg_y = 0;\n  var avg_xy = 0;\n  var avg_xx = 0;\n  for (i = 0; i < n; i++) {\n    var x = known_x[i];\n    var y = Math.log(known_y[i]);\n    avg_x += x;\n    avg_y += y;\n    avg_xy += x * y;\n    avg_xx += x * x;\n  }\n  avg_x /= n;\n  avg_y /= n;\n  avg_xy /= n;\n  avg_xx /= n;\n\n  // Compute linear regression coefficients:\n  var beta;\n  var alpha;\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);\n    alpha = avg_y - beta * avg_x;\n  } else {\n    beta = avg_xy / avg_xx;\n    alpha = 0;\n  }\n\n  // Compute and return result array:\n  var new_y = [];\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]));\n  }\n  return new_y;\n};\n\nexports.HARMEAN = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    den += 1 / range[i];\n  }\n  return n / den;\n};\n\nexports.HYPGEOM = {};\n\nexports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  M = utils.parseNumber(M);\n  N = utils.parseNumber(N);\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value;\n  }\n\n  function pdf(x, n, M, N) {\n    return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);\n  }\n\n  function cdf(x, n, M, N) {\n    var result = 0;\n    for (var i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N);\n    }\n    return result;\n  }\n\n  return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);\n};\n\nexports.INTERCEPT = function(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y);\n  known_x = utils.parseNumberArray(known_x);\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value;\n  }\n  if (known_y.length !== known_x.length) {\n    return error.na;\n  }\n  return exports.FORECAST(0, known_y, known_x);\n};\n\nexports.KURT = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4);\n  }\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4);\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));\n};\n\nexports.LARGE = function(range, k) {\n  range = utils.flatten(range)\n  var arr = []\n  for ( var i=0;i<range.length;i++){\n    if (parseFloat(range[i])){\n      arr.push((parseFloat(range[i])))\n    }\n  }\n  range = arr;\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function (a, b) {\n    return b - a;\n  })[k - 1];\n};\n\nexports.LINEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var ymean = jStat.mean(data_y);\n  var xmean = jStat.mean(data_x);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var m = num / den;\n  var b = ymean - m * xmean;\n  return [m, b];\n};\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexports.LOGEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  for (var i = 0; i < data_y.length; i ++) {\n    data_y[i] = Math.log(data_y[i]);\n  }\n\n  var result = exports.LINEST(data_y, data_x);\n  result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;\n  result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;\n  return result;\n};\n\nexports.LOGNORM = {};\n\nexports.LOGNORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd);\n};\n\nexports.LOGNORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.lognormal.inv(probability, mean, sd);\n};\n\nexports.MAX = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MAXA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MEDIAN = function() {\n  var arr = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  var arr2 = []\n  for (var i=0;i<arr.length;i++){\n    if (typeof arr[i] === 'number'){\n      arr2.push(arr[i])\n    }\n  }\n  var range = utils.arrayValuesToNumbers(utils.flatten(arr2));\n  return jStat.median(range);\n};\n\nexports.MIN = function() {\n  var range = utils.flatten(arguments);\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MINA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MODE = {};\n\nexports.MODE.MULT = function() {\n  // Credits: Ronan\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var count = {};\n  var maxItems = [];\n  var max = 0;\n  var currentItem;\n\n  for (var i = 0; i < n; i++) {\n    currentItem = range[i];\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n    if (count[currentItem] > max) {\n      max = count[currentItem];\n      maxItems = [];\n    }\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem;\n    }\n  }\n  return maxItems;\n};\n\nexports.MODE.SNGL = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return exports.MODE.MULT(range).sort(function(a, b) {\n    return a - b;\n  })[0];\n};\n\nexports.NEGBINOM = {};\n\nexports.NEGBINOM.DIST = function(k, r, p, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  k = utils.parseNumber(k);\n  r = utils.parseNumber(r);\n  p = utils.parseNumber(p);\n  if (utils.anyIsError(k, r, p)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p);\n};\n\nexports.NORM = {};\n\nexports.NORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  if (sd <= 0) {\n    return error.num;\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return (cumulative) ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd);\n};\n\nexports.NORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, mean, sd);\n};\n\nexports.NORM.S = {};\n\nexports.NORM.S.DIST = function(z, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1);\n};\n\nexports.NORM.S.INV = function(probability) {\n  probability = utils.parseNumber(probability);\n  if (probability instanceof Error) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, 0, 1);\n};\n\nexports.PEARSON = function(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den1 = 0;\n  var den2 = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den1 += Math.pow(data_x[i] - xmean, 2);\n    den2 += Math.pow(data_y[i] - ymean, 2);\n  }\n  return num / Math.sqrt(den1 * den2);\n};\n\nexports.PERCENTILE = {};\n\nexports.PERCENTILE.EXC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    {\n      return a - b;\n    }\n  });\n  var n = array.length;\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num;\n  }\n  var l = k * (n + 1) - 1;\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTILE.INC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var n = array.length;\n  var l = k * (n - 1);\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTRANK = {};\n\nexports.PERCENTRANK.EXC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERCENTRANK.INC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERMUT = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);\n};\n\nexports.PERMUTATIONA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return Math.pow(number, number_chosen);\n};\n\nexports.PHI = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return error.value;\n  }\n  return Math.exp(-0.5 * x * x) / SQRT2PI;\n};\n\nexports.POISSON = {};\n\nexports.POISSON.DIST = function(x, mean, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  if (utils.anyIsError(x, mean)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean);\n};\n\nexports.PROB = function(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0;\n  }\n  upper = (upper === undefined) ? lower : upper;\n\n  range = utils.parseNumberArray(utils.flatten(range));\n  probability = utils.parseNumberArray(utils.flatten(probability));\n  lower = utils.parseNumber(lower);\n  upper = utils.parseNumber(upper);\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value;\n  }\n\n  if (lower === upper) {\n    return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\n  }\n\n  var sorted = range.sort(function(a, b) {\n    return a - b;\n  });\n  var n = sorted.length;\n  var result = 0;\n  for (var i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])];\n    }\n  }\n  return result;\n};\n\nexports.QUARTILE = {};\n\nexports.QUARTILE.EXC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.EXC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.EXC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.EXC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.QUARTILE.INC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.INC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.INC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.INC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.RANK = {};\n\nexports.RANK.AVG = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  range = utils.flatten(range);\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n\n  var length = range.length;\n  var count = 0;\n  for (var i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++;\n    }\n  }\n\n  return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n};\n\nexports.RANK.EQ = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n  return range.indexOf(number) + 1;\n};\n\nexports.ROW = function(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (index < 0) {\n    return error.num;\n  }\n\n  if (!(matrix instanceof Array) || (typeof index !== 'number')) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return undefined;\n  }\n\n  return jStat.row(matrix, index);\n};\n\nexports.ROWS = function(matrix) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\n\nexports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n  return Math.pow(exports.PEARSON(data_x, data_y), 2);\n};\n\nexports.SKEW = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3);\n  }\n  return n * sigma / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3));\n};\n\nexports.SKEW.P = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var m2 = 0;\n  var m3 = 0;\n  for (var i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3);\n    m2 += Math.pow(range[i] - mean, 2);\n  }\n  m3 = m3 / n;\n  m2 = m2 / n;\n  return m3 / Math.pow(m2, 3 / 2);\n};\n\nexports.SLOPE = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return num / den;\n};\n\nexports.SMALL = function(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function(a, b) {\n    return a - b;\n  })[k - 1];\n};\n\nexports.STANDARDIZE = function(x, mean, sd) {\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (x - mean) / sd;\n};\n\nexports.STDEV = {};\n\nexports.STDEV.P = function() {\n  var v = exports.VAR.P.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEV.S = function() {\n  var v = exports.VAR.S.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVA = function() {\n  var v = exports.VARA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVPA = function() {\n  var v = exports.VARPA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\n\nexports.STEYX = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var lft = 0;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2);\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return Math.sqrt((lft - num * num / den) / (n - 2));\n};\n\nexports.TRANSPOSE = function(matrix) {\n  if (!matrix) {\n    return error.na;\n  }\n  return jStat.transpose(matrix);\n};\n\nexports.T = text.T;\n\nexports.T.DIST = function (x, df, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  df = utils.parseNumber(df);\n  if (utils.anyIsError(x, df)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.studentt.cdf(x, df) : jStat.studentt.pdf(x, df);\n};\n\nexports.T.DIST['2T'] = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return (1 - jStat.studentt.cdf(x , df)) * 2;\n};\n\nexports.T.DIST.RT = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.studentt.cdf(x , df);\n};\n\nexports.T.INV = function (probability, df) {\n  // probability = utils.parseNumber(probability);\n  // df = utils.parseNumber(df);\n  // if (utils.anyIsError(probability, df)) {\n  //   return error.value;\n  // }\n  // var res = jStat.studentt.inv(probability, df);\n  // return res\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\nexports.T.INV['2T'] = function(probability, df) {\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nexports.T.TEST = function(data_x, data_y) {\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n\n  var mean_x = jStat.mean(data_x);\n  var mean_y = jStat.mean(data_y);\n  var s_x = 0;\n  var s_y = 0;\n  var i;\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2);\n  }\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2);\n  }\n\n  s_x = s_x / (data_x.length-1);\n  s_y = s_y / (data_y.length-1);\n\n  var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);\n\n  return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);\n};\n\nexports.TREND = function (data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  var linest = exports.LINEST(data_y, data_x);\n  var m = linest[0];\n  var b = linest[1];\n  return m * new_data_x + b\n};\n\nexports.TRIMMEAN = function (range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  percent = utils.parseNumber(percent);\n  if (utils.anyIsError(range, percent)) {\n    return error.value;\n  }\n  var trim = mathTrig.FLOORMATH(range.length * percent, 2) / 2;\n  return jStat.mean(utils.initial(utils.rest(range.sort(function (a, b) {\n    return a - b;\n  }), trim), trim));\n};\n\nexports.VAR = {};\n\nexports.VAR.P = function () {\n  var range = utils.numbers(utils.flatten(arguments));\n  if (range.length==0){\n    return error.value\n  }\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  if (isNaN(sigma / n)){\n    return error.value\n  }else{\n    return sigma / n;\n  }\n};\n\nexports.VAR.S = function() {\n  var range = utils.numbers(utils.flatten(arguments));\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  return sigma / (n - 1);\n};\n\nexports.VARA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / (count - 1);\n};\n\nexports.VARPA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / count;\n};\n\nexports.WEIBULL = {};\n\nexports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\n  //XW:\n  cumulative = utils.parseBool(cumulative)\n  //XWend\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value;\n  }\n  return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n};\n\nexports.Z = {};\n\nexports.Z.TEST = function (range, x, sd) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  x = utils.parseNumber(x);\n  if (utils.anyIsError(range, x)) {\n    return error.value;\n  }\n\n  sd = sd || exports.STDEV.S(range);\n  var n = range.length;\n  return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n};\n","var exp = require(\"../core/alphabet\");\nvar error = require('./formulajs/lib/error');\n\n\nfunction isEqual(v1, v2) {\n  v1 = v1 + \"\";\n  v2 = v2 + \"\";\n  v1 = v1.toUpperCase();\n  v2 = v2.toUpperCase();\n  if (v1 === v2) {\n    return true;\n  }\n  return false;\n}\n\nfunction isHave(param) {\n  if (typeof param === \"undefined\") {\n    return false;\n  }\n  if (param === null) {\n    return false;\n  }\n  return true;\n}\nclass CalcWorkBook { // workbook\n  constructor(rows, tileArr) {\n    this.rows = rows\n    this.tileArr = tileArr\n  }\n\n  // workbook\n  get_workbook(workbook){\n    let {data} = this.rows;\n    let name = data['name']\n    var need_calc_cells = this.tileArr.findAllNeedCalcCell()\n    for (var i=0;i<need_calc_cells.length;i++){\n      var cell_name = need_calc_cells[i]\n      var zb = exp.expr2xy(cell_name)\n      var cell = this.rows.getCell(zb[1], zb[0])\n      if(isHave(cell)){\n        workbook.Sheets[name][cell_name] = {v: cell.text, f: cell.formulas, multivalueRefsCell: cell.multivalueRefsCell, source_v: cell.source_v}\n      }\n    }\n    return workbook\n  }\n\n  //workbookrows\n  calcDoneToSetCells(workbook, rows) {\n    let {data} = rows;\n    let name = data['name']\n    var sheet = workbook.Sheets[name]\n    Object.keys(sheet).forEach(i => {\n      let arg = exp.expr2xy(i);\n      if (isHave(sheet[i]) && isHave(sheet[i].v) && isHave(sheet[i].f)) {\n        var cell = rows.getCell(arg[1], arg[0])\n        if (!isHave(cell)){\n          cell = {}\n        }\n        cell.text = sheet[i].v\n        cell.formulas = sheet[i].f\n        cell.multivalueRefsCell = sheet[i].multivalueRefsCell\n        if (isHave(sheet[i].source_v)){\n          cell.source_v = sheet[i].source_v\n        }\n        rows.setCell(arg[1], arg[0], cell);\n      }\n    });\n    rows.workbook = workbook\n  }\n\n  // \n  is_muti_cell(formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    if (multivalueRefsCell !== null) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    }\n    return isHave(multivalueRefsCell) ? true : false\n  }\n\n  //\n  process_arr(){\n\n  }\n\n\n  //\n  process_matrix(formulas_i, multivalueRefsCell){\n    let enter = true\n    var cell_v = formulas_i.cell.v\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    let cell = \"\", expr = 0;\n    var wb = formulas_i.sheet\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        var v = cell_v[i][j]\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": v,\n            \"f\": formulas_i.cell.f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          var source = this.rows.getCell( cell_y + j,  cell_x + i);\n          if (!isHave(source) || !isHave(source.text) || (isHave(source.text) && (isEqual(source.text, v) || source.text === \"\"))) {\n            wb[c] = {\n              \"v\": cell_v[i][j],\n              \"f\": cell_v[i][j],\n              'multivalueRefsCell': multivalueRefsCell\n            }\n          } else {\n            wb[c] = {\n              \"v\": source.v,\n              \"f\": source.f,\n              'multivalueRefsCell': multivalueRefsCell\n            }\n            enter = false;\n            cell = source;\n            expr = c;\n          }\n        }\n      }\n    }\n    if(!enter) {\n      return this.clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr)\n    }else{\n      return wb\n    }\n  }\n\n\n  //\n  clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr){\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": error.ref,\n            \"f\": wb[c].f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else if (expr === c) {\n          wb[c] = {\n            \"v\": cell.text,\n            \"f\": cell.formulas,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n  //\n  clean_all_flag(formulas_i, multivalueRefsCell){\n    var wb = formulas_i.sheet\n    var zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = zb[0]\n    var cell_y = zb[1]\n    var cell = this.rows.getCell(zb[1], zb[0])\n    var cell_v = cell.source_v\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": formulas_i.cell.v,\n            \"f\": formulas_i.cell.f,\n            \"source_v\": \"\"\n          }\n        } else if (this.rows.getCell(cell_y + j, cell_x + i).text !== cell_v[i][j]) {\n          wb[c] = {\n            \"v\": this.rows.getCell(cell_y + j, cell_x + i).text,\n            \"f\": this.rows.getCell(cell_y + j, cell_x + i).formulas,\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n\n  //\n  deal_muti_cell(workbook, formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    let {data} = this.rows;\n    let name = data['name']\n    if (isHave(multivalueRefsCell) && isHave(multivalueRefsCell.multivalueRefsCell)) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    } else {\n      multivalueRefsCell = formulas_i.name;\n    }\n    var cell_v = formulas_i.cell.v\n    if (formulas_i.name !== multivalueRefsCell){\n      if (cell_v instanceof Array){\n        workbook.Sheets[name][formulas_i.name].v = error.ref\n        workbook.Sheets[name][formulas_i.name].source_v = cell_v\n      }else if(isHave(cell_v)){\n        workbook.Sheets[name][formulas_i.name].v = cell_v\n      }\n    }else {\n      if(!(cell_v instanceof Array)) {\n        workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n      }else{\n        var zb = exp.expr2xy(multivalueRefsCell)\n        if (isHave(this.rows.getCell(zb[1], zb[0]).source_v) && this.rows.getCell(zb[1], zb[0]).source_v !== cell_v){\n          workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n        }\n        var len = cell_v.length\n        if (len === 1){\n          workbook.Sheets[name] = this.process_arr(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }else{\n          workbook.Sheets[name] = this.process_matrix(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CalcWorkBook;","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_need_calc_cell = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\nconst CalcCell = require('./CalcCell.js');\nconst checker = require('./formula_check.js');\nconst helper = require(\"../core/helper\")\nconst CalcWorkBook = require('./CalcWorkBook')\nvar mymodule = function(rows, tileArr) {\n    if (helper.isHave(tileArr)){\n        var Calc_WorkBook = new CalcWorkBook(rows, tileArr)\n        var workbook = rows.workbook\n        workbook = Calc_WorkBook.get_workbook(workbook)\n        var formulas = find_all_need_calc_cell(workbook, tileArr, exec_formula)\n        for (var i = formulas.length - 1; i >= 0; i--) {\n            try {\n                var calc_cell = new CalcCell(formulas[i], rows)\n                var valid_res = calc_cell.check_valid()\n                if (valid_res !== true){\n                    formulas[i].cell.v = valid_res\n                }else{\n                    //cellsheet({}'',default_0)\n                    formulas[i].cell.f = calc_cell.trans_formula()\n                    checker.trans_sheet(formulas[i].sheet)\n                    exec_formula(formulas[i]);\n                    formulas[i].cell.f = calc_cell.recover_formula()\n                    checker.recover_sheet(formulas[i].sheet)\n                }\n                //array\n                if (Calc_WorkBook.is_muti_cell(formulas[i]) || Array.isArray(formulas[i].cell.v)){\n                    Calc_WorkBook.deal_muti_cell(workbook, formulas[i])\n                }\n            } catch (e) {\n                console.log(e)\n            }\n        }\n        Calc_WorkBook.calcDoneToSetCells(workbook, rows)\n    }\n\n};\n\nmymodule.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nmymodule.set_fx = exec_formula.set_fx;\nmymodule.exec_fx = exec_formula.exec_fx;\nmymodule.col_str_2_int = col_str_2_int;\nmymodule.int_2_col_str = int_2_col_str;\nmymodule.import_functions = exec_formula.import_functions;\nmymodule.import_raw_functions = exec_formula.import_raw_functions;\nmymodule.xlsx_Fx = exec_formula.xlsx_Fx;\nmymodule.localizeFunctions = exec_formula.localizeFunctions;\n\nmymodule.XLSX_CALC = mymodule\n\nmodule.exports = mymodule;\n","var exp = require(\"../core/alphabet\");\nconst helper = require(\"../core/helper\");\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};\n\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};","var map = {\n\t\"./af\": 63,\n\t\"./af.js\": 63,\n\t\"./ar\": 64,\n\t\"./ar-dz\": 65,\n\t\"./ar-dz.js\": 65,\n\t\"./ar-kw\": 66,\n\t\"./ar-kw.js\": 66,\n\t\"./ar-ly\": 67,\n\t\"./ar-ly.js\": 67,\n\t\"./ar-ma\": 68,\n\t\"./ar-ma.js\": 68,\n\t\"./ar-sa\": 69,\n\t\"./ar-sa.js\": 69,\n\t\"./ar-tn\": 70,\n\t\"./ar-tn.js\": 70,\n\t\"./ar.js\": 64,\n\t\"./az\": 71,\n\t\"./az.js\": 71,\n\t\"./be\": 72,\n\t\"./be.js\": 72,\n\t\"./bg\": 73,\n\t\"./bg.js\": 73,\n\t\"./bm\": 74,\n\t\"./bm.js\": 74,\n\t\"./bn\": 75,\n\t\"./bn.js\": 75,\n\t\"./bo\": 76,\n\t\"./bo.js\": 76,\n\t\"./br\": 77,\n\t\"./br.js\": 77,\n\t\"./bs\": 78,\n\t\"./bs.js\": 78,\n\t\"./ca\": 79,\n\t\"./ca.js\": 79,\n\t\"./cs\": 80,\n\t\"./cs.js\": 80,\n\t\"./cv\": 81,\n\t\"./cv.js\": 81,\n\t\"./cy\": 82,\n\t\"./cy.js\": 82,\n\t\"./da\": 83,\n\t\"./da.js\": 83,\n\t\"./de\": 84,\n\t\"./de-at\": 85,\n\t\"./de-at.js\": 85,\n\t\"./de-ch\": 86,\n\t\"./de-ch.js\": 86,\n\t\"./de.js\": 84,\n\t\"./dv\": 87,\n\t\"./dv.js\": 87,\n\t\"./el\": 88,\n\t\"./el.js\": 88,\n\t\"./en-SG\": 89,\n\t\"./en-SG.js\": 89,\n\t\"./en-au\": 90,\n\t\"./en-au.js\": 90,\n\t\"./en-ca\": 91,\n\t\"./en-ca.js\": 91,\n\t\"./en-gb\": 92,\n\t\"./en-gb.js\": 92,\n\t\"./en-ie\": 93,\n\t\"./en-ie.js\": 93,\n\t\"./en-il\": 94,\n\t\"./en-il.js\": 94,\n\t\"./en-nz\": 95,\n\t\"./en-nz.js\": 95,\n\t\"./eo\": 96,\n\t\"./eo.js\": 96,\n\t\"./es\": 97,\n\t\"./es-do\": 98,\n\t\"./es-do.js\": 98,\n\t\"./es-us\": 99,\n\t\"./es-us.js\": 99,\n\t\"./es.js\": 97,\n\t\"./et\": 100,\n\t\"./et.js\": 100,\n\t\"./eu\": 101,\n\t\"./eu.js\": 101,\n\t\"./fa\": 102,\n\t\"./fa.js\": 102,\n\t\"./fi\": 103,\n\t\"./fi.js\": 103,\n\t\"./fo\": 104,\n\t\"./fo.js\": 104,\n\t\"./fr\": 105,\n\t\"./fr-ca\": 106,\n\t\"./fr-ca.js\": 106,\n\t\"./fr-ch\": 107,\n\t\"./fr-ch.js\": 107,\n\t\"./fr.js\": 105,\n\t\"./fy\": 108,\n\t\"./fy.js\": 108,\n\t\"./ga\": 109,\n\t\"./ga.js\": 109,\n\t\"./gd\": 110,\n\t\"./gd.js\": 110,\n\t\"./gl\": 111,\n\t\"./gl.js\": 111,\n\t\"./gom-latn\": 112,\n\t\"./gom-latn.js\": 112,\n\t\"./gu\": 113,\n\t\"./gu.js\": 113,\n\t\"./he\": 114,\n\t\"./he.js\": 114,\n\t\"./hi\": 115,\n\t\"./hi.js\": 115,\n\t\"./hr\": 116,\n\t\"./hr.js\": 116,\n\t\"./hu\": 117,\n\t\"./hu.js\": 117,\n\t\"./hy-am\": 118,\n\t\"./hy-am.js\": 118,\n\t\"./id\": 119,\n\t\"./id.js\": 119,\n\t\"./is\": 120,\n\t\"./is.js\": 120,\n\t\"./it\": 121,\n\t\"./it-ch\": 122,\n\t\"./it-ch.js\": 122,\n\t\"./it.js\": 121,\n\t\"./ja\": 123,\n\t\"./ja.js\": 123,\n\t\"./jv\": 124,\n\t\"./jv.js\": 124,\n\t\"./ka\": 125,\n\t\"./ka.js\": 125,\n\t\"./kk\": 126,\n\t\"./kk.js\": 126,\n\t\"./km\": 127,\n\t\"./km.js\": 127,\n\t\"./kn\": 128,\n\t\"./kn.js\": 128,\n\t\"./ko\": 129,\n\t\"./ko.js\": 129,\n\t\"./ku\": 130,\n\t\"./ku.js\": 130,\n\t\"./ky\": 131,\n\t\"./ky.js\": 131,\n\t\"./lb\": 132,\n\t\"./lb.js\": 132,\n\t\"./lo\": 133,\n\t\"./lo.js\": 133,\n\t\"./lt\": 134,\n\t\"./lt.js\": 134,\n\t\"./lv\": 135,\n\t\"./lv.js\": 135,\n\t\"./me\": 136,\n\t\"./me.js\": 136,\n\t\"./mi\": 137,\n\t\"./mi.js\": 137,\n\t\"./mk\": 138,\n\t\"./mk.js\": 138,\n\t\"./ml\": 139,\n\t\"./ml.js\": 139,\n\t\"./mn\": 140,\n\t\"./mn.js\": 140,\n\t\"./mr\": 141,\n\t\"./mr.js\": 141,\n\t\"./ms\": 142,\n\t\"./ms-my\": 143,\n\t\"./ms-my.js\": 143,\n\t\"./ms.js\": 142,\n\t\"./mt\": 144,\n\t\"./mt.js\": 144,\n\t\"./my\": 145,\n\t\"./my.js\": 145,\n\t\"./nb\": 146,\n\t\"./nb.js\": 146,\n\t\"./ne\": 147,\n\t\"./ne.js\": 147,\n\t\"./nl\": 148,\n\t\"./nl-be\": 149,\n\t\"./nl-be.js\": 149,\n\t\"./nl.js\": 148,\n\t\"./nn\": 150,\n\t\"./nn.js\": 150,\n\t\"./pa-in\": 151,\n\t\"./pa-in.js\": 151,\n\t\"./pl\": 152,\n\t\"./pl.js\": 152,\n\t\"./pt\": 153,\n\t\"./pt-br\": 154,\n\t\"./pt-br.js\": 154,\n\t\"./pt.js\": 153,\n\t\"./ro\": 155,\n\t\"./ro.js\": 155,\n\t\"./ru\": 156,\n\t\"./ru.js\": 156,\n\t\"./sd\": 157,\n\t\"./sd.js\": 157,\n\t\"./se\": 158,\n\t\"./se.js\": 158,\n\t\"./si\": 159,\n\t\"./si.js\": 159,\n\t\"./sk\": 160,\n\t\"./sk.js\": 160,\n\t\"./sl\": 161,\n\t\"./sl.js\": 161,\n\t\"./sq\": 162,\n\t\"./sq.js\": 162,\n\t\"./sr\": 163,\n\t\"./sr-cyrl\": 164,\n\t\"./sr-cyrl.js\": 164,\n\t\"./sr.js\": 163,\n\t\"./ss\": 165,\n\t\"./ss.js\": 165,\n\t\"./sv\": 166,\n\t\"./sv.js\": 166,\n\t\"./sw\": 167,\n\t\"./sw.js\": 167,\n\t\"./ta\": 168,\n\t\"./ta.js\": 168,\n\t\"./te\": 169,\n\t\"./te.js\": 169,\n\t\"./tet\": 170,\n\t\"./tet.js\": 170,\n\t\"./tg\": 171,\n\t\"./tg.js\": 171,\n\t\"./th\": 172,\n\t\"./th.js\": 172,\n\t\"./tl-ph\": 173,\n\t\"./tl-ph.js\": 173,\n\t\"./tlh\": 174,\n\t\"./tlh.js\": 174,\n\t\"./tr\": 175,\n\t\"./tr.js\": 175,\n\t\"./tzl\": 176,\n\t\"./tzl.js\": 176,\n\t\"./tzm\": 177,\n\t\"./tzm-latn\": 178,\n\t\"./tzm-latn.js\": 178,\n\t\"./tzm.js\": 177,\n\t\"./ug-cn\": 179,\n\t\"./ug-cn.js\": 179,\n\t\"./uk\": 180,\n\t\"./uk.js\": 180,\n\t\"./ur\": 181,\n\t\"./ur.js\": 181,\n\t\"./uz\": 182,\n\t\"./uz-latn\": 183,\n\t\"./uz-latn.js\": 183,\n\t\"./uz.js\": 182,\n\t\"./vi\": 184,\n\t\"./vi.js\": 184,\n\t\"./x-pseudo\": 185,\n\t\"./x-pseudo.js\": 185,\n\t\"./yo\": 186,\n\t\"./yo.js\": 186,\n\t\"./zh-cn\": 187,\n\t\"./zh-cn.js\": 187,\n\t\"./zh-hk\": 188,\n\t\"./zh-hk.js\": 188,\n\t\"./zh-tw\": 189,\n\t\"./zh-tw.js\": 189\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 245;","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","/* global document */\n\n/* global window */\nclass Element {\n    constructor(tag, className = '') {\n        if (typeof tag === 'string') {\n            this.el = document.createElement(tag);\n            this.el.className = className;\n        } else {\n            this.el = tag;\n        }\n        this.data = {};\n    }\n\n    data(key, value) {\n        if (value !== undefined) {\n            this.data[key] = value;\n            return this;\n        }\n        return this.data[key];\n    }\n\n    on(eventNames, handler) {\n        const [fen, ...oen] = eventNames.split('.');\n        let eventName = fen;\n        if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n            eventName = 'DOMMouseScroll';\n        }\n        this.el.addEventListener(eventName, (evt) => {\n            handler(evt);\n            for (let i = 0; i < oen.length; i += 1) {\n                const k = oen[i];\n                if (k === 'left' && evt.button !== 0) {\n                    return;\n                }\n                if (k === 'right' && evt.button !== 2) {\n                    return;\n                }\n                if (k === 'stop') {\n                    evt.stopPropagation();\n                }\n            }\n        });\n        return this;\n    }\n\n    offset(value) {\n        if (value !== undefined) {\n            Object.keys(value).forEach((k) => {\n                this.css(k, `${value[k]}px`);\n            });\n            return this;\n        }\n        const {\n            offsetTop, offsetLeft, offsetHeight, offsetWidth,\n        } = this.el;\n        return {\n            top: offsetTop,\n            left: offsetLeft,\n            height: offsetHeight,\n            width: offsetWidth,\n        };\n    }\n\n    scroll(v) {\n        const {el} = this;\n        if (v !== undefined) {\n            if (v.left !== undefined) {\n                el.scrollLeft = v.left;\n            }\n            if (v.top !== undefined) {\n                el.scrollTop = v.top;\n            }\n        }\n\n        return {left: el.scrollLeft, top: el.scrollTop};\n    }\n\n    box() {\n        return this.el.getBoundingClientRect();\n    }\n\n    parent() {\n        return new Element(this.el.parentNode);\n    }\n\n    children(...eles) {\n        if (arguments.length === 0) {\n            return this.el.childNodes;\n        }\n        eles.forEach(ele => this.child(ele));\n        return this;\n    }\n\n    /*\n    first() {\n      return this.el.firstChild;\n    }\n\n    last() {\n      return this.el.lastChild;\n    }\n\n    remove(ele) {\n      return this.el.removeChild(ele);\n    }\n\n    prepend(ele) {\n      const { el } = this;\n      if (el.children.length > 0) {\n        el.insertBefore(ele, el.firstChild);\n      } else {\n        el.appendChild(ele);\n      }\n      return this;\n    }\n\n    prev() {\n      return this.el.previousSibling;\n    }\n\n    next() {\n      return this.el.nextSibling;\n    }\n    */\n\n    child(arg) {\n        let ele = arg;\n        if (typeof arg === 'string') {\n            ele = document.createTextNode(arg);\n        } else if (arg instanceof Element) {\n            ele = arg.el;\n        }\n        this.el.appendChild(ele);\n\n        return this;\n    }\n\n    contains(ele) {\n        return this.el.contains(ele);\n    }\n\n    className(v) {\n        if (v !== undefined) {\n            this.el.className = v;\n            return this;\n        }\n        return this.el.className;\n    }\n\n    addClass(name) {\n        this.el.classList.add(name);\n        return this;\n    }\n\n    hasClass(name) {\n        return this.el.classList.contains(name);\n    }\n\n    removeClass(name) {\n        this.el.classList.remove(name);\n        return this;\n    }\n\n    toggle(cls = 'active') {\n        return this.toggleClass(cls);\n    }\n\n    toggleClass(name) {\n        return this.el.classList.toggle(name);\n    }\n\n    active(flag = true, cls = 'active') {\n        if (flag) this.addClass(cls);\n        else this.removeClass(cls);\n        return this;\n    }\n\n    checked(flag = true) {\n        this.active(flag, 'checked');\n        return this;\n    }\n\n    disabled(flag = true) {\n        if (flag) this.addClass('disabled');\n        else this.removeClass('disabled');\n        return this;\n    }\n\n    // key, value\n    // key\n    // {k, v}...\n    attr(key, value) {\n        if (value !== undefined) {\n            this.el.setAttribute(key, value);\n        } else {\n            if (typeof key === 'string') {\n                return this.el.getAttribute(key);\n            }\n            Object.keys(key).forEach((k) => {\n                this.el.setAttribute(k, key[k]);\n            });\n        }\n        return this;\n    }\n\n    removeAttr(key) {\n        this.el.removeAttribute(key);\n        return this;\n    }\n\n    html(content) {\n        if (content !== undefined) {\n            this.el.innerHTML = content;\n            return this;\n        }\n        return this.el.innerHTML;\n    }\n\n    val(v) {\n        if (v !== undefined) {\n            this.el.value = v;\n            return this;\n        }\n        return this.el.value;\n    }\n\n    cssRemoveKeys(...keys) {\n        keys.forEach(k => this.el.style.removeProperty(k));\n        return this;\n    }\n\n    // css( propertyName )\n    // css( propertyName, value )\n    // css( properties )\n    css(name, value) {\n        if (value === undefined && typeof name !== 'string') {\n            Object.keys(name).forEach((k) => {\n                this.el.style[k] = name[k];\n            });\n            return this;\n        }\n        if (value !== undefined) {\n            this.el.style[name] = value;\n            return this;\n        }\n        return this.el.style[name];\n    }\n\n    removeEl() {\n        if (!this.el || !this.el.parentNode) {\n            return;\n        }\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    computedStyle() {\n        return window.getComputedStyle(this.el, null);\n    }\n\n    isShow() {\n        return this.el.style['display'] === 'block';\n    }\n\n    show(key = 'display', text = 'block') {\n        this.css(key, text);\n        return this;\n    }\n\n    hide(key = 'display', value = 'none') {\n        this.css(key, value);\n        return this;\n    }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n    Element,\n    h,\n};\n","/* global window */\nimport en from './en';\n\nlet $lang = 'en';\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages && messages[$lang]) {\n        let message = messages[$lang];\n        const keys = key.split('.');\n        for (let i = 0; i < keys.length; i += 1) {\n            const property = keys[i];\n            const value = message[property];\n            if (i === keys.length - 1) return value;\n            if (!value) return undefined;\n            message = value;\n        }\n    }\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x && window.x.spreadsheet && window.x.spreadsheet.$messages) {\n        v = translate(key, window.x.spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\nfunction locale(lang, message) {\n    $lang = lang;\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        font: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        textColor: 'Text color',\n        fillColor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        add: 'display equation',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n        flexible: 'Flexible',\n        throwFormula: 'Throw formulas',\n        comeBack: 'come back',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        insertRow: 'Insert row',\n        insertColumn: 'Insert column',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        recover: 'recover',\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    date_formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        concat: 'Concat',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","/**\n formulas:\n key\n title\n render\n */\nimport {tf} from '../locale/locale';\nimport XLSX_CALC from \"../calc\"\nlet formulajs = require('../calc/formulajs/index'); // jobs: todo: 3formulajs\nconst baseFormulas = [\n    {\n        key: 'MD.WLAND',\n        title: tf('formula.wland'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.WFR',\n        title: tf('formula.wfr'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.RTD',\n        title: tf('formula.rtd'),\n        render: ary => ary.join(''),\n    },\n];\n\nlet formulas = deepCopy(baseFormulas);\n\nconst formulaCalc = () => {\n    XLSX_CALC.import_functions(formulajs);\n    let xlsx_Fx = XLSX_CALC.xlsx_Fx;\n    formulas = deepCopy(baseFormulas);\n    Object.keys(xlsx_Fx).forEach(i => {\n        let args = {\n            key: i,\n            title: i,\n            render: xlsx_Fx[i]\n        };\n        formulas.push(args);\n    });\n\n\n    return XLSX_CALC;\n};\n\nfunction deepCopy(obj) {\n    let result = Array.isArray(obj) ? [] : {};\n    for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n                result[key] = deepCopy(obj[key]);\n            } else {\n                result[key] = obj[key];\n            }\n        }\n    }\n    return result;\n}\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n    formulaCalc,\n};\n","import {expr2xy, xy2expr} from './alphabet';\n\nclass CellRange {\n    constructor(sri, sci, eri, eci, w = 0, h = 0) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n        this.w = w;\n        this.h = h;\n    }\n\n    set(sri, sci, eri, eci) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    multiple() {\n        return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n    }\n\n    // cell-index: ri, ci\n    // cell-ref: A10\n    includes(...args) {\n        let [ri, ci] = [0, 0];\n        if (args.length === 1) {\n            [ci, ri] = expr2xy(args[0]);\n        } else if (args.length === 2) {\n            [ri, ci] = args;\n        }\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n    }\n\n    each(cb, rowFilter = () => true) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        for (let i = sri; i <= eri; i += 1) {\n            if (rowFilter(i)) {\n                for (let j = sci; j <= eci; j += 1) {\n                    cb(i, j);\n                }\n            }\n        }\n    }\n\n    // 1 * n  /  n * 1 / n * n\n    getType() {\n        let {\n            sri, sci, eri, eci,\n        } = this;\n\n        if(sri === eri && sci !== eci) {\n            return 1;\n        } else if(sri !== eri && sci === eci) {\n            return 2;\n        } else if(sri !== eri && sci !== eci) {\n            return 3;\n        } else if(sri === eri && sci === eci) {\n            return 1;\n        }\n\n        console.error(\"\");\n        return 4;\n    }\n\n    // each2(cb, rowFilter = () => true) {\n    //     let {\n    //         sri, sci, eri, eci,\n    //     } = this;\n    //     let extraRiValue = eri;\n    //     let extraCiValue = eci;\n    //\n    //     if (sri - extraRiValue <= 0) {\n    //         sri = 0;\n    //     } else {\n    //         sri = sri - extraRiValue;\n    //     }\n    //\n    //     if (sci - extraCiValue <= 0) {\n    //         sci = 0;\n    //     } else {\n    //         sci = sci - extraCiValue;\n    //     }\n    //\n    //     for (let i = sri; i <= eri + extraRiValue; i += 1) {\n    //         if (rowFilter(i)) {\n    //             for (let j = sci; j <= eci + extraCiValue; j += 1) {\n    //                 cb(i, j, eri, eci);\n    //             }\n    //         }\n    //     }\n    // }\n\n    // eachGivenRange(cb, mri, mci) {\n    //     let sri = 0;\n    //     let sci = 0;\n    //     let eri = mri;\n    //     let eci = mci;\n    //\n    //     for (let i = sri; i <= eri; i += 1) {\n    //         for (let j = sci; j <= eci; j += 1) {\n    //             cb(i, j, eri, eci);\n    //         }\n    //     }\n    // }\n\n    move(ri, ci) {\n        let d = this.eri - this.sri;        //   \n        let d2 = this.eci - this.sci;            //   \n        this.sri = ri;\n        this.sci = ci;\n        this.eri = this.sri + d;\n        this.eci = this.sci + d2;\n    }\n\n    move2(ri, ci, eri, eci) {\n        this.sri = ri;\n        this.sci = ci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    contains(other) {\n        return this.sri <= other.sri\n            && this.sci <= other.sci\n            && this.eri >= other.eri\n            && this.eci >= other.eci;\n    }\n\n    // within\n    within(other) {\n        return this.sri >= other.sri\n            && this.sci >= other.sci\n            && this.eri <= other.eri\n            && this.eci <= other.eci;\n    }\n\n    // disjoint\n    disjoint(other) {\n        return this.sri > other.eri\n            || this.sci > other.eci\n            || other.sri > this.eri\n            || other.sci > this.eci;\n    }\n\n    // intersects\n    intersects(other) {\n        return this.sri <= other.eri\n            && this.sci <= other.eci\n            && other.sri <= this.eri\n            && other.sci <= this.eci;\n    }\n\n    getMovePos(ri, ci) {\n        let {sri, sci, eri, eci} = this;\n\n        let pos = 0;\n        if (ri > eri && ci > eci) {\n            pos = 1;        // \n        } else if(ri > eri && ci < sci) {\n            pos = 7;        // \n        } else if(ri < sri && ci > eci) {\n            pos = 8;        // \n        } else if(ci < sci && ri < sri) {\n            pos = 4;        // \n        } else if(ri > eri) {\n            pos = 2;        // \n        } else if(ci > eci) {\n            pos = 3;        // \n        }  else if(ci < sci) {\n            pos = 5;        // \n        } else if(ri < sri) {\n            pos = 6;        // \n        }\n\n        return pos;\n    }\n\n    // union\n    union(other) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return new CellRange(\n            other.sri < sri ? other.sri : sri,\n            other.sci < sci ? other.sci : sci,\n            other.eri > eri ? other.eri : eri,\n            other.eci > eci ? other.eci : eci,\n        );\n    }\n\n    // intersection\n    // intersection(other) {}\n\n    // Returns Array<CellRange> that represents that part of this that does not intersect with other\n    // difference\n    difference(other) {\n        const ret = [];\n        const addRet = (sri, sci, eri, eci) => {\n            ret.push(new CellRange(sri, sci, eri, eci));\n        };\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        const dsr = other.sri - sri;\n        const dsc = other.sci - sci;\n        const der = eri - other.eri;\n        const dec = eci - other.eci;\n        if (dsr > 0) {\n            addRet(sri, sci, other.sri - 1, eci);\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, eci);\n                if (dsc > 0) {\n                    addRet(other.sri, sci, other.eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, other.eri, eci);\n                }\n            } else {\n                if (dsc > 0) {\n                    addRet(other.sri, sci, eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, eri, eci);\n                }\n            }\n        } else if (der > 0) {\n            addRet(other.eri + 1, sci, eri, eci);\n            if (dsc > 0) {\n                addRet(sri, sci, other.eri, other.sci - 1);\n            }\n            if (dec > 0) {\n                addRet(sri, other.eci + 1, other.eri, eci);\n            }\n        }\n        if (dsc > 0) {\n            addRet(sri, sci, eri, other.sci - 1);\n            if (dec > 0) {\n                addRet(sri, other.eri + 1, eri, eci);\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, other.eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, other.eci);\n                }\n            } else {\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, eci);\n                }\n            }\n        } else if (dec > 0) {\n            addRet(eri, other.eci + 1, eri, eci);\n            if (dsr > 0) {\n                addRet(sri, sci, other.sri - 1, other.eci);\n            }\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, other.eci);\n            }\n        }\n        return ret;\n    }\n\n    size() {\n        return [\n            this.eri - this.sri + 1,\n            this.eci - this.sci + 1,\n        ];\n    }\n\n    toString() {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        let ref = xy2expr(sci, sri);\n        if (this.multiple()) {\n            ref = `${ref}:${xy2expr(eci, eri)}`;\n        }\n        return ref;\n    }\n\n    includeByRiCi(ri, ci) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n\n        return sri <= ri && eri >= ri && sci <= ci && eci >= ci;\n    }\n\n    // clone() {\n    //     const {\n    //         sri, sci, eri, eci, w, h,\n    //     } = this;\n    //     return new CellRange(sri, sci, eri, eci, w, h);\n    // }\n\n    getLocationArray(sarr) {\n        let darr = [];\n        let index = 0;\n        this.each((i, j) => {\n            darr.push({ri: i, ci: j, v: sarr[index % sarr.length].tmp, type: sarr[index % sarr.length].type});\n            index = index + 1;\n        });\n\n        return darr;\n    }\n\n    /*\n    toJSON() {\n      return this.toString();\n    }\n    */\n\n    equals(other) {\n        return this.eri === other.eri\n            && this.eci === other.eci\n            && this.sri === other.sri\n            && this.sci === other.sci;\n    }\n\n    static valueOf(ref) {\n        // B1:B8, B1 => 1 x 1 cell range\n        const refs = ref.split(':');\n        const [sci, sri] = expr2xy(refs[0]);\n        let [eri, eci] = [sri, sci];\n        if (refs.length > 1) {\n            [eci, eri] = expr2xy(refs[1]);\n        }\n        return new CellRange(sri, sci, eri, eci);\n    }\n}\n\nexport default CellRange;\n\nexport {\n    CellRange,\n};\n","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  // isCopy() {\n  //   return this.state === 'copy';\n  // }\n  //\n  // isCut() {\n  //   return this.state === 'cut';\n  // }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    // vlength() {\n    //     const {operator, value} = this;\n    //     if (operator === 'in') {\n    //         return value.length;\n    //     }\n    //     return 0;\n    // }\n\n    getData() {\n\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n\n        this.flex = [];\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.fitlers = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    addFiexRows(args) {\n        this.flex = args;\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSet(exceptRowSet, rir) {\n        for (let ix = 0; ix < this.flex.length; ix++) {\n            let {ri,   set_total, state} = this.flex[ix];\n            for (let i = ri; i < set_total + ri; i++) {\n                console.log(state, \"114\", rir, ri, state);\n                if (state === false && rir === ri) {\n                    exceptRowSet.add(i + 1);\n                    this.flex[ix].state = true;\n                } else if (state === true && rir === ri) {\n                    exceptRowSet.delete(i + 1);\n                    this.flex[ix].state = false;\n                }\n            }\n        }\n\n        return exceptRowSet;\n    }\n\n    includes2(rir, cic) {\n        let b = false;\n\n        for (let i = 0; i < this.flex.length; i++) {\n            let {ri, ci} = this.flex[i];\n            if (rir === ri && cic === ci) {\n                b = true;\n            }\n        }\n\n        return b;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    m[key] = (m[key] || 0) + 1;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  each(cb) {\n      this._.forEach(it => cb(it));\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri >= index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    return this;\n  }\n\n  getData() {\n    return this._.map(merge => merge.toString());\n  }\n}\n\nexport {\n  Merges,\n};\n","const recast = require(\"recast\");\n\nconst colon = \"$$$\";\nconst fqm = '';\nconst exclamationPoint = \"\";\nconst braceLeft = \"\";\nconst braceRight = \"\";\n\nexport default class Recast {\n    constructor(formula) {\n        this.formula = formula;\n        this.ast = \"\";\n    }\n    preProcess() {\n        this.formula = this.formula.replace(/=/g, '');\n        this.formula = this.formula.replace(/:/g, colon);\n        this.formula = this.formula.replace(/\"\"\"\"/g, fqm);\n        this.formula = this.formula.replace(/!/g, exclamationPoint);\n        this.formula = this.formula.replace(/{/g, braceLeft);\n        this.formula = this.formula.replace(/}/g, braceRight);\n        this.formula = this.formula.replace(/#/g, '');\n        this.formula = this.formula.replace(/\\./g, 'a');\n        this.formula = this.formula.replace(/[0-9][0-9]*/g, 'a');\n        this.formula = this.formula.replace(/\\/g, '\"');\n        this.formula = this.formula.replace(/\\/g, '(');\n        this.formula = this.formula.replace(/\\/g, ')');\n        this.formula = this.formula.replace(/\\/g, '\"');\n        this.formula = this.formula.replace(/\\%/g, '');\n        this.formula = this.formula.replace(/\\,/g, '');\n        this.formula = this.formula.replace(/\\/g, '');\n        this.formula = this.formula.replace(/\"([\\s\\S]{1,})\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"\"/, \"\")\n    }\n\n    parse() {\n        this.preProcess();\n        let {formula} = this;\n        this.ast = recast.parse(formula);\n    }\n\n    ignoreSpace() {\n\n    }\n}","import CellRange from \"./cell_range\";\n\nexport default class PasteProxy {\n    constructor() {\n        this.srcCellRange = \"\";\n        this.dstCellRange = \"\";\n        this.srcOneDRange = \"\";\n        this.dstOneDRange = \"\";\n    }\n\n    setSrcAndDstCellRange(srcCellRange, dstCellRange) {\n        this.srcCellRange = srcCellRange;\n        this.dstCellRange = dstCellRange;\n    }\n\n    use() {\n        let {srcCellRange, dstCellRange} = this;\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n\n        return {\n            sri, sci, eri, eci, dsri, dsci, deri, deci, rn, cn, drn, dcn\n        }\n    }\n\n    autoFilterDirection() {\n        let {sri, dsri, deri, eri} = this.use();\n\n        let isLeftRight = false; //   falsetrue\n        if (sri === dsri && deri === eri) {\n            isLeftRight = true;\n        }\n\n        return isLeftRight;\n    }\n\n    upOrDown() {\n        let {deri, sri, deci, sci,} = this.use();\n        let isDown = true;       // false, true     // isDown\n        if (deri < sri || deci < sci) {\n            isDown = false;\n        }\n\n        return isDown;\n    }\n\n    leftOrRight() {\n        let {\n            srcOneDRange,\n            dstOneDRange\n        } = this.getRangeByWay();\n\n        let line = 1;       // \n        if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci > srcOneDRange.eci) {\n            line = 2;       // \n        } else if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci < srcOneDRange.eci) {\n            line = 3;       // \n        }\n        return line;\n    }\n\n    getOneDRangeObj(way, offset) {\n        let {sri, sci, eri, eci, dsri, dsci, deri, deci} = this.use();\n\n        if (!way) {\n            this.srcOneDRange = new CellRange(sri, sci + offset, eri, sci + offset);\n            this.dstOneDRange = new CellRange(dsri, dsci + offset, deri, dsci + offset);\n        } else {\n            this.srcOneDRange = new CellRange(sri + offset, sci, sri + offset, eci);\n            this.dstOneDRange = new CellRange(dsri + offset, dsci, dsri + offset, deci);\n        }\n\n        return this.getRangeByWay();\n    }\n\n    getRangeByWay() {\n        return {\n            \"srcOneDRange\": this.srcOneDRange,\n            \"dstOneDRange\": this.dstOneDRange\n        }\n    }\n\n    // todo \n    // isCopy(sarr, i) {\n    //     let {sri, sci, eri} = this.use();\n    //     let isCopy = false;\n    //     if (sarr.length > 1) {\n    //         isCopy = true;\n    //     }\n    //     if (sri === eri && sci + i === sci + i) {\n    //         isCopy = true;\n    //     }\n    //\n    //     return isCopy;\n    // }\n\n    calcDiff(sarr, isAdd) {\n        let diffValue = 1;\n\n        if (!isAdd) {\n            diffValue = 1;\n        }\n\n        if (isAdd && sarr.length > 1) {\n            let last2 = sarr[sarr.length - 2];\n            let last1 = sarr[sarr.length - 1];\n            diffValue = last1.text * 1 - last2.text * 1;\n        } else if (sarr.length > 1) {\n            let last2 = sarr[1];\n            let last1 = sarr[0];\n            diffValue = last1.text * 1 - last2.text * 1;\n        }\n\n        if(isNaN(diffValue)) {\n            diffValue = 1;\n        }\n\n        return diffValue;\n    }\n}","import {isHave} from \"./helper\";\nimport {isFormula} from \"./row\";\nimport {datePattern2, str2Re} from \"../utils/reg_pattern\";\n\nexport default class CellProxy {\n    constructor(cell) {\n        this.cell = cell;\n    }\n\n    renderFormat(style, nrindex, cindex, data, filter) {\n        if(isHave(style) === false || isHave(style.format) === false) {\n            return {\n                \"cellText\": \"\",\n                \"state\": false,\n            };\n        }\n\n        let {cell} = this;\n        let cellText = \"\";\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            let formatInfo = data.tryParseToNum(cell, nrindex, cindex);\n            if(formatInfo.state) {\n                if(filter) {\n                    if((formatInfo.style === 'date' || formatInfo.style === 'datetime')) {\n                        cellText = formatInfo.text;\n                    } else {\n                        formatInfo.state = false;\n                    }\n                }  else {\n                    cellText = formatInfo.text;\n                }\n            } else {\n                if( isHave(cell.text) === false) {\n                    cell.text = \"\";\n                }\n                cellText = cell.text;\n            }\n            return {\n                \"cellText\": cellText,\n                \"state\": formatInfo.state,\n            };\n        }\n        return {\n            \"cellText\": cellText,\n            \"state\": false,\n        };\n    }\n\n    getCellDataType(sarr, {isDate, isNumber}) {\n        let ncell = this.cell;\n        // let enter = false;\n        let nA = true;\n\n\n        if (!isHave(ncell.formulas)) {\n            ncell.formulas = \"\";\n        }\n        if (!isHave(ncell.text)) {\n            ncell.text = \"\";\n        }\n\n        let value = ncell.formulas !== \"\" ? ncell.formulas + \"\" : ncell.text + \"\";\n        // value = value.replace(/,/g, \"\").replace(\"=\", \"\");\n        value = value.replace(/,/g, \"\");        // =123 =\n        let ns = value * 1;\n\n        if ((ns || ns === 0) && typeof ns === 'number' && !isNaN(ns) && /^\\d+$/.test(value) === true) {\n            if(isNumber === true) {\n                isNumber = true;\n                nA = false;\n                isDate = false;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'number';\n        } else if (value && nA === true && isFormula(value)) {\n            nA = true;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'na';\n        } else if (value && value.search(str2Re(datePattern2), '') !== -1) {\n            if( isDate === true) { // jobs: todo: \n                nA = false;\n                isNumber = false;\n                isDate = true;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'date';\n        } else {//\n            nA = false;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'other';\n        }\n        ncell.tmp = value;\n        sarr.push(ncell);\n\n        return {\n            nA, isDate: isDate, isNumber: isNumber\n        }\n    }\n}\n","import {isHave} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\n\nexport default class CellProp {\n    constructor(ri, ci, cell, expr, empty) {\n        this.ri = ri;\n        this.ci = ci;\n        this.cell = cell;\n        this.expr = expr;\n        this.empty = empty;\n    }\n\n    isInclude() {\n\n    }\n\n\n    each(cb) {\n        let {cell} = this;\n        if(isHave(cell.depend) === false) {\n            return;\n        }\n        for(let i = 0; i < cell.depend.length; i++) {\n            let expr = cell.depend[i];\n            let [ci, ri] = expr2xy(expr);\n            cb(ri, ci);\n        }\n    }\n}","import {isHave} from \"../core/helper\";\n\n\n/**\n * Cell\n */\nexport default class Cell {\n    /**\n     * @constructor\n     * @param text - \n     * @param formulas - \n     * @param style - , null,\n     * @param depend - \n     * @param merge - null\n     * @param formatText - null\n     * @param multivalueRefsCell - \n     */\n    constructor() {\n        this.text = \"\";\n        this.depend = [];\n        this.formulas = \"\";\n\n        this.style = null;\n        this.merge = null;\n        this.formatText = null;\n        this.multivalueRefsCell = null;\n        this.source_v = null;\n    }\n\n    /**\n     * \n     */\n    setCell(cell) {\n        if (!isHave(cell)) {\n            return;\n        }\n\n        if (isHave(cell.text)) {\n            this.text = cell.text;\n        }\n\n        if (isHave(cell.formulas)) {\n            this.formulas = cell.formulas;\n        }\n\n        if(isHave(cell.formatText)) {\n            this.formatText = cell.formatText;\n        }\n\n        if (isHave(cell.depend)) {\n            this.depend = cell.depend;\n        }\n\n        if (isHave(cell.style)) {\n            this.style = cell.style;\n        }\n\n        if (isHave(cell.multivalueRefsCell)) {\n            this.multivalueRefsCell = cell.multivalueRefsCell;\n        }\n\n        if (isHave(cell.merge)) {\n            this.merge = cell.merge;\n        }\n\n        if (isHave(cell.source_v)) {\n            this.source_v = cell.source_v;\n        }\n    }\n\n    /**\n     * \n     * @param args args.state truefalse, text \n     */\n    setFormatText(args) {\n        if(args.state) {\n            this.formatText = args.text;\n        }\n    }\n}","import helper, {isHave} from './helper';\nimport {xy2expr} from './alphabet';\nimport {changeFormula, cutStr, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport dayjs from 'dayjs'\nimport {deepCopy, distinct, isSheetVale, splitStr} from \"./operator\";\nimport Recast from \"./recast\";\nimport PasteProxy from \"./paste_proxy\";\nimport CellProxy from \"./cell_proxy\";\nimport CellRange from \"./cell_range\";\nimport CellProp from \"../model/cell_prop\";\nimport Cell from \"../model/cell\";\nlet calcUtils = require('../calc/utils');\n\nexport function isFormula(text) {\n    // if (text && text[0] === \"=\") {\n    //     return true;\n    // }\n\n    return text && text[0] === \"=\";\n}\n\nfunction isEmpty(text, formulas, formatText) {\n    if(isHave(text) && text !== \"\") {\n        return false;\n    }\n\n    if(isHave(formulas) && formulas !== \"\") {\n        return false;\n    }\n\n    // if(isHave(formatText)) {\n    //     return false;\n    // }\n\n    return !isHave(formatText);\n}\n\nfunction otherAutoFilter(d, darr, direction, isAdd, what, cb, other, dri) {\n    // other  '=asd''asd'false\n    let ncell = this.getCellByTopCell(d, direction, isAdd, 'other', dri, 0);\n\n    let {text, formulas} = ncell;\n    let iText = formulas !== \"\" ? formulas : text;\n\n    // if (other) {\n    //     this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    // } else\n    if (this.isFormula(iText)) {\n        this.calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb);\n    } else {\n        //  '=asd''asd' \n        this.calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text);\n    }\n}\n\nfunction numberAutoFilter(d, darr, direction, isAdd, diffValue, what, cb, isNumber) {\n    let ncell = \"\";\n\n    if (isAdd) {\n        diffValue = Math.abs(diffValue);\n    } else {\n        diffValue = diffValue * -1;\n    }\n\n    if (!isNumber) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diffValue = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isAdd);\n    }\n\n    this.calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb);\n}\n\nfunction dateAutoFilter(d, line, isDown, darr, what, cb, isDate) {\n    let direction = line;\n    let ncell = \"\";\n    let diff = isDown ? 1 : -1;\n    if (!isDate) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diff = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isDown, 'date');\n    }\n    this.calcDateCellByTopCell(ncell, darr, d, isDown, what, cb, diff);\n}\n\nclass Rows {\n    constructor({len, height}, data = \"\") {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n        this.data = data;\n        this.pasteProxy = new PasteProxy();\n        this.workbook = null;\n    }\n\n    getHeight(ri) {\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined\n            && (isHave(row.cells[ci].text) || isHave(row.cells[ci].formulas) || isHave(row.cells[ci].style || typeof row.cells[ci] === 'object'))) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    toString(text) {\n        if (isHave(text) === false) {\n            text = \"\";\n        }\n        return text + \"\";\n    }\n\n    isBackEndFunc(text) {\n        // if (text.indexOf(\"MD.RTD\") !== -1) {\n        //     return true;\n        // }\n\n        return text.indexOf(\"MD.RTD\") !== -1;\n    }\n\n    isReferOtherSheet(cell, state = false) {\n        return cell.formulas && cell.formulas[0] === \"=\" && (state || isSheetVale(cell.formulas));\n    }\n\n    isEmpty(cell) {\n\n        return cell && (cell.text || cell.formulas || cell.depend);\n    }\n\n    isFormula(text) {\n        return isFormula(text);\n    }\n\n    setValue(type, value, cell) {\n        cell[type] = value;\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        let {data} = this;\n        const row = this.getOrNew(ri);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        if (what === 'all') {\n            row.cells[ci] = _cell;\n        } else if(what === 'formulas') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].formulas = _cell.formulas;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = _cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = _cell.style;\n            if (cell.merge) row.cells[ci].merge = _cell.merge;\n        } else if (what === 'date' || what === 'datetime') {\n            // row.cells[ci] = {};\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n            row.cells[ci].to_calc_num = _cell.to_calc_num;\n        } else if (what === 'normal' || what === 'number') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            // row.cells[ci].value = cell.value;\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'rmb' || what === 'percent') {        // rmb  text123, formalus 123,123\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].formulas = _cell.formulas;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'all_with_no_workbook') {\n            row.cells[ci] = _cell;\n\n            return;\n        } else if (what === 'style') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {};\n            }\n\n            row.cells[ci].style = _cell.style;\n            return;\n        }\n        // cell\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n        _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n    }\n\n    getDependCell(expr, cell) {\n        let {formulas} = cell;\n        if (isHave(formulas) === false) {\n            return;\n        }\n        if (isFormula(formulas)) {\n            let arr = cutStr(formulas, true, true);\n\n            for (let i = 0; i < arr.length; i++) {\n                let args = this.mergeCellExpr(arr[i]);\n                if (args.state) {\n                    arr.push(...args.mergeArr);\n                }\n            }\n            arr = distinct(arr);\n\n            if (isHave(cell.depend) === false) {\n                cell.depend = [];\n            }\n            for (let i = 0; i < arr.length; i++) {\n                let ref = arr[i];\n                let [ci, ri] = expr2xy(ref);\n                let refCell = this.getCell(ri, ci);\n                if (isHave(refCell) === false) {\n                    refCell = {};\n                }\n\n                if (isHave(refCell.depend) === false) {\n                    refCell.depend = [];\n                }\n                refCell.depend.push(expr);\n                refCell.depend = distinct(refCell.depend);\n                this.setCell(ri, ci, refCell, 'all_with_no_workbook');\n            }\n        }\n    }\n\n    mergeCellExpr(d) {\n        if (!isAbsoluteValue(d, 6)) {\n            return {\n                \"state\": false,\n            }\n        }\n        d = d.replace(/\\$/g, '');\n        d = d.split(\":\");\n        let e1 = expr2xy(d[0]);\n        let e2 = expr2xy(d[1]);\n\n        if (e1[0] > e2[0]) {\n            let t = e2[0];\n            e2[0] = e1[0];\n            e1[0] = t;\n        }\n        if (e1[1] > e2[1]) {\n            let t = e2[1];\n            e2[1] = e1[1];\n            e1[1] = t;\n        }\n        let cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0]);\n        let arr = [];\n        cellRange.each((i, j) => {\n            arr.push(xy2expr(j, i));\n        });\n\n        return {\n            \"state\": true,\n            \"mergeArr\": arr,\n        };\n    }\n\n    useOne(param, other, value = true) {\n        if (isHave(param) === false) {\n            return other;\n        }\n\n        if (value && this.isFormula(param)) {\n            return other;\n        }\n        return param;\n    }\n\n    // what === cell cell merge   merge\n    setCellText(ri, ci, {text, style, formulas, merge = \"\"},  what = 'all') {\n        if(what === 'all_with_no_workbook') {\n            this.setCell(ri, ci, {}, 'all_with_no_workbook');\n            return;\n        }\n\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        // _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n        if (what === 'style') {\n            _cell.style = style;\n            _cell.formulas = text;   //    cell.formulas = cell.formulas;\n        }   else if (what === 'format') {\n            _cell.formulas = cell.formulas;\n            _cell.style = style;\n        } else if (what === 'cell') {\n            _cell.style = style;\n            _cell.formulas = formulas;\n            _cell['merge'] = undefined;\n            if (merge !== \"\") {\n                _cell.merge = merge;\n            }\n        } else {\n            _cell.formulas = text;\n        }\n        _cell.text = text;\n        this.setCell(ri, ci, _cell);\n\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    setCellAll(ri, ci, text, formulas = \"\") {\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.formulas = formulas === \"\" ? cell.formulas : formulas;\n        _cell.text = text;\n\n        this.setCell(ri, ci, _cell, 'formulas');\n        this.setCell(ri, ci, _cell, 'text');\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    moveChange(arr, arr2, arr3) {\n        if (arr.length !== arr2.length && arr3.length !== arr2.length) {\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n\n            let s1 = arr[i].expr;\n            arr[i].each((ri, ci) => {\n                let cell = this.getCell(ri, ci);\n                if (isHave(cell) === false) {\n                    cell = {};\n                }\n                if (!isHave(cell.formulas)) {\n                    cell.formulas = \"\";\n                }\n\n                let formulas = changeFormula(cutStr(cell.formulas));\n\n                if (formulas.indexOf(s1) !== -1) {\n                    let ca = arr3[i].expr.replace(/\\$/g, \"\\\\$\");\n\n                    this.setCellAll(ri, ci, cell.text.replace(new RegExp(ca, 'g'), arr2[i].expr), cell.formulas.replace(ca, arr2[i].expr));\n                } else {\n                    let s = value2absolute(s1);\n                    let es = value2absolute(arr2[i].expr);\n                    if (formulas.indexOf(s.s3) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n\n                        s.s3 = s.s3.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s3, 'g'), es.s3), cell.formulas.replace(new RegExp(s.s3, 'g'), es.s3));\n                    } else if (formulas.indexOf(s.s2) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s2 = s.s2.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s2, 'g'), es.s2), cell.formulas.replace(new RegExp(s.s2, 'g'), es.s2));\n                    } else if (formulas.indexOf(s.s1) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s1 = s.s1.replace(/\\$/g, \"\\\\$\");\n\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s1, 'g'), es.s1), cell.formulas.replace(new RegExp(s.s1, 'g'), es.s1));\n                    }\n                }\n            });\n        }\n    }\n\n    formatMoney(s, type) {\n        if (/[^0-9\\.]/.test(s))\n            return \"0\";\n        if (s == null || s === \"\")\n            return \"0\";\n        s = s.toString().replace(/^(\\d*)$/, \"$1.\");\n        s = (s + \"00\").replace(/(\\d*\\.\\d\\d)\\d*/, \"$1\");\n        s = s.replace(\".\", \",\");\n        let re = /(\\d)(\\d{3},)/;\n        while (re.test(s))\n            s = s.replace(re, \"$1,$2\");\n        s = s.replace(/,(\\d\\d)$/, \".$1\");\n        if (type === 0) {\n            let a = s.split(\".\");\n            if (a[1] === \"00\") {\n                s = a[0];\n            }\n        }\n        return s;\n    }\n\n    // isValid => true   false  \n    getCellStyleConvert(cellStyle, isValid) {\n        if (cellStyle && cellStyle.format && cellStyle.format === 'number') {\n            return \"number\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'rmb') {\n            return 'rmb';\n        } else if ((cellStyle && cellStyle.format && cellStyle.format === 'normal')) {\n            return \"normal\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'percent') {\n            return \"percent\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'datetime') {\n            return \"datetime\";\n        } else if (\n            (isValid && !isHave(cellStyle))\n            || (isValid && cellStyle && cellStyle.format !== 'normal')\n            || cellStyle && cellStyle.format && cellStyle.format === 'date') {\n            return \"date\";\n        }\n\n        return \"\";\n    }\n\n    getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, abs = 0, isRows) {\n        let enter = false;\n        let s = \"\";\n        if (isInsert) {\n            if (sri <= ds[1] && isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[1] && !isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[0] && isAdd && isRows === false) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            }\n        }\n\n        return {\n            \"enter\": enter,\n            \"data\": s,\n        }\n    }\n\n    eachRange(range) {\n        let cells = [];\n        range.each((i, j) => {\n            let cell = this.getCell(i, j);\n            if (isHave(cell)) {\n                let empty = isEmpty(cell);\n                cell = deepCopy(cell);\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), empty);\n                cells.push(cellProp);\n            } else  {\n                cell = {};\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), true);\n                cells.push(cellProp);\n            }\n        });\n\n        return cells;\n    }\n\n    getCellTextByShift(arr, dei, dci, isInsert = false, isAdd = false, sri = 0, isRows = false) {\n        let bad = false;\n        let enter = false;\n        let newStr = \"\";\n\n        for (let i = 0; i < arr.length; i++) {\n            // if(isInsert && isHave(arr[i])) {\n            //     arr[i] = arr[i].replace(/\\$/, '');\n            // }\n            if (typeof arr[i] === 'string') {\n                arr[i] = arr[i].toUpperCase();\n            }\n            if (arr[i].search(/^[A-Z]+\\d+$/) !== -1) {\n                let ds = expr2xy(arr[i]);\n                if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    arr[i] = args.data;\n                } else if (isInsert === false) {\n                    arr[i] = xy2expr(ds[0] + dei, ds[1] + dci);\n                }\n                enter = true;\n            } else if (arr[i].search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                let a1 = arr[i].split(\":\")[0];\n                let a2 = arr[i].split(\":\")[1];\n                let ds1 = expr2xy(a1);\n                let ds2 = expr2xy(a2);\n\n                if (ds1[0] + dei < 0 || ds1[1] + dci < 0) {\n                    bad = true;\n                }\n                if (ds2[0] + dei < 0 || ds2[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let s = \"\";\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds1, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s = args.data + \":\";\n                } else if (isInsert === false) {\n                    s = xy2expr(ds1[0] + dei, ds1[1] + dci) + \":\";\n                } else {\n                    s = a1 + \":\";\n                }\n\n                args = this.getCellTextIsAdd(isInsert, sri, ds2, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s += args.data;\n                } else if (isInsert === false) {\n                    s += xy2expr(ds2[0] + dei, ds2[1] + dci);\n                } else {\n                    s += a2;\n                }\n\n                enter = true;\n                arr[i] = s;\n            } else {\n                let value = isAbsoluteValue(arr[i], 5);\n\n                if (value === 2) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0] + dei, ds[1], 2);\n                    }\n                    enter = true;\n                } else if (value === 1) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0], ds[1] + dci, 1);\n                    }\n\n                    enter = true;\n                } else if (value === 4) {\n                    let sp = arr[i].split(\":\");\n                    console.log(arr[i], sp);\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 5) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 7) {\n                    let sp = arr[i].split(':');\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 6) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 8) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 9) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 10) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 11) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                }\n            }\n            newStr += arr[i];\n        }\n\n        return {\n            \"bad\": bad,\n            \"enter\": enter,\n            \"result\": newStr\n        };\n    }\n\n    autoFilterRef(ref, range) {\n        let [ci, ri] = expr2xy(ref);\n        let cell = this.getCell(ri, ci);\n        while (cell !== null) {\n            ri += 1;\n            cell = this.getCell(ri, ci);\n        }\n        range.eri = ri;\n\n        return range;\n    }\n\n    // getAllDataType(cellRange)\n    getAllDataType(cellRange) {\n        let isNumber = true, isDate = true, sarr = [];\n\n        cellRange.each((i, j) => {\n            let und = false, cell = this.getCell(i, j);\n            if (cell) {\n                cell = deepCopy(cell);\n                let args = new CellProxy(cell).getCellDataType(sarr, {isDate, isNumber});\n                // pasteProxy.getCellDataType(cell, sarr, {isDate, isNumber}); // let args = CellProxy(cell).getCellDataType()\n                isDate = args.isDate;\n                isNumber = args.isNumber;\n            } else {\n                und = true;\n                isNumber = false;\n                isDate = false;\n            }\n\n            if (und) {\n                sarr.push({\n                    text: 0,\n                    formulas: 0,\n                    tmp: \"\",\n                    type: \"other\",\n                });\n            }\n        });\n\n        return {\n            isDate: isDate, isNumber: isNumber, sarr\n        }\n    }\n\n    calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb) {\n        let {text, formulas} = ncell;\n        text = this.toString(text);\n        formulas = this.toString(formulas);\n        let cell = {};\n        if (this.isFormula(formulas)) {\n            let last1 = text.replace(\"=\", \"\") * 1;\n\n            let value = last1 + diffValue;\n            cell = {\n                \"text\": \"=\" + value + \"\",\n                \"formulas\": \"=\" + value + \"\",\n            };\n        } else if (text !== '') {\n            let last1 = text * 1;\n            if (text.indexOf(\",\") !== -1) {\n                last1 = last1.replace(/,/g, '');\n                let value = parseFloat(last1) + diffValue;\n                last1 = this.formatMoney(value, 0);\n            } else {\n                last1 = last1 + diffValue;\n            }\n\n            cell = {\n                \"text\": last1 + \"\",\n                \"formulas\": last1 + \"\",\n            };\n        }\n\n        this.copyRender(darr, d.ri, d.ci, cell, what, cb);\n    }\n\n    calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb) {\n        let strList = splitStr(iText);\n        let args = this.getRangeByTopCell({ri: d.ri, ci: d.ci}, direction, isAdd);\n        let dci = d.ri - args.ri;\n        let dri = d.ci - args.ci;\n        let {bad, result} = this.getCellTextByShift(strList, dri, dci);\n        this.updateCellReferenceByShift(bad, result, d.ri, d.ci, cb);\n    }\n\n    calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text) {\n\n        if (!isHave(iText)) {\n            iText = \"\";\n        }\n        if (!isNaN(iText)) {\n            ncell.text = iText;\n            ncell.formulas = ncell.text;\n        } else {\n            let arr = this.toString(iText).split(/\\d+/g);\n            if (arr) {\n                let count = 0;\n                if (isAdd) {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 + 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                } else {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 - 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                }\n                ncell.formulas = ncell.text;\n            }\n        }\n        this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    }\n\n    calcDateCellByTopCell(ncell, darr, d, isAdd, what, cb, diff) {\n        if (ncell.text !== '') {\n            let last1 = ncell.text;\n\n            let value = \"\";\n            if (isAdd) {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            } else {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            }\n            ncell.text = this.toString(value);\n            ncell.formulas = this.toString(value);\n            this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n        }\n    }\n\n    getRangeByTopCell({ri, ci}, direction, isAdd) {\n        if (isAdd) {\n            ri = !direction ? ri - 1 : ri;\n            ci = !direction ? ci : ci - 1;\n        } else {\n            ri = !direction ? ri + 1 : ri;\n            ci = !direction ? ci : ci + 1;\n        }\n\n        return {ri, ci};\n    }\n\n    // logProxy.log({\"msg\":\"12312\"})  console.log --> logProxy.log\n    getCellByTopCell(d, direction, isAdd, what = 'all', dri = 0, dci = 0) {\n        if (what === 'date') {\n            if (direction === 1) {\n                let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, false, isAdd);\n                return this.getCellByCell(ri, ci);\n            } else if (direction === 2) {\n                return this.getCellByCell(d.ri, d.ci - 1);\n            } else if (direction === 3) {\n                return this.getCellByCell(d.ri, d.ci + 1);\n            }\n        } else {\n            let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, direction, isAdd);\n            return this.getCellByCell(ri, ci);\n        }\n    }\n\n    getCellByCell(ri, ci) {\n        let ncell = this.getCell(ri, ci);\n        if (!ncell) {\n            ncell = {\n                text: '',\n                formulas: '',\n            }\n        }\n\n        return helper.cloneDeep(ncell);\n    }\n\n    updateCellReferenceByShift(bad, result, ri, ci, cb = () => {\n    }) {\n        let _cell = {};\n        if (bad) {\n            _cell.text = \"#REF!\";\n            _cell.formulas = \"#REF!\";\n        } else {\n            _cell.text = result !== \"\" ? result : '';\n            _cell.formulas = result !== \"\" ? result : '';\n        }\n        // rows.setCellText(ri, ci, {text, style}, proxy, this.name, 'style');\n        this.setCell(ri, ci, _cell, 'all');\n        cb(ri, ci, _cell);\n    }\n\n    // what: all | format | text\n    // \n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {pasteProxy} = this;\n        pasteProxy.setSrcAndDstCellRange(srcCellRange, dstCellRange);\n        let {rn, cn} = pasteProxy.use();\n        let isLeftRight = pasteProxy.autoFilterDirection();\n\n        let len = isLeftRight ? rn : cn;\n        for (let i = 0; i < len; i++) {\n            let isDown = pasteProxy.upOrDown();\n            let {srcOneDRange, dstOneDRange} = pasteProxy.getOneDRangeObj(isLeftRight, i);\n            let {isNumber, isDate, sarr} = this.getAllDataType(srcOneDRange);\n            // let isCopy = pasteProxy.isCopy(sarr, i);\n\n            let darr = dstOneDRange.getLocationArray(sarr); //let dstOneDLocationAarray = dstOneDRange.getLocationArray()\n            let line = pasteProxy.leftOrRight(); // \n            let other = false;\n\n            for (let i = 0; i < darr.length; i++) {\n                let d = darr[i];\n                if (isNumber || d.type === 'number' || isDate || d.type === 'date') {\n                    other = true;\n                }\n            }\n\n            if (isDown) {\n                for (let i = 0; i < darr.length; i++) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            } else {\n                for (let i = darr.length - 1; i >= 0; i--) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            }\n        }\n    }\n\n\n    copyRender(darr, nri, nci, ncell, what, cb) {\n        let as = false;\n        for (let k = 0; as === false && k < darr.length; k++) {\n            if (darr[k].ri === nri && darr[k].ci === nci) {\n                as = true;\n            }\n        }\n        if (as) {\n            this.setCell(nri, nci, ncell, what);\n            cb(nri, nci, ncell);\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        let srcCell = [];\n        // const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n\n                if (ri * 1 !== nri || ci * 1 !== nci) {\n                    // ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                    if (this._[ri].cells[ci].text !== '' && this._[ri].cells[ci].formulas !== '') {\n                        srcCell.push({\n                            nri: nri,\n                            nci: nci,\n                            ri: ri,\n                            ci: ci,\n                            cell: deepCopy(this._[ri].cells[ci]),\n                        })\n                        // this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    }\n\n                    // if (this._[ri].cells[ci].style) {\n                    //     this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    // }\n                }\n            });\n        });\n        for (let i = 0; i < srcCell.length; i++) {\n            let {ri, ci} = srcCell[i];\n            this.setCell(ri, ci, {}, 'all');\n        }\n\n        for (let i = 0; i < srcCell.length; i++) {\n            let {nri, nci, cell} = srcCell[i];\n            this.setCell(nri, nci, cell, 'all');\n        }\n\n        // this._ = ncellmm;\n    }\n\n    insert(sri, n = 1) {\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= sri) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n, true, true, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n\n            ndata[nri] = row;\n        });\n\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n * -1, true, false, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri - n, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1) {\n        let cells = [];\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= sci) {\n                    nci += n;\n\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), n, 0, true, true, sci, false);\n                        if (enter && !bad) {\n                            cells.push({ri: ri, ci: nci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (isHave(cell.text)) delete cell.text;\n                    if (isHave(cell.value)) delete cell.value;\n                    if (isHave(cell.formulas)) delete cell.formulas;\n                    // if (isHave(cell.depend)) delete cell.depend;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    recast(cell) {\n        try {\n            if (this.isReferOtherSheet(cell, true)) {\n                let recast = new Recast(cell.formulas);\n                recast.parse();\n                cell['recast'] = recast;\n            } else {\n                cell['recast'] = null;\n            }\n        } catch (e) {\n            cell['recast'] = null;\n        }\n    }\n\n    init() {\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n            });\n        });\n    }\n\n    setData(d, sheet = \"\", out = false, rowsInit = false) {\n        try {\n            if (d.len) {\n                this.len = d.len;\n                delete d.len;\n            }\n            this._ = d;\n\n\n            if (out) {\n\n            } else if (sheet !== '') {\n                console.time(\"setData\");\n                if (rowsInit) {\n                    this.init();\n                    this.workbook = calcUtils.Rows2Workbook(this);\n                    sheet.toolbar.change('close', '');\n                }\n                console.timeEnd(\"setData\");\n\n            }\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n}\n\nexport {\n    Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  // setStyle(ci, style) {\n  //   const col = this.getOrNew(ci);\n  //   col.style = style;\n  // }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport {\n  Cols,\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport {\n  Validations,\n};\n","export default class Moved {\n    constructor() {\n        this.range = null;\n        this.state = 'move';\n    }\n\n    move(cellRange) {\n        this.range = cellRange;\n        this.state = 'move';\n\n        return this;\n    }\n}","/* global window */\n\n// import {setColor} from \"../plug-in/revision\";\n\nlet removeEvent = [];\n\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n    removeEvent.push({\n        name: name,\n        fn: fn,\n        target: target\n    })\n}\n\nexport function remove() {\n    for (let i = 0; i < removeEvent.length; i++) {\n        let re = removeEvent[i];\n        unbind(re.target, re.name, re.fn);\n    }\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\nexport function createEvent(keyCode, metaKey, name = \"keydown\", buttons = -1) {\n    let event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventType = 'message';\n    event.buttons = buttons;\n    event.keyCode = keyCode;\n    event.metaKey = metaKey;\n    document.dispatchEvent(event);\n}\n\n// the left mouse button: mousedown  mouseup  click\n// the right mouse button: mousedown  contenxtmenu  mouseup\n// the right mouse button in firefox(>65.0): mousedown  contenxtmenu  mouseup  click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\n// export function bindClickoutside2(el, revision) {\n//     el.xclickoutside = (evt) => {\n//         // ignore double click\n//         // console.log('evt:', evt);\n//         if (evt.buttons === 2 || el.contains(evt.target)) return false;\n//         else {\n//             // setColor.call(revision);\n//             el.hide();\n//             unbindClickoutside(el);\n//         }\n//     };\n//     bind(window.document.body, 'mousedown', el.xclickoutside);\n// }\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    target.xEvtUp = (evt) => {\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n","/* global window */\nexport const cssPrefix = 'fin-cell';\nexport const look = ['**', '*HYPERLINK*', '*MULTIPLECELLS*'];\nexport const look2 = '#CHECK';\nexport const filterFormula = ['CITY'];\nexport const offsetLeft = 60;\nexport const offsetTop = 70;\n\n// export const edgeRight = 30;\n// export const dpr = window.devicePixelRatio  || 1;\n// export const dpr = 1;\n","/* global window */\nimport {h} from './element';\nimport {mouseMoveUp} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Resizer {\n    constructor(vertical = false, minDistance) {\n        this.moving = false;\n        this.vertical = vertical;\n        this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n            this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n                .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n            this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n        ).hide();\n        // cell rect\n        this.cRect = null;\n        this.finishedFn = null;\n        this.minDistance = minDistance;\n    }\n\n    // rect : {top, left, width, height}\n    // line : {width, height}\n    show(rect, line) {\n        const {\n            moving, vertical, hoverEl, lineEl, el,\n        } = this;\n        if (moving) return;\n        this.cRect = rect;\n        const {\n            left, top, width, height,\n        } = rect;\n        el.offset({\n            left: vertical ? left + width - 5 : left,\n            top: vertical ? top : top + height - 5,\n        }).show();\n        hoverEl.offset({\n            width: vertical ? 5 : width,\n            height: vertical ? height : 5,\n        });\n        lineEl.offset({\n            width: vertical ? 0 : line.width,\n            height: vertical ? line.height : 0,\n        });\n    }\n\n    hide() {\n        this.el.offset({\n            left: 0,\n            top: 0,\n        }).hide();\n    }\n\n    mousedownHandler(evt) {\n        let startEvt = evt;\n        const {\n            el, lineEl, cRect, vertical, minDistance,\n        } = this;\n        let distance = vertical ? cRect.width : cRect.height;\n        // console.log('distance:', distance);\n        lineEl.show();\n        mouseMoveUp(window, (e) => {\n            this.moving = true;\n            if (startEvt !== null && e.buttons === 1) {\n                // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n                if (vertical) {\n                    distance += e.movementX;\n                    if (distance > minDistance) {\n                        el.css('left', `${cRect.left + distance}px`);\n                    }\n                } else {\n                    distance += e.movementY;\n                    if (distance > minDistance) {\n                        el.css('top', `${cRect.top + distance}px`);\n                    }\n                }\n                startEvt = e;\n            }\n        }, () => {\n            startEvt = null;\n            lineEl.hide();\n            this.moving = false;\n            this.hide();\n            if (this.finishedFn) {\n                if (distance < minDistance) distance = minDistance;\n                this.finishedFn(cRect, distance);\n            }\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n// import {moveArr} from \"../event/paste\";\n\nexport default class Scrollbar {\n    constructor(vertical) {\n        this.vertical = vertical;\n        this.moveFn = null;\n        this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n            .child(this.contentEl = h('div', ''))\n            .on('mousemove.stop', () => {\n            })\n            .on('scroll.stop', (evt) => {\n                let {scrollTop, scrollLeft} = evt.target;\n                // scrollTop = scrollTop * 2;\n                // moveArr.call(this.sheet, scrollTop, scrollLeft);\n                if (this.moveFn) {\n                    this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n                }\n\n                // console.log('evt:::', evt);\n            });\n    }\n\n    move(v) {\n        // debugger\n        this.el.scroll(v);\n        return this;\n    }\n\n    scroll() {\n        return this.el.scroll();\n    }\n\n    set(distance, contentDistance) {\n        const d = distance - 1;\n        // console.log('distance:', distance, ', contentDistance:', contentDistance);\n        if (contentDistance > d) {\n            const cssKey = this.vertical ? 'height' : 'width';\n            this.el.css(cssKey, `${d - 15}px`).show();\n            this.contentEl\n                .css(this.vertical ? 'width' : 'height', '1px')\n                .css(cssKey, `${contentDistance}px`);\n        } else {\n            this.el.hide();\n        }\n        return this;\n    }\n}\n","import {CellRange} from \"../core/cell_range\";\nimport {cssPrefix} from \"../config\";\nimport {h} from \"./element\";\nimport {selectorHeightBorderWidth} from \"./selector\";\n\nexport default class SelectorCell {\n    constructor(data) {\n        this.el = h('div', `${cssPrefix}-selector-cell`);\n        this.data = data;\n        this._ = new CellRange(0, 0, 0, 0);\n    }\n\n    resetSelectOffset() {\n        let rect = this.data.getRect(this._);\n        this.setOffset(rect);\n    }\n\n    setData(ri, ci) {\n        ri = ri === -1 ? 0 : ri;\n        ci = ci === -1 ? 0 : ci;\n\n        let {data} = this;\n        let {merges} = data;\n\n        let enter = false;\n        merges.each(range => {\n            if (range.includeByRiCi(ri, ci)) {\n                this._ = range;\n                enter = true;\n            }\n        });\n\n        if (!enter) {\n            this._ = new CellRange(ri, ci, ri, ci);\n        }\n    }\n\n    toolbarChangeSelectorCell() {\n        let ri = this._.sri;\n        let ci = this._.sci;\n\n        this.setData(ri, ci);\n    }\n\n    setOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.el.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {xy2expr} from \"../core/alphabet\";\nimport {deepCopy} from '../core/operator';\nimport SelectorCell from \"./selector_cell\";\nimport CellProp from \"../model/cell_prop\";\n\nexport const selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n\n                } else {\n                    this.moveEvent(1);\n                }\n\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(2);\n                }\n            }).on('click', (evt) => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                }\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    evt.stopPropagation();\n                }\n                this.moveEvent(3);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(4);\n                }\n            });\n\n\n        this.cornerEl.on('mousedown', evt => {\n            let {detail} = evt;\n            if (detail === 2) {\n                sheet.clickCopyPaste();\n                evt.stopPropagation();\n            }\n        });\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .children(this.cornerEl, this.boxinner).hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    border(value) {\n        this.areaEl.css('border', value);\n    }\n\n    longTimeBefore(time = 500) {\n        this.boxinner.hide();\n\n        setTimeout(() => {\n            this.boxinner.show();\n        }, time);\n    }\n\n    moveEvent(direction) {\n        console.log(60);\n        let {data, _selector, sheet,} = this;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = _selector.range;\n        let _cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let {selectorMoveEl} = sheet;\n        selectorMoveEl.set(-1, -1, true);\n        selectorMoveEl.hide();\n\n        mouseMoveUp(window, (e) => {\n            sheet.container.css('pointer-events', 'none');\n            _selector.setBoxinner(\"none\");\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                cellRange.move(ri, ci);\n                //     if(direction == 4) {\n                //         cellRange = new CellRange(eri, eci, eri, eci, w, h);\n                //     } else if(direction == 2) {\n                //         cellRange = new CellRange(sri, eci, eri, eci, w, h);\n                //     } else if(direction == 1) {\n                //         cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                // }\n\n                const rect = data.getMoveRect(cellRange);\n                selectorMoveEl.range = cellRange;\n                selectorMoveEl.setMove(rect);\n                selectorMoveEl.el.show();\n            }\n        }, () => {\n            // \n            let {rows} = data;\n            let arr = [], arr2 = [], arr3 = [];\n\n            _cellRange.each((i, j) => {\n                console.log(rows.getCell(i, j), i, j);\n                let cell = rows.getCell(i, j);\n                let movedCell = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}:${xy2expr(j, i)}`);\n                let movedCell2 = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}`);\n                arr.push(movedCell);\n                arr3.push(movedCell2);\n            });\n            cellRange.each((i, j) => {\n                let movedCell = new CellProp(i, j, deepCopy(rows.getCell(i, j) || {}), xy2expr(j, i));\n                arr2.push(movedCell);\n            });\n\n            data.cutPaste(_cellRange, cellRange, false);\n            sheet.container.css('pointer-events', 'auto');\n            _selector.setBoxinner(\"auto\");\n            selectorMoveEl.hide();\n\n            const rect = data.getMoveRect(cellRange);\n            selector.range = cellRange;\n            selector.ci = cellRange.sci;\n            selector.ri = cellRange.sri;\n\n            _selector.indexes = [selector.ri, selector.ci];\n            _selector.moveIndexes = [cellRange.sri, cellRange.sci];\n            _selector.range = cellRange;\n            _selector.setMove(rect);\n\n            sheet.selector.selectCell.setData(cellRange.sri, cellRange.sci);\n            // sheet.selectorMoveReset();\n\n            // \n            // if (_cellRange.eri != _cellRange.sri || _cellRange.eci != _cellRange.sci) {\n            //     let erpxArr = [];\n            //     let erpxArr2 = [];\n            //     let erpxArr3 = [];\n            //     for (let i = _cellRange.sci; i <= _cellRange.eci; i++) {\n            //         for (let j = _cellRange.sri; j <= _cellRange.eri; j++) {\n            //             erpxArr.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr.length; i++) {\n            //         for (let j = 0; j < erpxArr.length; j++) {\n            //             if (i <= j) {\n            //                 erpxArr2.push([i, j])\n            //             }\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr[a];\n            //         let a1 = erpxArr[b];\n            //         arr.push(`${a2}:${a1}`);\n            //         arr3.push(`${a2}:${a1}`);\n            //     }\n            //\n            //     for (let i = cellRange.sci; i <= cellRange.eci; i++) {\n            //         for (let j = cellRange.sri; j <= cellRange.eri; j++) {\n            //             erpxArr3.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr3[a];\n            //         let a1 = erpxArr3[b];\n            //\n            //         arr2.push(`${a2}:${a1}`);\n            //     }\n            //\n\n            // let {worker} = this;\n            // worker.terminate();\n            // worker = new Worker();\n            // worker.postMessage({ arr: arr, arr2: arr2, arr3: arr3, rows: rows });\n            //\n            // worker.onmessage = function (event) {\n            // };\n            //\n            // worker.addEventListener(\"message\", function (event) {\n            //     rows._ = event.data.rrows;\n            //     sheet.editor.display = true;\n            //     rows.moveChange(arr, arr2, arr3);\n            //     sheet.selectorMoveReset();\n            // });\n            console.time(\"move\");\n            rows.moveChange(arr, arr2, arr3);\n            console.timeEnd(\"move\");\n\n            sheet.selectorMoveReset();\n        });\n    }\n\n    setCss(b) {\n        this.areaEl.css('border', `2px dashed ${b}`);\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n\n        this.cornerEl.css(\"pointer-events\", pointer);\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n    constructor(data, sheet, sc = false) {\n        this.data = data;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.sheet = sheet;\n\n        // this.selectT = new SelectorElement(data, this, sheet);\n        // this.selectL = new SelectorElement(data, this, sheet);\n        // this.selectTl = new SelectorElement(data, this, sheet);\n\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        if (sc) {\n            this.selectCell = new SelectorCell(data, sc);\n            this.el.child(this.selectCell.el);\n        } else {\n            this.selectCell = new SelectorCell(data, sc);\n        }\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n\n    longTimeBefore() {\n        this.tl.longTimeBefore();\n        this.br.longTimeBefore();\n        this.t.longTimeBefore();\n        this.l.longTimeBefore();\n    }\n\n    setCss(b) {\n        this.br.setCss(b);\n        this.t.setCss(b);\n        this.l.setCss(b);\n        this.tl.setCss(b);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n\n        this.selectCell.resetSelectOffset();\n\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n\n\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        // this.resetSelectOffset(cellRange);\n\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    autoFilterRef() {\n        console.log(this.range);\n    }\n\n    setEnd(ri, ci, moving = true, enter = false) {\n        const {data } = this;\n        if (moving) {\n            // if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci, sci, sri} = this.data.selector.range;\n        //  ctrl + c bug  \n        this.set(sri, sci);\n\n        this.setEnd(eri, eci, true, true);\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    //\n    showAutofill(ri, ci, pos) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n\n        // pos == 1 pos == 3  pos == 2  pos == 4 \n        let drisc = 0;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        // const srn = sri - ri;\n        // const scn = sci - ci;\n        // const ern = eri - ri;\n        // const ecn = eci - ci;\n        // console.log(srn, scn, ern, ecn, ri, ci);\n        if (pos === 2) {\n            drisc = 11;\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // console.log(this.arange);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (pos === 4) {\n            drisc = 22;\n\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (pos === 3) {\n            drisc = 33;\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (pos === 1) {\n            drisc = 44;\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return drisc;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n        return drisc;\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {bind, bindClickoutside, createEvent, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport CellRange from \"../core/cell_range\";\n\nfunction inputMovePrev(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex -= 1;\n    if (this.itemIndex < 0) {\n        this.itemIndex = filterItems.length - 1;\n        this.el.el.scrollTop = this.el.el.scrollHeight;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0 || filterItems.length < this.itemIndex) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex += 1;\n    if (this.itemIndex > filterItems.length - 1) {\n        this.itemIndex = 0;\n        this.el.el.scrollTop = 0;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n    console.log(filterItems.length);\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n    evt.preventDefault();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    evt.stopPropagation();\n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n        this.hide();\n             createEvent.call(this, 13, false);\n\n        return\n    };\n\n    filterItems[this.itemIndex].el.click();\n    this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n    const {keyCode} = evt;\n    if (evt.ctrlKey) {\n        evt.stopPropagation();\n    }\n    switch (keyCode) {\n        case 37: // left\n            evt.stopPropagation();\n            break;\n        case 38: // up\n            inputMovePrev.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 39: // right\n            evt.stopPropagation();\n            break;\n        case 40: // down\n            inputMoveNext.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 13: // enter\n            inputEnter.call(this, evt);\n            break;\n        case 9:\n            inputEnter.call(this, evt);\n            break;\n        default:\n            evt.stopPropagation();\n            break;\n    }\n}\n\nexport default class Suggest {\n    constructor(items, itemClick, data, editor, width = '200px') {\n        this.filterItems = [];\n        this.items = items;\n        this.data = data;\n        this.editor = editor;\n        this.el = h('div', `${cssPrefix}-suggest`)\n            .css('width', width)\n            .css('overflow-y', 'auto')\n            .css('max-height', '306px').hide();\n        this.el.attr('tabindex', 0);\n\n\n        this.itemClick = itemClick;\n        this.itemIndex = -1;\n        this.show = false;\n    }\n\n    setOffset(v) {\n        this.el.cssRemoveKeys('top', 'bottom')\n            .offset(v);\n    }\n\n    hide() {\n        const {el} = this;\n        this.filterItems = [];\n        this.itemIndex = -1;\n        el.hide();\n        this.show = false;\n        unbindClickoutside(this.el.parent());\n    }\n\n    setItems(items) {\n        this.items = items;\n        // this.search('');\n    }\n\n    search(word) {\n        let {items, data, editor} = this;\n        if (!/^\\s*$/.test(word)) {\n            items = items.filter(it => (it.key.toUpperCase() || it.toUpperCase()).startsWith(word.toUpperCase()));\n        }\n        items = items.map((it) => {\n            let {title} = it;\n            if (title) {\n                if (typeof title === 'function') {\n                    title = title();\n                }\n            } else {\n                title = it;\n            }\n            const item = h('div', `${cssPrefix}-item`)\n                .child(title)\n                .on('click.stop', () => {\n                    this.itemClick(it);\n                });\n            if (it.label) {\n                item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        this.filterItems = items;\n        if (items.length <= 0) {\n            this.hide();\n            this.show = false;\n            return;\n        }\n        const {el} = this;\n        // items[0].toggle();\n        let rect = data.getRect(new CellRange(editor.ri, editor.ci, editor.ri, editor.ci));\n        let left = rect.left + 55;\n        let top = rect.top + 50;\n\n        if( items.length >= 9 && rect.top - 306 >= 50) {\n            top -= 306;\n            top -= rect.height;\n        }\n        el.css('left', `${left}px`);\n        el.css('top', `${top}px`);\n\n        el.html('').children(...items).show();\n        this.show = true;\n        bindClickoutside(el.parent(), () => {\n            this.hide();\n            this.show = false;\n        });\n    }\n\n    bindInputEvents(input) {\n        input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n    }\n}\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'fin-cell-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport {calendarPattern, str2Re} from \"../utils/reg_pattern\";\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (str2Re(calendarPattern).test(date)) { // jobs: todo: \n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","import {cssPrefix} from \"../config\";\nimport {h} from \"../component/element\";\nimport {helpFormula} from \"../core/operator\";\nimport {bind} from \"./event\";\n\nfunction variableElement(content, txt, pos, className, s = \"\", s2 = \"\") {\n    let item = h('div', className);\n    for (let i = 0; i < content[txt].length; i++) {\n        let ct = content[txt][i];\n        let {name, editor, index} = ct;\n\n        if (pos === i) {\n            item.child(h('span', s).child(name));\n        } else if (editor === true && pos >= index) {\n            item.child(h('span', s).child(name));\n        } else {\n            item.child(h('span', s2).child(name));\n        }\n    }\n\n    return item;\n}\n\nexport default class SuggestContent {\n    constructor(width = \"300px\") {\n        this.el = h('div', `${cssPrefix}-suggest-content`).css('width', width).css('z-index', \"10000\").css('position', \"absolute\").hide();\n        this.el.attr('tabindex', 0);\n        bind(this.el.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n    }\n\n    hide() {\n        const {el} = this;\n        el.hide();\n    }\n\n    content(cut = \"\", pos = -1) {\n        const {el} = this;\n\n        cut = cut.toUpperCase();\n        // cut \n        let content = {};\n        Object.keys(helpFormula).forEach(i => {\n            if (i === cut) {\n                content = helpFormula[i];\n            }\n        });\n\n        if (!content || JSON.stringify(content) === '{}') {\n            return;\n        }\n\n        let items = [];\n        let title = variableElement.call(this, content, \"title\", pos, `${cssPrefix}-help-title`, `${cssPrefix}-help-span-title`, `${cssPrefix}-help-span2-title`);\n        let exampleName = h('div', `${cssPrefix}-help-section-title`).child(\"\");\n        let example = variableElement.call(this, content, \"example\", pos, `${cssPrefix}-help-section-content`, `${cssPrefix}-help-span3-title`);\n        items.push(...[title, exampleName, example]);\n        Object.keys(content.content).forEach(i => {\n            let c = content.content[i];\n            let item = h('div', `${cssPrefix}-help-section-title`).child(i);\n            let item2 = h('div', `${cssPrefix}-help-section-content`).child(c);\n            items.push(...[item, item2]);\n        });\n\n        el.html('').children(...items).show();\n    }\n}","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\nimport {cuttingByPos, cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {lockCells} from \"./formula_editor\";\nimport {CellRange} from \"../core/cell_range\";\nimport {mouseMoveUp} from \"./event\";\n\nfunction find(str, cha) {\n\n    return str.lastIndexOf(cha);\n}\n\nexport default class SelectorMove {\n    constructor(boxinner, data, sheet, selector) {\n        this.l = h('div', `${cssPrefix}-selector-box-l-move-l`);\n        this.r = h('div', `${cssPrefix}-selector-box-l-move-r`);\n        this.t = h('div', `${cssPrefix}-selector-box-l-move-t`);\n        this.b = h('div', `${cssPrefix}-selector-box-l-move-b`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n\n        this.event(this.l, 1);\n        this.event(this.r, 2);\n        this.event(this.t, 3);\n        this.event(this.b, 4);\n        this.boxinner = boxinner;\n        this.boxinner.children(\n            this.l,\n            this.r,\n            this.t,\n            this.b,\n        );\n    }\n\n    event(target, dict) {\n        let timer = null;\n        target.on('mousedown.stop', evt => {\n            let {data, sheet, _selector} = this;\n            let p = -1;\n            let {selector} = data;\n            let _move_selectors = null;\n            let {sri, sci, eri, eci, w, h} = selector.range;\n            let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n            let _cellRange = null;\n            let {selectors} = sheet;\n            let msri = -1, msci = -1, meri = -1, meci = -1;\n\n            mouseMoveUp(window, (e) => {\n                clearTimeout(timer);\n                timer = setTimeout(() => {\n                    sheet.container.css('pointer-events', 'none');\n                    for (let i = 0; i < selectors.length; i++) {\n                        let selector = selectors[i];\n                        selector.selector.setBoxinner(\"none\");\n                    }\n\n                    let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n                    if (ri !== -1 && ci !== -1) {\n                        let {pos} = this.sheet.editor;\n                        let inputText = this.sheet.editor.editorText.getText();\n                        let _erpx = cuttingByPos(inputText, pos - 1, true);\n                        if (inputText.length > pos - 1) {\n                            _erpx += cuttingByPosEnd(inputText, pos - 1);\n                        }\n                        for (let i = 0; i < selectors.length; i++) {\n                            let selector = selectors[i];\n                            let {className, erpx} = selector;\n\n                            if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n                                if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    cellRange.move(ri, ci);\n                                    const rect = data.getMoveRect(cellRange);\n                                    _move_selectors.selector.range = cellRange;\n                                    _move_selectors.selector.setMove(rect);\n                                } else {\n                                    _move_selectors.selector.set(ri, ci, true);\n                                }\n                                break;\n                            } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                                p = p !== -1 ? p : find(inputText, selector.erpx);\n                                this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                                if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    if (_cellRange === null) {\n                                        _cellRange = cellRange;\n                                    }\n                                    if (dict === 4) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        // console.log(cellRange, _cellRange);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                } else {\n                                    let e1 = expr2xy(selector.erpx);\n                                    let e2 = expr2xy(selector.erpx);\n                                    let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                    if (dict === 4) {\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                }\n                                break;\n                            }\n                        }\n\n                        if (_move_selectors\n                            && (msri !== cellRange.sri\n                                || msci !== cellRange.sci\n                                || meri !== cellRange.eri\n                                || meci !== cellRange.eci)) {\n                            _move_selectors.selector.setCss(_move_selectors.color, false);\n                            lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                        }\n                        msri = cellRange.sri;\n                        msci = cellRange.sci;\n                        meri = cellRange.eri;\n                        meci = cellRange.eci;\n                    }\n                }, 6);\n            }, () => {\n                clearTimeout(timer);\n                let {selectors} = this.sheet;\n                sheet.container.css('pointer-events', 'auto');\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    selector.selector.setBoxinner(\"all\");\n                }\n                p = -1;\n                if (_move_selectors && _move_selectors.selector)\n                    _move_selectors.selector.setCss(_move_selectors.color, true);\n                _move_selectors = null;\n            })\n        });\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {lockCells} from \"../component/formula_editor\";\nimport {cuttingByPos} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport SelectorMove from \"./selector_move\";\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nfunction  find(str, cha) {\n    return str.lastIndexOf(cha);\n}\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        // this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this._selector = selector;\n        this.sheet = sheet;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n\n\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.selectorMove = new SelectorMove(this.boxinner, data, sheet, selector);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .child(this.boxinner)\n            .hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    moveEvent(evt) {\n        let {data, _selector, sheet} = this;\n        let _move_selectors = null;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = selector.range;\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let p = -1;\n        mouseMoveUp(window, (e) => {\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'none');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"none\");\n            }\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                let { pos} = this.sheet.editor;\n                let inputText = this.sheet.editor.editorText.getText();\n                let _erpx = cuttingByPos(inputText, pos - 1, true);\n                if (inputText.length > pos - 1) {\n                    _erpx += cuttingByPosEnd(inputText, pos - 1);\n                }\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    let {className, erpx} = selector;\n\n                    if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n                        if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                        p = p !== -1 ? p : find(inputText, selector.erpx);\n                        this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                        if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    }\n                }\n                if (_move_selectors) {\n                    _move_selectors.selector.setCss(_move_selectors.color, false);\n                    lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                }\n            }\n        }, () => {\n            //   e.layerX, e.layerY   xy\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'auto');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"all\");\n            }\n            p = -1;\n            if (_move_selectors && _move_selectors.selector)\n                _move_selectors.selector.setCss(_move_selectors.color, true);\n            _move_selectors = null;\n        });\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n        this.selectorMove.l.css(\"pointer-events\", pointer);\n        this.selectorMove.r.css(\"pointer-events\", pointer);\n        this.selectorMove.t.css(\"pointer-events\", pointer);\n        this.selectorMove.b.css(\"pointer-events\", pointer);\n    }\n\n    setCss(b, key = true) {\n        if (!key) {\n            this.areaEl.css(\"border\", `2px solid ${b}`);\n        } else {\n            this.areaEl.css(\"border\", `2px dashed ${b}`);\n        }\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class SelectorCopy {\n    constructor(data, sheet, className) {\n        this.data = data;\n        this.className = className;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n    setCss(b, key = true) {\n        this.br.setCss(b, key);\n        this.t.setCss(b, key);\n        this.l.setCss(b, key);\n        this.tl.setCss(b, key);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    setEnd(ri, ci, moving = true) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    // reset() {\n    //     // console.log('::::', this.data);\n    //     const {eri, eci} = this.data.selector.range;\n    //     this.setEnd(eri, eci);\n    // }\n\n    showAutofill(ri, ci) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        if (scn > 0) {\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (srn > 0) {\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (ecn < 0) {\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (ern < 0) {\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n    ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n    ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n    ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n    ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n    ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst selectColors = [\"#EE0000\", \"#8A2BE2\", \"#FF3E96\", \"#8B4500\", \"#3A5FCD\", \"#FF7F24\"];\n\nexport function selectorColor(index) {\n    index = index % selectColors.length;\n    return {\n        color: selectColors[index],\n        index: index,\n    };\n}\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nfunction buildTd(bgcolor) {\n    let item = h('div', `${cssPrefix}-color-palette-cell`)\n        .on('click.stop', () => this.change(bgcolor))\n        .css('background-color', bgcolor);\n\n    this.items.push(\n        item\n    );\n    return h('td', '').child(item);\n}\n\nexport default class ColorPalette {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-color-palette`);\n        this.change = () => {\n        };\n        this.items = [];\n        const table = h('table', '').children(\n            h('tbody', '').children(\n                h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n                    ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n                ),\n                ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n                    ...it.map(color => buildTd.call(this, color)),\n                )),\n                h('tr', `${cssPrefix}-standard-colors`).children(\n                    ...standardColors.map(color => buildTd.call(this, color)),\n                ),\n            ),\n        );\n        this.el.child(table);\n    }\n}\n","import SelectorCopy from '../component/selector_copy';\nimport {\n    cutFirst,\n    cutStr,\n    cutting,\n    cutting2,\n    cuttingByPos,\n    isAbsoluteValue,\n    operation,\n    value2absolute,\n} from '../core/operator';\nimport {expr2xy, xy2expr} from '../core/alphabet';\nimport {selectorColor} from './color_palette';\nimport {h} from './element';\n\nfunction lockCells(evt, _selector, isAb = false, p = -1) {\n    const {data, editor} = this;\n    const {offsetX, offsetY} = evt;\n\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {ri, ci} = cellRect;\n\n    let {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let input = '';\n\n    editor.handler(inputText);\n    const {mousedownIndex} = editor;\n    if (isAbsoluteValue(cuttingByPos(inputText, pos), 2) || _selector) {\n        if (_selector) {\n            const {\n                sri, sci, eri, eci,\n            } = _selector.selector.range;\n\n            const s1 = xy2expr(sci, sri);\n            const s2 = xy2expr(eci, eri);\n            let text = s1 === s2 ? s1 : `${s1}:${s2}`;\n\n            if (isAb === 2) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s1 === es2.s1 ? es1.s1 : `${es1.s1}:${es2.s1}`;\n            } else if (isAb === 1) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s2 === es2.s2 ? es1.s2 : `${es1.s2}:${es2.s2}`;\n            } else if (isAb === 3) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s3 === es2.s3 ? es1.s3 : `${es1.s3}:${es2.s3}`;\n            }\n            _selector.erpx = text;\n            let {isCors} = editor;\n            if (isCors) {\n                pos = 1;\n            }\n\n            let sp = p !== -1 ? p : pos - cuttingByPos(inputText, pos).length;\n            input = inputText.substring(0, sp) + text + inputText.substring(pos, inputText.length);\n            editor.setText(input);\n            editor.setCursorPos(inputText.substring(0, sp).length + text.length);\n        } else {\n            // : =A1  -> A2  : =A2\n            let enter = 0;\n            for (let i = 0; i < this.selectors.length && enter === 0; i++) {\n                const selector = this.selectors[i];\n                const {erpx} = selector;\n                if (erpx === cuttingByPos(inputText, pos)) {\n                    const {ri, ci} = cellRect;\n                    this.selectors[i].ri = ri;\n                    this.selectors[i].ci = ci;\n                    this.selectors[i].erpx = xy2expr(ci, ri);\n                    this.selectors[i].selector.set(ri, ci);\n                    input = `${inputText.substring(0, pos - erpx.length)}${xy2expr(ci, ri)}${inputText.substring(pos, inputText.length)}`;\n                    editor.setText(input);\n                    editor.setCursorPos(inputText.substring(0, pos - erpx.length).length + xy2expr(ci, ri).length);\n                    enter = 1;\n                }\n            }\n        }\n    } else if (mousedownIndex.length > 0) {\n        if (operation(mousedownIndex[1][0]) && isAbsoluteValue(cuttingByPos(mousedownIndex[1], mousedownIndex[1].length), 2)) {\n            editor.setLock(false);\n            return;\n        }\n\n        const args = makeSelector.call(this, ri, ci);\n        this.selectors.push(args);\n        input = `${mousedownIndex[0]}${xy2expr(ci, ri)}${mousedownIndex[1]}`;\n        const judgeText = input.substring(mousedownIndex[0].length + xy2expr(ci, ri).length, input.length);\n        // \n        let number = cutFirst(judgeText.substring(1));\n        if (operation(judgeText[0]) && !isAbsoluteValue(number, 2)) {\n            editor.setText(input);\n            editor.setMouseDownIndex([]);\n            return;\n        }\n        // \n        number = cutFirst(mousedownIndex[1]);\n\n        console.log(xy2expr(ci, ri));\n        const cut = cutStr(`${mousedownIndex[0]}${xy2expr(ci, ri)}+4${mousedownIndex[1]}`);\n        const {selectors_delete, selectors_new} = filterSelectors.call(this, cut);\n        Object.keys(selectors_delete).forEach((i) => {\n            const selector = selectors_delete[i];\n            selector.removeEl();\n        });\n\n        this.selectors = selectors_new;\n\n        input = input.replace(number, '');\n        editor.setText(input);\n        // const content = suggestContent.call(this, pos - 1, cutting(inputText), inputText);\n        editor.setCursorPos(mousedownIndex[0].length + xy2expr(ci, ri).length);\n    } else {\n        const {pos} = editor;\n\n        const args = _selector || makeSelector.call(this, ri, ci);\n        if (pos !== -1) {\n            let str = '';\n            let enter = false;\n            let step = pos;\n            let first = '';\n            for (let i = pos; i < inputText.length; i++) first += inputText[i];\n            let len = cutFirst(first).length;\n            for (let i = 0; i < inputText.length; i++) {\n                if (pos === i) {\n                    enter = true;\n                    str += xy2expr(ci, ri);\n                }\n\n                if (step === i && len > 0) {\n                    step += 1;\n                    len -= 1;\n                } else {\n                    str += inputText[i];\n                }\n            }\n\n            if (_selector) {\n                const {\n                    sri, sci, eri, eci,\n                } = data.selector.range;\n                const s1 = xy2expr(sci, sri);\n                const s2 = xy2expr(eci, eri);\n\n                input = s1 === s2 ? s1 : `${s1}:${s2}`;\n                str = !enter ? str + input : str;\n            } else {\n                this.selectors.push(args);\n                str = !enter ? str + xy2expr(ci, ri) : str;\n            }\n            editor.setText(str);\n            editor.setCursorPos(str.length);\n            editor.parse();\n        } else {\n            this.selectors.push(args);\n            input = `${inputText}${xy2expr(ci, ri)}`;\n            editor.setText(input);\n        }\n    }\n    editor.parse(editor.pos);\n    if (this.selectors.length > 0 || _selector) {\n        // const {inputText} = editor;\n        let inputText = editor.editorText.getText();\n        //  \n        let it = inputText, enter = false;\n        let {merges} = this.data;\n        Object.keys(merges._).forEach(i => {\n            let m = merges._[i];\n            const cut = cutStr(it, true);\n            for (let i = 0; i < cut.length; i++) {\n                if (cut[i].indexOf(\":\") !== -1) {\n                    let a1 = cut[i].split(\":\")[0];\n                    let a2 = cut[i].split(\":\")[1];\n                    let e1 = expr2xy(a1);\n                    let e2 = expr2xy(a2);\n\n                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                        it = it.replace(new RegExp(cut[i], 'g'), a1);\n                        enter = true;\n                    }\n                }\n            }\n        });\n\n\n        // clearSelectors.call(this);\n        // console.log(it);\n        div2span.call(this, cutting(it), cutting2(it));\n        if (enter) {\n            setTimeout(() => {\n                editor.setCursorPos(it.length);\n            }, 10);\n        }\n    }\n    // step 3.  entercell\n    // dataSetCellText.call(this, input, 'input');\n}\n\nfunction filterSelectors(cut) {\n    const selectors_new = [];\n    const selectors_delete = [];\n    Object.keys(this.selectors).forEach((i) => {\n        const selector = this.selectors[i];\n        const {erpx} = selector;\n        let enter = 0;\n        for (let i2 = 0; i2 < cut.length && enter === 0; i2++) {\n            if (cut[i2].replace(/\\$/g, '') === erpx) {\n                enter = 1;\n                selectors_new.push(selector);\n            }\n        }\n\n        if (enter === 0) {\n            selectors_delete.push(selector.selector.el);\n        }\n    });\n    return {\n        selectors_delete,\n        selectors_new,\n    };\n}\n\nfunction makeSelector(ri, ci, selectors = this.selectors, multiple = false, _selector, mergeSelector) {\n    const {data} = this;\n    let selector = null;\n    // const {inputText} = this.editor;\n    let inputText = this.editor.editorText.getText();\n    const {color, index} = selectorColor(selectors.length);\n    if (_selector) {\n        selector = _selector;\n    } else {\n        const className = `selector${Math.random() * 999999}`;\n        selector = new SelectorCopy(data, this, className);\n        selector.el.attr('class', `${className} clear_selector`);\n        selector.setCss(color);\n    }\n\n    if (multiple) {\n        if (mergeSelector) {\n            selector.setEnd(ri, ci);\n        } else {\n            selector.set(ri, ci, true);\n        }\n    } else {\n        selector.set(ri, ci, false);\n    }\n\n    selector.el.css('z-index', '100');\n    const len = inputText.split(xy2expr(ci, ri)).length - 2;\n\n    let it = xy2expr(ci, ri);\n    let {merges} = data;\n    Object.keys(merges._).forEach(i => {\n        let m = merges._[i];\n        const cut = cutStr(it, true);\n        for (let i = 0; i < cut.length; i++) {\n            if (cut[i].indexOf(\":\") !== -1) {\n                let a1 = cut[i].split(\":\")[0];\n                let a2 = cut[i].split(\":\")[1];\n                let e1 = expr2xy(a1);\n                let e2 = expr2xy(a2);\n\n                if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                    it = it.replace(new RegExp(cut[i], 'g'), a1);\n                }\n            }\n        }\n    });\n\n    const args = {\n        ri,\n        ci,\n        index: len,\n        color,\n        index2: index,\n        className: selector.el.el.className,\n        erpx: it,\n        selector,\n    };\n    if (!mergeSelector) {\n        selector.el.show();\n        this.selectorsEl.child(selector.el);\n    }\n\n    if (multiple) {\n        return args;\n    }\n\n    this.selectorsEl.child(selector.el);\n    return args;\n}\n\nfunction clearSelectors() {\n    this.selectorsEl.html('');\n    this.selectors = [];\n    const {editor, selector} = this;\n    editor.setLock(false);\n\n    // //  @~esc ri ci-1\n    // editor.setRiCi(-1, -1);\n    editor.state = 1;\n    selector.el.show();\n}\n\n//  input\nfunction editingSelectors(text = '') {\n    if (typeof text === 'number') {\n        return;\n    }\n    const selectors_new = [];\n    const cut = cutStr(text, true);\n    // case 1   selectors\n    const {selectors_delete} = filterSelectors.call(this, cut);\n\n    Object.keys(selectors_delete).forEach((i) => {\n        const selector = selectors_delete[i];\n        selector.removeEl();\n    });\n\n\n    const selectors_valid = selectors_new;\n    // case 2   selectors\n    Object.keys(cut).forEach((i) => {\n        let enterCode = 1;\n        Object.keys(this.selectors).forEach((i) => {\n            const {selector} = this.selectors[i];\n            selector.el.removeEl();\n        });\n\n        // \n        let arr = '';\n        let sc = cut[i].replace(/\\$/g, \"\");\n        if (isAbsoluteValue(cut[i])) {\n            const notTrueValue = cut[i].replace(/\\$/g, '');\n            arr = expr2xy(notTrueValue);\n        } else if (sc.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n            enterCode = 2;\n        } else {\n            arr = expr2xy(cut[i]);\n        }\n\n        if (enterCode === 1) {\n            const ri = arr[1];\n            const\n                ci = arr[0];\n            const args = makeSelector.call(this, ri, ci, selectors_valid);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        } else if (enterCode === 2) {\n            const prx = cut[i].replace(/\\$/g, '').split(':')[0];\n            const lax = cut[i].replace(/\\$/g, '').split(':')[1];\n\n            const prx_index = expr2xy(prx);\n            const lax_index = expr2xy(lax);\n            let args = makeSelector.call(this, prx_index[1], prx_index[0], selectors_valid, true, null, false);\n            args = makeSelector.call(this, lax_index[1], lax_index[0], selectors_valid, true, args.selector, true);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        }\n    });\n    this.selectors = selectors_valid;\n\n    if (this.selectors.length > 0 || text[0] === '=') {\n        div2span.call(this, cutting(text), cutting2(text));\n    }\n}\n\n//  ( index\nfunction findBracketLeft(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i - 1; j > 0 && stop === false; j--) {\n        if (cut[j] === '(') {\n            stop = true;\n        }\n        if (cut[j] === ')') {\n            has++;\n        }\n    }\n\n    for (let j = i; j > 0 && begin === -1; j--) {\n        if (cut[j] === '(') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n// => { left: 0, right: 0,  exist: false }\nfunction findBracket(pos, cut, text) {\n    let args = {left: 0, right: 0, exist: false};\n    if (text[pos] !== ')') {\n        return args;\n    }\n    const right = pos;\n    const left = findBracketLeft.call(this, cut, right);\n\n    if (left !== -1 && right !== -1) {\n        args = {left, right, exist: true};\n    }\n    return args;\n}\n\n\n//  )  index\nfunction findBracketRight(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i + 1; j < cut.length && stop === false; j++) {\n        if (cut[j] === ')') {\n            stop = true;\n        }\n        if (cut[j] === '(') {\n            has++;\n        }\n    }\n\n    for (let j = i; j < cut.length && begin === -1; j++) {\n        if (cut[j] === ')') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n\nfunction suggestContent(pos, cut, inputText) {\n    // \n    // step 1. posindex\n    // step 2. 1\n    // step 3. \n    const content = {suggestContent: false, cut: '', pos: 1};\n    const begin = pos - 1;\n    const left = findBracketLeft.call(this, cut, begin);\n    const right = findBracketRight.call(this, cut, left);\n\n    if (left <= begin && left !== -1 && (right >= begin || right === -1)) {\n        content.suggestContent = true;\n        content.cut = cuttingByPos(inputText, left);\n    }\n\n    for (let i = left; i < begin + 1; i++) {\n        if (inputText[i] === ',') {\n            content.pos += 2;\n        }\n    }\n\n    return content;\n}\n\nfunction div2span(cut, cutcolor) {\n    const {editor} = this;\n\n    const spanArr = [];\n    let begin = -1;\n    let end = -1;\n\n    Object.keys(cut).forEach((i) => {\n        const spanEl = h('span', `formula_span${i}`);\n        Object.keys(cutcolor).forEach(() => {\n            if (cutcolor[i] && cutcolor[i].code !== -1 && cutcolor[i].data === cut[i]) {\n                const {color} = selectorColor(cutcolor[i].code);\n                spanEl.css('color', color);\n            }\n        });\n        spanEl.css('display', 'inline-block');\n        spanEl.css('cursor', 'text');\n\n        if (cut[i] === ' ') {\n            spanEl.html('&emsp;');\n        } else {\n            spanEl.html(cut[i]);\n        }\n\n        spanArr.push(spanEl);\n    });\n\n    // \n    const {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let content = {suggestContent: false, cut: ''};\n    if (inputText[pos - 1] === ')') {\n        begin = pos - 1;\n        end = findBracketLeft.call(this, cut, begin);\n    } else {\n        content = suggestContent.call(this, pos + 1, cut, inputText);\n    }\n\n\n    if (inputText !== '' && spanArr.length <= 0) {\n        const spanEl = h('span', 'formula_span');\n        spanArr.push(spanEl);\n    }\n    // \n    editor.mount2span(spanArr, begin, end, content);\n}\n\n\nexport {\n    lockCells,\n    clearSelectors,\n    editingSelectors,\n    findBracket,\n    suggestContent,\n    makeSelector,\n};\n","const baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\n// const fonts = (ary = []) => {\n//   const map = {};\n//   baseFonts.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\n\nexport {\n  fontSizes,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","import {expr2xy, xy2expr} from './alphabet';\nimport {look, look2} from \"../config\";\n// import XLSX_CALC from \"calc\"\n// var formulajs = require('formulajs');\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgsLen = 1; // A1,A2,A3...\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        // console.log('c:', c);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1) {\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log(operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    if (!subExpr) {\n        subExpr = \"\";\n    }\n    if (subExpr[0] >= '0' && subExpr[0] <= '9') {\n        return Number(subExpr);\n    }\n    if (subExpr[0] === '\"') {\n        return subExpr.substring(1);\n    }\n    const [x, y] = expr2xy(subExpr);\n    return cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        if (srcStack[i] === '+') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) + Number(top));\n        } else if (srcStack[i] === '-') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) - Number(top));\n        } else if (srcStack[i] === '*') {\n            stack.push(Number(stack.pop()) * Number(stack.pop()));\n        } else if (srcStack[i] === '/') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) / Number(top));\n        } else if (Array.isArray(srcStack[i])) {\n            const [formula, len] = srcStack[i];\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(srcStack[i])) {\n                return 0;\n            }\n            cellList.push(srcStack[i]);\n            let s = evalSubExpr(srcStack[i], cellRender);\n            stack.push(evalSubExpr(srcStack[i], cellRender));\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nfunction evalFormula(text, rule) {\n    if (typeof text !== 'string') {\n        return false;\n    }\n    // if (text.toUpperCase().indexOf(rule.toUpperCase()) === -1) {\n    //     return false;\n    // }\n    return text.toUpperCase().indexOf(rule.toUpperCase()) !== -1;\n}\n\nconst cellRender = (data, sheetbook, y, x, src, formulaMap, getCellText, cellList = []) => {\n    if (typeof src === 'undefined') {\n        return \"\";\n    }\n\n    if (typeof src === 'string' && look.indexOf(src.split(\"!\")[0]) !== -1) {\n        let len = src.length;\n        if(src.split(\" \")[0]) {\n            len = src.split(\" \")[0].length;\n        }\n        let a = JSON.parse(src.substring(src.indexOf(\"!\") + 1, len));\n        let s = look.indexOf(src.split(\"!\")[0]);\n\n        if (s === 1) {\n            return a.text;\n        } else if (s === 0) {\n            if (a && a[0]) {\n                let {name, value} = a[0];\n\n                if (value === 0 && a[1] && a[1].value !== 0) {\n                    return name;\n                } else if (value === 0 && !a[1]) {\n                    return name;\n                }\n            }\n        }\n\n        return look2;\n    }\n\n    if (src[0] === '=' && src[1] !== '=') {\n        // console.log(\"156\", sheetbook.Sheets.Sheet1[xy2expr(x, y)], xy2expr(x, y))\n        if (evalFormula(src.substring(1), \"wland\") || evalFormula(src.substring(1), \"wfr\") || evalFormula(src.substring(1), \"rtd\")\n            || evalFormula(src.substring(1), \"city\")) {\n            // let {date_formula} = data.settings;=MD.RTD(\"sina\", \"162411\", \"now\")\n            // date_formula.wland(date_formula, data);\n            return src.toUpperCase();\n        } else if (src.substring(1) && sheetbook && sheetbook.Sheets && sheetbook.Sheets[data.name] && sheetbook.Sheets[data.name][xy2expr(x, y)]) {\n            // sheetbook.Sheets.Sheet1[xy2expr(x, y)].f = src.substring(1).toUpperCase();\n            // XLSX_CALC.import_functions(formulajs);\n            // XLSX_CALC(sheetbook);\n\n            if ((sheetbook.Sheets[data.name][xy2expr(x, y)].f && sheetbook.Sheets[data.name][xy2expr(x, y)].f.search(/\\((\\+|\\-|\\*|\\/)/) !== -1) || sheetbook.Sheets[data.name][xy2expr(x, y)].v === undefined || sheetbook.Sheets[data.name][xy2expr(x, y)].v === \"\") {\n                return \"#ERROR!\";\n            }\n            sheetbook.Sheets[data.name][xy2expr(x, y)].v = sheetbook.Sheets[data.name][xy2expr(x, y)].v + \"\";\n\n            // let value = sheetbook.Sheets.Sheet1[xy2expr(x, y)].v ? sheetbook.Sheets.Sheet1[xy2expr(x, y)].v : \"NaN\";\n            return sheetbook.Sheets[data.name][xy2expr(x, y)].w ? sheetbook.Sheets[data.name][xy2expr(x, y)].w : sheetbook.Sheets[data.name][xy2expr(x, y)].v.replace(/'/g, \"\\\"\");\n        }\n        // const stack = infixExprToSuffixExpr(src.substring(1));\n        // if (stack.length <= 0) return src;\n\n        return src;\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","export const isMinus = (text) => {\n    if(isNaN(text)) {\n        return false;\n    } else if(text === \"\") {\n        return false;\n    }\n\n    // if(parseInt(text) >= 0)\n    //     return false;\n\n    return parseInt(text) < 0;\n};","/* global window */\nimport {isHave} from \"../core/helper\";\n\nfunction dpr() {\n    return window.devicePixelRatio || 1;       // \n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    let d = px * dpr() + \"\";\n    return parseInt(d, 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nfunction drawFlexFalse(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nfunction drawFlexTrue(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx + 6, sy);\n    ctx.lineTo(sx + 6, sy + 12);\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n                   top, bottom, left, right,\n               }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2);\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2);\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, fontSize, hoffset) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y = y + height / 2 - hoffset;\n            // y = y1;\n            // const y2 = y + padding + fontSize / 2 + 1;\n            // if (y1 < y2) y = y2;\n            // else y = y1;\n        } else if (align === 'bottom') {\n            y += height - hoffset * 2 - padding;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr() * 1, dpr() * 1);\n        this.cxc = {\n            indent: 250,\n            vIndent: 200,\n            canvasContext: this.ctx\n        }\n\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        // this.ctx.font.size = 30;\n        // console.log(\"203:\", this.ctx.font);\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    selfAdaptionHeight(box, txt, font) {\n        if (font === undefined || txt === undefined)\n            return;\n        let n = 1;\n        const textLine = {len: 0, start: 0};\n        let innerWidth = box.width - box.padding * 2;\n        for (let i = 0; i < txt.length; i += 1) {\n            if (textLine.len + box.padding >= innerWidth) {\n                n = n + 1;\n                textLine.len = 0;\n                textLine.start = i;\n            }\n            textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n        }\n\n        return n;\n    }\n\n    selfAdaptionTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width + box.padding * 2;\n    }\n\n    selfAdaptionOneTxtWidth(txt, font) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(txt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        // const {\n        //     align, valign, font, color, strike, underline, ignore, cindex\n        // } = attr;\n        const {\n            align, valign, font, color, strike, underline, ignore\n        } = attr;\n\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n\n        let txtWidth = this.selfAdaptionTxtWidth(txt, font, box);\n        let hoffset = 0;\n        let innerWidth = box.innerWidth();\n        if (textWrap) {\n            innerWidth = box.width - box.padding * 2;\n            const n = this.selfAdaptionHeight(box, txt, font);\n            hoffset = ((n - 1) * font.size) / 2;\n            // for (let i = 0; i < ignore.length; i++) {\n            //     if (cindex != ignore[i]) {\n            //         // hoffset = 0;\n            //     } else if (cindex == ignore[i]) {\n            //     }\n            // }\n        }\n        let ty = box.texty(valign, font.size, hoffset);\n        if (textWrap && txtWidth > innerWidth) {\n            const textLine = {len: 0, start: 0};\n            for (let i = 0; i < txt.length; i += 1) {\n                if (textLine.len + box.padding >= innerWidth) {\n                    // debugger\n                    this.fillText(txt.substring(textLine.start, i), tx, ty);\n                    if (strike) {\n                        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    if (underline) {\n                        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    ty += font.size + 2;\n                    textLine.len = 0;\n                    textLine.start = i;\n                }\n                textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n            }\n            if (textLine.len > 0) {\n                this.fillText(txt.substring(textLine.start), tx, ty);\n                if (strike) {\n                    drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                }\n                if (underline) {\n                    drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                }\n            }\n        } else {\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'striket', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n        }\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        ctx.beginPath();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropUp(box, state, diff) {\n        const {ctx} = this;\n        const {\n            x, y, height,\n        } = box;\n\n        const sx = x + 10;\n        const sy = y + height - 18 - diff;\n\n        // if (state) {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278539177.svg\";\n        // } else {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278579742.svg\";\n        // }\n        // img.onload = function () {\n        //   ctx.drawImage(img, npx(sx), npx(sy), 16, 16);\n        // }\n        if (state) {\n            drawFlexTrue.call(this, ctx, npx(sx), npx(sy))\n        } else {\n            drawFlexFalse.call(this, ctx, npx(sx), npx(sy))\n        }\n    }\n\n\n\n    lineTo(x, y) {\n        this.cxc.canvasContext.lineTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    moveTo(x, y) {\n        this.cxc.canvasContext.moveTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    };\n\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n\n    rect2(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, bgcolor,\n        } = box;\n        let {height} = box;\n        // if (textwrap == true) {\n        //     console.log(\"487\")\n        //     const n = this.selfAdaptionHeight(box, cellText);\n        //     height = height * n;\n        //     console.log(\"495\", height)\n        // }\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor === \"rgba(0, 0, 0, 0)\" ? '#fff' : bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","import {isHave} from \"../core/helper\";\n\nexport function testValid(valid = this.valid) {\n    if(isHave(valid)) {\n       valid.assert();\n    }\n}","import { stringAt} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {isMinus} from \"../utils/number_util\";\nimport {Draw, DrawBox, npx, thinLineWidth,} from '../canvas/draw';\nimport {look} from \"../config\";\n// import {deepCopy, distinct} from \"../core/operator\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n// import Worker from 'worker-loader!../external/Worker2.js';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(rindex, cindex) {\n    const {data} = this;\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\n// function getAutoDrawBox(rindex, cindex, width) {\n//     const {data} = this;\n//     const {\n//         left, top, height\n//     } = data.cellRect(rindex, cindex);\n//     return new DrawBox(left, top, width, height, cellPaddingWidth);\n// }\n\n// function getCellTextStyle(rindex, cindex) {\n//     const {data} = this;\n//     const {sortedRowMap} = data;\n//     let nrindex = rindex;\n//     if (sortedRowMap.has(rindex)) {\n//         nrindex = sortedRowMap.get(rindex);\n//     }\n//\n//     return data.getCellStyleOrDefault(nrindex, cindex);\n// }\n\nexport function toUpperCase(text) {\n    text = text.toString().toUpperCase();\n\n    return text;\n}\n\nfunction getChangeDataToCalc() {\n    let {data} = this;\n    let changeData = data.changeDataForCalc;\n    if (!isHave(changeData)) {\n        return {\n            \"state\": false,\n            \"data\": null,\n        }\n    } else {\n        return {\n            \"state\": true,\n            \"data\": changeData\n        }\n    }\n}\n\nfunction parseCell() {\n    let {data} = this;\n\n    let changeDataArgs = getChangeDataToCalc.call(this);\n    // data.calc(data.rows, changeDataArgs.data);\n\n    if (changeDataArgs.state) {\n        data.changeDataForCalc = null;\n    }\n}\n\n// export function parseCell2(viewRange, state = false, src = '') {\n//     let {data} = this;\n//     let {calc, rows} = data;\n//     let workbook = [];\n//     workbook.Sheets = {};\n//     workbook.Sheets[data.name] = {};\n//\n//     viewRange.each2((ri, ci) => {\n//         let cell = data.getCell(ri, ci);\n//         let expr = xy2expr(ci, ri);\n//         if (cell && cell.text) {\n//             cell.text = cell.text + \"\";\n//             if (cell.text.indexOf(\"MD.RTD\") !== -1) {\n//                 workbook.Sheets[data.name][expr] = {v: \"\", f: \"\"};\n//             } else {\n//                 if (cell.text && cell.text.lastIndexOf(\"=\") === 0) {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: '',\n//                         f: cell.text.replace(//g, '').replace(/\\\"/g, \"\\\"\").replace(/\\\"\\\"\\\"\\\"&/g, \"\\\"'\\\"&\")\n//                     };\n//                 } else {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: cell.text.replace(//g, '').toUpperCase().replace(/\\\"/g, \"\\\"\"),\n//                         f: ''\n//                     };\n//                 }\n//             }\n//         }\n//         else {\n//             workbook.Sheets[data.name][expr] = {v: 0, f: 0};\n//         }\n//     });\n//\n//\n//     if (state) {\n//         workbook.Sheets[data.name]['A1'] = {v: '', f: `${src}`};\n//     }\n//\n//     try {\n//         calc(workbook);\n//     } catch (e) {\n//         console.error(e);\n//     }\n//     return workbook;\n// }\n\nfunction specialStyle(text) {\n    text = text + \"\";\n    if (!text) {\n        return false;\n    }\n\n    return look.indexOf(text.split(\"!\")[0]) === 1;\n}\n\nfunction renderCell(rindex, cindex) {\n    const {draw, data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (!isHave(cell)) return;\n    // data.rows.setHeight(1, 50);\n\n    // console.log(rindex, nrindex, \"63\")\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox.call(this, rindex, cindex);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n\n    let cellText = \"\";\n\n    if (data.showEquation) {\n        if(isHave(cell.formulas)) {\n            cellText = cell.formulas;\n        }\n    } else if(isHave(cell.text)) {\n        cellText = cell.text;\n    }\n    draw.rect2(dbox, () => {\n        // render text\n        let args = data.renderFormat(style, cell, nrindex, cindex, false);\n        cellText = args.state ? args.cellText : cellText;\n        const font = Object.assign({}, style.font);\n\n        font.size = getFontSizePxByPt(font.size);\n        let {ignore, minus} = data.settings;\n        let color = style.color;\n        // console.log('style:', cellText);\n        if (minus === true && isMinus(cellText)) {\n            color = 'red'\n        }\n        let underline = style.underline;\n        let regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\n        cellText = cellText + \"\";\n        let text = cellText.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + cellText : cellText;\n        if (regex.test(text) || specialStyle(cell.text)) {\n            color = \"#4b89ff\";\n            underline = true;\n        }\n\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: color,\n            strike: style.strike,\n            underline: underline,\n            ignore: ignore,\n            cindex: cindex,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            draw.error(dbox);\n        }\n    });\n}\n\nfunction renderFlexible() {\n    const {draw, data} = this;\n    const {autoFilter} = data;\n    const {flex} = autoFilter;\n\n    for (let i = 0; i < flex.length; i++) {\n        let {ri, ci, state} = flex[i];\n        let s_t = 0;\n        for (let j = 0; j < i; j++) {\n            let {set_total, state} = flex[j];\n            if (state === true) {\n                s_t += set_total;\n            }\n        }\n\n        const dbox = getDrawBox.call(this, ri, ci);\n        draw.dropUp(dbox, state, s_t * 25);\n    }\n\n    // const dbox = getDrawBox.call(this, ri, ci);\n    // draw.dropUp(dbox);\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n\n        if (!autoFilter.active()) {\n            return;\n        }\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                const dbox = getDrawBox.call(this, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n    // renderFlexible.call(this, 1, 1)\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n    // 1 render cell\n    draw.save();\n\n    viewRange.each((ri, ci) => {\n        renderCell.call(this, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n    // 2 render cell border\n    // draw.save();\n    // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));\n    // draw.restore();\n\n    // / bboxes = [];\n    // 3 render mergeCell\n    const rset = new Set();\n    draw.save();\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell.call(this, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n\n    // 4 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    // 5 render flex\n    renderFlexible.call(this);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n                               sri, sci, eri, eci, w, h,\n                           }, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data, editor) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        // this.factory = new ApplicationFactory(data.methods, data.name, this);\n        this.editor = editor;\n        this.data = data;\n        this.timer = null;\n        // this.worker = new Worker();\n        this.autoAdaptList = [];\n    }\n\n\n    getCellTextContent(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const cell = data.getCell(nrindex, cindex);\n        if (cell === null) return;\n        // console.log(\"62\", cell.adapt);\n\n        return _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n    }\n\n    getDrawBox(rindex, cindex) {\n        const {data} = this;\n        const {\n            left, top, width, height,\n        } = data.cellRect(rindex, cindex);\n        return new DrawBox(left, top, width, height, cellPaddingWidth);\n    }\n\n    getCellTextStyle(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        return data.getCellStyleOrDefault(nrindex, cindex);\n    }\n\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        let viewRange = data.viewRange();\n\n        parseCell.call(this);\n        this.clear();\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        let fh = rows.height;\n\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n\n        renderFixedLeftTopCell.call(this, fw, fh);\n\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3x\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n        testValid.call(this);\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","import {cuttingByPos, cuttingByPosEnd2, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {toUpperCase} from \"./table\";\n\nexport default class EditorText {\n    constructor() {\n        this.inputText = \"\";\n        this.oldCell = \"\";\n        this.ri = -1;\n        this.ci = -1;\n    }\n\n    setText(text) {\n        this.inputText = text;\n        return this.getText();\n    }\n\n    getText() {\n        return this.inputText;\n    }\n\n    setOldCell(oldCell, {ri = -1, ci = -1} = -1) {\n        this.oldCell = oldCell;\n        this.ri = ri;\n        this.ci = ci;\n        return this.getOldCell();\n    }\n\n    // setRICI(ri, ci) {\n    //    this.ri = ri;\n    //     this.ci = ci;\n    // }\n\n    getOldCell() {\n        return this.oldCell;\n    }\n\n    getRICI() {\n        return {\n            \"ri\": this.ri,\n            \"ci\": this.ci,\n        };\n    }\n\n    changeText(type) {\n        if (type === 1) {\n            this.setText(this.getText().replace(//g, ','));\n        }\n    }\n\n    isFormula() {\n        let inputText = this.getText();\n\n        return inputText.lastIndexOf(\"=\") === 0;\n    }\n\n    f4ShortcutKey(pos) {\n        let inputText = this.setText(toUpperCase(this.inputText));\n        let value = cuttingByPos(inputText, pos, true);\n        let value2 = cuttingByPosEnd2(inputText, pos + 1);\n        console.log(value2);\n        let type = isAbsoluteValue(value, 5);\n        let d = \"\";\n        let n = value.split(\":\")[1];\n        if (n) {\n            type = isAbsoluteValue(n, 5);\n            type = type === 3 ? 6 : type;\n            type = type === 12 ? 9 : type;\n            type = type === 1 ? 7 : type;\n            type = type === 2 ? 8 : type;\n            console.log(type);\n        }\n\n        if (type !== false) {\n            switch (type) {\n                case 13:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    let text_b = inputText.substring(0, inputText.lastIndexOf(n));\n                    inputText = this.setText(text_b + d);\n                    break;\n                case 12:\n                    n = value;\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    console.log(value2absolute(value));\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    console.log(this.getText());\n                    break;\n                case 11:\n                case 10:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 9:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 8:\n                    n = value.split(\":\")[1];\n                    d = n.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 7:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 6:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 5:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 4:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 3:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 2:\n                    d = value.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 1:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n            }\n        }\n        let newPos = inputText.length;\n        inputText = this.setText(inputText + value2);\n        return {\n            \"pos\": newPos,\n            \"inputText\": inputText\n        };\n    }\n}\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\nimport {\n    cutting,\n    cuttingByPos,\n    cuttingByPos2,\n    cuttingByPosEnd,\n    deepCopy,\n    isAbsoluteValue,\n    operation\n} from '../core/operator';\nimport SuggestContent from './suggest_content';\nimport {findBracket, suggestContent} from './formula_editor';\nimport {createEvent} from './event';\nimport EditorText from \"./editor_text\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n\nfunction resetTextareaSize() {\n    const {\n        textlineEl, textEl, areaOffset,\n    } = this;\n    if (!areaOffset) {\n        return;\n    }\n    const tlineWidth = textlineEl.offset().width + 9 + 15;\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\n    if (tlineWidth > areaOffset.width && areaOffset.width !== 0) {\n        let twidth = tlineWidth;\n        if (tlineWidth > maxWidth) {\n            twidth = maxWidth - 15;\n            let h1 = parseInt(tlineWidth / (maxWidth - 15), 10);\n            h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            h1 *= this.rowHeight;\n            if (h1 > areaOffset.height) {\n                textEl.css('height', `${h1}px`);\n            }\n        }\n        textEl.css('width', `${twidth}px`);\n    }\n}\n\nfunction textFormat(e) {\n    e.preventDefault();\n    let text = \"\";\n    let clp = (e.originalEvent || e).clipboardData;\n    if (clp === undefined || clp === null) {\n        text = window.clipboardData.getData('text') || '';\n        if (text !== '') {\n            if (window.getSelection) {\n                let newNode = document.createElement('span');\n                newNode.innerHTML = text;\n                window.getSelection().getRangeAt(0).insertNode(newNode)\n            } else {\n                document.selection.createRange().pasteHTML(text)\n            }\n        }\n    } else {\n        text = clp.getData('text/plain') || '';\n        if (text !== '') {\n            document.execCommand('insertText', false, text)\n        }\n    }\n}\n\nconst getCursortPosition = function () {\n    let selection = window.getSelection();\n    if (selection.rangeCount <= 0) {\n        return 0;\n    }\n    const range = window.getSelection().getRangeAt(0);\n    const preSelectionRange = range.cloneRange();\n    preSelectionRange.selectNodeContents(this.textEl.el);\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n    const start = preSelectionRange.toString().length;\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    const {exist, left, right} = findBracket(start - 1, cutting(inputText), inputText);\n    Object.keys(this.spanArr).forEach((i) => {\n        this.spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n    });\n    const spanLeft = this.spanArr[left];\n    const spanRight = this.spanArr[right];\n    this.suggestContent.hide();\n    if (exist && spanLeft && spanRight) {\n        spanLeft.css('background-color', 'rgb(229, 229, 229)');\n        spanRight.css('background-color', 'rgb(229, 229, 229)');\n    } else {\n        const {show} = this.suggest;\n        const content = suggestContent.call(this, start, cutting(inputText), inputText);\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        }\n    }\n\n    return start;\n};\n\nfunction set_focus(el) {\n    if (!this) {\n        return;\n    }\n    const savedSel = {\n        start: this.pos,\n        end: this.pos,\n    };\n    let charIndex = 0;\n    const\n        range = document.createRange();\n    range.setStart(el, 0);\n    range.collapse(true);\n    const nodeStack = [el];\n    let node;\n    let foundStart = false;\n    let\n        stop = false;\n\n    while (!stop && (node = nodeStack.pop())) {\n        if (node.nodeType === 3) {\n            const nextCharIndex = charIndex + node.length;\n            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\n                range.setStart(node, savedSel.start - charIndex);\n                foundStart = true;\n            }\n            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\n                range.setEnd(node, savedSel.end - charIndex);\n                stop = true;\n            }\n            charIndex = nextCharIndex;\n        } else {\n            let i = node.childNodes.length;\n            while (i--) {\n                nodeStack.push(node.childNodes[i]);\n            }\n        }\n    }\n\n    const sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\n// const setCursorPosition = (elem, index) => {\n//     const val = elem.value || elem.textContent;\n//     const len = val.length;\n//\n//     // \n//     if (len < index) return;\n//     set_focus.call(this, elem);\n// };\n\nfunction mouseDownEventHandler() {\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    this.pos = getCursortPosition.call(this);\n    parse2.call(this, inputText, this.pos);\n}\n\nfunction setOldCell() {\n    let d = isDisplay.call(this);\n    if (d === false) {\n        let cell = this.data.getCell(this.ri, this.ci);\n        this.editorText.setOldCell(deepCopy(cell), {ri: this.ri, ci: this.ci});\n    }\n}\n\nfunction inputEventHandler(evt, txt = '', formulas = '', state = \"input\") {\n    setOldCell.call(this);\n\n    if (evt) {\n        const {\n            inputType,\n        } = evt;\n\n        if (inputType === 'insertFromPaste' && this.textEl.el.style['caret-color'] !== 'black') {\n            this.copy = true;\n            return;\n        }\n\n        if (inputType === 'historyUndo') {\n            return;\n        }\n    }\n\n\n    let {editorText} = this;\n    // let inputText = editorText.getText();\n\n    // if (inputText === '') {\n    //     const {data} = this;\n    //     const {history} = data;\n    //     history.add(data.getData());\n    // }\n\n    setTimeout(() => {\n        if (this.chinese === false) return;\n        let v = '';\n        if (this.data.settings.showEditor) {\n            this.sheet.selector.hide();\n        } else {\n            return;\n        }\n\n        if (txt === '' && evt && evt.target && evt.target.childNodes) {\n            let t1 = '';\n            for (let i = 0, len = evt.target.childNodes.length; i < len; i++) {\n                if (evt.target.childNodes[i].nodeType === 1) {\n                    v += evt.target.childNodes[i].innerText;\n                } else if (evt.target.childNodes[i].nodeType === 3) {\n                    t1 += evt.target.childNodes[i].nodeValue;\n                }\n            }\n            v = t1 !== '' ? t1 : v;\n        } else if (txt === '' && evt && isHave(evt.data)) {\n            v = evt.data !== '' ? evt.data : v;\n        } else {\n            v = txt;\n        }\n\n        if (this.copy) {\n            this.copy = false;\n            v = (evt && evt.data) ? evt.data : '';\n            this.textEl.html(v);\n            this.pos = v.length;\n            set_focus.call(this, this.textEl.el, -1);\n        }\n        this.changed = true;\n        const {\n            suggest, textlineEl, validator, textEl,\n        } = this;\n        editorText.setText(`${v}`);\n        // inputText = `${v}`;\n        editorText.changeText(1);\n        // inputText = inputText.replace(//g, ',');\n        this.pos = getCursortPosition.call(this);\n\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            v = v + \"\";\n            const start = v.lastIndexOf('=');\n            if (this.pos !== -1) {\n                parse2.call(this, v, this.pos);\n            } else parse.call(this, v);\n            let show = false;\n            let cutValue = cuttingByPos2(v, this.pos, true);\n            if (v.length >= this.pos) {\n                const isNumber = `${v[this.pos]}`;\n                if (isNumber.search(/^[0-9]+.?[0-9]*$/) !== -1) {\n                    show = true;\n                } else if (isNumber) {\n                    cutValue += cuttingByPosEnd(v, this.pos + 1);\n                }\n            }\n\n            if (start === 0 && v.length > 1 && cutValue !== '' && !show && cutValue.trim().length > 0) {\n                suggest.search(cutValue);\n            } else {\n                suggest.hide();\n            }\n        }\n\n\n        textlineEl.html(formulas || v);\n        editorText.setText(formulas || v);\n        this.suggest.itemIndex = -1;\n        resetTextareaSize.call(this);\n        if (v && v[0] !== '=') {\n            set_focus.call(this, textEl.el, -1);\n        }\n\n        if (formulas && formulas[0] === '=') {\n            v = formulas;\n        }\n        this.change(state, v);\n        // testValid.call(this);\n        setTimeout(() => {\n            this.show();\n        });\n    });\n\n}\n\nfunction keyDownEventHandler(evt) {\n    this.pos = getCursortPosition.call(this);\n    if (evt.code === 'ArrowRight') {\n        this.pos = this.pos + 1;\n    } else if (evt.code === 'ArrowLeft') {\n        this.pos = this.pos - 1;\n    }\n\n    const keyCode = evt.keyCode || evt.which;\n    // this.textEl.el.style['caret-color'] != 'black' esc\n    if (keyCode === 27 && this.textEl.el.style['caret-color'] === 'black' && this.textEl.el.style.opacity === '1') {\n        this.change('input', '@~esc');\n    } else if (keyCode === 37 || keyCode === 38 || keyCode === 39 || keyCode === 40) {\n    }\n}\n\nfunction parse(v) {\n    const start = v.lastIndexOf('=');\n\n\n    if (start === 0 && v.length >= 1 && operation(v[v.length - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, this.pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction parse2(v, pos) {\n    v = v + \"\";\n    const start = v.lastIndexOf('=');\n    if (start === 0 && v.length >= 1 && operation(v[pos - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction setTextareaRange() {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        // el.focus();\n        set_focus.call(this, el);\n        // el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text) {\n    const {textEl, textlineEl, tmp} = this;\n    // firefox bug\n    textEl.el.blur();\n    tmp.html(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this);\n}\n\n\nfunction suggestItemClick(it) {\n    const {validator, editorText} = this;\n    let inputText = editorText.getText();\n    if (validator && validator.type === 'list') {\n        // this.inputText = it;\n        inputText = editorText.setText(it);\n    } else {\n        this.pos = getCursortPosition.call(this);\n        const begin = this.pos - cuttingByPos(inputText, this.pos).length;\n        const c = cuttingByPosEnd(inputText, this.pos + 1);\n        const arr = ['', ''];\n        const end = this.pos + c.length;\n        for (let i = 0; i < inputText.length; i++) {\n            if (i < begin) {\n                arr[0] += inputText[i];\n            }\n\n            if (i > end - 1) {\n                arr[1] += inputText[i];\n            }\n        }\n        inputText = editorText.setText(`${arr[0] + it.key}(`);\n        // this.inputText = `${arr[0] + it.key}(`;\n        this.pos = editorText.getText().length;\n        inputText = editorText.setText(inputText + `)${arr[1]}`);\n        // this.inputText += `)${arr[1]}`;\n    }\n    this.textEl.html(inputText);\n    this.textlineEl.html(inputText);\n    this.suggest.hide();\n    parse2.call(this, inputText, this.pos);\n    this.change('input', inputText);\n    set_focus.call(this, this.textEl.el, -1);\n    resetTextareaSize.call(this);\n}\n\nfunction resetSuggestContentItems() {\n    this.suggestContent.hide();\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nfunction isDisplay() {\n    // if (this.textEl.el.style['caret-color'] === 'black'\n    //     && this.textEl.el.style.opacity === '1') return true;\n    return this.textEl.el.style['caret-color'] === 'black'\n        && this.textEl.el.style.opacity === '1';\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight, rowWidth, data, sheet) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.sheet = sheet;\n        this.display = true;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        }, data, this);\n        this.suggestContent = new SuggestContent();\n        this.lock = false;\n        this.state = 1;\n        this.data = data;\n        this.datepicker = new Datepicker();\n        this.isCors = false;\n        this.datepicker.change((d) => {\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.ri = -1;\n        this.ci = -1;\n        this.spanArr = [];\n        this.mousedownIndex = [];\n        this.changed = false;\n        this.chinese = true;\n\n        this.editorText = new EditorText('');\n\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('div', `${cssPrefix}-editor-textEl`)\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('click', () => mouseDownEventHandler.call(this,))\n                    .on('keyup', evt => keyDownEventHandler.call(this, evt))\n                    .on('mousedown', (evt) => {\n                        if (evt.detail === 2) {\n                            if (isDisplay.call(this)) {\n                                return;\n                            }\n                            this.show();\n                            setTimeout(() => {\n                                const {ri, ci} = this;\n                                console.log(ri, ci);\n                                this.setCellEnd(data.getSelectedCellRiCi(ri, ci));\n                            });\n                        }\n                    })\n                    .on('compositionstart', () => {\n                        this.chinese = false;\n                    })\n                    .on('compositionend', ( ) => {\n                        this.chinese = true;\n                    })\n                    .on('paste', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 67, true, \"paste\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('copy', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 86, true, \"sheetCopy\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('keydown', (evt) => {\n                        resetTextareaSize.call(this);\n                        this.textlineEl.html(evt.currentTarget.innerText);\n                        const key_num = evt.keyCode;\n                        // ctrl + v 67     ctrl + v  86\n                        if (key_num === 38 || key_num === 40) {\n                            evt.preventDefault();\n                        }\n                        if (key_num === 115) {       // F4\n                            let {inputText, pos} = this.editorText.f4ShortcutKey(getCursortPosition.call(this));\n                            inputEventHandler.call(this, null, inputText, inputText);\n                            setTimeout(() => {\n                                this.pos = pos;\n                                set_focus.call(this, this.textEl.el, -1);\n                            });\n                            return;\n                        }\n                        if (this.textEl.el.style['caret-color'] === 'black') return;\n                        const {\n                            ctrlKey, metaKey,\n                        } = evt;\n\n                        if (key_num === 8 || key_num === 46) {\n                            createEvent.call(this, 8, false);\n                        } else if (key_num === 40) {\n                            this.clear();\n                            createEvent.call(this, 40, false);\n                        } else if (key_num === 39) {\n                            this.clear();\n                            createEvent.call(this, 39, false);\n                        } else if (key_num === 37) {\n                            this.clear();\n                            createEvent.call(this, 37, false);\n                        } else if (key_num === 38) {\n                            this.clear();\n                            createEvent.call(this, 38, false);\n                        } else if (ctrlKey || metaKey) {\n                            if (key_num === 67) {\n                                createEvent.call(this, 67, true);\n                            } else if (key_num === 86) {\n                                createEvent.call(this, 86, true);\n                            } else if (key_num === 88) {\n                                createEvent.call(this, 88, true);\n                            } else if (key_num === 90) {\n                                createEvent.call(this, 90, true);\n                            } else if (key_num === 66) {\n                                createEvent.call(this, 66, true);\n                            }\n                        }\n                    }),\n                this.textlineEl = h('div', 'textline'),\n                this.suggestContent.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n\n        sheet.el.child(this.suggest.el);\n        this.el = h('div', `${cssPrefix}-editor`)\n            .children(this.areaEl);\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.textEl.on('paste', (evt) => {\n            if (isDisplay.call(this) === false)\n                return;\n            textFormat(evt);\n        });\n        this.tmp = h('span', 'span_tmp').hide();\n        this.textEl.attr('contenteditable', 'true');\n        this.textEl.css('width', `${rowWidth - 3}px`);\n        this.textEl.css('height', `${rowHeight - 2}px`);\n        this.textEl.child(this.tmp);\n        this.pos = 0;\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n\n        setTimeout(() => {\n            this.show(false);\n        });\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    setMouseDownIndex(index) {\n        this.mousedownIndex = index;\n    }\n\n    setRiCi(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n        // if (this.ri === -1 || this.ci === -1) {\n        //     return false;\n        // }\n        // const cell = this.data.rows.getCell(ri, ci);\n        //\n        // this.editorText.setOldCell(deepCopy(cell));\n    }\n\n    setLock(lock) {\n        this.lock = lock;\n    }\n\n    getLock() {\n        return this.lock;\n    }\n\n\n    show(off = true) {\n\n        if (off && this.data.settings.showEditor) {\n            this.textEl.css('caret-color', 'black');\n            this.textEl.css('cursor', 'text');\n            this.textEl.css('opacity', '1');\n            this.textEl.el.focus();\n            this.areaEl.css('pointer-events', 'auto');\n            this.areaEl.css('border', '2px solid #4b89ff');\n            this.areaEl.css('background', 'white');\n        } else {\n            this.textEl.css('caret-color', 'white');\n            this.textEl.css('cursor', 'default');\n            this.textEl.css('opacity', '0');\n            this.textEl.el.blur();\n            this.areaEl.css('pointer-events', 'none');\n            this.areaEl.css('background', 'rgba(75, 137, 255, 0)');\n            this.areaEl.css('border', 'none');\n        }\n    }\n\n    parse(pos = -1) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n        if (pos !== -1) {\n            this.pos = getCursortPosition.call(this);\n            parse2.call(this, inputText, this.pos);\n        } else {\n            parse.call(this, inputText);\n        }\n    }\n\n    clear(c = false) {\n\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        this.display = isDisplay.call(this);\n\n        if (inputText !== '' && isNaN(inputText) && inputText.replace(/\\s/g, \"\").lastIndexOf('') === 0) {\n            this.change('format', inputText);\n\n        } else if (this.changed) {\n\n            this.change('finish', inputText);\n\n        }\n\n        this.changed = false;\n        this.cell = null;\n        this.areaOffset = null;\n        editorText.setText('');\n        // this.inputText = '';\n        this.show(false);\n        this.copy = false;\n        set_focus.call(this, this.textEl.el, -1);\n        this.pos = 0;\n        this.tmp.hide();\n        this.textEl.html('');\n        this.textlineEl.html('');\n        resetSuggestContentItems.call(this);\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n\n        if (c) {\n            return false;\n        }\n\n        setTimeout(() => {\n            const {ri, ci} = this.data.selector;\n            this.setRiCi(ri, ci);\n        });\n\n        return this.display;\n    }\n\n    mount2span(spanArr, pos = -1, begin = -1, content = {suggestContent: false, cut: '', pos: -1}) {\n        if (this.spanArr === spanArr) {\n            return;\n        }\n\n        const {show} = this.suggest;\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        } else {\n            this.suggestContent.hide();\n        }\n        Object.keys(spanArr).forEach((i) => {\n            spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n        });\n        if (pos !== '-1' && begin !== -1 && spanArr[pos]) {\n            spanArr[pos].css('background-color', '#e5e5e5');\n            spanArr[begin].css('background-color', '#e5e5e5');\n        }\n\n        if (spanArr.length > 0) {\n            this.textEl.html('');\n            this.tmp = h('span', 'span_tmp').children(...spanArr)\n                .css('top', '0px').css('color', 'black').css('font-size', '14px').css('font-family', 'm-inconsolata,monospace,arial,sans,sans-serif');\n            this.textEl.el.insertBefore(this.tmp.el, this.textEl.el.childNodes[0]);\n            // this.textEl.el.removeChild(this.textEl.el.childNodes[this.textEl.el.childNodes.length - 1]);\n            set_focus.call(this, this.textEl.el, -1);\n        }\n\n        this.spanArr = spanArr;\n    }\n\n    // handler(text) {\n    //     let {editorText} = this;\n    //     let inputText = editorText.getText();\n    //\n    //     const cursorPos = this.pos;\n    //     if (cursorPos >= inputText) {\n    //         this.setMouseDownIndex([]);\n    //         return;\n    //     }\n    //     const textBegin = text.substring(0, cursorPos);\n    //     const textEnd = text.substring(cursorPos, text.length);\n    //     parse.call(this, textBegin);\n    //     if (textEnd !== '') {\n    //         this.setMouseDownIndex([textBegin, textEnd]);\n    //     } else {\n    //         this.setMouseDownIndex([]);\n    //     }\n    // }\n\n    setOffset(offset, suggestPosition = 'top', show = true) {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 2 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            // suggest.setOffset(sOffset);\n            suggest.hide();\n            resetTextareaSize.call(this);\n            if (show) {\n                this.show(false);\n            }\n        }\n    }\n\n    setCellEnd(cell) {\n        let text = '';\n        let formulas = (cell && cell.formulas) || '';\n        if (isHave(cell) && isHave(cell.text)) {\n            text = cell.text;\n        }\n\n        if (isHave(cell) && isHave(cell.formulas)) {\n            text = cell.formulas;\n        }\n\n        let {data} = this;\n        let {rows} = data;\n        const style = data.getCellStyleOrDefault(this.ri, this.ci);\n        let args = data.renderFormat(style, cell, this.ri, this.ci, true);\n        if(args.state) {\n            text = args.cellText;\n            formulas = args.cellText;\n        }\n\n        this.textEl.child(text + \"\");\n        this.pos = text.length;\n        set_focus.call(this, this.textEl.el, -1);\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n\n        testValid.call(this);\n        inputEventHandler.call(this, null, text, formulas, \"end\");\n\n        setTimeout(() => {\n            this.pos = rows.toString(text).length;\n            set_focus.call(this, this.textEl.el, -1);\n        }, 20)\n    }\n\n    setCell(cell, validator, type = 1) {\n        this.cell = cell;\n        this.show();\n\n        let text = (cell && cell.formulas) || '';\n        text = text === '' ? (cell && cell.text) || '' : text;\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.textEl.show();\n        set_focus.call(this, this.textEl.el, -1);\n        setTimeout(() => {\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el);\n        }, 10);\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n\n        if (type === 2 && text !== '' && text[0] === '=') {\n            inputEventHandler.call(this, null, text);\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el, text.length);\n        } else if (type === 2 && text[0] !== '=') {\n            this.textEl.child(text);\n        }\n        setTimeout(() => {\n            this.textlineEl.html(text);\n            resetTextareaSize.call(this);\n        });\n    }\n\n    // inputEventHandler(text = '', pos = 1, hide = false) {\n    //     if (hide) {\n    //         this.areaEl.hide();\n    //         this.sheet.selector.hide();\n    //         this.isCors = true;\n    //     }\n    //     this.setCursorPos(pos);\n    //     inputEventHandler.call(this, null, text);\n    // }\n\n    // isDisplay() {\n    //     let {editorText} = this;\n    //\n    //     return isDisplay.call(this) && editorText.isFormula();\n    // }\n\n    isDisplay2() {\n        return isDisplay.call(this)\n    }\n\n    setCursorPos(pos) {\n        this.pos = pos;\n        set_focus.call(this, this.textEl.el);\n    }\n\n    setText(text) {\n        let {editorText} = this;\n        editorText.setText(text);\n        // this.inputText = text;\n        setText.call(this, text);\n        resetTextareaSize.call(this);\n        this.textEl.child(this.tmp);\n    }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  // { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  // { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  // { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', (evt) => {\n      this.itemClick(item.key, evt);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false) {\n    this.menus = buildMenu.call(this);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menus)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { height, width } = el.show().offset();\n    const view = this.viewFn();\n    let top = y;\n    let left = x;\n    if (view.height - y <= height) {\n      top -= height;\n    }\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.offset({ left, top });\n    bindClickoutside(el);\n  }\n}\n","import {Element, h} from './element';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Dropdown extends Element {\n    constructor(title, width, showArrow, placement, {type, change, arrowChange, historyBorder}, ...children) {\n        super('div', `${cssPrefix}-dropdown ${placement}`);\n\n        this.title = title;\n        this.change = () => {\n        };\n        if (typeof title === 'string') {\n            this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n        } else if (showArrow) {\n            this.title.addClass('arrow-left');\n        }\n        this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n            .children(...children)\n            .css('width', width)\n            .hide();\n\n        if (type) {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`).on('click', change);\n            this.headerEl.children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right_d`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`).on('click.stop', (evt) => {\n                        arrowChange(historyBorder);\n                        if (this.contentEl.css('display') !== 'block') {\n                            this.show();\n                        } else {\n                            this.hide();\n                        }\n                    }),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        } else {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n            this.headerEl.on('click', () => {\n                if (this.contentEl.css('display') !== 'block') {\n                    this.show();\n                } else {\n                    this.hide();\n                }\n            }).children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        }\n    }\n\n    setTitle(title) {\n        this.title.html(title);\n        this.hide();\n    }\n\n    show() {\n        const {contentEl} = this;\n        contentEl.show();\n        this.parent().active();\n        bindClickoutside(this.parent(), () => {\n            this.hide();\n        });\n    }\n\n    hide() {\n        this.parent().active(false);\n        this.contentEl.hide();\n        unbindClickoutside(this.parent());\n    }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', {type: false}, ...nfonts );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', {type: false}, ...nfontSizes );\n  }\n}\n","import {tf} from '../locale/locale';\nimport {isHave, isNumber} from \"./helper\";\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v, fixed = 2) => {\n    if(!isHave(v) || !isNumber(v)) {\n        return v;\n    }\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = fixed === -1 ? v.toString() : Number(v).toFixed(fixed).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        let value = first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1');\n        return value === 'NaN' ? v : value;\n    }\n\n    return v === 'NaN' ? v : v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'text',\n    //     title: tf('format.text'),\n    //     type: 'string',\n    //     render: formatStringRender,\n    // },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: (v) => {\n            const a = multiply(v, 100);\n            const a_s = `${a}`;\n            return `${a_s}%`;\n        },\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '10.00',\n        render: v => `${formatNumberRender(v)}`,\n    },\n    // {\n    //     key: 'usd',\n    //     title: tf('format.usd'),\n    //     type: 'number',\n    //     label: '$10.00',\n    //     render: v => `$${formatNumberRender(v)}`,\n    // },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '2009-01-01',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'datetime',\n        label: '20090101',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'time',\n    //     title: tf('format.time'),\n    //     type: 'date',\n    //     label: '15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'datetime',\n    //     title: tf('format.datetime'),\n    //     type: 'date',\n    //     label: '26/09/2008 15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'duration',\n    //     title: tf('format.duration'),\n    //     type: 'date',\n    //     label: '24:01:00',\n    //     render: formatStringRender,\n    // },\n];\n\nfunction isInteger(obj) {\n    return Math.floor(obj) === obj;\n}\n\n\nfunction add(a, b, digits) {\n    return operation(a, b, digits, 'add');\n}\n\nfunction subtract(a, b, digits) {\n    return operation(a, b, digits, 'subtract');\n}\n\nexport function multiply(a, b, digits) {\n    return operation(a, b, digits, 'multiply');\n}\n\nfunction divide(a, b, digits) {\n    return operation(a, b, digits, 'divide');\n}\n\n/*\n *  3.14 >> 314 100\n * @param floatNum {number} \n * @return {object}\n *   {times:100, num: 314}\n */\nfunction toInteger(floatNum) {\n    const ret = {times: 1, num: 0};\n    const isNegative = floatNum < 0;\n    if (isInteger(floatNum)) {\n        ret.num = floatNum;\n        return ret;\n    }\n    const strfi = `${floatNum}`;\n    const dotPos = strfi.indexOf('.');\n    const len = strfi.substr(dotPos + 1).length;\n    const times = Math.pow(10, len);\n    let intNum = parseInt(Math.abs(floatNum) * times + 0.5, 10);\n    ret.times = times;\n    if (isNegative) {\n        intNum = -intNum;\n    }\n    ret.num = intNum;\n    return ret;\n}\n\nfunction operation(a, b, digits, op) {\n    const o1 = toInteger(a);\n    const o2 = toInteger(b);\n    const n1 = o1.num;\n    const n2 = o2.num;\n    const t1 = o1.times;\n    const t2 = o2.times;\n    const max = t1 > t2 ? t1 : t2;\n    let result = null;\n    switch (op) {\n        case 'add':\n            if (t1 === t2) { // \n                result = n1 + n2;\n            } else if (t1 > t2) { // o1   o2\n                result = n1 + n2 * (t1 / t2);\n            } else { // o1   o2\n                result = n1 * (t2 / t1) + n2;\n            }\n            return result / max;\n        case 'subtract':\n            if (t1 === t2) {\n                result = n1 - n2;\n            } else if (t1 > t2) {\n                result = n1 - n2 * (t1 / t2);\n            } else {\n                result = n1 * (t2 / t1) - n2;\n            }\n            return result / max;\n        case 'multiply':\n            result = (n1 * n2) / (t1 * t2);\n            return result;\n        case 'divide':\n            result = (n1 / n2) * (t2 / t1);\n            return result;\n    }\n}\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport {\n    formatm,\n    baseFormats,\n    formatNumberRender\n};\n","import Dropdown from './dropdown';\nimport {h} from './element';\nimport {baseFormats} from '../core/format';\nimport {cssPrefix} from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n    constructor() {\n        let nformats = baseFormats.slice(0);\n        nformats.splice(1, 0, {key: 'divider'});\n        nformats.splice(5, 0, {key: 'divider'});\n        nformats = nformats.map((it) => {\n            const item = h('div', `${cssPrefix}-item`);\n            if (it.key === 'divider') {\n                item.addClass('divider');\n            } else {\n                item.child(it.title())\n                    .on('click', () => {\n                        this.setTitle(it.title());\n                        this.change(it);\n                    });\n                if (it.label) item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        super('Normal', '220px', true, 'bottom-left', {type: false}, ...nformats );\n    }\n\n    setTitle(key) {\n        for (let i = 0; i < baseFormats.length; i += 1) {\n            if (baseFormats[i].key === key) {\n                this.title.html(baseFormats[i].title);\n            }\n        }\n        this.hide();\n    }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', {type: false}, ...nformulas );\n  }\n}\n","/* global describe, it */\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, colorPalette.el);\n    this.colorPalette = colorPalette;  // \n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left',  {type: false}, ...naligns );\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', {type: false}, ...lineTypeEls );\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  let item =  h('div', `${cssPrefix}-border-palette-cell`);\n  this.items.push(item);\n  return h('td', '').child(\n    item.child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    this.items = [];\n\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, borderPalette.el );\n    this.borderPalette = borderPalette;\n  }\n}\n","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\n\nexport default class HistoryBorder {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-history-border`);\n        this.history = h('div', `${cssPrefix}-history-content`).html('');\n        this.el.child( this.history);\n    }\n\n    setContent(items) {\n        items = items.slice(items.length - 100 < 0 ? 0 : items.length, items.length);\n        this.el.html('');\n        let els = [];\n        for(let i = items.length - 1; i >= 0; i--) {\n            let d = h('div', '');\n            let {action} = items[i];\n            d.html(action);\n            els.push(d);\n        }\n\n        console.log(this, this.el);\n        this.el.children(...els);\n    }\n}","import Dropdown from \"./dropdown\";\nimport Icon from \"./icon\";\nimport HistoryBorder from \"./history_border\";\n\nexport default class DropdownAction extends Dropdown {\n    constructor(iconName, change, arrowChange) {\n        const icon = new Icon(iconName)\n            .css('height', '18px');\n        const historyBorder = new HistoryBorder();\n        super(icon, 'auto', true, 'bottom-left', {type: true, change: change, arrowChange: arrowChange, historyBorder}, historyBorder.el);\n    }\n}","/* global window */\nimport {h} from './element';\nimport {bind} from './event';\nimport tooltip from './tooltip';\nimport DropdownFont from './dropdown_font';\nimport DropdownFontSize from './dropdown_fontsize';\nimport DropdownFormat from './dropdown_format';\nimport DropdownFormula from './dropdown_formula';\nimport DropdownColor from './dropdown_color';\nimport DropdownAlign from './dropdown_align';\nimport DropdownBorder from './dropdown_border';\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\nimport DropdownAction from \"./dropdown_action\";\n\nfunction buildIcon(name) {\n    return new Icon(name);\n}\n\nexport function buildButton(tooltipdata) {\n    return h('div', `${cssPrefix}-toolbar-btn`)\n        .on('mouseenter', (evt) => {\n            tooltip(tooltipdata, evt.target);\n        })\n        .attr('data-tooltip', tooltipdata);\n}\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nexport function buildButtonWithIcon(tooltipdata, iconName, change = () => {\n}) {\n    return buildButton(tooltipdata)\n        .child(buildIcon(iconName))\n        .on('click', () => change());\n}\n\nfunction bindDropdownChange() {\n    this.ddFormat.change = it => this.change('format', it.key);\n    this.ddFont.change = it => this.change('font-name', it.key);\n    this.ddFormula.change = it => this.change('formula', it.key);\n    this.ddFontSize.change = it => this.change('font-size', it.pt);\n    this.ddTextColor.change = it => this.change('color', it);\n    this.ddFillColor.change = it => this.change('bgcolor', it);\n    this.ddAlign.change = it => this.change('align', it);\n    this.ddVAlign.change = it => this.change('valign', it);\n    this.ddBorder.change = it => this.change('border', it);\n    this.undoEl.change = it => this.change('undo', it);\n}\n\n\nfunction toggleChange(type) {\n    let elName = type;\n    const types = type.split('-');\n    if (types.length > 1) {\n        types.forEach((it, i) => {\n            if (i === 0) elName = it;\n            else elName += it[0].toUpperCase() + it.substring(1);\n        });\n    }\n    const el = this[`${elName}El`];\n    el.toggle();\n    this.change(type, el.hasClass('active'));\n}\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', false,  moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nfunction initBtns2() {\n    this.btns2 = this.btnChildren.map((it) => {\n        const rect = it.box();\n        const {marginLeft, marginRight} = it.computedStyle();\n        return [it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)];\n    });\n}\n\nfunction moreResize(widthFn = this.widthFn) {\n    const {\n        el, btns, moreEl, ddMore, btns2,\n    } = this;\n    const {moreBtns, contentEl} = ddMore;\n    el.css('width', `${ widthFn() - 60}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        const style = data.defaultStyle();\n        this.ddFormat = new DropdownFormat();\n        this.ddFont = new DropdownFont();\n        this.ddFormula = new DropdownFormula();\n        this.ddFontSize = new DropdownFontSize();\n        this.ddTextColor = new DropdownColor('text-color', style.color);\n        this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\n        this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\n        this.ddVAlign = new DropdownAlign(['top', 'middle', 'bottom'], style.valign);\n        this.ddBorder = new DropdownBorder();\n        this.ddMore = new DropdownMore();\n        this.undoEl = new DropdownAction('undo',  () => this.change('undo'), (v) => this.change('undoList', v));\n        this.redoEl = new DropdownAction('redo',  () => this.change('redo'), (v) => this.change('redoList', v));\n        this.btnChildren = [\n            // this.undoEl = buildButtonWithIcon(`${t('toolbar.undo')} (Ctrl+Z)`, 'undo', () => this.change('undo')),\n\n            // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\n            buildButton(`${t('toolbar.undo')}`).child(this.undoEl.el),\n            buildButton(`${t('toolbar.redo')}`).child(this.redoEl.el),\n            this.paintformatEl = buildButtonWithIcon(`${t('toolbar.paintformat')}`, 'paintformat', () => toggleChange.call(this, 'paintformat')),\n            this.clearformatEl = buildButtonWithIcon(`${t('toolbar.clearformat')}`, 'clearformat', () => this.change('clearformat')),\n            buildDivider(),\n            buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\n            buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\n            buildDivider(),\n            this.fontBoldEl = buildButtonWithIcon(`${t('toolbar.fontBold')} (Ctrl+B)`, 'bold', () => toggleChange.call(this, 'font-bold')),\n            this.fontItalicEl = buildButtonWithIcon(`${t('toolbar.fontItalic')} (Ctrl+I)`, 'italic', () => toggleChange.call(this, 'font-italic')),\n            this.underlineEl = buildButtonWithIcon(`${t('toolbar.underline')} (Ctrl+U)`, 'underline', () => toggleChange.call(this, 'underline')),\n            // this.flexibleEl = buildButtonWithIcon(`${t('toolbar.flexibleEl')} `, 'flexible', () => toggleChange.call(this, 'flexible')),\n            this.strikeEl = buildButtonWithIcon(`${t('toolbar.strike')}`, 'strike', () => toggleChange.call(this, 'strike')),\n            buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\n            buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\n            this.mergeEl = buildButtonWithIcon(`${t('toolbar.merge')}`, 'merge', () => toggleChange.call(this, 'merge')),\n            buildDivider(),\n            buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\n            buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\n            this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.call(this, 'textwrap')),\n            buildDivider(),\n            // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\n            // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\n            this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\n            this.addEl = buildButtonWithIcon(`${t('toolbar.add')}`, 'add', () => toggleChange.call(this, 'add')),\n            this.closeEl = buildButtonWithIcon(`${t('toolbar.calc')}`, 'close', () => toggleChange.call(this, 'close')),\n            this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleChange.call(this, 'autofilter')),\n            this.throwFormulaEl = buildButtonWithIcon(`${t('toolbar.throwFormula')}`, 'chevron-right', () => toggleChange.call(this, 'throwFormula')),\n            // buildButton(`${t('toolbar.date_formula')}`).child(this.ddFormula.el),\n            // buildDivider(),\n            this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),\n        ];\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(...this.btnChildren);\n        this.el.child(this.btns);\n        if (isHide) this.el.hide();\n        bindDropdownChange.call(this);\n        this.reset();\n        setTimeout(() => {\n            initBtns2.call(this);\n            moreResize.call(this);\n        }, 0);\n        bind(window, 'resize', () => {\n            moreResize.call(this, data.settings.view.width);\n        });\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.hasClass('active');\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        toggleChange.call(this, type);\n    }\n\n    reset() {\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        const cell = data.getSelectedCell();\n        this.undoEl.disabled(!data.canUndo());\n        this.redoEl.disabled(!data.canRedo());\n        this.mergeEl.active(data.canUnmerge())\n            .disabled(!data.selector.multiple());\n        this.autofilterEl.active(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font} = style;\n        this.ddFont.setTitle(font.name);\n        this.ddFontSize.setTitle(font.size);\n        this.fontBoldEl.active(font.bold);\n        this.fontItalicEl.active(font.italic);\n        this.underlineEl.active(style.underline);\n        // this.flexibleEl.active(style.flexible);\n        this.strikeEl.active(style.strike);\n        this.ddTextColor.setTitle(style.color);\n        this.ddFillColor.setTitle(style.bgcolor);\n        this.ddAlign.setTitle(style.align);\n        this.ddVAlign.setTitle(style.valign);\n        this.textwrapEl.active(style.textwrap);\n        this.addEl.active(data.equationIsActive());\n        this.closeEl.active(false);\n        this.throwFormulaEl.active(false);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.active(data.freezeIsActive());\n        if (cell) {\n            if (cell.format) {\n                this.ddFormat.setTitle(cell.format);\n            }\n        }\n    }\n}\n","/* global document */\nimport {h} from './element';\nimport {bind} from './event';\nimport {cssPrefix} from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n      if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n      this.open = false;\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n      this.open = true;\n      bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n      this.open = false;\n      document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import {Element} from './element';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nexport default class Button extends Element {\n    // type: primary\n    constructor(title, type = '') {\n        super('div', `${cssPrefix}-button ${type}`);\n        this.child(t(`button.${title}`));\n    }\n}\n","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  // showVf(it) {\n  //   const hint = it === 'date' ? '2018-11-12' : '10';\n  //   const { vf } = this;\n  //   vf.input.hint(hint);\n  //   vf.show();\n  // }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import {h} from './element';\nimport Button from './button';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nfunction buildMenu(clsName) {\n    return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n    return buildMenu('state').child(t(`sort.${it}`))\n        .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n    const {filterbEl, filterValues} = this;\n    filterbEl.html('');\n    const itemKeys = Object.keys(items);\n    itemKeys.forEach((it, index) => {\n        const cnt = items[it];\n        const active = filterValues.includes(it) ? 'checked' : '';\n        filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n            .on('click.stop', () => this.filterClick(index, it))\n            .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n    });\n}\n\nfunction resetFilterHeader() {\n    const {filterhEl, filterValues, values} = this;\n    filterhEl.html(`${filterValues.length} / ${values.length}`);\n    filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n    constructor() {\n        this.filterbEl = h('div', `${cssPrefix}-body`);\n        this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n        this.tindex = 1;\n        this.el = h('div', `${cssPrefix}-sort-filter`).children(\n            this.sortAscEl = buildSortItem.call(this, 'asc'),\n            this.sortDescEl = buildSortItem.call(this, 'desc'),\n            buildMenu('divider'),\n            h('div', `${cssPrefix}-filter`).children(\n                this.filterhEl,\n                this.filterbEl,\n            ),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', () => this.btnClick('cancel')),\n                new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n            ),\n        ).hide();\n        // this.setFilters(['test1', 'test2', 'text3']);\n        this.el.on('mousedown.stop', evt => {\n            this.tindex = 1;\n        });\n\n        this.ci = null;\n        this.sortDesc = null;\n        this.values = null;\n        this.filterValues = [];\n    }\n\n    btnClick(it) {\n        if (it === 'ok') {\n            const {ci, sort, filterValues} = this;\n            if (this.ok) {\n                this.ok(ci, sort, 'in', filterValues);\n            }\n        }\n        this.hide();\n    }\n\n    itemClick(it) {\n        // console.log('it:', it);\n        this.sort = it;\n        const {sortAscEl, sortDescEl} = this;\n        sortAscEl.checked(it === 'asc');\n        sortDescEl.checked(it === 'desc');\n    }\n\n    filterClick(index, it) {\n        const {filterbEl, filterValues, values} = this;\n        const children = filterbEl.children();\n        if (it === 'all') {\n            if (children.length === filterValues.length) {\n                this.filterValues = [];\n                children.forEach(i => h(i).checked(false));\n            } else {\n                this.filterValues = Array.from(values);\n                children.forEach(i => h(i).checked(true));\n            }\n        } else {\n            const checked = h(children[index]).toggle('checked');\n            // console.log(h(children[index]), \"92\")\n            if (checked) {\n                filterValues.push(it);\n            } else {\n                filterValues.splice(filterValues.findIndex(i => i === it), 1);\n            }\n        }\n\n        resetFilterHeader.call(this);\n    }\n\n    // v: autoFilter\n    // items: {value: cnt}\n    // sort { ci, order }\n    set(ci, items, filter, sort) {\n        this.ci = ci;\n        const {sortAscEl, sortDescEl} = this;\n        if (sort !== null) {\n            this.sort = sort.order;\n            sortAscEl.checked(sort.asc());\n            sortDescEl.checked(sort.desc());\n        } else {\n            this.sortDesc = null;\n            sortAscEl.checked(false);\n            sortDescEl.checked(false);\n        }\n        // this.setFilters(items, filter);\n        this.values = Object.keys(items);\n        this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n        buildFilterBody.call(this, items, filter);\n        resetFilterHeader.call(this);\n    }\n\n    setOffset(v) {\n        if(this.el.isShow()) {\n            this.hide();\n            return;\n        }\n\n        this.el.offset(v).show();\n        let tindex = 1;\n\n\n        console.log(this.el);\n        bindClickoutside(this.el, () => {\n\n            if (tindex === 0) {\n                this.hide();\n            }\n\n            tindex = 0;\n        });\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n        unbindClickoutside(this.el);\n    }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {sheetReset} from './sheet';\n\nexport default class Advice {\n    constructor(data, sheet) {\n        this.el = h('div', `${cssPrefix}-advice`)\n            .children(\n                this.save = h('div', `${cssPrefix}-advice-style`)\n                    .css('border-bottom', '1px solid'),\n                this.text = h('div', `${cssPrefix}-advice-style`),\n            )\n            .hide();\n        this.save.children(\n            this.saveCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html(''),\n        );\n        this.text.children(\n            this.textCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html(''),\n        );\n        this.data = data;\n        this.sheet = sheet;\n        this.left = 0;\n        this.top = 0;\n\n        this.save.on('mousedown.stop', () => {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n            this.sheet.setCellRange(this.reference, this.tableProxy, true);\n            sheetReset.call(this.sheet);\n        });\n\n        this.text.on('mousedown.stop', () => {\n            this.sheet.setCellRange(this.reference, this.tableProxy, false);\n            this.saveCheck.show('visibility', 'hidden');\n            this.textCheck.hide('visibility', 'initial');\n            sheetReset.call(this.sheet);\n        });\n    }\n\n    show(left, top, type = 1, reference, tableProxy ) {\n        this.el.css('left', `${left}px`);\n        this.el.css('top', `${top}px`);\n        if (type === 1) {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n        }\n        this.left = parseInt(left);\n        this.top = parseInt(top);\n        this.tableProxy = tableProxy;\n        this.reference = reference;\n        this.el.show();\n    }\n}\n","import {h} from \"../component/element\";\nimport {cutStr} from \"../core/operator\";\n\nfunction mountCopy(event) {\n    event.preventDefault();\n    let choose = getChooseImg.call(this);\n    if (choose) {\n        if (event.clipboardData) {\n            event.clipboardData.setData(\"text/html\", parseDom(choose.img2));\n            event.clipboardData.setData(\"text/plain\", \"\");\n        }\n        return;\n    }\n\n    let args = sheetCopy.call(this);\n    if (event.clipboardData) {\n        event.clipboardData.setData(\"text/html\", parseDom(args.html.el));\n        event.clipboardData.setData(\"text/plain\", args.plain);\n    }\n}\n\nfunction getChooseImg() {\n    let {pasteDirectionsArr} = this.data;\n\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true) {\n                this.container.css('pointer-events', 'auto');\n                return pasteDirectionsArr[i];\n            }\n        }\n    }\n    return null;\n}\n\nfunction sheetCopy() {\n    let args = {\n        plain: \"\",\n        html: h(\"table\", \"\"),\n    };\n\n    let {selector, rows, styles} = this.data;\n    let {sri, eri, sci, eci} = selector.range;\n    let tbody = h('tbody', '');\n    for (let i = sri; i <= eri; i += 1) {\n        let tr = h('tr', '');\n        for (let j = sci; j <= eci; j += 1) {\n            let td = h('td', '');\n            if (rows._[i] && rows._[i].cells && rows._[i].cells[j]) {\n                if (rows._[i].cells[j] && styles[rows._[i].cells[j].style]) {\n                    td.css('color', styles[rows._[i].cells[j].style].color);\n                    if (styles[rows._[i].cells[j].style]\n                        && styles[rows._[i].cells[j].style].font\n                        && styles[rows._[i].cells[j].style].font.bold) {\n                        let bold = styles[rows._[i].cells[j].style].font.bold ? '900' : '';\n                        td.css('font-weight', bold);\n                    }\n                    td.css('background', styles[rows._[i].cells[j].style].bgcolor);\n                }\n\n                if(!rows._[i].cells[j].text) {\n                    rows._[i].cells[j].text = \"\";\n                }\n                if(!rows._[i].cells[j].formulas) {\n                    rows._[i].cells[j].formulas = \"\";\n                }\n\n                let text = rows._[i].cells[j].formulas !== \"\" ? rows._[i].cells[j].formulas : rows._[i].cells[j].text;\n                if(rows._[i].cells[j].formulas && cutStr(rows._[i].cells[j].formulas, false, true).length > 0) {\n                    let hidden = h('reference', '');\n                    hidden.html(text);\n                    hidden.attr('ri', i);\n                    hidden.attr('ci', j);\n                    td.child(hidden.el);\n                } else\n                    td.html(text);\n                args.plain += text;\n                args.plain += \"\\t\";\n            } else {\n                args.plain += \"\\t\";\n            }\n            tr.child(td);\n        }\n\n        tbody.child(tr);\n        args.plain += \"\\n\";\n    }\n    args.html.child(tbody);\n\n    return args;\n}\n\nfunction parseDom(node) {\n    let tmpNode = document.createElement(\"div\");\n    tmpNode.appendChild(node.cloneNode(true));\n\n    return  tmpNode.innerHTML;\n}\n\nexport {\n    mountCopy,\n    getChooseImg,\n    sheetCopy\n}","import {h} from \"../component/element\";\nimport {cssPrefix, look} from \"../config\";\nimport CellRange from \"../core/cell_range\";\nimport {bind} from \"./event\";\nimport {  isSpecialWebsite} from \"../core/special_formula_process\";\n\nexport default class Website {\n    constructor(data, editor) {\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n\n        this.tableEl = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n        this.editor = editor;\n        this.tableEl.attr('tabindex', 0);\n        this.tableEl.css('overflow-y', 'auto');\n        this.tableEl.css('max-height', '400px');\n        bind(this.tableEl.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n        this.timer = null;\n        this.timer2 = null;\n    }\n\n    show(ri, ci) {\n        if(this.editor.isDisplay2()) {\n            this.el.hide();\n            this.tableEl.hide();\n\n            return;\n        }\n\n        let {data} = this;\n        let text = data.getCellTextOrDefault(ri, ci) + \"\";\n        clearTimeout(this.timer);\n        clearTimeout(this.timer2);\n\n        if (look.indexOf(text.split(\"!\")[0]) === 0) {\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 50;\n            let arr = JSON.parse(text.substring(text.indexOf(\"!\") + 1, text.length));\n\n            this.tableEl.css('left', `${left}px`);\n            this.tableEl.css('top', `${top}px`);\n            this.tableEl.css('user-select', 'text');\n\n            this.tableEl.html('');\n            let table = h('table', '');\n            table.css('border-spacing', '0px');\n            let tr = h('tr', '');\n            tr.children(\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html('')\n            );\n            table.children(\n                tr\n            );\n\n            for (let j = 0; j < arr.length; j++) {\n                let {number, name, city, area, value} = arr[j];\n                let tr = h('tr', '');\n                let td = h('td', '');\n                td.html(number);\n                td.css('border', '1px solid black');\n\n                let td2 = h('td', '');\n                td2.html(name);\n                td2.css('border', '1px solid black');\n\n                let td3 = h('td', '');\n                td3.html(city);\n                td3.css('border', '1px solid black');\n\n                let td4 = h('td', '');\n                td4.html(area);\n                td4.css('border', '1px solid black');\n\n                let td5 = h('td', '');\n                td5.html(value);\n                td5.css('border', '1px solid black');\n                tr.children(\n                    td,\n                    td2,\n                    td3,\n                    td4,\n                    td5\n                );\n                table.children(\n                    tr\n                );\n            }\n\n            this.tableEl.children(\n                table\n            );\n\n            this.timer = setTimeout(() => {\n                this.tableEl.show();\n                this.el.hide();\n            }, 150);\n        } else {\n            let args = isSpecialWebsite(text);\n            if(args.state) {\n                text = args.text;\n            }\n            text = text.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + text : text;\n            // console.log(regex.test(text))\n            if (text.substr(0, 7).toLowerCase() !== 'http://' &&\n                text.substr(0, 8).toLowerCase() !== 'https://') {\n                this.el.hide();\n                this.tableEl.hide();\n                return;\n            }\n\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 5;\n            this.el.html('');\n            this.el.css('color', 'blue');\n            this.el.children(\n                h('div', 'aaa').css(\"border-bottom\", \"1px solid blue\")\n                    .on('click', evt => {\n                        let iWidth = 650; //;\n                        let iHeight = 500; //;\n\n                        console.log(evt);\n                        let {screenX, screenY} = evt;\n                        window.open(text, \"\", `width=${iWidth},height=${iHeight},left=${screenX + rect.width},top=${screenY}`);\n                    })\n                    .html(text)\n            );\n            this.el.css('left', `${left}px`);\n            this.el.css('top', `${top}px`);\n\n            this.timer2 = setTimeout(() => {\n                this.el.show();\n                this.tableEl.hide();\n            }, 150);\n        }\n    }\n}","import {look} from \"../config\";\n\nlet v1 = \"HYPERLINK\";\n\n\nfunction isSpecialWebsite(text) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return {\n            \"state\": true,\n            \"text\": JSON.parse(text.split(\"!\")[1]).url,\n        };\n    }\n    return {\n        \"state\": false,\n        \"text\": \"\",\n    };\n}\n\nfunction indexOf(text, formula) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1 && formula.toUpperCase().indexOf(v1) === -1) {\n        return 2;\n    }\n    return 0;\n}\n\nfunction multipleCellsRender(cells, mc) {\n    let tailArr = [];\n    Object.keys(mc).forEach(i => {\n        cells[i] = mc[i];\n        tailArr.push(i);\n    });\n\n    return tailArr;\n}\n\nfunction specialWebsiteValue(text, formula) {\n    let index = indexOf(text, formula);\n\n    if (index === 2) {\n        let arr = text.split(\" \");\n        let s = \"\";\n        if (arr.length >= 1) {\n            text = arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                s += arr[i];\n            }\n        }\n        return {\n            \"state\": true,\n            \"type\": index,\n            \"text\": JSON.parse(text.split(\"!\")[1]).text + s,\n        };\n    }\n    return {\n        \"state\": false,\n        \"type\": index,\n        \"text\": \"\",\n    };\n}\n\nexport {\n    isSpecialWebsite,\n    specialWebsiteValue,\n    multipleCellsRender,\n}","import Modal from \"./modal\";\nimport {h} from \"./element\";\nimport Button from \"./button\";\nimport {t} from \"../locale/locale\";\nimport {cssPrefix} from \"../config\";\n\nexport default class ErrorPopUp extends Modal {\n    constructor() {\n        let tip = h('span', '').html(\"\");\n        super(t('contextmenu.errorPop'), [\n            h('div', `${cssPrefix}-form-fields`).children(\n                tip,\n            ),\n            h('div', `${cssPrefix}-form-fields`),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('ok', 'primary')\n                    .on('click', () => this.btnClick('ok')),\n            ),\n        ]);\n        this.tip = tip;\n    }\n\n    show(t) {\n        this.tip.html(t);\n        super.show();\n    }\n\n    btnClick(action) {\n        if (action === 'ok') {\n            this.hide();\n        }\n    }\n\n}","import {offsetTop} from \"../config\";\nimport {positionAngle} from \"../core/operator\";\n\nexport default class RectProxy {\n    constructor(rect) {\n        this.rect = rect;\n    }\n\n    isLocInside(x, y) {\n        let {rect} = this;\n\n        // if (x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height) {\n        //     return true;\n        // }\n        return x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height;\n    }\n\n    getUpDownLeftRight(ex, ey, clientX, clientY) {\n        let {rect} = this;\n\n        let pos = 0;\n        if (ex < rect.width + rect.left && ex > rect.left) {\n            if (ey > rect.top + rect.height + offsetTop) {\n                pos = 1;\n            } else if (ey - offsetTop < rect.top) {\n                pos = 4;\n            }\n\n        } else if (ey - ( rect.top - rect.height + offsetTop) > 0 && (rect.height + rect.top + offsetTop) > ey) {\n            if (ex > rect.width + rect.left) {\n                pos = 3;\n            } else if (ex < rect.left) {\n                pos = 2;\n            }\n        }\n\n        if (pos === 0) {\n            pos = positionAngle(clientX, ex, clientY, ey);\n        }\n        if (pos === 1 && ey < 0) {\n            pos = 4;\n        } else if (document.body.clientHeight < ey && pos === 4) {\n            pos = 1;\n        }\n        if (pos === 3 && ex < 0) {\n            pos = 2;\n        } else if (document.body.clientWidth < ex && pos === 2) {\n            pos = 3;\n        }\n\n        return pos;\n    }\n}","export default class Timer {\n    constructor() {\n        this.timer = [];\n    }\n\n    push(t) {\n        this.timer.push(t);\n    }\n\n    clear() {\n        for(let i = 0; i < this.timer.length; i++) {\n            let t = this.timer[i];\n            clearTimeout(t);\n            clearInterval(t);\n        }\n    }\n}","import {deepCopy, distinct} from \"../core/operator\";\nimport {isHave} from '../core/helper';\nimport {expr2xy, xy2expr} from \"../core/alphabet\";\n\nfunction getCellDepend(cells) {\n    let arr = [];\n    for (let i = 0; i < cells.length; i++) {\n        if(isHave(cells[i]) && isHave(cells[i].expr)) {\n            arr.push(cells[i].expr);\n        }\n\n        if (isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.depend)) {\n            arr.push(...cells[i].cell.depend);\n        }\n\n        if(isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.multivalueRefsCell)) {\n            arr.push(cells[i].cell.multivalueRefsCell);\n        }\n    }\n\n    return arr;\n}\n\nexport default class PreAction {\n    constructor({type = -1, action = \"\",  ri = -1, ci = -1, oldData = \"\", newData = \"\", expr = \"\", oldStep = \"\", cellRange = \"\", cells = {}, height = -1, width = -1, oldCell = {}, newCell = {}, newMergesData = \"\", oldMergesData = \"\", property = \"\", value = \"\"}, data) {\n        this.type = type;\n        this.action = action;\n        this.ri = ri;\n        this.ci = ci;\n        this.expr = expr;\n        this.cellRange = cellRange;\n        this.cells = cells;\n        this.height = height;\n        this.width = width;\n        this.oldCell = oldCell;\n        this.newCell = newCell;\n        this.oldMergesData = oldMergesData;\n        this.newMergesData = newMergesData;\n        this.property = property;\n        this.value = value;\n        this.oldStep = oldStep;\n\n        this.oldData = oldData;\n        this.newData = newData;\n        this.data = data;\n    }\n\n    findAllNeedCalcCell() {\n        let changeArr = [];\n        let {oldCell, newCell, ri, ci} = this;\n        changeArr.push(...getCellDepend(oldCell));\n        changeArr.push(...getCellDepend(newCell));\n        if (ri !== -1 && ci !== -1) {\n            changeArr.push(xy2expr(ci, ri));\n        }\n\n        changeArr = distinct(changeArr);\n        return changeArr;\n    }\n\n    restore(data, sheet, isRedo) {\n        let {type} = this;\n\n        if (type === 1) { // shuru\n            let {oldCell, newCell} = this;\n            let _cell = \"\";\n            // redo 1  undo 2\n            if (isRedo === 1) {\n                _cell = deepCopy(oldCell);\n            } else {\n                _cell = deepCopy(newCell);\n            }\n            for (let i = 0; i < _cell.length; i++) {\n                let {cell, ri, ci} = _cell[i];\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n\n        } else if(type === 13) {\n            let {oldData, newData} = this;\n            let _data = \"\";\n            if (isRedo === 1) {\n                _data = deepCopy(newData);\n            } else {\n                _data = deepCopy(oldData);\n            }\n\n            data.setData(_data);\n        } else if (type === 2 || type === 5 || type === 6 || type === 11 || type === 12) {\n            let {newCell, oldCell, oldMergesData, newMergesData, cellRange, property, value} = this;\n            let _cells = \"\";\n            if (isRedo === 1) {\n                _cells = deepCopy(oldCell);\n            } else {\n                _cells = deepCopy(newCell);\n            }\n\n            if (property === 'merge') {\n                if (isRedo === 1) {\n                    this.data.merges.setData(oldMergesData);\n                } else {\n                    this.data.merges.setData(newMergesData);\n                }\n            }\n\n            for (let i = 0; i < _cells.length; i++) {\n                let {cell, ri, ci} = _cells[i];\n\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n        } else if (type === 3) {\n            let {ri, height, oldStep} = this;\n            if (isRedo === 1) {\n                data.rows.setHeight(ri, oldStep.height);\n            } else {\n                data.rows.setHeight(ri, height);\n            }\n        } else if (type === 4) {\n            let {ci, width, oldStep} = this;\n            if (isRedo === 1) {\n                data.cols.setWidth(ci, oldStep.width);\n            } else {\n                data.cols.setWidth(ci, width);\n            }\n\n        }\n    }\n}\n","/* global window */\nimport {h} from './element';\nimport {bind, bindTouch, mouseMoveUp, remove} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix, offsetLeft, offsetTop} from '../config';\nimport {formulas} from '../core/formula';\nimport {getFontSizePxByPt} from \"../core/font\";\n// import {baseFormats, multiply} from \"../core/format\";\nimport Advice from \"../component/advice\";\nimport {clearSelectors, editingSelectors, lockCells, makeSelector} from \"../component/formula_editor\";\nimport {deleteImg, hideDirectionArr, mountPaste} from \"../event/paste\";\nimport {getChooseImg, mountCopy} from \"../event/copy\";\nimport Website from \"../component/website\";\nimport {cutStr, cuttingByPos, deepCopy} from \"../core/operator\";\nimport {moveCell} from \"../event/move\";\nimport CellRange from \"../core/cell_range\";\nimport {isHave, isOusideViewRange} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\nimport ErrorPopUp from \"./error_pop_up\";\nimport RectProxy from \"../core/rect_proxy\";\nimport {testValid} from \"../utils/test\";\nimport Timer from \"../model/Timer\";\nimport PreAction from \"../model/pre_action\";\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    // console.log(multiple, ', ri:', ri, ', ci:', ci);\n    const {\n        table, selector, toolbar,\n    } = this;\n\n    if (multiple) {\n        selector.setEnd(ri, ci, moving, true);\n    } else {\n        selector.set(ri, ci, indexesUpdated);\n    }\n\n    toolbar.reset();\n\n    // add\n    clearTimeout(this.render_timer);\n\n    this.render_timer = setTimeout(() => {\n        table.render();\n    }, 100);\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data, editor\n    } = this;\n    const {rows, cols} = data;\n    if (editor.isCors) {\n        selector.indexes = [editor.ri, editor.ci];\n    }\n    let [ri, ci] = selector.indexes;\n    const { eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n\n\n    // console.log(\"92\", ri, ci, editor.ri, editor.ci)\n    // if((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n    //     return;\n    // }\n\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        // if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selector.selectCell.setData(ri, ci);\n    selector.selectCell.resetSelectOffset();\n    selectorSet.call(this, multiple, ri, ci);\n    // editor.clear();\n\n    editorSetOffset.call(this);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    if (evt.buttons !== 0) return;\n    if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n    const {offsetX, offsetY} = evt;\n\n    const {\n        rowResizer, colResizer, tableEl, data, website\n    } = this;\n    const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n\n    // moveCell.call(this);\n\n    // url \n    website.show(cRect.ri, cRect.ci);\n    const {rows, cols} = data;\n    if (offsetX > cols.indexWidth && offsetY > rows.height) {\n        rowResizer.hide();\n        colResizer.hide();\n        return;\n    }\n    const tRect = tableEl.box();\n    if (cRect.ri >= 0 && cRect.ci === -1) {\n        cRect.width = cols.indexWidth;\n        rowResizer.show(cRect, {\n            width: tRect.width,\n        });\n    } else {\n        rowResizer.hide();\n    }\n    if (cRect.ri === -1 && cRect.ci >= 0) {\n        cRect.height = rows.height;\n        colResizer.show(cRect, {\n            height: tRect.height,\n        });\n    } else {\n        colResizer.hide();\n    }\n}\n\nfunction overlayerMousescroll(evt) {\n    const {verticalScrollbar, data} = this;\n    const {autoLoad} = data.settings;\n    const {top} = verticalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n    let delta = evt.deltaY;\n    const {rows} = data;\n    if (evt.detail) delta = evt.detail * 40;\n    if (delta > 0 && autoLoad === true) {\n        // up\n        const ri = data.scroll.ri + 1;\n        if (ri < rows.len) {\n            verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n        }\n    } else if (autoLoad === true) {\n        // down\n        const ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    }\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('direction:', direction, ', distance:', distance, left);\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    verticalScrollbar.set(height, data.rows.totalHeight());\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset() {\n    // debugger\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    renderAutoAdapt.call(this);\n    autoRowResizer.call(this);\n\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    selector.selectCell.toolbarChangeSelectorCell();\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy() {\n    const {data, selector} = this;\n    data.copy();\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    data.cut();\n    selector.showClipboard();\n}\n\n// const a = () => {\n// }\n\nfunction paste(what, cb = (p) => {\n    if (p) {\n        clearClipboard.call(this);\n        sheetReset.call(this);\n    }\n}) {\n    const {data} = this;\n    let p = data.paste(what, msg => xtoast('Tip', msg));\n    cb(p);\n\n    return p;\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar, data} = this;\n    if (toolbar.paintformatActive()) {\n        // paste.call(this, 'format');\n        data.paintFormatChange((ri, ci) => {\n            selectorSet.call(this, true, ri, ci, true, true);\n        });\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n        toolbar.reset();\n    }\n}\n\nfunction getPoint(obj) { //\n    let t = obj.offsetTop; //\n    let l = obj.offsetLeft; //\n    //\n    while (obj = obj.offsetParent) {// obj = obj.offsetParent;while (obj != undefined)\n        t += obj.offsetTop; //\n        l += obj.offsetLeft; //\n    }\n\n    return {\n        t: t,\n        l: l\n    }\n}\n\nfunction dropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, pos = 0, offset, horizontalScrollbar, cols) {\n    this.selector.setBoxinner(\"none\");\n    this.container.css('pointer-events', 'none');\n    let dstRect = data.getCellRectByXYWithNotTotalResult(e.layerX || e.clientX, e.layerY || e.clientY);\n    let {ri, ci} = dstRect;\n\n    if (isAutofillEl) {\n        let {rpos, ey, ex,} = dropGetPos.call(this, data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos);\n\n        let orien = selector.showAutofill(ri, ci, rpos);\n        if (isOusideViewRange(this.data.settings.view.height(), this.data.settings.view.width(), ey, ex, orien)) {\n            // if (Math.round(Math.random()) === 1) {\n            continueMove.call(this, orien, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n            // }\n        }\n\n    } else if (e.buttons === 1 && !e.shiftKey) {\n        ri = ri <= 0 ? 0 : ri;\n        ci = ci <= 0 ? 0 : ci;\n        let cell = data.viewRange();\n        let pos = cell.getMovePos(ri, ci);\n\n        selectorBeyondMove.call(this, pos, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n\n        console.log(\"ri: \", ri, \"ci: \", ci);\n        selectorSet.call(this, true, ri, ci, true, true);\n    }\n}\n\n\nfunction dropGetPos(data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos) {\n    let rect = data.getRect(selector.range);\n    let rectProxy = new RectProxy(rect);\n    let clientX = rect.width + rect.left;\n    let clientY = rect.height + rect.top + offsetTop;\n    let ex = e.clientX - offset.l - offsetLeft;\n    let ey = e.clientY;\n\n    if (rectProxy.isLocInside(ex, ey)) {\n        pos = -1;\n        selector.arange = null;\n    } else {\n        pos = rectProxy.getUpDownLeftRight(ex, ey, clientX, clientY)\n    }\n\n    return {\n        rpos: pos,\n        ex,\n        ey\n    };\n}\n\nfunction selectorBeyondMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    if (orien === 2) {   //\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 6) {    // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 3) {        //\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 5) {    // \n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 1) { // \n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 7) {         // \n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 8) {     // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 4) {       // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    }\n}\n\nfunction scrollTo(orien, verticalScrollbar, horizontalScrollbar, rows, data, cols) {\n    if (Math.round(Math.random()) !== 1) {\n        return;\n    }\n    // 1  2  3 4 \n    let ri = 0, ci = 0;\n    if (orien === 1) {\n        const {top} = verticalScrollbar.scroll();  // toolbar\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 2) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n\n        verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n    } else if (orien === 4) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 3) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\nfunction continueMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    let ri = 0, ci = 0;\n    if (orien === 44) {\n        const {top} = verticalScrollbar.scroll();  // toolbar\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 22) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    } else if (orien === 33 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 11 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data,  sortFilter, editor, advice\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    editor.setRiCi(ri, ci);\n\n    // sort or filter\n    const {autoFilter} = data;\n\n    // trait add\n    hideDirectionArr.call(this);\n    advice.el.hide();\n\n    if (autoFilter.includes2(ri, ci)) {\n        autoFilter.getSet(data.exceptRowSet, ri);\n    }\n\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n\n        // let {pageX, pageY} = evt;\n        let {verticalScrollbar, horizontalScrollbar} = this;\n        const {rows, cols} = data;\n        // const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri + 1;\n        // let ttop = top + rows.getHeight(ri) - 1;\n\n        let point = getPoint(this.el.el);\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            console.log(\"dropdown\");\n            clearStopTimer.call(this);\n\n            continueDropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols);\n\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols);\n        }, () => {\n            clearStopTimer.call(this);\n\n            if (isAutofillEl) {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    testValid.call(this);\n                    autofillNext.call(this);\n                }\n            }\n            this.selector.setBoxinner(\"auto\");\n\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n            this.container.css('pointer-events', 'auto');\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction continueDropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols) {\n    let stopTimer = setTimeout(() => {\n        let stopTimer2 = setInterval(() => {\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols,);\n        }, 50);\n        this.stopTimer2.push(stopTimer2);\n    }, 200);\n\n    this.stopTimer.push(stopTimer);\n}\n\nfunction clearStopTimer() {\n    this.stopTimer.clear();\n    this.stopTimer2.clear();\n}\n\nfunction autofillNext() {\n    const {\n        data, table, editor\n    } = this;\n    editor.display = true;\n    let enter = false;\n    // this.selector.arange.each((ri, ci) => {\n    //     // let cell = data.rows.getCell(ri, ci);\n    //     // if (cell && cell.formulas) {\n    //     //     let enter2 = this.editorProxy.change(ri, ci, cell.formulas, data.rows, data, true);\n    //     //     if (enter2 === true) {\n    //     //         enter = true;\n    //     //     }\n    //     // }\n    // });\n    if (enter) {\n        data.change(data.getData());\n    }\n    this.selector.arange = null;\n    loadFormula.call(this);\n    table.render();\n}\n\nfunction loadFormula(load = false) {\n    // this.table.proxy.diff = 305;\n    // this.table.proxy.oldData = \"\";\n    // sheetReset.call(this);\n    // clearTimeout(this.formulaTime);\n    // let {data, table} = this;\n    // this.formulaTime = setTimeout(() => {\n    //     let {date_formula} = data.settings;\n    //     if (date_formula && typeof date_formula.wland == \"function\") {\n    //         date_formula.wland(date_formula, data, table, load);\n    //     }\n    // }, 1500);\n}\n\nfunction firstRowToWidth(width) {\n    let cRect = {ri: -1, ci: 0, left: 60, top: 0, width: 100};\n    colResizerFinished.call(this, cRect, width);\n}\n\nfunction adviceSetOffset() {\n    const {data} = this;\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n\n    this.advice.el.el.style['top'] = `${top}px`;\n    this.advice.el.el.style['left'] = `${ left}px`;\n}\n\nfunction pictureSetOffset() {\n    const {data} = this;\n    let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n\n    this.data.pasteDirectionsArr.forEach(i => {\n        const sOffset = data.getMoveRect(i.range);\n\n        i.img.el.style['top'] = `${sOffset.top + pictureOffsetTop + i.number * 15 + i.offsetTop }px`;\n        i.img.el.style['left'] = `${sOffset.left + pictureOffsetLeft + i.number * 15 + i.offsetLeft}px`;\n    });\n}\n\n\nfunction editorSetOffset(show = true, cri = -1, cci = -1) {\n    const {\n        selector, data, editor\n    } = this;\n    let [ri, ci] = selector.indexes;\n    ri = cri === -1 ? ri : cri;\n    ci = cci === -1 ? ci : cci;\n\n    const sOffset = data.getMoveRect(new CellRange(ri, ci, selector.range.eri, selector.range.eci));\n    const tOffset = this.getTableOffset();\n\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n\n    editor.setOffset(sOffset, sPosition, show);\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction selectorsSetOffset() {\n    for (let i = 0; i < this.selectors.length; i++) {\n        let selector = this.selectors[i];\n        selector.selector.resetSelectorBRLAreaOffset(new CellRange(selector.ri, selector.ci, selector.ri, selector.ci));\n    }\n}\n\nfunction hasEditor(showEditor = true) {\n    // let {selector} = this;\n    if (showEditor === true) {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selectorMoveEl.el,\n                this.selector.el,\n            );\n    } else {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                // this.editor.el,\n                // this.selector.el,\n                this.selectorMoveEl.el\n            );\n    }\n}\n\nfunction editorSet() {\n    const {editor, data, selector} = this;\n    editorSetOffset.call(this);\n    editor.setCellEnd(data.getSelectedCell());\n    // editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), type);\n    if (this.data.settings.showEditor) {\n        selector.el.hide();\n    }\n    clearClipboard.call(this);\n\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrolly(distance, () => {\n        editor.display = false;\n        selector.resetBRLAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrollx(distance, () => {\n        editor.display = false;\n        selector.resetBRTAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction renderAutoAdapt() {\n    let {data, table} = this;\n    const viewRange = data.viewRange2();\n    let {autoAdapt} = data.settings.style;\n    let {ignoreRi} = data.settings;\n    let viewWidth = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            let txt = table.getCellTextContent(ri, ci);\n            const dbox = table.getDrawBox(ri, ci);\n\n            if (txt !== undefined) {\n                const style = table.getCellTextStyle(ri, ci);\n                const font = Object.assign({}, style.font);\n                font.size = getFontSizePxByPt(font.size);\n                // width\n                let txtWidth = null;\n                if (style.format !== undefined) {\n                    // txtWidth = table.draw.selfAdaptionTxtWidth(formatm[style.format].render(txt), font, dbox);\n\n                } else {\n                    txtWidth = table.draw.selfAdaptionTxtWidth(txt, font, dbox);\n                }\n                if ((table.autoAdaptList[ci] === undefined || table.autoAdaptList[ci] < txtWidth) && ri > ignoreRi - 1) {\n                    table.autoAdaptList[ci] = txtWidth;\n                }\n            }\n        });\n        if (table.autoAdaptList.length < 0) {\n            return;\n        }\n        let {ignore} = data.settings;\n        for (let i = 0; i < table.autoAdaptList.length; i++) {\n            let _ignore = false;\n            for (let j = 0; j < ignore.length; j++) {\n                if (i === ignore[j]) _ignore = true;\n            }\n            if (_ignore === false) {\n                if (table.autoAdaptList[i] === undefined) {\n                    viewWidth += 50;\n                    data.cols.setWidth(i, 50);\n                } else {\n                    if (table.autoAdaptList[i] < 30) {\n                        table.autoAdaptList[i] = 30;\n                    }\n                    data.cols.setWidth(i, table.autoAdaptList[i]);\n                }\n            }\n            viewWidth += table.autoAdaptList[i];\n\n        }\n        if (viewWidth > 0)\n            data.settings.cellWidth = () => viewWidth;\n    }\n}\n\nfunction autoRowResizer() {\n    let {data, table} = this;\n    let viewRange = data.viewRange2();\n    let record_rc = 0, max = 0;\n    let r_h = data.settings.row.height;\n    let {autoAdapt} = data.settings.style;\n    let viewHeight = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            const txt = table.getCellTextContent(record_rc, ci);\n            const style = table.getCellTextStyle(ri, ci);\n            const font = Object.assign({}, style.font);\n            font.size = getFontSizePxByPt(font.size);\n            const dbox = table.getDrawBox(record_rc, ci);\n            // 1. \n            // 2.   max\n            if (record_rc !== ri && txt !== undefined) {\n                let record_h = data.rows.getHeight(record_rc);\n                if (r_h * max !== record_h) {\n                    let c_h = font.size * max + dbox.padding * 2 + 2 * max;\n                    // console.log(\"451\", view.height(r_h * max));\n                    data.rows.setHeight(record_rc, c_h);\n                    viewHeight += c_h;\n                } else {\n                    viewHeight += record_h;\n                }\n                max = 0;\n            } else if (txt !== undefined && record_rc === ri) {\n                if (txt !== undefined) {\n                    const n = table.draw.selfAdaptionHeight(dbox, txt, font);\n                    if (n > max || max === 0) {\n                        max = n;\n                    }\n                }\n            }\n            record_rc = ri;\n        });\n        let record_h = data.rows.getHeight(record_rc);\n        const style = table.getCellTextStyle(record_h, 0);\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        const dbox = table.getDrawBox(record_rc, 0);\n        if (r_h * max !== record_h && viewHeight > 0) {\n            let c_h = font.size * max + dbox.padding * 2;\n            viewHeight += c_h;\n            data.rows.setHeight(record_rc, c_h);\n        } else if (viewHeight > 0) {\n            viewHeight += record_h;\n        }\n    }\n    console.log(503, viewHeight);\n    if (viewHeight > 0)\n        data.settings.view.height = () => viewHeight + 40;\n}\n\nfunction clickSelectorChangeRiCi(evt) {\n    const overlayer = evt.target.className === `${cssPrefix}-overlayer`;\n    if (!overlayer) {\n        return;\n    }\n\n    let {selector, data} = this;\n\n    const {offsetX, offsetY} = evt;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n\n    selector.selectCell.setData(cellRect.ri, cellRect.ci);\n    selector.selectCell.resetSelectOffset();\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setRowHeight(ri, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setColWidth(ci, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    // console.log('data:', data);\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction errorPop(enter, msg) {\n    const {errorPopUp} = this;\n\n    if (enter && !errorPopUp.open) {\n        errorPopUp.show(msg);\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else if (errorPopUp.open) {\n        errorPopUp.hide();\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    }\n    return {\n        \"state\": false,\n        \"msg\": msg\n    };\n}\n\nexport function selectorCellText(ri, ci, {text, style}, state) {\n    const {data, editor,} = this;\n    let args = data.selectorCellText(ri, ci, text + \"\", state);\n    if (args.state) {\n        args = errorPop.call(this, true, args.msg);\n        if (args.state) {\n            return true;\n        }\n    }\n\n    data.setCellText(ri, ci, {text, style});\n    editor.setRiCi(-1, -1);\n\n    return false;\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table, editor} = this;\n    // const [ri, ci] = selector.indexes;\n    let {ri, ci} = data.selector;\n    if ((editor.ri !== ri && editor.ri !== -1) || (editor.ci !== ci && editor.ci !== -1)) {\n        return;\n    }\n\n    data.setSelectedCellText(text, state);\n    if (state === 'finished') table.render();\n}\n\nfunction throwFormula() {\n    const {data} = this;\n    data.throwFormula();\n    // sheetReset.call(this);\n}\n\nexport function insertDeleteRowColumn(type) {\n    const {data} = this;\n    if (type === 'insert-row') {\n        data.insert('row');\n    } else if (type === 'delete-row') {\n        data.delete('row');\n    } else if (type === 'insert-column') {\n        data.insert('column');\n    } else if (type === 'delete-column') {\n        data.delete('column');\n    } else if (type === 'delete-cell') {\n        data.deleteCell();\n    } else if (type === 'delete-cell-format') {\n        data.deleteCell('format');\n    } else if (type === 'delete-cell-text') {\n        data.deleteCell('text');\n    }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'undoList') {\n        value.setContent(data.historyList(1));\n    } else if (type === 'redoList') {\n        value.setContent(data.historyList(2));\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        // print\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'throwFormula') {\n        throwFormula.call(this);\n    } else if (type === 'close') {\n        let {mri, mci} = data.getMax();\n\n        data.changeDataForCalc = new PreAction({\n            type: 999,\n            action: \"\", ri: -1, ci: -1, oldCell: {}, newCell: data.rows.eachRange(new CellRange(0, 0, mri, mci))\n        }, this.data);\n        sheetReset.call(this);\n        // loadFormula.call(this, true);\n    } else if (type === 'freeze') {\n        let {showFreeze} = data.settings;\n        if (value && showFreeze === true) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else if (type === 'add') {\n        data.showEquation = !data.showEquation;\n        sheetReset.call(this, true);\n    } else {\n        //format percent 473\n        data.setSelectedCellAttr(type, value);\n        if (type === 'border') {\n            borderResSet.call(this, 'none');\n        }\n        if (type === 'formula') {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction borderResSet(value = \"1px solid rgb(75, 137, 255\") {\n    this.selector.br.border(value);\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction afterSelector(editor) {\n    if (editor.getLock() || editor.state === 2) {\n        let {ri, ci} = editor;\n        let inputText = editor.editorText.getText();\n        let {selector} = this;\n        selector.indexes = [ri, ci];\n        return selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n    }\n    return false;\n}\n\nfunction pasteEvent(evt) {\n    clearClipboard.call(this);\n    mountPaste.call(this, evt, () => {\n        sheetReset.call(this);\n        let {data} = this;\n        data.change(data.getData());\n    });\n}\n\nfunction sheetInitEvents() {\n    const {\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n         contextMenu,\n        data,\n        toolbar,\n        modalValidation,\n        sortFilter,\n    } = this;\n\n    // pasteOverlay.on('mousedown', evt => {\n    //   console.log(\"669\");\n    //   pasteOverlay.hide();\n    // });\n\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            // renderAutoAdapt.call(this);\n            // autoRowResizer.call(this);\n            // the left mouse button: mousedown  mouseup  click\n            // the right mouse button: mousedown  contenxtmenu  mouseup\n            if (evt.buttons === 2) {\n                if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                    evt.stopPropagation();\n                } else {\n                    contextMenu.hide();\n                    overlayerMousedown.call(this, evt);\n                    setTimeout(() => {\n                        contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                        evt.stopPropagation();\n                    }, 100);\n                }\n                clickSelectorChangeRiCi.call(this, evt);\n            } else if (evt.detail === 2) {\n                clearTimeout(this.render_timer);\n                editor.setMouseDownIndex([]);\n\n                if (editor.getLock()) {\n                    return;\n                }\n                editorSet.call(this);\n            } else {\n                if (editor.getLock() || editor.isCors) {\n                    let _selector = null;\n                    let change = 0;\n                    mouseMoveUp(window, (e) => {\n                        this.container.css('pointer-events', 'none');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"none\");\n                        }\n\n                        let enter = true;\n                        let {merges} = data;\n                        // let {inputText} = editor;\n                        let inputText = editor.editorText.getText();\n                        let it = inputText;\n\n                        Object.keys(merges._).forEach(i => {\n                            let m = merges._[i];\n                            const cut = cutStr(it, true);\n                            for (let i = 0; i < cut.length; i++) {\n                                if (cut[i].indexOf(\":\") !== -1) {\n                                    let a1 = cut[i].split(\":\")[0];\n                                    let a2 = cut[i].split(\":\")[1];\n                                    let e1 = expr2xy(a1);\n                                    let e2 = expr2xy(a2);\n\n                                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                                        enter = false;\n                                    }\n                                }\n                            }\n                        });\n\n                        if (enter) {\n                            if (e.buttons === 1 && !e.shiftKey) {\n                                let {ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY);\n                                if (_selector && _selector.selector) {\n                                    _selector = makeSelector.call(this, ri, ci, this.selectors, true, _selector.selector, true);\n                                    lockCells.call(this, evt, _selector);\n                                    this.mergeSelector = true;\n                                } else {\n                                    let {pos} = editor;\n                                    let inputText = editor.editorText.getText();\n                                    for (let i = 0; i < this.selectors.length; i++) {\n                                        let selector = this.selectors[i];\n                                        let {erpx} = selector;\n\n                                        if (erpx === cuttingByPos(inputText, pos)) {\n                                            _selector = selector;\n                                            change = 1;\n                                            _selector.selector.set(ri, ci, true);\n                                            break;\n                                        }\n                                    }\n\n                                    _selector = _selector ? _selector : makeSelector.call(this, ri, ci, this.selectors, true, null, false);\n                                }\n                            }\n                        }\n                    }, () => {\n                        this.container.css('pointer-events', 'auto');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"auto\");\n                        }\n\n                        if (this.mergeSelector === false) {\n                            if (_selector && !change) {\n                                this.selectors.push(_selector);\n                            }\n                            lockCells.call(this, evt, _selector);\n                        } else if (_selector && !change && _selector.selector) {\n                            this.selectors.push(_selector);\n                        }\n                        if (_selector) {\n                            for (let i = 0; i < this.selectors.length; i++) {\n                                let selector = this.selectors[i];\n\n                                if (selector.className === _selector.className) {\n                                    selector.erpx = _selector.erpx;\n                                    break;\n                                }\n                            }\n                        }\n                        _selector = null;\n                        change = 0;\n                        this.mergeSelector = false;\n                    });\n                }\n\n                console.time(\"dbclick time1\");\n\n                if (!editor.getLock() && !editor.isCors) {\n                    console.time(\"dbclick time2\");\n\n                    let {ri, ci} = editor;\n                    let inputText = editor.editorText.getText();\n                    if (ri !== -1 && ci !== -1 && inputText[0] === \"=\") {\n                        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n\n                        if (error) {\n                            return;\n                        }\n                    }\n                    console.timeEnd(\"dbclick time2\");\n\n                    let state = editor.clear();\n\n                    if (state) {\n\n                        // let cell = data.rows.getCell(ri, ci);\n                        // if (cell && cell.formulas) {\n                        //     this.editorProxy.change(ri, ci, cell.formulas, data.rows, data);\n                        // }\n                        loadFormula.call(this);\n\n                    }\n\n\n                    this.selector.longTimeBefore();\n                    overlayerMousedown.call(this, evt);\n                    clickSelectorChangeRiCi.call(this, evt);\n                    borderResSet.call(this);\n                    clearSelectors.call(this);\n                    editorSetOffset.call(this);\n                }\n                testValid.call(this);\n                console.timeEnd(\"dbclick time1\");\n\n            }\n        }).on('mousewheel.stop', (evt) => {\n        overlayerMousescroll.call(this, evt);\n    });\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        }\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        if (state === 'finish') { //  \n            data.editorChangeToHistory(editor.editorText.getOldCell(), editor.editorText.getRICI(), 1);\n            editor.editorText.setOldCell({}, {ri: -1, ci: -1});\n            return;\n        }\n\n        //  esc\n        if (itext === \"@~esc\") {\n            let {text, formulas} = editor.editorText.getOldCell();\n            editor.editorText.setOldCell({\n                text: '',\n                formulas: '',\n            });\n            let {ri, ci} = editor;\n            data.setSelectedCell(text, 'input', formulas, ri, ci);\n            editor.setText(\"\");\n            clearSelectors.call(this);\n            editor.clear(true);\n            // editor.setRiCi(-1, -1);\n            return;\n        }\n\n        if (state === \"format\") {\n            data.setSelectedCellAttr(state, \"rmb\");\n            // return;\n        }\n        // let {selector} = this;\n        // selector.el.hide();\n        //this.selectors\n        let {lock} = editor;\n        editor.setMouseDownIndex(data.rows, []);\n        editingSelectors.call(this, itext);\n\n        if (lock && itext !== '=') {\n            return;\n        }\n\n        // if (this.selectors.length > 0) {\n        //     return;\n        // }\n\n        if (state === \"format\") {\n            return;\n        }\n\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            data.addValidation(...args);\n        } else {\n            data.removeValidation();\n        }\n    };\n    // contextmenu\n    contextMenu.itemClick = (type) => {\n        // console.log('type:', type);\n        if (type === 'validation') {\n            modalValidation.setValue(data.getSelectedValidation());\n        } else if (type === 'copy') {\n            copy.call(this);\n        } else if (type === 'cut') {\n            cut.call(this);\n        } else if (type === 'paste') {\n            // paste.call(this, 'all');\n            // process.call(this, document.execCommand(\"sheetCopy\"));\n            // createEvent(1, false, \"paste\");\n            // console.log(  document.execCommand(\"paste\"));\n        } else if (type === 'paste-value') {\n            paste.call(this, 'text');\n        } else if (type === 'paste-format') {\n            paste.call(this, 'format');\n        } else {\n            insertDeleteRowColumn.call(this, type);\n        }\n    };\n\n\n    // let windows = this.el.el;\n    bind(window, 'resize', () => {\n        this.reload();\n    });\n\n    bind(window, 'click', (evt) => {\n        overlayerEl.contains(evt.target);\n        // this.focusing = overlayerEl.contains(evt.target);\n    });\n\n    bind(window, 'copy', (evt) => {\n        mountCopy.call(this, evt);\n        // data.history.add(data.getData());\n    });\n\n    bind(window, 'cut', (evt) => {\n        console.log(\"cut\", evt);\n        cut.call(this);\n        mountCopy.call(this, evt);\n        let {data} = this;\n        data.history.add(data.getData());\n    });\n\n    bind(window, 'paste', (evt) => {\n        pasteEvent.call(this, evt);\n    });\n\n    // for selector\n    bind(window, 'keydown', evt => {\n        // if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key, ctrlKey, shiftKey,   metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (getChooseImg.call(this)) {\n            console.log(keyCode);\n            switch (keyCode) {\n                case 8:         // delete\n                    data.history.addPic(data.getData().pictures, \"add\");\n                    deleteImg.call(this);\n                    break;\n                // case 90:         // delete\n                //     data.history.addPic(data.getData().pictures, \"add\");\n                //     deleteImg.call(this);\n                //     break;\n            }\n\n            if (ctrlKey || metaKey) {\n                if (90 === keyCode) {\n                    this.undo();\n                    evt.preventDefault();\n                }\n            }\n        } else if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            // let what = 'all';\n            // if (shiftKey) what = 'text';\n            // if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    //   \n                    if (getChooseImg.call(this))\n                        return;\n                    copy.call(this);\n                    // table.render();\n                    // sheetReset.call(this);\n                    evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // paste.call(this, what, () => {\n                    //     console.log(\"837\")\n                    // });\n                    break;\n                case 37:\n                    // ctrl + left\n\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('font-bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('font-italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error = afterSelector.call(this, editor);\n                    if (error) {\n                        return;\n                    }\n\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    // \n                    clearSelectors.call(this);\n                    break;\n                case 13: // enter\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error2 = afterSelector.call(this, editor);\n                    if (error2) {\n                        return;\n                    }\n                    editor.clear();\n                    renderAutoAdapt.call(this);\n                    autoRowResizer.call(this);\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    loadFormula.call(this);\n\n                    evt.preventDefault();\n                    editorSetOffset.call(this, true);\n                    // \n                    clearSelectors.call(this);\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    // evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                // dataSetCellText.call(this, evt.key, 'input');\n                // editorSet.call(this);\n                // editor.inputEventHandler();\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    });\n}\n\nexport {\n    sheetReset,\n    selectorSet,\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        const {view, showToolbar, showContextmenu, showEditor, rowWidth} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n\n        targetEl.children(this.toolbar.el, this.el);\n        this.pictureOffsetLeft = 10;\n        this.pictureOffsetTop = 10;\n\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n            data.cols.width,\n            data,\n            this,\n        );\n        this.stopTimer = new Timer();\n        this.stopTimer2 = new Timer();\n        this.website = new Website(data, this.editor);\n\n        // data validation\n        this.modalValidation = new ModalValidation();\n        this.errorPopUp = new ErrorPopUp();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);\n        // selector\n        this.selector = new Selector(data, this, true);\n        this.selectorMoveEl = new Selector(data, this, false);\n        // this.editorProxy = new EditorProxy();\n\n        this.advice = new Advice(data, this);\n        // this.pasteDirectionsArr = [];\n        // this.pasteOverlay = h('div', `${cssPrefix}-paste-overlay-container`).hide();\n\n        this.overlayerCEl = hasEditor.call(this, showEditor);\n        this.selectors = [];\n        this.container = h('div', '');\n        this.selectorsEl = h('div', `selector_clear`).attr(\"id\", \"selector_clear\");\n\n        //  overlayerCEl   overlayerEl \n        this.overlayerCEl.children(this.selectorsEl, this.container);\n\n        this.mergeSelector = false;\n\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        this.direction = false;   // \n\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.rowResizer.el,\n            this.overlayerEl.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.errorPopUp.el,\n            this.sortFilter.el,\n            this.advice.el,\n            this.website.el,\n            this.website.tableEl,\n            // this.pasteOverlay.el,\n        );\n\n        // table\n        this.table = new Table(this.tableEl.el, data, this.editor);\n        sheetInitEvents.call(this);\n        sheetReset.call(this, false);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n\n        if (rowWidth && rowWidth.state) {\n            firstRowToWidth.call(this, rowWidth.width)\n        }\n    }\n\n    selectorMoveReset() {\n        editorSetOffset.call(this);\n        this.editor.setRiCi(this.data.selector.ri, this.data.selector.ci)\n        sheetReset.call(this);\n    }\n\n    getTable() {\n        let {table} = this;\n        return {\n            recalc: false,\n            table: table\n        }\n    }\n\n    clickCopyPaste() {\n        let {data} = this;\n        let args = data.clickCopyPaste();\n        if (args.enter) {\n            this.selector.arange = args.dstCellRange;\n            data.clickAutofill(args.srcCellRange, args.dstCellRange, \"all\", msg => xtoast('Tip', msg));\n            autofillNext.call(this);\n        }\n    }\n\n    setCellRange(reference, tableProxy, styleBool, cellRange) {\n        let {  data} = this;\n        data.paste(cellRange);\n        for (let i = 0; i < reference.length; i++) {\n            let {ri, ci} = reference[i];\n            let cell = deepCopy(tableProxy.rows.getCellOrNew(ri, ci));\n            if (styleBool === false) {\n                delete cell['style'];\n            }\n            selectorCellText.call(this, ri, ci, cell, 'style');\n            selectorSet.call(this, true, ri, ci, true, true);\n        }\n    }\n\n    selectorEditorReset(ri, ci) {\n        let {selector} = this;\n        editorSetOffset.call(this, true, ri, ci);\n        this.editor.setRiCi(ri, ci);\n        selector.hide();\n        sheetReset.call(this);\n    }\n\n    loadData(data) {\n        this.data.setData(data, this);\n        // \n        // this.editorProxy.associatedArr(this.data.rows);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo(this);\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    removeEvent() {\n        remove.call(this);\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n}\n\n","function Drag(options, self) {\n\n    /**\n     *\n     * @param el \n     */\n    this.register = function (el) {\n        el.addEventListener('mousedown', function (e) {\n            if (e.button !== 0) {\n                //\n                return;\n            }\n\n\n            //xy\n            let x = e.clientX;\n            let y = e.clientY;\n\n            //\n            let l = el.offsetLeft;\n            let t = el.offsetTop;\n\n            if (options && options.onBegin) {\n                options.onBegin.call(el, {\n                    left: x - l,\n                    top: y - t\n                });\n            }\n\n\n            //\n            let isDown = true;\n            //\n            el.style.cursor = 'move';\n\n            let nl = x, nt = y;\n\n\n            window.onmousemove = function (e) {\n                if (!isDown) {\n                    return;\n                }\n                //xy\n                let nx = e.clientX;\n                let ny = e.clientY;\n\n\n                //\n                nl = nx - (x - l);\n                nt = ny - (y - t);\n\n                // console.log( nl, nt);\n                // let drag = false;\n                if (nl > 0) {\n                    // drag = false;\n                    el.style.left = nl + 'px';\n                } else {\n                    // drag = true;\n                    el.style.left = 0 + 'px';\n                }\n                if (nt > 0) {\n                    // drag = false;\n                    el.style.top = nt + 'px';\n                } else {\n                    // drag = true;\n                    el.style.top = 0 + 'px';\n                }\n                // el.style.left = nl + 'px';\n                // el.style.top = nt + 'px';\n\n\n                if (options && options.onDrag) {\n                    options.onDrag.call(el, {\n                        left: nl,\n                        top: nt,\n                        x: nx - x,\n                        y: ny - y,\n                        isDown: isDown\n                    });\n                }\n\n                return false;\n            };\n\n            window.onmouseup = function () {\n                //\n                isDown = false;\n                el.style.cursor = 'default';\n\n                if (options && options.onEnd) {\n                    options.onEnd.call(el, {left: parseInt(el.style.left), top: parseInt(el.style.top)}, self);\n                }\n\n                return false;\n            };\n            // e.stopPropagation();\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            } else if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                // window.event.returnValue === false;\n            }\n        });\n    }\n}\n\nexport default Drag;","function Resize(options, self) {\n\n    this.register = function (el) {\n        let directionsArr = [];\n        let directions = ['nw', 'w', 'ws', 's', 'se', 'e', 'ne', 'n'];\n        //\n        directions.forEach(str => {\n            //direction ws\n\n            let div = document.createElement('div');\n            div.style.display = \"block\";\n            div.className = 'direction ' + str;\n            //\n\n            directionsArr.push(div);\n            el.appendChild(div);\n        });\n\n        for(let i = 0; i < 4; i++) {\n            let line = document.createElement('div');\n            line.style.display = \"block\";\n            line.className = `line${i+1}`;\n            el.appendChild(line);\n            directionsArr.push(line);\n        }\n\n\n        let border = document.createElement('div');\n        border.className = 'border';\n        el.appendChild(border);\n\n\n        //\n\n        directions.forEach(str => {\n            let obj = el.querySelector(\".\" + str);\n            obj.onmousedown = function (e) {\n\n                if (e.button !== 0) {\n                    return;\n                }\n\n                let ox = e.clientX;\n                let oy = e.clientY;\n\n                let data = {\n                    ox: ox,\n                    oy: oy,\n                    ow: el.offsetWidth,\n                    oh: el.offsetHeight,\n                    ol: el.offsetLeft,\n                    ot: el.offsetTop\n\n                };\n\n                if (options && options.onBegin) {\n                    options.onBegin.call(el,data)\n                }\n\n                let isResize = true;\n                window.onmousemove = function (event) {\n                    if (!isResize) {\n                        return;\n                    }\n                    let x = event.clientX;\n                    let y = event.clientY;\n\n                    // widthheight \n\n                    let width = x - data.ox;\n                    let height = y - data.oy;\n\n\n                    data.width = width;\n                    data.height = height;\n\n                    let fun = mappers[str];\n                    if (fun) {\n                        fun.call(obj, data, event);\n                    }\n\n                    event.stopPropagation();\n                };\n                window.onmouseup = function (ee) {\n                    isResize = false;\n                    ee.stopPropagation();\n\n                    if (options && options.onEnd) {\n                        options.onEnd.call(el)\n                    }\n                };\n\n                //\n                e.stopPropagation()\n            }\n\n        });\n\n\n        if (!options) {\n            options = {\n                onResize: function () {\n\n                }\n            }\n        } else if (!options.onResize) {\n            options.onResize = function () {\n\n            }\n        }\n\n        function setLeft(l) {\n            options.onResize({left: l}, self);\n            el.style.left = l + 'px';\n        }\n\n        function setTop(t) {\n            options.onResize({top: t}, self);\n            el.style.top = t + 'px';\n        }\n\n        function setWidth(w) {\n            if (w < 20) {\n                w = 20;\n            }\n            options.onResize({width: w}, self);\n            el.style.width = w + 'px';\n        }\n\n        function setHeight(h) {\n\n            if (h < 20) {\n                h = 20;\n            }\n            options.onResize({height: h}, self);\n            el.style.height = h + 'px';\n        }\n\n        let mappers = {\n            s: function (data) {\n                setHeight(data.oh + data.height);\n            },\n            e: function (data) {\n                setWidth(data.ow + data.width)\n            },\n            w: function (data) {\n                let value = data.width;\n\n\n                let l = data.ol + value;\n                let w = data.ow + Math.abs(value);\n\n                if (value > 0) {\n                    w = data.ow - value;\n                }\n\n                if (w > 20) {\n                    setLeft(l);\n                    setWidth(w);\n                }\n            },\n            n: function (data) {\n                let value = data.height;\n\n                let t = data.ot + value;\n                let h = data.oh + Math.abs(value);\n\n                if (value > 0) {\n                    h = data.oh - value;\n                }\n                if (h > 20) {\n                    setHeight(h);\n                    setTop(t);\n                }\n            },\n            se: function (data) {\n                mappers.s(data);\n                mappers.e(data);\n            },\n            nw: function (data) {\n                mappers.n(data);\n                mappers.w(data);\n            },\n            ws: function (data) {\n                mappers.w(data);\n                mappers.s(data);\n            },\n            ne: function (data) {\n                mappers.n(data);\n                mappers.e(data);\n            }\n        };\n\n        // el.querySelector()\n        return directionsArr;\n    }\n}\n\nexport default Resize;\n","import {isHaveStyle} from \"../event/paste\";\nimport {Rows} from \"../core/row\";\nimport {splitStr} from \"../core/operator\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from '../core/cell_range';\nimport {isHave} from \"../core/helper\";\n// jobs: todo: TableProxyeventcore\nexport default class TableProxy {\n    constructor(data ) {\n        this.data = data;\n         this.rows = new Rows({len: 0, height: 0}, data);\n    }\n\n    getComputedStyle(computedStyle) {\n        let bold = false;\n        if (computedStyle.fontWeight > 400) {\n            bold = true;\n        }\n\n        return {\n            color: computedStyle.color,\n            bgcolor: computedStyle.background.substring(0,\n                computedStyle.background.indexOf(\")\") + 1),\n            font: {\n                bold: bold,\n            },\n        };\n    }\n\n    extend(tableDom, {ri, ci}) {\n        let {data} = this;\n        if (tableDom.rows.length >= data.rows.len - ri) {\n            let diff = tableDom.rows.length - (data.rows.len - ri);\n            if(diff > 0) {\n                data.insert('row', diff);\n            }\n        }\n\n        if (isHave(tableDom.rows[0]) === false || isHave(tableDom.rows[0].cells) === false) {\n            return;\n        }\n\n        let colLen = tableDom.rows[0].cells.length;\n        if (colLen >= data.cols.len) {\n            let diff = colLen - (data.cols.len - ci);\n            if(diff > 0) {\n                data.insert('column', diff, data.cols.len);\n            }\n        }\n    }\n\n    each(obj, cb) {\n        for (let i = 0; i < obj.rows.length; i++) {\n            for (let j = 0; j < obj.rows[i].cells.length; j++) {\n                cb(i, j, obj.rows[i].cells[j]);\n            }\n        }\n    }\n\n    dealColSpan(tableDom) {\n        this.each(tableDom, (i, j, cell) => {\n            let len = cell.getAttribute(\"colspan\");\n            if (len && len > 1) {\n                for (let c = 0; c < len - 1; c++) {\n                    tableDom.rows[i].insertBefore(document.createElement(\"td\"), tableDom.rows[i].cells[j + 1]);\n                }\n            }\n        });\n    }\n\n    dealStyle(tableDom, {ri, ci}) {\n        let {data, rows} = this;\n        let styles = data.styles;\n\n        this.each(tableDom, (i, j, cell) => {\n            let computedStyle = document.defaultView.getComputedStyle(cell, false);\n            let args = this.getComputedStyle(computedStyle);\n            let index = isHaveStyle(styles, args);\n            if (index === -1) {\n                styles.push(args);\n            }\n            rows.setCell(ri + i, ci + j, {\"style\": index === -1 ? styles.length - 1 : index}, 'all');\n        });\n    }\n\n    parseTableCellRange(tableDom, {ri, ci}) {\n      let maxRi = ri, maxCi = ci;\n      this.each(tableDom, (i, j) => {\n        let rii = ri + i;\n        let cij = ci + j;\n            if(maxRi < rii) {\n              maxRi = rii;\n            }\n            if(maxCi < cij) {\n              maxCi = cij;\n            }\n        });\n        return new CellRange(ri, ci, maxRi, maxCi);\n    }\n\n    dealReference(tableDom, {ri, ci}) {\n        let {rows} = this;\n         let reference = [];\n\n        this.each(tableDom, (i, j, cell) => { // reference updateCEllReferenceByShift \n            let node = cell.querySelector(\"reference\");\n            let innerText = cell.innerText || \"\";\n            if (node) {\n                let eri = node.getAttribute('ri');\n                let eci = node.getAttribute('ci');\n\n                let strList = splitStr(innerText);\n                let dci = i + ri - eri;\n                let dei = j + ci - eci;\n\n                let {bad, result} = rows.getCellTextByShift(strList, dei, dci);\n                rows.updateCellReferenceByShift(bad, result, ri + i, ci + j);\n            } else {\n                let _cell = rows.getCell(ri + i, ci + j) || {};\n                _cell.text = innerText;\n                _cell.formulas = innerText;\n\n                rows.setCell(ri + i, ci + j, _cell, 'all');\n            }\n            // proxy.setCell(data.name, xy2expr(ci + j, ri + i));\n\n            reference.push({\n                ri: ri + i,\n                ci: ci + j\n            });\n        });\n        return {\"reference\": reference};\n    }\n}\n","import {sheetReset} from \"../component/sheet\";\nimport {h} from \"../component/element\";\nimport Drag from \"../external/drag\";\nimport Resize from \"../external/resize\";\nimport {cssPrefix} from \"../config\";\nimport {getChooseImg} from \"../event/copy\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from \"../core/cell_range\";\n// import {deepCopy} from \"../core/operator\";\nimport TableProxy from \"../core/table_proxy\";\n\nexport let resizeOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n\n    onEnd(data) {\n\n    },\n    onResize(data, self) {\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n\n        img.img2.style['width'] = img.img.el.style['width'];\n        img.img2.style['height'] = img.img.el.style['height'];\n    }\n};\n\nexport let dragOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n    onEnd(data, self) {\n        let {left, top} = data;\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n        // img.left = left + 70;\n        // img.top = top + 31;\n\n        if (top - 31 < 0) {\n            top = 0;\n        } else if (left - 60 < 0) {\n            left = 0;\n        }\n\n        let range = self.data.getCellRectByXY(left + 60, top + 31);\n        range.sri = range.ri;\n        range.sci = range.ci;\n        range.eri = range.ri;\n        range.eci = range.ci;\n        let offsetLeft = left - range.left + 50;\n        let offsetTop = top - range.top + 21;\n\n        img.offsetLeft = offsetLeft;\n        img.offsetTop = offsetTop;\n        img.range = range;\n        if (typeof img.lastCi !== 'undefined' && typeof img.lastRi !== 'undefined') {\n            img.ri = img.lastRi;\n            img.ci = img.lastCi;\n        }\n        img.lastCi = range.ci;\n        img.lastRi = range.ri;\n\n        // self.data.history.addPic(deepCopy(self.data.pasteDirectionsArr), \"delete\");\n    },\n    onDrag(data) {\n    },\n};\n\nfunction spanDomPackage(spanDom, tableDom) {\n    let table = h(\"table\", \"\");\n    let tbody = h('tbody', '');\n\n    let textArr = spanDom.innerText.split(\"\\n\");\n    for (let i = 0; i < textArr.length; i++) {\n        let text = textArr[i];\n        let tr = h('tr', '');\n        let td = h('td', '');\n        td.html(text);\n        td.css('background', spanDom.style['background']);\n        td.css('font-weight', spanDom.style['font-weight']);\n        td.css('color', spanDom.style['color']);\n        tr.child(td);\n        tbody.child(tr);\n    }\n\n    table.child(tbody);\n    tableDom = table.el;\n\n    return tableDom;\n}\n\nexport function process(tableDom, styleDom = \"\") {\n    let {el, data} = this;\n    data.history.add(data.getData());\n    el.child(tableDom);\n    GetInfoFromTable.call(this, tableDom);\n    tableDom.parentNode.removeChild(tableDom);\n    if (styleDom) {\n        styleDom.parentNode.removeChild(styleDom);\n    }\n    sheetReset.call(this);\n}\n\nfunction mountPaste(e, cb) {\n    let cbd = e.clipboardData;\n    let p = false;\n\n    for (let i = 0; i < cbd.items.length; i++) {\n        let item = cbd.items[i];\n        if (item.kind === \"string\") {\n            item.getAsString((str) => {\n                let textDom = h('head', '');\n                let d = h('span', '');\n                if ((str.indexOf('<span') === -1 && str.indexOf('span>') === -1) && (str.indexOf('<table') === -1 && str.indexOf('table>') === -1)) {\n                    d.html(str);\n                    textDom.child(d.el);\n                    textDom = textDom.el;\n                }\n                else {\n                    textDom.html(str);\n                    textDom = textDom.el;\n                }\n                let imgDom = textDom.getElementsByTagName(\"img\")[0];\n                let styleDom = textDom.getElementsByTagName(\"style\")[0];\n                let tableDom = textDom.getElementsByTagName(\"table\")[0];\n                let spanDom = textDom.getElementsByTagName(\"span\")[0];\n                if (imgDom && !styleDom) {\n                    mountImg.call(this, imgDom);\n                    p = true;\n                } else {\n                    if (!tableDom) {\n                        setTimeout(() => {\n                            if (p) {\n                                return;\n                            }\n                            if (spanDom) {\n                                tableDom = spanDomPackage.call(this, spanDom, tableDom);\n                            }\n                            if (styleDom) {\n                                let {el} = this;\n                                el.child(styleDom);\n                            }\n\n                            if (tableDom && p === false) {\n                                let {el} = this;\n                                el.child(tableDom);\n                                GetInfoFromTable.call(this, tableDom);\n                                tableDom.parentNode.removeChild(tableDom);\n                                if (styleDom) {\n                                    styleDom.parentNode.removeChild(styleDom);\n                                }\n                                sheetReset.call(this);\n                                p = true;\n                            }\n                        }, 100)\n                    } else {\n                        if (styleDom) {\n                            let {el} = this;\n                            el.child(styleDom);\n                        }\n\n                        if (tableDom && p === false) {\n                            process.call(this, tableDom, styleDom);\n                            p = true;\n                        }\n                    }\n                }\n            });\n        } else if (item.kind === \"file\" && !p) {\n            let f = item.getAsFile();\n            let reader = new FileReader();\n            reader.onload = (evt) => {\n                // let {x, y, overlayerEl} = this;\n                // let {pasteDirectionsArr} = this.data;\n                let img = h('img', 'paste-img');\n                img.el.src = evt.target.result;\n\n                setTimeout(() => {\n                    if (p) {\n                        return;\n                    }\n                    p = true;\n                    mountImg.call(this, img.el);\n                }, 0);\n            };\n\n            if (!f)\n                return;\n            reader.readAsDataURL(f);\n        }\n    }\n    setTimeout(() => {\n        if (!p)\n            cb();\n        else {\n            let {data} = this;\n            data.change(data.getData());\n        }\n    })\n}\n\n// function processImg(item) {\n//     let f = item.getAsFile();\n//     let reader = new FileReader();\n//     reader.onload = (evt) => {\n//         // let {x, y, overlayerEl, pasteDirectionsArr} = this;\n//         let img = h('img', 'paste-img');\n//         img.el.src = evt.target.result;\n//\n//         setTimeout(() => {\n//             if (p) {\n//                 return;\n//             }\n//             p = true;\n//             mountImg.call(this, img.el);\n//         }, 0);\n//     };\n//\n//     reader.readAsDataURL(f);\n// }\n\n// function moveArr(top, left) {\n//     let {pasteDirectionsArr} = this.data;\n//     for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//         let p = pasteDirectionsArr[i];\n//         console.log(p.img.el['style'].top, \"108\");\n//         p.img.css(\"top\", `${top }px`)\n//             .css(\"left\", `${left  }px`)\n//     }\n// }\n\nfunction getMaxCoord(ri, ci) {\n    let top = 0;\n    let left = 0;\n    let {pasteDirectionsArr} = this.data;\n    let number = 0;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        if (p.ri === ri && p.ci === ci) {\n            if (left < p.nextLeft) {\n                left = p.nextLeft;\n            }\n            if (top < p.nextTop) {\n                top = p.nextTop;\n            }\n            number++;\n        }\n    }\n\n    return {\n        top: top,\n        left: left,\n        number: number,\n    }\n}\n\n\n//     add = true\nexport function mountImg(imgDom, init = false, sri, sci, range) {\n    let image = new Image();\n    image.src = imgDom.src;\n    image.onload = () => {\n        let width = image.width;\n        let height = image.height;\n        let img = imgDom;\n        let {container, data} = this;\n        let {pasteDirectionsArr} = data;\n        // if (add) {\n        //     // data.history.addPic(Object.assign([], pasteDirectionsArr), \"delete\");\n        // }\n\n        let {ri, ci} = data.selector;\n        if (init) {\n            ri = sri;\n            ci = sci;\n        }\n        let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n        const rect = data.getMoveRect(new CellRange(ri, ci, ri, ci));\n        let left = rect.left + pictureOffsetLeft;\n        let top = rect.top + pictureOffsetTop;\n        let number = 0;\n        let choose = getChooseImg.call(this);\n        if (choose) {\n            let args = getMaxCoord.call(this, choose.ri, choose.ci);\n            left = args.left;\n            top = args.top;\n            ri = choose.ri;\n            ci = choose.ci;\n            number = args.number;\n        }\n\n        let div = h('div', `${cssPrefix}-object-container`)\n            .css(\"position\", \"absolute\")\n            .css(\"top\", `${top}px`)\n            .css(\"width\", `${width}px`)\n            .css(\"height\", `${height}px`)\n            .css(\"z-index\", `100000`)\n            .css(\"left\", `${left}px`)\n            .child(img);\n        container.child(div);\n        new Drag(dragOption, this).register(div.el);\n        setTimeout(() => {\n            let {data} = this;\n            let directionsArr = new Resize(resizeOption, this).register(div.el);\n            let index = pasteDirectionsArr.length;\n\n            pasteDirectionsArr.push({\n                \"src\": img.src,\n                \"state\": true,\n                \"arr\": directionsArr,\n                \"img\": div,\n                \"index\": index,\n                \"img2\": img,\n                \"ri\": ri,\n                \"ci\": ci,\n                \"offsetLeft\": 0,\n                \"offsetTop\": 0,\n                \"number\": number,\n                \"range\": init ? range : data.selector.range,\n                \"top\": top,\n                \"left\": left,\n                \"nextLeft\": left + 15,\n                \"nextTop\": top + 15,\n            });\n            if (!init) {\n                this.data.change(this.data.getData());\n            }\n            this.direction = true;\n            div.css(\"width\", `${img.offsetWidth}px`);\n            div.css(\"height\", `${img.offsetHeight}px`);\n            containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr, init);\n            div.on('mousedown', () => containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr));\n        }, 0);\n    };\n}\n\nfunction hideDirectionArr() {\n    let {pasteDirectionsArr} = this.data;\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let arr = pasteDirectionsArr[i].arr;\n            if (arr.length > 0) {\n                for (let j = 0; j < arr.length; j++) {\n                    arr[j].style.display = 'none';\n                }\n            }\n            pasteDirectionsArr[i].state = false;\n            pasteDirectionsArr[i].img.css(\"z-index\", \"10000\");\n            pasteDirectionsArr[i].img2.style['border'] = \"none\";\n        }\n    }\n}\n\nfunction deleteImg(d = false) {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true || d === true) {\n                direction_delete.push(pasteDirectionsArr[i]);\n            } else {\n                direction_new.push(pasteDirectionsArr[i]);\n            }\n        }\n    }\n\n    Object.keys(direction_delete).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n\n    let {data} = this;\n    data.pasteDirectionsArr = direction_new;\n    data.change(data.getData());\n}\n\n// function deleteAllImg() {\n//     let {pasteDirectionsArr} = this.data;\n//     let direction_new = [];\n//     let direction_delete = [];\n//     this.direction = false;\n//     if (pasteDirectionsArr.length > 0) {\n//         for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//             direction_delete.push(pasteDirectionsArr[i]);\n//         }\n//     }\n//\n//     Object.keys(pasteDirectionsArr).forEach(i => {\n//         direction_delete[i].img.removeEl();\n//     });\n//\n//     this.pasteDirectionsArr = direction_new;\n// }\n\nfunction containerHandlerEvent(directionsArr, index, pasteDirectionsArr, init) {\n    hideDirectionArr.call(this);\n    this.direction = true;\n    Object.keys(directionsArr).forEach(i => {\n        directionsArr[i].style.display = 'block';\n    });\n\n    let {selector, editor} = this;\n    if (!init) {\n        selector.hide();\n        editor.clear();\n\n        pasteDirectionsArr[index].img.css(\"z-index\", \"99999999\");\n        pasteDirectionsArr[index].state = true;\n    } else {\n        hideDirectionArr.call(this);\n    }\n}\n\nfunction equals(x, y) {\n    let f1 = x instanceof Object;\n    let f2 = y instanceof Object;\n    if (!f1 || !f2) {\n        return x === y\n    }\n    if (Object.keys(x).length !== Object.keys(y).length) {\n        return false\n    }\n    let newX = Object.keys(x);\n    for (let p in newX) {\n        p = newX[p];\n        let a = x[p] instanceof Object;\n        let b = y[p] instanceof Object;\n        if (a && b) {\n            let equal = equals(x[p], y[p]);\n            if (!equal) {\n                return equal\n            }\n        } else if (x[p] !== y[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isHaveStyle(styles, style) {\n    for (let i = 0; i < styles.length; i++) {\n        if (equals(styles[i], style)) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n\nfunction GetInfoFromTable(tableObj) { // class ClipboardTableProxy; .tableDom   .dealColSpan() [477~483], dealStyle(), dealReferrence() row2 sheet12setCellRange3\n    let {data} = this;\n    let {ri, ci} = data.selector;\n    let styles = data.styles;\n    console.time(\"paste\");\n    let tableProxy = new TableProxy(data);\n\n    tableProxy.extend(tableObj, {ri, ci});\n    tableProxy.dealColSpan(tableObj);\n    tableProxy.dealStyle(tableObj, {ri, ci});\n    let {reference} = tableProxy.dealReference(tableObj, {ri, ci});\n    this.setCellRange(reference, tableProxy, true, tableProxy.parseTableCellRange(tableObj, {ri, ci}));\n\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n    let {advice, editor} = this;\n    editor.clear();\n    advice.show(left, top, 1, reference, tableProxy);\n    console.timeEnd(\"paste\");\n    return {\n        rows: data.rows._,\n        styles: styles\n    };\n}\n\n// function pasteType(type, ds, dei) {\n//     if (type === 1) {\n//\n//     } else if (type === 2) {\n//         xy2expr(ds[0] + dei, ds[1], 2);\n//     }\n// }\n\nexport {\n    mountPaste,\n    hideDirectionArr,\n    deleteImg,\n    // moveArr,\n    // deleteAllImg,\n    GetInfoFromTable,\n}\n\n","import dayjs from 'dayjs'\nimport {datePattern, str2Re} from \"../utils/reg_pattern\";\nimport {formatNumberRender} from \"../core/format\";\nimport {isHave, isNumber} from \"../core/helper\";\n\n\nexport function formatDate(diff) {\n    if(!isHave(diff) || !isNumber(diff)) {\n        return {\n            \"state\": false,\n            // \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n\n    let str = calcDecimals(diff, (i) => {\n        return i * 24 * 60;\n    });\n    str = formatNumberRender(str, 5);\n    let beginDate = dayjs('1900-01-01');\n    let beginDate2 = dayjs('1900-01-01');\n    let enter = false;\n\n    if (isHave(str) && str * 1 > 0) {\n        let second = calcDecimals(str, (i) => {\n            return i * 60;\n        });\n        enter = true;\n        second = formatNumberRender(second, 5);\n        beginDate2 = dayjs('1900-01-01  00:00:00').set('minute', str).set('second', second);\n    }\n\n    let date = \"\";\n    if (enter) {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n\n        let formula = beginDate2.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD  h:mm:ss');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": formula,\n            \"minute\": true\n        }\n    } else {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n}\n\nexport function changeFormat(date, format = 'YYYYMMDD') {\n  return dayjs(date).format(format);\n}\n\nexport function calcDecimals(diff, cb = () => {\n}) {\n    let arr = diff.toString().split('.');\n    if (arr.length > 2) {\n        return diff;\n    }\n    let fix = arr[1] + \"\";\n    let newData = fix;\n    for (let i = 0; i < fix.length; i++) {\n        newData = newData * 0.1;\n    }\n\n    return cb(newData);\n}\n\n// export function cellDate() {\n//\n// }\n\n// test\nexport function dateDiff(date) {\n    let valid = false;\n\n    for (let i = 0; valid === false && i < datePattern.length; i++) {\n        valid = str2Re(datePattern[i]).test(date);\n    }\n\n    if (valid === false) {\n        return {\n            \"isValid\": false,\n        };\n    } else {\n        date = date.replace(/[|]/g, \"-\");\n        date = date.replace(/[]/g, \"\");\n\n        return {\n            \"diff\": dayjs(date).diff(dayjs('1900-01-01'), 'day') + 2,\n            \"isValid\": true,\n        }\n    }\n}\n","import {xy2expr} from \"./alphabet\";\nimport PreAction from \"../model/pre_action\";\nimport {testValid} from \"../utils/test\";\n\nfunction operationItem(preAction) {\n    this.undoItems.push(preAction);\n    this.redoItems = [];\n}\n\nexport default class MultiPreAction {\n    constructor(data) {\n        this.undoItems = [];\n        this.redoItems = [];\n        this.data = data;\n    }\n\n    addStep({type, action, ri, ci, expr, cellRange, cells, height, width, property, value, oldData}, {oldCell, newCell, oldMergesData, newMergesData, oldStep}) {\n        let preAction = \"\";\n\n        if(type === 1) {\n            preAction = new PreAction({\n                type,\n                action, ri, ci, expr, oldCell, newCell\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 2 || type === 5 || type === 11 || type === 12 || type === 6) {\n            preAction = new PreAction({\n                type, oldMergesData, property, value, newMergesData,\n                action, cellRange,  oldCell, newCell: cells\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 13) {\n            preAction = new PreAction({\n                type, oldData, newData: oldStep.oldData,\n                action,\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 3) {\n            preAction = new PreAction({\n                type,\n                action, height, ri, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 4) {\n            preAction = new PreAction({\n                type,\n                action, width, ci, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        }\n\n        testValid.call(this);\n    }\n\n    // merges\n    getStepType(type, {ri, ci, expr, text, range, cellRange, property, value}) {\n        let str = \"\";\n        let {rows, cols} = this.data;\n\n        if(type === 1) {\n            str = `${expr}\"${text}\"`;\n            return {\n                action: str,\n                type,\n                ri, ci, expr\n            };\n        } else if(type === 2) {\n            let expr1 = xy2expr(range.sci, range.sri);\n            let expr2 = xy2expr(range.eci, range.eri);\n            expr = expr1 === expr2 ? expr1 : `${expr1}:${expr2}`;\n            str = `${expr}`;\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(range),\n            };\n        } else if(type === 3) {\n            let height = rows.getHeight(ri);\n            str = ``;\n            return {\n                action: str,\n                type,\n                height: height,\n                ri: ri\n            };\n        } else if(type === 4) {\n            let width = cols.getWidth(ci);\n            str = ``;\n            return {\n                action: str,\n                type,\n                width: width,\n                ci: ci\n            };\n        } else if(type === 5) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 12) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 13) {\n            str = '';\n\n            return {\n                action: str,\n                type, oldData: this.data.getData(),\n            };\n        }else if(type === 11) {\n            if (property === 'font-bold' || property === 'font-italic'\n                || property === 'font-name' || property === 'font-size' || property === 'color') {\n                str = \"\";\n            } else if (property === 'underline') {\n                str = \"\";\n            } else if (property === 'bgcolor' || property === 'format') {\n                str = \"\";\n            } else if (property === 'align') {\n                if (value === 'left') {\n                    str = \"\";\n                } else if (value === 'center') {\n                    str = \"\";\n                } else if (value === 'right') {\n                    str = \"\";\n                }\n            } else if (property === 'valign') {\n                if (value === 'top') {\n                    str = \"\";\n                } else if (value === 'center') {\n                    str = \"\";\n                } else if (value === 'bottom') {\n                    str = \"\";\n                }\n            } else if (property === 'border') {\n                str = \"\";\n            } else if (property === 'strike') {\n                str = \"\";\n            } else if (property === 'merge') {\n                str = '';\n            }\n\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 6) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        }\n    }\n\n    undo() {\n        let preAction = this.does(this.getItems(1), 1);\n        this.redoItems.push(preAction);\n    }\n\n    redo() {\n        let preAction = this.does(this.getItems(2), 2);\n        this.undoItems.push(preAction);\n    }\n\n    eachRange(range) {\n        let {rows} = this.data;\n\n        return rows.eachRange(range);\n    }\n\n    does(actionItems, actionType) {\n        if (!this.data.settings.showEditor) {\n            return;\n        }\n\n        if (actionItems.length <= 0) {\n            return;\n        }\n        let {data} = this;\n        let {sheet} = data;\n\n        let preAction = actionItems.pop();\n        preAction.restore(data, sheet, actionType);\n\n        return preAction;\n    }\n\n    getItems(type) {\n        if (type === 1) {\n            return this.undoItems;\n        } else {\n            return this.redoItems;\n        }\n    }\n}\n","import CellProp from \"./cell_prop\";\nimport {isHave} from \"../core/helper\";\nimport {xy2expr} from \"../core/alphabet\";\n\nfunction getType(dType, sType) {\n    if (dType === 1 && sType === 1) {\n        return 1;           // 1 * 1\n    } else if (dType === 1 && sType === 2) {\n        return 2;\n    } else if (dType === 1 && sType === 3) {    //  * \n        return 3;\n    } else if (dType === 2 && sType === 1) {\n        return 4;\n    } else if (dType === 3 && sType === 1) {\n        return 5;\n    } else if (dType === 2 && sType === 2) {\n        return 6;\n    } else if (dType === 2 && sType === 3) {\n        return 7;\n    } else if (dType === 3 && sType === 2) {\n        return 8;\n    } else if (dType === 3 && sType === 3) {\n        return 9;\n    }\n}\n\nfunction changeDarrToDoubleArr(darr, selectorRange) {\n    let ri = selectorRange.sri;\n    let _darr = [];\n    let arr = [];\n    let index = 0;\n    selectorRange.each((i, j) => {\n        if (ri !== i) {\n            ri = i;\n            _darr.push(arr);\n            arr = [];\n        }\n        arr.push(darr[index]);\n        index += 1;\n    });\n    _darr.push(arr);\n\n    return _darr;\n}\n\nexport default class PaintFormat {\n    constructor(selectorRange, dstRange) {\n        this.selectorRange = selectorRange;\n        this.dstRange = dstRange;\n    }\n\n    getPaintType() {\n        let {dstRange, selectorRange} = this;\n\n        let dType = dstRange.getType();\n        let sType = selectorRange.getType();\n\n        let paintType = getType(dType, sType);\n\n        return paintType;\n    }\n\n    makePaintArr(type, darr) {\n        let {dstRange, selectorRange} = this;\n        let pArr = [];\n        // if (type === 1 || type === 6) {  // 1 // 1\n        //     let index = 0;\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         index += 1;\n        //         if (index === darr.length) {\n        //             index = 0;\n        //         }\n        //     });\n        // } else if (type === 3) {        // 3  * 1\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         let {cell} = _darr[0][index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //     });\n        // } else if(type === 7) {\n        //     let recordRi = dstRange.sri;\n        //     let rowIndex = 0;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === _darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = _darr[rowIndex][0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // }else if (type === 4 || type === 2) {   // 4: 1 * 1    6: 1 * 1\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //     });\n        // } else if (type === 5) {\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             index = 0;\n        //         }\n        //\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //         recordRi = i;\n        //     });\n        // } else if (type === 8) {\n        //     let rowIndex = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = darr[rowIndex];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // } else if (type === 9) {\n            let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n            let rowIndex = 0;\n\n            let _darr = changeDarrToDoubleArr(darr, selectorRange);\n\n            dstRange.each((i, j) => {\n                if (recordRi !== i) {\n                    rowIndex += 1;\n                    index = 0;\n                    if (rowIndex === _darr.length) {\n                        rowIndex = 0;\n                    }\n                }\n\n                let {cell} = _darr[rowIndex][index];\n\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j));\n                pArr.push(cellProp);\n\n                if (index === dci) {\n                    index = 0;\n                } else {\n                    index += 1;\n                }\n                recordRi = i;\n            });\n        // }\n\n        return pArr;\n    }\n}","/* global document */\n\nimport {formulaCalc} from '../core/formula';\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper, {isHave, isNumber, useOne} from './helper';\nimport {isFormula, Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\nimport Moved from '../event/move';\nimport {h} from \"../component/element\";\nimport {mountImg} from \"../event/paste\";\nimport {parseCell2} from \"../component/table\";\nimport {isLegal} from \"./operator\";\nimport Recast from \"./recast\";\nimport {changeFormat, dateDiff, formatDate} from '../utils/date';\nimport {formatNumberRender} from \"./format\";\nimport MultiPreAction from \"../core/multi_pre_action\";\nimport CellProxy from \"./cell_proxy\";\nimport CellProp from \"../model/cell_prop\";\nimport PaintFormat from \"../model/paint_format\";\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        family: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    formula: {},\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showEditor: true,\n    autoLoad: true,\n    ignore: [],\n    cellWidth: 0,\n    ignoreRi: 0,\n    minus: false,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 10,\n    },\n    rowsInit: false,\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        flexible: false,\n        underline: false,\n        autoAdapt: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n    },\n};\n\nconst toolbarHeight = 41;\n\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    if (!dst) {\n        return false;\n    }\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange, cleard) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    if (cleard)\n        clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (isHave(cell.style)) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n\n    Object.assign(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction selectorCellText(ri, ci, text, event_type) {\n    if (ri === -1 || ci === -1) {\n        return {\n            \"state\": true,\n            \"msg\": \"\"\n        };\n    }\n    if (event_type !== 'style' && (!text || text[0] !== '=')) {\n        return {\n            \"state\": false,\n            \"msg\": \"\"\n        };\n    }\n\n    // state\n    let args = errorPop.call(this, text);\n    if (event_type !== 'style' && args.state === true) {\n        return {\n            \"msg\": args.msg,\n            \"state\": true,\n        };\n    }\n    return {\n        \"msg\": args.msg,\n        \"state\": false,\n    };\n}\n\nfunction errorPop(text) {\n    let enter = false;\n    let msg = \"\";\n    try {\n        let recast = new Recast(text);\n        recast.parse();\n    } catch (e) {\n        msg = ', : ' + e.description;\n        enter = true;\n    }\n\n    if (enter === true) {\n        if (isLegal(text) === false) {\n            msg = '';\n            enter = true;\n        }\n    }\n\n    if (enter) {\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else {\n        return {\n            \"state\": false,\n            \"msg\": msg\n        };\n    }\n}\n\nfunction processPasteDirectionsArr(pasteDirectionsArr, type = 'to', sheet) {\n    if (type === 'to') {\n        let arr = [];\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            console.log(item);\n            let newItem = {\n                src: item.img2.src,\n                ri: item.ri,\n                ci: item.ci,\n                top: item.top,\n                left: item.left,\n                range: item.range,\n                offsetLeft: item.offsetLeft,\n                offsetTop: item.offsetTop,\n                nextLeft: item.nextLeft,\n                nextTop: item.nextTop,\n                img: item.img,\n                arr: item.arr,\n                img2: item.img2\n            };\n\n            arr.push(newItem);\n        }\n\n        return arr;\n    } else if (type === 'from') {\n        if (typeof sheet === 'string') {\n            return;\n        }\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            let img = h('img', '');\n            img.el.src = item.src;\n            mountImg.call(sheet, img.el, true, item.ri, item.ci, item.range);\n        }\n    }\n}\n\nfunction clickCopyPasteHelp(ri, lci) {\n    let {rows} = this;\n    let lri = ri + 1;\n    let enter = true;\n    while (enter) {\n        let lcell = rows.getCellOrNew(lri, lci);\n        if (!lcell || !lcell.text) {\n            enter = false;\n        } else {\n            lri = lri + 1;\n        }\n    }\n\n    return lri;\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSignleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            setStyleBorder.call(this, ri, ci, {});\n        }\n    }\n\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci <= eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\n// function getCellRowByAbsX(scrollOffsetx) {\n//     let x = scrollOffsetx;\n//     const {cols} = this;\n//     const fsw = this.freezeTotalWidth();\n//     let inits = cols.indexWidth;\n//     if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n//     const [ci, left, width] = helper.rangeReduceIf(\n//         0,\n//         cols.len,\n//         inits,\n//         cols.indexWidth,\n//         x,\n//         i => cols.getWidth(i),\n//     );\n//     if (left <= 0) {\n//         return {ci: 0, left: 0, width: cols.indexWidth};\n//     }\n//     return {ci: ci - 1, left, width};\n// }\n\n// function getCellRowByAbsY(scrollOffsety) {\n//     let y = scrollOffsety;\n//     let {rows} = this;\n//     let ri = 0;\n//     let top = rows.height;\n//     const frset = this.exceptRowSet;\n//     let {height} = rows;\n//\n//     for (; ri < rows.len; ri += 1) {\n//         if (top > y) break;\n//         if (!frset.has(ri)) {\n//             height = rows.getHeight(ri);\n//             top += height;\n//         }\n//     }\n//\n//     if (ri <= 0) {\n//         ri = 0;\n//     }\n//     if (height <= 0) {\n//         height = 0;\n//     }\n//\n//     return {ri: ri, top, height};\n// }\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction makeFormatCell({text, formula}, {symbol, position}, cb) {\n    if (!isHave(text) || !isNumber(text)) {\n        return null;\n    }\n\n    let cText = cb(formatNumberRender(text, -1));\n    formula = isFormula(formula) ? formula : cText;\n    if (!isNaN(cText)) {\n\n        return {\n            \"text\": position === 'begin' ? symbol + cText : cText + symbol,\n            \"value\": text,\n            \"formulas\": formula,\n        };\n    } else {\n        return null;\n    }\n}\n\n// what = 'input' || 'change'\nfunction tryParseToNum(cell, ri, ci) {\n    return getType.call(this, ri, ci, cell);\n}\n\nfunction getType(ri, ci, cell) {\n    let data = this;\n    let {rows} = this;\n    let cellStyle = data.getCellStyle(ri, ci);\n    let {isValid, diff} = dateDiff(cell.text);\n\n    let format = rows.getCellStyleConvert(cellStyle, isValid);\n    if (format === 'number') {\n        let text = cell.text, formula = cell.formulas;\n        let _cell = {};\n        if (isValid) {\n            _cell = {\n                \"text\": diff.toFixed(2),\n                \"formulas\": formula,\n            };\n        } else {\n            text = formatNumberRender(text, 2);\n            _cell = {\n                \"text\": text,\n                \"value\": cell.text,\n                \"formulas\": formula,\n            };\n        }\n\n        if (isHave(_cell.text) && isNumber(_cell.text)) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        } else {\n            return {\n                \"state\": false,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'date' || format === 'datetime') {\n        let text = cell.text;\n\n        if (!isValid) {\n            let args = formatDate(text);\n            let {state, date} = args;\n            // minute = args.minute;\n            isValid = state;\n            diff = cell.text;\n            text = date;\n        }\n\n        if (isValid) {\n            if (format === 'datetime') {\n                text = changeFormat(formatDate(dateDiff(text).diff).date);\n            }\n\n        }\n\n        return {\n            \"state\": isValid,\n            \"style\": format,\n            \"text\": !isHave(cellStyle) ? diff : text,\n        };\n    } else if (format === 'normal') {\n        if (isValid) {\n            let text = diff, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": rows.toString(formula),\n                \"text\": rows.toString(text),\n            };\n\n            return {\n                \"state\": true,\n                \"text\": _cell.text,\n                \"style\": format,\n                \"cell\": _cell,\n            }\n        } else {\n            let text = cell.text, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'rmb') {\n        let text = \"\", formula = \"\";\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = formatNumberRender(cell.text, 0);\n            formula = cell.formulas;\n        }\n\n        let _cell = makeFormatCell({text, formula}, {symbol: \"\", position: \"begin\"}, (s) => {\n            return s;\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    } else if (format === 'percent') {\n        let text = \"\", formula = \"\";\n\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = rows.useOne(cell.value, cell.text);\n            formula = cell.formulas;\n        }\n        let _cell = makeFormatCell({text, formula}, {symbol: \"%\", position: \"end\"}, (s) => {\n            return Number(s * 100).toFixed(2);\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    }\n\n    return {\n        \"state\": false,\n        \"style\": format,\n        \"text\": cell.text,\n        \"cell\": {},\n    };\n}\n\n\nexport default class DataProxy {\n    constructor(name, settings, methods) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.methods = methods;\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row, this);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = {};\n        this.showEquation = false;\n        this.calc = formulaCalc();\n        this.pasteDirectionsArr = [];\n        this.changeDataForCalc = null;\n\n        // save data end\n\n        // don't save object\n        this.multiPreAction = new MultiPreAction(this);\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        // this.history = new History(this);\n        this.clipboard = new Clipboard();\n        this.moved = new Moved();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    tryParseToNum(cell, ri, ci) {\n        return tryParseToNum.call(this, cell, ri, ci);\n    }\n\n    clickCopyPaste() {\n        let ri = this.selector.range.eri;\n        let ci = this.selector.range.eci;\n        let {rows} = this;\n        const cell = rows.getCellOrNew(ri, ci);\n        const cell2 = rows.getCellOrNew(ri + 1, ci);\n        if (!cell || !cell.text || (cell2 && cell2.text)) {\n            return {\n                enter: false\n            };\n        }\n\n        let left = clickCopyPasteHelp.call(this, ri, ci - 1);\n        let right = clickCopyPasteHelp.call(this, ri, ci + 1);\n        let eri = left < right ? right : left;\n\n        let enter = false;\n        for (let i = 1; i < eri && enter === false; i++) {\n            let cell3 = rows.getCellOrNew(ri + i, ci);\n\n            if (cell3 && cell3.text) {\n                eri = ri + i;\n                enter = true;\n            }\n        }\n\n\n        let dstCellRange = new CellRange(ri + 1, ci, eri - 1, ci);\n        let srcCellRange = new CellRange(ri, ci, ri, ci);\n\n        return {\n            enter: true,\n            dstCellRange: dstCellRange,\n            srcCellRange: srcCellRange\n        };\n    }\n\n\n    // getSelectedValidator() {\n    //     const {ri, ci} = this.selector;\n    //     const v = this.validations.get(ri, ci);\n    //     return v ? v.validator : null;\n    // }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.multiPreAction.getItems(1).length > 0;\n        // return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.multiPreAction.getItems(2).length > 0;\n    }\n\n    undo() {\n        this.multiPreAction.undo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.undo(this.getData(), (d) => {\n        //     this.setData(d);\n        // }, sheet);\n    }\n\n    historyList(item) {\n        return this.multiPreAction.getItems(item);\n    }\n\n    redo() {\n        this.multiPreAction.redo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.redo(this.getData(), (d) => {\n        //     this.setData(d);\n        // });\n    }\n\n    copy() {\n        document.execCommand('copy', true);\n        this.clipboard.copy(this.selector.range);\n    }\n\n    makeCellPropArr(range, dsri, dsci) {\n        let {rows} = this;\n        let darr = [];\n        let cells = rows.eachRange(range);\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n\n            if (isHave(cell) && isHave(cell.style) === false) {\n                let cstyle = this.defaultStyle();\n                cell.style = this.addStyle(cstyle);\n            }\n\n            let cellProp = new CellProp(ri + dsri, ci + dsci, cell, xy2expr(ri + dsri, ci + dsci));\n            darr.push(cellProp);\n        }\n\n        return darr;\n    }\n\n    setCellByCellProp(pArr, cb) {\n        let {rows} = this;\n        for (let i = 0; i < pArr.length; i++) {\n            let {ri, ci, cell} = pArr[i];\n            if (isHave(cell) && isHave(cell.style)) {\n                rows.setCell(ri, ci, cell, 'style');\n            }\n            cb(ri, ci);\n        }\n    }\n\n    paintFormatChange(cb) {\n        this.changeData(() => {\n            let {clipboard,   selector} = this;\n            let {range} = clipboard;\n            let sri = selector.ri;\n            let sci = selector.ci;\n\n            let dsri = sri - range.sri;\n            let dsci = sci - range.sci;\n            let darr = this.makeCellPropArr(range, dsri, dsci);\n\n            if (selector.range.eri - selector.range.sri === 0 && selector.range.eci - selector.range.sci === 0) {\n                this.setCellByCellProp(darr, cb);\n            } else {\n                let paintFormat = new PaintFormat(range, selector.range);\n                let paintType = paintFormat.getPaintType();\n                let pArr = paintFormat.makePaintArr(paintType, darr);\n\n                this.setCellByCellProp(pArr, cb);\n            }\n        }, {type: 12, cellRange: this.selector.range});\n    }\n\n    move() {\n        this.moved.move();\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    paste(cellRange) {\n        this.changeData(() => {\n\n        }, {type: 6, cellRange: cellRange});\n    }\n\n    // what: all | text | format\n    // paste(what = 'all', error = () => {\n    // }) {\n    //\n    //     // console.log('sIndexes:', sIndexes);\n    //     // const {clipboard, selector} = this;\n    //     // if (clipboard.isClear()) return false;\n    //     // if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n    //     //\n    //     // this.changeData(() => {\n    //     //     if (clipboard.isCopy()) {\n    //     //         copyPaste.call(this, clipboard.range, selector.range, what);\n    //     //     } else if (clipboard.isCut()) {\n    //     //         cutPaste.call(this, clipboard.range, selector.range);\n    //     //     }\n    //     // });\n    //     return true;\n    // }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        }, {type: 5, cellRange: cellRange});\n\n        return true;\n    }\n\n\n    clickAutofill(srcRange, cellRange, what, error = () => {\n    }) {\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        // row index\n        if (nri <= cri) [sri, eri] = [nri, cri];\n        else eri = nri;\n        // col index\n        if (nci <= cci) [sci, eci] = [nci, cci];\n        else eci = nci;\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                const cell = rows.getCellOrNew(selector.ri, selector.ci);\n                cell.text = `=${value}()`;\n                cell.formulas = `=${value}()`;\n            } else {\n                selector.range.each((ri, ci) => {\n                    let cell = rows.getCellOrNew(ri, ci);\n\n                    let cstyle = {};\n                    if (isHave(cell.style)) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        // cell.text = cell.text.replace(\"\", \"\");\n                        // cell.formulas = cell.formulas.replace(\"\", \"\");\n                        rows.setCellText(ri, ci, {\n                            text: cell.text,\n                            style: this.addStyle(cstyle)\n                        }, 'format');\n                        // this.rows.workbook.change(ri, ci, cell, deepCopy(cell), 'change');\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'flexible') {\n                        if (this.exceptRowSet.has(ri + 1) && this.exceptRowSet.has(ri + 2) && !this.exceptRowSet.has(ri + 3)) {\n                            this.exceptRowSet.delete(ri);\n                            this.exceptRowSet.delete(ri + 1);\n                            this.exceptRowSet.delete(ri + 2);\n                        } else {\n                            this.exceptRowSet.add(ri);\n                            this.exceptRowSet.add(ri + 1);\n                            this.exceptRowSet.add(ri + 2);\n                        }\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    }\n                });\n            }\n        }, {type: 11, cellRange: this.selector.range, property, value});\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        this.setCellText(nri, ci, {text}, state);\n        this.resetAutoFilter();\n    }\n\n    // state: input | finished\n    setSelectedCell(text, state = 'input', formulas, ri, ci) {\n        this.setCellAll(ri, ci, text, formulas, state);\n        this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    editorChangeToHistory(oldCell, {ri, ci}, type) {\n        if (ri === -1 || ci === -1) {\n            return {\"state\": false}\n        }\n        let newCell = this.rows.getCell(ri, ci);\n        // if (oldCell.text === newCell.text || oldCell.formulas === newCell.text) {\n        //     return {\n        //         \"state\": false,\n        //     };\n        // }\n        let {multiPreAction} = this;\n        let expr = xy2expr(ci, ri);\n        let step = multiPreAction.getStepType(type, {ri, ci, expr, text: newCell.text});\n\n        let oc = new CellProp(ri, ci, oldCell, expr);\n        let nc = new CellProp(ri, ci, newCell, expr);\n        multiPreAction.addStep(step, {oldCell: [oc], newCell: [nc]});\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        return {\n            \"state\": true\n        }\n    }\n\n    changeToHistory({ri, type, ci, cellRange, property, value, oldCell, oldMergesData}, oldStep) {\n        if (type === -1) {\n            return {\"state\": false,}\n        }\n\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n        multiPreAction.addStep(step, {oldCell, oldMergesData, newMergesData: this.merges.getData(), oldStep,});\n        return {\n            \"state\": true\n        }\n    }\n\n    getSelectedCellRiCi(ri, ci) {\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n\n    getMoveRect(range) {\n        return this.getRect(range);\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    getCellRectByXYWithNotTotalResult(x, y) {\n        const {\n            scroll, merges,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n\n        if (ci === -1) {\n            // // width = cols.totalWidth();\n            // let args = getCellRowByAbsX.call(this, scroll.x);\n            // console.log(args);\n            // // ci = args.ci;\n        }\n        if (ri === -1) {\n            // let args = getCellRowByAbsY.call(this, scroll.y);\n            // console.log(\"1179: \", args.ri);\n            // ri = args.ri;\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    isSignleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSignleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            const cell = rows.getCellOrNew(sri, sci);\n            cell.merge = [rn - 1, cn - 1];\n            this.merges.add(selector.range);\n            // delete merge cells\n            this.rows.deleteCells(selector.range);\n            // console.log('cell:', cell, this.d);\n            this.rows.setCell(sri, sci, cell);\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSignleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                let v = selector.range.toString();\n                let eri = selector.range.eri;\n                const {rows} = this;\n\n                for (let i = selector.range.sci; i <= selector.range.eci; i++) {\n                    let range = new CellRange(selector.range.sri, i, selector.range.sri, i);\n                    range = rows.autoFilterRef(v, range);\n                    if (eri < range.eri) {\n                        eri = range.eri;\n                    }\n                }\n                let range = new CellRange(selector.range.sri, selector.range.sci, eri, selector.range.eci);\n                autoFilter.ref = range.toString();\n            }\n        });\n    }\n\n    throwFormula() {\n        const {selector, rows} = this;\n\n        this.changeData(() => {\n            selector.range.each((i, j) => {\n                const cell = rows.getCellOrNew(i, j);\n                if (cell && cell.text && cell.formulas) {\n                    rows.setCellAll(i, j, cell.text, cell.text);\n                }\n            });\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        }, {type: 2});\n    }\n\n    // type: row | column\n    insert(type, n = 1, begin = -1) {\n        const {sri, sci} = this.selector.range;\n        const {rows, merges, cols} = this;\n        if (type === 'row') {\n            begin = begin !== -1 ? begin : sri;\n        } else if ('column') {\n            begin = begin !== -1 ? begin : sci;\n        }\n\n        this.changeData(() => {\n            let si = begin;\n            if (type === 'row') {\n                rows.insert(begin, n);\n            } else if (type === 'column') {\n                rows.insertColumn(begin, n);\n                si = begin;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        }, {type: 13, data: this.getData(), property: \"insert\"});\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= 1;\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {scroll, freeze, rows} = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        // console.log('ri:', ri, ' ,y:', y1);\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getMax() {\n        let mci = this.cols.len;\n        let mri = this.rows.len;\n\n        return {\n            mri,\n            mci\n        }\n    }\n\n\n    // isEmpty(cell) {\n    //     return this.rows.isEmpty(cell);\n    // }\n\n    renderFormat(style, cell, nrindex, cindex, filter) {\n        let cellProxy = new CellProxy(cell);\n        return cellProxy.renderFormat(style, nrindex, cindex, this, filter);\n    }\n\n    isFormula(text) {\n        return this.rows.isFormula(text);\n    }\n\n    toString(text) {\n        return this.rows.toString(text);\n    }\n\n    // isBackEndFunc(text) {\n    //     return this.rows.isBackEndFunc(text);\n    // }\n\n    // isReferOtherSheet(cell) {\n    //     return this.rows.isReferOtherSheet(cell);\n    // }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    // getCellStyleHandle(index, type, cell, ri, ci) {\n    //     let style = this.styles[index];\n    //\n    //     if (style && style.format === type) {\n    //         return true;\n    //     }\n    //     return false;\n    // }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    getCellByExpr(src, table, name, inputText, pos) {\n        // let p1 = inputText.substring(0, pos);\n        // let p2 = inputText.substring(pos, inputText.length);\n        // inputText = p1 + src + p2;\n        // let workbook = parseCell2.call(table, this.viewRange(), true, inputText);\n        // return {\n        //     \"text\": workbook['Sheets'][name].A1.w ? workbook['Sheets'][name].A1.w : workbook['Sheets'][name].A1.v,\n        //     \"formulas\": p1 + `${name}!` + src + p2\n        // };\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, {text, style}, state) {\n        // text = text.replace(/\\\"/g)\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, {text: ''});\n            history.add(this.getData());\n            rows.setCellText(ri, ci, {text});\n        } else {\n            if (state === 'end') {\n                rows.setCellAll(ri, ci, text);\n            } else if (state === 'formulas') {\n                rows.setCellAll(ri, ci, text, \"-\");\n            } else if (state === 'style') {\n                rows.setCellText(ri, ci, {text, style}, 'style');\n            } else {\n                rows.setCellText(ri, ci, {text});\n                // rows.\n            }\n            //  change\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    // setCellWithFormulas(ri, ci, text, formulas, what = 'all') {\n    //     const {rows} = this;\n    //     rows.setCellAll(ri, ci, text, formulas, what);\n    // }\n\n\n    // state: input | finished\n    setCellAll(ri, ci, text, formulas, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellAll(ri, ci, '', '');\n            history.add(this.getData());\n            rows.setCellAll(ri, ci, text, formulas);\n        } else {\n            rows.setCellAll(ri, ci, text, formulas);\n            // this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text, formulas);\n    }\n\n    equationIsActive() {\n        return this.showEquation;\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        }, {type: 3, ri: ri});\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        }, {type: 4, ci: ci});\n    }\n\n    viewHeight() {\n        const {view, showToolbar} = this.settings;\n        let h = view.height();\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    viewRange2() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) offset += 1;\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                cb(i, y, rowHeight);\n                y += rowHeight;\n                if (y > this.viewHeight()) break;\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            cb(i, x, colWidth);\n            x += colWidth;\n            if (x > this.viewWidth()) break;\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    // addPicture(pic) {\n    //     const {pictures} = this;\n    //\n    // }\n\n    getChangeDataToCalc() {\n        let {multiPreAction} = this;\n        if (multiPreAction.undoItems.length <= 0) {\n            return null;\n        }\n        let lastStep = multiPreAction.undoItems[multiPreAction.undoItems.length - 1];\n        if (!isHave(lastStep)) {\n            return null;\n        }\n\n        return lastStep;\n    }\n\n    changeData(cb, {type = -1, ri = -1, ci = -1, cellRange = \"\", property = \"\", value = \"\"} = -1) {\n        if (this.settings.showEditor === false) {\n            return;\n        }\n\n        let oldCell = {};\n        let oldMergesData = this.merges.getData();\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n\n        if (cellRange !== \"\") {\n            let {multiPreAction} = this;\n            oldCell = multiPreAction.eachRange(cellRange);\n        }\n        cb();\n        this.changeToHistory({type, ri, ci, cellRange, property, value, oldCell, oldMergesData, newData: this.getData(), }, step);\n        this.changeDataForCalc = this.getChangeDataToCalc();\n\n        this.change(this.getData());\n    }\n\n    cutPaste(srcCellRange, dstCellRange, cleard = true) {\n        cutPaste.call(this, srcCellRange, dstCellRange, cleard);\n    }\n\n    setData(d, sheet = \"\", out = false) {\n        const {autoFilter} = this;\n        Object.keys(d).forEach((property) => {\n            // this.judgeAutoWidth(d.rows);\n            if (property === 'merges'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'flex') {\n                autoFilter.addFiexRows(d[property]);\n            } else if (property === 'rows') {\n                this[property].setData(d[property], sheet, out, this.settings.rowsInit);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'pictures') {\n                if (d[property]) {\n                    processPasteDirectionsArr.call(this, d[property], 'from', sheet);\n                }\n            } else if (property === 'autofilter') {\n                if (d[property] && d[property].ref) {\n                    autoFilter.ref = d[property].ref;\n                    autoFilter.filters = d[property].filters;\n                    autoFilter.sort = d[property].sort;\n                }\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    selectorCellText(ri, ci, text, event_type) {\n        return selectorCellText.call(this, ri, ci, text, event_type);\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter, pasteDirectionsArr,\n        } = this;\n        return {\n            editor: this.settings.showEditor,\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            pictures: processPasteDirectionsArr(pasteDirectionsArr, 'to'),\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n}\n","export default {\n    toolbar: {\n        undo: '',\n        redo: '',\n        paintformat: '',\n        clearformat: '',\n        format: '',\n        font: '',\n        fontSize: '',\n        fontBold: '',\n        fontItalic: '',\n        underline: '',\n        strike: '',\n        textColor: '',\n        fillColor: '',\n        border: '',\n        merge: '',\n        align: '',\n        valign: '',\n        textwrap: '',\n        freeze: '',\n        autofilter: '',\n        add: '',\n        calc: '',\n        formula: '',\n        more: '',\n        throwFormula: '',\n        comeBack: '',\n    },\n    revision: {\n        comeBack: '',\n    },\n    contextmenu: {\n        copy: '',\n        cut: '',\n        paste: '',\n        pasteValue: '',\n        pasteFormat: '',\n        insertRow: '',\n        insertColumn: '',\n        deleteRow: '',\n        deleteColumn: '',\n        deleteCell: '',\n        deleteCellText: '',\n        validation: '',\n        errorPop: '',\n        recover: '',\n    },\n    format: {\n        normal: '',\n        text: '',\n        number: '',\n        percent: '',\n        rmb: '',\n        usd: '',\n        date: '',\n        time: '',\n        datetime: '',\n        duration: '',\n    },\n    date_formula: {\n        sum: '',\n        average: '',\n        max: '',\n        min: '',\n        concat: '',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: '',\n        notMatch: '',\n        between: ' {}  {} ',\n        notBetween: ' {}  {} ',\n        notIn: '',\n        equal: ' {}',\n        notEqual: ' {}',\n        lessThan: ' {}',\n        lessThanEqual: ' {}',\n        greaterThan: ' {}',\n        greaterThanEqual: ' {}',\n    },\n    error: {\n        pasteForMergedCell: '',\n    },\n    calendar: {\n        weeks: ['', '', '', '', '', '', ''],\n        months: ['', '', '', '', '', '', '', '', '', '', '', ''],\n    },\n    button: {\n        cancel: '',\n        remove: '',\n        save: '',\n        ok: '',\n    },\n    sort: {\n        desc: '',\n        asc: '',\n    },\n    filter: {\n        empty: '',\n    },\n    dataValidation: {\n        mode: '',\n        range: '',\n        criteria: '',\n        modeType: {\n            cell: '',\n            column: '',\n            row: '',\n        },\n        type: {\n            list: '',\n            number: '',\n            date: '',\n            phone: '',\n            email: '',\n        },\n        operator: {\n            be: '',\n            nbe: '',\n            lt: '',\n            lte: '',\n            gt: '',\n            gte: '',\n            eq: '',\n            neq: '',\n        },\n    },\n};\n\n","import {debugout} from \"./debugout\";\nlet bugout = \"\";\ntry {\n    bugout = new debugout();\n} catch (e) {\n    console.error(e);\n}\n\nexport {\n    bugout,\n}","/*\n\n    debugout.js\n    by @inorganik\n    \n*/\n\n\n// save all the console.logs\nexport function debugout() {\n    var self = this;\n\n    // OPTIONS\n    self.realTimeLoggingOn = true; // log in real time (forwards to console.log)\n    self.useTimestamps = false; // insert a timestamp in front of each log\n    self.useLocalStorage = true; // store the output using window.localStorage() and continuously add to the same log each session\n    self.recordLogs = true; // set to false after you're done debugging to avoid the log eating up memory\n    self.autoTrim = true; // to avoid the log eating up potentially endless memory\n    self.maxLines = 2500; // if autoTrim is true, this many most recent lines are saved\n    self.tailNumLines = 100; // how many lines tail() will retrieve\n    self.logFilename = 'debugout.txt'; // filename of log downloaded with downloadLog()\n\n    // vars\n    self.depth = 0;\n    self.parentSizes = [0];\n    self.currentResult = '';\n    self.startTime = new Date();\n    self.output = '';\n\n    this.version = function () {\n        return '0.5.0'\n    }\n\n    /*\n        USER METHODS\n    */\n    this.getLog = function () {\n        var retrievalTime = new Date();\n        // if recording is off, so dev knows why they don't have any logs\n        if (!self.recordLogs) {\n            self.log('[debugout.js] log recording is off.');\n        }\n        // if using local storage, get values\n        if (self.useLocalStorage) {\n            var saved = window.localStorage.getItem('debugout.js');\n            if (saved) {\n                saved = JSON.parse(saved);\n                self.startTime = new Date(saved.startTime);\n                self.output = saved.log;\n                retrievalTime = new Date(saved.lastLog);\n            }\n        }\n        return self.output\n            + '\\n---- Log retrieved: ' + retrievalTime + ' ----\\n'\n            + self.formatSessionDuration(self.startTime, retrievalTime);\n    }\n    // accepts optional number or uses the default for number of lines\n    this.tail = function (numLines) {\n        var numLines = numLines || self.tailLines;\n        return self.trimLog(self.getLog(), numLines);\n    }\n    // accepts a string to search for\n    this.search = function (string) {\n        var lines = self.output.split('\\n');\n        var rgx = new RegExp(string);\n        var matched = [];\n        // can't use a simple Array.prototype.filter() here\n        // because we need to add the line number\n        for (var i = 0; i < lines.length; i++) {\n            var addr = '[' + i + '] ';\n            if (lines[i].match(rgx)) {\n                matched.push(addr + lines[i]);\n            }\n        }\n        var result = matched.join('\\n');\n        if (result.length == 0) result = 'Nothing found for \"' + string + '\".';\n        return result\n    }\n    // accepts the starting line and how many lines after the starting line you want\n    this.getSlice = function (lineNumber, numLines) {\n        var lines = self.output.split('\\n');\n        var segment = lines.slice(lineNumber, lineNumber + numLines);\n        return segment.join('\\n');\n    }\n    // immediately downloads the log - for desktop browser use\n    this.downloadLog = function () {\n        var file = \"data:text/plain;charset=utf-8,\";\n        var logFile = self.getLog();\n        var encoded = encodeURIComponent(logFile);\n        file += encoded;\n        var a = document.createElement('a');\n        a.href = file;\n        a.target = '_blank';\n        a.download = self.logFilename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    }\n    // clears the log\n    this.clear = function () {\n        var clearTime = new Date();\n        self.output = '---- Log cleared: ' + clearTime + ' ----\\n';\n        if (self.useLocalStorage) {\n            // local storage\n            var saveObject = {\n                startTime: self.startTime,\n                log: self.output,\n                lastLog: clearTime\n            }\n            saveObject = JSON.stringify(saveObject);\n            window.localStorage.setItem('debugout.js', saveObject);\n        }\n        if (self.realTimeLoggingOn) console.log('[debugout.js] clear()');\n    }\n    // records a log\n    this.log = function (obj) {\n        // log in real time\n        if (self.realTimeLoggingOn) console.log(obj);\n        // record log\n        var type = self.determineType(obj);\n        if (type != null && self.recordLogs) {\n            var addition = obj;\n            // timestamp, formatted for brevity\n            if (self.useTimestamps) {\n                var logTime = new Date();\n                self.output += self.formatTimestamp(logTime);\n            }\n            self.output += addition + '\\n';\n            if (self.autoTrim) self.output = self.trimLog(self.output, self.maxLines);\n            // local storage\n            if (self.useLocalStorage) {\n                var last = new Date();\n                var saveObject = {\n                    startTime: self.startTime,\n                    log: self.output,\n                    lastLog: last\n                }\n                saveObject = JSON.stringify(saveObject);\n                window.localStorage.setItem('debugout.js', saveObject);\n            }\n        }\n        self.depth = 0;\n        self.parentSizes = [0];\n        self.currentResult = '';\n    }\n    /*\n        METHODS FOR CONSTRUCTING THE LOG\n    */\n\n    // like typeof but classifies objects of type 'object'\n    // kept separate from formatType() so you can use at your convenience!\n    this.determineType = function (object) {\n        if (object != null) {\n            var typeResult;\n            var type = typeof object;\n            if (type == 'object') {\n                var len = object.length;\n                if (len == null) {\n                    if (typeof object.getTime == 'function') {\n                        typeResult = 'Date';\n                    }\n                    else if (typeof object.test == 'function') {\n                        typeResult = 'RegExp';\n                    }\n                    else {\n                        typeResult = 'Object';\n                    }\n                } else {\n                    typeResult = 'Array';\n                }\n            } else {\n                typeResult = type;\n            }\n            return typeResult;\n        } else {\n            return null;\n        }\n    }\n    // format type accordingly, recursively if necessary\n    this.formatType = function (type, obj) {\n        switch (type) {\n            case 'Object' :\n                self.currentResult += '{\\n';\n                self.depth++;\n                self.parentSizes.push(self.objectSize(obj));\n                var i = 0;\n                for (var prop in obj) {\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    self.currentResult += prop + ': ';\n                    var subtype = self.determineType(obj[prop]);\n                    var subresult = self.formatType(subtype, obj[prop]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    }\n                    i++;\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += self.indentsForDepth(self.depth);\n                self.currentResult += '}';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'Array' :\n                self.currentResult += '[';\n                self.depth++;\n                self.parentSizes.push(obj.length);\n                for (var i = 0; i < obj.length; i++) {\n                    var subtype = self.determineType(obj[i]);\n                    if (subtype == 'Object' || subtype == 'Array') self.currentResult += '\\n' + self.indentsForDepth(self.depth);\n                    var subresult = self.formatType(subtype, obj[i]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype == 'Array') self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype != 'Object') self.currentResult += '\\n';\n                        else if (i == self.parentSizes[self.depth] - 1) self.currentResult += '\\n';\n                    }\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += ']';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'function' :\n                obj += '';\n                var lines = obj.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    if (lines[i].match(/\\}/)) self.depth--;\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    if (lines[i].match(/\\{/)) self.depth++;\n                    self.currentResult += lines[i] + '\\n';\n                }\n                return self.currentResult;\n                break;\n            case 'RegExp' :\n                return '/' + obj.source + '/';\n                break;\n            case 'Date' :\n            case 'string' :\n                if (self.depth > 0 || obj.length == 0) {\n                    return '\"' + obj + '\"';\n                } else {\n                    return obj;\n                }\n            case 'boolean' :\n                if (obj) return 'true';\n                else return 'false';\n            case 'number' :\n                return obj + '';\n                break;\n        }\n    }\n    this.indentsForDepth = function (depth) {\n        var str = '';\n        for (var i = 0; i < depth; i++) {\n            str += '\\t';\n        }\n        return str;\n    }\n    this.trimLog = function (log, maxLines) {\n        var lines = log.split('\\n');\n        if (lines.length > maxLines) {\n            lines = lines.slice(lines.length - maxLines);\n        }\n        return lines.join('\\n');\n    }\n    this.lines = function () {\n        return self.output.split('\\n').length;\n    }\n    // calculate testing time\n    this.formatSessionDuration = function (startTime, endTime) {\n        var msec = endTime - startTime;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        var hrs = ('0' + hh).slice(-2);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        var mins = ('0' + mm).slice(-2);\n        msec -= mm * 1000 * 60;\n        var ss = Math.floor(msec / 1000);\n        var secs = ('0' + ss).slice(-2);\n        msec -= ss * 1000;\n        return '---- Session duration: ' + hrs + ':' + mins + ':' + secs + ' ----'\n    }\n    this.formatTimestamp = function (timestamp) {\n        var year = timestamp.getFullYear();\n        var date = timestamp.getDate();\n        var month = ('0' + (timestamp.getMonth() + 1)).slice(-2);\n        var hrs = Number(timestamp.getHours());\n        var mins = ('0' + timestamp.getMinutes()).slice(-2);\n        var secs = ('0' + timestamp.getSeconds()).slice(-2);\n        return '[' + year + '-' + month + '-' + date + ' ' + hrs + ':' + mins + ':' + secs + ']: ';\n    }\n    this.objectSize = function (obj) {\n        var size = 0, key;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n    }\n\n    /*\n        START/RESUME LOG\n    */\n    if (self.useLocalStorage) {\n        var saved = window.localStorage.getItem('debugout.js');\n        if (saved) {\n            saved = JSON.parse(saved);\n            self.output = saved.log;\n            var start = new Date(saved.startTime);\n            var end = new Date(saved.lastLog);\n            self.output += '\\n---- Session end: ' + saved.lastLog + ' ----\\n';\n            self.output += self.formatSessionDuration(start, end);\n            self.output += '\\n\\n';\n        }\n    }\n    self.output += '---- Session started: ' + self.startTime + ' ----\\n\\n';\n}","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\nimport zhCN from './locale/zh-cn';\nimport {bugout} from \"./log/log_proxy\";\nimport Drag from \"./external/drag\";\n\nclass Spreadsheet {\n    constructor(selectors, options = {}, methods = {}, alias = 'sheet1') {\n        let targetEl = selectors;\n          if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.locale('zh-cn', zhCN);\n        this.data = new DataProxy(alias, options, methods);\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n\n        this.sheet = new Sheet(rootEl, this.data);\n        this.data.sheet = this.sheet;\n    }\n\n    setDataSettings(value) {\n        this.data.settings.showEditor = value;\n    }\n\n    loadData(data) {\n        this.sheet.loadData(data);\n        return this;\n    }\n\n    getData() {\n        return this.data.getData();\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.data.change = cb;\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n\n    locale(lang, message) {\n        locale(lang, message);\n    }\n\n    // getEditorStatus() {\n    //     let {editor} = this.sheet;\n    //     let { ri, ci, pos} = editor;\n    //     let inputText = editor.editorText.getText();\n    //\n    //     return  {\n    //         \"status\": editor.isDisplay(),\n    //         \"inputText\": inputText,\n    //         \"ri\": ri,\n    //         \"ci\": ci,\n    //         \"pos\": pos,\n    //     };\n    // }\n\n    // setEditorText(text = '', pos = 1) {\n    //     let {editor} = this.sheet;\n    //     text = text !== '' ? text : '=';\n    //     editor.inputEventHandler(text, pos, true);\n    // }\n    //\n    // setTextEnd(cell, ri, ci) {\n    //     let {editor, data} = this.sheet;\n    //     editor.setCellEnd({\n    //         text: cell.text,\n    //         formulas: cell.formulas\n    //     });\n    //     data.setCellAll(ri, ci, cell.formulas + \"\", cell.formulas + \"\", '');\n    //\n    //     this.sheet.selectorEditorReset(ri, ci);\n    //\n    //     setTimeout(() => {\n    //         editor.setCursorPos(cell.formulas.length);\n    //     }, 100)\n    // }\n\n    getText(alias, inputText, pos) {\n        let {selectors, data, table} = this.sheet;\n        let text = \"\";\n        for(let i = 0; i < selectors.length; i++) {\n            let {erpx} = selectors[i];\n            text += erpx;\n        }\n\n        return data.getCellByExpr(text, table, alias, inputText, pos);\n    }\n\n    removeEvent() {\n        this.sheet.removeEvent();\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.jsSpreadsheet = require('js-spreadsheet');\n    window.drag = Drag;\n    window.x = window.x || {};\n    window.bugout = bugout;\n    window.x.spreadsheet = spreadsheet;\n    window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\n// export default Spreadsheet;\nexport {\n    spreadsheet,\n};\n","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nclass Range{\n    constructor(str_expression, formula, possition_i){\n        var range_expression, sheet_name, sheet;\n        this.start_pst = possition_i - str_expression.length\n        this.end_pst = possition_i\n\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            range_expression = aux[1];\n            this.range_start_pst = possition_i - aux[1].length\n        }\n        else {\n            sheet_name = formula.sheet_name;\n            range_expression = str_expression;\n            this.range_start_pst = this.start_pst\n\n        }\n        this.sheet = formula.wb.Sheets[sheet_name];\n        this.range_expression = range_expression\n        this.sheet_name = sheet_name\n        this.formula = formula\n\n    }\n    calc(){\n        let sheet_name = this.sheet_name\n        let sheet = this.sheet\n        let range_expression = this.range_expression\n        let formula = this.formula\n        var arr = range_expression.split(':');\n        var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n        var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n        var max_row;\n        if (str_max_row === '' && sheet['!ref']) {\n            str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n        }\n        // the max is 1048576, but TLE\n        max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n        var min_col = col_str_2_int(arr[0]);\n        var max_col = col_str_2_int(arr[1]);\n        var matrix = [];\n        for (var i = min_row; i <= max_row; i++) {\n            var row = [];\n            matrix.push(row);\n            for (var j = min_col; j <= max_col; j++) {\n                var cell_name = int_2_col_str(j) + i;\n                var cell_full_name = sheet_name + '!' + cell_name;\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]);\n                    }\n                    else if (formula.formula_ref[cell_full_name].status === 'working') {\n                        throw new Error('Circular ref');\n                    }\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        return matrix;\n\n    }\n\n}\n\nmodule.exports = Range\n//     function Range(str_expression, formula) { // Range ; calc\n//     var range_expression, sheet_name, sheet;\n//     if (str_expression.indexOf('!') != -1) {\n//         var aux = str_expression.split('!');\n//         sheet_name = getSanitizedSheetName(aux[0]);\n//         range_expression = aux[1];\n//     }\n//     else {\n//         sheet_name = formula.sheet_name;\n//         range_expression = str_expression;\n//     }\n//     sheet = formula.wb.Sheets[sheet_name];\n//     this.range_expression = range_expression\n//     this.sheet_name = sheet_name\n//     console.log(this.range_expression)\n//\n//     this.calc = function() {\n//         var arr = range_expression.split(':');\n//         var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n//         var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n//         var max_row;\n//         if (str_max_row === '' && sheet['!ref']) {\n//             str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n//         }\n//         // the max is 1048576, but TLE\n//         max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n//         var min_col = col_str_2_int(arr[0]);\n//         var max_col = col_str_2_int(arr[1]);\n//         var matrix = [];\n//         for (var i = min_row; i <= max_row; i++) {\n//             var row = [];\n//             matrix.push(row);\n//             for (var j = min_col; j <= max_col; j++) {\n//                 var cell_name = int_2_col_str(j) + i;\n//                 var cell_full_name = sheet_name + '!' + cell_name;\n//                 if (formula.formula_ref[cell_full_name]) {\n//                     if (formula.formula_ref[cell_full_name].status === 'new') {\n//                         formula.exec_formula(formula.formula_ref[cell_full_name]);\n//                     }\n//                     else if (formula.formula_ref[cell_full_name].status === 'working') {\n//                         throw new Error('Circular ref');\n//                     }\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else if (sheet[cell_name]) {\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else {\n//                     row.push(null);\n//                 }\n//             }\n//         }\n//         return matrix;\n//     };\n// };\n","var utils = require('./utils');\nvar error = require('./error');\nvar numeral = require('numeral');\n\n//TODO\nexports.ASC = function(str) {\n  var tmp = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 65248 && str.charCodeAt(i) < 65375) {\n      tmp += String.fromCharCode(str.charCodeAt(i) - 65248);\n    }\n    else {\n      tmp += String.fromCharCode(str.charCodeAt(i));\n    }\n  }\n  return tmp\n};\n\n//TODO\nexports.BAHTTEXT = function() {\n throw new Error('BAHTTEXT is not implemented');\n};\n\nexports.CHAR = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return String.fromCharCode(number);\n};\n\nexports.CLEAN = function(text) {\n  text = text || '';\n  var re = /[\\0-\\x1F]/g;\n  return text.replace(re, \"\");\n};\n\nexports.CODE = function(text) {\n  text = text || '';\n  return text.charCodeAt(0);\n};\n\nexports.CONCATENATE = function() {\n  var args = utils.flatten(arguments);\n\n  var trueFound = 0;\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE';\n  }\n\n  var falseFound = 0;\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE';\n  }\n\n  return args.join('');\n};\n\n//TODO\nexports.DBCS = function() {\n throw new Error('DBCS is not implemented');\n};\n\nexports.DOLLAR = function(number, decimals) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n  var format = '';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n    format = '($0,0)';\n  } else if (decimals > 0) {\n    format = '($0,0.' + new Array(decimals + 1).join('0') + ')';\n  }\n  return numeral(number).format(format);\n};\n\nexports.EXACT = function(text1, text2) {\n  return text1 === text2;\n};\n\nexports.FIND = function (find_text, within_text, position) {\n  position = (position === undefined) ? 0 : position;\n  within_text.indexOf(find_text)\n  return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n};\nexports.FIXED = function(number, decimals, no_commas) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n  no_commas = (no_commas === undefined) ? false : no_commas;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n\n  var format = no_commas ? '0' : '0,0';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n  } else if (decimals > 0) {\n    format += '.' + new Array(decimals + 1).join('0');\n  }\n  return numeral(number).format(format);\n};\n\nexports.HTML2TEXT = function (value) {\n  var result = '';\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach(function (line) {\n        if (result !== '') {\n          result += '\\n';\n        }\n        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\n      });\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '');\n    }\n  }\n\n  return result;\n};\nexports.INDEX = function (matrix, row_num, column_num) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n  return matrix[row_num][column_num-1]\n};\nexports.LEFT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.substring(0, number) : null;\n};\n\nexports.LEN = function(text) {\n  if (arguments.length === 0) {\n    return error.error;\n  }\n\n  if (typeof text === 'string') {\n    return text ? text.length : 0;\n  }\n\n  if (text.length) {\n    return text.length;\n  }\n\n  return error.value;\n};\n\nexports.LOWER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.toLowerCase() : text;\n};\n\nexports.MID = function(text, start, number) {\n  start = utils.parseNumber(start);\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number;\n  }\n\n  var begin = start - 1;\n  var end = begin + number;\n\n  return text.substring(begin, end);\n};\n\n// TODO\nexports.NUMBERVALUE = function (text, decimal_separator, group_separator) {\n  decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;\n  group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;\n  if (text.indexOf('%') > 0){\n    text = text.replace('%', '')\n    return parseFloat(text)/100\n  }\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));\n};\n\n// TODO\nexports.PRONETIC = function() {\n throw new Error('PRONETIC is not implemented');\n};\n\nexports.PROPER = function(text) {\n  if (text === undefined || text.length === 0) {\n    return error.value;\n  }\n  if (text === true) {\n    text = 'TRUE';\n  }\n  if (text === false) {\n    text = 'FALSE';\n  }\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value;\n  }\n  if (typeof text === 'number') {\n    text = '' + text;\n  }\n\n  return text.replace(/\\w\\S*/g, function(txt) {\n    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n  });\n};\n\nexports.REGEXEXTRACT = function (text, regular_expression) {\n  var match = text.match(new RegExp(regular_expression));\n  return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\n};\n\nexports.REGEXMATCH = function (text, regular_expression, full) {\n  var match = text.match(new RegExp(regular_expression));\n  return full ? match : !!match;\n};\n\nexports.REGEXREPLACE = function (text, regular_expression, replacement) {\n  return text.replace(new RegExp(regular_expression), replacement);\n};\n\nexports.REPLACE = function(text, position, length, new_text) {\n  position = utils.parseNumber(position);\n  length = utils.parseNumber(length);\n  if (utils.anyIsError(position, length) ||\n    typeof text !== 'string' ||\n    typeof new_text !== 'string') {\n    return error.value;\n  }\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n};\n\nexports.REPT = function(text, number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return new Array(number + 1).join(text);\n};\n\nexports.RIGHT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return text ? text.substring(text.length - number) : null;\n};\n\nexports.SEARCH = function(find_text, within_text, position) {\n  var foundAt;\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value;\n  }\n  position = (position === undefined) ? 0 : position;\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\n  return (foundAt === 0)?error.value:foundAt;\n};\n\nexports.SPLIT = function (text, separator) {\n  return text.split(separator);\n};\n\nexports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\n  if (!text || !old_text || !new_text) {\n    return text;\n  } else if (occurrence === undefined) {\n    return text.replace(new RegExp(old_text, 'g'), new_text);\n  } else {\n    var index = 0;\n    var i = 0;\n    while (text.indexOf(old_text, index) > 0) {\n      index = text.indexOf(old_text, index + 1);\n      i++;\n      if (i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n      }\n    }\n  }\n};\n\nexports.T = function(value) {\n  if (value == 'TRUE' || value == 'FALSE'){\n    return ''\n  }\n  return (typeof value === \"string\") ? value : '';\n};\n\n// TODO incomplete implementation\nfunction num2e(num){\n  var p = Math.floor(Math.log(num)/Math.LN10);\n  var n = num * Math.pow(10, -p);\n  if (p.toString().length < 10){\n    p = '0' + p\n  }\n  return n + 'E+' + p;\n}\nfunction allzero(num){\n  num = num.toString()\n  for (var i=0;i<num.length;i++){\n    if (num[i] != '0'){\n      return false\n    }\n  }\n  return true\n}\nfunction decimalsToFractional(decimals){\n  formatDecimals = decimals.toFixed(2);\n  var denominator = 3;//\n  var numerator  = formatDecimals*3;//\n  var bigger = 0;\n  function  recursion (){\n    bigger = denominator>numerator?denominator:numerator;\n    for(let i=bigger;i>1;i--){\n      if(Number.isInteger(numerator/i)&&Number.isInteger(denominator/i)){\n        numerator=numerator/i;\n        denominator=denominator/i;\n        recursion();\n      }\n    }\n  }\n  recursion();\n  numerator = parseInt(numerator)\n  return `${numerator}/${denominator}`\n}\nexports.TEXT = function (value, format) {\n  try{\n    if (format.indexOf('%') >= 0){\n      var fixed = format.split('.')[1].length-1\n      return (parseFloat(value) *100).toFixed(fixed) + '%'\n    }\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    var result = Formulas.TEXT(value, format);\n    console.log(result)\n  }catch (e) {\n    var result = undefined\n  }\n  if (result == undefined){\n    if (format.indexOf('#') >= 0 && format.indexOf('?/?') >=0){\n      var x = parseFloat(value) - parseInt(value);\n      if (parseInt(value) != 0){\n        return parseInt(value) + ' ' + decimalsToFractional(x)\n      }\n      return decimalsToFractional(x)\n    }\n    if (format.indexOf('E+') >=0){\n      return num2e(value)\n    }else if(allzero(value)){\n      var result = ''\n      for (var i=0;i<format.length-value.length; i++){\n        result += '0'\n      }\n      return result + value\n    }else if (format.indexOf('#') >=0){\n      var fmt = format\n      if (format.indexOf('[')>=0 && format.indexOf(';')>=0){\n        var valid = format.split('#')[0]\n        fmt = format.split(']')[1].split(';')\n        valid = valid.replace('[', '').replace(']', '')\n        if (eval(value + valid)){\n          fmt = fmt[0]\n        }else {\n          fmt = fmt[1]\n        }\n      }\n      if (format.indexOf('#') >=0 && format.indexOf('.' >=0) && format.indexOf('0') >=0 && format.indexOf('') <=0){\n        if (value.toString().split('.')[1].length > format.split('.')[1].length){\n          value = value.toFixed(format.split('.')[1].length)\n        }\n        value = value.toString()\n        var result = ''\n        var n = 0\n        for (var i=0; i< fmt.length; i ++){\n          if (fmt[i] == '#' || fmt[i] == '0' || fmt[i] == '.'){\n            result += value[n]\n            n += 1\n          }else{\n            result += fmt[i]\n          }\n        }\n        return result\n      }\n      fmt = fmt.replace('##0', '##')\n      value = value.toString()\n      var result = ''\n      var n = 0\n      for (var i=0; i< fmt.length; i ++){\n        if (fmt[i] == '#' || fmt[i] == '0'){\n          result += value[n]\n          n += 1\n        }else{\n          result += fmt[i]\n        }\n      }\n      return result\n    }\n  }\n  return result\n};\n\nexports.TRIM = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.replace(/ +/g, ' ').trim();\n};\n\nexports.UNICHAR = function (text) {\n  if (text == 0){\n    return error.value\n  }\n  return String.fromCharCode(text);\n};\n\nexports.UNICODE = function (text){\n  return text.charCodeAt(0)\n}\n\nexports.UPPER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.toUpperCase();\n};\n\nexports.VALUE = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return numeral().unformat(text);\n};\n","var error = require('./error');\n\n// TODO\nexports.CELL = function() {\n throw new Error('CELL is not implemented');\n};\n\nexports.ERROR = {};\nexports.ERROR.TYPE = function (error_val) {\n  switch (error_val) {\n    case error.nil.message:\n      return 1;\n    case error.div0.message:\n      return 2;\n    case error.value.message:\n      return 3;\n    case error.ref.message:\n      return 4;\n    case error.name.message:\n      return 5;\n    case error.num.message:\n      return 6;\n    case error.na.message:\n      return 7;\n    case error.data.message:\n      return 8;\n  }\n  return error.na;\n};\n\n// TODO\nexports.INFO = function() {\n throw new Error('INFO is not implemented');\n};\n\nexports.ISBLANK = function(value) {\n  return value === null;\n};\n\nexports.ISBINARY = function (number) {\n  return (/^[01]{1,10}$/).test(number);\n};\n\nexports.ISERR = function(value) {\n  return ([error.value.message, error.ref.message, error.div0.message, error.num.message, error.name.message, error.nil.message]).indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\n};\n\nexports.ISERROR = function(value) {\n  return exports.ISERR(value) || value === error.na;\n};\n\nexports.ISEVEN = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? false : true;\n};\n\n// TODO\nexports.ISFORMULA = function() {\n  throw new Error('ISFORMULA is not implemented');\n};\n\nexports.ISLOGICAL = function(value) {\n  if(value == 'FALSE'){\n    return false\n  }\n  return value == true || value == false;\n};\n\nexports.ISNA = function(value) {\n  return value === error.na || value === error.na.message;;\n};\n\nexports.ISNONTEXT = function(value) {\n  return typeof(value) !== 'string';\n};\n\nexports.ISNUMBER = function(value) {\n  return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\n};\n\nexports.ISODD = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? true : false;\n};\n\n// TODO\nexports.ISREF = function() {\n  return arguments['0'] != null\n};\n\nexports.ISTEXT = function(value) {\n  return typeof(value) === 'string';\n};\n\nexports.N = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return value;\n  }\n  if (value instanceof Date) {\n    return value.getTime();\n  }\n  if (value === true || value.toString().toUpperCase() == 'TRUE' || value.toString().toUpperCase() == 'FALSE') {\n    return 1;\n  }\n  if (value === false || typeof(value)=='string') {\n    return 0;\n  }\n  if (ISERROR(value)) {\n    return value;\n  }\n  return 0;\n};\n\nexports.NA = function() {\n  return error.na;\n};\n\n\n// TODO\nexports.SHEET = function() {\n  throw new Error('SHEET is not implemented');\n};\n\n// TODO\nexports.SHEETS = function() {\n  throw new Error('SHEETS is not implemented');\n};\n\nexports.TYPE = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return 1;\n  }\n  // if (typeof(value) !== 'string' && isNaN(value)){\n  //   return error.value\n  // }\n  if (typeof(value) === 'string') {\n    if (value.slice(0,1) == '{'){\n      var arr = utils.strToMatrix(value)\n      if (Array.isArray(arr)) {\n        return 64;\n      }\n    }else{\n      return 2\n    }\n  }\n  if(value == 'FALSE'){\n    return false\n  }\n  if (value == true || value == false) {\n    return 4;\n  }\n  if (exports.ISERR(value) || value === error.na) {\n    return 16;\n  }\n  if (Array.isArray(arr)) {\n    return 64;\n  }\n\n};\n","var error = require('./error');\nvar utils = require('./utils');\n\nvar d1900 = new Date(1900, 0, 1);\nvar WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n];\nvar WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n];\nvar WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined, [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n];\n\nexports.DATE = function(year, month, day) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.DATE(year, month, day)\n  // year = utils.parseNumber(year);\n  // month = utils.parseNumber(month);\n  // day = utils.parseNumber(day);\n  // if (utils.anyIsError(year, month, day)) {\n  //   return error.value;\n  // }\n  // if (year < 0 || month < 0 || day < 0) {\n  //   return error.num;\n  // }\n  // var date = new Date(year, month - 1, day);\n  // return date;\n};\n\nexports.DATEVALUE = function(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value;\n  }\n  var date = Date.parse(date_text);\n  if (isNaN(date)) {\n    return error.value;\n  }\n  if (date <= -2203891200000) {\n    return (date - d1900) / 86400000 + 1;\n  }\n  return (date - d1900) / 86400000 + 2;\n};\n\nexports.DAY = function(serial_number) {\n  var date = utils.parseDate(serial_number);\n  if (date instanceof Error) {\n    return date;\n  }\n  return date.getDate();\n};\n\nexports.DAYS = function(end_date, start_date) {\n  end_date = utils.parseDate(end_date);\n  start_date = utils.parseDate(start_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  return serial(end_date) - serial(start_date);\n};\n\nexports.DAYS360 = function(start_date, end_date, method) {\n  method = utils.parseBool(method);\n  start_date = utils.parseDate(start_date);\n  end_date = utils.parseDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (method instanceof Error) {\n    return method;\n  }\n  var sm = start_date.getMonth();\n  var em = end_date.getMonth();\n  var sd, ed;\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();\n  } else {\n    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();\n    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate();\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++;\n        ed = 1;\n      } else {\n        ed = 30;\n      }\n    } else {\n      ed = end_date.getDate();\n    }\n  }\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) +\n    30 * (em - sm) + (ed - sd);\n};\n\nexports.EDATE = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  start_date.setMonth(start_date.getMonth() + months);\n  return serial(start_date);\n};\n\nexports.EOMONTH = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n};\n\nexports.HOUR = function(serial_number) {\n  if (typeof serial_number === 'number' && !isNaN(serial_number)){\n    //XW: \n    return parseInt((parseFloat(serial_number)-parseInt(serial_number)) * 24)\n    //XW: end\n  }\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getHours();\n};\n\nexports.INTERVAL = function (second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value;\n  } else {\n    second = parseInt(second, 10);\n  }\n\n  var year  = Math.floor(second/946080000);\n  second    = second%946080000;\n  var month = Math.floor(second/2592000);\n  second    = second%2592000;\n  var day   = Math.floor(second/86400);\n  second    = second%86400;\n\n  var hour  = Math.floor(second/3600);\n  second    = second%3600;\n  var min   = Math.floor(second/60);\n  second    = second%60;\n  var sec   = second;\n\n  year  = (year  > 0) ? year  + 'Y' : '';\n  month = (month > 0) ? month + 'M' : '';\n  day   = (day   > 0) ? day   + 'D' : '';\n  hour  = (hour  > 0) ? hour  + 'H' : '';\n  min   = (min   > 0) ? min   + 'M' : '';\n  sec   = (sec   > 0) ? sec   + 'S' : '';\n\n  return 'P' + year + month + day +\n  'T' + hour + min + sec;\n};\n\nexports.ISOWEEKNUM = function(date) {\n  date = utils.parseDate(date);\n  if (date instanceof Error) {\n    return date;\n  }\n\n  date.setHours(0, 0, 0);\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n  var yearStart = new Date(date.getFullYear(), 0, 1);\n  return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\n};\n\nexports.MINUTE = function(serial_number) {\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.MINUTE(serial_number);\n};\n\nexports.MONTH = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getMonth() + 1;\n};\n\nexports.NETWORKDAYS = function (start_date, end_date, holidays) {\n  if (holidays instanceof Array){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.NETWORKDAYS(start_date, end_date, holidays);\n};\nexports.NETWORKDAYSINTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays)[0])\n  }\n  try{\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.NETWORKDAYS$INTL(start_date, end_date, weekend, holidays);\n  }catch (e) {\n    start_date = utils.ExcelDateToJSDate(utils.parseDate(start_date));\n    end_date = utils.ExcelDateToJSDate(utils.parseDate(end_date));\n    if (start_date instanceof Error) {\n      return start_date;\n    }\n    if (end_date instanceof Error) {\n      return end_date;\n    }\n    if (weekend === undefined) {\n      weekend = WEEKEND_TYPES[1];\n    } else if (typeof weekend=='string' && weekend.length === 7) {\n      var arr = []\n      for (var i=0;i<weekend.length;i++){\n        if (weekend[i] == '1'){\n          arr.push(((i+1)>6)? 0: i+1)\n        }\n      }\n      weekend = arr\n    }else {\n      weekend = WEEKEND_TYPES[weekend];\n    }\n    if (!(weekend instanceof Array)) {\n      return error.value;\n    }\n    if (holidays === undefined) {\n      holidays = [];\n    } else if (!(holidays instanceof Array)) {\n      holidays = [holidays];\n    }\n    for (var i = 0; i < holidays.length; i++) {\n      var h = utils.parseDate(holidays[i]);\n      if (h instanceof Error) {\n        return h;\n      }\n      holidays[i] = h;\n    }\n    var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n    var total = days;\n    var day = start_date;\n    for (i = 0; i < days; i++) {\n      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n      var dec = false;\n      if (d === weekend[0] || d === weekend[1]) {\n        dec = true;\n      }\n      for (var j = 0; j < holidays.length; j++) {\n        var holiday = holidays[j];\n        if (holiday.getDate() === day.getDate() &&\n          holiday.getMonth() === day.getMonth() &&\n          holiday.getFullYear() === day.getFullYear()) {\n          dec = true;\n          break;\n        }\n      }\n      if (dec) {\n        total--;\n      }\n      day.setDate(day.getDate() + 1);\n    }\n    return total;\n  }\n};\n\n\nexports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays))\n  }\n  start_date = utils.ExcelDateToJSDate(start_date);\n  end_date = utils.ExcelDateToJSDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n  var total = days;\n  var day = start_date;\n  for (i = 0; i < days; i++) {\n    var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n    var dec = false;\n    if (d === weekend[0] || d === weekend[1]) {\n      dec = true;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()) {\n        dec = true;\n        break;\n      }\n    }\n    if (dec) {\n      total--;\n    }\n    day.setDate(day.getDate() + 1);\n  }\n  return total;\n};\n\nexports.NOW = function() {\n  return new Date();\n};\n\nexports.SECOND = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getSeconds();\n};\n\nexports.TIME = function(hour, minute, second) {\n  hour = utils.parseNumber(hour);\n  minute = utils.parseNumber(minute);\n  second = utils.parseNumber(second);\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value;\n  }\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num;\n  }\n  return (3600 * hour + 60 * minute + second) / 86400;\n};\n\nexports.TIMEVALUE = function(time_text) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  try{\n    return Formulas.TIMEVALUE(time_text);\n  }catch(e){\n    return error.value\n  }\n};\n\nexports.TODAY = function() {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.TODAY()\n};\n\nexports.WEEKDAY = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  var day = serial_number.getDay();\n  return WEEK_TYPES[return_type][day];\n};\n\nexports.WEEKNUM = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  if (return_type === 21) {\n    return this.ISOWEEKNUM(serial_number);\n  }\n  var week_start = WEEK_STARTS[return_type];\n  var jan = new Date(serial_number.getFullYear(), 0, 1);\n  var inc = jan.getDay() < week_start ? 1 : 0;\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;\n  return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;\n};\n\nexports.WORKDAY = function (start_date, days, holidays) {\n  if (holidays != undefined){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.WORKDAY(start_date, days, holidays);\n};\nexports.WORKDAYINTL = function (start_date, days, weekend, holidays) {\n  // var Formulas = window.jsSpreadsheet.AllFormulas;\n  // return Formulas.WORKDAY$INTL(start_date, days, weekend, holidays);\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (weekend == 0){\n    return error.num\n  }\n  days = utils.parseNumber(days);\n  if (days instanceof Error) {\n    return days;\n  }\n  if (days < 0) {\n    return error.num;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var d = 0;\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1);\n    var day = start_date.getDay();\n    if (day === weekend[0] || day === weekend[1]) {\n      continue;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()) {\n        d--;\n        break;\n      }\n    }\n    d++;\n  }\n  var year = start_date.getFullYear();\n  var month = start_date.getMonth();\n  var day = start_date.getDay();\n  return year+ '/' + month + '/' + day;\n};\n\nexports.YEAR = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getFullYear();\n};\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1;\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);\n}\n\nexports.YEARFRAC = function(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  end_date = utils.parseDate(end_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n\n  basis = basis || 0;\n  var sd = start_date.getDate();\n  var sm = start_date.getMonth() + 1;\n  var sy = start_date.getFullYear();\n  var ed = end_date.getDate();\n  var em = end_date.getMonth() + 1;\n  var ey = end_date.getFullYear();\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30;\n        ed = 30;\n      } else if (sd === 31) {\n        sd = 30;\n      } else if (sd === 30 && ed === 31) {\n        ed = 30;\n      }\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n    case 1:\n      // Actual/actual\n      var feb29Between = function(date1, date2) {\n        var year1 = date1.getFullYear();\n        var mar1year1 = new Date(year1, 2, 1);\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true;\n        }\n        var year2 = date2.getFullYear();\n        var mar1year2 = new Date(year2, 2, 1);\n        return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);\n      };\n      var ylength = 365;\n      if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) ||\n            feb29Between(start_date, end_date) ||\n            (em === 1 && ed === 29)) {\n          ylength = 366;\n        }\n        return daysBetween(start_date, end_date) / ylength;\n      }\n      var years = (ey - sy) + 1;\n      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;\n      var average = days / years;\n      return daysBetween(start_date, end_date) / average;\n    case 2:\n      // Actual/360\n      return daysBetween(start_date, end_date) / 360;\n    case 3:\n      // Actual/365\n      return daysBetween(start_date, end_date) / 365;\n    case 4:\n      // European 30/360\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n  }\n};\n\nfunction serial(date) {\n  var addOn = (date > -2203891200000)?2:1;\n  return (date - d1900) / 86400000 + addOn;\n}","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","const RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\n\nmodule.exports = function str_2_val(buffer, formula, position_i) { // buffer \n    var v;\n    if (!isNaN(buffer)) {\n        v = new RawValue(+buffer);\n    }\n    else if (buffer === 'TRUE') {\n        v = new RawValue(1);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // \n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // \n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n    }\n    else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n        v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n    }\n    else {\n        v = buffer;\n        v.end_pst = position_i // \n    }\n    return v;\n};\n","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        var resolved_ref = self.parseRef();\n        var sheet = resolved_ref.sheet;\n        var cell_name = resolved_ref.cell_name;\n        var cell_full_name = resolved_ref.cell_full_name;\n        var ref_cell = sheet[cell_name];\n        if (!ref_cell) {\n            return null;\n        }\n        var formula_ref = formula.formula_ref[cell_full_name];\n        if (formula_ref) {\n            if (formula_ref.status === 'new') {\n                formula.exec_formula(formula_ref);\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error with new formula', cell_full_name);\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n            else if (formula_ref.status === 'working') {\n                throw new Error('Circular ref');\n            }\n            else if (formula_ref.status === 'done') {\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error after formula eval');\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n        }\n        else {\n            if (ref_cell.t === 'e') {\n                console.log('ref is an error with no formula', cell_name);\n                throw new Error(ref_cell.w);\n            }\n            return ref_cell.v;\n        }\n    };\n};\n","var categories = [\n  require('./lib/compatibility'),\n  require('./lib/database'),\n  require('./lib/engineering'),\n  require('./lib/logical'),\n  require('./lib/math-trig'),\n  require('./lib/text'),\n  require('./lib/date-time'),\n  require('./lib/financial'),\n  require('./lib/information'),\n  require('./lib/lookup-reference'),\n  require('./lib/statistical'),\n  require('./lib/miscellaneous'),\n  require('./lib/custom')\n];\n\nfor (var c in categories) {\n  var category = categories[c];\n  for (var f in category) {\n    exports[f] = exports[f] || category[f];\n  }\n}\n","var utils   = require('./utils');\nvar numeral = require('numeral');\n\nexports.UNIQUE = function () {\n  var result = [];\n  for (var i = 0; i < arguments.length; ++i) {\n    var hasElement = false;\n    var element    = arguments[i];\n\n    // Check if we've already seen this element.\n    for (var j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element;\n      if (hasElement) { break; }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\nexports.FLATTEN = utils.flatten;\n\nexports.ARGS2ARRAY = function () {\n  return Array.prototype.slice.call(arguments, 0);\n};\n\nexports.REFERENCE = function (context, reference) {\n  try {\n    var path = reference.split('.');\n    var result = context;\n    for (var i = 0; i < path.length; ++i) {\n      var step = path[i];\n      if (step[step.length - 1] === ']') {\n        var opening = step.indexOf('[');\n        var index = step.substring(opening + 1, step.length - 1);\n        result = result[step.substring(0, opening)][index];\n      } else {\n        result = result[step];\n      }\n    }\n    return result;\n  } catch (error) {}\n};\n\nexports.JOIN = function (array, separator) {\n  return array.join(separator);\n};\n\nexports.NUMBERS = function () {\n  var possibleNumbers = utils.flatten(arguments);\n  return possibleNumbers.filter(function (el) {\n    return typeof el === 'number';\n  });\n};\n\nexports.NUMERAL = function (number, format) {\n  return numeral(number).format(format);\n};","var error = require('./error');\nvar jStat = require('jStat').jStat;\nvar text = require('./text');\nvar utils = require('./utils');\nvar bessel = require('bessel');\n\nfunction isValidBinaryNumber(number) {\n  return (/^[01]{1,10}$/).test(number);\n}\n\nexports.BESSELI = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besseli(x, n);\n};\n\nexports.BESSELJ = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselj(x, n);\n};\n\nexports.BESSELK = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselk(x, n);\n};\n\nexports.BESSELY = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.bessely(x, n);\n};\n\nexports.BIN2DEC = function(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Convert binary number to decimal\n  var result = parseInt(number, 2);\n\n  // Handle negative numbers\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512;\n  } else {\n    return result;\n  }\n};\n\n\nexports.BIN2HEX = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n  }\n\n  // Convert binary number to hexadecimal\n  var result = parseInt(number, 2).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BIN2OCT = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n  }\n\n  // Convert binary number to octal\n  var result = parseInt(number, 2).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BITAND = function(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2;\n};\n\nexports.BITLSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return (shift >= 0) ? number << shift : number >> -shift;\n};\n\nexports.BITOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2;\n};\n\nexports.BITRSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return (shift >= 0) ? number >> shift : number << -shift;\n};\n\nexports.BITXOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2;\n};\n\nexports.COMPLEX = function(real, imaginary, suffix) {\n  real = utils.parseNumber(real);\n  imaginary = utils.parseNumber(imaginary);\n  //XW: \n  if (utils.anyIsError(real, imaginary)) {\n    return error.value;\n  }\n  //XWend\n\n  // Set suffix\n  suffix = (suffix === undefined) ? 'i' : suffix;\n  suffix = suffix.toLowerCase();\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value;\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0;\n  } else if (real === 0) {\n    return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\n  } else if (imaginary === 0) {\n    return real.toString();\n  } else {\n    var sign = (imaginary > 0) ? '+' : '';\n    return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\n  }\n};\n\nexports.CONVERT = function(number, from_unit, to_unit) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  var units = [\n    [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\n    [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\n    [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\n    [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\n    [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\n    [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\n    [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\n    [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\n    [\"are\", \"ar\", null, \"area\", false, true, 100],\n    [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\n    [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\n    [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\n    [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\n    [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\n    [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\n    [\"byte\", \"byte\", null, \"information\", false, true, 8],\n    [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\n    [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\n    [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\n    [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\n    [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\n    [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\n    [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\n    [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\n    [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\n    [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\n    [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\n    [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\n    [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\n    [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\n    [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\n    [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\n    [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\n    [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\n    [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\n    [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\n    [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\n    [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\n    [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\n    [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\n    [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\n    [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\n    [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\n    [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\n    [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\n    [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\n    [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\n    [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\n    [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\n    [\"henry\", \"H\", null, \"inductance\", true, false, 1],\n    [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\n    [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\n    [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\n    [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\n    [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\n    [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\n    [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\n    [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\n    [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\n    [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\n    [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\n    [\"joule\", \"J\", null, \"energy\", true, true, 1],\n    [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\n    [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\n    [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\n    [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\n    [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\n    [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\n    [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\n    [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\n    [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\n    [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\n    [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\n    [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\n    [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\n    [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\n    [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\n    [\"metre\", \"m\", null, \"length\", true, true, 1],\n    [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\n    [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\n    [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\n    [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\n    [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\n    [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\n    [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\n    [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\n    [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\n    [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1],\n    [\"newton\", \"N\", null, \"force\", true, true, 1],\n    [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\n    [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\n    [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\n    [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\n    [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\n    [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\n    [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\n    [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\n    [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\n    [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\n    [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\n    [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\n    [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\n    [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\n    [\"radian\", \"rad\", null, \"angle\", true, false, 1],\n    [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\n    [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\n    [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\n    [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\n    [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\n    [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\n    [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\n    [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\n    [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\n    [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\n    [\"square meter\", \"m?\", null, \"area\", true, true, 1],\n    [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\n    [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\n    [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\n    [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\n    [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\n    [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\n    [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\n    [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\n    [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\n    [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\n    [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\n    [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\n    [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\n    [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\n    [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\n    [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\n    [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\n    [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\n    [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\n    [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\n    [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\n    [\"volt\", \"V\", null, \"voltage\", true, false, 1],\n    [\"watt\", \"W\", null, \"power\", true, true, 1],\n    [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\n    [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\n    [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\n    [\"year\", \"yr\", null, \"time\", false, true, 31557600]\n  ];\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  var binary_prefixes = {\n    Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n    Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n    Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n    Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n    Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n    Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n    Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n    ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n  };\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  var unit_prefixes = {\n    Y: [\"yotta\", 1e+24, \"Y\"],\n    Z: [\"zetta\", 1e+21, \"Z\"],\n    E: [\"exa\", 1e+18, \"E\"],\n    P: [\"peta\", 1e+15, \"P\"],\n    T: [\"tera\", 1e+12, \"T\"],\n    G: [\"giga\", 1e+09, \"G\"],\n    M: [\"mega\", 1e+06, \"M\"],\n    k: [\"kilo\", 1e+03, \"k\"],\n    h: [\"hecto\", 1e+02, \"h\"],\n    e: [\"dekao\", 1e+01, \"e\"],\n    d: [\"deci\", 1e-01, \"d\"],\n    c: [\"centi\", 1e-02, \"c\"],\n    m: [\"milli\", 1e-03, \"m\"],\n    u: [\"micro\", 1e-06, \"u\"],\n    n: [\"nano\", 1e-09, \"n\"],\n    p: [\"pico\", 1e-12, \"p\"],\n    f: [\"femto\", 1e-15, \"f\"],\n    a: [\"atto\", 1e-18, \"a\"],\n    z: [\"zepto\", 1e-21, \"z\"],\n    y: [\"yocto\", 1e-24, \"y\"]\n  };\n\n  // Initialize units and multipliers\n  var from = null;\n  var to = null;\n  var base_from_unit = from_unit.toLowerCase();\n  var base_to_unit = to_unit.toLowerCase();\n  var from_multiplier = 1;\n  var to_multiplier = 1;\n  var alt;\n  // Lookup from and to units\n  for (var i = 0; i < units.length; i++) {\n    alt = (units[i][2] === null) ? [] : units[i][2];\n    if (units[i][1].toLowerCase() === base_from_unit || alt.indexOf(from_unit) >= 0) {\n      from = units[i];\n    }\n    if (units[i][1].toLowerCase() === base_to_unit || alt.indexOf(to_unit) >= 0) {\n      to = units[i];\n    }\n  }\n  // Lookup from prefix\n  if (from === null) {\n    var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n    var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2];\n      base_from_unit = from_unit.substring(2);\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1];\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n    }\n\n    // Lookup from unit\n    for (var j = 0; j < units.length; j++) {\n      alt = (units[j][2] === null) ? [] : units[j][2];\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j];\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n    var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2];\n      base_to_unit = to_unit.substring(2);\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1];\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n    }\n\n    // Lookup to unit\n    for (var k = 0; k < units.length; k++) {\n      alt = (units[k][2] === null) ? [] : units[k][2];\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k];\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na;\n  }\n\n  //Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    if(from_unit == 'F' && to_unit == 'C'){\n      return (number-32)/1.8\n    }\n    if(from_unit == 'C' && to_unit == 'F'){\n      return number * 1.8 + 32\n    }\n    return error.na;\n  }\n\n  // Return converted number\n  return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n};\n\nexports.DEC2BIN = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = parseInt(number, 10).toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2HEX = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = parseInt(number, 10).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2OCT = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = parseInt(number, 10).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DELTA = function(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = (number2 === undefined) ? 0 : number2;\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return delta\n  return (number1 === number2) ? 1 : 0;\n};\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexports.ERF = function(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = (upper_bound === undefined) ? 0 : upper_bound;\n\n  lower_bound = utils.parseNumber(lower_bound);\n  upper_bound = utils.parseNumber(upper_bound);\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value;\n  }\n\n  return jStat.erf(lower_bound);\n};\n\n// TODO\nexports.ERF.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERF(x)\n};\n\nexports.ERFC = function(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value;\n  }\n\n  return jStat.erfc(x);\n};\n\n// TODO\nexports.ERFC.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERFC(x)\n};\n\nexports.GESTEP = function(number, step) {\n  step = step || 0;\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(step, number)) {\n    return number;\n  }\n\n  // Return delta\n  return (number >= step) ? 1 : 0;\n};\n\nexports.HEX2BIN = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\n\n  // Convert hexadecimal number to decimal\n  var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.HEX2DEC = function(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return decimal number\n  return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\n};\n\nexports.HEX2OCT = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = decimal.toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\nexports.ROWS = function (matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\nfunction trans_num(inumber){\n  inumber = inumber.toString()\n  inumber = inumber.replace('I', 'i').replace('J', 'j')\n  return inumber\n}\nexports.IMABS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n};\n\nexports.IMAGINARY = function (inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1;\n  }\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(plus + 1, inumber.length - 1));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        -Number(inumber.substring(minus + 1, inumber.length - 1));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\n    } else {\n      return (isNaN(inumber)) ? error.num : 0;\n    }\n  }\n};\n\nexports.IMARGUMENT = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0;\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2;\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI;\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x);\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI;\n  } else {\n    return Math.atan(y / x) - Math.PI;\n  }\n};\n\nexports.IMCONJUGATE = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return conjugate of complex number\n  return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\n};\n\nexports.IMCOS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return cosine of complex number\n  return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMCOSH = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic cosine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n};\n\nexports.IMCOT = function (inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return cotangent of complex number\n  return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n};\n\nexports.IMDIV = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num;\n  }\n\n  // Return exponential of complex number\n  var den = c * c + d * d;\n  return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n};\n\nexports.IMEXP = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  var e = Math.exp(x);\n  return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n};\n\nexports.IMLN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n};\n\nexports.IMLOG10 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n};\n\nexports.IMLOG2 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n};\n\nexports.IMPOWER = function(inumber, number) {\n  inumber = trans_num(inumber)\n  number = utils.parseNumber(number);\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n  if (utils.anyIsError(number, x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var p = Math.pow(exports.IMABS(inumber), number);\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n};\n\nexports.IMPRODUCT = function() {\n  // Initialize result\n  var result = arguments[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(arguments[i]);\n    var d = exports.IMAGINARY(arguments[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n  }\n\n  // Return product of complex numbers\n  return result;\n};\n\nexports.IMREAL = function(inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0;\n  }\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, plus));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, minus));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\n    } else {\n      return (isNaN(inumber)) ? error.num : inumber;\n    }\n  }\n};\n\nexports.IMSEC = function(inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return secant of complex number\n  return exports.IMDIV('1', exports.IMCOS(inumber));\n};\n\nexports.IMSECH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return hyperbolic secant of complex number\n  return exports.IMDIV('1', exports.IMCOSH(inumber));\n};\n\nexports.IMSIN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return sine of complex number\n  return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMSINH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic sine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n};\n\nexports.IMSQRT = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var s = Math.sqrt(exports.IMABS(inumber));\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n};\n\nexports.IMCSC = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return cosecant of complex number\n  return exports.IMDIV('1', exports.IMSIN(inumber));\n};\n\nexports.IMCSCH = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return exports.IMDIV('1', exports.IMSINH(inumber));\n};\n\nexports.IMSUB = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber1 = trans_num(inumber1)\n  inumber2 = trans_num(inumber2)\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return _ of two complex numbers\n  return exports.COMPLEX(a - c, b - d, unit);\n};\n\nexports.IMSUM = function (inumber) {\n  inumber = trans_num(inumber)\n  var args = utils.flatten(arguments);\n\n  // Initialize result\n  var result = args[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(args[i]);\n    var d = exports.IMAGINARY(args[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a + c, b + d);\n  }\n\n  // Return sum of complex numbers\n  return result;\n};\n\nexports.IMTAN = function (inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return tangent of complex number\n  return exports.IMDIV(exports.IMSIN(inumber), exports.IMCOS(inumber));\n};\n\nexports.OCT2BIN = function (number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\n\n  // Convert octal number to decimal\n  var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\n\n  // Return error if number is lower than -512 or greater than 511\n  // if (decimal < -512 || decimal > 511) {\n  //     return error.num;\n  // }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n  if (result.length >=10){\n    return result.slice(result.length-10, result.length)\n  }\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.OCT2DEC = function(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Return decimal number\n  return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\n};\n\nexports.OCT2HEX = function(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = decimal.toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};","\"use strict\";\nmodule.exports = function find_all_need_calc_cell(wb, tileArr, exec_formula) {\n    var need_calc_cells = tileArr.findAllNeedCalcCell()\n    let formula_ref = {};\n    let cells = [];\n    for (let sheet_name in wb.Sheets) {\n        let sheet = wb.Sheets[sheet_name];\n        for(let i=0; i<need_calc_cells.length; i++){\n            let cell_name = need_calc_cells[i]\n            let formula = formula_ref[sheet_name + '!' + cell_name] = {\n                formula_ref: formula_ref,\n                wb: wb,\n                sheet: sheet,\n                sheet_name: sheet_name,\n                cell: sheet[cell_name],\n                name: cell_name,\n                status: 'new',\n                exec_formula: exec_formula\n            };\n            cells.push(formula);\n        }\n    }\n    return cells;\n};\n","var helper = require(\"../core/helper\")\n//XW: end\n//XW:,''\nexports.trans_params = function (cell) {\n  var reg = new RegExp('\\{(.*?)\\}', 'g')\n  var arg = cell.f.match(reg)\n  if (arg != null){\n    for (var i=0; i<arg.length; i++){\n      var param = arg[i]\n      var rep = \"'\" + param + \"'\"\n      cell.f = cell.f.replace(param, rep)\n    }\n  }\n  return cell\n}\n//XW:end\n//XW: default_0\nexports.trans_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 0 && sheet[i].f === \"\"){\n      sheet[i].v = 'default_0'\n    }\n  });\n  return sheet\n}\n\nexports.recover_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 'default_0'){\n      if (!helper.isHave(sheet[i].f)) {\n        sheet[i].f = \"\"\n      }\n      sheet[i].v = 0\n    }\n  });\n  return sheet\n}\n//XW: end\n//XW: \nexports.strim = function (str){\n  let str1 = str.replace(/\\s+$/,'');\n  let str2 = str1.replace(/^\\s+/,'')\n  return str2;\n}\n//XW end\n\n//xW: \nexports.trans_formula = function(f){\n  // FLOOR->FLOORMATH, vap-> vara\n  var trans_dict = {\n    'FLOOR': 'FLOORMATH',\n    'VAR': 'VARA',\n    'WORKDAY.INTL': 'WORKDAYINTL'\n  }\n  for(var i in trans_dict){\n    var b = trans_dict[i]\n    if (f.indexOf(b) < 0 && f.indexOf(i)>=0 && f.indexOf(i + '.') <=0){\n      f = f.replace(i, b)\n    }\n  }\n  //_XLFN. \n  f = f.replace('_XLFN.', '')\n  //\"\"\n  var reg = new RegExp('\"(.*?)\"', 'g')\n  var arg = f.match(reg)\n  if (f.indexOf('=') === 0){\n    f = f.toUpperCase()\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i].toUpperCase()\n        if(f.indexOf(param) >= 0){\n          f = f.replace(param, arg[i])\n        }\n      }\n    }\n  }\n  return f\n}\n//xW:end\n","exports.nil = new Error('#NULL!');\nexports.div0 = new Error('#DIV/0!');\nexports.value = new Error('#VALUE?');\nexports.ref = new Error('#REF!');\nexports.name = new Error('#NAME?');\nexports.num = new Error('#NUM!');\nexports.na = new Error('#N/A');\nexports.error = new Error('#ERROR!');\nexports.data = new Error('#GETTING_DATA');\n"],"sourceRoot":""}