{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/calc/formulajs/lib/utils.js","webpack:///./src/calc/RawValue.js","webpack:///./src/calc/exec_formula.js","webpack:///./src/calc/expression_builder.js","webpack:///./src/calc/Exp.js","webpack:///./src/calc/UserFnExecutor.js","webpack:///./src/calc/UserRawFnExecutor.js","webpack:///./src/calc/formulajs/lib/compatibility.js","webpack:///./src/calc/formulajs/lib/expression.js","webpack:///./src/calc/formulajs/lib/database.js","webpack:///./src/calc/formulajs/lib/logical.js","webpack:///./src/calc/formulajs/lib/financial.js","webpack:///./src/calc/formulajs/lib/lookup-reference.js","webpack:///./src/calc/formulajs/lib/custom.js","webpack:///./src/calc/formulas-raw.js","webpack:///./src/calc/Calculator.js","webpack:///./src/calc/CalcCell.js","webpack:///./src/calc/CalcWorkBook.js","webpack:///./src/calc/formulajs/lib/math-trig.js","webpack:///./src/calc/formulajs/lib/statistical.js","webpack:///./src/calc/utils.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/component/element.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/formula.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/recast.js","webpack:///./src/core/paste_proxy.js","webpack:///./src/core/cell_proxy.js","webpack:///./src/model/cell_prop.js","webpack:///./src/model/cell.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/event/move.js","webpack:///./src/component/event.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector_cell.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/suggest_content.js","webpack:///./src/component/selector_move.js","webpack:///./src/component/selector_copy.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/formula_editor.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/utils/number_util.js","webpack:///./src/canvas/draw.js","webpack:///./src/utils/test.js","webpack:///./src/component/table.js","webpack:///./src/component/editor_text.js","webpack:///./src/component/editor.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/core/format.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/history_border.js","webpack:///./src/component/dropdown_action.js","webpack:///./src/component/toolbar.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/button.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/advice.js","webpack:///./src/event/copy.js","webpack:///./src/component/website.js","webpack:///./src/component/special_formula_process.js","webpack:///./src/component/error_pop_up.js","webpack:///./src/component/rect_proxy.js","webpack:///./src/model/Timer.js","webpack:///./src/model/pre_action.js","webpack:///./src/component/sheet.js","webpack:///./src/external/drag.js","webpack:///./src/external/resize.js","webpack:///./src/event/table_proxy.js","webpack:///./src/event/paste.js","webpack:///./src/utils/date.js","webpack:///./src/core/multi_pre_action.js","webpack:///./src/model/paint_format.js","webpack:///./src/core/data_proxy.js","webpack:///./src/locale/zh-cn.js","webpack:///./src/log/log_proxy.js","webpack:///./src/log/debugout.js","webpack:///./src/index.js","webpack:///./src/calc/index.js","webpack:///./src/calc/int_2_col_str.js","webpack:///./src/calc/col_str_2_int.js","webpack:///./src/calc/Range.js","webpack:///./src/calc/formulajs/lib/text.js","webpack:///./src/calc/formulajs/lib/information.js","webpack:///./src/calc/formulajs/lib/date-time.js","webpack:///./src/calc/getSanitizedSheetName.js","webpack:///./src/calc/str_2_val.js","webpack:///./src/calc/RefValue.js","webpack:///./src/calc/formulajs/index.js","webpack:///./src/calc/formulajs/lib/miscellaneous.js","webpack:///./src/calc/formulajs/lib/engineering.js","webpack:///./src/calc/find_all_cells_with_formulas.js","webpack:///./src/calc/formula_check.js","webpack:///./src/calc/formulajs/lib/error.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","error","require","flattenShallow","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","isFlat","parse","Error","arr","flatten","argsToArray","arguments","args","numbers","possibleNumbers","filter","el","flattenNum","div0","undefined","cleanFloat","number","Math","round","parseBool","bool","up","toUpperCase","Date","isNaN","parseNumber","string","parseFloat","parseNumberArray","len","parsed","parseMatrix","matrix","pnarr","d1900","parse_arg","arg","parseInt","replace","parseDate","date","num","getTime","Copy","obj","copy","setTime","clone","attr","strToMatrix","str","split","toString","indexOf","ExcelDateToJSDate","utils","issue","isNumber","val","test","parseDateArray","this","anyIsError","arrayValuesToNumbers","rest","idx","initial","setValue","v","calc","expression_builder","xlsx_Fx","xlsx_raw_Fx","import_raw_functions","functions","opts","import_functions","formulajs","prefix","override","my_assign","dest","source","JSON","stringify","k","build_expression","formula","exec_formula","update_cell_value","set_fx","fn","exec_fx","localizeFunctions","dic","newName","oldName","Exp","RawValue","UserFnExecutor","UserRawFnExecutor","common_operations","status","root_exp","str_formula","cell","f","substr","exp_obj","buffer","was_string","fn_stack","exp","char","state","start","single_quote","stack","trim_buffer","trim","special","special_raw","sheet_name","ini_parentheses","pop","position_i","Range","str_2_val","MS_PER_DAY","exp_id","last_arg","self","isEmpty","checkVariable","exec","op","as","e","id","errorValues","message","w","sheet","str_expression","datedifference","exec_minus","pow","toLowerCase","user_function","map","mathTrig","statistical","engineering","dateTime","set","root","BETADIST","BETA","DIST","BETAINV","INV","BINOMDIST","BINOM","CEILING","ISOCEILING","MATH","CEILINGMATH","CEILINGPRECISE","PRECISE","CHIDIST","CHISQ","CHIDISTRT","RT","CHIINV","CHIINVRT","CHITEST","TEST","CONFIDENCE","NORM","COVAR","COVARIANCE","P","COVARIANCEP","COVARIANCES","S","CRITBINOM","EXPONDIST","EXPON","ERFCPRECISE","ERFC","ERFPRECISE","ERF","FDIST","F","FDISTRT","FINVRT","FINV","FLOORMATH","FLOORPRECISE","FLOORPRACE","FTEST","GAMMADIST","GAMMA","GAMMAINV","GAMMALNPRECISE","GAMMALN","HYPGEOMDIST","HYPGEOM","LOGINV","LOGNORM","LOGNORMINV","LOGNORMDIST","MODE","SNGL","MODEMULT","MULT","MODESNGL","NEGBINOMDIST","NEGBINOM","NETWORKDAYSINTL","NORMDIST","NORMINV","NORMSDIST","NORMSINV","PERCENTILE","EXC","PERCENTILEEXC","PERCENTILEINC","INC","PERCENTRANK","PERCENTRANKEXC","PERCENTRANKINC","POISSON","POISSONDIST","QUARTILE","QUARTILEEXC","QUARTILEINC","RANK","EQ","RANKAVG","AVG","RANKEQ","SKEWP","SKEW","STDEV","STDEVP","STDEVS","TDIST","T","TDISTRT","TINV","TTEST","VARP","VAR","VARS","WEIBULL","WEIBULLDIST","WORKDAYINTL","ZTEST","Z","_XLFN","FLOOR","defaultOperator","validSymbols","TOKEN_TYPE_OPERATOR","TOKEN_TYPE_LITERAL","SUPPORTED_TOKENS","createToken","type","analyzeTokens","tokens","literalValue","analyzedTokens","token","unshift","expression","expressionLength","cursorIndex","processedValue","processedSymbol","charAt","tokenizeExpression","compute","operator","values","evaluate","stats","maths","compact","find_result_idx","database","criteria","valid_arr","filter_arr","valid_str","result_idx","is_valid","eval","get_values","resultIndexes","field","field_idx","FINDFIELD","title","index","DAVERAGE","targetValues","sum","DCOUNT","COUNT","DCOUNTA","COUNTA","DGET","DMAX","max","DMIN","min","DPRODUCT","DSTDEV","DSTDEVP","DSUM","SUM","DVAR","DVARP","information","AND","CHOOSE","na","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","ISERROR","IFNA","value_if_na","NOT","logical","OR","TRUE","XOR","floor","abs","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","validDate","ACCRINT","first","settlement","rate","par","frequency","basis","YEARFRAC","ACCRINTM","AMORDEGRC","cost","date_purchased","first_period","salvage","period","AMORLINC","COUPDAYBS","maturity","COUPDAYS","COUPDAYSNC","COUPNCD","numerror","COUPNUM","COUPPCD","CUMIPMT","periods","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","life","month","toFixed","total","current","ceiling","DDB","factor","DISC","pr","redemption","DAYS","DOLLARDE","dollar","fraction","ceil","log","LN10","power","LN2","DOLLARFR","DURATION","coupon","yld","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","investment","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","negative","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","den","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","day","discount","PRICEDISC","PRICEMAT","dsm","PV","RATE","iter","close","t1","t2","Number","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","DAYS360","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","match_less_than_or_equal","lookupValue","indexValue","match_exactly_string","match_exactly_non_string","match_greater_than_or_equal","MATCH","matchType","VLOOKUP","return_index","cumulative","HLOOKUP","needle","table","exactmatch","row","City","url","PQUERY","absArr","o1","sort","obj1","obj2","val1","val2","items","count","a1","a2","a4","city","area","HYPERLINK","console","lianjia","lianJiaUrl","woaiwojia","woaiwojiaUrl","fangtianxia","fangtianxiaUrl","int_2_col_str","col_str_2_int","RefValue","cell_ref","rows","columns","height","width","ref_value","parsed_ref","parseRef","col","cell_name","col_str","end_range","onerrorvalue","Infinity","condition","_then","_else","find_all_cells_with_formulas","Calculator","workbook","expressions","variables","formulas","calcNames","var_name","variable","forEach","setVarOfExpression","vars","Workbook","Names","item","getRef","Ref","Name","ref_name","formula_ref","wb","checker","CalcCell","formulas_i","text","match","fml","reg","RegExp","param","rep","strim","trans_formula","trans_params","isHave","CalcWorkBook","tileArr","need_calc_cells","findAllNeedCalcCell","zb","expr2xy","getCell","Sheets","multivalueRefsCell","source_v","keys","setCell","v1","v2","enter","cell_v","cell_zb","cell_x","cell_y","expr","xy2expr","clean_matrix","ref","clean_all_flag","process_arr","process_matrix","numeric","ABS","ACOS","acos","ACOSH","sqrt","ACOT","atan","ACOTH","AGGREGATE","function_num","options","ref1","ref2","AVERAGE","MAX","MIN","PRODUCT","MEDIAN","LARGE","SMALL","ARABIC","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","join","significance","precision","ROUND","COMBIN","number_chosen","FACT","COMBINA","COS","cos","COSH","COT","tan","COTH","e2","CSC","sin","CSCH","DECIMAL","DEGREES","PI","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","places","GCD","range","r0","x","ri","y","INT","ISO","LCM","LN","LOG","base","LOG10","MDETERM","det","MINVERSE","inv","MMULT","matrix1","matrix2","dot","MOD","dividend","divisor","modulus","MROUND","multiple","MULTINOMIAL","MUNIT","dimension","identity","ODD","temp","POWER","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","top","ROMAN","digits","String","roman","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","function_code","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","value1","value2","NE","POW","exponent","argsKeys","elt","SUMIF","SUMIFS","s_arr","compareValue","lastIndexOf","resultArr","SUMPRODUCT","product","_i","_ij","arrays","SUMSQ","ISNUMBER","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","jStat","misc","evalExpression","AVEDEV","subtract","mean","AVERAGEA","AVERAGEIF","average_range","average_count","isWildcard","tokenizedCriteria","filter_criteria","AVERAGEIFS","criteriaLength","isMeetCondition","computedResult","average","alpha","beta","A","B","cdf","pdf","probability","successes","trials","binomial","chisquare","observed","expected","tmp","dof","xsqr","Pi","ChiSq","COLUMN","col_list","COLUMNS","cols","sd","normalci","tci","IFS","cond","CORREL","array1","array2","corrcoeff","COUNTBLANK","COUNTIN","element","blanks","COUNTIF","matches","COUNTIFS","results","COUNTUNIQUE","UNIQUE","mean1","mean2","covariance","DEVSQ","lambda","exponential","d1","d2","centralF","sumOfSquares","x1","x2","FISHER","FISHERINV","e2y","FORECAST","data_y","data_x","xmean","ymean","FREQUENCY","bins","gammafn","gamma","gammaln","GAUSS","z","normal","GEOMEAN","geomean","GROWTH","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","HARMEAN","N","INTERCEPT","KURT","sigma","stdev","LINEST","LOGEST","lognormal","MAXA","arr2","median","MINA","currentItem","maxItems","negbin","PEARSON","den1","den2","fl","uniques","PERMUT","PERMUTATIONA","PHI","poisson","PROB","lower","upper","sorted","quart","order","ROW","ROWS","RSQ","m2","m3","SLOPE","STANDARDIZE","STDEVA","VARA","STDEVPA","VARPA","STEYX","lft","TRANSPOSE","transpose","df","studentt","mean_x","mean_y","s_x","s_y","TREND","new_data_x","linest","TRIMMEAN","percent","helper","Rows2Workbook","cells","_","ci","webpackContext","req","webpackContextResolve","code","resolve","Element","tag","className","document","createElement","eventNames","handler","fen","oen","eventName","navigator","userAgent","addEventListener","evt","button","stopPropagation","css","offsetTop","left","offsetLeft","offsetHeight","offsetWidth","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","childNodes","ele","child","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","removeChild","getComputedStyle","h","$lang","$messages","en","toolbar","undo","redo","paintformat","clearformat","format","font","fontSize","fontBold","fontItalic","underline","strike","textColor","fillColor","border","merge","align","valign","textwrap","freeze","autofilter","more","flexible","throwFormula","comeBack","contextmenu","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteRow","deleteColumn","deleteCell","deleteCellText","validation","recover","rmb","usd","time","datetime","duration","date_formula","wland","wfr","rtd","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","pasteForMergedCell","calendar","weeks","months","cancel","save","ok","desc","asc","empty","dataValidation","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","spreadsheet","tf","locale","lang","baseFormulas","render","ary","deepCopy","formulaCalc","XLSX_CALC","formulam","Selector","CellRange","size","Scroll","Clipboard","cellRange","Filter","includes","Sort","AutoFilter","filters","flex","fitlers","it","getData","getFilter","hrange","exceptRowSet","rir","ix","set_total","cic","rset","Set","fset","sri","eri","ctext","cnt","valueOf","Merges","cb","cr","within","intersects","union","deleteWithin","cbWithin","sci","eci","rn","cn","it1","merges","recast","Recast","ast","preProcess","PasteProxy","srcCellRange","dstCellRange","srcOneDRange","dstOneDRange","dsri","dsci","deri","deci","drn","dcn","use","isLeftRight","isDown","getRangeByWay","line","way","offset","sarr","isCopy","isAdd","diffValue","last2","CellProxy","nrindex","cindex","cellText","formatInfo","tryParseToNum","isDate","ncell","nA","isFormula","search","str2Re","datePattern2","CellProp","depend","Cell","formatText","calcUtils","otherAutoFilter","darr","direction","what","other","dri","getCellByTopCell","iText","calcFormulaCellByTopCell","calcCellByTopCell","numberAutoFilter","calcNumberCellByTopCell","dateAutoFilter","diff","calcDateCellByTopCell","Rows","pasteProxy","getOrNew","exceptSet","rangeSum","has","getHeight","sumHeight","isSheetVale","_cell","to_calc_num","getDependCell","setFormatText","cutStr","mergeCellExpr","mergeArr","distinct","refCell","isAbsoluteValue","e1","each","getCellOrNew","arr3","s1","changeFormula","ca","setCellAll","value2absolute","es","s3","s2","re","cellStyle","isValid","isInsert","ds","dei","dci","isRows","cellProp","bad","newStr","getCellTextIsAdd","ds1","ds2","sp","und","getCellDataType","last1","formatMoney","copyRender","strList","splitStr","getRangeByTopCell","getCellTextByShift","updateCellReferenceByShift","word","dayjs","getCellByCell","cloneDeep","innerText","setSrcAndDstCellRange","autoFilterDirection","upOrDown","getOneDRangeObj","getAllDataType","getLocationArray","leftOrRight","calcDiff","nri","nci","srcCell","eachCells","ndata","rndata","entries","isReferOtherSheet","out","rowsInit","init","change","timeEnd","assign","Cols","indexWidth","minWidth","getWidth","sumWidth","rules","returnMessage","Validator","arrayEquals","parseValue","Validation","refs","validator","nrefs","difference","Validations","errors","Map","validate","getByValidator","addRef","equals","Moved","removeEvent","target","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","createEvent","keyCode","metaKey","buttons","event","initEvent","eventType","dispatchEvent","bindClickoutside","detail","hide","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","Resizer","vertical","minDistance","moving","cssPrefix","children","hoverEl","on","mousedownHandler","lineEl","cRect","finishedFn","rect","show","startEvt","distance","movementX","movementY","Scrollbar","moveFn","contentEl","scroll","contentDistance","cssKey","SelectorCell","getRect","setOffset","includeByRiCi","setData","selectorHeightBorderWidth","startZIndex","SelectorElement","selector","cornerEl","_selector","moveEvent","clickCopyPaste","boxinner","areaEl","clipboardEl","autofillEl","setTimeout","_cellRange","selectorMoveEl","container","setBoxinner","getCellRectByXY","layerX","layerY","move","getMoveRect","setMove","movedCell","movedCell2","cutPaste","indexes","moveIndexes","selectCell","moveChange","selectorMoveReset","pointer","calBRAreaOffset","ftwidth","freezeTotalWidth","ftheight","freezeTotalHeight","left0","top0","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","sc","areaOffset","arange","lastri","lastci","longTimeBefore","setCss","resetSelectOffset","freezeHeight","freezeWidth","getSelectedRect","coffset","getClipboardRect","resetOffset","isMergeCell","indexesUpdated","calSelectedRangeByStart","cri","cci","setIndexes","resetAreaOffset","calSelectedRangeByEnd","setEnd","pos","drisc","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","preventDefault","filterItems","itemIndex","scrollHeight","inputMoveNext","inputEnter","click","inputKeydownHandler","ctrlKey","Suggest","itemClick","editor","cssRemoveKeys","parent","startsWith","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","prev","next","week","selectChange","buildHeaderLeft","buildBody","getFullYear","trs","year","cdate","startDate","datess","disabled","getDate","monthDays","tds","Datepicker","calendarPattern","variableElement","txt","ct","SuggestContent","helpFormula","exampleName","example","item2","SelectorMove","cha","dict","timer","_move_selectors","selectors","msri","msci","meri","meci","clearTimeout","inputText","editorText","getText","_erpx","cuttingByPos","cuttingByPosEnd","erpx","find","setCursorPos","move2","color","lockCells","selectorMove","SelectorCopy","srn","ern","ecn","themeColorPlaceHolders","themeColors","selectColors","selectorColor","standardColors","buildTd","bgcolor","ColorPalette","isAb","offsetX","offsetY","cellRect","mousedownIndex","es1","es2","isCors","substring","setText","operation","setLock","makeSelector","judgeText","cutFirst","setMouseDownIndex","filterSelectors","selectors_delete","selectors_new","removeEl","suggestContent","cutting","div2span","cutting2","i2","mergeSelector","index2","selectorsEl","clearSelectors","editingSelectors","selectors_valid","enterCode","notTrueValue","prx","lax","prx_index","lax_index","findBracketLeft","begin","stop","findBracketRight","right","cutcolor","spanArr","spanEl","mount2span","baseFonts","fontSizes","pt","px","getFontSizePxByPt","evalFormula","rule","sheetbook","src","formulaMap","getCellText","look","look2","isMinus","dpr","devicePixelRatio","thinLineWidth","npx","npxLine","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","ctx","getContext","resize","scale","cxc","indent","vIndent","canvasContext","clearRect","beginPath","restore","fillRect","fillText","box","textLine","innerWidth","selfAdaptionOneTxtWidth","italic","bold","measureText","textWrap","ignore","textx","textAlign","textBaseline","fillStyle","strokeStyle","txtWidth","selfAdaptionTxtWidth","selfAdaptionHeight","texty","lineWidth","setLineDash","moveTo","y1","lineTo","stroke","topxys","rightxys","bottomxys","leftxys","sx","sy","drawFlexTrue","drawFlexFalse","strokeRect","clip","fill","y2","bezierCurveTo","closePath","dtextcb","testValid","valid","assert","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","getChangeDataToCalc","changeData","changeDataForCalc","parseCell","changeDataArgs","parseCell2","viewRange","each2","renderCell","draw","sortedRowMap","getCellStyleOrDefault","dbox","setBorders","strokeBorders","showEquation","rect2","renderFormat","settings","minus","specialStyle","validations","getError","renderFlexible","autoFilter","s_t","dropup","renderAutofilter","afRange","dropdown","renderContent","fw","fh","ret","filteredTranslateFunc","eachMergesInView","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","rowHeight","ii","colEach","colWidth","stringAt","renderFixedLeftTopCell","renderContentGrid","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","viewWidth","theight","viewHeight","Table","autoAdaptList","getCellTextOrDefault","clear","fri","fci","vr","freezeViewRange","EditorText","oldCell","getOldCell","cuttingByPosEnd2","text_b","resetTextareaSize","textlineEl","textEl","tlineWidth","maxWidth","viewFn","h1","getCursortPosition","containerEl","getSelection","rangeCount","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","startContainer","startOffset","exist","findBracket","spanLeft","spanRight","suggest","set_focus","savedSel","charIndex","createRange","setStart","collapse","node","nodeStack","foundStart","nodeType","nextCharIndex","sel","removeAllRanges","addRange","mouseDownEventHandler","parse2","setOldCell","isDisplay","inputEventHandler","inputType","chinese","showEditor","nodeValue","changed","changeText","cutValue","cuttingByPos2","valid2","keyDownEventHandler","which","opacity","setTextareaRange","position","blur","suggestItemClick","resetSuggestContentItems","resetSuggestItems","setItems","Editor","rowWidth","display","lock","datepicker","dateFormat","setCellEnd","getSelectedCellRiCi","currentTarget","key_num","f4ShortcutKey","bindInputEvents","clp","originalEvent","clipboardData","newNode","insertNode","selection","pasteHTML","execCommand","textFormat","off","focus","setRiCi","insertBefore","cursorPos","textBegin","textEnd","suggestPosition","elOffset","sOffset","menuItems","buildMenuItem","buildMenu","ContextMenu","isHide","menus","view","Dropdown","showArrow","placement","arrowChange","historyBorder","headerEl","DropdownFont","nfonts","setTitle","DropdownFontSize","nfontSizes","formatStringRender","formatNumberRender","fixed","baseFormats","multiply","a_s","toInteger","floatNum","times","isNegative","strfi","dotPos","intNum","o2","n1","n2","formatm","DropdownFormat","nformats","DropdownFormula","nformulas","DropdownColor","iconName","icon","colorPalette","DropdownAlign","aligns","naligns","setName","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","HistoryBorder","history","els","action","DropdownAction","buildButton","tooltipdata","elBox","tooltip","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","undoEl","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","widthFn","btns","moreEl","ddMore","sumWidth2","list1","list2","Toolbar","defaultStyle","redoEl","paintformatEl","clearformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","freezeEl","addEl","closeEl","autofilterEl","throwFormulaEl","reset","getSelectedCellStyle","getSelectedCell","canUndo","canRedo","canUnmerge","canAutofilter","equationIsActive","freezeIsActive","Modal","open","dimmer","documentElement","clientHeight","clientWidth","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","labelWidth","tip","pattern","Button","fieldLabelWidth","ModalValidation","mf","rf","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","attrs","isShow","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","itemKeys","filterClick","resetFilterHeader","filterhEl","checked","SortFilter","tindex","sortAscEl","sortDescEl","sortDesc","from","findIndex","xtoast","Advice","saveCheck","textCheck","old_rows","new_rows","setCellRange","reference","tableProxy","sheetReset","mountCopy","choose","getChooseImg","parseDom","img2","sheetCopy","plain","pasteDirectionsArr","styles","tbody","tr","td","hidden","tmpNode","cloneNode","Website","tableEl","timer2","isDisplay2","td2","td3","td4","td5","isSpecialWebsite","screenX","screenY","ErrorPopUp","RectProxy","ex","ey","clientX","clientY","positionAngle","Timer","clearInterval","getCellDepend","PreAction","oldData","newData","oldStep","newCell","newMergesData","oldMergesData","changeArr","isRedo","setCellText","_data","_cells","setHeight","setWidth","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","fsw","fsh","selectorSet","render_timer","editorSetOffset","overlayerMousemove","rowResizer","colResizer","website","tRect","overlayerMousescroll","autoLoad","delta","deltaY","overlayerTouch","verticalScrollbarSet","totalHeight","horizontalScrollbarSet","totalWidth","sheetFreeze","fwidth","fheight","setFreezeLengths","overlayerEl","overlayerCEl","tOffset","vRect","renderAutoAdapt","autoRowResizer","toolbarChangeSelectorCell","clearClipboard","msg","toolbarChangePaintformatPaste","paintformatActive","paintFormatChange","paintformatToggle","dropDown","isAutofillEl","dstRect","getCellRectByXYWithNotTotalResult","dropGetPos","rpos","orien","isOusideViewRange","continueMove","shiftKey","getMovePos","selectorBeyondMove","rectProxy","isLocInside","getUpDownLeftRight","scrollTo","overlayerMousedown","sortFilter","advice","corner","hideDirectionArr","includes2","getSet","getSort","point","offsetParent","getPoint","clearStopTimer","continueDropDown","autofill","autofillNext","stopTimer","stopTimer2","setInterval","loadFormula","firstRowToWidth","colResizerFinished","adviceSetOffset","pictureSetOffset","pictureOffsetLeft","pictureOffsetTop","img","sPosition","selectorsSetOffset","resetSelectorBRLAreaOffset","hasEditor","editorSet","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","viewRange2","autoAdapt","ignoreRi","getCellTextContent","getCellTextStyle","_ignore","cellWidth","record_rc","r_h","record_h","c_h","clickSelectorChangeRiCi","rowResizerFinished","setRowHeight","setColWidth","errorPop","errorPopUp","selectorCellText","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","insert","toolbarChange","setContent","historyList","getMax","mri","mci","eachRange","showFreeze","setSelectedCellAttr","borderResSet","sortFilterChange","setAutoFilter","afterSelector","getLock","proxy","pasteEvent","mountPaste","sheetInitEvents","startx","starty","contextMenu","modalValidation","pasteOverlay","xyInSelectedRect","setPosition","touches","pageX","pageY","changedTouches","itext","editorChangeToHistory","getRICI","setSelectedCell","addValidation","removeValidation","getSelectedValidation","reload","focusing","altKey","addPic","pictures","deleteImg","trigger","Sheet","targetEl","showToolbar","showContextmenu","recalc","clickAutofill","styleBool","setFreeze","Drag","register","onBegin","cursor","nl","nt","onmousemove","nx","ny","onDrag","onmouseup","onEnd","returnValue","Resize","directionsArr","directions","div","onResize","querySelector","onmousedown","ox","oy","ow","oh","ol","ot","isResize","fun","mappers","ee","setLeft","setTop","se","nw","ws","ne","TableProxy","fontWeight","background","tableDom","colLen","defaultView","isHaveStyle","maxRi","maxCi","rii","cij","resizeOption","dragOption","lastCi","lastRi","spanDomPackage","spanDom","textArr","process","styleDom","GetInfoFromTable","cbd","kind","getAsString","textDom","imgDom","getElementsByTagName","mountImg","getAsFile","reader","FileReader","onload","readAsDataURL","getMaxCoord","nextLeft","nextTop","image","Image","containerHandlerEvent","direction_new","direction_delete","newX","tableObj","extend","dealColSpan","dealStyle","dealReference","parseTableCellRange","formatDate","calcDecimals","beginDate","beginDate2","second","fix","dateDiff","datePattern","operationItem","preAction","undoItems","redoItems","MultiPreAction","expr1","expr2","does","getItems","actionItems","actionType","PaintFormat","selectorRange","dstRange","dType","sType","getType","pArr","recordRi","rowIndex","_darr","changeDarrToDoubleArr","defaultSettings","canPaste","dst","scn","copyPaste","deleteCells","cleard","clipboard","setStyleBorder","bss","cstyle","addStyle","event_type","description","isLegal","processPasteDirectionsArr","newItem","clickCopyPasteHelp","lci","lri","lcell","setStyleBorders","isSignleSelected","mergeIndexes","mrl","mcl","getCellMerge","getCellRowByY","scrollOffsety","inits","frset","getCellColByX","scrollOffsetx","rangeReduceIf","makeFormatCell","symbol","cText","getCellStyle","getCellStyleConvert","minute","changeFormat","useOne","DataProxy","methods","hyperlinks","comments","multiPreAction","moved","unsortedRowMap","cell2","cell3","makeCellPropArr","setCellByCellProp","paintFormat","paintType","getPaintType","makePaintArr","srcRange","getFirstIncludes","unmerge","nfont","resetAutoFilter","getStepType","oc","nc","addStep","isClear","autoFilterRef","addFilter","setSort","filteredRows","fary","oldAry","si","rsize","csize","isBackEndFunc","p1","p2","A1","filterIntersects","frary","nstyle","lastStep","changeToHistory","addFiexRows","revision","bugout","realTimeLoggingOn","useTimestamps","useLocalStorage","recordLogs","autoTrim","maxLines","tailNumLines","logFilename","depth","parentSizes","currentResult","startTime","output","version","getLog","retrievalTime","saved","localStorage","getItem","lastLog","formatSessionDuration","tail","numLines","tailLines","trimLog","lines","rgx","matched","addr","getSlice","lineNumber","downloadLog","file","logFile","encodeURIComponent","href","download","clearTime","saveObject","setItem","determineType","addition","logTime","formatTimestamp","last","typeResult","formatType","objectSize","prop","indentsForDepth","subtype","subresult","endTime","msec","hh","hrs","mm","mins","ss","timestamp","getHours","getMinutes","getSeconds","Spreadsheet","alias","zhCN","rootEl","loadData","selectorEditorReset","getCellByExpr","jsSpreadsheet","drag","find_all_need_calc_cell","mymodule","Calc_WorkBook","get_workbook","calc_cell","valid_res","check_valid","trans_sheet","recover_formula","recover_sheet","is_muti_cell","deal_muti_cell","calcDoneToSetCells","calculator","modulo","columnName","guard","fromCharCode","colstr","charCodeAt","getSanitizedSheetName","possition_i","range_expression","start_pst","end_pst","aux","range_start_pst","max_row","min_row","str_max_row","min_col","max_col","cell_full_name","numeral","num2e","allzero","decimalsToFractional","decimals","formatDecimals","recursion","isInteger","ASC","BAHTTEXT","CHAR","CLEAN","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","EXACT","text1","text2","FIND","find_text","within_text","FIXED","no_commas","HTML2TEXT","INDEX","row_num","column_num","LEFT","LEN","LOWER","MID","NUMBERVALUE","decimal_separator","group_separator","PRONETIC","PROPER","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","REPT","RIGHT","SEARCH","foundAt","SPLIT","separator","SUBSTITUTE","old_text","occurrence","TEXT","Formulas","AllFormulas","fmt","TRIM","UNICHAR","UNICODE","UPPER","VALUE","unformat","CELL","ERROR","TYPE","error_val","nil","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISODD","ISREF","ISTEXT","NA","SHEET","SHEETS","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","isLeapYear","daysBetween","start_date","end_date","serial","DATE","DATEVALUE","date_text","DAY","serial_number","method","ed","sm","em","smd","emd","EDATE","EOMONTH","HOUR","INTERVAL","hour","sec","ISOWEEKNUM","setHours","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","weekend","NETWORKDAYS$INTL","days","getTimezoneOffset","getUTCDay","dec","holiday","INTL","NOW","SECOND","TIME","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","week_start","jan","inc","WORKDAY","YEAR","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","quotedMatch","resolved_ref","ref_cell","categories","category","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","path","opening","JOIN","NUMBERS","NUMERAL","bessel","isValidBinaryNumber","trans_num","inumber","BESSELI","besseli","BESSELJ","besselj","BESSELK","besselk","BESSELY","bessely","BIN2DEC","stringified","BIN2HEX","BIN2OCT","BITAND","number1","number2","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","Y","E","G","u","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","lower_bound","upper_bound","erf","erfc","GESTEP","HEX2BIN","decimal","HEX2DEC","HEX2OCT","IMABS","IMREAL","IMAGINARY","plus","unit","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","trans_dict"],"mappings":"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X,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,gBAAiB,IACjB,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,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","file":"xspreadsheet.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([259,2,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var error = require('./error');\n\nfunction flattenShallow(array) {\n  if (!array || !array.reduce) { return array; }\n  return array.reduce(function(a, b) {\n    var aIsArray = Array.isArray(a);\n    var bIsArray = Array.isArray(b);\n    if (aIsArray && bIsArray ) {\n      return a.concat(b);\n    }\n    if (aIsArray) {\n      a.push(b);\n      return a;\n    }\n    if (bIsArray) {\n      return [a].concat(b);\n    }\n    return [a, b];\n  });\n}\n\nfunction isFlat(array) {\n  if (!array) { return false; }\n  for (var i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexports.flatten = function() {\n  var result = exports.argsToArray.apply(null, arguments);\n  while (!isFlat(result)) {\n    result = flattenShallow(result);\n  }\n  return result;\n};\n\nexports.argsToArray = function(args) {\n  return Array.prototype.slice.call(args, 0);\n};\n\nexports.numbers = function() {\n\n  return possibleNumbers.filter(function(el) {\n    return typeof el === 'number';\n  });\n};\n//XW: 将参数解析成数字数组，若有不符合要求的报错，default0忽略\nfunction parse(a){\n  if (a instanceof Error){\n    return a\n  }\n  if (a instanceof Array){\n    var arr = []\n    for (var i=0;i<a.length;i++){\n      if (typeof a[i][0] === 'string' && a[i][0] !== 'default_0'){\n        return error.name\n      }\n      if (typeof a[i][0] === 'number'){\n        arr.push(a[i][0])\n      }\n      if (a[i][0] instanceof Object){\n        return error.name\n      }\n    }\n    return arr\n  }\n  if (typeof a === 'string'){\n    if (a === 'default_0'){\n      return 'pass'\n    }else{\n      return error.name\n    }\n  }\n  if (typeof a === 'number'){\n    return a\n  }\n}\nexports.flattenNum = function(args) {\n  try{\n    if (args.length === 1 && args[0][0] === 'default_0'){\n      return error.div0\n    }\n    var arr = []\n    for( var i=0;i<args.length;i++){\n      var p = parse(args[i])\n      if (p === undefined){\n        return error.name\n      }\n      if (p instanceof Error){\n        return p\n      }else if(p !== 'pass'){\n        if (p instanceof Array){\n          for (var n=0; n < p.length;n++){\n            arr.push(p[n])\n          }\n        }else{\n          arr.push(p)\n        }\n      }\n    }\n    return arr\n  }catch{\n    return error.name\n  }\n};\n//XW:end\n\nexports.cleanFloat = function(number) {\n  var power = 1e14;\n  return Math.round(number * power) / power;\n};\n\nexports.parseBool = function(bool) {\n  if (bool === undefined){\n    return true\n  }\n  if (typeof bool === 'boolean') {\n    return bool;\n  }\n\n  if (bool instanceof Error) {\n    return bool;\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0;\n  }\n\n  if (typeof bool === 'string') {\n    var up = bool.toUpperCase();\n    if (up === 'TRUE') {\n      return true;\n    }\n\n    if (up === 'FALSE') {\n      return false;\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true;\n  }\n\n  return error.value;\n};\n\nexports.parseNumber = function(string) {\n  if (string === undefined || string === '') {\n    return error.value;\n  }\n  if (!isNaN(string)) {\n    return parseFloat(string);\n  }\n  return error.value;\n};\n\nexports.parseNumberArray = function(arr) {\n  var len;\n  if (!arr || (len = arr.length) === 0) {\n    return error.value;\n  }\n  var parsed;\n  while (len--) {\n    parsed = exports.parseNumber(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.parseMatrix = function(matrix) {\n  var n;\n  if (!matrix || (n = matrix.length) === 0) {\n    return error.value;\n  }\n  var pnarr;\n  for (var i = 0; i < matrix.length; i++) {\n    pnarr = exports.parseNumberArray(matrix[i]);\n    matrix[i] = pnarr;\n    if (pnarr instanceof Error) {\n      return pnarr;\n    }\n  }\n  return matrix;\n};\n\nvar d1900 = new Date(1900, 0, 1);\nexports.parseDate = function(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date);\n    }\n    var d = parseInt(date, 10);\n    if (d < 0) {\n      return error.num;\n    }\n    if (d <= 60) {\n      return new Date(d1900.getTime() + (d - 1) * 86400000);\n    }\n    return new Date(d1900.getTime() + (d - 2) * 86400000);\n  }\n  if (typeof date === 'string') {\n    date = new Date(date);\n    if (!isNaN(date)) {\n      return date;\n    }\n  }\n  return error.value;\n};\nexports.Copy =  function (obj) {\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n  // Handle Date\n  if (obj instanceof Date) {\n    var copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n  // Handle Array\n  if (obj instanceof Array) {\n    var copy = [];\n    for (var i = 0; i < obj.length; ++i) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n  // Handle Object\n  if (obj instanceof Object) {\n    var copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n//XW:{}中参数解析,将{1,2,3；4,5,6}这样的参数解析为数组结构\nfunction parse_arg(arg) {\n  if(!isNaN(parseInt(arg))){\n    return parseInt(arg)\n  }\n  return arg.replace('\"', '').replace('\"', '')\n}\nexports.strToMatrix = function (str) {\n  var arg = str.slice(2,str.length-2).split(',')\n  var matrix = [];\n  var arr = []\n  for (var i=0; i < arg.length; i++){\n    var num = arg[i].toString()\n    if (num.indexOf(';') > 0) {\n      arr.push(parse_arg(num.split(';')[0]))\n      matrix.push(arr)\n      arr = [parse_arg(num.split(';')[1])]\n    }else{\n      arr.push(parse_arg(num))\n    }\n  }\n  matrix.push(arr)\n  return matrix\n}\n//XW: end\n//XW：excel日期转js日期\nexports.ExcelDateToJSDate = function (date) {\n  if (typeof date == 'string'){\n    date = utils.parseDate(issue)\n  }\n  return (date instanceof Date) ? date : new Date(Math.round((date - 25569)*86400*1000));\n}\n//XW：end\n//XW：判定是否是数字\nexports.isNumber = function (val) {\n  var regPos = /^\\d+(\\.\\d+)?$/; //非负浮点数\n  var regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //负浮点数\n  if(regPos.test(val) || regNeg.test(val)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n//XW：end\nexports.parseDateArray = function(arr) {\n  var len = arr.length;\n  var parsed;\n  while (len--) {\n    parsed = this.parseDate(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.anyIsError = function() {\n  var n = arguments.length;\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexports.arrayValuesToNumbers = function(arr) {\n  var n = arr.length;\n  var el;\n  while (n--) {\n    el = arr[n];\n    if (typeof el === 'number') {\n      continue;\n    }\n    if (el === true) {\n      arr[n] = 1;\n      continue;\n    }\n    if (el === false) {\n      arr[n] = 0;\n      continue;\n    }\n    if (typeof el === 'string') {\n      var number = this.parseNumber(el);\n      if (number instanceof Error) {\n        arr[n] = 0;\n      } else {\n        arr[n] = number;\n      }\n    }\n  }\n  return arr;\n};\n\nexports.rest = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(idx);\n};\n\nexports.initial = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(0, array.length - idx);\n};\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","\"use strict\";\n\nconst expression_builder = require('./expression_builder.js');\n\nlet xlsx_Fx = {};\nlet xlsx_raw_Fx = {};\n\nimport_functions(require('.//formulajs/index'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            if (opts.override || !xlsx_Fx[prefix + key]) {\n                xlsx_Fx[prefix + key] = obj;\n            }\n            // else {\n            //     console.log(prefix + key, 'already exists.');\n            //     console.log('  to override:');\n            //     console.log('    XLSX_CALC.import_functions(yourlib, {override: true})');\n            // }\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    return expression_builder(formula, {xlsx_Fx: xlsx_Fx, xlsx_raw_Fx: xlsx_raw_Fx});\n    // xlsx_raw_Fx = {AND, IF, IFERROR, OFFSET}\n    // xlsx_Fx = {FLOOR, AVERGAE ... }\n}\n\nfunction exec_formula(formula) { // formula.cell.f = \"Average(1,2,3,4,5)\n    let root_exp = build_expression(formula);\n    root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.localizeFunctions = function(dic) {\n    for (let newName in dic) {\n        let oldName = dic[newName];\n        if (xlsx_Fx[oldName]) {\n            xlsx_Fx[newName] = xlsx_Fx[oldName];\n        }\n        if (xlsx_raw_Fx[oldName]) {\n            xlsx_raw_Fx[newName] = xlsx_raw_Fx[oldName];\n        }\n    }\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nexec_formula.xlsx_Fx = xlsx_Fx;\nmodule.exports = exec_formula;\n","const Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nmodule.exports = function expression_builder(formula, opts) { // 核心的解析公式的方法\n    formula.status = 'working';\n\n    var xlsx_Fx = opts.xlsx_Fx || {};\n    var xlsx_raw_Fx = opts.xlsx_raw_Fx || {};\n\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1); // =adsf 会变为adsf\n    }\n    var exp_obj = root_exp = new Exp(formula);  // 封装公式实例\n    var buffer = '',\n        was_string = false;\n    var fn_stack = [{ // 这个是函数调用栈？\n        exp: exp_obj\n    }];\n\n    /**\n     * state pattern in functional way\n     */\n    function string(char) {\n        if (char === '\"') {\n            exp_obj.push(new RawValue(buffer));\n            was_string = true;\n            buffer = '';\n            state = start;\n        } else {\n            buffer += char;\n        }\n    }\n\n    function single_quote(char) {\n        if (char === \"'\") {\n            state = start;\n        }\n        buffer += char;\n    }\n\n    function ini_parentheses() {\n        var o, trim_buffer = buffer.trim(),\n            special = xlsx_Fx[trim_buffer];\n        var special_raw = xlsx_raw_Fx[trim_buffer];\n        if (special_raw) {\n            special = new UserRawFnExecutor(special_raw, formula);\n        }\n        else if (special) {\n            special = new UserFnExecutor(special, formula);\n        }\n        else if (trim_buffer) {\n            //Error: \"Worksheet 1\"!D145: Function INDEX not found\n            throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n        }\n        o = new Exp(formula);\n        fn_stack.push({\n            exp: o,\n            special: special\n        });\n        exp_obj = o;\n        buffer = '';\n    }\n\n    function end_parentheses() {\n        var v, stack = fn_stack.pop();\n        exp_obj = stack.exp;\n        exp_obj.push(buffer,position_i);\n        v = exp_obj;\n        buffer = '';\n        exp_obj = fn_stack[fn_stack.length - 1].exp;\n        if (stack.special) {\n            stack.special.push(v);\n            exp_obj.push(stack.special, position_i);\n        }\n        else {\n            exp_obj.push(v, position_i);\n        }\n    }\n\n    function add_operation(char) {\n        if (!was_string) {\n            exp_obj.push(buffer, position_i);\n        }\n        was_string = false;\n        exp_obj.push(char, position_i);\n        buffer = '';\n    }\n\n    function start(char) {\n        if (char === '\"') {\n            state = string;\n            buffer = \"\";\n        } else if (char === \"'\") {\n            state = single_quote;\n            buffer = \"'\";\n        } else if (char === '(') {\n            ini_parentheses();\n        } else if (char === ')') {\n            end_parentheses();\n        } else if (common_operations[char]) {\n            add_operation(char);\n        } else if (char === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer, position_i);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        } else {\n            buffer += char;\n        }\n    }\n\n    var state = start;\n    var position_i = 0;\n\n    for (; position_i < str_formula.length; position_i++) {\n        state(str_formula[position_i]); // 逐字符解析函数\n    }\n    root_exp.push(buffer, position_i); // root_exp 是一个Exp实例，这个实例会引用一个Exp数组\n    return root_exp;\n\n}\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst str_2_val = require('./str_2_val.js');\n//XW：统一报错\nvar error = require('./formulajs/lib/error');\n//XW：end\n\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\nvar exp_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;   // id 是一个递增序列，其中root_exp的id为1\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n\n    function update_cell_value() {\n        try {\n            if (Array.isArray(self.args)\n                    && self.args.length === 1\n                    && self.args[0] instanceof Range) {\n                throw error.value;\n            }\n            formula.cell.v = self.calc();\n\n            if (typeof(formula.cell.v) === 'string') {\n                formula.cell.t = 's';\n            }\n            else if (typeof(formula.cell.v) === 'number') {\n                formula.cell.t = 'n';\n            }\n        }\n        catch (e) {\n            var errorValues = {\n                '#NULL!': 0x00,\n                '#DIV/0!': 0x07,\n                '#VALUE!': 0x0F,\n                '#REF!': 0x17,\n                '#NAME?': 0x1D,\n                '#NUM!': 0x24,\n                '#N/A': 0x2A,\n                '#GETTING_DATA': 0x2B\n            };\n            if (errorValues[e.message] !== undefined) {\n                formula.cell.t = 'e';\n                formula.cell.w = e.message;\n                formula.cell.v = errorValues[e.message];\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            formula.status = 'done';\n        }\n    }\n    function isEmpty(value) {\n        return value === undefined || value === null || value === \"\";\n    }\n\n    function checkVariable(obj) {\n        if (typeof obj.calc !== 'function') {\n            return 0;\n        }\n        return 1;\n    }\n\n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    if (i === 0 && op === '+') {\n                        let as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = args[i + 1].calc();\n                        args.splice(i, 2, new RawValue(r));\n                    } else {\n                        let as = checkVariable(args[i - 1]);\n                        if (!as)\n                            break;\n                        as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = fn(args[i - 1].calc(), args[i + 1].calc());\n                        args.splice(i - 1, 3, new RawValue(r));\n                        i--;\n                    }\n                }\n                catch (e) {\n                    // console.log('[Exp.js] - ' + formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                checkVariable(args[i + 1]);\n                var b = args[i + 1].calc();\n                if (i > 0 && typeof args[i - 1] !== 'string') {\n                    args.splice(i, 1, '+');\n                    if (b instanceof Date) {\n                        b = Date.parse(b);\n                        checkVariable(args[i - 1]);\n                        var a = args[i - 1].calc();\n                        if (a instanceof Date) {\n                            a = Date.parse(a) / MS_PER_DAY;\n                            b = b / MS_PER_DAY;\n                            args.splice(i - 1, 1, new RawValue(a));\n                        }\n                    }\n                    args.splice(i + 1, 1, new RawValue(-b));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(-b));\n                }\n            }\n        }\n    }\n    self.calc = function() {\n        let args = self.args.concat();\n        //XW: 对函数参数做转换、判断\n        try{\n            for (var i=0;i<args.length;i++){\n                if (args[i].name == 'RefValue'){\n                    var sheet = args[i].formula.sheet\n                    //未定义单元格f置为default_0\n                    if (sheet[args[i].str_expression] === undefined){\n                        args[i].formula.sheet[args[i].str_expression] = {v: 'default_0'}\n                    }\n                    //=A0形式参数报错\n                    if (args[i].str_expression.slice(1, args[i].str_expression.length) == '0'){\n                        return error.name;\n                    }\n                }\n            }\n        }catch (e) {\n        }\n        try{\n            //形如2019年10月19日参数转为2019-10-19\n            if (args[0].name == 'RefValue' && args[1] == '-' && args[2].name == 'RefValue'){\n                var sheet = args[0].formula.sheet\n                var a = sheet[args[0].str_expression].v\n                var b = sheet[args[2].str_expression].v\n                var a = a.replace('年', '-').replace('月', '-').replace('日', '')\n                var b = b.replace('年', '-').replace('月', '-').replace('日', '')\n                return datedifference(a, b)\n            }\n        }catch (e) {\n        }\n        //XW：end\n        exec_minus(args);\n        exec('^', args, function(a, b) {\n            return Math.pow(+a, +b);\n        });\n        exec('/', args, function(a, b) {\n            if (b == 0) {\n                throw error.div0;\n            }\n            return (+a) / (+b);\n        });\n        exec('*', args, function(a, b) {\n            return (+a) * (+b);\n        });\n        exec('+', args, function(a, b) {\n            if (a instanceof Date && typeof b === 'number') {\n                b = b * MS_PER_DAY;\n            }\n            return (+a) + (+b);\n        });\n        exec('&', args, function(a, b) {\n            return '' + a + b;\n        });\n        exec('<', args, function(a, b) {\n            return a < b;\n        });\n        exec('>', args, function(a, b) {\n            return a > b;\n        });\n        exec('>=', args, function(a, b) {\n            return a >= b;\n        });\n        exec('<=', args, function(a, b) {\n            return a <= b;\n        });\n        exec('<>', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() !== b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return false;\n            }\n            return a != b;\n        });\n        exec('=', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return true;\n            }\n            if ((a == null && b === 0) || (a === 0 && b == null)) {\n                return true;\n            }\n            if (typeof a === 'string' && typeof b === 'string' && a.toLowerCase() === b.toLowerCase()) {\n                return true;\n            }\n            return a == b;\n        });\n        if (args.length == 1) {\n            if (typeof(args[0].calc) !== 'function') {\n                return args[0];\n            }\n            else {\n                return args[0].calc();\n            }\n        }\n    };\n\n    var last_arg;\n    self.push = function(buffer, position_i) {\n        if (buffer) {\n            var v = str_2_val(buffer, formula, position_i);\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};\n","\"use strict\";\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    self.calc = function() {\n        var errorValues = {\n            '#NULL!': 0x00,\n            '#DIV/0!': 0x07,\n            '#VALUE!': 0x0F,\n            '#REF!': 0x17,\n            '#NAME?': 0x1D,\n            '#NUM!': 0x24,\n            '#N/A': 0x2A,\n            '#GETTING_DATA': 0x2B\n        }, result;\n        try {\n            result = user_function.apply(self, self.args.map(f=>f.calc()));\n        } catch (e) {\n            if (user_function.name === 'is_blank'\n                && errorValues[e.message] !== undefined) {\n                // is_blank applied to an error cell doesn't propagate the error\n                result = 0;\n            }\n            else if (user_function.name === 'iserror'\n                && errorValues[e.message] !== undefined) {\n                // iserror applied to an error doesn't propagate the error and returns true\n                result = true;\n            }\n            else {\n                throw e;\n            }\n        }\n        return result;\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","var mathTrig = require('./math-trig');\nvar statistical = require('./statistical');\nvar engineering = require('./engineering');\nvar dateTime = require('./date-time');\n\nfunction set(fn, root) {\n  if (root) {\n    for (var i in root) {\n      fn[i] = root[i];\n    }\n  }\n  return fn;\n}\n\nexports.BETADIST = statistical.BETA.DIST;\nexports.BETAINV = statistical.BETA.INV;\nexports.BINOMDIST = statistical.BINOM.DIST;\nexports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);\nexports.CEILINGMATH = mathTrig.CEILING.MATH;\nexports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;\nexports.CHIDIST = statistical.CHISQ.DIST;\nexports.CHIDISTRT = statistical.CHISQ.DIST.RT;\nexports.CHIINV = statistical.CHISQ.INV;\nexports.CHIINVRT = statistical.CHISQ.INV.RT;\nexports.CHITEST = statistical.CHISQ.TEST;\nexports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);\nexports.COVAR = statistical.COVARIANCE.P;\nexports.COVARIANCEP = statistical.COVARIANCE.P;\nexports.COVARIANCES = statistical.COVARIANCE.S;\nexports.CRITBINOM = statistical.BINOM.INV;\nexports.EXPONDIST = statistical.EXPON.DIST;\nexports.ERFCPRECISE = engineering.ERFC.PRECISE;\nexports.ERFPRECISE = engineering.ERF.PRECISE;\nexports.FDIST = statistical.F.DIST;\nexports.FDISTRT = statistical.F.DIST.RT;\nexports.FINVRT = statistical.F.INV.RT;\nexports.FINV = statistical.F.INV;\n// XW：FLOOR函数修改\n// exports.FLOOR = set(mathTrig.FLOORMATH, mathTrig.FLOOR);//11.5-调用矛盾\nexports.FLOORMATH = mathTrig.FLOORMATH;\nexports.FLOORPRECISE = mathTrig.FLOORPRACE;\n//XW：end\nexports.FTEST = statistical.F.TEST;\nexports.GAMMADIST = statistical.GAMMA.DIST;\nexports.GAMMAINV = statistical.GAMMA.INV;\nexports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;\nexports.HYPGEOMDIST = statistical.HYPGEOM.DIST;\nexports.LOGINV = statistical.LOGNORM.INV;\nexports.LOGNORMINV = statistical.LOGNORM.INV;\nexports.LOGNORMDIST = statistical.LOGNORM.DIST;\nexports.MODE = set(statistical.MODE.SNGL, statistical.MODE);\nexports.MODEMULT = statistical.MODE.MULT;\nexports.MODESNGL = statistical.MODE.SNGL;\nexports.NEGBINOMDIST = statistical.NEGBINOM.DIST;\nexports.NETWORKDAYSINTL = dateTime.NETWORKDAYSINTL;\nexports.NORMDIST = statistical.NORM.DIST;\nexports.NORMINV = statistical.NORM.INV;\nexports.NORMSDIST = statistical.NORM.S.DIST;\nexports.NORMSINV = statistical.NORM.S.INV;\nexports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);\nexports.PERCENTILEEXC = statistical.PERCENTILE.EXC;\nexports.PERCENTILEINC = statistical.PERCENTILE.INC;\nexports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);\nexports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;\nexports.PERCENTRANKINC = statistical.PERCENTRANK.INC;\nexports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);\nexports.POISSONDIST = statistical.POISSON.DIST;\nexports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);\nexports.QUARTILEEXC = statistical.QUARTILE.EXC;\nexports.QUARTILEINC = statistical.QUARTILE.INC;\nexports.RANK = set(statistical.RANK.EQ, statistical.RANK);\nexports.RANKAVG = statistical.RANK.AVG;\nexports.RANKEQ = statistical.RANK.EQ;\nexports.SKEWP = statistical.SKEW.P;\nexports.STDEV = set(statistical.STDEV.S, statistical.STDEV);\nexports.STDEVP = statistical.STDEV.P;\nexports.STDEVS = statistical.STDEV.S;\nexports.TDIST = statistical.T.DIST;\nexports.TDISTRT = statistical.T.DIST.RT;\nexports.TINV = statistical.T.INV;\nexports.TTEST = statistical.T.TEST;\n// exports.VAR = set(statistical.VAR.S, statistical.VAR);\nexports.VARP = statistical.VAR.P;\nexports.VARS = statistical.VAR.S;\nexports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);\nexports.WEIBULLDIST = statistical.WEIBULL.DIST;\nexports.WORKDAYINTL = dateTime.WORKDAYINTL;\nexports.ZTEST = statistical.Z.TEST;\n//XW: _XLFN开头函数处理\nexports._XLFN = set(mathTrig.FLOOR.MATH, statistical.COVARIANCE.P, statistical.NORM.INV, statistical.VAR.P)\n// exports._XLFN.FLOOR = mathTrig.FLOOR\n// exports._XLFN.COVARIANCE = statistical.COVARIANCE\n// exports._XLFN.NORM = statistical.NORM\n// exports._XLFN.VAR = statistical.VAR\n//XW：end","var defaultOperator = '=';\nvar validSymbols = ['>', '>=', '<', '<=', '=', '<>'];\nvar TOKEN_TYPE_OPERATOR = 'operator';\nvar TOKEN_TYPE_LITERAL = 'literal';\nvar SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];\n\nexports.TOKEN_TYPE_OPERATOR = TOKEN_TYPE_OPERATOR;\nexports.TOKEN_TYPE_LITERAL = TOKEN_TYPE_LITERAL;\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @return {Object}\n */\nfunction createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type);\n  }\n\n  return {\n    value: value,\n    type: type,\n  };\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @return {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);\n  }\n\n  return value;\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @return {String[]}\n */\nfunction tokenizeExpression(expression) {\n  var expressionLength = expression.length;\n  var tokens = [];\n  var cursorIndex = 0;\n  var processedValue = '';\n  var processedSymbol = '';\n\n  while (cursorIndex < expressionLength) {\n    var char = expression.charAt(cursorIndex);\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char;\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue);\n          processedValue = '';\n        }\n        break;\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol);\n          processedSymbol = '';\n        }\n\n        processedValue = processedValue + char;\n        break;\n    }\n    cursorIndex++;\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue);\n  }\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol);\n  }\n\n  return tokens;\n};\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @return {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  var literalValue = '';\n  var analyzedTokens = [];\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));\n    } else {\n      literalValue += token;\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));\n  }\n\n  return analyzedTokens;\n};\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @return {Boolean}\n */\nfunction computeExpression(tokens) {\n  var values = [];\n  var operator;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value;\n        break;\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value);\n        break;\n    }\n  }\n\n  return evaluate(values, operator);\n};\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @return {Boolean}\n */\nfunction evaluate(values, operator) {\n  var result = false;\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1];\n      break;\n    case '>=':\n      result = values[0] >= values[1];\n      break;\n    case '<':\n      result = values[0] < values[1];\n      break;\n    case '<=':\n      result = values[0] <= values[1];\n      break;\n    case '=':\n      result = values[0] == values[1];\n      break;\n    case '<>':\n      result = values[0] != values[1];\n      break;\n  }\n\n  return result;\n}\n\nexports.parse = function(expression) {\n  return analyzeTokens(tokenizeExpression(expression));\n};\nexports.createToken = createToken;\nexports.compute = computeExpression;","var error = require('./error');\nvar stats = require('./statistical');\nvar maths = require('./math-trig');\nvar utils = require('./utils');\n\nfunction compact(array) {\n  if (!array) { return array; }\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    if (!array[i]) { continue; }\n    result.push(array[i]);\n  }\n  return result;\n}\n\nexports.FINDFIELD = function(database, title) {\n  var index = null;\n  for (var i = 0; i < database.length; i++) {\n    if (database[i][0] === title) {\n      index = i;\n      break;\n    }\n  }\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value;\n  }\n  return index;\n};\n\n//XW: 重写函数\nfunction find_result_idx(database, criteria){\n  var valid_arr = []\n  var filter_arr = []\n  for (var i=0; i < criteria[0].length; i++) {\n    filter_arr.push(criteria[0][i])\n  }\n  for (var i=1; i < criteria.length; i++){\n    var arr = criteria[i]\n    var valid_str = []\n    for (var j=0; j < filter_arr.length; j++){\n      if (arr[j] != null){\n        valid_str.push(database[0].indexOf(criteria[0][j]) + '-' + arr[j])\n      }\n    }\n    valid_arr.push(valid_str)\n  }\n  var result_idx = []\n  for (var i=1; i < database.length; i++){\n    var data = database[i]\n    for(var j=0;j<valid_arr.length;j++){\n      var is_valid = true\n      for(var k=0;k<valid_arr[j].length;k++){\n        var a = data[parseInt(valid_arr[j][k].split('-')[0])]\n        var b = valid_arr[j][k].split('-')[1]\n        if (b.indexOf('=') >= 0){\n          is_valid = (a == b.replace('=', ''))\n        }else if(!eval(a+b)){\n          is_valid = false\n        }\n      }\n      if(is_valid){\n        result_idx.push(i)\n      }\n    }\n  }\n  return result_idx\n}\nfunction get_values(resultIndexes, database, field){\n  if (typeof field == 'number'){\n    var field_idx = field - 1\n  }else{\n    var field_idx = database[0].indexOf(field)\n  }\n  var values= []\n  for (var i=0; i< resultIndexes.length; i++){\n    values.push(database[resultIndexes[i]][field_idx])\n  }\n  return values\n}\n// Database functions\nexports.DAVERAGE = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  if (typeof field == 'number'){\n    var resultIndexes = [];\n    for (var i=1;i<database.length;i++){\n      resultIndexes.push(i)\n    }\n  }else{\n    var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  var sum = 0\n  for (var i=0; i < targetValues.length; i++){\n    sum += targetValues[i]\n  }\n  return resultIndexes.length === 0 ? error.div0 : sum / targetValues.length;\n};\nexports.DCOUNT = function(database, field, criteria) {\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNT(targetValues);\n};\n\nexports.DCOUNTA = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNTA(targetValues);\n};\n\nexports.DGET = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  if (resultIndexes.length > 1){\n    return error.num\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  return targetValues[0];\n};\n\nexports.DMAX = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var max = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] > max){\n      max = targetValues[i]\n    }\n  }\n  return max\n};\n\nexports.DMIN = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var min = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] < min){\n      min = targetValues[i]\n    }\n  }\n  return min\n};\n\nexports.DPRODUCT = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var result = 1;\n  for (var i=0; i < targetValues.length; i++){\n    result *= targetValues[i]\n  }\n  return result;\n};\n\nexports.DSTDEV = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.S(targetValues);\n};\n\nexports.DSTDEVP = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.P(targetValues);\n};\n\nexports.DSUM = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return maths.SUM(targetValues);\n};\n\nexports.DVAR = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.S(targetValues);\n};\n\nexports.DVARP = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.P(targetValues);\n};\n//XW：end\n","var error = require('./error');\nvar utils = require('./utils');\nvar information = require('./information');\n\nexports.AND = function() {\n  var args = utils.flatten(arguments);\n  var result = true;\n  for (var i = 0; i < args.length; i++) {\n    if (!args[i]) {\n      result = false;\n    }\n  }\n  return result;\n};\n\nexports.CHOOSE = function() {\n  if (arguments.length < 2) {\n    return error.na;\n  }\n\n  var index = arguments[0];\n  if (index < 1 || index > 254) {\n    return error.value;\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value;\n  }\n\n  return arguments[index];\n};\n\nexports.FALSE = function() {\n  return false;\n};\n\nexports.IF = function(test, then_value, otherwise_value) {\n  return test ? then_value : otherwise_value;\n};\n\nexports.IFERROR = function(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError;\n  }\n  return value;\n};\n\nexports.IFNA = function(value, value_if_na) {\n  return value === error.na ? value_if_na : value;\n};\n\nexports.NOT = function(logical) {\n  return !logical;\n};\n\nexports.OR = function() {\n  var args = utils.flatten(arguments);\n  var result = false;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result = true;\n    }\n  }\n  return result;\n};\n\nexports.TRUE = function() {\n  return true;\n};\n\nexports.XOR = function() {\n  var args = utils.flatten(arguments);\n  var result = 0;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result++;\n    }\n  }\n  return (Math.floor(Math.abs(result)) & 1) ? true : false;\n};\n\nexports.SWITCH = function () {\n  var result;\n  if (arguments.length > 0) {\n    var targetValue = arguments[0];\n    var argc = arguments.length - 1;\n    var switchCount = Math.floor(argc / 2);\n    var switchSatisfied = false;\n    var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n    if (switchCount) {\n      for (var index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2];\n          switchSatisfied = true;\n          break;\n        }\n      }\n    }\n\n    if (!switchSatisfied && defaultClause) {\n      result = defaultClause;\n    }\n  }\n  if (result == undefined){\n    return error.na\n  }\n  return result;\n};\n","var error = require('./error');\nvar dateTime = require('./date-time');\nvar utils = require('./utils');\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime());\n}\n\nfunction ensureDate(d) {\n  return (d instanceof Date)?d:new Date(d);\n}\n\nexports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\n  if (typeof issue=='string'){\n    issue = utils.parseDate(issue)\n  }\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    first = utils.ExcelDateToJSDate(first);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value;\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n};\n\n// XW: ACCRINTM函数\nexports.ACCRINTM = function(issue, settlement, rate, par, basis) {\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  var result = par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n  if (isNaN(result)){\n    return error.value;\n  }else{\n    return result\n  }\n};\n//XW: end\n\n// TODO\n//XW: 待实现\nexports.AMORDEGRC = function (cost, date_purchased, first_period, salvage, period, rate, basis) {\n  if (!validDate(issue) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n};\n\n// TODO\nexports.AMORLINC = function() {\n throw new Error('AMORLINC is not implemented');\n};\n\n// TODO\nexports.COUPDAYBS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement >= maturity) {\n    return error.num;\n  }\n};\n\nexports.COUPDAYS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPDAYSNC = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.numerror.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNUM = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPPCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n//XW：end\n\nexports.CUMIPMT = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  // Requires exports.FV() and exports.PMT() from exports.js [http://stoic.com/exports/]\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative interest\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var interest = 0;\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value;\n      start++;\n    }\n  }\n\n  for (var i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n    } else {\n      interest += exports.FV(rate, i - 1, payment, value, 0);\n    }\n  }\n  interest *= rate;\n\n  // Return cumulative interest\n  return interest;\n};\n\nexports.CUMPRINC = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative principal\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var principal = 0;\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate;\n    } else {\n      principal = payment;\n    }\n    start++;\n  }\n  for (var i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n    } else {\n      principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n    }\n  }\n\n  // Return cumulative principal\n  return principal;\n};\n\nexports.DB = function(cost, salvage, life, period, month) {\n  // Initialize month\n  month = (month === undefined) ? 12 : month;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  month = utils.parseNumber(month);\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num;\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Rate is rounded to three decimals places\n  var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\n\n  // Compute initial depreciation\n  var initial = cost * rate * month / 12;\n\n  // Compute total depreciation\n  var total = initial;\n  var current = 0;\n  var ceiling = (period === life) ? life - 1 : period;\n  for (var i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate;\n    total += current;\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial;\n  } else if (period === life) {\n    // Last period\n    return (cost - total) * rate;\n  } else {\n    return current;\n  }\n};\n\nexports.DDB = function(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = (factor === undefined) ? 2 : factor;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  factor = utils.parseNumber(factor);\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Compute depreciation\n  var total = 0;\n  var current = 0;\n  for (var i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\n    total += current;\n  }\n\n  // Return depreciation\n  return current;\n};\n\n// TODO\nexports.DISC = function (settlement,maturity,pr,redemption,basis) {\n  if (pr<=0 || redemption<=0){\n    return error.num\n  }\n  if (basis<0 || basis >4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 360\n  var DSM = Math.abs(dateTime.DAYS(maturity, settlement, false))\n  return (redemption-pr)/pr * B /DSM\n};\n\nexports.DOLLARDE = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\n\n  // Round result\n  var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n  result = Math.round(result * power) / power;\n\n  // Return converted dollar price\n  return result;\n};\n\nexports.DOLLARFR = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\n\n  // Return converted dollar price\n  return result;\n};\n\n// TODO\n//XW：待实现\nexports.DURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n};\n//XW：end\n\nexports.EFFECT = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1;\n};\n\nexports.FV = function(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  value = value || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  value = utils.parseNumber(value);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value;\n  }\n\n  // Return future value\n  var result;\n  if (rate === 0) {\n    result = value + payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = value * term + payment * (1 + rate) * (term - 1) / rate;\n    } else {\n      result = value * term + payment * (term - 1) / rate;\n    }\n  }\n  return -result;\n};\n\nexports.FVSCHEDULE = function (principal, schedule) {\n  principal = utils.parseNumber(principal);\n  if (typeof schedule === 'string'){\n    schedule = utils.strToMatrix(schedule)\n  }\n  schedule = utils.parseNumberArray(utils.flatten(schedule));\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value;\n  }\n\n  var n = schedule.length;\n  var future = principal;\n\n  // Apply all interests in schedule\n  for (var i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i];\n  }\n\n  // Return future value\n  return future;\n};\n\n// XW：INTRATE实现\nexports.INTRATE = function (settlement, maturity, investment, redemption, basis) {\n  //https://support.office.com/zh-cn/article/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f\n  if (investment<=0 || redemption<=0){\n    return error.value\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 1//一年之中的天数，取决于年基准数。\n  var DIM = 2// 结算日与到期日之间的天数。\n  return (redemption-investment)/investment *(B/DIM)\n};\n//XW：end\n\nexports.IPMT = function(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Compute payment\n  var payment = exports.PMT(rate, periods, present, future, type);\n\n  // Compute interest\n  var interest;\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0;\n    } else {\n      interest = -present;\n    }\n  } else {\n    if (type === 1) {\n      interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n    } else {\n      interest = exports.FV(rate, period - 1, payment, present, 0);\n    }\n  }\n\n  // Return interest\n  return interest * rate;\n};\n\nexports.IRR = function(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  guess = guess || 0;\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = (dates[i] - dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  var dates = [];\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = (guess === undefined) ? 0.1 : guess;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.ISPMT = function(rate, period, periods, value) {\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value;\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1);\n};\n\n// XW：待实现\nexports.MDURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  if (coupon < 0 || yld < 0){\n    return error.num\n  }\n  if (basis < 0 || basis > 4){\n    return error.num\n  }\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n};\n//xW:end\n\nexports.MIRR = function(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values));\n  finance_rate = utils.parseNumber(finance_rate);\n  reinvest_rate = utils.parseNumber(reinvest_rate);\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value;\n  }\n\n  // Initialize number of values\n  var n = values.length;\n\n  // Lookup payments (negative values) and incomes (positive values)\n  var payments = [];\n  var incomes = [];\n  for (var i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i]);\n    } else {\n      incomes.push(values[i]);\n    }\n  }\n\n  // Return modified internal rate of return\n  var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n  var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n  return Math.pow(num / den, 1 / (n - 1)) - 1;\n};\n\nexports.NOMINAL = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n};\n\nexports.NPER = function(rate, payment, present, future, type) {\n  type = (type === undefined) ? 0 : type;\n  future = (future === undefined) ? 0 : future;\n\n  rate = utils.parseNumber(rate);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value;\n  }\n\n  // Return number of periods\n  var num = payment * (1 + rate * type) - future * rate;\n  var den = (present * rate + payment * (1 + rate * type));\n  return Math.log(num / den) / Math.log(1 + rate);\n};\n\nexports.NPV = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n\n  // Lookup rate\n  var rate = args[0];\n\n  // Initialize net present value\n  var value = 0;\n\n  // Loop on all values\n  for (var j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j);\n  }\n\n  // Return net present value\n  return value;\n};\n\n// XW:待实现\nexports.ODDFPRICE = function() {\n throw new Error('ODDFPRICE is not implemented');\n};\n\n// TODO\nexports.ODDFYIELD = function() {\n throw new Error('ODDFYIELD is not implemented');\n};\n\n// TODO\nexports.ODDLPRICE = function() {\n throw new Error('ODDLPRICE is not implemented');\n};\n\n// TODO\nexports.ODDLYIELD = function() {\n throw new Error('ODDLYIELD is not implemented');\n};\n//XW：end\nexports.PDURATION = function(rate, present, future) {\n  rate = utils.parseNumber(rate);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num;\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n};\n\nexports.PMT = function(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Return payment\n  var result;\n  if (rate === 0) {\n    result = (present + future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n    } else {\n      result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n    }\n  }\n  return -result;\n};\n\nexports.PPMT = function(rate, period, periods, present, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n};\n//XW：函数实现\nexports.PRICE = function (settlement, maturity, rate, yld, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEDISC = function (settlement, maturity, discount, redemption, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEMAT = function (settlement, maturity, issue, rate, yld, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  issue = utils.parseDate(issue);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var dsm = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  var dim = Math.abs(dateTime.DAYS(maturity, issue, false))\n  var B = 360\n  var A = Math.abs(dateTime.DAYS(issue, settlement, false))\n  var result = (100 + ((dim/B)*rate*100))/(1+(dsm/B)*yld)-(A/B)*rate*100\n  return result\n};\n//XW：end\nexports.PV = function(rate, periods, payment, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value;\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future;\n  } else {\n    return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n  }\n};\n\nexports.RATE = function(periods, payment, present, future, type, guess) {\n  // Credits: rabugento\n\n  guess = (guess === undefined) ? 0.01 : guess;\n  future = (future === undefined) ? 0 : future;\n  type = (type === undefined) ? 0 : type;\n\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value;\n  }\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-6;\n\n  // Set maximum number of iterations\n  var iterMax = 100;\n  var iter = 0;\n  var close = false;\n  var rate = guess;\n\n  while (iter < iterMax && !close) {\n    var t1 = Math.pow(rate + 1, periods);\n    var t2 = Math.pow(rate + 1, periods - 1);\n\n    var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n    var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\n    var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n\n    var newRate = rate - f1 / (f2 + f3);\n\n    if (Math.abs(newRate - rate) < epsMax) close = true;\n    iter++\n    rate = newRate;\n  }\n\n  if (!close) return Number.NaN + rate;\n  return rate;\n};\n//XW：函数实现\nexports.RECEIVED = function (settlement, maturity, investment, discount, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (investment <= 0 || discount <= 0){\n    return error.na\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return investment/(1-(discount*day/360))\n};\n//XW：end\n\nexports.RRI = function(periods, present, future) {\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value;\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num;\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1;\n};\n\nexports.SLN = function(cost, salvage, life) {\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life;\n};\n\nexports.SYD = function(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num;\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10);\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\n};\n\nexports.TBILLEQ = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));\n};\n\nexports.TBILLPRICE = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);\n};\n\nexports.TBILLYIELD = function(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  price = utils.parseNumber(price);\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value;\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));\n};\n\n// XW：待实现\nexports.VDB = function() {\n throw new Error('VDB is not implemented');\n};\n//XW：end\n\n\nexports.XIRR = function(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = dateTime.DAYS(dates[i], dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Check that values contains at least one positive value and one negative value\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.XNPV = function(rate, values, dates) {\n  rate = utils.parseNumber(rate);\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value;\n  }\n\n  var result = 0;\n  for (var i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);\n  }\n  return result;\n};\n\n// XW：待实现\nexports.YIELD = function (settlement, maturity, rate, pr, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if(rate <= 0){\n    return error.num;\n  }\n  // Return error if price is lower than or equal to zero\n  if (pr <= 0) {\n    return error.num;\n  }\n  if (redemption <= 0){\n    return error.num\n  }\n  // Return error if settlement is greater than maturity\n  if (settlement >= maturity  ) {\n    return error.num;\n  }\n  var A = Math.abs(dateTime.DAYS(settlement, maturity, false))\n\n};\n\n\n// TODO\nexports.YIELDDISC = function() {\n throw new Error('YIELDDISC is not implemented');\n};\n\n// TODO\nexports.YIELDMAT = function() {\n throw new Error('YIELDMAT is not implemented');\n};\n//XW：end","var error = require('./error');\nvar utils = require('./utils');\nfunction match_less_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] < lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] > indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\n\nfunction match_exactly_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    lookupValue = lookupValue.replace(/\\?/g, '.');\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1\n        && typeof matrix[idx][0] === 'string') {\n        if (matrix[idx][0].toLowerCase() === lookupValue.toLowerCase()) {\n          return idx + 1;\n        }\n      }\n    } else if (typeof matrix[idx] === 'string') {\n      if (matrix[idx].toLowerCase() === lookupValue.toLowerCase()) {\n        return idx + 1;\n      }\n    }\n\n  }\n  return error.na;\n}\n\nfunction match_exactly_non_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1) {\n        if (matrix[idx][0] === lookupValue) {\n          return idx + 1;\n        }\n      }\n    } else if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    }\n  }\n  //XW:统一错误变量\n  return error.na;\n  //XW：end\n}\n\nfunction match_greater_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] > lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] < indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\nexports.MATCH = function (lookupValue, matrix, matchType) {\n  if (Array.isArray(matrix)\n    && matrix.length === 1\n    && Array.isArray(matrix[0])) {\n    matrix = matrix[0];\n  }\n  if (!lookupValue && !matrix) {\n    return error.na;\n  }\n  if (arguments.length === 2) {\n    matchType = 1;\n  }\n  if (!(matrix instanceof Array)) {\n    return error.na;\n  }\n  if (matchType === 0) {\n    if (typeof lookupValue === 'string') {\n      return match_exactly_string(matrix, lookupValue);\n    } else {\n      return match_exactly_non_string(matrix, lookupValue);\n    }\n  } else if (matchType === 1) {\n    return match_less_than_or_equal(matrix, lookupValue);\n  } else if (matchType === -1) {\n    var a = matrix[0][0]\n    for (var i=1;i<matrix.length;i++){\n      if (matrix[i][0] > a){\n        return error.na;\n      }\n    }\n    return match_greater_than_or_equal(matrix, lookupValue);\n  } else {\n    return error.na;\n  }\n}\n//XW: vlookup函数实现\nexports.VLOOKUP = function (key, matrix, return_index, cumulative) {\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value;\n  }\n  if (cumulative == 'FALSE') {\n    cumulative = false\n  }else{\n    cumulative = true\n  }\n  for (var i = 0; i < matrix.length; i++) {\n    if (matrix[i][0] == key) {\n      return matrix[i][return_index - 1];\n    }\n  }\n  return error.na;\n};\n//XW：end\n\n\n//XW:hlookup函数实现\nexports.HLOOKUP = function (needle, table, index, exactmatch) {\n  if (exactmatch == 'TRUE'){\n    exactmatch = true\n  }\n  if (exactmatch == 'FALSE'){\n    exactmatch = false\n  }\n  if (typeof table == 'string' && table.indexOf('{') >=0){\n    table = utils.strToMatrix(table)\n  }\n  if (typeof needle === \"undefined\" || table[0].indexOf(needle) < 0) {\n    return error.na;\n  }\n\n  index = index || 0;\n  let row = table[0];\n\n  for (let i = 0; i < row.length; i++) {\n    if (exactmatch && row[i] === needle || row[i].toString().toLowerCase().indexOf(needle.toString().toLowerCase()) !== -1) {\n      return index < table.length + 1 ? table[index - 1][i] : table[0][i];\n    }\n  }\n\n  return error.na;\n}\n//XW：end\n","var error = require('./error');\n//XW: 自定义函数\nexports.PQUERY = function () {\n  if (arguments.length !== 5) {\n    return error.error;\n  }\n\n  if (arguments[0].length !== arguments[1].length) {\n    return error.error;\n  }\n\n  if (arguments[1].length !== arguments[3].length) {\n    return error.error;\n  }\n\n  // 计算出绝对值\n  let absArr = [];\n  let o1 = arguments[4];\n  for (let i = 0; i < arguments[3].length; i++) {\n    arguments[3][i] = parseFloat(arguments[3][i]);\n    if (!isNaN(arguments[3][i])) {\n      absArr.push({\n        number: i,\n        value: Math.abs(arguments[3][i] - o1)\n      });\n    }\n  }\n  absArr = absArr.sort((obj1, obj2) => {\n    var val1 = obj1.value;\n    var val2 = obj2.value;\n    if (val1 < val2) {\n      return -1;\n    } else if (val1 > val2) {\n      return 1;\n    } else {\n      return 0;\n    }\n  });\n\n\n  let items = [];\n  let count = 1;\n  for (let i = 0; i < absArr.length; i++) {\n    let {number, value} = absArr[i];\n    let a1 = arguments[0][number][0];\n    let a2 = arguments[1][number][0];\n    let a4 = arguments[3][number];\n\n    if (a2 === arguments[2]) {\n      items.push({\n        number: count,\n        name: a1,\n        city: a2,\n        area: a4,\n        value: value\n      });\n      count = count + 1;\n    }\n  }\n\n  return '*悬浮查看*!' + JSON.stringify(items);\n};\n\nexports.HYPERLINK = function () {\n  console.log(arguments);\n  if (!arguments || !arguments[0] || !arguments[1]) {\n    return error.na;\n  }\n  let url = arguments[0];\n  if (url.substr(0, 7).toLowerCase() == \"http://\" || url.substr(0, 8).toLowerCase() == \"https://\") {\n    url = url;\n  } else {\n    url = \"http://\" + url;\n  }\n\n  let cell = {\n    \"text\": arguments[1],\n    \"url\": url\n  }\n  return \"*HYPERLINK*!\" + JSON.stringify(cell) + \" \";\n}\n\nfunction City(name, type, url) {\n  this.name = name;\n  this.type = type;\n  this.url = url;\n}\n\nfunction lianJiaUrl(lianjia) {\n  lianjia.push(new City(\"合肥\", 0, \"https://hf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"安庆\", 0, \"https://aq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"滁州\", 0, \"https://cz.fang.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"马鞍山\", 0, \"https://mas.lianjia.com/ditu\"));\n  lianjia.push(new City(\"北京\", 0, \"https://bj.lianjia.com/ditu\"));\n  lianjia.push(new City(\"重庆\", 0, \"https://cq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"福州\", 0, \"https://fz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"泉州\", 0, \"https://quanzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"厦门\", 0, \"https://xm.lianjia.com/ditu\"));\n  lianjia.push(new City(\"漳州\", 0, \"https://zhangzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"东莞\", 0, \"https://dg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"佛山\", 0, \"https://fs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"广州\", 0, \"https://gz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"惠州\", 0, \"https://hui.lianjia.com/ditu\"));\n  lianjia.push(new City(\"江门\", 0, \"https://jiangmen.lianjia.com/ditu\"));\n  lianjia.push(new City(\"清远\", 0, \"https://qy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"深圳\", 0, \"https://sz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"珠海\", 0, \"https://zh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湛江\", 0, \"https://zhanjiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"中山\", 0, \"https://zs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"贵阳\", 0, \"https://gy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"北海\", 0, \"https://bh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"防城港\", 0, \"https://fcg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"桂林\", 0, \"https://gl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"柳州\", 0, \"https://liuzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南宁\", 0, \"https://nn.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"兰州\", 0, \"https://lz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"鄂州\", 0, \"https://ez.lianjia.com/ditu\"));\n  lianjia.push(new City(\"黄石\", 0, \"https://huangshi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"武汉\", 0, \"https://wh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"襄阳\", 0, \"https://xy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宜昌\", 0, \"https://yichang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长沙\", 0, \"https://cs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"常德\", 0, \"https://changde.lianjia.com/ditu\"));\n  lianjia.push(new City(\"岳阳\", 0, \"https://yy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"株洲\", 0, \"https://zhuzhou.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保定\", 0, \"https://bd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"廊坊\", 0, \"https://lf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"秦皇岛\", 0, \"https://qhd.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"石家庄\", 0, \"https://sjz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"唐山\", 0, \"https://ts.lianjia.com/ditu\"));\n  lianjia.push(new City(\"张家口\", 0, \"https://zjk.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保亭\", 0, \"https://bt.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"澄迈\", 0, \"https://cm.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"儋州\", 0, \"https://dz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"海口\", 0, \"https://hk.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临高\", 0, \"https://lg.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐东\", 0, \"https://ld.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"陵水\", 0, \"https://ls.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"琼海\", 0, \"https://qh.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"三亚\", 0, \"https://san.lianjia.com/ditu\"));\n  lianjia.push(new City(\"五指山\", 0, \"https://wzs.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"文昌\", 0, \"https://wc.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"万宁\", 0, \"https://wn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"开封\", 0, \"https://kf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"洛阳\", 0, \"https://luoyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"新乡\", 0, \"https://xinxiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"许昌\", 0, \"https://xc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"郑州\", 0, \"https://zz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"哈尔滨\", 0, \"https://kf.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"常州\", 0, \"https://changzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淮安\", 0, \"https://ha.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆山\", 0, \"https://ks.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南京\", 0, \"https://nj.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"南通\", 0, \"https://nt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"苏州\", 0, \"https://su.lianjia.com/ditu\"));\n  lianjia.push(new City(\"无锡\", 0, \"https://wx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"徐州\", 0, \"https://xz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"盐城\", 0, \"https://yc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"镇江\", 0, \"https://zj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长春\", 0, \"https://cc.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"吉林\", 0, \"https://jl.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"赣州\", 0, \"https://ganzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"九江\", 0, \"https://jiujiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"吉安\", 0, \"https://jian.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南昌\", 0, \"https://nc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"上饶\", 0, \"https://sr.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大连\", 0, \"https://dl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"丹东\", 0, \"https://dd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"沈阳\", 0, \"https://sy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"呼和浩特\", 0, \"https://hhht.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"上海\", 0, \"https://sh.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"成都\", 0, \"https://cd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"德阳\", 0, \"https://dy.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"达州\", 0, \"https://dazhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐山\", 0, \"https://leshan.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"凉山\", 0, \"https://liangshan.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绵阳\", 0, \"https://mianyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"眉山\", 0, \"https://ms.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南充\", 0, \"https://nanchong.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"济南\", 0, \"https://jn.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临沂\", 0, \"https://linyi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"青岛\", 0, \"https://qd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"潍坊\", 0, \"https://wf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"威海\", 0, \"https://weihai.lianjia.com/ditu\"));\n  lianjia.push(new City(\"烟台\", 0, \"https://yt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淄博\", 0, \"https://zb.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"宝鸡\", 0, \"https://baoji.lianjia.com/ditu\"));\n  lianjia.push(new City(\"汉中\", 0, \"https://hanzhong.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西安\", 0, \"https://xa.lianjia.com/ditu\"));\n  lianjia.push(new City(\"咸阳\", 0, \"https://xianyang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"晋中\", 0, \"https://jz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"太原\", 0, \"https://ty.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"天津\", 0, \"https://tj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大理\", 0, \"https://dali.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆明\", 0, \"https://km.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西双版纳\", 0, \"https://xsbn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"杭州\", 0, \"https://hz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湖州\", 0, \"https://huzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"嘉兴\", 0, \"https://jx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"金华\", 0, \"https://jh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宁波\", 0, \"https://nb.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绍兴\", 0, \"https://sx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"台州\", 0, \"https://taizhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"温州\", 0, \"https://wz.lianjia.comditu\"));\n}\n\nfunction woaiwojiaUrl(woaiwojia) {\n  woaiwojia.push(new City(\"北京\", 0, \"https://bj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"杭州\", 0, \"https://hz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"青岛\", 0, \"https://qd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"天津\", 0, \"https://tj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"太原\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"郑州\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"成都\", 0, \"https://cd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"长沙\", 0, \"https://cs.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南昌\", 0, \"https://nc.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南京\", 0, \"https://nj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南宁\", 0, \"https://nn.5i5j.com/map\"));\n  woaiwojia.push(new City(\"上海\", 0, \"https://sh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"苏州\", 0, \"https://sz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"武汉\", 0, \"https://wh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"无锡\", 0, \"https://wx.5i5j.com/map\"));\n}\n\nfunction fangtianxiaUrl(fangtianxia) {\n  fangtianxia.push(new City(\"全国\", 0, \"https://www1.fang.com\"));\n}\n\nfunction find(name, arr, str = true) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i].name === name || (typeof name === 'string' && str === false)) {\n      let {url} = arr[i];\n      return url;\n    }\n  }\n\n  return \"城市未找到\";\n}\n\nlet lianjia = [];\nlianJiaUrl(lianjia);\nlet woaiwojia = [];\nwoaiwojiaUrl(woaiwojia);\nlet fangtianxia = [];\nfangtianxiaUrl(fangtianxia);","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    try {\n        var value = cell_ref.calc();\n        if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n            return onerrorvalue.calc();\n        }\n        return value;\n    } catch(e) {\n        return onerrorvalue.calc();\n    }\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition.calc()) {\n        return _then.calc();\n    }\n    else {\n        return _else.calc();\n    }\n}\n\nfunction and() {\n    for (var i = 0; i < arguments.length; i++) {\n        if(!arguments[i].calc()) return false;\n    }\n    return true;\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror,\n    'IF': _if,\n    'AND': and\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst str_2_val = require('./str_2_val.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator { // 这个应该是对重对外暴露的类。\n\n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        this.formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = this.formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(this.formulas[i]);\n            this.expressions.push(exp);\n        }\n        this.calcNames();\n    }\n\n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n\n    getVars() {\n        let vars = {};\n        for (let k in this.variables) {\n            vars[k] = this.variables[k].calc();\n        }\n        return vars;\n    }\n\n    calcNames() {\n        if (!this.workbook || !this.workbook.Workbook || !this.workbook.Workbook.Names) {\n            return;\n        }\n        this.workbook.Workbook.Names.forEach(item => {\n            let val = this.getRef(item.Ref);\n            this.variables[item.Name] = val;\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, item.Name);\n            });\n        });\n    }\n\n    getRef(ref_name) {\n        if (!this.formulas.length) {\n            throw new Error(\"No formula found.\");\n        }\n        let first_formula = this.formulas[0];\n        let formula_ref = first_formula.formula_ref;\n        let formula = {\n            formula_ref: formula_ref,\n            wb: this.workbook,\n            exec_formula: this.exec_formula\n        };\n        return str_2_val(ref_name, formula);\n    }\n\n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n\n    execute() {\n        this.expressions.forEach(exp => {\n            exp.update_cell_value();\n        });\n    }\n}\n\nmodule.exports = Calculator;\n","const checker = require('./formula_check.js');\nconst error = require('./formulajs/lib/error');\nclass CalcCell { // 对cell中的参数做转换，判断,多单元格处理等的类\n  constructor(formulas_i, rows) {\n    this.cell = formulas_i.cell\n    this.rows = rows\n    this.f = formulas_i.cell.f\n    this.name = formulas_i.name\n    this.sheet = formulas_i.sheet\n  }\n\n  //检测是否合法\n  check_valid() {\n    var text = this.f\n    //==A1报错\n    if (text[1] === '='){\n      return error.name\n    }\n    var params = text.match('=[a-z|A-Z]{2,100}')\n    if (params != null && this.f.indexOf('(') <0 && this.f.indexOf(')')<0){\n      return error.name\n    }\n    // 处理\"\" 中\"\"的转义\n    if (this.f.indexOf('\"\"') >= 1 && this.f.indexOf('(') < 0 && this.f.indexOf(')') < 0) {\n      return this.f.slice(2, this.f.length - 1).replace('\"\"', '\"')\n    }\n    return true\n  }\n\n  //{}用''包起来\n  trans_params(fml) {\n    var reg = new RegExp('\\{(.*?)\\}', 'g')\n    var arg = fml.match(reg)\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i]\n        var rep = \"'\" + param + \"'\"\n        fml = fml.replace(param, rep)\n      }\n    }\n    return fml\n  }\n\n  //参数转换\n  trans_formula() {\n    var fml = this.f\n    //去除公式开头结尾的空格\n    fml = checker.strim(fml)\n    //公式参数转换\n    fml = checker.trans_formula(fml)\n    if (fml.indexOf('{') >= 0 && fml.indexOf('}') >= 0 && fml.indexOf(\"'{\") < 0) {// XW: 大括号参数判断\n      fml = this.trans_params(fml)\n    }\n    return fml\n  }\n\n  //将公式还原成原来的样子\n  recover_formula() {\n    return checker.strim(this.f)\n  }\n}\n\nmodule.exports = CalcCell;","var exp = require(\"../core/alphabet\");\nvar error = require('./formulajs/lib/error');\n\n\nfunction isEqual(v1, v2) {\n  v1 = v1 + \"\";\n  v2 = v2 + \"\";\n  v1 = v1.toUpperCase();\n  v2 = v2.toUpperCase();\n  if (v1 === v2) {\n    return true;\n  }\n  return false;\n}\n\nfunction isHave(param) {\n  if (typeof param === \"undefined\") {\n    return false;\n  }\n  if (param === null) {\n    return false;\n  }\n  return true;\n}\nclass CalcWorkBook { // 对workbook处理的类\n  constructor(rows, tileArr) {\n    this.rows = rows\n    this.tileArr = tileArr\n  }\n\n  // 变动数据传入workbook\n  get_workbook(workbook){\n    let {data} = this.rows;\n    let name = data['name']\n    var need_calc_cells = this.tileArr.findAllNeedCalcCell()\n    for (var i=0;i<need_calc_cells.length;i++){\n      var cell_name = need_calc_cells[i]\n      var zb = exp.expr2xy(cell_name)\n      var cell = this.rows.getCell(zb[1], zb[0])\n      if(isHave(cell)){\n        workbook.Sheets[name][cell_name] = {v: cell.text, f: cell.formulas, multivalueRefsCell: cell.multivalueRefsCell, source_v: cell.source_v}\n      }\n    }\n    return workbook\n  }\n\n  //workbook填入rows\n  calcDoneToSetCells(workbook, rows) {\n    let {data} = rows;\n    let name = data['name']\n    var sheet = workbook.Sheets[name]\n    Object.keys(sheet).forEach(i => {\n      let arg = exp.expr2xy(i);\n      if (isHave(sheet[i]) && isHave(sheet[i].v) && isHave(sheet[i].f)) {\n        var cell = rows.getCell(arg[1], arg[0])\n        if (!isHave(cell)){\n          cell = {}\n        }\n        cell.text = sheet[i].v\n        cell.formulas = sheet[i].f\n        cell.multivalueRefsCell = sheet[i].multivalueRefsCell\n        if (isHave(sheet[i].source_v)){\n          cell.source_v = sheet[i].source_v\n        }\n        rows.setCell(arg[1], arg[0], cell);\n      }\n    });\n    rows.workbook = workbook\n  }\n\n  // 判断是否是多值函数的单元格\n  is_muti_cell(formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    if (multivalueRefsCell !== null) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    }\n    return isHave(multivalueRefsCell) ? true : false\n  }\n\n  //一维数组\n  process_arr(){\n\n  }\n\n\n  //二维数组\n  process_matrix(formulas_i, multivalueRefsCell){\n    let enter = true\n    var cell_v = formulas_i.cell.v\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    let cell = \"\", expr = 0;\n    var wb = formulas_i.sheet\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        var v = cell_v[i][j]\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": v,\n            \"f\": formulas_i.cell.f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          var source = this.rows.getCell( cell_y + j,  cell_x + i);\n          if (!isHave(source) || !isHave(source.text) || (isHave(source.text) && (isEqual(source.text, v) || source.text === \"\"))) {\n            wb[c] = {\n              \"v\": cell_v[i][j],\n              \"f\": cell_v[i][j],\n              'multivalueRefsCell': multivalueRefsCell\n            }\n          } else {\n            wb[c] = {\n              \"v\": source.v,\n              \"f\": source.f,\n              'multivalueRefsCell': multivalueRefsCell\n            }\n            enter = false;\n            cell = source;\n            expr = c;\n          }\n        }\n      }\n    }\n    if(!enter) {\n      return this.clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr)\n    }else{\n      return wb\n    }\n  }\n\n\n  //清除二维数组标记\n  clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr){\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": error.ref,\n            \"f\": wb[c].f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else if (expr === c) {\n          wb[c] = {\n            \"v\": cell.text,\n            \"f\": cell.formulas,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n  //如果多值原始单元格发生变动，清除所有该多值函数生成的单元格中的标记\n  clean_all_flag(formulas_i, multivalueRefsCell){\n    var wb = formulas_i.sheet\n    var zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = zb[0]\n    var cell_y = zb[1]\n    var cell = this.rows.getCell(zb[1], zb[0])\n    var cell_v = cell.source_v\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": formulas_i.cell.v,\n            \"f\": formulas_i.cell.f,\n            \"source_v\": \"\"\n          }\n        } else if (this.rows.getCell(cell_y + j, cell_x + i).text !== cell_v[i][j]) {\n          wb[c] = {\n            \"v\": this.rows.getCell(cell_y + j, cell_x + i).text,\n            \"f\": this.rows.getCell(cell_y + j, cell_x + i).formulas,\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n\n  //处理多值函数单元格\n  deal_muti_cell(workbook, formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    let {data} = this.rows;\n    let name = data['name']\n    if (isHave(multivalueRefsCell) && isHave(multivalueRefsCell.multivalueRefsCell)) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    } else {\n      multivalueRefsCell = formulas_i.name;\n    }\n    var cell_v = formulas_i.cell.v\n    if (formulas_i.name !== multivalueRefsCell){\n      if (cell_v instanceof Array){\n        workbook.Sheets[name][formulas_i.name].v = error.ref\n        workbook.Sheets[name][formulas_i.name].source_v = cell_v\n      }else if(isHave(cell_v)){\n        workbook.Sheets[name][formulas_i.name].v = cell_v\n      }\n    }else {\n      if(!(cell_v instanceof Array)) {\n        workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n      }else{\n        var zb = exp.expr2xy(multivalueRefsCell)\n        if (isHave(this.rows.getCell(zb[1], zb[0]).source_v) && this.rows.getCell(zb[1], zb[0]).source_v !== cell_v){\n          workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n        }\n        var len = cell_v.length\n        if (len === 1){\n          workbook.Sheets[name] = this.process_arr(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }else{\n          workbook.Sheets[name] = this.process_matrix(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CalcWorkBook;","var numeric = require('numeric');\nvar utils = require('./utils');\nvar error = require('./error');\nvar statistical = require('./statistical');\nvar information = require('./information');\n\nexports.ABS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.abs(utils.parseNumber(number));\n};\n\nexports.ACOS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.acos(number);\n};\n\nexports.ACOSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number - 1));\n};\n\nexports.ACOT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(1 / number);\n};\n\nexports.ACOTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 0.5 * Math.log((number + 1) / (number - 1));\n};\n\n//TODO: use options\nexports.AGGREGATE = function(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num);\n  options = utils.parseNumber(options);\n  //XW: 函数报错\n  if (typeof ref1 == 'string') {\n    return error.value\n  }//XW:end\n  if (utils.anyIsError(function_num, options)) {\n    return error.value;\n  }\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n    case 12:\n      return statistical.MEDIAN(ref1, ref2);\n    case 13:\n      return statistical.MODE.SNGL(ref1);\n    case 14:\n      return statistical.LARGE(ref1, ref2);\n    case 15:\n      if (ref2 == undefined){\n        return error.value\n      }\n      return statistical.SMALL(ref1, ref2);\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2);\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2);\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2);\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2);\n  }\n};\n\nexports.ARABIC = function(text) {\n  // Credits: Rafa? Kukawski\n  text = text.toUpperCase()\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value;\n  }\n  var r = 0;\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i];\n  });\n  return r;\n};\n\nexports.ASIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.asin(number);\n};\n\nexports.ASINH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number + 1));\n};\n\nexports.ATAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(number);\n};\n\nexports.ATAN2 = function(number_x, number_y) {\n  number_x = utils.parseNumber(number_x);\n  number_y = utils.parseNumber(number_y);\n  if (utils.anyIsError(number_x, number_y)) {\n    return error.value;\n  }\n  return Math.atan2(number_x, number_y);\n};\n\nexports.ATANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log((1 + number) / (1 - number)) / 2;\n};\n\nexports.BASE = function(number, radix, min_length) {\n  min_length = min_length || 0;\n\n  number = utils.parseNumber(number);\n  radix = utils.parseNumber(radix);\n  min_length = utils.parseNumber(min_length);\n  if (utils.anyIsError(number, radix, min_length)) {\n    return error.value;\n  }\n  min_length = (min_length === undefined) ? 0 : min_length;\n  var result = number.toString(radix);\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n};\n\nexports.CEILING = function(number, significance, mode) {\n  significance = (significance === undefined) ? 1 : Math.abs(significance);\n  mode = mode || 0;\n\n  number = utils.parseNumber(number);\n  significance = utils.parseNumber(significance);\n  mode = utils.parseNumber(mode);\n  if (utils.anyIsError(number, significance, mode)) {\n    return error.value;\n  }\n  if (significance === 0) {\n    return 0;\n  }\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return exports.ROUND(Math.ceil(number / significance) * significance, precision);\n  } else {\n    if (mode === 0) {\n      return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n    } else {\n      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n    }\n  }\n};\n\nexports.CEILING.MATH = exports.CEILING;\n\nexports.CEILING.PRECISE = exports.CEILING;\n\nexports.COMBIN = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n};\n\nexports.COMBINA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n};\n\nexports.COS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.cos(number);\n};\n\nexports.COSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return (Math.exp(number) + Math.exp(-number)) / 2;\n};\n\nexports.COT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.tan(number);\n};\n\nexports.COTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 + 1) / (e2 - 1);\n};\n\nexports.CSC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.sin(number);\n};\n\nexports.CSCH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) - Math.exp(-number));\n};\n\nexports.DECIMAL = function(number, radix) {\n  if (arguments.length < 1) {\n    return error.value;\n  }\n\n\n  return parseInt(number, radix);\n};\n\nexports.DEGREES = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * 180 / Math.PI;\n};\n\nexports.EVEN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return exports.CEILING(number, -2, -1);\n};\n\nexports.EXP = Math.exp;\n\nvar MEMOIZED_FACT = [];\nexports.FACT = function (number) {\n  number = utils.parseNumber(number);\n  if (number < 0){\n    return error.num\n  }\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n === 0 || n === 1) {\n    return 1;\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n];\n  } else {\n    MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n    return MEMOIZED_FACT[n];\n  }\n};\n\nexports.FACTDOUBLE = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n <= 0) {\n    return 1;\n  } else {\n    return n * exports.FACTDOUBLE(n - 2);\n  }\n};\n\n//TODO: Verify\n// XW: 自己写的函数\nexports.FLOOR = {};\nvar ROUND = function (value, places) {\n  var n = value;\n  var d = places;\n  return Math.round(n * Math.pow(10, d)) / Math.pow(10, d);\n};\nexports.FLOORMATH = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number>0&&significance<0){\n    return error.num\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\nexports.FLOORPRACE = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\n\n// Deprecated\nexports.FLOOR.MATH = exports.FLOORMATH;\nexports.FLOOR.PRECISE = exports.FLOORPRACE;\n//XW: end\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexports.GCD = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var r0 = range[0];\n  var x = r0 < 0 ? -r0 : r0;\n  for (var i = 1; i < n; i++) {\n    var ri = range[i];\n    var y = ri < 0 ? -ri : ri;\n    while (x && y) {\n      if (x > y) {\n        x %= y;\n      } else {\n        y %= x;\n      }\n    }\n    x += y;\n  }\n  return x;\n};\n\n\nexports.INT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.floor(number);\n};\n\n//TODO: verify\nexports.ISO = {\n  CEILING: exports.CEILING\n};\n\nexports.LCM = function() {\n  // Credits: Jonas Raoni Soares Silva\n  var o = utils.parseNumberArray(utils.flatten(arguments));\n  if (o instanceof Error) {\n    return o;\n  }\n  for (var i, j, n, d, r = 1;\n    (n = o.pop()) !== undefined;) {\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          //empty\n        }\n        d = (i <= j) ? i : n;\n      } else {\n        d = 2;\n      }\n      for (n /= d, r *= d, i = o.length; i;\n        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        //empty\n      }\n    }\n  }\n  return r;\n};\n\nexports.LN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number);\n};\n\nexports.LOG = function (number, base) {\n  number = utils.parseNumber(number);\n  base = utils.parseNumber(base);\n  if (utils.anyIsError(base)) {\n    base = 10\n  }\n  base = (base === undefined) ? 10 : base;\n  return Math.log(number) / Math.log(base);\n};\n\nexports.LOG10 = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number) / Math.log(10);\n};\n\nexports.MDETERM = function(matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix);\n  }\n  try{\n    return numeric.det(matrix);\n  }catch (e) {\n    return error.value\n  }\n};\n\nexports.MINVERSE = function(matrix) {\n  matrix = utils.parseMatrix(matrix);\n  if (matrix instanceof Error) {\n    return matrix;\n  }\n  return numeric.inv(matrix);\n};\n\nexports.MMULT = function(matrix1, matrix2) {\n  matrix1 = utils.parseMatrix(matrix1);\n  matrix2 = utils.parseMatrix(matrix2);\n  if (utils.anyIsError(matrix1, matrix2)) {\n    return error.value;\n  }\n  console.log(numeric.dot(matrix1, matrix2))\n  return numeric.dot(matrix1, matrix2);\n};\n\nexports.MOD = function(dividend, divisor) {\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n  if (divisor === 0) {\n    return error.div0;\n  }\n  var modulus = Math.abs(dividend % divisor);\n  return (divisor > 0) ? modulus : -modulus;\n};\n\n  exports.MROUND = function(number, multiple) {\n  number = utils.parseNumber(number);\n  multiple = utils.parseNumber(multiple);\n  if (utils.anyIsError(number, multiple)) {\n    return error.value;\n  }\n  if (number * multiple < 0) {\n    return error.num;\n  }\n\n  return Math.round(number / multiple) * multiple;\n};\n\nexports.MULTINOMIAL = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var sum = 0;\n  var divisor = 1;\n  for (var i = 0; i < args.length; i++) {\n    sum += args[i];\n    divisor *= exports.FACT(args[i]);\n  }\n  return exports.FACT(sum) / divisor;\n};\n\nexports.MUNIT = function(dimension) {\n  dimension = utils.parseNumber(dimension);\n  if (dimension instanceof Error) {\n    return dimension;\n  }\n  return numeric.identity(dimension);\n};\n\nexports.ODD = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var temp = Math.ceil(Math.abs(number));\n  temp = (temp & 1) ? temp : temp + 1;\n  return (number > 0) ? temp : -temp;\n};\n\nexports.PI = function() {\n  return Math.PI;\n};\n\nexports.POWER = function(number, power) {\n  number = utils.parseNumber(number);\n  power = utils.parseNumber(power);\n  if (utils.anyIsError(number, power)) {\n    return error.value;\n  }\n  var result = Math.pow(number, power);\n  if (isNaN(result)) {\n    return error.num;\n  }\n\n  return result;\n};\n\nexports.PRODUCT = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var result = 1;\n  for (var i = 0; i < args.length; i++) {\n    result *= args[i];\n  }\n  return result;\n};\n\nexports.QUOTIENT = function(numerator, denominator) {\n  numerator = utils.parseNumber(numerator);\n  denominator = utils.parseNumber(denominator);\n  if (utils.anyIsError(numerator, denominator)) {\n    return error.value;\n  }\n  return parseInt(numerator / denominator, 10);\n};\n\nexports.RADIANS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * Math.PI / 180;\n};\n\nexports.RAND = function() {\n  if (arguments.length > 0 && arguments[0] !== undefined){\n    return error.value\n  }\n  return Math.random();\n};\n\nexports.RANDBETWEEN = function(bottom, top) {\n  bottom = utils.parseNumber(bottom);\n  top = utils.parseNumber(top);\n  if (utils.anyIsError(bottom, top)) {\n    return error.value;\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n};\n\n// TODO\nexports.ROMAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  var digits = String(number).split('');\n  var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];\n  var roman = '';\n  var i = 3;\n  while (i--) {\n    roman = (key[+digits.pop() + (i * 10)] || '') + roman;\n  }\n  return new Array(+digits.join('') + 1).join('M') + roman;\n};\n\nexports.ROUND = function (number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  if (number < 0){\n    number = 0-number\n    return 0-Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n  }\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n};\n\nexports.ROUNDDOWN = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.ROUNDUP = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.SEC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.cos(number);\n};\n\nexports.SECH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) + Math.exp(-number));\n};\n\nexports.SERIESSUM = function(x, n, m, coefficients) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  m = utils.parseNumber(m);\n  coefficients = utils.parseNumberArray(coefficients);\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value;\n  }\n  var result = coefficients[0] * Math.pow(x, n);\n  for (var i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m);\n  }\n  return result;\n};\n\nexports.SIGN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  if (number < 0) {\n    return -1;\n  } else if (number === 0) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\nexports.SIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.sin(number);\n};\n\n  exports.SINH = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return (Math.exp(number) - Math.exp(-number)) / 2;\n  };\n\n  exports.SQRT = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    if (number < 0) {\n      return error.num;\n    }\n    return Math.sqrt(number);\n  };\n\n  exports.SQRTPI = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return Math.sqrt(number * Math.PI);\n  };\n\nexports.SUBTOTAL = function(function_code, ref1) {\n  function_code = utils.parseNumber(function_code);\n  if (function_code instanceof Error) {\n    return function_code;\n  }\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n      // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1);\n    case 102:\n      return statistical.COUNT(ref1);\n    case 103:\n      return statistical.COUNTA(ref1);\n    case 104:\n      return statistical.MAX(ref1);\n    case 105:\n      return statistical.MIN(ref1);\n    case 106:\n      return exports.PRODUCT(ref1);\n    case 107:\n      return statistical.STDEV.S(ref1);\n    case 108:\n      return statistical.STDEV.P(ref1);\n    case 109:\n      return exports.SUM(ref1);\n    case 110:\n      return statistical.VAR.S(ref1);\n    case 111:\n      return statistical.VAR.P(ref1);\n\n  }\n};\n\nexports.ADD = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.name;\n  }\n\n  return num1 + num2;\n};\n\nexports.MINUS = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.value;\n  }\n\n  return num1 - num2;\n};\n\nexports.DIVIDE = function (dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n\n  if (divisor === 0) {\n    return error.div0;\n  }\n\n  return dividend / divisor;\n};\n\nexports.MULTIPLY = function (factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  factor1 = utils.parseNumber(factor1);\n  factor2 = utils.parseNumber(factor2);\n  if (utils.anyIsError(factor1, factor2)) {\n    return error.value;\n  }\n\n  return factor1 * factor2;\n};\n\nexports.GTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 >= num2;\n};\n\nexports.LT = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 < num2;\n};\n\n\nexports.LTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 <= num2;\n};\n\nexports.EQ = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 === value2;\n};\n\nexports.NE = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 !== value2;\n};\n\nexports.POW = function (base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  base = utils.parseNumber(base);\n  exponent = utils.parseNumber(exponent);\n  if (utils.anyIsError(base, exponent)) {\n    return error.error;\n  }\n\n  return exports.POWER(base, exponent);\n};\n\nexports.SUM = function() {\n  var result = 0;\n  var argsKeys = Object.keys(arguments);\n  for (var i = 0; i < argsKeys.length; ++i) {\n    var elt = arguments[argsKeys[i]];\n    if (typeof elt === 'number') {\n      result += elt;\n    } else if (typeof elt === 'string') {\n      var parsed = parseFloat(elt);\n      !isNaN(parsed) && (result += parsed);\n    } else if (Array.isArray(elt)) {\n      result += exports.SUM.apply(null, elt);\n    }\n  }\n  return result;\n};\n\nexports.SUMIF = function(range, criteria) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (range instanceof Error) {\n    return range;\n  }\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\n  }\n  return result;\n};\n//XW： SUMIFS函数\nexports.SUMIFS = function() {\n  var args = utils.argsToArray(arguments);\n  var range = utils.flatten(args.shift());\n  if (range instanceof Error) {\n    return range;\n  }\n  if (args.length % 2 !== 0) {\n    return error.value;\n  }\n  for (let i = 0; i < args.length; i += 2) {\n    if (args[i].length !== range.length || !args[i + 1]) {\n      return error.value;\n    }\n  }\n  let arr = [];\n  var result = 0;\n  for (let i = 0; i < args.length; i += 2) {\n    let s_arr = [];\n    for (let j = 0; j < args[i].length; j++) {\n      let compareValue = args[i + 1] + \"\";\n      if (compareValue.lastIndexOf(\">=\") == 0) {\n        compareValue = compareValue.replace(/>=/, \"\");\n        if (isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 <= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }else if (compareValue.lastIndexOf(\"<=\") == 0) {\n        compareValue = compareValue.replace(/<=/, \"\");\n        if(isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 >= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }\n      compareValue = compareValue.replace(\"=\", \"\");\n      if (compareValue.lastIndexOf(\"<>\") == 0) {\n        compareValue = compareValue.replace(/<>/, \"\");\n        if (compareValue !== args[i][j][0]) {\n          s_arr.push(j);\n        }\n      } else {\n        let str = false;\n        if (compareValue.lastIndexOf(\"<\") == 0) {\n          compareValue = compareValue.replace(/</, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 > args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else if (compareValue.lastIndexOf(\">\") == 0) {\n          compareValue = compareValue.replace(/>/, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 < args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else {\n          if (compareValue.indexOf('*') > 0){\n            var v = compareValue\n            v = v.replace('*', '')\n            if (typeof args[i][j][0] == 'string' && args[i][j][0].indexOf(v) >= 0){\n              s_arr.push(j);\n            }\n          }\n          if(isNaN(compareValue)) {\n            if(compareValue === args[i][j][0]) {\n              s_arr.push(j);\n            }\n          } else {\n            if(compareValue * 1 === args[i][j][0]) {\n              s_arr.push(j);\n            }\n\n          }\n        }\n        if(str) {\n          return error.value;\n        }\n      }\n\n    }\n    arr.push(s_arr);\n  }\n\n  let resultArr = [];\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = 0; j < arr[i].length; j++) {\n      let value = arr[i][j];\n      let enter = 1;\n      for (let k = 0; enter !== 3 && k < arr.length; k++) {\n        if (k !== i && arr[k].indexOf(value) != -1) {\n          enter = 2;\n        } else if (k !== i) {\n          enter = 3;\n        }\n      }\n      if (enter == 1 && arr.length > 1) {\n        enter = 3;\n      } else if (enter == 1 && arr.length === 1) {\n        enter = 2;\n      }\n      if (enter == 2 && resultArr.indexOf(value) == -1) {\n        resultArr.push(value);\n      }\n    }\n  }\n\n  if (arr.length <= 0) {\n    return error.value;\n  }\n\n  for (let i = 0; i < resultArr.length; i++) {\n    let a = range[resultArr[i]];\n    if (a && !isNaN(a)) {\n      result += a;\n    } else {\n      return 0;\n    }\n  }\n\n  return result;\n};\n//XW：end\n\nexports.SUMPRODUCT = function() {\n  if (!arguments || arguments.length === 0) {\n    return error.value;\n  }\n  var arrays = arguments.length + 1;\n  var result = 0;\n  var product;\n  var k;\n  var _i;\n  var _ij;\n  for (var i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1;\n      for (k = 1; k < arrays; k++) {\n        _i = utils.parseNumber(arguments[k - 1][i]);\n        if (_i instanceof Error) {\n          return _i;\n        }\n        product *= _i;\n      }\n      result += product;\n    } else {\n      for (var j = 0; j < arguments[0][i].length; j++) {\n        product = 1;\n        for (k = 1; k < arrays; k++) {\n          _ij = utils.parseNumber(arguments[k - 1][i][j]);\n          if (_ij instanceof Error) {\n            return _ij;\n          }\n          product *= _ij;\n        }\n        result += product;\n      }\n    }\n  }\n  return result;\n};\n\nexports.SUMSQ = function() {\n  var numbers = utils.parseNumberArray(utils.flatten(arguments));\n  if (numbers instanceof Error) {\n    return numbers;\n  }\n  var result = 0;\n  var length = numbers.length;\n  for (var i = 0; i < length; i++) {\n    result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\n  }\n  return result;\n};\n\nexports.SUMX2MY2 = function (array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMX2PY2 = function (array_x, array_y) {\n  //XW: 参数转数组\n  if (typeof array_x == \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y == \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  //XW：end\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMXMY2 = function(array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.flatten(array_x);\n  array_y = utils.flatten(array_y);\n  for (var i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2);\n  }\n  return result;\n};\n\nexports.TAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.tan(number);\n};\n\nexports.TANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 - 1) / (e2 + 1);\n};\n\nexports.TRUNC = function(number, digits) {\n  digits = (digits === undefined) ? 0 : digits;\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};","var mathTrig = require('./math-trig');\nvar text = require('./text');\nvar jStat = require('jStat').jStat;\nvar utils = require('./utils');\nvar error = require('./error');\nvar misc = require('./miscellaneous');\nvar evalExpression = require('./expression')\nvar SQRT2PI = 2.5066282746310002;\n\nexports.AVEDEV = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length;\n};\n\nexports.AVERAGE = function() {\n  var range = utils.flattenNum(arguments);\n  if (range instanceof Error) {\n    return range;\n  }\n  if (range.length === 0){\n    return error.div0\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    sum += range[i];\n    count += 1;\n  }\n  return sum / count;\n};\n\nexports.AVERAGEA = function() {\n  var range = utils.flattenNum(arguments);\n  if (range.length == 1 && isNaN(range[0])){\n    return error.value\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sum += el;\n    }\n    if (el === true) {\n      sum++;\n    }\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sum / count;\n};\n\nexports.AVERAGEIF = function (range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na;\n  }\n  average_range = average_range || range;\n  range = utils.flatten(range);\n  average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n  if (average_range instanceof Error) {\n    return average_range;\n  }\n  var average_count = 0;\n  var result = 0;\n  var isWildcard = criteria === void 0 || criteria === '*';\n  var tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '');\n  var filter_criteria = criteria.replace('=', '').replace('*', '').replace('<>', '')\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n\n    if (isWildcard) {\n      result += average_range[i];\n      average_count++;\n    } else {\n      var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n      if (criteria.indexOf('<>') >= 0){\n        if (value.indexOf(filter_criteria) < 0) {\n          result += average_range[i];\n          average_count++;\n        }\n      }else if (evalExpression.compute(tokens) || value.toString().indexOf(filter_criteria) >= 0) {\n        result += average_range[i];\n        average_count++;\n      }\n    }\n  }\n  if (average_count == 0){\n    return error.div0\n  }\n  return result / average_count;\n};\n\nexports.AVERAGEIFS = function () {\n  // Does not work with multi dimensional ranges yet!\n  //http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  var args = utils.argsToArray(arguments);\n  var criteriaLength = (args.length - 1) / 2;\n  var range = utils.flatten(args[0]);\n  var count = 0;\n  var result = 0;\n\n  for (var i = 0; i < range.length; i++) {\n    var isMeetCondition = false;\n\n    for (var j = 0; j < criteriaLength; j++) {\n      var value = args[2 * j + 1][i];\n      var criteria = args[2 * j + 2];\n      var isWildcard = criteria === void 0 || criteria === '*';\n      var computedResult = false;\n\n      if (isWildcard) {\n        computedResult = true;\n      } else {\n        var tokenizedCriteria = evalExpression.parse(criteria + '');\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n        computedResult = evalExpression.compute(tokens);\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false;\n        break;\n      }\n\n      isMeetCondition = true;\n    }\n\n    if (isMeetCondition) {\n      result += range[i];\n      count++;\n    }\n  }\n\n  var average = result / count;\n\n  if (isNaN(average)) {\n    return error.div0;\n  } else {\n    return average;\n  }\n};\n\nexports.BETA = {};\n\nexports.BETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value;\n  }\n\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value;\n  }\n  cumulative = utils.parseBool(cumulative)\n  x = (x - A) / (B - A);\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)/2;\n};\n\nexports.BETA.INV = function(probability, alpha, beta, A, B) {\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value;\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A;\n};\n\nexports.BINOM = {};\n\nexports.BINOM.DIST = function (successes, trials, probability, cumulative) {\n  successes = utils.parseNumber(successes);\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  cumulative = utils.parseBool(cumulative)\n  cumulative = utils.parseNumber(cumulative);\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.binomial.cdf(successes, trials, probability) : jStat.binomial.pdf(successes, trials, probability);\n};\n\nexports.BINOM.INV = function(trials, probability, alpha) {\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value;\n  }\n\n  var x = 0;\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x;\n    }\n    x++;\n  }\n};\n\nexports.CHISQ = {};\n\nexports.CHISQ.DIST = function(x, k, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (x < 0){\n    return error.num\n  }\n  x = utils.parseNumber(x);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(x, k)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k);\n};\n\nexports.CHISQ.DIST.RT = function(x, k) {\n  if (!x | !k) {\n    return error.na;\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return 1 -  jStat.chisquare.cdf(x, k);\n};\n\nexports.CHISQ.INV = function(probability, k) {\n  probability = utils.parseNumber(probability);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(probability, k)) {\n    return error.value;\n  }\n  return jStat.chisquare.inv(probability, k);\n};\n\nexports.CHISQ.INV.RT = function(p, k) {\n  if (!p | !k) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k);\n};\n\nexports.CHISQ.TEST = function(observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {\n    return error.value;\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value;\n  }\n\n  if (observed[0] && expected[0] &&\n      observed[0].length !== expected[0].length) {\n    return error.value;\n  }\n\n  var row = observed.length;\n  var tmp, i, j;\n\n  // Convert single-dimension array into two-dimension array\n  for (i = 0; i < row; i ++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i];\n      observed[i] = [];\n      observed[i].push(tmp);\n    }\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i];\n      expected[i] = [];\n      expected[i].push(tmp);\n    }\n  }\n\n  var col = observed[0].length;\n  var dof = (col === 1) ? row-1 : (row-1)*(col-1);\n  var xsqr = 0;\n  var Pi =Math.PI;\n\n  for (i = 0; i < row; i ++) {\n    for (j = 0; j < col; j ++) {\n      xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    var p = Math.exp(-0.5 * xsqr);\n    if((dof%2) === 1) {\n      p = p * Math.sqrt(2 * xsqr/Pi);\n    }\n    var k = dof;\n    while(k >= 2) {\n      p = p * xsqr/k;\n      k = k - 2;\n    }\n    var t = p;\n    var a = dof;\n    while (t > 0.0000000001*p) {\n      a = a + 2;\n      t = t * xsqr/a;\n      p = p + t;\n    }\n    return 1-p;\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;\n};\n\nexports.COLUMN = function() {\n  col_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n  cell_name = this.args[0].formula.name\n  cell_name = cell_name.replace(/\\d+/g,'')\n  return col_list.indexOf(cell_name)+1\n};\n\nexports.COLUMNS = function(matrix) {\n  if (typeof matrix === 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.cols(matrix);\n};\n\nexports.CONFIDENCE = {};\n\nexports.CONFIDENCE.NORM = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.normalci(1, alpha, sd, n)[1] - 1;\n};\n\nexports.CONFIDENCE.T = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.tci(1, alpha, sd, n)[1] - 1;\n};\nexports.IFS = function() {\n  for (var i = 0; i + 1 < arguments.length; i += 2) {\n    var cond = arguments[i];\n    var val = arguments[i + 1];\n    if (cond) {\n      return val;\n    }\n  }\n  return error.na;\n}\nexports.CORREL = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.corrcoeff(array1, array2);\n};\n\nexports.COUNT = function() {\n  return utils.numbers(utils.flatten(arguments)).length;\n};\n\nexports.COUNTA = function() {\n  var range = utils.flatten(arguments);\n  return range.length - exports.COUNTBLANK(range);\n};\n\nexports.COUNTIN = function (range, value) {\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++;\n    }\n  }\n  return result;\n};\n\n\nexports.COUNTBLANK = function() {\n  var range = utils.flatten(arguments);\n  var blanks = 0;\n  var element;\n  for (var i = 0; i < range.length; i++) {\n    element = range[i];\n    if (element === null || element === '') {\n      blanks++;\n    }\n  }\n  return blanks;\n};\n\nexports.COUNTIF = function (range, criteria) {\n  range = utils.flatten(range);\n  if (criteria === undefined) {\n    return error.value;\n  }\n  var isWildcard = criteria === void 0 || criteria === '*';\n\n  if (isWildcard) {\n    return range.length;\n  }\n\n  var matches = 0;\n  var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n    var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n    if (evalExpression.compute(tokens)) {\n      matches++;\n    }\n  }\n\n  return matches;\n};\n\nexports.COUNTIFS = function () {\n  var args = utils.argsToArray(arguments);\n  var results = new Array(utils.flatten(args[0]).length);\n\n  for (var i = 0; i < results.length; i++) {\n    results[i] = true;\n  }\n  for (i = 0; i < args.length; i += 2) {\n    var range = utils.flatten(args[i]);\n    var criteria = args[i + 1];\n    var isWildcard = criteria === void 0 || criteria === '*';\n\n    if (!isWildcard) {\n      var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n      for (var j = 0; j < range.length; j++) {\n        var value = range[j];\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n        results[j] = results[j] && evalExpression.compute(tokens);\n      }\n    }\n  }\n  var result = 0;\n  for (i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++;\n    }\n  }\n  return result;\n};\n\nexports.COUNTUNIQUE = function () {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length;\n};\n\nexports.COVARIANCE = {};\n\nexports.COVARIANCE.P = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  var mean1 = jStat.mean(array1);\n  var mean2 = jStat.mean(array2);\n  var result = 0;\n  var n = array1.length;\n  for (var i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2);\n  }\n  return result / n;\n};\n\nexports.COVARIANCE.S = function(array1, array2) {\n  if (typeof array1 == \"string\") {\n    array1 = utils.strToMatrix(array1);\n  }\n  if (typeof array2 == \"string\") {\n    array2 = utils.strToMatrix(array2);\n  }\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.covariance(array1, array2);\n};\n\nexports.DEVSQ = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += Math.pow((range[i] - mean), 2);\n  }\n  return result;\n};\n\nexports.EXPON = {};\n\nexports.EXPON.DIST = function(x, lambda, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  lambda = utils.parseNumber(lambda);\n  if (utils.anyIsError(x, lambda)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda);\n};\n\nexports.F = {};\n\nexports.F.DIST = function (x, d1, d2, cumulative) {\n  x = utils.parseNumber(x);\n  d1 = utils.parseNumber(d1);\n  d2 = utils.parseNumber(d2);\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value;\n  }\n  if (cumulative == undefined){\n    cumulative = true\n  }\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value\n  }\n  if (cumulative == 'FALSE'){\n    cumulative = false\n  }\n  return (cumulative) ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2);\n};\n\nexports.F.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2);\n};\n\nexports.F.INV = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.TEST = function (array1, array2) {\n  if (!array1 || !array2) {\n    return error.na;\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na;\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0;\n  }\n\n  var sumOfSquares = function (values, x1) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n      sum += Math.pow((values[i] - x1), 2);\n    }\n    return sum;\n  };\n\n  var x1 = mathTrig.SUM(array1) / array1.length;\n  var x2 = mathTrig.SUM(array2) / array2.length;\n  var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);\n  var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);\n\n  return sum1 / sum2;\n};\n\nexports.FISHER = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return x;\n  }\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n\nexports.FISHERINV = function(y) {\n  y = utils.parseNumber(y);\n  if (y instanceof Error) {\n    return y;\n  }\n  var e2y = Math.exp(2 * y);\n  return (e2y - 1) / (e2y + 1);\n};\n\nexports.FORECAST = function(x, data_y, data_x) {\n  x = utils.parseNumber(x);\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var b = num / den;\n  var a = ymean - b * xmean;\n  return a + b * x;\n};\n\nexports.FREQUENCY = function(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data));\n  bins = utils.parseNumberArray(utils.flatten(bins));\n  if (utils.anyIsError(data, bins)) {\n    return error.value;\n  }\n  var n = data.length;\n  var b = bins.length;\n  var r = [];\n  for (var i = 0; i <= b; i++) {\n    r[i] = 0;\n    for (var j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1;\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1;\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1;\n        }\n      }\n    }\n  }\n  return r;\n};\n\n\nexports.GAMMA = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  if (number === 0) {\n    return error.num;\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num;\n  }\n\n  return jStat.gammafn(number);\n};\n\nexports.GAMMA.DIST = function(value, alpha, beta, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (arguments.length !== 4) {\n    return error.na;\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value;\n  }\n\n  if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false);\n};\n\nexports.GAMMA.INV = function(probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num;\n  }\n\n  if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta);\n};\n\nexports.GAMMALN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return jStat.gammaln(number);\n};\n\nexports.GAMMALN.PRECISE = function(x) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (x <= 0) {\n    return error.num;\n  }\n\n  if (typeof x !== 'number') {\n    return error.value;\n  }\n\n  return jStat.gammaln(x);\n};\n\nexports.GAUSS = function(z) {\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return z;\n  }\n  return jStat.normal.cdf(z, 0, 1) - 0.5;\n};\n\nexports.GEOMEAN = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  return jStat.geomean(args);\n};\n\nexports.GROWTH = function(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n\n  known_y = utils.parseNumberArray(known_y);\n  if (known_y instanceof Error) {\n    return known_y;\n  }\n\n  // Default values for optional parameters:\n  var i;\n  if (known_x === undefined) {\n    known_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i);\n    }\n  }\n  if (new_x === undefined) {\n    new_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i);\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x);\n  new_x = utils.parseNumberArray(new_x);\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value;\n  }\n\n\n  if (use_const === undefined) {\n    use_const = true;\n  }\n\n  // Calculate sums over the data:\n  var n = known_y.length;\n  var avg_x = 0;\n  var avg_y = 0;\n  var avg_xy = 0;\n  var avg_xx = 0;\n  for (i = 0; i < n; i++) {\n    var x = known_x[i];\n    var y = Math.log(known_y[i]);\n    avg_x += x;\n    avg_y += y;\n    avg_xy += x * y;\n    avg_xx += x * x;\n  }\n  avg_x /= n;\n  avg_y /= n;\n  avg_xy /= n;\n  avg_xx /= n;\n\n  // Compute linear regression coefficients:\n  var beta;\n  var alpha;\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);\n    alpha = avg_y - beta * avg_x;\n  } else {\n    beta = avg_xy / avg_xx;\n    alpha = 0;\n  }\n\n  // Compute and return result array:\n  var new_y = [];\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]));\n  }\n  return new_y;\n};\n\nexports.HARMEAN = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    den += 1 / range[i];\n  }\n  return n / den;\n};\n\nexports.HYPGEOM = {};\n\nexports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  M = utils.parseNumber(M);\n  N = utils.parseNumber(N);\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value;\n  }\n\n  function pdf(x, n, M, N) {\n    return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);\n  }\n\n  function cdf(x, n, M, N) {\n    var result = 0;\n    for (var i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N);\n    }\n    return result;\n  }\n\n  return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);\n};\n\nexports.INTERCEPT = function(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y);\n  known_x = utils.parseNumberArray(known_x);\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value;\n  }\n  if (known_y.length !== known_x.length) {\n    return error.na;\n  }\n  return exports.FORECAST(0, known_y, known_x);\n};\n\nexports.KURT = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4);\n  }\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4);\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));\n};\n\nexports.LARGE = function(range, k) {\n  range = utils.flatten(range)\n  var arr = []\n  for ( var i=0;i<range.length;i++){\n    if (parseFloat(range[i])){\n      arr.push((parseFloat(range[i])))\n    }\n  }\n  range = arr;\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function (a, b) {\n    return b - a;\n  })[k - 1];\n};\n\nexports.LINEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var ymean = jStat.mean(data_y);\n  var xmean = jStat.mean(data_x);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var m = num / den;\n  var b = ymean - m * xmean;\n  return [m, b];\n};\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexports.LOGEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  for (var i = 0; i < data_y.length; i ++) {\n    data_y[i] = Math.log(data_y[i]);\n  }\n\n  var result = exports.LINEST(data_y, data_x);\n  result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;\n  result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;\n  return result;\n};\n\nexports.LOGNORM = {};\n\nexports.LOGNORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd);\n};\n\nexports.LOGNORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.lognormal.inv(probability, mean, sd);\n};\n\nexports.MAX = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MAXA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MEDIAN = function() {\n  var arr = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  var arr2 = []\n  for (var i=0;i<arr.length;i++){\n    if (typeof arr[i] === 'number'){\n      arr2.push(arr[i])\n    }\n  }\n  var range = utils.arrayValuesToNumbers(utils.flatten(arr2));\n  return jStat.median(range);\n};\n\nexports.MIN = function() {\n  var range = utils.flatten(arguments);\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MINA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MODE = {};\n\nexports.MODE.MULT = function() {\n  // Credits: Roönaän\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var count = {};\n  var maxItems = [];\n  var max = 0;\n  var currentItem;\n\n  for (var i = 0; i < n; i++) {\n    currentItem = range[i];\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n    if (count[currentItem] > max) {\n      max = count[currentItem];\n      maxItems = [];\n    }\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem;\n    }\n  }\n  return maxItems;\n};\n\nexports.MODE.SNGL = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return exports.MODE.MULT(range).sort(function(a, b) {\n    return a - b;\n  })[0];\n};\n\nexports.NEGBINOM = {};\n\nexports.NEGBINOM.DIST = function(k, r, p, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  k = utils.parseNumber(k);\n  r = utils.parseNumber(r);\n  p = utils.parseNumber(p);\n  if (utils.anyIsError(k, r, p)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p);\n};\n\nexports.NORM = {};\n\nexports.NORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  if (sd <= 0) {\n    return error.num;\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return (cumulative) ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd);\n};\n\nexports.NORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, mean, sd);\n};\n\nexports.NORM.S = {};\n\nexports.NORM.S.DIST = function(z, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1);\n};\n\nexports.NORM.S.INV = function(probability) {\n  probability = utils.parseNumber(probability);\n  if (probability instanceof Error) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, 0, 1);\n};\n\nexports.PEARSON = function(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den1 = 0;\n  var den2 = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den1 += Math.pow(data_x[i] - xmean, 2);\n    den2 += Math.pow(data_y[i] - ymean, 2);\n  }\n  return num / Math.sqrt(den1 * den2);\n};\n\nexports.PERCENTILE = {};\n\nexports.PERCENTILE.EXC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    {\n      return a - b;\n    }\n  });\n  var n = array.length;\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num;\n  }\n  var l = k * (n + 1) - 1;\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTILE.INC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var n = array.length;\n  var l = k * (n - 1);\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTRANK = {};\n\nexports.PERCENTRANK.EXC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERCENTRANK.INC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERMUT = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);\n};\n\nexports.PERMUTATIONA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return Math.pow(number, number_chosen);\n};\n\nexports.PHI = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return error.value;\n  }\n  return Math.exp(-0.5 * x * x) / SQRT2PI;\n};\n\nexports.POISSON = {};\n\nexports.POISSON.DIST = function(x, mean, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  if (utils.anyIsError(x, mean)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean);\n};\n\nexports.PROB = function(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0;\n  }\n  upper = (upper === undefined) ? lower : upper;\n\n  range = utils.parseNumberArray(utils.flatten(range));\n  probability = utils.parseNumberArray(utils.flatten(probability));\n  lower = utils.parseNumber(lower);\n  upper = utils.parseNumber(upper);\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value;\n  }\n\n  if (lower === upper) {\n    return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\n  }\n\n  var sorted = range.sort(function(a, b) {\n    return a - b;\n  });\n  var n = sorted.length;\n  var result = 0;\n  for (var i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])];\n    }\n  }\n  return result;\n};\n\nexports.QUARTILE = {};\n\nexports.QUARTILE.EXC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.EXC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.EXC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.EXC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.QUARTILE.INC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.INC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.INC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.INC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.RANK = {};\n\nexports.RANK.AVG = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  range = utils.flatten(range);\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n\n  var length = range.length;\n  var count = 0;\n  for (var i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++;\n    }\n  }\n\n  return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n};\n\nexports.RANK.EQ = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n  return range.indexOf(number) + 1;\n};\n\nexports.ROW = function(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (index < 0) {\n    return error.num;\n  }\n\n  if (!(matrix instanceof Array) || (typeof index !== 'number')) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return undefined;\n  }\n\n  return jStat.row(matrix, index);\n};\n\nexports.ROWS = function(matrix) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\n\nexports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n  return Math.pow(exports.PEARSON(data_x, data_y), 2);\n};\n\nexports.SKEW = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3);\n  }\n  return n * sigma / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3));\n};\n\nexports.SKEW.P = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var m2 = 0;\n  var m3 = 0;\n  for (var i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3);\n    m2 += Math.pow(range[i] - mean, 2);\n  }\n  m3 = m3 / n;\n  m2 = m2 / n;\n  return m3 / Math.pow(m2, 3 / 2);\n};\n\nexports.SLOPE = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return num / den;\n};\n\nexports.SMALL = function(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function(a, b) {\n    return a - b;\n  })[k - 1];\n};\n\nexports.STANDARDIZE = function(x, mean, sd) {\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (x - mean) / sd;\n};\n\nexports.STDEV = {};\n\nexports.STDEV.P = function() {\n  var v = exports.VAR.P.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEV.S = function() {\n  var v = exports.VAR.S.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVA = function() {\n  var v = exports.VARA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVPA = function() {\n  var v = exports.VARPA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\n\nexports.STEYX = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var lft = 0;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2);\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return Math.sqrt((lft - num * num / den) / (n - 2));\n};\n\nexports.TRANSPOSE = function(matrix) {\n  if (!matrix) {\n    return error.na;\n  }\n  return jStat.transpose(matrix);\n};\n\nexports.T = text.T;\n\nexports.T.DIST = function (x, df, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  df = utils.parseNumber(df);\n  if (utils.anyIsError(x, df)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.studentt.cdf(x, df) : jStat.studentt.pdf(x, df);\n};\n\nexports.T.DIST['2T'] = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return (1 - jStat.studentt.cdf(x , df)) * 2;\n};\n\nexports.T.DIST.RT = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.studentt.cdf(x , df);\n};\n\nexports.T.INV = function (probability, df) {\n  // probability = utils.parseNumber(probability);\n  // df = utils.parseNumber(df);\n  // if (utils.anyIsError(probability, df)) {\n  //   return error.value;\n  // }\n  // var res = jStat.studentt.inv(probability, df);\n  // return res\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\nexports.T.INV['2T'] = function(probability, df) {\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nexports.T.TEST = function(data_x, data_y) {\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n\n  var mean_x = jStat.mean(data_x);\n  var mean_y = jStat.mean(data_y);\n  var s_x = 0;\n  var s_y = 0;\n  var i;\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2);\n  }\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2);\n  }\n\n  s_x = s_x / (data_x.length-1);\n  s_y = s_y / (data_y.length-1);\n\n  var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);\n\n  return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);\n};\n\nexports.TREND = function (data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  var linest = exports.LINEST(data_y, data_x);\n  var m = linest[0];\n  var b = linest[1];\n  return m * new_data_x + b\n};\n\nexports.TRIMMEAN = function (range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  percent = utils.parseNumber(percent);\n  if (utils.anyIsError(range, percent)) {\n    return error.value;\n  }\n  var trim = mathTrig.FLOORMATH(range.length * percent, 2) / 2;\n  return jStat.mean(utils.initial(utils.rest(range.sort(function (a, b) {\n    return a - b;\n  }), trim), trim));\n};\n\nexports.VAR = {};\n\nexports.VAR.P = function () {\n  var range = utils.numbers(utils.flatten(arguments));\n  if (range.length==0){\n    return error.value\n  }\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  if (isNaN(sigma / n)){\n    return error.value\n  }else{\n    return sigma / n;\n  }\n};\n\nexports.VAR.S = function() {\n  var range = utils.numbers(utils.flatten(arguments));\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  return sigma / (n - 1);\n};\n\nexports.VARA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / (count - 1);\n};\n\nexports.VARPA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / count;\n};\n\nexports.WEIBULL = {};\n\nexports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\n  //XW:参数判断\n  cumulative = utils.parseBool(cumulative)\n  //XW：end\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value;\n  }\n  return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n};\n\nexports.Z = {};\n\nexports.Z.TEST = function (range, x, sd) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  x = utils.parseNumber(x);\n  if (utils.anyIsError(range, x)) {\n    return error.value;\n  }\n\n  sd = sd || exports.STDEV.S(range);\n  var n = range.length;\n  return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n};\n","var exp = require(\"../core/alphabet\");\nconst helper = require(\"../core/helper\");\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};\n\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};","var map = {\n\t\"./af\": 65,\n\t\"./af.js\": 65,\n\t\"./ar\": 66,\n\t\"./ar-dz\": 67,\n\t\"./ar-dz.js\": 67,\n\t\"./ar-kw\": 68,\n\t\"./ar-kw.js\": 68,\n\t\"./ar-ly\": 69,\n\t\"./ar-ly.js\": 69,\n\t\"./ar-ma\": 70,\n\t\"./ar-ma.js\": 70,\n\t\"./ar-sa\": 71,\n\t\"./ar-sa.js\": 71,\n\t\"./ar-tn\": 72,\n\t\"./ar-tn.js\": 72,\n\t\"./ar.js\": 66,\n\t\"./az\": 73,\n\t\"./az.js\": 73,\n\t\"./be\": 74,\n\t\"./be.js\": 74,\n\t\"./bg\": 75,\n\t\"./bg.js\": 75,\n\t\"./bm\": 76,\n\t\"./bm.js\": 76,\n\t\"./bn\": 77,\n\t\"./bn.js\": 77,\n\t\"./bo\": 78,\n\t\"./bo.js\": 78,\n\t\"./br\": 79,\n\t\"./br.js\": 79,\n\t\"./bs\": 80,\n\t\"./bs.js\": 80,\n\t\"./ca\": 81,\n\t\"./ca.js\": 81,\n\t\"./cs\": 82,\n\t\"./cs.js\": 82,\n\t\"./cv\": 83,\n\t\"./cv.js\": 83,\n\t\"./cy\": 84,\n\t\"./cy.js\": 84,\n\t\"./da\": 85,\n\t\"./da.js\": 85,\n\t\"./de\": 86,\n\t\"./de-at\": 87,\n\t\"./de-at.js\": 87,\n\t\"./de-ch\": 88,\n\t\"./de-ch.js\": 88,\n\t\"./de.js\": 86,\n\t\"./dv\": 89,\n\t\"./dv.js\": 89,\n\t\"./el\": 90,\n\t\"./el.js\": 90,\n\t\"./en-SG\": 91,\n\t\"./en-SG.js\": 91,\n\t\"./en-au\": 92,\n\t\"./en-au.js\": 92,\n\t\"./en-ca\": 93,\n\t\"./en-ca.js\": 93,\n\t\"./en-gb\": 94,\n\t\"./en-gb.js\": 94,\n\t\"./en-ie\": 95,\n\t\"./en-ie.js\": 95,\n\t\"./en-il\": 96,\n\t\"./en-il.js\": 96,\n\t\"./en-nz\": 97,\n\t\"./en-nz.js\": 97,\n\t\"./eo\": 98,\n\t\"./eo.js\": 98,\n\t\"./es\": 99,\n\t\"./es-do\": 100,\n\t\"./es-do.js\": 100,\n\t\"./es-us\": 101,\n\t\"./es-us.js\": 101,\n\t\"./es.js\": 99,\n\t\"./et\": 102,\n\t\"./et.js\": 102,\n\t\"./eu\": 103,\n\t\"./eu.js\": 103,\n\t\"./fa\": 104,\n\t\"./fa.js\": 104,\n\t\"./fi\": 105,\n\t\"./fi.js\": 105,\n\t\"./fo\": 106,\n\t\"./fo.js\": 106,\n\t\"./fr\": 107,\n\t\"./fr-ca\": 108,\n\t\"./fr-ca.js\": 108,\n\t\"./fr-ch\": 109,\n\t\"./fr-ch.js\": 109,\n\t\"./fr.js\": 107,\n\t\"./fy\": 110,\n\t\"./fy.js\": 110,\n\t\"./ga\": 111,\n\t\"./ga.js\": 111,\n\t\"./gd\": 112,\n\t\"./gd.js\": 112,\n\t\"./gl\": 113,\n\t\"./gl.js\": 113,\n\t\"./gom-latn\": 114,\n\t\"./gom-latn.js\": 114,\n\t\"./gu\": 115,\n\t\"./gu.js\": 115,\n\t\"./he\": 116,\n\t\"./he.js\": 116,\n\t\"./hi\": 117,\n\t\"./hi.js\": 117,\n\t\"./hr\": 118,\n\t\"./hr.js\": 118,\n\t\"./hu\": 119,\n\t\"./hu.js\": 119,\n\t\"./hy-am\": 120,\n\t\"./hy-am.js\": 120,\n\t\"./id\": 121,\n\t\"./id.js\": 121,\n\t\"./is\": 122,\n\t\"./is.js\": 122,\n\t\"./it\": 123,\n\t\"./it-ch\": 124,\n\t\"./it-ch.js\": 124,\n\t\"./it.js\": 123,\n\t\"./ja\": 125,\n\t\"./ja.js\": 125,\n\t\"./jv\": 126,\n\t\"./jv.js\": 126,\n\t\"./ka\": 127,\n\t\"./ka.js\": 127,\n\t\"./kk\": 128,\n\t\"./kk.js\": 128,\n\t\"./km\": 129,\n\t\"./km.js\": 129,\n\t\"./kn\": 130,\n\t\"./kn.js\": 130,\n\t\"./ko\": 131,\n\t\"./ko.js\": 131,\n\t\"./ku\": 132,\n\t\"./ku.js\": 132,\n\t\"./ky\": 133,\n\t\"./ky.js\": 133,\n\t\"./lb\": 134,\n\t\"./lb.js\": 134,\n\t\"./lo\": 135,\n\t\"./lo.js\": 135,\n\t\"./lt\": 136,\n\t\"./lt.js\": 136,\n\t\"./lv\": 137,\n\t\"./lv.js\": 137,\n\t\"./me\": 138,\n\t\"./me.js\": 138,\n\t\"./mi\": 139,\n\t\"./mi.js\": 139,\n\t\"./mk\": 140,\n\t\"./mk.js\": 140,\n\t\"./ml\": 141,\n\t\"./ml.js\": 141,\n\t\"./mn\": 142,\n\t\"./mn.js\": 142,\n\t\"./mr\": 143,\n\t\"./mr.js\": 143,\n\t\"./ms\": 144,\n\t\"./ms-my\": 145,\n\t\"./ms-my.js\": 145,\n\t\"./ms.js\": 144,\n\t\"./mt\": 146,\n\t\"./mt.js\": 146,\n\t\"./my\": 147,\n\t\"./my.js\": 147,\n\t\"./nb\": 148,\n\t\"./nb.js\": 148,\n\t\"./ne\": 149,\n\t\"./ne.js\": 149,\n\t\"./nl\": 150,\n\t\"./nl-be\": 151,\n\t\"./nl-be.js\": 151,\n\t\"./nl.js\": 150,\n\t\"./nn\": 152,\n\t\"./nn.js\": 152,\n\t\"./pa-in\": 153,\n\t\"./pa-in.js\": 153,\n\t\"./pl\": 154,\n\t\"./pl.js\": 154,\n\t\"./pt\": 155,\n\t\"./pt-br\": 156,\n\t\"./pt-br.js\": 156,\n\t\"./pt.js\": 155,\n\t\"./ro\": 157,\n\t\"./ro.js\": 157,\n\t\"./ru\": 158,\n\t\"./ru.js\": 158,\n\t\"./sd\": 159,\n\t\"./sd.js\": 159,\n\t\"./se\": 160,\n\t\"./se.js\": 160,\n\t\"./si\": 161,\n\t\"./si.js\": 161,\n\t\"./sk\": 162,\n\t\"./sk.js\": 162,\n\t\"./sl\": 163,\n\t\"./sl.js\": 163,\n\t\"./sq\": 164,\n\t\"./sq.js\": 164,\n\t\"./sr\": 165,\n\t\"./sr-cyrl\": 166,\n\t\"./sr-cyrl.js\": 166,\n\t\"./sr.js\": 165,\n\t\"./ss\": 167,\n\t\"./ss.js\": 167,\n\t\"./sv\": 168,\n\t\"./sv.js\": 168,\n\t\"./sw\": 169,\n\t\"./sw.js\": 169,\n\t\"./ta\": 170,\n\t\"./ta.js\": 170,\n\t\"./te\": 171,\n\t\"./te.js\": 171,\n\t\"./tet\": 172,\n\t\"./tet.js\": 172,\n\t\"./tg\": 173,\n\t\"./tg.js\": 173,\n\t\"./th\": 174,\n\t\"./th.js\": 174,\n\t\"./tl-ph\": 175,\n\t\"./tl-ph.js\": 175,\n\t\"./tlh\": 176,\n\t\"./tlh.js\": 176,\n\t\"./tr\": 177,\n\t\"./tr.js\": 177,\n\t\"./tzl\": 178,\n\t\"./tzl.js\": 178,\n\t\"./tzm\": 179,\n\t\"./tzm-latn\": 180,\n\t\"./tzm-latn.js\": 180,\n\t\"./tzm.js\": 179,\n\t\"./ug-cn\": 181,\n\t\"./ug-cn.js\": 181,\n\t\"./uk\": 182,\n\t\"./uk.js\": 182,\n\t\"./ur\": 183,\n\t\"./ur.js\": 183,\n\t\"./uz\": 184,\n\t\"./uz-latn\": 185,\n\t\"./uz-latn.js\": 185,\n\t\"./uz.js\": 184,\n\t\"./vi\": 186,\n\t\"./vi.js\": 186,\n\t\"./x-pseudo\": 187,\n\t\"./x-pseudo.js\": 187,\n\t\"./yo\": 188,\n\t\"./yo.js\": 188,\n\t\"./zh-cn\": 189,\n\t\"./zh-cn.js\": 189,\n\t\"./zh-hk\": 190,\n\t\"./zh-hk.js\": 190,\n\t\"./zh-tw\": 191,\n\t\"./zh-tw.js\": 191\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 247;","/* global document */\n\n/* global window */\nclass Element {\n    constructor(tag, className = '') {\n        if (typeof tag === 'string') {\n            this.el = document.createElement(tag);\n            this.el.className = className;\n        } else {\n            this.el = tag;\n        }\n        this.data = {};\n    }\n\n    data(key, value) {\n        if (value !== undefined) {\n            this.data[key] = value;\n            return this;\n        }\n        return this.data[key];\n    }\n\n    on(eventNames, handler) {\n        const [fen, ...oen] = eventNames.split('.');\n        let eventName = fen;\n        if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n            eventName = 'DOMMouseScroll';\n        }\n        this.el.addEventListener(eventName, (evt) => {\n            handler(evt);\n            for (let i = 0; i < oen.length; i += 1) {\n                const k = oen[i];\n                if (k === 'left' && evt.button !== 0) {\n                    return;\n                }\n                if (k === 'right' && evt.button !== 2) {\n                    return;\n                }\n                if (k === 'stop') {\n                    evt.stopPropagation();\n                }\n            }\n        });\n        return this;\n    }\n\n    offset(value) {\n        if (value !== undefined) {\n            Object.keys(value).forEach((k) => {\n                this.css(k, `${value[k]}px`);\n            });\n            return this;\n        }\n        const {\n            offsetTop, offsetLeft, offsetHeight, offsetWidth,\n        } = this.el;\n        return {\n            top: offsetTop,\n            left: offsetLeft,\n            height: offsetHeight,\n            width: offsetWidth,\n        };\n    }\n\n    scroll(v) {\n        const {el} = this;\n        if (v !== undefined) {\n            if (v.left !== undefined) {\n                el.scrollLeft = v.left;\n            }\n            if (v.top !== undefined) {\n                el.scrollTop = v.top;\n            }\n        }\n\n        return {left: el.scrollLeft, top: el.scrollTop};\n    }\n\n    box() {\n        return this.el.getBoundingClientRect();\n    }\n\n    parent() {\n        return new Element(this.el.parentNode);\n    }\n\n    children(...eles) {\n        if (arguments.length === 0) {\n            return this.el.childNodes;\n        }\n        eles.forEach(ele => this.child(ele));\n        return this;\n    }\n\n    /*\n    first() {\n      return this.el.firstChild;\n    }\n\n    last() {\n      return this.el.lastChild;\n    }\n\n    remove(ele) {\n      return this.el.removeChild(ele);\n    }\n\n    prepend(ele) {\n      const { el } = this;\n      if (el.children.length > 0) {\n        el.insertBefore(ele, el.firstChild);\n      } else {\n        el.appendChild(ele);\n      }\n      return this;\n    }\n\n    prev() {\n      return this.el.previousSibling;\n    }\n\n    next() {\n      return this.el.nextSibling;\n    }\n    */\n\n    child(arg) {\n        let ele = arg;\n        if (typeof arg === 'string') {\n            ele = document.createTextNode(arg);\n        } else if (arg instanceof Element) {\n            ele = arg.el;\n        }\n        this.el.appendChild(ele);\n\n        return this;\n    }\n\n    contains(ele) {\n        return this.el.contains(ele);\n    }\n\n    className(v) {\n        if (v !== undefined) {\n            this.el.className = v;\n            return this;\n        }\n        return this.el.className;\n    }\n\n    addClass(name) {\n        this.el.classList.add(name);\n        return this;\n    }\n\n    hasClass(name) {\n        return this.el.classList.contains(name);\n    }\n\n    removeClass(name) {\n        this.el.classList.remove(name);\n        return this;\n    }\n\n    toggle(cls = 'active') {\n        return this.toggleClass(cls);\n    }\n\n    toggleClass(name) {\n        return this.el.classList.toggle(name);\n    }\n\n    active(flag = true, cls = 'active') {\n        if (flag) this.addClass(cls);\n        else this.removeClass(cls);\n        return this;\n    }\n\n    checked(flag = true) {\n        this.active(flag, 'checked');\n        return this;\n    }\n\n    disabled(flag = true) {\n        if (flag) this.addClass('disabled');\n        else this.removeClass('disabled');\n        return this;\n    }\n\n    // key, value\n    // key\n    // {k, v}...\n    attr(key, value) {\n        if (value !== undefined) {\n            this.el.setAttribute(key, value);\n        } else {\n            if (typeof key === 'string') {\n                return this.el.getAttribute(key);\n            }\n            Object.keys(key).forEach((k) => {\n                this.el.setAttribute(k, key[k]);\n            });\n        }\n        return this;\n    }\n\n    removeAttr(key) {\n        this.el.removeAttribute(key);\n        return this;\n    }\n\n    html(content) {\n        if (content !== undefined) {\n            this.el.innerHTML = content;\n            return this;\n        }\n        return this.el.innerHTML;\n    }\n\n    val(v) {\n        if (v !== undefined) {\n            this.el.value = v;\n            return this;\n        }\n        return this.el.value;\n    }\n\n    cssRemoveKeys(...keys) {\n        keys.forEach(k => this.el.style.removeProperty(k));\n        return this;\n    }\n\n    // css( propertyName )\n    // css( propertyName, value )\n    // css( properties )\n    css(name, value) {\n        if (value === undefined && typeof name !== 'string') {\n            Object.keys(name).forEach((k) => {\n                this.el.style[k] = name[k];\n            });\n            return this;\n        }\n        if (value !== undefined) {\n            this.el.style[name] = value;\n            return this;\n        }\n        return this.el.style[name];\n    }\n\n    removeEl() {\n        if (!this.el || !this.el.parentNode) {\n            return;\n        }\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    computedStyle() {\n        return window.getComputedStyle(this.el, null);\n    }\n\n    isShow() {\n        if(this.el.style['display'] === 'block') {\n            return true;\n        }\n        return false;\n    }\n\n    show(key = 'display', text = 'block') {\n        this.css(key, text);\n        return this;\n    }\n\n    hide(key = 'display', value = 'none') {\n        this.css(key, value);\n        return this;\n    }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n    Element,\n    h,\n};\n","/* global window */\nimport en from './en';\n\nlet $lang = 'en';\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages && messages[$lang]) {\n        let message = messages[$lang];\n        const keys = key.split('.');\n        for (let i = 0; i < keys.length; i += 1) {\n            const property = keys[i];\n            const value = message[property];\n            if (i === keys.length - 1) return value;\n            if (!value) return undefined;\n            message = value;\n        }\n    }\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x && window.x.spreadsheet && window.x.spreadsheet.$messages) {\n        v = translate(key, window.x.spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\nfunction locale(lang, message) {\n    $lang = lang;\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        font: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        textColor: 'Text color',\n        fillColor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        add: 'display equation',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n        flexible: 'Flexible',\n        throwFormula: 'Throw formulas',\n        comeBack: 'come back',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        insertRow: 'Insert row',\n        insertColumn: 'Insert column',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        recover: 'recover',\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    date_formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        concat: 'Concat',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","/**\n formulas:\n key\n title\n render\n */\nimport {tf} from '../locale/locale';\nimport XLSX_CALC from \"../calc\"\nvar formulajs = require('../calc/formulajs/index'); // jobs: todo: 这里为何又多出3个函数？似乎应该统一放到formulajs中解决。\nconst baseFormulas = [\n    {\n        key: 'MD.WLAND',\n        title: tf('formula.wland'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.WFR',\n        title: tf('formula.wfr'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.RTD',\n        title: tf('formula.rtd'),\n        render: ary => ary.join(''),\n    },\n];\n\nlet formulas = deepCopy(baseFormulas);\n\nconst formulaCalc = () => {\n    XLSX_CALC.import_functions(formulajs);\n    let xlsx_Fx = XLSX_CALC.xlsx_Fx;\n    formulas = deepCopy(baseFormulas);\n    Object.keys(xlsx_Fx).forEach(i => {\n        let args = {\n            key: i,\n            title: i,\n            render: xlsx_Fx[i]\n        };\n        formulas.push(args);\n    });\n\n\n    return XLSX_CALC;\n};\n\nfunction deepCopy(obj) {\n    var result = Array.isArray(obj) ? [] : {};\n    for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n                result[key] = deepCopy(obj[key]);\n            } else {\n                result[key] = obj[key];\n            }\n        }\n    }\n    return result;\n}\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport default {};\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n    formulaCalc,\n};\n","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  isCopy() {\n    return this.state === 'copy';\n  }\n\n  isCut() {\n    return this.state === 'cut';\n  }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    vlength() {\n        const {operator, value} = this;\n        if (operator === 'in') {\n            return value.length;\n        }\n        return 0;\n    }\n\n    getData() {\n\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n\n        this.flex = [];\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.fitlers = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    addFiexRows(args) {\n        this.flex = args;\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSet(exceptRowSet, rir) {\n        for (let ix = 0; ix < this.flex.length; ix++) {\n            let {ri, ci, set_total, state} = this.flex[ix]\n            for (let i = ri; i < set_total + ri; i++) {\n                console.log(state, \"114\", rir, ri, state)\n                if (state === false && rir == ri) {\n                    exceptRowSet.add(i + 1);\n                    this.flex[ix].state = true;\n                } else if (state === true && rir == ri) {\n                    exceptRowSet.delete(i + 1);\n                    this.flex[ix].state = false;\n                }\n            }\n        }\n\n        return exceptRowSet;\n    }\n\n    includes2(rir, cic) {\n        let b = false\n\n        for (let i = 0; i < this.flex.length; i++) {\n            let {ri, ci} = this.flex[i];\n            if (rir == ri && cic == ci) {\n                b = true;\n            }\n        }\n\n        return b;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    const cnt = (m[key] || 0) + 1;\n                    m[key] = cnt;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        console.log(this.range(), \"171\")\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  each(cb) {\n      this._.forEach(it => cb(it));\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri >= index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    return this;\n  }\n\n  getData() {\n    return this._.map(merge => merge.toString());\n  }\n}\n\nexport default {};\nexport {\n  Merges,\n};\n","const recast = require(\"recast\");\n\nconst colon = \"$$$\";\nconst fqm = '';\nconst exclamationPoint = \"\";\nconst braceLeft = \"\";\nconst braceRight = \"\";\n\nexport default class Recast {\n    constructor(formula) {\n        this.formula = formula;\n        this.ast = \"\";\n    }\n    preProcess() {\n        this.formula = this.formula.replace(/=/g, '');\n        this.formula = this.formula.replace(/:/g, colon);\n        this.formula = this.formula.replace(/\"\"\"\"/g, fqm);\n        this.formula = this.formula.replace(/!/g, exclamationPoint);\n        this.formula = this.formula.replace(/{/g, braceLeft);\n        this.formula = this.formula.replace(/}/g, braceRight);\n        this.formula = this.formula.replace(/#/g, '');\n        this.formula = this.formula.replace(/\\./g, 'a');\n        this.formula = this.formula.replace(/[0-9][0-9]*/g, 'a');\n        this.formula = this.formula.replace(/\\“/g, '\"');\n        this.formula = this.formula.replace(/\\（/g, '(');\n        this.formula = this.formula.replace(/\\）/g, ')');\n        this.formula = this.formula.replace(/\\”/g, '\"');\n        this.formula = this.formula.replace(/\\%/g, '');\n        this.formula = this.formula.replace(/\\,/g, '');\n        this.formula = this.formula.replace(/\\，/g, '');\n        this.formula = this.formula.replace(/\"([\\s\\S]{1,})\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"\"/, \"\")\n    }\n\n    parse() {\n        this.preProcess();\n        let {formula} = this;\n        this.ast = recast.parse(formula);\n    }\n\n    ignoreSpace() {\n\n    }\n}","import CellRange from \"./cell_range\";\n\nexport default class PasteProxy {\n    constructor(srcCellRange, dstCellRange, rows) {\n        this.srcCellRange = \"\";\n        this.dstCellRange = \"\";\n        this.srcOneDRange = \"\";\n        this.dstOneDRange = \"\";\n    }\n\n    setSrcAndDstCellRange(srcCellRange, dstCellRange) {\n        this.srcCellRange = srcCellRange;\n        this.dstCellRange = dstCellRange;\n    }\n\n    use() {\n        let {srcCellRange, dstCellRange} = this;\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n\n        return {\n            sri, sci, eri, eci, dsri, dsci, deri, deci, rn, cn, drn, dcn\n        }\n    }\n\n    autoFilterDirection() {\n        let {sri, dsri, deri, eri} = this.use();\n\n        let isLeftRight = false; // 识别方向  上下false、左右true\n        if (sri == dsri && deri == eri) {\n            isLeftRight = true;\n        }\n\n        return isLeftRight;\n    }\n\n    upOrDown() {\n        let {deri, sri, deci, sci,} = this.use();\n        let isDown = true;       // 往上是false, 往下是true     // isDown\n        if (deri < sri || deci < sci) {\n            isDown = false;\n        }\n\n        return isDown;\n    }\n\n    leftOrRight() {\n        let {\n            srcOneDRange,\n            dstOneDRange\n        } = this.getRangeByWay();\n\n        let line = 1;       // 往左往右\n        if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci > srcOneDRange.eci) {\n            line = 2;       // 往右\n        } else if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci < srcOneDRange.eci) {\n            line = 3;       // 往左\n        }\n        return line;\n    }\n\n    getOneDRangeObj(way, offset) {\n        let {sri, sci, eri, eci, dsri, dsci, deri, deci} = this.use();\n\n        if (!way) {\n            this.srcOneDRange = new CellRange(sri, sci + offset, eri, sci + offset);\n            this.dstOneDRange = new CellRange(dsri, dsci + offset, deri, dsci + offset);\n        } else {\n            this.srcOneDRange = new CellRange(sri + offset, sci, sri + offset, eci);\n            this.dstOneDRange = new CellRange(dsri + offset, dsci, dsri + offset, deci);\n        }\n\n        return this.getRangeByWay();\n    }\n\n    getRangeByWay() {\n        return {\n            \"srcOneDRange\": this.srcOneDRange,\n            \"dstOneDRange\": this.dstOneDRange\n        }\n    }\n\n    // todo 什么意思\n    isCopy(sarr, i) {\n        let {sri, sci, eri} = this.use();\n        let isCopy = false;\n        if (sarr.length > 1) {\n            isCopy = true;\n        }\n        if (sri == eri && sci + i == sci + i) {\n            isCopy = true;\n        }\n\n        return isCopy;\n    }\n\n    calcDiff(sarr, isAdd) {\n        let diffValue = 1;\n\n        if (!isAdd) {\n            diffValue = 1;\n        }\n\n        if (isAdd && sarr.length > 1) {\n            let last2 = sarr[sarr.length - 2];\n            let last1 = sarr[sarr.length - 1];\n            diffValue = last1.text * 1 - last2.text * 1;\n        } else if (sarr.length > 1) {\n            let last2 = sarr[1];\n            let last1 = sarr[0];\n            diffValue = last1.text * 1 - last2.text * 1;\n        }\n\n        if(isNaN(diffValue)) {\n            diffValue = 1;\n        }\n\n        return diffValue;\n    }\n}","import {isHave} from \"./helper\";\nimport {isFormula} from \"./row\";\nimport {datePattern2, str2Re} from \"../utils/reg_pattern\";\n\nexport default class CellProxy {\n    constructor(cell) {\n        this.cell = cell;\n    }\n\n    renderFormat(style, nrindex, cindex, data, filter) {\n        if(isHave(style) === false || isHave(style.format) === false) {\n            return {\n                \"cellText\": \"\",\n                \"state\": false,\n            };\n        }\n\n        let {cell} = this;\n        let cellText = \"\";\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            let formatInfo = data.tryParseToNum(cell, nrindex, cindex);\n            if(formatInfo.state) {\n                if(filter) {\n                    if((formatInfo.style === 'date' || formatInfo.style === 'datetime')) {\n                        cellText = formatInfo.text;\n                    } else {\n                        formatInfo.state = false;\n                    }\n                }  else {\n                    cellText = formatInfo.text;\n                }\n            } else {\n                if( isHave(cell.text) === false) {\n                    cell.text = \"\";\n                }\n                cellText = cell.text;\n            }\n            return {\n                \"cellText\": cellText,\n                \"state\": formatInfo.state,\n            };\n        }\n        return {\n            \"cellText\": cellText,\n            \"state\": false,\n        };\n    }\n\n    getCellDataType(sarr, {isDate, isNumber}) {\n        let ncell = this.cell;\n        // let enter = false;\n        let nA = true;\n\n\n        if (!isHave(ncell.formulas)) {\n            ncell.formulas = \"\";\n        }\n        if (!isHave(ncell.text)) {\n            ncell.text = \"\";\n        }\n\n        let value = ncell.formulas !== \"\" ? ncell.formulas + \"\" : ncell.text + \"\";\n        // value = value.replace(/,/g, \"\").replace(\"=\", \"\");\n        value = value.replace(/,/g, \"\");        // =123 不要把=扔掉\n        let ns = value * 1;\n\n        if ((ns || ns == 0) && typeof ns === 'number' && !isNaN(ns) && /^\\d+$/.test(value) === true) {\n            if(isNumber == true) {\n                isNumber = true;\n                nA = false;\n                isDate = false;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'number';\n        } else if (value && nA == true && isFormula(value)) {\n            nA = true;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'na';\n        } else if (value && value.search(str2Re(datePattern2), '') != -1) {\n            if( isDate == true) { // jobs: todo: 正则表达式应该集中管理。而且这个正则表达式太复杂了，应该能简化。\n                nA = false;\n                isNumber = false;\n                isDate = true;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'date';\n        } else {//\n            nA = false;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'other';\n        }\n        ncell.tmp = value;\n        sarr.push(ncell);\n\n        return {\n            nA, isDate: isDate, isNumber: isNumber\n        }\n    }\n}\n","import {isHave} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\n\nexport default class CellProp {\n    constructor(ri, ci, cell, expr, empty) {\n        this.ri = ri;\n        this.ci = ci;\n        this.cell = cell;\n        this.expr = expr;\n        this.empty = empty;\n    }\n\n    isInclude() {\n\n    }\n\n\n    each(cb) {\n        let {cell} = this;\n        if(isHave(cell.depend) === false) {\n            return;\n        }\n        for(let i = 0; i < cell.depend.length; i++) {\n            let expr = cell.depend[i];\n            let [ci, ri] = expr2xy(expr);\n            cb(ri, ci);\n        }\n    }\n}","import {isHave} from \"../core/helper\";\n\n\n/**\n * Cell类，代表一个单元格的数据格式。\n */\nexport default class Cell {\n    /**\n     * @constructor\n     * @param text - 单元格的文本。\n     * @param formulas - 单元格的公式\n     * @param style - 单元格的样式, 如果为null,则表示是默认样式\n     * @param depend - 其他单元格依赖\n     * @param merge - 为null表示不是合并单元格，否则为一个合并单元格\n     * @param formatText - 单元格的格式，若为null，则表明没有格式\n     * @param multivalueRefsCell - 用来标记多值单元格\n     */\n    constructor() {\n        this.text = \"\";\n        this.depend = [];\n        this.formulas = \"\";\n\n        this.style = null;\n        this.merge = null;\n        this.formatText = null;\n        this.multivalueRefsCell = null;\n        this.source_v = null;\n    }\n\n    /**\n     * 设置单元格信息\n     */\n    setCell(cell) {\n        if (!isHave(cell)) {\n            return;\n        }\n\n        if (isHave(cell.text)) {\n            this.text = cell.text;\n        }\n\n        if (isHave(cell.formulas)) {\n            this.formulas = cell.formulas;\n        }\n\n        if(isHave(cell.formatText)) {\n            this.formatText = cell.formatText;\n        }\n\n        if (isHave(cell.depend)) {\n            this.depend = cell.depend;\n        }\n\n        if (isHave(cell.style)) {\n            this.style = cell.style;\n        }\n\n        if (isHave(cell.multivalueRefsCell)) {\n            this.multivalueRefsCell = cell.multivalueRefsCell;\n        }\n\n        if (isHave(cell.merge)) {\n            this.merge = cell.merge;\n        }\n\n        if (isHave(cell.source_v)) {\n            this.source_v = cell.source_v;\n        }\n    }\n\n    /**\n     * 设置单元格的格式\n     * @param args args.state 为true表示存在格式，为false不存在格式, text 具体格式信息\n     */\n    setFormatText(args) {\n        if(args.state) {\n            this.formatText = args.text;\n        }\n    }\n}","import helper, {isHave} from './helper';\nimport {xy2expr} from './alphabet';\nimport {changeFormula, cutStr, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport dayjs from 'dayjs'\nimport {deepCopy, distinct, isSheetVale, splitStr} from \"./operator\";\nimport Recast from \"./recast\";\nimport PasteProxy from \"./paste_proxy\";\nimport CellProxy from \"./cell_proxy\";\nimport CellRange from \"./cell_range\";\nimport CellProp from \"../model/cell_prop\";\nimport Cell from \"../model/cell\";\nvar calcUtils = require('../calc/utils');\n\nexport function isFormula(text) {\n    if (text && text[0] === \"=\") {\n        return true;\n    }\n\n    return false;\n}\n\nfunction isEmpty(text, formulas, formatText) {\n    if(isHave(text) && text !== \"\") {\n        return false;\n    }\n\n    if(isHave(formulas) && formulas !== \"\") {\n        return false;\n    }\n\n    if(isHave(formatText)) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction otherAutoFilter(d, darr, direction, isAdd, what, cb, other, dri) {\n    // other 为 '=asd'或者'asd'也为false\n    let ncell = this.getCellByTopCell(d, direction, isAdd, 'other', dri, 0);\n\n    let {text, formulas} = ncell;\n    let iText = formulas != \"\" ? formulas : text;\n\n    // if (other) {\n    //     this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    // } else\n    if (this.isFormula(iText)) {\n        this.calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb);\n    } else {\n        // 为 '=asd'或者'asd' 进这里\n        this.calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text);\n    }\n}\n\nfunction numberAutoFilter(d, darr, direction, isAdd, diffValue, what, cb, isNumber) {\n    let ncell = \"\";\n\n    if (isAdd) {\n        diffValue = Math.abs(diffValue);\n    } else {\n        diffValue = diffValue * -1;\n    }\n\n    if (!isNumber) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        }\n        diffValue = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isAdd);\n    }\n\n    this.calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb);\n}\n\nfunction dateAutoFilter(d, line, isDown, darr, what, cb, isDate) {\n    let direction = line;\n    let ncell = \"\";\n    let diff = isDown ? 1 : -1;\n    if (!isDate) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diff = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isDown, 'date');\n    }\n    this.calcDateCellByTopCell(ncell, darr, d, isDown, what, cb, diff);\n}\n\nclass Rows {\n    constructor({len, height}, data = \"\") {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n        this.data = data;\n        this.pasteProxy = new PasteProxy();\n        this.workbook = null;\n    }\n\n    getHeight(ri) {\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined\n            && (isHave(row.cells[ci].text) || isHave(row.cells[ci].formulas) || isHave(row.cells[ci].style || typeof row.cells[ci] === 'object'))) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    toString(text) {\n        if (isHave(text) === false) {\n            text = \"\";\n        }\n        return text + \"\";\n    }\n\n    isBackEndFunc(text) {\n        if (text.indexOf(\"MD.RTD\") != -1) {\n            return true;\n        }\n\n        return false;\n    }\n\n    isReferOtherSheet(cell, state = false) {\n        if (cell.formulas && cell.formulas[0] == \"=\" && (state || isSheetVale(cell.formulas))) {\n            return true;\n        }\n        return false;\n    }\n\n    isEmpty(cell) {\n        if (cell && (cell.text || cell.formulas || cell.depend)) {\n            return false;\n        }\n        return true;\n    }\n\n    isFormula(text) {\n        return isFormula(text);\n    }\n\n    setValue(type, value, cell) {\n        cell[type] = value;\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        let {data} = this;\n        const row = this.getOrNew(ri);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        if (what === 'all') {\n            row.cells[ci] = _cell;\n        } else if(what === 'formulas') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].formulas = _cell.formulas;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = _cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = _cell.style;\n            if (cell.merge) row.cells[ci].merge = _cell.merge;\n        } else if (what === 'date' || what === 'datetime') {\n            // row.cells[ci] = {};\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n            row.cells[ci].to_calc_num = _cell.to_calc_num;\n        } else if (what === 'normal' || what === 'number') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            // row.cells[ci].value = cell.value;\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'rmb' || what === 'percent') {        // rmb 单独拿出来是因为 text是￥123, 而formalus不能是 ￥123,应该是123\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].formulas = _cell.formulas;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'all_with_no_workbook') {\n            row.cells[ci] = _cell;\n\n            return;\n        } else if (what === 'style') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {};\n            }\n\n            row.cells[ci].style = _cell.style;\n            return;\n        }\n        // cell\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n        _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n    }\n\n    getDependCell(expr, cell) {\n        let {formulas} = cell;\n        if (isHave(formulas) === false) {\n            return;\n        }\n        if (isFormula(formulas)) {\n            let arr = cutStr(formulas, true, true);\n\n            for (let i = 0; i < arr.length; i++) {\n                let args = this.mergeCellExpr(arr[i]);\n                if (args.state) {\n                    arr.push(...args.mergeArr);\n                }\n            }\n            arr = distinct(arr);\n\n            if (isHave(cell.depend) === false) {\n                cell.depend = [];\n            }\n            for (let i = 0; i < arr.length; i++) {\n                let ref = arr[i];\n                let [ci, ri] = expr2xy(ref);\n                let refCell = this.getCell(ri, ci);\n                if (isHave(refCell) === false) {\n                    refCell = {};\n                }\n\n                if (isHave(refCell.depend) === false) {\n                    refCell.depend = [];\n                }\n                refCell.depend.push(expr);\n                refCell.depend = distinct(refCell.depend);\n                this.setCell(ri, ci, refCell, 'all_with_no_workbook');\n            }\n        }\n    }\n\n    mergeCellExpr(d) {\n        if (!isAbsoluteValue(d, 6)) {\n            return {\n                \"state\": false,\n            }\n        }\n        d = d.replace(/\\$/g, '');\n        d = d.split(\":\");\n        let e1 = expr2xy(d[0]);\n        let e2 = expr2xy(d[1]);\n\n        if (e1[0] > e2[0]) {\n            let t = e2[0];\n            e2[0] = e1[0];\n            e1[0] = t;\n        }\n        if (e1[1] > e2[1]) {\n            let t = e2[1];\n            e2[1] = e1[1];\n            e1[1] = t;\n        }\n        let cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0]);\n        let arr = [];\n        cellRange.each((i, j) => {\n            arr.push(xy2expr(j, i));\n        });\n\n        return {\n            \"state\": true,\n            \"mergeArr\": arr,\n        };\n    }\n\n    useOne(param, other, value = true) {\n        if (isHave(param) === false) {\n            return other;\n        }\n\n        if (value && this.isFormula(param)) {\n            return other;\n        }\n        return param;\n    }\n\n    // what === cell 把原本的cell 的merge 清空， 原因是不清空 merge还会存在\n    setCellText(ri, ci, {text, style, formulas, merge = \"\"},  what = 'all') {\n        if(what === 'all_with_no_workbook') {\n            this.setCell(ri, ci, {}, 'all_with_no_workbook');\n            return;\n        }\n\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        // _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n        if (what === 'style') {\n            _cell.style = style;\n            _cell.formulas = text;   //    cell.formulas = cell.formulas;\n        }   else if (what === 'format') {\n            _cell.formulas = cell.formulas;\n            _cell.style = style;\n        } else if (what === 'cell') {\n            _cell.style = style;\n            _cell.formulas = formulas;\n            _cell['merge'] = undefined;\n            if (merge !== \"\") {\n                _cell.merge = merge;\n            }\n        } else {\n            _cell.formulas = text;\n        }\n        _cell.text = text;\n        this.setCell(ri, ci, _cell);\n\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    setCellAll(ri, ci, text, formulas = \"\", what = '') {\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.formulas = formulas == \"\" ? cell.formulas : formulas;\n        _cell.text = text;\n\n        this.setCell(ri, ci, _cell, 'formulas');\n        this.setCell(ri, ci, _cell, 'text');\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    moveChange(arr, arr2, arr3) {\n        if (arr.length != arr2.length && arr3.length != arr2.length) {\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n\n            let s1 = arr[i].expr;\n            arr[i].each((ri, ci) => {\n                let cell = this.getCell(ri, ci);\n                if (isHave(cell) === false) {\n                    cell = {};\n                }\n                if (!isHave(cell.formulas)) {\n                    cell.formulas = \"\";\n                }\n\n                let formulas = changeFormula(cutStr(cell.formulas));\n\n                if (formulas.indexOf(s1) != -1) {\n                    let ca = arr3[i].expr.replace(/\\$/g, \"\\\\$\");\n\n                    this.setCellAll(ri, ci, cell.text.replace(new RegExp(ca, 'g'), arr2[i].expr), cell.formulas.replace(ca, arr2[i].expr));\n                } else {\n                    let s = value2absolute(s1);\n                    let es = value2absolute(arr2[i].expr);\n                    if (formulas.indexOf(s.s3) != -1) {\n                        s = value2absolute(arr3[i].expr);\n\n                        s.s3 = s.s3.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s3, 'g'), es.s3), cell.formulas.replace(new RegExp(s.s3, 'g'), es.s3));\n                    } else if (formulas.indexOf(s.s2) != -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s2 = s.s2.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s2, 'g'), es.s2), cell.formulas.replace(new RegExp(s.s2, 'g'), es.s2));\n                    } else if (formulas.indexOf(s.s1) != -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s1 = s.s1.replace(/\\$/g, \"\\\\$\");\n\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s1, 'g'), es.s1), cell.formulas.replace(new RegExp(s.s1, 'g'), es.s1));\n                    }\n                }\n            });\n        }\n    }\n\n    formatMoney(s, type) {\n        if (/[^0-9\\.]/.test(s))\n            return \"0\";\n        if (s == null || s == \"\")\n            return \"0\";\n        s = s.toString().replace(/^(\\d*)$/, \"$1.\");\n        s = (s + \"00\").replace(/(\\d*\\.\\d\\d)\\d*/, \"$1\");\n        s = s.replace(\".\", \",\");\n        let re = /(\\d)(\\d{3},)/;\n        while (re.test(s))\n            s = s.replace(re, \"$1,$2\");\n        s = s.replace(/,(\\d\\d)$/, \".$1\");\n        if (type == 0) {\n            let a = s.split(\".\");\n            if (a[1] == \"00\") {\n                s = a[0];\n            }\n        }\n        return s;\n    }\n\n    // isValid => true 为日期  false 为 数字\n    getCellStyleConvert(cellStyle, isValid) {\n        if (cellStyle && cellStyle.format && cellStyle.format === 'number') {\n            return \"number\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'rmb') {\n            return 'rmb';\n        } else if ((cellStyle && cellStyle.format && cellStyle.format === 'normal')) {\n            return \"normal\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'percent') {\n            return \"percent\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'datetime') {\n            return \"datetime\";\n        } else if (\n            (isValid && !isHave(cellStyle))\n            || (isValid && cellStyle && cellStyle.format !== 'normal')\n            || cellStyle && cellStyle.format && cellStyle.format === 'date') {\n            return \"date\";\n        }\n\n        return \"\";\n    }\n\n    getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, abs = 0, isRows) {\n        let enter = false;\n        let s = \"\";\n        if (isInsert) {\n            if (sri <= ds[1] && isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[1] && !isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[0] && isAdd && isRows === false) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            }\n        }\n\n        return {\n            \"enter\": enter,\n            \"data\": s,\n        }\n    }\n\n    eachRange(range) {\n        let cells = [];\n        range.each((i, j) => {\n            let cell = this.getCell(i, j);\n            if (isHave(cell)) {\n                let empty = isEmpty(cell);\n                cell = deepCopy(cell);\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), empty);\n                cells.push(cellProp);\n            } else  {\n                cell = {};\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), true);\n                cells.push(cellProp);\n            }\n        });\n\n        return cells;\n    }\n\n    getCellTextByShift(arr, dei, dci, isInsert = false, isAdd = false, sri = 0, isRows = false) {\n        let bad = false;\n        let enter = false;\n        let newStr = \"\";\n\n        for (let i = 0; i < arr.length; i++) {\n            // if(isInsert && isHave(arr[i])) {\n            //     arr[i] = arr[i].replace(/\\$/, '');\n            // }\n            if (typeof arr[i] === 'string') {\n                arr[i] = arr[i].toUpperCase();\n            }\n            if (arr[i].search(/^[A-Z]+\\d+$/) != -1) {\n                let ds = expr2xy(arr[i]);\n                if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    arr[i] = args.data;\n                } else if (isInsert === false) {\n                    arr[i] = xy2expr(ds[0] + dei, ds[1] + dci);\n                }\n                enter = true;\n            } else if (arr[i].search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                let a1 = arr[i].split(\":\")[0];\n                let a2 = arr[i].split(\":\")[1];\n                let ds1 = expr2xy(a1);\n                let ds2 = expr2xy(a2);\n\n                if (ds1[0] + dei < 0 || ds1[1] + dci < 0) {\n                    bad = true;\n                }\n                if (ds2[0] + dei < 0 || ds2[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let s = \"\";\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds1, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s = args.data + \":\";\n                } else if (isInsert == false) {\n                    s = xy2expr(ds1[0] + dei, ds1[1] + dci) + \":\";\n                } else {\n                    s = a1 + \":\";\n                }\n\n                args = this.getCellTextIsAdd(isInsert, sri, ds2, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s += args.data;\n                } else if (isInsert == false) {\n                    s += xy2expr(ds2[0] + dei, ds2[1] + dci);\n                } else {\n                    s += a2;\n                }\n\n                enter = true;\n                arr[i] = s;\n            } else {\n                let value = isAbsoluteValue(arr[i], 5);\n\n                if (value === 2) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0] + dei, ds[1], 2);\n                    }\n                    enter = true;\n                } else if (value === 1) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0], ds[1] + dci, 1);\n                    }\n\n                    enter = true;\n                } else if (value === 4) {\n                    let sp = arr[i].split(\":\");\n                    console.log(arr[i], sp);\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 5) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 7) {\n                    let sp = arr[i].split(':');\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 6) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 8) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 9) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 10) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 11) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                }\n            }\n            newStr += arr[i];\n        }\n\n        return {\n            \"bad\": bad,\n            \"enter\": enter,\n            \"result\": newStr\n        };\n    }\n\n    autoFilterRef(ref, range) {\n        let [ci, ri] = expr2xy(ref);\n        let cell = this.getCell(ri, ci);\n        while (cell !== null) {\n            ri += 1;\n            cell = this.getCell(ri, ci);\n        }\n        range.eri = ri;\n\n        return range;\n    }\n\n    // getAllDataType(cellRange)\n    getAllDataType(cellRange) {\n        const {pasteProxy} = this;\n        let isNumber = true, isDate = true, sarr = [];\n\n        cellRange.each((i, j) => {\n            let und = false, cell = this.getCell(i, j);\n            if (cell) {\n                cell = deepCopy(cell);\n                let args = new CellProxy(cell).getCellDataType(sarr, {isDate, isNumber});\n                // pasteProxy.getCellDataType(cell, sarr, {isDate, isNumber}); // let args = CellProxy(cell).getCellDataType()\n                isDate = args.isDate;\n                isNumber = args.isNumber;\n            } else {\n                und = true;\n                isNumber = false;\n                isDate = false;\n            }\n\n            if (und) {\n                sarr.push({\n                    text: 0,\n                    formulas: 0,\n                    tmp: \"\",\n                    type: \"other\",\n                });\n            }\n        });\n\n        return {\n            isDate: isDate, isNumber: isNumber, sarr\n        }\n    }\n\n    calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb) {\n        let {text, formulas} = ncell;\n        text = this.toString(text);\n        formulas = this.toString(formulas);\n        let cell = {};\n        if (this.isFormula(formulas)) {\n            let last1 = text.replace(\"=\", \"\") * 1;\n\n            let value = last1 + diffValue;\n            cell = {\n                \"text\": \"=\" + value + \"\",\n                \"formulas\": \"=\" + value + \"\",\n            };\n        } else if (text !== '') {\n            let last1 = text * 1;\n            if (text.indexOf(\",\") != -1) {\n                last1 = last1.replace(/,/g, '');\n                let value = parseFloat(last1) + diffValue;\n                last1 = this.formatMoney(value, 0);\n            } else {\n                last1 = last1 + diffValue;\n            }\n\n            cell = {\n                \"text\": last1 + \"\",\n                \"formulas\": last1 + \"\",\n            };\n        }\n\n        this.copyRender(darr, d.ri, d.ci, cell, what, cb);\n    }\n\n    calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb) {\n        let strList = splitStr(iText);\n        let args = this.getRangeByTopCell({ri: d.ri, ci: d.ci}, direction, isAdd);\n        let dci = d.ri - args.ri;\n        let dri = d.ci - args.ci;\n        let {bad, result} = this.getCellTextByShift(strList, dri, dci);\n        this.updateCellReferenceByShift(bad, result, d.ri, d.ci, cb);\n    }\n\n    calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text) {\n\n        if (!isHave(iText)) {\n            iText = \"\";\n        }\n        if (!isNaN(iText)) {\n            ncell.text = iText;\n            ncell.formulas = ncell.text;\n        } else {\n            let arr = this.toString(iText).split(/\\d+/g);\n            if (arr) {\n                let count = 0;\n                if (isAdd) {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 + 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                } else {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 - 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                }\n                ncell.formulas = ncell.text;\n            }\n        }\n        this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    }\n\n    calcDateCellByTopCell(ncell, darr, d, isAdd, what, cb, diff) {\n        if (ncell.text != '') {\n            let last1 = ncell.text;\n\n            let value = \"\";\n            if (isAdd) {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            } else {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            }\n            ncell.text = this.toString(value);\n            ncell.formulas = this.toString(value);\n            this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n        }\n    }\n\n    getRangeByTopCell({ri, ci}, direction, isAdd) {\n        if (isAdd) {\n            ri = !direction ? ri - 1 : ri;\n            ci = !direction ? ci : ci - 1;\n        } else {\n            ri = !direction ? ri + 1 : ri;\n            ci = !direction ? ci : ci + 1;\n        }\n\n        return {ri, ci};\n    }\n\n    // logProxy.log({\"msg\":\"12312\"})  console.log --> logProxy.log\n    getCellByTopCell(d, direction, isAdd, what = 'all', dri = 0, dci = 0) {\n        if (what === 'date') {\n            if (direction === 1) {\n                let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, false, isAdd);\n                return this.getCellByCell(ri, ci);\n            } else if (direction === 2) {\n                return this.getCellByCell(d.ri, d.ci - 1);\n            } else if (direction === 3) {\n                return this.getCellByCell(d.ri, d.ci + 1);\n            }\n        } else {\n            let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, direction, isAdd);\n            return this.getCellByCell(ri, ci);\n        }\n    }\n\n    getCellByCell(ri, ci) {\n        let ncell = this.getCell(ri, ci);\n        if (!ncell) {\n            ncell = {\n                text: '',\n                formulas: '',\n            }\n        }\n\n        return helper.cloneDeep(ncell);\n    }\n\n    updateCellReferenceByShift(bad, result, ri, ci, cb = () => {\n    }) {\n        let _cell = {};\n        if (bad) {\n            _cell.text = \"#REF!\";\n            _cell.formulas = \"#REF!\";\n        } else {\n            _cell.text = result != \"\" ? result : innerText;\n            _cell.formulas = result != \"\" ? result : innerText;\n        }\n        // rows.setCellText(ri, ci, {text, style}, proxy, this.name, 'style');\n        this.setCell(ri, ci, _cell, 'all');\n        cb(ri, ci, _cell);\n    }\n\n    // what: all | format | text\n    // 填充\n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {pasteProxy} = this;\n        pasteProxy.setSrcAndDstCellRange(srcCellRange, dstCellRange);\n        let {rn, cn} = pasteProxy.use();\n        let isLeftRight = pasteProxy.autoFilterDirection(); // todo: upOrDownOrLeftOrRight = pateProxy.getUpDownLeftRight() 去掉482\n\n        let len = isLeftRight ? rn : cn;\n        for (let i = 0; i < len; i++) {\n            let isDown = pasteProxy.upOrDown();\n            let {srcOneDRange, dstOneDRange} = pasteProxy.getOneDRangeObj(isLeftRight, i);\n            let {isNumber, isDate, sarr} = this.getAllDataType(srcOneDRange); // todo: 改成与Excel一样的逻辑 let {isNumber, isDate, sarr} = this.getRangeDataType(srcOneDRange);\n            // let isCopy = pasteProxy.isCopy(sarr, i);\n\n            let darr = dstOneDRange.getLocationArray(sarr); //let dstOneDLocationAarray = dstOneDRange.getLocationArray()\n            let line = pasteProxy.leftOrRight(); // 向左或者向右\n            let other = false;\n\n            for (let i = 0; i < darr.length; i++) {\n                let d = darr[i];\n                if (isNumber || d.type === 'number' || isDate || d.type === 'date') {\n                    other = true;\n                }\n            }\n\n            if (isDown) {\n                for (let i = 0; i < darr.length; i++) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            } else {\n                for (let i = darr.length - 1; i >= 0; i--) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            }\n        }\n    }\n\n\n    copyRender(darr, nri, nci, ncell, what, cb) {\n        let as = false;\n        for (let k = 0; as == false && k < darr.length; k++) {\n            if (darr[k].ri == nri && darr[k].ci == nci) {\n                as = true;\n            }\n        }\n        if (as) {\n            this.setCell(nri, nci, ncell, what);\n            cb(nri, nci, ncell);\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        let srcCell = [];\n        // const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n\n                if (ri * 1 !== nri || ci * 1 !== nci) {\n                    // ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                    if (this._[ri].cells[ci].text != '' && this._[ri].cells[ci].formulas != '') {\n                        srcCell.push({\n                            nri: nri,\n                            nci: nci,\n                            ri: ri,\n                            ci: ci,\n                            cell: deepCopy(this._[ri].cells[ci]),\n                        })\n                        // this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    }\n\n                    // if (this._[ri].cells[ci].style) {\n                    //     this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    // }\n                }\n            });\n        });\n        for (let i = 0; i < srcCell.length; i++) {\n            let {ri, ci, cell} = srcCell[i];\n            this.setCell(ri, ci, {}, 'all');\n        }\n\n        for (let i = 0; i < srcCell.length; i++) {\n            let {nri, nci, cell} = srcCell[i];\n            this.setCell(nri, nci, cell, 'all');\n        }\n\n        // this._ = ncellmm;\n    }\n\n    insert(sri, n = 1) {\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= sri) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n, true, true, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n\n            ndata[nri] = row;\n        });\n\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n * -1, true, false, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri - n, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1) {\n        let cells = [];\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= sci) {\n                    nci += n;\n\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), n, 0, true, true, sci, false);\n                        if (enter && !bad) {\n                            cells.push({ri: ri, ci: nci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (isHave(cell.text)) delete cell.text;\n                    if (isHave(cell.value)) delete cell.value;\n                    if (isHave(cell.formulas)) delete cell.formulas;\n                    // if (isHave(cell.depend)) delete cell.depend;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    recast(cell) {\n        try {\n            if (this.isReferOtherSheet(cell, true)) {\n                let recast = new Recast(cell.formulas);\n                recast.parse();\n                cell['recast'] = recast;\n            } else {\n                cell['recast'] = null;\n            }\n        } catch (e) {\n            cell['recast'] = null;\n        }\n    }\n\n    init() {\n        this.each((ri, row) => {\n            this.eachCells(ri, (ci, cell) => {\n                this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n            });\n        });\n    }\n\n    setData(d, sheet = \"\", out = false, rowsInit = false) {\n        try {\n            if (d.len) {\n                this.len = d.len;\n                delete d.len;\n            }\n            this._ = d;\n\n\n            if (out) {\n\n            } else if (sheet !== '') {\n                console.time(\"setData\")\n                if (rowsInit) {\n                    this.init();\n                    this.workbook = calcUtils.Rows2Workbook(this);\n                    sheet.toolbar.change('close', '');\n                }\n                console.timeEnd(\"setData\")\n\n            }\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n}\n\nexport default {};\nexport {\n    Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  setStyle(ci, style) {\n    const col = this.getOrNew(ci);\n    col.style = style;\n  }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport default {};\nexport {\n  Cols,\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport default {};\nexport {\n  Validations,\n};\n","export default class Moved {\n    constructor() {\n        this.range = null;\n        this.state = 'move';\n    }\n\n    move(cellRange) {\n        this.range = cellRange;\n        this.state = 'move';\n\n        return this;\n    }\n}","/* global window */\n\n// import {setColor} from \"../plug-in/revision\";\n\nlet removeEvent = [];\n\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n    removeEvent.push({\n        name: name,\n        fn: fn,\n        target: target\n    })\n}\n\nexport function remove() {\n    for (let i = 0; i < removeEvent.length; i++) {\n        let re = removeEvent[i];\n        unbind(re.target, re.name, re.fn);\n    }\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\nexport function createEvent(keyCode, metaKey, name = \"keydown\", buttons = -1) {\n    let event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventType = 'message';\n    event.buttons = buttons;\n    event.keyCode = keyCode;\n    event.metaKey = metaKey;\n    document.dispatchEvent(event);\n}\n\n// the left mouse button: mousedown → mouseup → click\n// the right mouse button: mousedown → contenxtmenu → mouseup\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\nexport function bindClickoutside2(el, revision) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.buttons === 2 || el.contains(evt.target)) return;\n        else {\n            // setColor.call(revision);\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'mousedown', el.xclickoutside);\n}\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    const t = target;\n    t.xEvtUp = (evt) => {\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n","/* global window */\nimport {h} from './element';\nimport {mouseMoveUp} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Resizer {\n    constructor(vertical = false, minDistance) {\n        this.moving = false;\n        this.vertical = vertical;\n        this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n            this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n                .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n            this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n        ).hide();\n        // cell rect\n        this.cRect = null;\n        this.finishedFn = null;\n        this.minDistance = minDistance;\n    }\n\n    // rect : {top, left, width, height}\n    // line : {width, height}\n    show(rect, line) {\n        const {\n            moving, vertical, hoverEl, lineEl, el,\n        } = this;\n        if (moving) return;\n        this.cRect = rect;\n        const {\n            left, top, width, height,\n        } = rect;\n        el.offset({\n            left: vertical ? left + width - 5 : left,\n            top: vertical ? top : top + height - 5,\n        }).show();\n        hoverEl.offset({\n            width: vertical ? 5 : width,\n            height: vertical ? height : 5,\n        });\n        lineEl.offset({\n            width: vertical ? 0 : line.width,\n            height: vertical ? line.height : 0,\n        });\n    }\n\n    hide() {\n        this.el.offset({\n            left: 0,\n            top: 0,\n        }).hide();\n    }\n\n    mousedownHandler(evt) {\n        let startEvt = evt;\n        const {\n            el, lineEl, cRect, vertical, minDistance,\n        } = this;\n        let distance = vertical ? cRect.width : cRect.height;\n        // console.log('distance:', distance);\n        lineEl.show();\n        mouseMoveUp(window, (e) => {\n            this.moving = true;\n            if (startEvt !== null && e.buttons === 1) {\n                // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n                if (vertical) {\n                    distance += e.movementX;\n                    if (distance > minDistance) {\n                        el.css('left', `${cRect.left + distance}px`);\n                    }\n                } else {\n                    distance += e.movementY;\n                    if (distance > minDistance) {\n                        el.css('top', `${cRect.top + distance}px`);\n                    }\n                }\n                startEvt = e;\n            }\n        }, () => {\n            startEvt = null;\n            lineEl.hide();\n            this.moving = false;\n            this.hide();\n            if (this.finishedFn) {\n                if (distance < minDistance) distance = minDistance;\n                this.finishedFn(cRect, distance);\n            }\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {moveArr} from \"../event/paste\";\n\nexport default class Scrollbar {\n    constructor(vertical) {\n        this.vertical = vertical;\n        this.moveFn = null;\n        this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n            .child(this.contentEl = h('div', ''))\n            .on('mousemove.stop', () => {\n            })\n            .on('scroll.stop', (evt) => {\n                let {scrollTop, scrollLeft} = evt.target;\n                // scrollTop = scrollTop * 2;\n                // moveArr.call(this.sheet, scrollTop, scrollLeft);\n                if (this.moveFn) {\n                    this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n                }\n\n                // console.log('evt:::', evt);\n            });\n    }\n\n    move(v) {\n        // debugger\n        this.el.scroll(v);\n        return this;\n    }\n\n    scroll() {\n        return this.el.scroll();\n    }\n\n    set(distance, contentDistance) {\n        const d = distance - 1;\n        // console.log('distance:', distance, ', contentDistance:', contentDistance);\n        if (contentDistance > d) {\n            const cssKey = this.vertical ? 'height' : 'width';\n            this.el.css(cssKey, `${d - 15}px`).show();\n            this.contentEl\n                .css(this.vertical ? 'width' : 'height', '1px')\n                .css(cssKey, `${contentDistance}px`);\n        } else {\n            this.el.hide();\n        }\n        return this;\n    }\n}\n","import {CellRange} from \"../core/cell_range\";\nimport {cssPrefix} from \"../config\";\nimport {h} from \"./element\";\nimport {selectorHeightBorderWidth} from \"./selector\";\n\nexport default class SelectorCell {\n    constructor(data) {\n        this.el = h('div', `${cssPrefix}-selector-cell`);\n        this.data = data;\n        // this.direction = 1;     // 1 左上 2 右上 3左下 4右下\n        this._ = new CellRange(0, 0, 0, 0);\n    }\n\n    resetSelectOffset() {\n        let rect = this.data.getRect(this._);\n        this.setOffset(rect);\n    }\n\n    setData(ri, ci) {\n        ri = ri === -1 ? 0 : ri;\n        ci = ci === -1 ? 0 : ci;\n\n        let {data} = this;\n        let {merges} = data;\n\n        console.log(this._);\n        let enter = false;\n        merges.each(range => {\n            if (range.includeByRiCi(ri, ci)) {\n                this._ = range;\n                enter = true;\n            }\n        });\n\n        if (!enter) {\n            this._ = new CellRange(ri, ci, ri, ci);\n        }\n    }\n\n    toolbarChangeSelectorCell() {\n        let ri = this._.sri;\n        let ci = this._.sci;\n\n        this.setData(ri, ci);\n    }\n\n    setOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.el.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {xy2expr} from \"../core/alphabet\";\nimport {deepCopy} from '../core/operator';\nimport SelectorCell from \"./selector_cell\";\nimport CellProp from \"../model/cell_prop\";\n\nexport const selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n\n                } else {\n                    this.moveEvent(1);\n                }\n\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(2);\n                }\n            }).on('click', (evt) => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                }\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    evt.stopPropagation();\n                }\n                this.moveEvent(3);\n            })\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(4);\n                }\n            })\n\n\n        this.cornerEl.on('mousedown', evt => {\n            let {detail} = evt;\n            if (detail === 2) {\n                sheet.clickCopyPaste();\n                evt.stopPropagation();\n            }\n        });\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .children(this.cornerEl, this.boxinner).hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    border(value) {\n        this.areaEl.css('border', value);\n    }\n\n    longTimeBefore(time = 500) {\n        this.boxinner.hide();\n\n        setTimeout(() => {\n            this.boxinner.show();\n        }, time);\n    }\n\n    moveEvent(direction) {\n        console.log(60);\n        let {data, _selector, sheet,} = this;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = _selector.range;\n        let _cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let {selectorMoveEl} = sheet;\n        selectorMoveEl.set(-1, -1, true);\n        selectorMoveEl.hide();\n\n        mouseMoveUp(window, (e) => {\n            sheet.container.css('pointer-events', 'none');\n            _selector.setBoxinner(\"none\");\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                cellRange.move(ri, ci);\n                //     if(direction == 4) {\n                //         cellRange = new CellRange(eri, eci, eri, eci, w, h);\n                //     } else if(direction == 2) {\n                //         cellRange = new CellRange(sri, eci, eri, eci, w, h);\n                //     } else if(direction == 1) {\n                //         cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                // }\n\n                const rect = data.getMoveRect(cellRange);\n                selectorMoveEl.range = cellRange;\n                selectorMoveEl.setMove(rect);\n                selectorMoveEl.el.show();\n            }\n        }, (e) => {\n            // 如果移动的内容被单元格包含，则需要变化\n            let {rows} = data;\n            let arr = [], arr2 = [], arr3 = [];\n\n            _cellRange.each((i, j) => {\n                console.log(rows.getCell(i, j), i, j);\n                let cell = rows.getCell(i, j);\n                let movedCell = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}:${xy2expr(j, i)}`);\n                let movedCell2 = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}`);\n                arr.push(movedCell);\n                arr3.push(movedCell2);\n            });\n            cellRange.each((i, j) => {\n                let movedCell = new CellProp(i, j, deepCopy(rows.getCell(i, j) || {}), xy2expr(j, i));\n                arr2.push(movedCell);\n            });\n\n            data.cutPaste(_cellRange, cellRange, false);\n            sheet.container.css('pointer-events', 'auto');\n            _selector.setBoxinner(\"auto\");\n            selectorMoveEl.hide();\n\n            const rect = data.getMoveRect(cellRange);\n            selector.range = cellRange;\n            selector.ci = cellRange.sci;\n            selector.ri = cellRange.sri;\n\n            _selector.indexes = [selector.ri, selector.ci];\n            _selector.moveIndexes = [cellRange.sri, cellRange.sci];\n            _selector.range = cellRange;\n            _selector.setMove(rect);\n\n            sheet.selector.selectCell.setData(cellRange.sri, cellRange.sci);\n            // sheet.selectorMoveReset();\n\n            // 多个单元格\n            // if (_cellRange.eri != _cellRange.sri || _cellRange.eci != _cellRange.sci) {\n            //     let erpxArr = [];\n            //     let erpxArr2 = [];\n            //     let erpxArr3 = [];\n            //     for (let i = _cellRange.sci; i <= _cellRange.eci; i++) {\n            //         for (let j = _cellRange.sri; j <= _cellRange.eri; j++) {\n            //             erpxArr.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr.length; i++) {\n            //         for (let j = 0; j < erpxArr.length; j++) {\n            //             if (i <= j) {\n            //                 erpxArr2.push([i, j])\n            //             }\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr[a];\n            //         let a1 = erpxArr[b];\n            //         arr.push(`${a2}:${a1}`);\n            //         arr3.push(`${a2}:${a1}`);\n            //     }\n            //\n            //     for (let i = cellRange.sci; i <= cellRange.eci; i++) {\n            //         for (let j = cellRange.sri; j <= cellRange.eri; j++) {\n            //             erpxArr3.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr3[a];\n            //         let a1 = erpxArr3[b];\n            //\n            //         arr2.push(`${a2}:${a1}`);\n            //     }\n            //\n\n            // let {worker} = this;\n            // worker.terminate();\n            // worker = new Worker();\n            // worker.postMessage({ arr: arr, arr2: arr2, arr3: arr3, rows: rows });\n            //\n            // worker.onmessage = function (event) {\n            // };\n            //\n            // worker.addEventListener(\"message\", function (event) {\n            //     rows._ = event.data.rrows;\n            //     sheet.editor.display = true;\n            //     rows.moveChange(arr, arr2, arr3);\n            //     sheet.selectorMoveReset();\n            // });\n            console.time(\"move\")\n            rows.moveChange(arr, arr2, arr3);\n            console.timeEnd(\"move\")\n\n            sheet.selectorMoveReset();\n        });\n    }\n\n    setCss(b) {\n        this.areaEl.css('border', `2px dashed ${b}`);\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n\n        this.cornerEl.css(\"pointer-events\", pointer);\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n    constructor(data, sheet, sc = false) {\n        this.data = data;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.sheet = sheet;\n\n        // this.selectT = new SelectorElement(data, this, sheet);\n        // this.selectL = new SelectorElement(data, this, sheet);\n        // this.selectTl = new SelectorElement(data, this, sheet);\n\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        if (sc) {\n            this.selectCell = new SelectorCell(data, sc);\n            this.el.child(this.selectCell.el);\n        } else {\n            this.selectCell = new SelectorCell(data, sc);\n        }\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n\n    longTimeBefore() {\n        this.tl.longTimeBefore();\n        this.br.longTimeBefore();\n        this.t.longTimeBefore();\n        this.l.longTimeBefore();\n    }\n\n    setCss(b) {\n        this.br.setCss(b);\n        this.t.setCss(b);\n        this.l.setCss(b);\n        this.tl.setCss(b);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n\n        this.selectCell.resetSelectOffset();\n\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n\n\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    isMergeCell(ri, ci) {\n        let {data, state} = this.data.isMergeCell(ri, ci);\n        if (state) {\n            this.selectCell.eri = data.eri;\n            this.selectCell.eci = data.eci;\n        } else {\n            this.selectCell.eri = ri;\n            this.selectCell.eci = ci;\n        }\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        // this.resetSelectOffset(cellRange);\n\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    autoFilterRef() {\n        console.log(this.range);\n    }\n\n    setEnd(ri, ci, moving = true, enter = false) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            // if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci, sci, sri} = this.data.selector.range;\n        // 原因是 从右下角往左上角选中，然后ctrl + c 会有bug  加下面一行的原因\n        this.set(sri, sci);\n\n        this.setEnd(eri, eci, true, true);\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    //\n    showAutofill(ri, ci, pos) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n\n        // pos == 1 往下，pos == 3 往右， pos == 2 往左， pos == 4 往上\n        let drisc = 0;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        // console.log(srn, scn, ern, ecn, ri, ci);\n        if (pos == 2) {\n            drisc = 11;\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // console.log(this.arange);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (pos == 4) {\n            drisc = 22;\n\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (pos == 3) {\n            drisc = 33;\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (pos == 1) {\n            drisc = 44;\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return drisc;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n        return drisc;\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    showClipboard2(coffset) {\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {bind, bindClickoutside, createEvent, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport CellRange from \"../core/cell_range\";\n\nfunction inputMovePrev(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex -= 1;\n    if (this.itemIndex < 0) {\n        this.itemIndex = filterItems.length - 1;\n        this.el.el.scrollTop = this.el.el.scrollHeight;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0 || filterItems.length < this.itemIndex) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex += 1;\n    if (this.itemIndex > filterItems.length - 1) {\n        this.itemIndex = 0;\n        this.el.el.scrollTop = 0;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n    console.log(filterItems.length);\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n    evt.preventDefault();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    evt.stopPropagation();\n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n        this.hide();\n             createEvent.call(this, 13, false);\n\n        return\n    };\n\n    filterItems[this.itemIndex].el.click();\n    this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n    const {keyCode} = evt;\n    if (evt.ctrlKey) {\n        evt.stopPropagation();\n    }\n    switch (keyCode) {\n        case 37: // left\n            evt.stopPropagation();\n            break;\n        case 38: // up\n            inputMovePrev.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 39: // right\n            evt.stopPropagation();\n            break;\n        case 40: // down\n            inputMoveNext.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 13: // enter\n            inputEnter.call(this, evt);\n            break;\n        case 9:\n            inputEnter.call(this, evt);\n            break;\n        default:\n            evt.stopPropagation();\n            break;\n    }\n}\n\nexport default class Suggest {\n    constructor(items, itemClick, data, editor, width = '200px') {\n        this.filterItems = [];\n        this.items = items;\n        this.data = data;\n        this.editor = editor;\n        this.el = h('div', `${cssPrefix}-suggest`)\n            .css('width', width)\n            .css('overflow-y', 'auto')\n            .css('max-height', '306px').hide();\n        this.el.attr('tabindex', 0);\n\n\n        this.itemClick = itemClick;\n        this.itemIndex = -1;\n        this.show = false;\n    }\n\n    setOffset(v) {\n        this.el.cssRemoveKeys('top', 'bottom')\n            .offset(v);\n    }\n\n    hide() {\n        const {el} = this;\n        this.filterItems = [];\n        this.itemIndex = -1;\n        el.hide();\n        this.show = false;\n        unbindClickoutside(this.el.parent());\n    }\n\n    setItems(items) {\n        this.items = items;\n        // this.search('');\n    }\n\n    search(word) {\n        let {items, data, editor} = this;\n        if (!/^\\s*$/.test(word)) {\n            items = items.filter(it => (it.key.toUpperCase() || it.toUpperCase()).startsWith(word.toUpperCase()));\n        }\n        items = items.map((it) => {\n            let {title} = it;\n            if (title) {\n                if (typeof title === 'function') {\n                    title = title();\n                }\n            } else {\n                title = it;\n            }\n            const item = h('div', `${cssPrefix}-item`)\n                .child(title)\n                .on('click.stop', () => {\n                    this.itemClick(it);\n                });\n            if (it.label) {\n                item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        this.filterItems = items;\n        if (items.length <= 0) {\n            this.hide();\n            this.show = false;\n            return;\n        }\n        const {el} = this;\n        // items[0].toggle();\n        let rect = data.getRect(new CellRange(editor.ri, editor.ci, editor.ri, editor.ci));\n        let left = rect.left + 55;\n        let top = rect.top + 50;\n\n        if( items.length >= 9 && rect.top - 306 >= 50) {\n            top -= 306;\n            top -= rect.height;\n        }\n        el.css('left', `${left}px`);\n        el.css('top', `${top}px`);\n\n        el.html('').children(...items).show();\n        this.show = true;\n        bindClickoutside(el.parent(), () => {\n            this.hide();\n            this.show = false;\n        });\n    }\n\n    bindInputEvents(input) {\n        input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n    }\n}\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'fin-cell-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport {calendarPattern, str2Re} from \"../utils/reg_pattern\";\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (str2Re(calendarPattern).test(date)) { // jobs: todo: 正则表达式抽取出来\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","import {cssPrefix} from \"../config\";\nimport {h} from \"../component/element\";\nimport {helpFormula} from \"../core/operator\";\nimport {bind} from \"./event\";\n\nfunction variableElement(content, txt, pos, className, s = \"\", s2 = \"\") {\n    let item = h('div', className);\n    for (let i = 0; i < content[txt].length; i++) {\n        let ct = content[txt][i];\n        let {name, editor, index} = ct;\n\n        if (pos === i) {\n            item.child(h('span', s).child(name));\n        } else if (editor == true && pos >= index) {\n            item.child(h('span', s).child(name));\n        } else {\n            item.child(h('span', s2).child(name));\n        }\n    }\n\n    return item;\n}\n\nexport default class SuggestContent {\n    constructor(width = \"300px\") {\n        this.el = h('div', `${cssPrefix}-suggest-content`).css('width', width).css('z-index', \"10000\").css('position', \"absolute\").hide();\n        this.el.attr('tabindex', 0);\n        bind(this.el.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n    }\n\n    hide() {\n        const {el} = this;\n        el.hide();\n    }\n\n    content(cut = \"\", pos = -1) {\n        const {el} = this;\n\n        cut = cut.toUpperCase();\n        // cut 找到内容\n        let content = {};\n        Object.keys(helpFormula).forEach(i => {\n            if (i == cut) {\n                content = helpFormula[i];\n            }\n        });\n\n        if (!content || JSON.stringify(content) === '{}') {\n            return;\n        }\n\n        let items = [];\n        let title = variableElement.call(this, content, \"title\", pos, `${cssPrefix}-help-title`, `${cssPrefix}-help-span-title`, `${cssPrefix}-help-span2-title`);\n        let exampleName = h('div', `${cssPrefix}-help-section-title`).child(\"示例\");\n        let example = variableElement.call(this, content, \"example\", pos, `${cssPrefix}-help-section-content`, `${cssPrefix}-help-span3-title`);\n        items.push(...[title, exampleName, example]);\n        Object.keys(content.content).forEach(i => {\n            let c = content.content[i];\n            let item = h('div', `${cssPrefix}-help-section-title`).child(i);\n            let item2 = h('div', `${cssPrefix}-help-section-content`).child(c);\n            items.push(...[item, item2]);\n        });\n\n        el.html('').children(...items).show();\n    }\n}","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\nimport {cuttingByPos, cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {lockCells} from \"./formula_editor\";\nimport {CellRange} from \"../core/cell_range\";\nimport {mouseMoveUp} from \"./event\";\n\nexport default class SelectorMove {\n    constructor(boxinner, data, sheet, selector) {\n        this.l = h('div', `${cssPrefix}-selector-box-l-move-l`);\n        this.r = h('div', `${cssPrefix}-selector-box-l-move-r`);\n        this.t = h('div', `${cssPrefix}-selector-box-l-move-t`);\n        this.b = h('div', `${cssPrefix}-selector-box-l-move-b`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n\n        this.event(this.l, 1);\n        this.event(this.r, 2);\n        this.event(this.t, 3);\n        this.event(this.b, 4);\n        this.boxinner = boxinner;\n        this.boxinner.children(\n            this.l,\n            this.r,\n            this.t,\n            this.b,\n        );\n    }\n\n    find(str, cha, num) {\n        let x = str.lastIndexOf(cha);\n        // for (let i = 0; i < num; i++) {\n        //     x = str.indexOf(cha, x + 1);\n        // }\n        return x;\n    }\n\n    event(target, dict) {\n        let timer = null;\n        target.on('mousedown.stop', evt => {\n            let {data, sheet, _selector} = this;\n            let p = -1;\n            let {selector} = data;\n            let _move_selectors = null;\n            let {sri, sci, eri, eci, w, h} = selector.range;\n            let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n            let _cellRange = null;\n            let {selectors} = sheet;\n            let msri = -1, msci = -1, meri = -1, meci = -1;\n\n            mouseMoveUp(window, (e) => {\n                clearTimeout(timer);\n                timer = setTimeout(() => {\n                    sheet.container.css('pointer-events', 'none');\n                    for (let i = 0; i < selectors.length; i++) {\n                        let selector = selectors[i];\n                        selector.selector.setBoxinner(\"none\");\n                    }\n\n                    let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n                    if (ri != -1 && ci != -1) {\n                        let {  pos} = this.sheet.editor;\n                        let inputText = this.sheet.editor.editorText.getText();\n                        let _erpx = cuttingByPos(inputText, pos - 1, true);\n                        if (inputText.length > pos - 1) {\n                            let c = cuttingByPosEnd(inputText, pos - 1);\n                            _erpx += c;\n                        }\n                        for (let i = 0; i < selectors.length; i++) {\n                            let selector = selectors[i];\n                            let {className, erpx} = selector;\n\n                            if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n                                if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    cellRange.move(ri, ci);\n                                    const rect = data.getMoveRect(cellRange);\n                                    _move_selectors.selector.range = cellRange;\n                                    _move_selectors.selector.setMove(rect);\n                                } else {\n                                    _move_selectors.selector.set(ri, ci, true);\n                                }\n                                break;\n                            } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                                p = p != -1 ? p : this.find(inputText, selector.erpx, selector.index);\n                                this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                                if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    if (_cellRange === null) {\n                                        _cellRange = cellRange;\n                                    }\n                                    if (dict === 4) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        // console.log(cellRange, _cellRange);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                } else {\n                                    let e1 = expr2xy(selector.erpx);\n                                    let e2 = expr2xy(selector.erpx);\n                                    let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                    if (dict === 4) {\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                }\n                                break;\n                            }\n                        }\n\n                        if (_move_selectors\n                            && (msri !== cellRange.sri\n                                || msci !== cellRange.sci\n                                || meri !== cellRange.eri\n                                || meci !== cellRange.eci)) {\n                            _move_selectors.selector.setCss(_move_selectors.color, false);\n                            lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                        }\n                        msri = cellRange.sri;\n                        msci = cellRange.sci;\n                        meri = cellRange.eri;\n                        meci = cellRange.eci;\n                    }\n                }, 6);\n            }, (e) => {\n                clearTimeout(timer);\n                let {selectors} = this.sheet;\n                sheet.container.css('pointer-events', 'auto');\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    selector.selector.setBoxinner(\"all\");\n                }\n                p = -1;\n                if (_move_selectors && _move_selectors.selector)\n                    _move_selectors.selector.setCss(_move_selectors.color, true)\n                _move_selectors = null;\n            })\n        });\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {lockCells} from \"../component/formula_editor\";\nimport {cuttingByPos} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport SelectorMove from \"./selector_move\";\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        // this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this._selector = selector;\n        this.sheet = sheet;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n\n\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.selectorMove = new SelectorMove(this.boxinner, data, sheet, selector);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .child(this.boxinner)\n            .hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    find(str, cha, num) {\n        let x = str.lastIndexOf(cha);\n        return x;\n    }\n\n    moveEvent(evt) {\n        let {data, _selector, sheet} = this;\n        let _move_selectors = null;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = selector.range;\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let p = -1;\n        mouseMoveUp(window, (e) => {\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'none');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"none\");\n            }\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri != -1 && ci != -1) {\n                let { pos} = this.sheet.editor;\n                let inputText = this.sheet.editor.editorText.getText();\n                let _erpx = cuttingByPos(inputText, pos - 1, true);\n                if (inputText.length > pos - 1) {\n                    let c = cuttingByPosEnd(inputText, pos - 1);\n                    _erpx += c;\n                }\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    let {className, erpx} = selector;\n\n                    if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n                        if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                        p = p != -1 ? p :this.find(inputText, selector.erpx, selector.index);\n                        this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                        if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    }\n                }\n                if (_move_selectors) {\n                    _move_selectors.selector.setCss(_move_selectors.color, false)\n                    lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                }\n            }\n        }, (e) => {\n            // 加这个的原因是  e.layerX, e.layerY， 如果不加的话 会点到单元格内的 xy坐标进行结算\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'auto');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"all\");\n            }\n            p = -1;\n            if (_move_selectors && _move_selectors.selector)\n                _move_selectors.selector.setCss(_move_selectors.color, true)\n            _move_selectors = null;\n        });\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n        this.selectorMove.l.css(\"pointer-events\", pointer);\n        this.selectorMove.r.css(\"pointer-events\", pointer);\n        this.selectorMove.t.css(\"pointer-events\", pointer);\n        this.selectorMove.b.css(\"pointer-events\", pointer);\n    }\n\n    setCss(b, key = true) {\n        if (!key) {\n            this.areaEl.css(\"border\", `2px solid ${b}`);\n        } else {\n            this.areaEl.css(\"border\", `2px dashed ${b}`);\n        }\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class SelectorCopy {\n    constructor(data, sheet, className) {\n        this.data = data;\n        this.className = className;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n    setCss(b, key = true) {\n        this.br.setCss(b, key);\n        this.t.setCss(b, key);\n        this.l.setCss(b, key);\n        this.tl.setCss(b, key);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    setEnd(ri, ci, moving = true) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci} = this.data.selector.range;\n        this.setEnd(eri, eci);\n    }\n\n    showAutofill(ri, ci) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        if (scn > 0) {\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (srn > 0) {\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (ecn < 0) {\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (ern < 0) {\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    showClipboard2(coffset) {\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n    ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n    ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n    ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n    ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n    ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst selectColors = [\"#EE0000\", \"#8A2BE2\", \"#FF3E96\", \"#8B4500\", \"#3A5FCD\", \"#FF7F24\"];\n\nexport function selectorColor(index) {\n    index = index % selectColors.length;\n    return {\n        color: selectColors[index],\n        index: index,\n    };\n}\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nfunction buildTd(bgcolor) {\n    let item = h('div', `${cssPrefix}-color-palette-cell`)\n        .on('click.stop', () => this.change(bgcolor))\n        .css('background-color', bgcolor);\n\n    this.items.push(\n        item\n    );\n    return h('td', '').child(item);\n}\n\nexport default class ColorPalette {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-color-palette`);\n        this.change = () => {\n        };\n        this.items = [];\n        const table = h('table', '').children(\n            h('tbody', '').children(\n                h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n                    ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n                ),\n                ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n                    ...it.map(color => buildTd.call(this, color)),\n                )),\n                h('tr', `${cssPrefix}-standard-colors`).children(\n                    ...standardColors.map(color => buildTd.call(this, color)),\n                ),\n            ),\n        );\n        this.el.child(table);\n    }\n}\n","import SelectorCopy from '../component/selector_copy';\nimport {\n    cutFirst,\n    cutStr,\n    cutting,\n    cutting2,\n    cuttingByPos,\n    isAbsoluteValue,\n    operation,\n    value2absolute,\n} from '../core/operator';\nimport {expr2xy, xy2expr} from '../core/alphabet';\nimport {selectorColor} from './color_palette';\nimport {h} from './element';\n\nfunction lockCells(evt, _selector, isAb = false, p = -1) {\n    const {data, editor} = this;\n    const {offsetX, offsetY} = evt;\n\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {ri, ci} = cellRect;\n\n    let { pos} = editor;\n    let inputText = editor.editorText.getText();\n    let input = '';\n\n    editor.handler(inputText);\n    const {mousedownIndex} = editor;\n    if (isAbsoluteValue(cuttingByPos(inputText, pos), 2) || _selector) {\n        if (_selector) {\n            const {\n                sri, sci, eri, eci,\n            } = _selector.selector.range;\n\n            const s1 = xy2expr(sci, sri);\n            const s2 = xy2expr(eci, eri);\n            let text = s1 == s2 ? s1 : `${s1}:${s2}`;\n\n            if (isAb == 2) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s1 == es2.s1 ? es1.s1 : `${es1.s1}:${es2.s1}`;\n            } else if (isAb == 1) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s2 == es2.s2 ? es1.s2 : `${es1.s2}:${es2.s2}`;\n            } else if (isAb == 3) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s3 == es2.s3 ? es1.s3 : `${es1.s3}:${es2.s3}`;\n            }\n            _selector.erpx = text;\n            let {isCors} = editor;\n            if (isCors) {\n                pos = 1;\n            }\n\n            let sp = p != -1 ? p : pos - cuttingByPos(inputText, pos).length;\n            input = inputText.substring(0, sp) + text + inputText.substring(pos, inputText.length);\n            editor.setText(input);\n            editor.setCursorPos(inputText.substring(0, sp).length + text.length);\n        } else {\n            // 此情况是例如: =A1  -> 这时再点A2  则变成: =A2\n            let enter = 0;\n            for (let i = 0; i < this.selectors.length && enter == 0; i++) {\n                const selector = this.selectors[i];\n                const {erpx} = selector;\n                if (erpx === cuttingByPos(inputText, pos)) {\n                    const {ri, ci} = cellRect;\n                    this.selectors[i].ri = ri;\n                    this.selectors[i].ci = ci;\n                    this.selectors[i].erpx = xy2expr(ci, ri);\n                    this.selectors[i].selector.set(ri, ci);\n                    input = `${inputText.substring(0, pos - erpx.length)}${xy2expr(ci, ri)}${inputText.substring(pos, inputText.length)}`;\n                    editor.setText(input);\n                    editor.setCursorPos(inputText.substring(0, pos - erpx.length).length + xy2expr(ci, ri).length);\n                    enter = 1;\n                }\n            }\n        }\n    } else if (mousedownIndex.length > 0) {\n        if (operation(mousedownIndex[1][0]) && isAbsoluteValue(cuttingByPos(mousedownIndex[1], mousedownIndex[1].length), 2)) {\n            editor.setLock(false);\n            return;\n        }\n\n        const args = makeSelector.call(this, ri, ci);\n        this.selectors.push(args);\n        input = `${mousedownIndex[0]}${xy2expr(ci, ri)}${mousedownIndex[1]}`;\n        const judgeText = input.substring(mousedownIndex[0].length + xy2expr(ci, ri).length, input.length);\n        // 不是的话，需要删除这个\n        let number = cutFirst(judgeText.substring(1));\n        if (operation(judgeText[0]) && !isAbsoluteValue(number, 2)) {\n            editor.setText(input);\n            editor.setMouseDownIndex([]);\n            return;\n        }\n        // 不是的话，需要删除这个\n        number = cutFirst(mousedownIndex[1]);\n\n        console.log(xy2expr(ci, ri));\n        const cut = cutStr(`${mousedownIndex[0]}${xy2expr(ci, ri)}+4${mousedownIndex[1]}`);\n        const {selectors_delete, selectors_new} = filterSelectors.call(this, cut);\n        Object.keys(selectors_delete).forEach((i) => {\n            const selector = selectors_delete[i];\n            selector.removeEl();\n        });\n\n        this.selectors = selectors_new;\n\n        input = input.replace(number, '');\n        editor.setText(input);\n        const content = suggestContent.call(this, pos - 1, cutting(inputText), inputText);\n        editor.setCursorPos(mousedownIndex[0].length + xy2expr(ci, ri).length);\n    } else {\n        const {pos} = editor;\n\n        const args = _selector || makeSelector.call(this, ri, ci);\n        if (pos != -1) {\n            let str = '';\n            let enter = false;\n            let step = pos;\n            let first = '';\n            for (let i = pos; i < inputText.length; i++) first += inputText[i];\n            let len = cutFirst(first).length;\n            for (let i = 0; i < inputText.length; i++) {\n                if (pos == i) {\n                    enter = true;\n                    str += xy2expr(ci, ri);\n                }\n\n                if (step == i && len > 0) {\n                    step += 1;\n                    len -= 1;\n                } else {\n                    str += inputText[i];\n                }\n            }\n\n            if (_selector) {\n                const {\n                    sri, sci, eri, eci,\n                } = data.selector.range;\n                const s1 = xy2expr(sci, sri);\n                const s2 = xy2expr(eci, eri);\n\n                input = s1 === s2 ? s1 : `${s1}:${s2}`;\n                str = !enter ? str += input : str;\n            } else {\n                console.log('121push');\n                this.selectors.push(args);\n                str = !enter ? str += xy2expr(ci, ri) : str;\n            }\n            editor.setText(str);\n            editor.setCursorPos(str.length);\n            editor.parse();\n        } else {\n            this.selectors.push(args);\n            input = `${inputText}${xy2expr(ci, ri)}`;\n            editor.setText(input);\n        }\n    }\n    editor.parse(editor.pos);\n    if (this.selectors.length > 0 || _selector) {\n        // const {inputText} = editor;\n        let inputText = editor.editorText.getText();\n        // 处理 合并单元格\n        let it = inputText, enter = false;\n        let {merges} = this.data;\n        Object.keys(merges._).forEach(i => {\n            let m = merges._[i];\n            const cut = cutStr(it, true);\n            for (let i = 0; i < cut.length; i++) {\n                if (cut[i].indexOf(\":\") != -1) {\n                    let a1 = cut[i].split(\":\")[0];\n                    let a2 = cut[i].split(\":\")[1];\n                    let e1 = expr2xy(a1);\n                    let e2 = expr2xy(a2);\n\n                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                        it = it.replace(new RegExp(cut[i], 'g'), a1);\n                        enter = true;\n                    }\n                }\n            }\n        });\n\n\n        // clearSelectors.call(this);\n        // console.log(it);\n        div2span.call(this, cutting(it), cutting2(it, this.selectors));\n        if (enter) {\n            setTimeout(() => {\n                editor.setCursorPos(it.length);\n            }, 10);\n        }\n    }\n    // step 3.  在enter或者点击的时候写入到cell中\n    // dataSetCellText.call(this, input, 'input');\n}\n\nfunction filterSelectors(cut) {\n    const selectors_new = [];\n    const selectors_delete = [];\n    Object.keys(this.selectors).forEach((i) => {\n        const selector = this.selectors[i];\n        const {erpx} = selector;\n        let enter = 0;\n        for (let i2 = 0; i2 < cut.length && enter === 0; i2++) {\n            if (cut[i2].replace(/\\$/g, '') === erpx) {\n                enter = 1;\n                selectors_new.push(selector);\n            }\n        }\n\n        if (enter == 0) {\n            selectors_delete.push(selector.selector.el);\n        }\n    });\n    return {\n        selectors_delete,\n        selectors_new,\n    };\n}\n\nfunction makeSelector(ri, ci, selectors = this.selectors, multiple = false, _selector, mergeSelector) {\n    const {data} = this;\n    let selector = null;\n    // const {inputText} = this.editor;\n    let inputText = this.editor.editorText.getText();\n    const {color, index} = selectorColor(selectors.length);\n    if (_selector) {\n        selector = _selector;\n    } else {\n        const className = `selector${parseInt(Math.random() * 999999)}`;\n        selector = new SelectorCopy(data, this, className);\n        selector.el.attr('class', `${className} clear_selector`);\n        selector.setCss(color);\n    }\n\n    if (multiple) {\n        if (mergeSelector) {\n            selector.setEnd(ri, ci);\n        } else {\n            selector.set(ri, ci, true);\n        }\n    } else {\n        selector.set(ri, ci, false);\n    }\n\n    selector.el.css('z-index', '100');\n    const len = inputText.split(xy2expr(ci, ri)).length - 2;\n\n    let it = xy2expr(ci, ri);\n    let {merges} = data;\n    Object.keys(merges._).forEach(i => {\n        let m = merges._[i];\n        const cut = cutStr(it, true);\n        for (let i = 0; i < cut.length; i++) {\n            if (cut[i].indexOf(\":\") != -1) {\n                let a1 = cut[i].split(\":\")[0];\n                let a2 = cut[i].split(\":\")[1];\n                let e1 = expr2xy(a1);\n                let e2 = expr2xy(a2);\n\n                if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                    it = it.replace(new RegExp(cut[i], 'g'), a1);\n                }\n            }\n        }\n    });\n\n    const args = {\n        ri,\n        ci,\n        index: len,\n        color,\n        index2: index,\n        className: selector.el.el.className,\n        erpx: it,\n        selector,\n    };\n    if (!mergeSelector) {\n        selector.el.show();\n        this.selectorsEl.child(selector.el);\n    }\n\n    if (multiple) {\n        return args;\n    }\n\n    this.selectorsEl.child(selector.el);\n    return args;\n}\n\nfunction clearSelectors() {\n    this.selectorsEl.html('');\n    this.selectors = [];\n    const {editor, selector} = this;\n    editor.setLock(false);\n\n    // // 这行是在 @~esc的时候加的 原因是要把ri ci赋值为-1\n    // editor.setRiCi(-1, -1);\n    editor.state = 1;\n    selector.el.show();\n}\n\n// 输入 input\nfunction editingSelectors(text = '') {\n    if (typeof text === 'number') {\n        return;\n    }\n    const selectors_new = [];\n    const cut = cutStr(text, true);\n    // case 1  过滤 selectors\n    const {selectors_delete} = filterSelectors.call(this, cut);\n\n    Object.keys(selectors_delete).forEach((i) => {\n        const selector = selectors_delete[i];\n        selector.removeEl();\n    });\n\n\n    const selectors_valid = selectors_new;\n    // case 2  验证 selectors\n    Object.keys(cut).forEach((i) => {\n        let enterCode = 1;\n        Object.keys(this.selectors).forEach((i) => {\n            const {selector} = this.selectors[i];\n            selector.el.removeEl();\n        });\n\n        // 绝对值\n        let arr = '';\n        let sc = cut[i].replace(/\\$/g, \"\");\n        if (isAbsoluteValue(cut[i])) {\n            const notTrueValue = cut[i].replace(/\\$/g, '');\n            arr = expr2xy(notTrueValue);\n        } else if (sc.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n            enterCode = 2;\n        } else {\n            arr = expr2xy(cut[i]);\n        }\n\n        if (enterCode == 1) {\n            const ri = arr[1];\n            const\n                ci = arr[0];\n            const args = makeSelector.call(this, ri, ci, selectors_valid);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        } else if (enterCode == 2) {\n            const prx = cut[i].replace(/\\$/g, '').split(':')[0];\n            const lax = cut[i].replace(/\\$/g, '').split(':')[1];\n\n            const prx_index = expr2xy(prx);\n            const lax_index = expr2xy(lax);\n            let args = makeSelector.call(this, prx_index[1], prx_index[0], selectors_valid, true, null, false);\n            args = makeSelector.call(this, lax_index[1], lax_index[0], selectors_valid, true, args.selector, true);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        }\n    });\n    this.selectors = selectors_valid;\n\n    if (this.selectors.length > 0 || text[0] == '=') {\n        div2span.call(this, cutting(text), cutting2(text, this.selectors));\n    }\n}\n\n// 找 ( 的index\nfunction findBracketLeft(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i - 1; j > 0 && stop == false; j--) {\n        if (cut[j] == '(') {\n            stop = true;\n        }\n        if (cut[j] == ')') {\n            has++;\n        }\n    }\n\n    for (let j = i; j > 0 && begin == -1; j--) {\n        if (cut[j] == '(') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n// => { left: 0, right: 0,  exist: false }\nfunction findBracket(pos, cut, text) {\n    let args = {left: 0, right: 0, exist: false};\n    if (text[pos] !== ')') {\n        return args;\n    }\n    const right = pos;\n    const left = findBracketLeft.call(this, cut, right);\n\n    if (left != -1 && right != -1) {\n        args = {left, right, exist: true};\n    }\n    return args;\n}\n\n\n// 找 ) 的 index\nfunction findBracketRight(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i + 1; j < cut.length && stop == false; j++) {\n        if (cut[j] == ')') {\n            stop = true;\n        }\n        if (cut[j] == '(') {\n            has++;\n        }\n    }\n\n    for (let j = i; j < cut.length && begin == -1; j++) {\n        if (cut[j] == ')') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n\nfunction suggestContent(pos, cut, inputText) {\n    // 如果在括号内\n    // step 1. 找到距离pos最近的左、右括号的index\n    // step 2. 若1成立，找到该函数名\n    // step 3. 找光标前有几个逗号\n    const content = {suggestContent: false, cut: '', pos: 1};\n    const begin = pos - 1;\n    const left = findBracketLeft.call(this, cut, begin);\n    const right = findBracketRight.call(this, cut, left);\n\n    if (left <= begin && left != -1 && (right >= begin || right == -1)) {\n        content.suggestContent = true;\n        content.cut = cuttingByPos(inputText, left);\n    }\n\n    for (let i = left; i < begin + 1; i++) {\n        if (inputText[i] == ',') {\n            content.pos += 2;\n        }\n    }\n\n    return content;\n}\n\nfunction div2span(cut, cutcolor) {\n    const {editor} = this;\n\n    const spanArr = [];\n    let begin = -1;\n    let end = -1;\n\n    Object.keys(cut).forEach((i) => {\n        const spanEl = h('span', `formula_span${i}`);\n        Object.keys(cutcolor).forEach((i2) => {\n            if (cutcolor[i] && cutcolor[i].code !== -1 && cutcolor[i].data == cut[i]) {\n                const {color} = selectorColor(cutcolor[i].code);\n                spanEl.css('color', color);\n            }\n        });\n        spanEl.css('display', 'inline-block');\n        spanEl.css('cursor', 'text');\n\n        if (cut[i] == ' ') {\n            spanEl.html('&emsp;');\n        } else {\n            spanEl.html(cut[i]);\n        }\n\n        spanArr.push(spanEl);\n    });\n\n    // 高亮\n    const {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let content = {suggestContent: false, cut: ''};\n    if (inputText[pos - 1] == ')') {\n        begin = pos - 1;\n        end = findBracketLeft.call(this, cut, begin);\n    } else {\n        content = suggestContent.call(this, pos + 1, cut, inputText);\n    }\n\n\n    if (inputText != '' && spanArr.length <= 0) {\n        const spanEl = h('span', 'formula_span');\n        spanArr.push(spanEl);\n    }\n    // 挂载\n    editor.mount2span(spanArr, begin, end, content);\n}\n\n\nexport {\n    lockCells,\n    clearSelectors,\n    editingSelectors,\n    findBracket,\n    suggestContent,\n    makeSelector,\n};\n","const baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\nconst fonts = (ary = []) => {\n  const map = {};\n  baseFonts.concat(ary).forEach((f) => {\n    map[f.key] = f;\n  });\n  return map;\n};\n\nexport default {};\nexport {\n  fontSizes,\n  fonts,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","import {expr2xy, xy2expr} from './alphabet';\nimport {look, look2} from \"../config\";\n// import XLSX_CALC from \"calc\"\n// var formulajs = require('formulajs');\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgsLen = 1; // A1,A2,A3...\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        // console.log('c:', c);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1) {\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log(operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    if (!subExpr) {\n        subExpr = \"\";\n    }\n    if (subExpr[0] >= '0' && subExpr[0] <= '9') {\n        return Number(subExpr);\n    }\n    if (subExpr[0] === '\"') {\n        return subExpr.substring(1);\n    }\n    const [x, y] = expr2xy(subExpr);\n    return cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        if (srcStack[i] === '+') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) + Number(top));\n        } else if (srcStack[i] === '-') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) - Number(top));\n        } else if (srcStack[i] === '*') {\n            stack.push(Number(stack.pop()) * Number(stack.pop()));\n        } else if (srcStack[i] === '/') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) / Number(top));\n        } else if (Array.isArray(srcStack[i])) {\n            const [formula, len] = srcStack[i];\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(srcStack[i])) {\n                return 0;\n            }\n            cellList.push(srcStack[i]);\n            let s = evalSubExpr(srcStack[i], cellRender)\n            stack.push(evalSubExpr(srcStack[i], cellRender));\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nfunction evalFormula(text, rule) {\n    if (typeof text !== 'string') {\n        return false;\n    }\n    if (text.toUpperCase().indexOf(rule.toUpperCase()) == -1) {\n        return false;\n    }\n    return true;\n}\n\nconst cellRender = (data, sheetbook, y, x, src, formulaMap, getCellText, cellList = []) => {\n    if (typeof src === 'undefined') {\n        return \"\";\n    }\n\n    if (typeof src === 'string' && look.indexOf(src.split(\"!\")[0]) != -1) {\n        let len = src.length;\n        if(src.split(\" \")[0]) {\n            len = src.split(\" \")[0].length;\n        }\n        let a = JSON.parse(src.substring(src.indexOf(\"!\") + 1, len));\n        let s = look.indexOf(src.split(\"!\")[0]);\n\n        if (s === 1) {\n            return a.text;\n        } else if (s === 0) {\n            if (a && a[0]) {\n                let {name, value} = a[0];\n\n                if (value === 0 && a[1] && a[1].value !== 0) {\n                    return name;\n                } else if (value === 0 && !a[1]) {\n                    return name;\n                }\n            }\n        }\n\n        return look2;\n    }\n\n    if (src[0] === '=' && src[1] !== '=') {\n        // console.log(\"156\", sheetbook.Sheets.Sheet1[xy2expr(x, y)], xy2expr(x, y))\n        if (evalFormula(src.substring(1), \"wland\") || evalFormula(src.substring(1), \"wfr\") || evalFormula(src.substring(1), \"rtd\")\n            || evalFormula(src.substring(1), \"city\")) {\n            // let {date_formula} = data.settings;=MD.RTD(\"sina\", \"162411\", \"now\")\n            // date_formula.wland(date_formula, data);\n            return src.toUpperCase();\n        } else if (src.substring(1) && sheetbook && sheetbook.Sheets && sheetbook.Sheets[data.name] && sheetbook.Sheets[data.name][xy2expr(x, y)]) {\n            // sheetbook.Sheets.Sheet1[xy2expr(x, y)].f = src.substring(1).toUpperCase();\n            // XLSX_CALC.import_functions(formulajs);\n            // XLSX_CALC(sheetbook);\n\n            if ((sheetbook.Sheets[data.name][xy2expr(x, y)].f && sheetbook.Sheets[data.name][xy2expr(x, y)].f.search(/\\((\\+|\\-|\\*|\\/)/) != -1) || sheetbook.Sheets[data.name][xy2expr(x, y)].v == undefined || sheetbook.Sheets[data.name][xy2expr(x, y)].v === \"\") {\n                return \"#ERROR!\";\n            }\n            sheetbook.Sheets[data.name][xy2expr(x, y)].v = sheetbook.Sheets[data.name][xy2expr(x, y)].v + \"\";\n\n            // let value = sheetbook.Sheets.Sheet1[xy2expr(x, y)].v ? sheetbook.Sheets.Sheet1[xy2expr(x, y)].v : \"NaN\";\n            return sheetbook.Sheets[data.name][xy2expr(x, y)].w ? sheetbook.Sheets[data.name][xy2expr(x, y)].w : sheetbook.Sheets[data.name][xy2expr(x, y)].v.replace(/'/g, \"\\\"\");\n        }\n        // const stack = infixExprToSuffixExpr(src.substring(1));\n        // if (stack.length <= 0) return src;\n\n        return src;\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","export const isMinus = (text) => {\n    if(isNaN(text)) {\n        return false;\n    } else if(text == \"\") {\n        return false;\n    }\n\n    if(parseInt(text) >= 0)\n        return false;\n\n    return true;\n};","/* global window */\nimport {isHave} from \"../core/helper\";\n\nfunction dpr() {\n    return window.devicePixelRatio || 1;       // 修改之后\n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    return parseInt(px * dpr(), 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n                   top, bottom, left, right,\n               }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2);\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2);\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, fontSize, hoffset) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y = y + height / 2 - hoffset;\n            // y = y1;\n            // const y2 = y + padding + fontSize / 2 + 1;\n            // if (y1 < y2) y = y2;\n            // else y = y1;\n        } else if (align === 'bottom') {\n            y += height - hoffset * 2 - padding;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr(), dpr());\n        this.cxc = {\n            indent: 250,\n            vIndent: 200,\n            canvasContext: this.ctx\n        }\n\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        // this.ctx.font.size = 30;\n        // console.log(\"203:\", this.ctx.font);\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    selfAdaptionHeight(box, txt, font) {\n        if (font == undefined || txt == undefined)\n            return;\n        let n = 1;\n        const textLine = {len: 0, start: 0};\n        let innerWidth = box.width - box.padding * 2;\n        for (let i = 0; i < txt.length; i += 1) {\n            if (textLine.len + box.padding >= innerWidth) {\n                n = n + 1;\n                textLine.len = 0;\n                textLine.start = i;\n            }\n            textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font, box);\n        }\n\n        return n;\n    }\n\n    selfAdaptionTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) == false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        const txtWidth = ctx.measureText(txt).width + box.padding * 2;\n        return txtWidth;\n    }\n\n    selfAdaptionOneTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) == false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        const txtWidth = ctx.measureText(txt).width;\n        return txtWidth;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(txt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        const {\n            align, valign, font, color, strike, underline, ignore, cindex\n        } = attr;\n\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n\n        let txtWidth = this.selfAdaptionTxtWidth(txt, font, box);\n        let hoffset = 0;\n        let innerWidth = box.innerWidth();\n        if (textWrap) {\n            innerWidth = box.width - box.padding * 2;\n            const n = this.selfAdaptionHeight(box, txt, font);\n            hoffset = ((n - 1) * font.size) / 2;\n            // for (let i = 0; i < ignore.length; i++) {\n            //     if (cindex != ignore[i]) {\n            //         // hoffset = 0;\n            //     } else if (cindex == ignore[i]) {\n            //     }\n            // }\n        }\n        let ty = box.texty(valign, font.size, hoffset);\n        if (textWrap && txtWidth > innerWidth) {\n            const textLine = {len: 0, start: 0};\n            for (let i = 0; i < txt.length; i += 1) {\n                if (textLine.len + box.padding >= innerWidth) {\n                    // debugger\n                    this.fillText(txt.substring(textLine.start, i), tx, ty);\n                    if (strike) {\n                        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    if (underline) {\n                        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    ty += font.size + 2;\n                    textLine.len = 0;\n                    textLine.start = i;\n                }\n                textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font, box);\n            }\n            if (textLine.len > 0) {\n                this.fillText(txt.substring(textLine.start), tx, ty);\n                if (strike) {\n                    drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                }\n                if (underline) {\n                    drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                }\n            }\n        } else {\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'striket', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n        }\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        ctx.beginPath();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropup(box, state, diff) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + 10;\n        const sy = y + height - 18 - diff;\n\n        // if (state) {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278539177.svg\";\n        // } else {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278579742.svg\";\n        // }\n        // img.onload = function () {\n        //   ctx.drawImage(img, npx(sx), npx(sy), 16, 16);\n        // }\n        if (state) {\n            this.drawFlexTrue(ctx, npx(sx), npx(sy))\n        } else {\n            this.drawFlexFalse(ctx, npx(sx), npx(sy))\n        }\n    }\n\n\n    drawFlexFalse(ctx, sx, sy) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = \"#707070\";\n        ctx.moveTo(sx, sy + 6);\n        ctx.lineTo(sx + 12, sy + 6);\n        ctx.stroke();\n\n        ctx.strokeRect(sx, sy, 12, 12);\n        ctx.clip();\n        ctx.fill();\n        ctx.restore();\n    }\n\n    drawFlexTrue(ctx, sx, sy) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = \"#707070\";\n        ctx.moveTo(sx + 6, sy);\n        ctx.lineTo(sx + 6, sy + 12);\n        ctx.moveTo(sx, sy + 6);\n        ctx.lineTo(sx + 12, sy + 6);\n        ctx.stroke();\n\n        ctx.strokeRect(sx, sy, 12, 12);\n        ctx.clip();\n        ctx.fill();\n        ctx.restore();\n    }\n\n    translatex(x, y) {\n        this.cxc.canvasContext.translate(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    lineTo(x, y) {\n        this.cxc.canvasContext.lineTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    moveTo(x, y) {\n        this.cxc.canvasContext.moveTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    };\n\n    bezierCurveTo(x, y, x1, y1, x2, y2) {\n        this.cxc.canvasContext.bezierCurveTo(\n            x + this.cxc.indent, y + this.cxc.vIndent,\n            x1 + this.cxc.indent, y1 + this.cxc.vIndent,\n            x2 + this.cxc.indent, y2 + this.cxc.vIndent);\n    }\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        console.log(\"350\", sy, sx)\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n\n    rect2(box, dtextcb, textwrap, cellText) {\n        const {ctx} = this;\n        const {\n            x, y, width, bgcolor,\n        } = box;\n        let {height} = box;\n        // if (textwrap == true) {\n        //     console.log(\"487\")\n        //     const n = this.selfAdaptionHeight(box, cellText);\n        //     height = height * n;\n        //     console.log(\"495\", height)\n        // }\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor === \"rgba(0, 0, 0, 0)\" ? '#fff' : bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport default {};\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","import {isHave} from \"../core/helper\";\n\nexport function testValid(valid = this.valid) {\n    if(isHave(valid)) {\n       valid.assert();\n    }\n}","import {expr2xy, stringAt, xy2expr} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {isMinus} from \"../utils/number_util\";\nimport {Draw, DrawBox, npx, thinLineWidth,} from '../canvas/draw';\nimport {look} from \"../config\";\nimport {deepCopy, distinct} from \"../core/operator\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n// import Worker from 'worker-loader!../external/Worker2.js';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(rindex, cindex) {\n    const {data} = this;\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\nfunction getAutoDrawBox(rindex, cindex, width) {\n    const {data} = this;\n    const {\n        left, top, height\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\nfunction getCellTextStyle(rindex, cindex) {\n    const {data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n\n    return style;\n}\n\nexport function toUpperCase(text) {\n    text = text.toString().toUpperCase();\n\n    return text;\n}\n\nfunction getChangeDataToCalc() {\n    let {data} = this;\n    let changeData = data.changeDataForCalc;\n    if (!isHave(changeData)) {\n        return {\n            \"state\": false,\n            \"data\": null,\n        }\n    } else {\n        return {\n            \"state\": true,\n            \"data\": changeData\n        }\n    }\n}\n\nfunction parseCell() {\n    let {data} = this;\n\n    let changeDataArgs = getChangeDataToCalc.call(this);\n    data.calc(data.rows, changeDataArgs.data);\n\n    if (changeDataArgs.state) {\n        data.changeDataForCalc = null;\n    }\n}\n\nexport function parseCell2(viewRange, state = false, src = '') {\n    let {data} = this;\n    let {calc, rows} = data;\n    let workbook = [];\n    workbook.Sheets = {};\n    workbook.Sheets[data.name] = {};\n\n    viewRange.each2((ri, ci) => {\n        let cell = data.getCell(ri, ci);\n        let expr = xy2expr(ci, ri);\n        if (cell && cell.text) {\n            cell.text = cell.text + \"\";\n            if (cell.text.indexOf(\"MD.RTD\") != -1) {\n                workbook.Sheets[data.name][expr] = {v: \"\", f: \"\"};\n            } else {\n                if (cell.text && cell.text.lastIndexOf(\"=\") === 0) {\n                    workbook.Sheets[data.name][expr] = {\n                        v: '',\n                        f: cell.text.replace(/ /g, '').replace(/\\\"/g, \"\\\"\").replace(/\\\"\\\"\\\"\\\"&/g, \"\\\"'\\\"&\")\n                    };\n                } else {\n                    workbook.Sheets[data.name][expr] = {\n                        v: cell.text.replace(/ /g, '').toUpperCase().replace(/\\\"/g, \"\\\"\"),\n                        f: ''\n                    };\n                }\n            }\n        }\n        else {\n            workbook.Sheets[data.name][expr] = {v: 0, f: 0};\n        }\n    });\n\n\n    if (state) {\n        workbook.Sheets[data.name]['A1'] = {v: '', f: `${src}`};\n    }\n\n    try {\n        calc(workbook);\n    } catch (e) {\n        console.error(e);\n    }\n    return workbook;\n}\n\nfunction specialStyle(text) {\n    text = text + \"\";\n    if (!text) {\n        return false;\n    }\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return true;\n    }\n    return false;\n}\n\nfunction renderCell(rindex, cindex) {\n    const {draw, data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (!isHave(cell)) return;\n    // data.rows.setHeight(1, 50);\n\n    // console.log(rindex, nrindex, \"63\")\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox.call(this, rindex, cindex);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n\n    let cellText = \"\";\n\n    if (data.showEquation) {\n        if(isHave(cell.formulas)) {\n            cellText = cell.formulas;\n        }\n    } else if(isHave(cell.text)) {\n        cellText = cell.text;\n    }\n    draw.rect2(dbox, () => {\n        // render text\n        let args = data.renderFormat(style, cell, nrindex, cindex, false);\n        cellText = args.state ? args.cellText : cellText;\n        const font = Object.assign({}, style.font);\n\n        font.size = getFontSizePxByPt(font.size);\n        let {ignore, minus} = data.settings;\n        let color = style.color;\n        // console.log('style:', cellText);\n        if (minus == true && isMinus(cellText)) {\n            color = 'red'\n        }\n        let underline = style.underline;\n        let regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\n        cellText = cellText + \"\";\n        let text = cellText.substr(0, 3).toLowerCase() == \"www\" ? \"http://\" + cellText : cellText;\n        if (regex.test(text) || specialStyle(cell.text)) {\n            color = \"#4b89ff\";\n            underline = true;\n        }\n\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: color,\n            strike: style.strike,\n            underline: underline,\n            ignore: ignore,\n            cindex: cindex,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            draw.error(dbox);\n        }\n    }, style.textwrap, cellText);\n}\n\nfunction renderFlexible() {\n    const {draw, data} = this;\n    const {autoFilter} = data;\n    const {flex} = autoFilter;\n\n    for (let i = 0; i < flex.length; i++) {\n        let {ri, ci, state} = flex[i];\n        let s_t = 0;\n        for (let j = 0; j < i; j++) {\n            let {set_total, state} = flex[j];\n            if (state == true) {\n                s_t += set_total;\n            }\n        }\n\n        const dbox = getDrawBox.call(this, ri, ci);\n        draw.dropup(dbox, state, s_t * 25);\n    }\n\n    // const dbox = getDrawBox.call(this, ri, ci);\n    // draw.dropup(dbox);\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n\n        if (!autoFilter.active()) {\n            return;\n        }\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                console.log(ri, ci, 108)\n                const dbox = getDrawBox.call(this, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n    // renderFlexible.call(this, 1, 1)\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n    // 1 render cell\n    draw.save();\n\n    viewRange.each((ri, ci) => {\n        renderCell.call(this, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n    // 2 render cell border\n    // draw.save();\n    // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));\n    // draw.restore();\n\n    // / bboxes = [];\n    // 3 render mergeCell\n    const rset = new Set();\n    draw.save();\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell.call(this, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n\n    // 4 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    // 5 render flex\n    renderFlexible.call(this);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n                               sri, sci, eri, eci, w, h,\n                           }, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data, editor) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        // this.factory = new ApplicationFactory(data.methods, data.name, this);\n        this.editor = editor;\n        this.data = data;\n        this.timer = null;\n        // this.worker = new Worker();\n        this.autoAdaptList = [];\n    }\n\n\n    getCellTextContent(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const cell = data.getCell(nrindex, cindex);\n        if (cell === null) return;\n        // console.log(\"62\", cell.adapt);\n\n        let cellText = _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n        return cellText;\n    }\n\n    getDrawBox(rindex, cindex) {\n        const {data} = this;\n        const {\n            left, top, width, height,\n        } = data.cellRect(rindex, cindex);\n        return new DrawBox(left, top, width, height, cellPaddingWidth);\n    }\n\n    getCellTextStyle(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const style = data.getCellStyleOrDefault(nrindex, cindex);\n\n        return style;\n    }\n\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        let viewRange = data.viewRange();\n\n        parseCell.call(this);\n        this.clear();\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        let fh = rows.height;\n\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n\n        renderFixedLeftTopCell.call(this, fw, fh);\n\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3x\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n        testValid.call(this);\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","import {cuttingByPos, cuttingByPosEnd2, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {toUpperCase} from \"./table\";\n\nexport default class EditorText {\n    constructor() {\n        this.inputText = \"\";\n        this.oldCell = \"\";\n        this.ri = -1;\n        this.ci = -1;\n    }\n\n    setText(text) {\n        this.inputText = text;\n        return this.getText();\n    }\n\n    getText() {\n        return this.inputText;\n    }\n\n    setOldCell(oldCell, {ri = -1, ci = -1} = -1) {\n        this.oldCell = oldCell;\n        this.ri = ri;\n        this.ci = ci;\n        return this.getOldCell();\n    }\n\n    setRICI(ri, ci) {\n       this.ri = ri;\n        this.ci = ci;\n    }\n\n    getOldCell() {\n        return this.oldCell;\n    }\n\n    getRICI() {\n        return {\n            \"ri\": this.ri,\n            \"ci\": this.ci,\n        };\n    }\n\n    changeText(type) {\n        if (type === 1) {\n            this.setText(this.getText().replace(/，/g, ','));\n        }\n    }\n\n    isFormula() {\n        let inputText = this.getText();\n        if (inputText.lastIndexOf(\"=\") == 0) {\n            return true;\n        }\n        return false;\n    }\n\n    f4ShortcutKey(pos) {\n        let inputText = this.setText(toUpperCase(this.inputText));\n        let value = cuttingByPos(inputText, pos, true);\n        let value2 = cuttingByPosEnd2(inputText, pos + 1);\n        console.log(value2);\n        let type = isAbsoluteValue(value, 5);\n        let d = \"\";\n        let n = \"\";\n        n = value.split(\":\")[1];\n        if (n) {\n            type = isAbsoluteValue(n, 5);\n            type = type === 3 ? 6 : type;\n            type = type === 12 ? 9 : type;\n            type = type === 1 ? 7 : type;\n            type = type === 2 ? 8 : type;\n            console.log(type);\n        }\n\n        if (type != false) {\n            switch (type) {\n                case 13:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    let text_b = inputText.substring(0, inputText.lastIndexOf(n));\n                    inputText = this.setText(text_b + d);\n                    break;\n                case 12:\n                    n = value;\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    console.log(value2absolute(value));\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    console.log(this.getText());\n                    break;\n                case 11:\n                case 10:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 9:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 8:\n                    n = value.split(\":\")[1];\n                    d = n.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 7:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 6:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 5:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 4:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 3:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 2:\n                    d = value.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 1:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n            }\n        }\n        let newPos = inputText.length;\n        inputText = this.setText(inputText + value2);\n        return {\n            \"pos\": newPos,\n            \"inputText\": inputText\n        };\n    }\n}\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\nimport {\n    cutting,\n    cuttingByPos,\n    cuttingByPos2,\n    cuttingByPosEnd,\n    deepCopy,\n    isAbsoluteValue,\n    operation\n} from '../core/operator';\nimport SuggestContent from './suggest_content';\nimport {findBracket, suggestContent} from './formula_editor';\nimport {createEvent} from './event';\nimport EditorText from \"./editor_text\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n\nfunction resetTextareaSize() {\n    const {\n        textlineEl, textEl, areaOffset,\n    } = this;\n    if (!areaOffset) {\n        return;\n    }\n    const tlineWidth = textlineEl.offset().width + 9 + 15;\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\n    if (tlineWidth > areaOffset.width && areaOffset.width != 0) {\n        let twidth = tlineWidth;\n        if (tlineWidth > maxWidth) {\n            twidth = maxWidth - 15;\n            let h1 = parseInt(tlineWidth / (maxWidth - 15), 10);\n            h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            h1 *= this.rowHeight;\n            if (h1 > areaOffset.height) {\n                textEl.css('height', `${h1}px`);\n            }\n        }\n        textEl.css('width', `${twidth}px`);\n    }\n}\n\nfunction textFormat (e) {\n    e.preventDefault();\n    var text\n    var clp = (e.originalEvent || e).clipboardData\n    if (clp === undefined || clp === null) {\n        text = window.clipboardData.getData('text') || ''\n        if (text !== '') {\n            if (window.getSelection) {\n                var newNode = document.createElement('span')\n                newNode.innerHTML = text\n                window.getSelection().getRangeAt(0).insertNode(newNode)\n            } else {\n                document.selection.createRange().pasteHTML(text)\n            }\n        }\n    } else {\n        text = clp.getData('text/plain') || ''\n        if (text !== '') {\n            document.execCommand('insertText', false, text)\n        }\n    }\n}\n\nconst getCursortPosition = function (containerEl) {\n    let selection = window.getSelection();\n    if (selection.rangeCount <= 0) {\n        return 0;\n    }\n    const range = window.getSelection().getRangeAt(0);\n    const preSelectionRange = range.cloneRange();\n    preSelectionRange.selectNodeContents(this.textEl.el);\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n    const start = preSelectionRange.toString().length;\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    const {exist, left, right} = findBracket(start - 1, cutting(inputText), inputText);\n    Object.keys(this.spanArr).forEach((i) => {\n        this.spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n    });\n    const spanLeft = this.spanArr[left];\n    const spanRight = this.spanArr[right];\n    this.suggestContent.hide();\n    if (exist && spanLeft && spanRight) {\n        spanLeft.css('background-color', 'rgb(229, 229, 229)');\n        spanRight.css('background-color', 'rgb(229, 229, 229)');\n    } else {\n        const {show} = this.suggest;\n        const content = suggestContent.call(this, start, cutting(inputText), inputText);\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        }\n    }\n\n    return start;\n};\n\nfunction set_focus(el) {\n    if (!this) {\n        return;\n    }\n    const savedSel = {\n        start: this.pos,\n        end: this.pos,\n    };\n    let charIndex = 0;\n    const\n        range = document.createRange();\n    range.setStart(el, 0);\n    range.collapse(true);\n    const nodeStack = [el];\n    let node;\n    let foundStart = false;\n    let\n        stop = false;\n\n    while (!stop && (node = nodeStack.pop())) {\n        if (node.nodeType == 3) {\n            const nextCharIndex = charIndex + node.length;\n            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\n                range.setStart(node, savedSel.start - charIndex);\n                foundStart = true;\n            }\n            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\n                range.setEnd(node, savedSel.end - charIndex);\n                stop = true;\n            }\n            charIndex = nextCharIndex;\n        } else {\n            let i = node.childNodes.length;\n            while (i--) {\n                nodeStack.push(node.childNodes[i]);\n            }\n        }\n    }\n\n    const sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\nconst setCursorPosition = (elem, index) => {\n    const val = elem.value || elem.textContent;\n    const len = val.length;\n\n    // 超过文本长度直接返回\n    if (len < index) return;\n    set_focus.call(this, elem);\n};\n\nfunction mouseDownEventHandler(evt) {\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    this.pos = getCursortPosition.call(this, evt);\n    parse2.call(this, inputText, this.pos);\n}\n\nfunction setOldCell() {\n    let d = isDisplay.call(this);\n    if (d === false) {\n        let cell = this.data.getCell(this.ri, this.ci);\n        this.editorText.setOldCell(deepCopy(cell), {ri: this.ri, ci: this.ci});\n    }\n}\n\nfunction inputEventHandler(evt, txt = '', formulas = '', state = \"input\") {\n    setOldCell.call(this);\n\n    if (evt) {\n        const {\n            inputType,\n        } = evt;\n\n        if (inputType === 'insertFromPaste' && this.textEl.el.style['caret-color'] != 'black') {\n            this.copy = true;\n            return;\n        }\n\n        if (inputType === 'historyUndo') {\n            return;\n        }\n    }\n\n\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    // if (inputText === '') {\n    //     const {data} = this;\n    //     const {history} = data;\n    //     history.add(data.getData());\n    // }\n\n    setTimeout(() => {\n        if (this.chinese == false) return;\n        let v = '';\n        if (this.data.settings.showEditor) {\n            this.sheet.selector.hide();\n        } else {\n            return;\n        }\n\n        if (txt == '' && evt && evt.target && evt.target.childNodes) {\n            let t1 = '';\n            for (let i = 0, len = evt.target.childNodes.length; i < len; i++) {\n                if (evt.target.childNodes[i].nodeType === 1) {\n                    v += evt.target.childNodes[i].innerText;\n                } else if (evt.target.childNodes[i].nodeType === 3) {\n                    t1 += evt.target.childNodes[i].nodeValue;\n                }\n            }\n            v = t1 !== '' ? t1 : v;\n        } else if(txt == '' && evt && isHave(evt.data)) {\n            v = evt.data !== '' ? evt.data : v;\n        } else{\n            v = txt;\n        }\n\n        if (this.copy) {\n            this.copy = false;\n            v = (evt && evt.data) ? evt.data : '';\n            this.textEl.html(v);\n            this.pos = v.length;\n            set_focus.call(this, this.textEl.el, -1);\n        }\n        this.changed = true;\n        const {\n            suggest, textlineEl, validator, textEl, save,\n        } = this;\n        editorText.setText(`${v}`);\n        // inputText = `${v}`;\n        editorText.changeText(1);\n        // inputText = inputText.replace(/，/g, ',');\n        this.pos = getCursortPosition.call(this, evt);\n\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            v = v + \"\";\n            const start = v.lastIndexOf('=');\n            if (this.pos != -1) {\n                parse2.call(this, v, this.pos);\n            } else parse.call(this, v);\n            let show = false;\n            let cutValue = cuttingByPos2(v, this.pos, true);\n            if (v.length >= this.pos) {\n                const isNumber = `${v[this.pos]}`;\n                if (isNumber.search(/^[0-9]+.?[0-9]*$/) != -1) {\n                    show = true;\n                } else if (isNumber) {\n                    const c = cuttingByPosEnd(v, this.pos + 1);\n                    cutValue += c;\n                }\n            }\n\n            if (start === 0 && v.length > 1 && cutValue != '' && !show && cutValue.trim().length > 0) {\n                suggest.search(cutValue);\n            } else {\n                suggest.hide();\n            }\n        }\n\n\n        textlineEl.html(formulas || v);\n        editorText.setText(formulas || v);\n        this.suggest.itemIndex = -1;\n        resetTextareaSize.call(this);\n        if (v && v[0] !== '=') {\n            set_focus.call(this, textEl.el, -1);\n        }\n\n        if (formulas && formulas[0] === '=') {\n            v = formulas;\n        }\n        this.change(state, v);\n        testValid.call(this, this.valid2);\n        setTimeout(() => {\n            this.show();\n        });\n    });\n\n}\n\nfunction keyDownEventHandler(evt) {\n    this.pos = getCursortPosition.call(this, evt);\n    if (evt.code === 'ArrowRight') {\n        this.pos = this.pos + 1;\n    } else if (evt.code === 'ArrowLeft') {\n        this.pos = this.pos - 1;\n    }\n\n    const keyCode = evt.keyCode || evt.which;\n    // this.textEl.el.style['caret-color'] != 'black' 加这个主要防止用户在没有输入的情况下按下esc\n    if (keyCode == 27 && this.textEl.el.style['caret-color'] == 'black' && this.textEl.el.style.opacity == '1') {\n        this.change('input', '@~esc');\n    } else if (keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {\n    }\n}\n\nfunction parse(v) {\n    const start = v.lastIndexOf('=');\n\n\n    if (start === 0 && v.length >= 1 && operation(v[v.length - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length == 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, this.pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction parse2(v, pos) {\n    v = v + \"\";\n    const start = v.lastIndexOf('=');\n    if (start === 0 && v.length >= 1 && operation(v[pos - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length == 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction setTextareaRange(position) {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        // el.focus();\n        set_focus.call(this, el);\n        // el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text, position) {\n    const {textEl, textlineEl, tmp} = this;\n    // firefox bug\n    textEl.el.blur();\n    tmp.html(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this, position);\n}\n\n\nfunction suggestItemClick(it) {\n    const {validator, editorText} = this;\n    let inputText = editorText.getText();\n    let position = 0;\n    if (validator && validator.type === 'list') {\n        // this.inputText = it;\n        inputText = editorText.setText(it);\n        position = inputText.length;\n    } else {\n        this.pos = getCursortPosition.call(this);\n        const begin = this.pos - cuttingByPos(inputText, this.pos).length;\n        const c = cuttingByPosEnd(inputText, this.pos + 1);\n        const arr = ['', ''];\n        const end = this.pos + c.length;\n        for (let i = 0; i < inputText.length; i++) {\n            if (i < begin) {\n                arr[0] += inputText[i];\n            }\n\n            if (i > end - 1) {\n                arr[1] += inputText[i];\n            }\n        }\n        inputText = editorText.setText(`${arr[0] + it.key}(`);\n        // this.inputText = `${arr[0] + it.key}(`;\n        this.pos = editorText.getText().length;\n        inputText = editorText.setText(inputText + `)${arr[1]}`);\n        // this.inputText += `)${arr[1]}`;\n    }\n    this.textEl.html(inputText);\n    this.textlineEl.html(inputText);\n    this.suggest.hide();\n    parse2.call(this, inputText, this.pos);\n    this.change('input', inputText);\n    set_focus.call(this, this.textEl.el, -1);\n    resetTextareaSize.call(this);\n}\n\nfunction resetSuggestContentItems() {\n    this.suggestContent.hide();\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nfunction isDisplay() {\n    if (this.textEl.el.style['caret-color'] == 'black'\n        && this.textEl.el.style.opacity == '1') return true;\n    return false;\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight, rowWidth, data, sheet) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.sheet = sheet;\n        this.display = true;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        }, data, this);\n        this.suggestContent = new SuggestContent();\n        this.lock = false;\n        this.state = 1;\n        this.data = data;\n        this.datepicker = new Datepicker();\n        this.isCors = false;\n        this.datepicker.change((d) => {\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.ri = -1;\n        this.ci = -1;\n        this.spanArr = [];\n        this.mousedownIndex = [];\n        this.changed = false;\n        this.chinese = true;\n\n        this.editorText = new EditorText('');\n\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('div', `${cssPrefix}-editor-textEl`)\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('click', evt => mouseDownEventHandler.call(this, evt))\n                    .on('keyup', evt => keyDownEventHandler.call(this, evt))\n                    .on('mousedown', (evt) => {\n                        if (evt.detail == 2) {\n                            if (isDisplay.call(this)) {\n                                return;\n                            }\n                            this.show();\n                            setTimeout(() => {\n                                const {ri, ci} = this;\n                                console.log(ri, ci);\n                                this.setCellEnd(data.getSelectedCellRiCi(ri, ci));\n                            });\n                        }\n                    })\n                    .on('compositionstart', (evt) => {\n                        this.chinese = false;\n                    })\n                    .on('compositionend', (evt) => {\n                        this.chinese = true;\n                    })\n                    .on('paste', (evt) => {\n                        if (this.textEl.el.style['caret-color'] == 'black') {\n                            // createEvent.call(this, 67, true, \"paste\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('copy', (evt) => {\n                        if (this.textEl.el.style['caret-color'] == 'black') {\n                            // createEvent.call(this, 86, true, \"sheetCopy\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('keydown', (evt) => {\n                        resetTextareaSize.call(this);\n                        this.textlineEl.html(evt.currentTarget.innerText);\n                        const key_num = evt.keyCode;\n                        // ctrl + v 67     ctrl + v  86\n                        if (key_num === 38 || key_num === 40) {\n                            evt.preventDefault();\n                        }\n                        if (key_num === 115) {       // F4\n                            let {inputText, pos} = this.editorText.f4ShortcutKey(getCursortPosition.call(this));\n                            inputEventHandler.call(this, null, inputText, inputText);\n                            setTimeout(() => {\n                                this.pos = pos;\n                                set_focus.call(this, this.textEl.el, -1);\n                            });\n                            return;\n                        }\n                        if (this.textEl.el.style['caret-color'] == 'black') return;\n                        const {\n                            ctrlKey, metaKey,\n                        } = evt;\n\n                        if (key_num === 8 || key_num === 46) {\n                            createEvent.call(this, 8, false);\n                        } else if (key_num === 40) {\n                            this.clear();\n                            createEvent.call(this, 40, false);\n                        } else if (key_num === 39) {\n                            this.clear();\n                            createEvent.call(this, 39, false);\n                        } else if (key_num === 37) {\n                            this.clear();\n                            createEvent.call(this, 37, false);\n                        } else if (key_num === 38) {\n                            this.clear();\n                            createEvent.call(this, 38, false);\n                        } else if (ctrlKey || metaKey) {\n                            if (key_num === 67) {\n                                createEvent.call(this, 67, true);\n                            } else if (key_num === 86) {\n                                createEvent.call(this, 86, true);\n                            } else if (key_num === 88) {\n                                createEvent.call(this, 88, true);\n                            } else if (key_num === 90) {\n                                createEvent.call(this, 90, true);\n                            } else if (key_num === 66) {\n                                createEvent.call(this, 66, true);\n                            }\n                        }\n                    }),\n                this.textlineEl = h('div', 'textline'),\n                this.suggestContent.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n\n        sheet.el.child(this.suggest.el);\n        this.el = h('div', `${cssPrefix}-editor`)\n            .children(this.areaEl);\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.textEl.on('paste', (evt) => {\n            if (isDisplay.call(this) === false)\n                return;\n            textFormat(evt);\n        });\n        this.tmp = h('span', 'span_tmp').hide();\n        this.textEl.attr('contenteditable', 'true');\n        this.textEl.css('width', `${rowWidth - 3}px`);\n        this.textEl.css('height', `${rowHeight - 2}px`);\n        this.textEl.child(this.tmp);\n        this.pos = 0;\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n\n        setTimeout(() => {\n            this.show(false);\n        });\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    setMouseDownIndex(index) {\n        this.mousedownIndex = index;\n    }\n\n    setRiCi(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n        if (this.ri === -1 || this.ci === -1) {\n            return;\n        }\n        // const cell = this.data.rows.getCell(ri, ci);\n        //\n        // this.editorText.setOldCell(deepCopy(cell));\n    }\n\n    setLock(lock) {\n        this.lock = lock;\n    }\n\n    getLock() {\n        return this.lock;\n    }\n\n\n    show(off = true) {\n\n        if (off && this.data.settings.showEditor) {\n            this.textEl.css('caret-color', 'black');\n            this.textEl.css('cursor', 'text');\n            this.textEl.css('opacity', '1');\n            this.textEl.el.focus();\n            this.areaEl.css('pointer-events', 'auto');\n            this.areaEl.css('border', '2px solid #4b89ff');\n            this.areaEl.css('background', 'white');\n        } else {\n            this.textEl.css('caret-color', 'white');\n            this.textEl.css('cursor', 'default');\n            this.textEl.css('opacity', '0');\n            this.textEl.el.blur();\n            this.areaEl.css('pointer-events', 'none');\n            this.areaEl.css('background', 'rgba(75, 137, 255, 0)');\n            this.areaEl.css('border', 'none');\n        }\n    }\n\n    parse(pos = -1) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n        if (pos != -1) {\n            this.pos = getCursortPosition.call(this);\n            parse2.call(this, inputText, this.pos);\n        } else {\n            parse.call(this, inputText);\n        }\n    }\n\n    clear(c = false) {\n\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        this.display = isDisplay.call(this);\n\n        if (inputText !== '' && isNaN(inputText) && inputText.replace(/\\s/g, \"\").lastIndexOf('¥') === 0) {\n            this.change('format', inputText);\n\n        } else if (this.changed) {\n\n            this.change('finish', inputText);\n\n        }\n\n        this.changed = false;\n        this.cell = null;\n        this.areaOffset = null;\n        inputText = editorText.setText('');\n        // this.inputText = '';\n        this.show(false);\n        this.copy = false;\n        set_focus.call(this, this.textEl.el, -1);\n        this.pos = 0;\n        this.tmp.hide();\n        this.textEl.html('');\n        this.textlineEl.html('');\n        resetSuggestContentItems.call(this);\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n\n        if (c) {\n            return false;\n        }\n\n        setTimeout(() => {\n            const {ri, ci} = this.data.selector;\n            this.setRiCi(ri, ci);\n        });\n\n        return this.display;\n    }\n\n    mount2span(spanArr, pos = -1, begin = -1, content = {suggestContent: false, cut: '', pos: -1}) {\n        if (this.spanArr === spanArr) {\n            return;\n        }\n\n        const {show} = this.suggest;\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        } else {\n            this.suggestContent.hide();\n        }\n        Object.keys(spanArr).forEach((i) => {\n            spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n        });\n        if (pos !== '-1' && begin != -1 && spanArr[pos]) {\n            spanArr[pos].css('background-color', '#e5e5e5');\n            spanArr[begin].css('background-color', '#e5e5e5');\n        }\n\n        if (spanArr.length > 0) {\n            this.textEl.html('');\n            this.tmp = h('span', 'span_tmp').children(...spanArr)\n                .css('top', '0px').css('color', 'black').css('font-size', '14px').css('font-family', 'm-inconsolata,monospace,arial,sans,sans-serif');\n            this.textEl.el.insertBefore(this.tmp.el, this.textEl.el.childNodes[0]);\n            // this.textEl.el.removeChild(this.textEl.el.childNodes[this.textEl.el.childNodes.length - 1]);\n            set_focus.call(this, this.textEl.el, -1);\n        }\n\n        this.spanArr = spanArr;\n    }\n\n    handler(text) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        const cursorPos = this.pos;\n        if (cursorPos >= inputText) {\n            this.setMouseDownIndex([]);\n            return;\n        }\n        const textBegin = text.substring(0, cursorPos);\n        const textEnd = text.substring(cursorPos, text.length);\n        parse.call(this, textBegin);\n        if (textEnd !== '') {\n            this.setMouseDownIndex([textBegin, textEnd]);\n        } else {\n            this.setMouseDownIndex([]);\n        }\n    }\n\n    setOffset(offset, suggestPosition = 'top', show = true) {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 2 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            // suggest.setOffset(sOffset);\n            suggest.hide();\n            resetTextareaSize.call(this);\n            if (show) {\n                this.show(false);\n            }\n        }\n    }\n\n    setCellEnd(cell) {\n        let text = '';\n        if(isHave(cell) && isHave(cell.text)) {\n            text = cell.text;\n        }\n\n        if(isHave(cell) && isHave(cell.formulas)) {\n            text = cell.formulas;\n        }\n\n        let {data} = this;\n        const style = data.getCellStyleOrDefault( this.ri, this.ci);\n        let args = data.renderFormat(style, cell, this.ri, this.ci, true);\n        text = args.state ? args.cellText : text;\n\n        this.textEl.child(text + \"\");\n        this.pos = text.length;\n        set_focus.call(this, this.textEl.el, -1);\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n\n        testValid.call(this);\n        inputEventHandler.call(this, null,  text, (cell && cell.formulas) || '', \"end\");\n\n        setTimeout(() => {\n            this.pos = data.rows.toString(text).length;\n            set_focus.call(this, this.textEl.el, -1);\n        }, 20)\n    }\n\n    setCell(cell, validator, type = 1) {\n        this.cell = cell;\n        this.show();\n\n        let text = (cell && cell.formulas) || '';\n        text = text == '' ? (cell && cell.text) || '' : text;\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.textEl.show();\n        set_focus.call(this, this.textEl.el, -1);\n        setTimeout(() => {\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el);\n        }, 10);\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n\n        if (type == 2 && text != '' && text[0] == '=') {\n            inputEventHandler.call(this, null, text);\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el, text.length);\n        } else if (type == 2 && text[0] != '=') {\n            this.textEl.child(text);\n        }\n        setTimeout(() => {\n            this.textlineEl.html(text);\n            resetTextareaSize.call(this);\n        });\n    }\n\n    inputEventHandler(text = '', pos = 1, hide = false) {\n        if (hide) {\n            this.areaEl.hide();\n            this.sheet.selector.hide();\n            this.isCors = true;\n        }\n        this.setCursorPos(pos);\n        inputEventHandler.call(this, null, text);\n    }\n\n    isDisplay() {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        if (isDisplay.call(this) && editorText.isFormula())\n            return true;\n        else\n            return false\n    }\n\n    isDisplay2() {\n        if (isDisplay.call(this))\n            return true;\n        else\n            return false\n    }\n\n    setCursorPos(pos) {\n        this.pos = pos;\n        set_focus.call(this, this.textEl.el);\n    }\n\n    setText(text) {\n        let {editorText} = this;\n        editorText.setText(text);\n        // this.inputText = text;\n        setText.call(this, text, text.length);\n        resetTextareaSize.call(this);\n        this.textEl.child(this.tmp);\n    }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  // { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  // { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  // { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', (evt) => {\n      this.itemClick(item.key, evt);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false) {\n    this.menus = buildMenu.call(this);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menus)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { height, width } = el.show().offset();\n    const view = this.viewFn();\n    let top = y;\n    let left = x;\n    if (view.height - y <= height) {\n      top -= height;\n    }\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.offset({ left, top });\n    bindClickoutside(el);\n  }\n}\n","import {Element, h} from './element';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Dropdown extends Element {\n    constructor(title, width, showArrow, placement, {type, change, arrowChange, historyBorder}, ...children) {\n        super('div', `${cssPrefix}-dropdown ${placement}`);\n\n        this.title = title;\n        this.change = () => {\n        };\n        if (typeof title === 'string') {\n            this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n        } else if (showArrow) {\n            this.title.addClass('arrow-left');\n        }\n        this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n            .children(...children)\n            .css('width', width)\n            .hide();\n\n        if (type) {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`).on('click', change);\n            this.headerEl.children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right_d`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`).on('click.stop', (evt) => {\n                        arrowChange(historyBorder);\n                        if (this.contentEl.css('display') !== 'block') {\n                            this.show();\n                        } else {\n                            this.hide();\n                        }\n                    }),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        } else {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n            this.headerEl.on('click', () => {\n                if (this.contentEl.css('display') !== 'block') {\n                    this.show();\n                } else {\n                    this.hide();\n                }\n            }).children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        }\n    }\n\n    setTitle(title) {\n        this.title.html(title);\n        this.hide();\n    }\n\n    show() {\n        const {contentEl} = this;\n        contentEl.show();\n        this.parent().active();\n        bindClickoutside(this.parent(), () => {\n            this.hide();\n        });\n    }\n\n    hide() {\n        this.parent().active(false);\n        this.contentEl.hide();\n        unbindClickoutside(this.parent());\n    }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', {type: false}, ...nfonts );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', {type: false}, ...nfontSizes );\n  }\n}\n","import {tf} from '../locale/locale';\nimport {isHave, isNumber} from \"./helper\";\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v, fixed = 2) => {\n    if(!isHave(v) || !isNumber(v)) {\n        return v;\n    }\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = fixed === -1 ? v.toString() : Number(v).toFixed(fixed).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        let value = first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1');\n        return value === 'NaN' ? v : value;\n    }\n\n    return v === 'NaN' ? v : v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'text',\n    //     title: tf('format.text'),\n    //     type: 'string',\n    //     render: formatStringRender,\n    // },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: (v) => {\n            const a = multiply(v, 100);\n            const a_s = `${a}`;\n            return `${a_s}%`;\n        },\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '￥10.00',\n        render: v => `￥${formatNumberRender(v)}`,\n    },\n    // {\n    //     key: 'usd',\n    //     title: tf('format.usd'),\n    //     type: 'number',\n    //     label: '$10.00',\n    //     render: v => `$${formatNumberRender(v)}`,\n    // },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '2009-01-01',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'datetime',\n        label: '2009年01月01日',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'time',\n    //     title: tf('format.time'),\n    //     type: 'date',\n    //     label: '15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'datetime',\n    //     title: tf('format.datetime'),\n    //     type: 'date',\n    //     label: '26/09/2008 15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'duration',\n    //     title: tf('format.duration'),\n    //     type: 'date',\n    //     label: '24:01:00',\n    //     render: formatStringRender,\n    // },\n];\n\nfunction isInteger(obj) {\n    return Math.floor(obj) === obj;\n}\n\n\nfunction add(a, b, digits) {\n    return operation(a, b, digits, 'add');\n}\n\nfunction subtract(a, b, digits) {\n    return operation(a, b, digits, 'subtract');\n}\n\nexport function multiply(a, b, digits) {\n    return operation(a, b, digits, 'multiply');\n}\n\nfunction divide(a, b, digits) {\n    return operation(a, b, digits, 'divide');\n}\n\n/*\n * 将一个浮点数转成整数，返回整数和倍数。如 3.14 >> 314，倍数是 100\n * @param floatNum {number} 小数\n * @return {object}\n *   {times:100, num: 314}\n */\nfunction toInteger(floatNum) {\n    const ret = {times: 1, num: 0};\n    const isNegative = floatNum < 0;\n    if (isInteger(floatNum)) {\n        ret.num = floatNum;\n        return ret;\n    }\n    const strfi = `${floatNum}`;\n    const dotPos = strfi.indexOf('.');\n    const len = strfi.substr(dotPos + 1).length;\n    const times = Math.pow(10, len);\n    let intNum = parseInt(Math.abs(floatNum) * times + 0.5, 10);\n    ret.times = times;\n    if (isNegative) {\n        intNum = -intNum;\n    }\n    ret.num = intNum;\n    return ret;\n}\n\nfunction operation(a, b, digits, op) {\n    const o1 = toInteger(a);\n    const o2 = toInteger(b);\n    const n1 = o1.num;\n    const n2 = o2.num;\n    const t1 = o1.times;\n    const t2 = o2.times;\n    const max = t1 > t2 ? t1 : t2;\n    let result = null;\n    switch (op) {\n        case 'add':\n            if (t1 === t2) { // 两个小数位数相同\n                result = n1 + n2;\n            } else if (t1 > t2) { // o1 小数位 大于 o2\n                result = n1 + n2 * (t1 / t2);\n            } else { // o1 小数位 小于 o2\n                result = n1 * (t2 / t1) + n2;\n            }\n            return result / max;\n        case 'subtract':\n            if (t1 === t2) {\n                result = n1 - n2;\n            } else if (t1 > t2) {\n                result = n1 - n2 * (t1 / t2);\n            } else {\n                result = n1 * (t2 / t1) - n2;\n            }\n            return result / max;\n        case 'multiply':\n            result = (n1 * n2) / (t1 * t2);\n            return result;\n        case 'divide':\n            result = (n1 / n2) * (t2 / t1);\n            return result;\n    }\n}\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport default {};\nexport {\n    formatm,\n    baseFormats,\n    formatNumberRender\n};\n","import Dropdown from './dropdown';\nimport {h} from './element';\nimport {baseFormats} from '../core/format';\nimport {cssPrefix} from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n    constructor() {\n        let nformats = baseFormats.slice(0);\n        nformats.splice(1, 0, {key: 'divider'});\n        nformats.splice(5, 0, {key: 'divider'});\n        nformats = nformats.map((it) => {\n            const item = h('div', `${cssPrefix}-item`);\n            if (it.key === 'divider') {\n                item.addClass('divider');\n            } else {\n                item.child(it.title())\n                    .on('click', () => {\n                        this.setTitle(it.title());\n                        this.change(it);\n                    });\n                if (it.label) item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        super('Normal', '220px', true, 'bottom-left', {type: false}, ...nformats );\n    }\n\n    setTitle(key) {\n        for (let i = 0; i < baseFormats.length; i += 1) {\n            if (baseFormats[i].key === key) {\n                this.title.html(baseFormats[i].title);\n            }\n        }\n        this.hide();\n    }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', {type: false}, ...nformulas );\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, colorPalette.el);\n    this.colorPalette = colorPalette;\n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left',  {type: false}, ...naligns );\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', {type: false}, ...lineTypeEls );\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  let item =  h('div', `${cssPrefix}-border-palette-cell`);\n  this.items.push(item);\n  return h('td', '').child(\n    item.child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    this.items = [];\n\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, borderPalette.el );\n    this.borderPalette = borderPalette;\n  }\n}\n","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\n\nexport default class HistoryBorder {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-history-border`);\n        this.history = h('div', `${cssPrefix}-history-content`).html('暂无内容');\n        this.el.child( this.history);\n    }\n\n    setContent(items) {\n        items = items.slice(items.length - 100 < 0 ? 0 : items.length, items.length);\n        this.el.html('');\n        let els = [];\n        for(let i = items.length - 1; i >= 0; i--) {\n            let d = h('div', '');\n            let {action} = items[i];\n            d.html(action);\n            els.push(d);\n        }\n\n        console.log(this, this.el);\n        this.el.children(...els);\n    }\n}","import Dropdown from \"./dropdown\";\nimport Icon from \"./icon\";\nimport HistoryBorder from \"./history_border\";\n\nexport default class DropdownAction extends Dropdown {\n    constructor(iconName, change, arrowChange) {\n        const icon = new Icon(iconName)\n            .css('height', '18px');\n        const historyBorder = new HistoryBorder();\n        super(icon, 'auto', true, 'bottom-left', {type: true, change: change, arrowChange: arrowChange, historyBorder}, historyBorder.el);\n    }\n}","/* global window */\nimport {h} from './element';\nimport {bind} from './event';\nimport tooltip from './tooltip';\nimport DropdownFont from './dropdown_font';\nimport DropdownFontSize from './dropdown_fontsize';\nimport DropdownFormat from './dropdown_format';\nimport DropdownFormula from './dropdown_formula';\nimport DropdownColor from './dropdown_color';\nimport DropdownAlign from './dropdown_align';\nimport DropdownBorder from './dropdown_border';\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\nimport DropdownAction from \"./dropdown_action\";\n\nfunction buildIcon(name) {\n    return new Icon(name);\n}\n\nexport function buildButton(tooltipdata) {\n    return h('div', `${cssPrefix}-toolbar-btn`)\n        .on('mouseenter', (evt) => {\n            tooltip(tooltipdata, evt.target);\n        })\n        .attr('data-tooltip', tooltipdata);\n}\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nexport function buildButtonWithIcon(tooltipdata, iconName, change = () => {\n}) {\n    return buildButton(tooltipdata)\n        .child(buildIcon(iconName))\n        .on('click', () => change());\n}\n\nfunction bindDropdownChange() {\n    this.ddFormat.change = it => this.change('format', it.key);\n    this.ddFont.change = it => this.change('font-name', it.key);\n    this.ddFormula.change = it => this.change('formula', it.key);\n    this.ddFontSize.change = it => this.change('font-size', it.pt);\n    this.ddTextColor.change = it => this.change('color', it);\n    this.ddFillColor.change = it => this.change('bgcolor', it);\n    this.ddAlign.change = it => this.change('align', it);\n    this.ddVAlign.change = it => this.change('valign', it);\n    this.ddBorder.change = it => this.change('border', it);\n    this.undoEl.change = it => this.change('undo', it);\n}\n\n\nfunction toggleChange(type) {\n    let elName = type;\n    const types = type.split('-');\n    if (types.length > 1) {\n        types.forEach((it, i) => {\n            if (i === 0) elName = it;\n            else elName += it[0].toUpperCase() + it.substring(1);\n        });\n    }\n    const el = this[`${elName}El`];\n    el.toggle();\n    this.change(type, el.hasClass('active'));\n}\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', false,  moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nfunction initBtns2() {\n    this.btns2 = this.btnChildren.map((it) => {\n        const rect = it.box();\n        const {marginLeft, marginRight} = it.computedStyle();\n        return [it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)];\n    });\n}\n\nfunction moreResize(widthFn = this.widthFn) {\n    const {\n        el, btns, moreEl, ddMore, btns2,\n    } = this;\n    const {moreBtns, contentEl} = ddMore;\n    el.css('width', `${ widthFn() - 60}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        const style = data.defaultStyle();\n        this.ddFormat = new DropdownFormat();\n        this.ddFont = new DropdownFont();\n        this.ddFormula = new DropdownFormula();\n        this.ddFontSize = new DropdownFontSize();\n        this.ddTextColor = new DropdownColor('text-color', style.color);\n        this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\n        this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\n        this.ddVAlign = new DropdownAlign(['top', 'middle', 'bottom'], style.valign);\n        this.ddBorder = new DropdownBorder();\n        this.ddMore = new DropdownMore();\n        this.undoEl = new DropdownAction('undo',  () => this.change('undo'), (v) => this.change('undoList', v));\n        this.redoEl = new DropdownAction('redo',  () => this.change('redo'), (v) => this.change('redoList', v));\n        this.btnChildren = [\n            // this.undoEl = buildButtonWithIcon(`${t('toolbar.undo')} (Ctrl+Z)`, 'undo', () => this.change('undo')),\n\n            // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\n            buildButton(`${t('toolbar.undo')}`).child(this.undoEl.el),\n            buildButton(`${t('toolbar.redo')}`).child(this.redoEl.el),\n            this.paintformatEl = buildButtonWithIcon(`${t('toolbar.paintformat')}`, 'paintformat', () => toggleChange.call(this, 'paintformat')),\n            this.clearformatEl = buildButtonWithIcon(`${t('toolbar.clearformat')}`, 'clearformat', () => this.change('clearformat')),\n            buildDivider(),\n            buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\n            buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\n            buildDivider(),\n            this.fontBoldEl = buildButtonWithIcon(`${t('toolbar.fontBold')} (Ctrl+B)`, 'bold', () => toggleChange.call(this, 'font-bold')),\n            this.fontItalicEl = buildButtonWithIcon(`${t('toolbar.fontItalic')} (Ctrl+I)`, 'italic', () => toggleChange.call(this, 'font-italic')),\n            this.underlineEl = buildButtonWithIcon(`${t('toolbar.underline')} (Ctrl+U)`, 'underline', () => toggleChange.call(this, 'underline')),\n            // this.flexibleEl = buildButtonWithIcon(`${t('toolbar.flexibleEl')} `, 'flexible', () => toggleChange.call(this, 'flexible')),\n            this.strikeEl = buildButtonWithIcon(`${t('toolbar.strike')}`, 'strike', () => toggleChange.call(this, 'strike')),\n            buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\n            buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\n            this.mergeEl = buildButtonWithIcon(`${t('toolbar.merge')}`, 'merge', () => toggleChange.call(this, 'merge')),\n            buildDivider(),\n            buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\n            buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\n            this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.call(this, 'textwrap')),\n            buildDivider(),\n            // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\n            // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\n            this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\n            this.addEl = buildButtonWithIcon(`${t('toolbar.add')}`, 'add', () => toggleChange.call(this, 'add')),\n            this.closeEl = buildButtonWithIcon(`${t('toolbar.calc')}`, 'close', () => toggleChange.call(this, 'close')),\n            this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleChange.call(this, 'autofilter')),\n            this.throwFormulaEl = buildButtonWithIcon(`${t('toolbar.throwFormula')}`, 'chevron-right', () => toggleChange.call(this, 'throwFormula')),\n            // buildButton(`${t('toolbar.date_formula')}`).child(this.ddFormula.el),\n            // buildDivider(),\n            this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),\n        ];\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(...this.btnChildren);\n        this.el.child(this.btns);\n        if (isHide) this.el.hide();\n        bindDropdownChange.call(this);\n        this.reset();\n        setTimeout(() => {\n            initBtns2.call(this);\n            moreResize.call(this);\n        }, 0);\n        bind(window, 'resize', () => {\n            moreResize.call(this, data.settings.view.width);\n        });\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.hasClass('active');\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        toggleChange.call(this, type);\n    }\n\n    reset() {\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        const cell = data.getSelectedCell();\n        this.undoEl.disabled(!data.canUndo());\n        this.redoEl.disabled(!data.canRedo());\n        this.mergeEl.active(data.canUnmerge())\n            .disabled(!data.selector.multiple());\n        this.autofilterEl.active(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font} = style;\n        this.ddFont.setTitle(font.name);\n        this.ddFontSize.setTitle(font.size);\n        this.fontBoldEl.active(font.bold);\n        this.fontItalicEl.active(font.italic);\n        this.underlineEl.active(style.underline);\n        // this.flexibleEl.active(style.flexible);\n        this.strikeEl.active(style.strike);\n        this.ddTextColor.setTitle(style.color);\n        this.ddFillColor.setTitle(style.bgcolor);\n        this.ddAlign.setTitle(style.align);\n        this.ddVAlign.setTitle(style.valign);\n        this.textwrapEl.active(style.textwrap);\n        this.addEl.active(data.equationIsActive());\n        this.closeEl.active(false);\n        this.throwFormulaEl.active(false);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.active(data.freezeIsActive());\n        if (cell) {\n            if (cell.format) {\n                this.ddFormat.setTitle(cell.format);\n            }\n        }\n    }\n}\n","/* global document */\nimport {h} from './element';\nimport {bind} from './event';\nimport {cssPrefix} from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n      if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n      this.open = false;\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n      this.open = true;\n      bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n      this.open = false;\n      document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import { Element } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nexport default class Button extends Element {\n  // type: primary\n  constructor(title, type = '') {\n    super('div', `${cssPrefix}-button ${type}`);\n    this.child(t(`button.${title}`));\n  }\n}\n","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  showVf(it) {\n    const hint = it === 'date' ? '2018-11-12' : '10';\n    const { vf } = this;\n    vf.input.hint(hint);\n    vf.show();\n  }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import {h} from './element';\nimport Button from './button';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nfunction buildMenu(clsName) {\n    return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n    return buildMenu('state').child(t(`sort.${it}`))\n        .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n    const {filterbEl, filterValues} = this;\n    filterbEl.html('');\n    const itemKeys = Object.keys(items);\n    console.log(\"20\")\n    itemKeys.forEach((it, index) => {\n        const cnt = items[it];\n        const active = filterValues.includes(it) ? 'checked' : '';\n        filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n            .on('click.stop', () => this.filterClick(index, it))\n            .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n    });\n}\n\nfunction resetFilterHeader() {\n    const {filterhEl, filterValues, values} = this;\n    filterhEl.html(`${filterValues.length} / ${values.length}`);\n    filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n    constructor() {\n        this.filterbEl = h('div', `${cssPrefix}-body`);\n        this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n        this.tindex = 1;\n        this.el = h('div', `${cssPrefix}-sort-filter`).children(\n            this.sortAscEl = buildSortItem.call(this, 'asc'),\n            this.sortDescEl = buildSortItem.call(this, 'desc'),\n            buildMenu('divider'),\n            h('div', `${cssPrefix}-filter`).children(\n                this.filterhEl,\n                this.filterbEl,\n            ),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', () => this.btnClick('cancel')),\n                new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n            ),\n        ).hide();\n        // this.setFilters(['test1', 'test2', 'text3']);\n        this.el.on('mousedown.stop', evt => {\n            this.tindex = 1;\n        });\n\n        this.ci = null;\n        this.sortDesc = null;\n        this.values = null;\n        this.filterValues = [];\n    }\n\n    btnClick(it) {\n        if (it === 'ok') {\n            const {ci, sort, filterValues} = this;\n            if (this.ok) {\n                this.ok(ci, sort, 'in', filterValues);\n            }\n        }\n        this.hide();\n    }\n\n    itemClick(it) {\n        // console.log('it:', it);\n        this.sort = it;\n        const {sortAscEl, sortDescEl} = this;\n        sortAscEl.checked(it === 'asc');\n        sortDescEl.checked(it === 'desc');\n    }\n\n    filterClick(index, it) {\n        const {filterbEl, filterValues, values} = this;\n        const children = filterbEl.children();\n        if (it === 'all') {\n            if (children.length === filterValues.length) {\n                this.filterValues = [];\n                children.forEach(i => h(i).checked(false));\n            } else {\n                this.filterValues = Array.from(values);\n                children.forEach(i => h(i).checked(true));\n            }\n        } else {\n            const checked = h(children[index]).toggle('checked');\n            // console.log(h(children[index]), \"92\")\n            if (checked) {\n                filterValues.push(it);\n            } else {\n                filterValues.splice(filterValues.findIndex(i => i === it), 1);\n            }\n        }\n\n        resetFilterHeader.call(this);\n    }\n\n    // v: autoFilter\n    // items: {value: cnt}\n    // sort { ci, order }\n    set(ci, items, filter, sort) {\n        this.ci = ci;\n        const {sortAscEl, sortDescEl} = this;\n        if (sort !== null) {\n            this.sort = sort.order;\n            sortAscEl.checked(sort.asc());\n            sortDescEl.checked(sort.desc());\n        } else {\n            this.sortDesc = null;\n            sortAscEl.checked(false);\n            sortDescEl.checked(false);\n        }\n        // this.setFilters(items, filter);\n        this.values = Object.keys(items);\n        this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n        buildFilterBody.call(this, items, filter);\n        resetFilterHeader.call(this);\n    }\n\n    setOffset(v) {\n        if(this.el.isShow()) {\n            this.hide();\n            return;\n        }\n\n        this.el.offset(v).show();\n        let tindex = 1;\n\n\n        console.log(this.el);\n        bindClickoutside(this.el, () => {\n\n            if (tindex === 0) {\n                this.hide();\n            }\n\n            tindex = 0;\n        });\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n        unbindClickoutside(this.el);\n    }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\nexport default {};\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {sheetReset} from './sheet';\n\nexport default class Advice {\n    constructor(data, sheet) {\n        this.el = h('div', `${cssPrefix}-advice`)\n            .children(\n                this.save = h('div', `${cssPrefix}-advice-style`)\n                    .css('border-bottom', '1px solid'),\n                this.text = h('div', `${cssPrefix}-advice-style`),\n            )\n            .hide();\n        this.save.children(\n            this.saveCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('保留样式'),\n        );\n        this.text.children(\n            this.textCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('仅文本'),\n        );\n        this.data = data;\n        this.sheet = sheet;\n        this.old_rows = '';\n        this.new_rows = '';\n        this.left = 0;\n        this.top = 0;\n\n        this.save.on('mousedown.stop', (evt) => {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n            this.sheet.setCellRange(this.reference, this.tableProxy, true);\n            sheetReset.call(this.sheet);\n        });\n\n        this.text.on('mousedown.stop', (evt) => {\n            this.sheet.setCellRange(this.reference, this.tableProxy, false);\n            this.saveCheck.show('visibility', 'hidden');\n            this.textCheck.hide('visibility', 'initial');\n            sheetReset.call(this.sheet);\n        });\n    }\n\n    show(left, top, type = 1, reference, tableProxy ) {\n        this.el.css('left', `${left}px`);\n        this.el.css('top', `${top}px`);\n        if (type == 1) {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n        }\n        this.left = parseInt(left);\n        this.top = parseInt(top);\n        this.tableProxy = tableProxy;\n        this.reference = reference;\n        this.el.show();\n    }\n}\n","import {h} from \"../component/element\";\nimport {cutStr} from \"../core/operator\";\n\nfunction mountCopy(event) {\n    event.preventDefault();\n    let choose = getChooseImg.call(this);\n    if (choose) {\n        if (event.clipboardData) {\n            event.clipboardData.setData(\"text/html\", parseDom(choose.img2));\n            event.clipboardData.setData(\"text/plain\", \"\");\n        }\n        return;\n    }\n\n    let args = sheetCopy.call(this);\n    if (event.clipboardData) {\n        event.clipboardData.setData(\"text/html\", parseDom(args.html.el));\n        event.clipboardData.setData(\"text/plain\", args.plain);\n    }\n}\n\nfunction getChooseImg() {\n    let {pasteDirectionsArr} = this.data;\n\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true) {\n                this.container.css('pointer-events', 'auto');\n                return pasteDirectionsArr[i];\n            }\n        }\n    }\n    return null;\n}\n\nfunction sheetCopy() {\n    let args = {\n        plain: \"\",\n        html: h(\"table\", \"\"),\n    };\n\n    let {selector, rows, styles} = this.data;\n    let {sri, eri, sci, eci} = selector.range;\n    let tbody = h('tbody', '');\n    for (let i = sri; i <= eri; i += 1) {\n        let tr = h('tr', '');\n        for (let j = sci; j <= eci; j += 1) {\n            let td = h('td', '');\n            if (rows._[i] && rows._[i].cells && rows._[i].cells[j]) {\n                if (rows._[i].cells[j] && styles[rows._[i].cells[j].style]) {\n                    td.css('color', styles[rows._[i].cells[j].style].color);\n                    if (styles[rows._[i].cells[j].style]\n                        && styles[rows._[i].cells[j].style].font\n                        && styles[rows._[i].cells[j].style].font.bold) {\n                        let bold = styles[rows._[i].cells[j].style].font.bold ? '900' : '';\n                        td.css('font-weight', bold);\n                    }\n                    td.css('background', styles[rows._[i].cells[j].style].bgcolor);\n                }\n\n                if(!rows._[i].cells[j].text) {\n                    rows._[i].cells[j].text = \"\";\n                }\n                if(!rows._[i].cells[j].formulas) {\n                    rows._[i].cells[j].formulas = \"\";\n                }\n\n                let text = rows._[i].cells[j].formulas != \"\" ? rows._[i].cells[j].formulas : rows._[i].cells[j].text;\n                if(rows._[i].cells[j].formulas && cutStr(rows._[i].cells[j].formulas, false, true).length > 0) {\n                    let hidden = h('reference', '');\n                    hidden.html(text);\n                    hidden.attr('ri', i);\n                    hidden.attr('ci', j);\n                    td.child(hidden.el);\n                } else\n                    td.html(text);\n                args.plain += text;\n                args.plain += \"\\t\";\n            } else {\n                args.plain += \"\\t\";\n            }\n            tr.child(td);\n        }\n\n        tbody.child(tr);\n        args.plain += \"\\n\";\n    }\n    args.html.child(tbody);\n\n    return args;\n}\n\nfunction parseDom(node) {\n    let tmpNode = document.createElement(\"div\");\n    tmpNode.appendChild(node.cloneNode(true));\n    let str = tmpNode.innerHTML;\n\n    return str;\n};\n\nexport {\n    mountCopy,\n    getChooseImg,\n    sheetCopy\n}","import {h} from \"../component/element\";\nimport {cssPrefix, look} from \"../config\";\nimport CellRange from \"../core/cell_range\";\nimport {bind} from \"./event\";\nimport {  isSpecialWebsite} from \"./special_formula_process\";\n\nexport default class Website {\n    constructor(data, editor) {\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n\n        this.tableEl = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n        this.editor = editor;\n        this.tableEl.attr('tabindex', 0);\n        this.tableEl.css('overflow-y', 'auto');\n        this.tableEl.css('max-height', '400px');\n        bind(this.tableEl.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n        this.timer = null;\n        this.timer2 = null;\n    }\n\n    show(ri, ci) {\n        if(this.editor.isDisplay2()) {\n            this.el.hide();\n            this.tableEl.hide();\n\n            return;\n        }\n\n        let {data} = this;\n        let text = data.getCellTextOrDefault(ri, ci) + \"\";\n        clearTimeout(this.timer);\n        clearTimeout(this.timer2);\n\n        if (look.indexOf(text.split(\"!\")[0]) == 0) {\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 50;\n            let arr = JSON.parse(text.substring(text.indexOf(\"!\") + 1, text.length));\n\n            this.tableEl.css('left', `${left}px`);\n            this.tableEl.css('top', `${top}px`);\n            this.tableEl.css('user-select', 'text');\n\n            this.tableEl.html('');\n            let table = h('table', '');\n            table.css('border-spacing', '0px');\n            let tr = h('tr', '');\n            tr.children(\n                h('td', '').css('border', '1px solid black').html('序号'),\n                h('td', '').css('border', '1px solid black').html('项目名称'),\n                h('td', '').css('border', '1px solid black').html('城市'),\n                h('td', '').css('border', '1px solid black').html('占地面积'),\n                h('td', '').css('border', '1px solid black').html('差额')\n            );\n            table.children(\n                tr\n            );\n\n            for (let j = 0; j < arr.length; j++) {\n                let {number, name, city, area, value} = arr[j];\n                let tr = h('tr', '');\n                let td = h('td', '');\n                td.html(number);\n                td.css('border', '1px solid black');\n\n                let td2 = h('td', '');\n                td2.html(name);\n                td2.css('border', '1px solid black');\n\n                let td3 = h('td', '');\n                td3.html(city);\n                td3.css('border', '1px solid black');\n\n                let td4 = h('td', '');\n                td4.html(area);\n                td4.css('border', '1px solid black');\n\n                let td5 = h('td', '');\n                td5.html(value);\n                td5.css('border', '1px solid black');\n                tr.children(\n                    td,\n                    td2,\n                    td3,\n                    td4,\n                    td5\n                );\n                table.children(\n                    tr\n                );\n            }\n\n            this.tableEl.children(\n                table\n            );\n\n            this.timer = setTimeout(() => {\n                this.tableEl.show();\n                this.el.hide();\n            }, 150);\n        } else {\n            let args = isSpecialWebsite(text);\n            if(args.state) {\n                text = args.text;\n            }\n            text = text.substr(0, 3).toLowerCase() == \"www\" ? \"http://\" + text : text;\n            // console.log(regex.test(text))\n            if (text.substr(0, 7).toLowerCase() !== 'http://' &&\n                text.substr(0, 8).toLowerCase() !== 'https://') {\n                this.el.hide();\n                this.tableEl.hide();\n                return;\n            }\n\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 5;\n            this.el.html('');\n            this.el.css('color', 'blue');\n            this.el.children(\n                h('div', 'aaa').css(\"border-bottom\", \"1px solid blue\")\n                    .on('click', evt => {\n                        let iWidth = 650; //弹出窗口的宽度;\n                        let iHeight = 500; //弹出窗口的高度;\n\n                        console.log(evt);\n                        let {screenX, screenY} = evt;\n                        window.open(text, \"\", `width=${iWidth},height=${iHeight},left=${screenX + rect.width},top=${screenY}`);\n                    })\n                    .html(text)\n            );\n            this.el.css('left', `${left}px`);\n            this.el.css('top', `${top}px`);\n\n            this.timer2 = setTimeout(() => {\n                this.el.show();\n                this.tableEl.hide();\n            }, 150);\n        }\n    }\n}","import {look} from \"../config\";\n\nlet v1 = \"HYPERLINK\";\nlet v2 = \"MULTIPLECELLS\";\n\n\nfunction isSpecialWebsite(text) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return {\n            \"state\": true,\n            \"text\": JSON.parse(text.split(\"!\")[1]).url,\n        };\n    }\n    return {\n        \"state\": false,\n        \"text\": \"\",\n    };\n}\n\nfunction indexOf(text, formula) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1 && formula.toUpperCase().indexOf(v1) === -1) {\n        return 2;\n    } else if (look.indexOf(text.split(\"!\")[0]) === 2 && formula.toUpperCase().indexOf(v2) === -1) {\n        return 1;\n    }\n    return 0;\n}\n\nfunction multipleCellsRender(cells, mc) {\n    let tailArr = [];\n    Object.keys(mc).forEach(i => {\n        cells[i] = mc[i];\n        tailArr.push(i);\n    });\n\n    return tailArr;\n}\n\nfunction specialWebsiteValue(text, formula) {\n    let index = indexOf(text, formula);\n\n    // if (index === 1) {\n    //     return {\n    //         \"state\": true,\n    //         \"type\": index,\n    //         \"text\": JSON.parse(text.split(\"!\")[1])\n    //     };\n    // } else\n    if (index === 2) {\n        let arr = text.split(\" \");\n        let s = \"\";\n        if (arr.length >= 1) {\n            text = arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                s += arr[i];\n            }\n        }\n        return {\n            \"state\": true,\n            \"type\": index,\n            \"text\": JSON.parse(text.split(\"!\")[1]).text + s,\n        };\n    }\n    return {\n        \"state\": false,\n        \"type\": index,\n        \"text\": \"\",\n    };\n}\n\nexport {\n    isSpecialWebsite,\n    specialWebsiteValue,\n    multipleCellsRender,\n}","import Modal from \"./modal\";\nimport {h} from \"./element\";\nimport Button from \"./button\";\nimport {t} from \"../locale/locale\";\nimport {cssPrefix} from \"../config\";\n\nexport default class ErrorPopUp extends Modal {\n    constructor() {\n        let tip = h('span', '').html(\"您输入的公式好像至少缺少一个左括号\");\n        super(t('contextmenu.errorPop'), [\n            h('div', `${cssPrefix}-form-fields`).children(\n                tip,\n            ),\n            h('div', `${cssPrefix}-form-fields`),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('ok', 'primary')\n                    .on('click', () => this.btnClick('ok')),\n            ),\n        ]);\n        this.tip = tip;\n    }\n\n    show(t) {\n        this.tip.html(t);\n        super.show();\n    }\n\n    btnClick(action) {\n        if (action === 'ok') {\n            this.hide();\n        }\n    }\n\n}","import {offsetTop} from \"../config\";\nimport {positionAngle} from \"../core/operator\";\n\nexport default class RectProxy {\n    constructor(rect) {\n        this.rect = rect;\n    }\n\n    isLocInside(x, y) {\n        let {rect} = this;\n\n        if (x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height) {\n            return true;\n        }\n        return false;\n    }\n\n    getUpDownLeftRight(ex, ey, clientX, clientY) {\n        let {rect} = this;\n\n        let pos = 0;\n        if (ex < rect.width + rect.left && ex > rect.left) {\n            if (ey > rect.top + rect.height + offsetTop) {\n                pos = 1;\n            } else if (ey - offsetTop < rect.top) {\n                pos = 4;\n            }\n\n        } else if (ey - ( rect.top - rect.height + offsetTop) > 0 && (rect.height + rect.top + offsetTop) > ey) {\n            if (ex > rect.width + rect.left) {\n                pos = 3;\n            } else if (ex < rect.left) {\n                pos = 2;\n            }\n        }\n\n        console.log(pos);\n        if (pos === 0) {\n            pos = positionAngle(clientX, ex, clientY, ey);\n        }\n        if (pos === 1 && ey < 0) {\n            pos = 4;\n        } else if (document.body.clientHeight < ey && pos === 4) {\n            pos = 1;\n        }\n        if (pos === 3 && ex < 0) {\n            pos = 2;\n        } else if (document.body.clientWidth < ex && pos === 2) {\n            pos = 3;\n        }\n\n        return pos;\n    }\n}","export default class Timer {\n    constructor() {\n        this.timer = [];\n    }\n\n    push(t) {\n        this.timer.push(t);\n    }\n\n    clear() {\n        for(let i = 0; i < this.timer.length; i++) {\n            let t = this.timer[i];\n            clearTimeout(t);\n            clearInterval(t);\n        }\n    }\n}","import {deepCopy, distinct} from \"../core/operator\";\nimport {isHave} from '../core/helper';\nimport {expr2xy, xy2expr} from \"../core/alphabet\";\n\nfunction getCellDepend(cells) {\n    let arr = [];\n    for (let i = 0; i < cells.length; i++) {\n        if(isHave(cells[i]) && isHave(cells[i].expr)) {\n            arr.push(cells[i].expr);\n        }\n\n        if (isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.depend)) {\n            arr.push(...cells[i].cell.depend);\n        }\n\n        if(isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.multivalueRefsCell)) {\n            arr.push(cells[i].cell.multivalueRefsCell);\n        }\n    }\n\n    return arr;\n}\n\nexport default class PreAction {\n    constructor({type = -1, action = \"\",  ri = -1, ci = -1, oldData = \"\", newData = \"\", expr = \"\", oldStep = \"\", cellRange = \"\", cells = {}, height = -1, width = -1, oldCell = {}, newCell = {}, newMergesData = \"\", oldMergesData = \"\", property = \"\", value = \"\"}, data) {\n        this.type = type;\n        this.action = action;\n        this.ri = ri;\n        this.ci = ci;\n        this.expr = expr;\n        this.cellRange = cellRange;\n        this.cells = cells;\n        this.height = height;\n        this.width = width;\n        this.oldCell = oldCell;\n        this.newCell = newCell;\n        this.oldMergesData = oldMergesData;\n        this.newMergesData = newMergesData;\n        this.property = property;\n        this.value = value;\n        this.oldStep = oldStep;\n\n        this.oldData = oldData;\n        this.newData = newData;\n        this.data = data;\n    }\n\n    findAllNeedCalcCell() {\n        let changeArr = [];\n        let {oldCell, newCell, ri, ci} = this;\n        changeArr.push(...getCellDepend(oldCell));\n        changeArr.push(...getCellDepend(newCell));\n        if (ri !== -1 && ci !== -1) {\n            changeArr.push(xy2expr(ci, ri));\n        }\n\n        changeArr = distinct(changeArr);\n        return changeArr;\n    }\n\n    restore(data, sheet, isRedo) {\n        let {type} = this;\n\n        if (type === 1) { // shuru\n            let {oldCell, newCell} = this;\n            let _cell = \"\";\n            // redo 1  undo 2\n            if (isRedo === 1) {\n                _cell = deepCopy(oldCell);\n            } else {\n                _cell = deepCopy(newCell);\n            }\n            for (let i = 0; i < _cell.length; i++) {\n                let {cell, ri, ci} = _cell[i];\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n\n        } else if(type === 13) {\n            let {oldData, newData} = this;\n            let _data = \"\";\n            if (isRedo === 1) {\n                _data = deepCopy(newData);\n            } else {\n                _data = deepCopy(oldData);\n            }\n\n            data.setData(_data);\n        } else if (type === 2 || type === 5 || type === 6 || type === 11 || type === 12) {\n            let {newCell, oldCell, oldMergesData, newMergesData, cellRange, property, value} = this;\n            let _cells = \"\";\n            if (isRedo === 1) {\n                _cells = deepCopy(oldCell);\n            } else {\n                _cells = deepCopy(newCell);\n            }\n\n            if (property === 'merge') {\n                if (isRedo === 1) {\n                    this.data.merges.setData(oldMergesData);\n                } else {\n                    this.data.merges.setData(newMergesData);\n                }\n            }\n\n            for (let i = 0; i < _cells.length; i++) {\n                let {cell, ri, ci} = _cells[i];\n\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n        } else if (type === 3) {\n            let {ri, height, oldStep} = this;\n            if (isRedo === 1) {\n                data.rows.setHeight(ri, oldStep.height);\n            } else {\n                data.rows.setHeight(ri, height);\n            }\n        } else if (type === 4) {\n            let {ci, width, oldStep} = this;\n            if (isRedo === 1) {\n                data.cols.setWidth(ci, oldStep.width);\n            } else {\n                data.cols.setWidth(ci, width);\n            }\n\n        }\n    }\n}\n","/* global window */\nimport {h} from './element';\nimport {bind, bindTouch, mouseMoveUp, remove} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix, offsetLeft, offsetTop} from '../config';\nimport {formulas} from '../core/formula';\nimport {getFontSizePxByPt} from \"../core/font\";\n// import {baseFormats, multiply} from \"../core/format\";\nimport Advice from \"../component/advice\";\nimport {clearSelectors, editingSelectors, lockCells, makeSelector} from \"../component/formula_editor\";\nimport {deleteImg, hideDirectionArr, mountPaste} from \"../event/paste\";\nimport {getChooseImg, mountCopy} from \"../event/copy\";\nimport Website from \"../component/website\";\nimport {cutStr, cuttingByPos, deepCopy} from \"../core/operator\";\nimport {moveCell} from \"../event/move\";\nimport CellRange from \"../core/cell_range\";\nimport {isHave, isOusideViewRange} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\nimport ErrorPopUp from \"./error_pop_up\";\nimport RectProxy from \"./rect_proxy\";\nimport {testValid} from \"../utils/test\";\nimport Timer from \"../model/Timer\";\nimport PreAction from \"../model/pre_action\";\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    // console.log(multiple, ', ri:', ri, ', ci:', ci);\n    const {\n        table, selector, toolbar,\n    } = this;\n\n    if (multiple) {\n        selector.setEnd(ri, ci, moving, true);\n    } else {\n        selector.set(ri, ci, indexesUpdated);\n    }\n\n    toolbar.reset();\n\n    // add\n    clearTimeout(this.render_timer);\n\n    this.render_timer = setTimeout(() => {\n        table.render();\n    }, 100);\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data, editor\n    } = this;\n    const {rows, cols} = data;\n    if (editor.isCors) {\n        selector.indexes = [editor.ri, editor.ci];\n    }\n    let [ri, ci] = selector.indexes;\n    const {eri, eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n\n\n    // console.log(\"92\", ri, ci, editor.ri, editor.ci)\n    // if((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n    //     return;\n    // }\n\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        // if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selector.selectCell.setData(ri, ci);\n    selector.selectCell.resetSelectOffset();\n    selectorSet.call(this, multiple, ri, ci);\n    // editor.clear();\n\n    editorSetOffset.call(this);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    if (evt.buttons !== 0) return;\n    if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n    const {offsetX, offsetY} = evt;\n\n    const {\n        rowResizer, colResizer, tableEl, data, website\n    } = this;\n    const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n\n    // moveCell.call(this);\n\n    // url 展开\n    website.show(cRect.ri, cRect.ci);\n    const {rows, cols} = data;\n    if (offsetX > cols.indexWidth && offsetY > rows.height) {\n        rowResizer.hide();\n        colResizer.hide();\n        return;\n    }\n    const tRect = tableEl.box();\n    if (cRect.ri >= 0 && cRect.ci === -1) {\n        cRect.width = cols.indexWidth;\n        rowResizer.show(cRect, {\n            width: tRect.width,\n        });\n    } else {\n        rowResizer.hide();\n    }\n    if (cRect.ri === -1 && cRect.ci >= 0) {\n        cRect.height = rows.height;\n        colResizer.show(cRect, {\n            height: tRect.height,\n        });\n    } else {\n        colResizer.hide();\n    }\n}\n\nfunction overlayerMousescroll(evt) {\n    const {verticalScrollbar, data} = this;\n    const {autoLoad} = data.settings;\n    const {top} = verticalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n    let delta = evt.deltaY;\n    const {rows} = data;\n    if (evt.detail) delta = evt.detail * 40;\n    if (delta > 0 && autoLoad == true) {\n        // up\n        const ri = data.scroll.ri + 1;\n        if (ri < rows.len) {\n            verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n        }\n    } else if (autoLoad == true) {\n        // down\n        const ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    }\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('direction:', direction, ', distance:', distance, left);\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    verticalScrollbar.set(height, data.rows.totalHeight());\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset(state = true) {\n    // debugger\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    renderAutoAdapt.call(this);\n    autoRowResizer.call(this);\n\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    selector.selectCell.toolbarChangeSelectorCell();\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy() {\n    const {data, selector} = this;\n    data.copy();\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    data.cut();\n    selector.showClipboard();\n}\n\nconst a = () => {\n}\n\nfunction paste(what, cb = (p) => {\n    if (p) {\n        clearClipboard.call(this);\n        sheetReset.call(this);\n    }\n}) {\n    const {data} = this;\n    let p = data.paste(what, msg => xtoast('Tip', msg));\n    cb(p);\n\n    return p;\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar, data} = this;\n    if (toolbar.paintformatActive()) {\n        // paste.call(this, 'format');\n        data.paintFormatChange((ri, ci) => {\n            selectorSet.call(this, true, ri, ci, true, true);\n        });\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n        toolbar.reset();\n    }\n}\n\nfunction getPoint(obj) { //获取某元素以浏览器左上角为原点的坐标\n    let t = obj.offsetTop; //获取该元素对应父容器的上边距\n    let l = obj.offsetLeft; //对应父容器的上边距\n    //判断是否有父容器，如果存在则累加其边距\n    while (obj = obj.offsetParent) {//等效 obj = obj.offsetParent;while (obj != undefined)\n        t += obj.offsetTop; //叠加父容器的上边距\n        l += obj.offsetLeft; //叠加父容器的左边距\n    }\n\n    return {\n        t: t,\n        l: l\n    }\n}\n\nfunction dropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, pos = 0, offset, horizontalScrollbar, cols) {\n    this.selector.setBoxinner(\"none\");\n    this.container.css('pointer-events', 'none');\n    let dstRect = data.getCellRectByXYWithNotTotalResult(e.layerX || e.clientX, e.layerY || e.clientY);\n    let {ri, ci} = dstRect;\n\n    if (isAutofillEl) {\n        let {rpos, ey, ex,} = dropGetPos.call(this, data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos);\n\n        let orien = selector.showAutofill(ri, ci, rpos);\n        if (isOusideViewRange(this.data.settings.view.height(), this.data.settings.view.width(), ey, ex, orien)) {\n            // if (Math.round(Math.random()) === 1) {\n            continueMove.call(this, orien, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n            // }\n        }\n\n    } else if (e.buttons === 1 && !e.shiftKey) {\n        ri = ri <= 0 ? 0 : ri;\n        ci = ci <= 0 ? 0 : ci;\n        let cell = data.viewRange();\n        let pos = cell.getMovePos(ri, ci);\n\n        selectorBeyondMove.call(this, pos, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n\n        console.log(\"ri: \", ri, \"ci: \", ci);\n        selectorSet.call(this, true, ri, ci, true, true);\n    }\n}\n\n\nfunction dropGetPos(data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos) {\n    let rect = data.getRect(selector.range);\n    let rectProxy = new RectProxy(rect);\n    let clientX = rect.width + rect.left;\n    let clientY = rect.height + rect.top + offsetTop;\n    let ex = e.clientX - offset.l - offsetLeft;\n    let ey = e.clientY;\n\n    if (rectProxy.isLocInside(ex, ey)) {\n        pos = -1;\n        selector.arange = null;\n    } else {\n        pos = rectProxy.getUpDownLeftRight(ex, ey, clientX, clientY)\n    }\n\n    return {\n        rpos: pos,\n        ex,\n        ey\n    };\n}\n\nfunction selectorBeyondMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    if (orien === 2) {   //往下\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 6) {    // 往上\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 3) {        //往右\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 5) {    // 往左\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 1) { // 往下往右\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 7) {         // 往下往左\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 8) {     // 往上往右\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 4) {       // 往上往左\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    }\n}\n\nfunction scrollTo(orien, verticalScrollbar, horizontalScrollbar, rows, data, cols) {\n    if (Math.round(Math.random()) !== 1) {\n        return;\n    }\n    // 1 下 2 上 3左 4 右\n    let ri = 0, ci = 0;\n    if (orien === 1) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 2) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n\n        verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n    } else if (orien === 4) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 3) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\nfunction continueMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    let ri = 0, ci = 0;\n    if (orien === 44) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 22) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    } else if (orien === 33 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 11 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data, table, sortFilter, editor, advice\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = isHave(evt.corner) ? true : evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    editor.setRiCi(ri, ci);\n\n    // sort or filter\n    const {autoFilter} = data;\n\n    // trait add\n    hideDirectionArr.call(this);\n    advice.el.hide();\n\n    if (autoFilter.includes2(ri, ci)) {\n        autoFilter.getSet(data.exceptRowSet, ri);\n    }\n\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n\n        // let {pageX, pageY} = evt;\n        let {verticalScrollbar, horizontalScrollbar} = this;\n        const {rows, cols} = data;\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri + 1;\n        let ttop = top + rows.getHeight(ri) - 1;\n\n        let point = getPoint(this.el.el);\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            console.log(\"dropdown\")\n            clearStopTimer.call(this);\n\n            continueDropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols);\n\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols);\n        }, (e) => {\n            clearStopTimer.call(this);\n\n            if (isAutofillEl) {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    testValid.call(this);\n                    autofillNext.call(this);\n                }\n            }\n            this.selector.setBoxinner(\"auto\");\n\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n            this.container.css('pointer-events', 'auto');\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction continueDropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols) {\n    let stopTimer = setTimeout(() => {\n        let stopTimer2 = setInterval(() => {\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols,);\n        }, 50);\n        this.stopTimer2.push(stopTimer2);\n    }, 200);\n\n    this.stopTimer.push(stopTimer);\n}\n\nfunction clearStopTimer() {\n    this.stopTimer.clear();\n    this.stopTimer2.clear();\n}\n\nfunction autofillNext() {\n    const {\n        data, table, editor\n    } = this;\n    editor.display = true;\n    let enter = false;\n    // this.selector.arange.each((ri, ci) => {\n    //     // let cell = data.rows.getCell(ri, ci);\n    //     // if (cell && cell.formulas) {\n    //     //     let enter2 = this.editorProxy.change(ri, ci, cell.formulas, data.rows, data, true);\n    //     //     if (enter2 === true) {\n    //     //         enter = true;\n    //     //     }\n    //     // }\n    // });\n    if (enter) {\n        data.change(data.getData());\n    }\n    this.selector.arange = null;\n    loadFormula.call(this);\n    table.render();\n}\n\nfunction loadFormula(load = false) {\n    // this.table.proxy.diff = 305;\n    // this.table.proxy.oldData = \"\";\n    // sheetReset.call(this);\n    // clearTimeout(this.formulaTime);\n    // let {data, table} = this;\n    // this.formulaTime = setTimeout(() => {\n    //     let {date_formula} = data.settings;\n    //     if (date_formula && typeof date_formula.wland == \"function\") {\n    //         date_formula.wland(date_formula, data, table, load);\n    //     }\n    // }, 1500);\n}\n\nfunction firstRowToWidth(width) {\n    let cRect = {ri: -1, ci: 0, left: 60, top: 0, width: 100}\n    colResizerFinished.call(this, cRect, width);\n}\n\nfunction adviceSetOffset() {\n    const {data} = this;\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n\n    this.advice.el.el.style['top'] = `${top}px`;\n    this.advice.el.el.style['left'] = `${ left}px`;\n}\n\nfunction pictureSetOffset() {\n    const {data} = this;\n    let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n\n    this.data.pasteDirectionsArr.forEach(i => {\n        const sOffset = data.getMoveRect(i.range);\n\n        i.img.el.style['top'] = `${sOffset.top + pictureOffsetTop + i.number * 15 + i.offsetTop }px`;\n        i.img.el.style['left'] = `${sOffset.left + pictureOffsetLeft + i.number * 15 + i.offsetLeft}px`;\n    });\n}\n\n\nfunction editorSetOffset(show = true, cri = -1, cci = -1) {\n    const {\n        selector, data, editor\n    } = this;\n    let [ri, ci] = selector.indexes;\n    ri = cri == -1 ? ri : cri;\n    ci = cci == -1 ? ci : cci;\n\n    const sOffset = data.getMoveRect(new CellRange(ri, ci, selector.range.eri, selector.range.eci));\n    const tOffset = this.getTableOffset();\n\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n\n    editor.setOffset(sOffset, sPosition, show);\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction selectorsSetOffset() {\n    for (let i = 0; i < this.selectors.length; i++) {\n        let selector = this.selectors[i];\n        selector.selector.resetSelectorBRLAreaOffset(new CellRange(selector.ri, selector.ci, selector.ri, selector.ci));\n    }\n}\n\nfunction hasEditor(showEditor = true) {\n    let {selector} = this\n    if (showEditor === true) {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selectorMoveEl.el,\n                this.selector.el,\n            );\n    } else {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                // this.editor.el,\n                // this.selector.el,\n                this.selectorMoveEl.el\n            );\n    }\n}\n\nfunction editorSet(type = 1) {\n    const {editor, data, selector} = this;\n    editorSetOffset.call(this);\n    editor.setCellEnd(data.getSelectedCell());\n    // editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), type);\n    if (this.data.settings.showEditor) {\n        selector.el.hide();\n    }\n    clearClipboard.call(this);\n\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrolly(distance, () => {\n        editor.display = false;\n        selector.resetBRLAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrollx(distance, () => {\n        editor.display = false;\n        selector.resetBRTAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction renderAutoAdapt() {\n    let {data, table} = this;\n    const viewRange = data.viewRange2();\n    let {autoAdapt} = data.settings.style;\n    let {ignoreRi} = data.settings;\n    let viewWidth = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            let txt = table.getCellTextContent(ri, ci);\n            const dbox = table.getDrawBox(ri, ci);\n\n            if (txt != undefined) {\n                const style = table.getCellTextStyle(ri, ci);\n                const font = Object.assign({}, style.font);\n                font.size = getFontSizePxByPt(font.size);\n                // 得到当前文字最宽的width\n                let txtWidth = null;\n                if (style.format != undefined) {\n                    // txtWidth = table.draw.selfAdaptionTxtWidth(formatm[style.format].render(txt), font, dbox);\n\n                } else {\n                    txtWidth = table.draw.selfAdaptionTxtWidth(txt, font, dbox);\n                }\n                if ((table.autoAdaptList[ci] == undefined || table.autoAdaptList[ci] < txtWidth) && ri > ignoreRi - 1) {\n                    table.autoAdaptList[ci] = txtWidth;\n                }\n            }\n        });\n        if (table.autoAdaptList.length < 0) {\n            return;\n        }\n        let {ignore} = data.settings;\n        for (let i = 0; i < table.autoAdaptList.length; i++) {\n            let _ignore = false;\n            for (let j = 0; j < ignore.length; j++) {\n                if (i == ignore[j]) _ignore = true;\n            }\n            if (_ignore == false) {\n                if (table.autoAdaptList[i] == undefined) {\n                    viewWidth += 50;\n                    data.cols.setWidth(i, 50);\n                } else {\n                    if (table.autoAdaptList[i] < 30) {\n                        table.autoAdaptList[i] = 30;\n                    }\n                    data.cols.setWidth(i, table.autoAdaptList[i]);\n                }\n            }\n            viewWidth += table.autoAdaptList[i];\n\n        }\n        if (viewWidth > 0)\n            data.settings.cellWidth = () => viewWidth;\n    }\n}\n\nfunction autoRowResizer() {\n    let {data, table} = this;\n    let viewRange = data.viewRange2();\n    let record_rc = 0, max = 0;\n    let r_h = data.settings.row.height;\n    let {autoAdapt} = data.settings.style;\n    let viewHeight = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            const txt = table.getCellTextContent(record_rc, ci);\n            const style = table.getCellTextStyle(ri, ci);\n            const font = Object.assign({}, style.font);\n            font.size = getFontSizePxByPt(font.size);\n            const dbox = table.getDrawBox(record_rc, ci);\n            // 1. 自适应调整一行的高度\n            // 2. 进入下一行 得到 本行的max\n            if (record_rc != ri && txt != undefined) {\n                let record_h = data.rows.getHeight(record_rc);\n                if (r_h * max != record_h) {\n                    let c_h = font.size * max + dbox.padding * 2 + 2 * max;\n                    // console.log(\"451\", view.height(r_h * max));\n                    data.rows.setHeight(record_rc, c_h);\n                    viewHeight += c_h;\n                } else {\n                    viewHeight += record_h;\n                }\n                max = 0;\n            } else if (txt != undefined && record_rc == ri) {\n                if (txt != undefined) {\n                    const n = table.draw.selfAdaptionHeight(dbox, txt, font);\n                    if (n > max || max == 0) {\n                        max = n;\n                    }\n                }\n            }\n            record_rc = ri;\n        });\n        let record_h = data.rows.getHeight(record_rc);\n        const style = table.getCellTextStyle(record_h, 0);\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        const dbox = table.getDrawBox(record_rc, 0);\n        if (r_h * max != record_h && viewHeight > 0) {\n            let c_h = font.size * max + dbox.padding * 2;\n            viewHeight += c_h;\n            data.rows.setHeight(record_rc, c_h);\n        } else if (viewHeight > 0) {\n            viewHeight += record_h;\n        }\n    }\n    console.log(503, viewHeight)\n    if (viewHeight > 0)\n        data.settings.view.height = () => viewHeight + 40;\n}\n\nfunction clickSelectorChangeRiCi(evt) {\n    const overlayer = evt.target.className === `${cssPrefix}-overlayer` ? true : false;\n    if (!overlayer) {\n        return;\n    }\n\n    let {selector, data} = this;\n\n    const {offsetX, offsetY} = evt;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n\n    selector.selectCell.setData(cellRect.ri, cellRect.ci);\n    selector.selectCell.resetSelectOffset();\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setRowHeight(ri, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setColWidth(ci, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    // console.log('data:', data);\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction errorPop(enter, msg) {\n    const {errorPopUp} = this;\n\n    if (enter && !errorPopUp.open) {\n        errorPopUp.show(msg);\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else if (errorPopUp.open) {\n        errorPopUp.hide();\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    }\n    return {\n        \"state\": false,\n        \"msg\": msg\n    };\n}\n\nexport function selectorCellText(ri, ci, {text, style}, state, proxy = \"\") {\n    const {data, editor,} = this;\n    let args = data.selectorCellText(ri, ci, text + \"\", state);\n    if (args.state) {\n        args = errorPop.call(this, true, args.msg);\n        if (args.state) {\n            return true;\n        }\n    }\n\n    data.setCellText(ri, ci, {text, style});\n    editor.setRiCi(-1, -1);\n\n    return false;\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table, editor} = this;\n    // const [ri, ci] = selector.indexes;\n    let {ri, ci} = data.selector;\n    if ((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n        return;\n    }\n\n    data.setSelectedCellText(text, state);\n    if (state === 'finished') table.render();\n}\n\nfunction throwFormula() {\n    const {data} = this;\n    data.throwFormula();\n    // sheetReset.call(this);\n}\n\nexport function insertDeleteRowColumn(type) {\n    const {data} = this;\n    if (type === 'insert-row') {\n        data.insert('row');\n    } else if (type === 'delete-row') {\n        data.delete('row');\n    } else if (type === 'insert-column') {\n        data.insert('column');\n    } else if (type === 'delete-column') {\n        data.delete('column');\n    } else if (type === 'delete-cell') {\n        data.deleteCell();\n    } else if (type === 'delete-cell-format') {\n        data.deleteCell('format');\n    } else if (type === 'delete-cell-text') {\n        data.deleteCell('text');\n    }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'undoList') {\n        value.setContent(data.historyList(1));\n    } else if (type === 'redoList') {\n        value.setContent(data.historyList(2));\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        // print\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'throwFormula') {\n        throwFormula.call(this);\n    } else if (type === 'close') {\n        let {mri, mci} = data.getMax();\n\n        data.changeDataForCalc = new PreAction({\n            type: 999,\n            action: \"重新计算\", ri: -1, ci: -1, oldCell: {}, newCell: data.rows.eachRange(new CellRange(0, 0, mri, mci))\n        }, this.data);\n        sheetReset.call(this);\n        // loadFormula.call(this, true);\n    } else if (type === 'freeze') {\n        let {showFreeze} = data.settings;\n        if (value && showFreeze === true) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else if (type === 'add') {\n        data.showEquation = !data.showEquation;\n        sheetReset.call(this, true);\n    } else {\n        //format percent 473\n        data.setSelectedCellAttr(type, value);\n        if (type === 'border') {\n            borderResSet.call(this, 'none');\n        }\n        if (type === 'formula') {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction borderResSet(value = \"1px solid rgb(75, 137, 255\") {\n    this.selector.br.border(value);\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction afterSelector(editor) {\n    if (editor.getLock() || editor.state === 2) {\n        let {ri, ci} = editor;\n        let inputText = editor.editorText.getText();\n        let {selector} = this;\n        selector.indexes = [ri, ci];\n        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input', this.table.proxy);\n        return error;\n    }\n    return false;\n}\n\nfunction pasteEvent(evt) {\n    clearClipboard.call(this);\n    mountPaste.call(this, evt, () => {\n        sheetReset.call(this);\n        let {data} = this;\n        data.change(data.getData());\n    });\n}\n\nfunction sheetInitEvents() {\n    const {\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n        table,\n        contextMenu,\n        data,\n        toolbar,\n        modalValidation,\n        pasteOverlay,\n        sortFilter,\n    } = this;\n\n    // pasteOverlay.on('mousedown', evt => {\n    //   console.log(\"669\");\n    //   pasteOverlay.hide();\n    // });\n\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            // renderAutoAdapt.call(this);\n            // autoRowResizer.call(this);\n            // the left mouse button: mousedown → mouseup → click\n            // the right mouse button: mousedown → contenxtmenu → mouseup\n            if (evt.buttons === 2) {\n                if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                    evt.stopPropagation();\n                } else {\n                    contextMenu.hide();\n                    overlayerMousedown.call(this, evt);\n                    setTimeout(() => {\n                        contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                        evt.stopPropagation();\n                    }, 100);\n                }\n                clickSelectorChangeRiCi.call(this, evt);\n            } else if (evt.detail === 2) {\n                clearTimeout(this.render_timer);\n                editor.setMouseDownIndex([]);\n\n                if (editor.getLock()) {\n                    return;\n                }\n                editorSet.call(this, 2);\n            } else {\n                if (editor.getLock() || editor.isCors) {\n                    let _selector = null;\n                    let change = 0;\n                    mouseMoveUp(window, (e) => {\n                        this.container.css('pointer-events', 'none');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"none\");\n                        }\n\n                        let enter = true;\n                        let {merges} = data;\n                        // let {inputText} = editor;\n                        let inputText = editor.editorText.getText();\n                        let it = inputText;\n\n                        Object.keys(merges._).forEach(i => {\n                            let m = merges._[i];\n                            const cut = cutStr(it, true);\n                            for (let i = 0; i < cut.length; i++) {\n                                if (cut[i].indexOf(\":\") != -1) {\n                                    let a1 = cut[i].split(\":\")[0];\n                                    let a2 = cut[i].split(\":\")[1];\n                                    let e1 = expr2xy(a1);\n                                    let e2 = expr2xy(a2);\n\n                                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                                        enter = false;\n                                    }\n                                }\n                            }\n                        });\n\n                        if (enter) {\n                            if (e.buttons === 1 && !e.shiftKey) {\n                                let {ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY);\n                                if (_selector && _selector.selector) {\n                                    _selector = makeSelector.call(this, ri, ci, this.selectors, true, _selector.selector, true);\n                                    lockCells.call(this, evt, _selector);\n                                    this.mergeSelector = true;\n                                } else {\n                                    let {pos} = editor;\n                                    let inputText = editor.editorText.getText();\n                                    for (let i = 0; i < this.selectors.length; i++) {\n                                        let selector = this.selectors[i];\n                                        let {erpx} = selector;\n\n                                        if (erpx === cuttingByPos(inputText, pos)) {\n                                            _selector = selector;\n                                            change = 1;\n                                            _selector.selector.set(ri, ci, true);\n                                            break;\n                                        }\n                                    }\n\n                                    _selector = _selector ? _selector : makeSelector.call(this, ri, ci, this.selectors, true, null, false);\n                                }\n                            }\n                        }\n                    }, () => {\n                        this.container.css('pointer-events', 'auto');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"auto\");\n                        }\n\n                        if (this.mergeSelector === false) {\n                            if (_selector && !change) {\n                                this.selectors.push(_selector);\n                            }\n                            lockCells.call(this, evt, _selector);\n                        } else if (_selector && !change && _selector.selector) {\n                            this.selectors.push(_selector);\n                        }\n                        if (_selector) {\n                            for (let i = 0; i < this.selectors.length; i++) {\n                                let selector = this.selectors[i];\n\n                                if (selector.className === _selector.className) {\n                                    selector.erpx = _selector.erpx;\n                                    break;\n                                }\n                            }\n                        }\n                        _selector = null;\n                        change = 0;\n                        this.mergeSelector = false;\n                    });\n                }\n\n                console.time(\"dbclick time1\");\n\n                if (!editor.getLock() && !editor.isCors) {\n                    console.time(\"dbclick time2\");\n\n                    let {ri, ci} = editor;\n                    let inputText = editor.editorText.getText();\n                    if (ri !== -1 && ci !== -1 && inputText[0] === \"=\") {\n                        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input', this.table.proxy);\n\n                        if (error) {\n                            return;\n                        }\n                    }\n                    console.timeEnd(\"dbclick time2\");\n\n                    let state = editor.clear();\n\n                    if (state) {\n\n                        let cell = data.rows.getCell(ri, ci);\n                        // if (cell && cell.formulas) {\n                        //     this.editorProxy.change(ri, ci, cell.formulas, data.rows, data);\n                        // }\n                        loadFormula.call(this);\n\n                    }\n\n\n                    this.selector.longTimeBefore();\n                    overlayerMousedown.call(this, evt);\n                    clickSelectorChangeRiCi.call(this, evt);\n                    borderResSet.call(this);\n                    clearSelectors.call(this);\n                    editorSetOffset.call(this);\n                }\n                testValid.call(this);\n                console.timeEnd(\"dbclick time1\");\n\n            }\n        }).on('mousewheel.stop', (evt) => {\n        overlayerMousescroll.call(this, evt);\n    });\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        }\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        if (state === 'finish') { //  用户输入\n            data.editorChangeToHistory(editor.editorText.getOldCell(), editor.editorText.getRICI(), 1);\n            editor.editorText.setOldCell({}, {ri: -1, ci: -1});\n            return;\n        }\n\n        // 如果是 esc\n        if (itext == \"@~esc\") {\n            let {text, formulas} = editor.editorText.getOldCell();\n            editor.editorText.setOldCell({\n                text: '',\n                formulas: '',\n            });\n            let {ri, ci} = editor;\n            data.setSelectedCell(text, 'input', formulas, ri, ci);\n            editor.setText(\"\");\n            clearSelectors.call(this);\n            editor.clear(true);\n            // editor.setRiCi(-1, -1);\n            return;\n        }\n\n        if (state == \"format\") {\n            data.setSelectedCellAttr(state, \"rmb\");\n            // return;\n        }\n        // let {selector} = this;\n        // selector.el.hide();\n        //实时更新this.selectors\n        let {lock} = editor;\n        editor.setMouseDownIndex(data.rows, []);\n        editingSelectors.call(this, itext);\n\n        if (lock && itext != '=') {\n            return;\n        }\n\n        // if (this.selectors.length > 0) {\n        //     return;\n        // }\n\n        if (state == \"format\") {\n            return;\n        }\n\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            data.addValidation(...args);\n        } else {\n            data.removeValidation();\n        }\n    };\n    // contextmenu\n    contextMenu.itemClick = (type, evt) => {\n        // console.log('type:', type);\n        if (type === 'validation') {\n            modalValidation.setValue(data.getSelectedValidation());\n        } else if (type === 'copy') {\n            copy.call(this);\n        } else if (type === 'cut') {\n            cut.call(this);\n        } else if (type === 'paste') {\n            // paste.call(this, 'all');\n            // process.call(this, document.execCommand(\"sheetCopy\"));\n            // createEvent(1, false, \"paste\");\n            // console.log(  document.execCommand(\"paste\"));\n        } else if (type === 'paste-value') {\n            paste.call(this, 'text');\n        } else if (type === 'paste-format') {\n            paste.call(this, 'format');\n        } else {\n            insertDeleteRowColumn.call(this, type);\n        }\n    };\n\n\n    // let windows = this.el.el;\n    bind(window, 'resize', () => {\n        this.reload();\n    });\n\n    bind(window, 'click', (evt) => {\n        this.focusing = overlayerEl.contains(evt.target);\n    });\n\n    bind(window, 'copy', (evt) => {\n        mountCopy.call(this, evt);\n        // data.history.add(data.getData());\n    });\n\n    bind(window, 'cut', (evt) => {\n        console.log(\"cut\", evt);\n        cut.call(this);\n        mountCopy.call(this, evt);\n        let {data} = this;\n        data.history.add(data.getData());\n    });\n\n    bind(window, 'paste', (evt) => {\n        pasteEvent.call(this, evt);\n    });\n\n    // for selector\n    bind(window, 'keydown', evt => {\n        // if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key, ctrlKey, shiftKey, altKey, metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (getChooseImg.call(this)) {\n            console.log(keyCode);\n            switch (keyCode) {\n                case 8:         // delete\n                    data.history.addPic(data.getData().pictures, \"add\");\n                    deleteImg.call(this);\n                    break;\n                // case 90:         // delete\n                //     data.history.addPic(data.getData().pictures, \"add\");\n                //     deleteImg.call(this);\n                //     break;\n            }\n\n            if (ctrlKey || metaKey) {\n                if (90 === keyCode) {\n                    this.undo();\n                    evt.preventDefault();\n                }\n            }\n        } else if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            let what = 'all';\n            if (shiftKey) what = 'text';\n            if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    //  加上这里是因为 需要展示虚线\n                    if (getChooseImg.call(this))\n                        return;\n                    copy.call(this);\n                    // table.render();\n                    // sheetReset.call(this);\n                    evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // paste.call(this, what, () => {\n                    //     console.log(\"837\")\n                    // });\n                    break;\n                case 37:\n                    // ctrl + left\n\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('font-bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('font-italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error = afterSelector.call(this, editor);\n                    if (error) {\n                        return;\n                    }\n\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 13: // enter\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error2 = afterSelector.call(this, editor);\n                    if (error2) {\n                        return;\n                    }\n                    editor.clear();\n                    renderAutoAdapt.call(this);\n                    autoRowResizer.call(this);\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    loadFormula.call(this);\n\n                    evt.preventDefault();\n                    editorSetOffset.call(this, true);\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    // evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                // dataSetCellText.call(this, evt.key, 'input');\n                // editorSet.call(this);\n                // editor.inputEventHandler();\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    });\n}\n\nexport {\n    sheetReset,\n    selectorSet,\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        const {view, showToolbar, showContextmenu, showEditor, rowWidth} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n\n        targetEl.children(this.toolbar.el, this.el);\n        this.pictureOffsetLeft = 10;\n        this.pictureOffsetTop = 10;\n\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n            data.cols.width,\n            data,\n            this,\n        );\n        this.stopTimer = new Timer();\n        this.stopTimer2 = new Timer();\n        this.website = new Website(data, this.editor);\n\n        // data validation\n        this.modalValidation = new ModalValidation();\n        this.errorPopUp = new ErrorPopUp();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);\n        // selector\n        this.selector = new Selector(data, this, true);\n        this.selectorMoveEl = new Selector(data, this, false);\n        // this.editorProxy = new EditorProxy();\n\n        this.advice = new Advice(data, this);\n        // this.pasteDirectionsArr = [];\n        // this.pasteOverlay = h('div', `${cssPrefix}-paste-overlay-container`).hide();\n\n        this.overlayerCEl = hasEditor.call(this, showEditor);\n        this.selectors = [];\n        this.container = h('div', '');\n        this.selectorsEl = h('div', `selector_clear`).attr(\"id\", \"selector_clear\");\n\n        // 把图片容器移到了 overlayerCEl 下面，原因是 如果在 overlayerEl下面 会遮挡表头\n        this.overlayerCEl.children(this.selectorsEl, this.container);\n\n        this.mergeSelector = false;\n\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        this.direction = false;   // 图片移动\n\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.rowResizer.el,\n            this.overlayerEl.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.errorPopUp.el,\n            this.sortFilter.el,\n            this.advice.el,\n            this.website.el,\n            this.website.tableEl,\n            // this.pasteOverlay.el,\n        );\n\n        // table\n        this.table = new Table(this.tableEl.el, data, this.editor);\n        sheetInitEvents.call(this);\n        sheetReset.call(this, false);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n\n        if (rowWidth && rowWidth.state) {\n            firstRowToWidth.call(this, rowWidth.width)\n        }\n    }\n\n    selectorMoveReset() {\n        editorSetOffset.call(this);\n        this.editor.setRiCi(this.data.selector.ri, this.data.selector.ci)\n        sheetReset.call(this);\n    }\n\n    getTable() {\n        let {table} = this;\n        return {\n            recalc: false,\n            table: table\n        }\n    }\n\n    clickCopyPaste() {\n        let {data} = this;\n        let args = data.clickCopyPaste();\n        if (args.enter) {\n            this.selector.arange = args.dstCellRange;\n            data.clickAutofill(args.srcCellRange, args.dstCellRange, \"all\", msg => xtoast('Tip', msg));\n            autofillNext.call(this);\n        }\n    }\n\n    setCellRange(reference, tableProxy, styleBool, cellRange) {\n        let {table, data} = this;\n        data.paste(cellRange);\n        for (let i = 0; i < reference.length; i++) {\n            let {ri, ci} = reference[i];\n            let cell = deepCopy(tableProxy.rows.getCellOrNew(ri, ci));\n            if (styleBool === false) {\n                delete cell['style'];\n            }\n            selectorCellText.call(this, ri, ci, cell, 'style', table.proxy);\n            selectorSet.call(this, true, ri, ci, true, true);\n        }\n    }\n\n    selectorEditorReset(ri, ci) {\n        let {selector} = this;\n        editorSetOffset.call(this, true, ri, ci);\n        this.editor.setRiCi(ri, ci);\n        selector.hide();\n        sheetReset.call(this);\n    }\n\n    loadData(data) {\n        this.data.setData(data, this);\n        // 把所有后端计算的公式过滤出来\n        // this.editorProxy.associatedArr(this.data.rows);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo(this);\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    removeEvent() {\n        remove.call(this);\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n}\n\n","function Drag(options, self) {\n\n    /**\n     *\n     * @param el 节点\n     */\n    this.register = function (el) {\n        el.addEventListener('mousedown', function (e) {\n            if (e.button != 0) {\n                //屏蔽左键以外的按键\n                return;\n            }\n\n\n            //获取x坐标和y坐标\n            var x = e.clientX;\n            var y = e.clientY;\n\n            //获取左部和顶部的偏移量\n            var l = el.offsetLeft;\n            var t = el.offsetTop;\n\n            if (options && options.onBegin) {\n                options.onBegin.call(el, {\n                    left: x - l,\n                    top: y - t\n                });\n            }\n\n\n            //开关打开\n            var isDown = true;\n            //设置样式\n            el.style.cursor = 'move';\n\n            var nl = x, nt = y;\n\n\n            window.onmousemove = function (e) {\n                if (!isDown) {\n                    return;\n                }\n                //获取x和y\n                var nx = e.clientX;\n                var ny = e.clientY;\n\n\n                //计算移动后的左偏移量和顶部的偏移量\n                nl = nx - (x - l);\n                nt = ny - (y - t);\n\n                // console.log( nl, nt);\n\n                let drag = false;\n                if (nl > 0) {\n                    drag = false;\n                    el.style.left = nl + 'px';\n                } else {\n                    drag = true;\n                    el.style.left = 0 + 'px';\n                }\n                if (nt > 0) {\n                    drag = false;\n                    el.style.top = nt + 'px';\n                } else {\n                    drag = true;\n                    el.style.top = 0 + 'px';\n                }\n                // el.style.left = nl + 'px';\n                // el.style.top = nt + 'px';\n\n\n                if (options && options.onDrag) {\n                    options.onDrag.call(el, {\n                        left: nl,\n                        top: nt,\n                        x: nx - x,\n                        y: ny - y,\n                        isDown: isDown\n                    });\n                }\n\n                return false;\n            };\n\n            window.onmouseup = function (e) {\n                //开关关闭\n                isDown = false;\n                el.style.cursor = 'default';\n\n                if (options && options.onEnd) {\n                    options.onEnd.call(el, {left: parseInt(el.style.left), top: parseInt(el.style.top)}, self);\n                }\n\n                return false;\n            };\n            // e.stopPropagation();\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            } else if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                window.event.returnValue == false;\n            }\n        });\n    }\n}\n\nexport default Drag;","function Resize(options, self) {\n\n    this.register = function (el) {\n        var directionsArr = [];\n        var directions = ['nw', 'w', 'ws', 's', 'se', 'e', 'ne', 'n'];\n        //增加元素\n        directions.forEach(str => {\n            //direction ws\n\n            var div = document.createElement('div');\n            div.style.display = \"block\";\n            div.className = 'direction ' + str;\n            //注册事件\n\n            directionsArr.push(div);\n            el.appendChild(div);\n        });\n\n        for(let i = 0; i < 4; i++) {\n            var line = document.createElement('div');\n            line.style.display = \"block\";\n            line.className = `line${i+1}`;\n            el.appendChild(line);\n            directionsArr.push(line);\n        }\n\n\n        var border = document.createElement('div');\n        border.className = 'border';\n        el.appendChild(border);\n\n\n        //注册事件\n\n        directions.forEach(str => {\n            var isDown = false;\n            var obj = el.querySelector(\".\" + str);\n            obj.onmousedown = function (e) {\n\n                if (e.button != 0) {\n                    return;\n                }\n\n                var ox = e.clientX;\n                var oy = e.clientY;\n\n                var data = {\n                    ox: ox,\n                    oy: oy,\n                    ow: el.offsetWidth,\n                    oh: el.offsetHeight,\n                    ol: el.offsetLeft,\n                    ot: el.offsetTop\n\n                };\n\n                if (options && options.onBegin) {\n                    options.onBegin.call(el,data)\n                }\n\n                var isResize = true;\n                window.onmousemove = function (event) {\n                    if (!isResize) {\n                        return;\n                    }\n                    var x = event.clientX;\n                    var y = event.clientY;\n\n                    //计算 width和height 差值\n\n                    var width = x - data.ox;\n                    var height = y - data.oy;\n\n\n                    data.width = width;\n                    data.height = height;\n\n                    var fun = mappers[str];\n                    if (fun) {\n                        fun.call(obj, data, event);\n                    }\n\n                    event.stopPropagation();\n                }\n                window.onmouseup = function (ee) {\n                    isResize = false;\n                    ee.stopPropagation()\n\n                    if (options && options.onEnd) {\n                        options.onEnd.call(el)\n                    }\n                };\n\n                //阻止事件冒泡\n                e.stopPropagation()\n            }\n\n        });\n\n\n        if (!options) {\n            options = {\n                onResize: function () {\n\n                }\n            }\n        } else if (!options.onResize) {\n            options.onResize = function () {\n\n            }\n        }\n\n        function setLeft(l) {\n            options.onResize({left: l}, self);\n            el.style.left = l + 'px';\n        }\n\n        function setTop(t) {\n            options.onResize({top: t}, self);\n            el.style.top = t + 'px';\n        }\n\n        function setWidth(w) {\n            if (w < 20) {\n                w = 20;\n            }\n            options.onResize({width: w}, self);\n            el.style.width = w + 'px';\n        }\n\n        function setHeight(h) {\n\n            if (h < 20) {\n                h = 20;\n            }\n            options.onResize({height: h}, self);\n            el.style.height = h + 'px';\n        }\n\n        var mappers = {\n            s: function (data) {\n                setHeight(data.oh + data.height);\n            },\n            e: function (data) {\n                setWidth(data.ow + data.width)\n            },\n            w: function (data) {\n                var value = data.width;\n\n\n                var l = data.ol + value;\n                var w = data.ow + Math.abs(value);\n\n                if (value > 0) {\n                    w = data.ow - value;\n                }\n\n                if (w > 20) {\n                    setLeft(l);\n                    setWidth(w);\n                }\n            },\n            n: function (data) {\n                var value = data.height;\n\n                var t = data.ot + value;\n                var h = data.oh + Math.abs(value);\n\n                if (value > 0) {\n                    h = data.oh - value;\n                }\n                if (h > 20) {\n                    setHeight(h);\n                    setTop(t);\n                }\n            },\n            se: function (data) {\n                mappers.s(data);\n                mappers.e(data);\n            },\n            nw: function (data) {\n                mappers.n(data);\n                mappers.w(data);\n            },\n            ws: function (data) {\n                mappers.w(data);\n                mappers.s(data);\n            },\n            ne: function (data) {\n                mappers.n(data);\n                mappers.e(data);\n            }\n        }\n\n        // el.querySelector()\n        return directionsArr;\n    }\n}\n\nexport default Resize;\n","import {isHaveStyle} from \"./paste\";\nimport {Rows} from \"../core/row\";\nimport {splitStr} from \"../core/operator\";\nimport {xy2expr} from \"../core/alphabet\";\nimport CellRange from '../core/cell_range';\nimport {isHave} from \"../core/helper\";\n// jobs: todo: 为什么TableProxy放在event文件夹里面，似乎应该放到core文件夹？\nexport default class TableProxy {\n    constructor(data ) {\n        this.data = data;\n         this.rows = new Rows({len: 0, height: 0}, data);\n    }\n\n    getComputedStyle(computedStyle) {\n        let bold = false;\n        if (computedStyle.fontWeight > 400) {\n            bold = true;\n        }\n        let args = {\n            color: computedStyle.color,\n            bgcolor: computedStyle.background.substring(0,\n                computedStyle.background.indexOf(\")\") + 1),\n            font: {\n                bold: bold,\n            },\n        };\n\n        return args;\n    }\n\n    extend(tableDom, {ri, ci}) {\n        let {data} = this;\n        if (tableDom.rows.length >= data.rows.len - ri) {\n            let diff = tableDom.rows.length - (data.rows.len - ri);\n            if(diff > 0) {\n                data.insert('row', diff);\n            }\n        }\n\n        if (isHave(tableDom.rows[0]) === false || isHave(tableDom.rows[0].cells) === false) {\n            return;\n        }\n\n        let colLen = tableDom.rows[0].cells.length;\n        if (colLen >= data.cols.len) {\n            let diff = colLen - (data.cols.len - ci);\n            if(diff > 0) {\n                data.insert('column', diff, data.cols.len);\n            }\n        }\n    }\n\n    each(obj, cb) {\n        for (let i = 0; i < obj.rows.length; i++) {\n            for (let j = 0; j < obj.rows[i].cells.length; j++) {\n                cb(i, j, obj.rows[i].cells[j]);\n            }\n        }\n    }\n\n    dealColSpan(tableDom) {\n        this.each(tableDom, (i, j, cell) => {\n            let len = cell.getAttribute(\"colspan\");\n            if (len && len > 1) {\n                for (let c = 0; c < len - 1; c++) {\n                    tableDom.rows[i].insertBefore(document.createElement(\"td\"), tableDom.rows[i].cells[j + 1]);\n                }\n            }\n        });\n    }\n\n    dealStyle(tableDom, {ri, ci}) {\n        let {data, rows} = this;\n        let styles = data.styles;\n\n        this.each(tableDom, (i, j, cell) => {\n            let computedStyle = document.defaultView.getComputedStyle(cell, false);\n            let args = this.getComputedStyle(computedStyle);\n            let index = isHaveStyle(styles, args);\n            if (index === -1) {\n                styles.push(args);\n            }\n            rows.setCell(ri + i, ci + j, {\"style\": index === -1 ? styles.length - 1 : index}, 'all');\n        });\n    }\n\n    parseTableCellRange(tableDom, {ri, ci}) {\n      let maxRi = ri, maxCi = ci;\n      this.each(tableDom, (i, j, cell) => {\n        let rii = ri + i;\n        let cij = ci + j;\n            if(maxRi < rii) {\n              maxRi = rii;\n            }\n            if(maxCi < cij) {\n              maxCi = cij;\n            }\n        });\n        let cellRange = new CellRange(ri, ci, maxRi, maxCi);\n        return cellRange;\n    }\n\n    dealReference(tableDom, {ri, ci}) {\n        let {rows} = this;\n         let reference = [];\n\n        this.each(tableDom, (i, j, cell) => { // 处理reference函数提取一下，填充也用引用这个函数。 updateCEllReferenceByShift， 跟填充的逻辑共享\n            let node = cell.querySelector(\"reference\");\n            let innerText = cell.innerText || \"\";\n            if (node) {\n                let eri = node.getAttribute('ri');\n                let eci = node.getAttribute('ci');\n\n                let strList = splitStr(innerText);\n                let dci = i + ri - eri;\n                let dei = j + ci - eci;\n\n                let {bad, result} = rows.getCellTextByShift(strList, dei, dci);\n                rows.updateCellReferenceByShift(bad, result, ri + i, ci + j);\n            } else {\n                let _cell = rows.getCell(ri + i, ci + j) || {};\n                _cell.text = innerText;\n                _cell.formulas = innerText;\n\n                rows.setCell(ri + i, ci + j, _cell, 'all');\n            }\n            // proxy.setCell(data.name, xy2expr(ci + j, ri + i));\n\n            reference.push({\n                ri: ri + i,\n                ci: ci + j\n            });\n        });\n        return {\"reference\": reference};\n    }\n}\n","import {sheetReset} from \"../component/sheet\";\nimport {h} from \"../component/element\";\nimport Drag from \"../external/drag\";\nimport Resize from \"../external/resize\";\nimport {cssPrefix} from \"../config\";\nimport {getChooseImg} from \"../event/copy\";\nimport {xy2expr} from \"../core/alphabet\";\nimport CellRange from \"../core/cell_range\";\nimport {deepCopy} from \"../core/operator\";\nimport TableProxy from \"./table_proxy\";\n\nexport let resizeOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n\n    onEnd(data) {\n\n    },\n    onResize(data, self) {\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n\n        img.img2.style['width'] = img.img.el.style['width'];\n        img.img2.style['height'] = img.img.el.style['height'];\n    }\n};\n\nexport let dragOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n    onEnd(data, self) {\n        let {left, top} = data;\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n        // img.left = left + 70;\n        // img.top = top + 31;\n\n        if (top - 31 < 0) {\n            top = 0;\n        } else if (left - 60 < 0) {\n            left = 0;\n        }\n\n        let range = self.data.getCellRectByXY(left + 60, top + 31);\n        range.sri = range.ri;\n        range.sci = range.ci;\n        range.eri = range.ri;\n        range.eci = range.ci;\n        let offsetLeft = left - range.left + 50;\n        let offsetTop = top - range.top + 21;\n\n        img.offsetLeft = offsetLeft;\n        img.offsetTop = offsetTop;\n        img.range = range;\n        if (typeof img.lastCi !== 'undefined' && typeof img.lastRi !== 'undefined') {\n            img.ri = img.lastRi;\n            img.ci = img.lastCi;\n        }\n        img.lastCi = range.ci;\n        img.lastRi = range.ri;\n\n        self.data.history.addPic(deepCopy(self.data.pasteDirectionsArr), \"delete\");\n    },\n    onDrag(data) {\n    },\n};\n\nfunction spanDomPackage(spanDom, tableDom) {\n    let table = h(\"table\", \"\");\n    let tbody = h('tbody', '');\n\n    let textArr = spanDom.innerText.split(\"\\n\");\n    for (let i = 0; i < textArr.length; i++) {\n        let text = textArr[i];\n        let tr = h('tr', '');\n        let td = h('td', '');\n        td.html(text);\n        td.css('background', spanDom.style['background']);\n        td.css('font-weight', spanDom.style['font-weight']);\n        td.css('color', spanDom.style['color']);\n        tr.child(td);\n        tbody.child(tr);\n    }\n\n    table.child(tbody);\n    tableDom = table.el;\n\n    return tableDom;\n}\n\nexport function process(tableDom, styleDom = \"\") {\n    let {el, data} = this;\n    data.history.add(data.getData());\n    el.child(tableDom);\n    GetInfoFromTable.call(this, tableDom);\n    tableDom.parentNode.removeChild(tableDom);\n    if (styleDom) {\n        styleDom.parentNode.removeChild(styleDom);\n    }\n    sheetReset.call(this);\n}\n\nfunction mountPaste(e, cb) {\n    let cbd = e.clipboardData;\n    let p = false;\n\n    for (let i = 0; i < cbd.items.length; i++) {\n        let item = cbd.items[i];\n        if (item.kind === \"string\") {\n            item.getAsString((str) => {\n                let textDom = h('head', '');\n                let d = h('span', '');\n                if ((str.indexOf('<span') == -1 && str.indexOf('span>') == -1) && (str.indexOf('<table') == -1 && str.indexOf('table>') == -1)) {\n                    d.html(str);\n                    textDom.child(d.el);\n                    textDom = textDom.el;\n                }\n                else {\n                    textDom.html(str);\n                    textDom = textDom.el;\n                }\n                let imgDom = textDom.getElementsByTagName(\"img\")[0];\n                let styleDom = textDom.getElementsByTagName(\"style\")[0];\n                let tableDom = textDom.getElementsByTagName(\"table\")[0];\n                let spanDom = textDom.getElementsByTagName(\"span\")[0];\n                if (imgDom && !styleDom) {\n                    mountImg.call(this, imgDom);\n                    p = true;\n                } else {\n                    if (!tableDom) {\n                        setTimeout(() => {\n                            if (p) {\n                                return;\n                            }\n                            if (spanDom) {\n                                tableDom = spanDomPackage.call(this, spanDom, tableDom);\n                            }\n                            if (styleDom) {\n                                let {el} = this;\n                                el.child(styleDom);\n                            }\n\n                            if (tableDom && p == false) {\n                                let {el} = this;\n                                el.child(tableDom);\n                                GetInfoFromTable.call(this, tableDom);\n                                tableDom.parentNode.removeChild(tableDom);\n                                if (styleDom) {\n                                    styleDom.parentNode.removeChild(styleDom);\n                                }\n                                sheetReset.call(this);\n                                p = true;\n                            }\n                        }, 100)\n                    } else {\n                        if (styleDom) {\n                            let {el} = this;\n                            el.child(styleDom);\n                        }\n\n                        if (tableDom && p == false) {\n                            process.call(this, tableDom, styleDom);\n                            p = true;\n                        }\n                    }\n                }\n            });\n        } else if (item.kind === \"file\" && !p) {\n            let f = item.getAsFile();\n            let reader = new FileReader();\n            reader.onload = (evt) => {\n                let {x, y, overlayerEl} = this;\n                let {pasteDirectionsArr} = this.data;\n                let img = h('img', 'paste-img');\n                img.el.src = evt.target.result;\n\n                setTimeout(() => {\n                    if (p) {\n                        return;\n                    }\n                    p = true;\n                    mountImg.call(this, img.el);\n                }, 0);\n            };\n\n            if (!f)\n                return;\n            reader.readAsDataURL(f);\n        }\n    }\n    setTimeout(() => {\n        if (!p)\n            cb();\n        else {\n            let {data} = this;\n            data.change(data.getData());\n        }\n    })\n}\n\nfunction processImg(item) {\n    let f = item.getAsFile();\n    let reader = new FileReader();\n    reader.onload = (evt) => {\n        // let {x, y, overlayerEl, pasteDirectionsArr} = this;\n        let img = h('img', 'paste-img');\n        img.el.src = evt.target.result;\n\n        setTimeout(() => {\n            if (p) {\n                return;\n            }\n            p = true;\n            mountImg.call(this, img.el);\n        }, 0);\n    };\n\n    reader.readAsDataURL(f);\n}\n\nfunction moveArr(top, left) {\n    let {pasteDirectionsArr} = this.data;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        console.log(p.img.el['style'].top, \"108\");\n        p.img.css(\"top\", `${top }px`)\n            .css(\"left\", `${left  }px`)\n    }\n}\n\nfunction getMaxCoord(ri, ci) {\n    let top = 0;\n    let left = 0;\n    let {pasteDirectionsArr} = this.data;\n    let number = 0;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        if (p.ri === ri && p.ci === ci) {\n            if (left < p.nextLeft) {\n                left = p.nextLeft;\n            }\n            if (top < p.nextTop) {\n                top = p.nextTop;\n            }\n            number++;\n        }\n    }\n\n    return {\n        top: top,\n        left: left,\n        number: number,\n    }\n}\n\n\nexport function mountImg(imgDom, init = false, sri, sci, range, add = true) {\n    let image = new Image();\n    image.src = imgDom.src;\n    image.onload = () => {\n        let width = image.width;\n        let height = image.height;\n        let img = imgDom;\n        let {container, data} = this;\n        let {pasteDirectionsArr} = data;\n        if (add) {\n            data.history.addPic(Object.assign([], pasteDirectionsArr), \"delete\");\n        }\n\n        let {ri, ci} = data.selector;\n        if (init) {\n            ri = sri;\n            ci = sci;\n        }\n        let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n        const rect = data.getMoveRect(new CellRange(ri, ci, ri, ci));\n        let left = rect.left + pictureOffsetLeft;\n        let top = rect.top + pictureOffsetTop;\n        let number = 0;\n        let choose = getChooseImg.call(this);\n        if (choose) {\n            let args = getMaxCoord.call(this, choose.ri, choose.ci);\n            left = args.left;\n            top = args.top;\n            ri = choose.ri;\n            ci = choose.ci;\n            number = args.number;\n        }\n\n        let div = h('div', `${cssPrefix}-object-container`)\n            .css(\"position\", \"absolute\")\n            .css(\"top\", `${top}px`)\n            .css(\"width\", `${width}px`)\n            .css(\"height\", `${height}px`)\n            .css(\"z-index\", `100000`)\n            .css(\"left\", `${left}px`)\n            .child(img);\n        container.child(div);\n        new Drag(dragOption, this).register(div.el);\n        setTimeout(() => {\n            let {data} = this;\n            let directionsArr = new Resize(resizeOption, this).register(div.el);\n            let index = pasteDirectionsArr.length;\n\n            pasteDirectionsArr.push({\n                \"src\": img.src,\n                \"state\": true,\n                \"arr\": directionsArr,\n                \"img\": div,\n                \"index\": index,\n                \"img2\": img,\n                \"ri\": ri,\n                \"ci\": ci,\n                \"offsetLeft\": 0,\n                \"offsetTop\": 0,\n                \"number\": number,\n                \"range\": init ? range : data.selector.range,\n                \"top\": top,\n                \"left\": left,\n                \"nextLeft\": left + 15,\n                \"nextTop\": top + 15,\n            });\n            if (!init) {\n                this.data.change(this.data.getData());\n            }\n            this.direction = true;\n            div.css(\"width\", `${img.offsetWidth}px`);\n            div.css(\"height\", `${img.offsetHeight}px`);\n            containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr, init);\n            div.on('mousedown', evt => containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr));\n        }, 0);\n    };\n}\n\nfunction hideDirectionArr() {\n    let {pasteDirectionsArr} = this.data;\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let arr = pasteDirectionsArr[i].arr;\n            if (arr.length > 0) {\n                for (let j = 0; j < arr.length; j++) {\n                    arr[j].style.display = 'none';\n                }\n            }\n            pasteDirectionsArr[i].state = false;\n            pasteDirectionsArr[i].img.css(\"z-index\", \"10000\");\n            pasteDirectionsArr[i].img2.style['border'] = \"none\";\n        }\n    }\n}\n\nfunction deleteImg(d = false) {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true || d == true) {\n                direction_delete.push(pasteDirectionsArr[i]);\n            } else {\n                direction_new.push(pasteDirectionsArr[i]);\n            }\n        }\n    }\n\n    Object.keys(direction_delete).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n\n    let {data} = this;\n    data.pasteDirectionsArr = direction_new;\n    data.change(data.getData());\n}\n\nfunction deleteAllImg() {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            direction_delete.push(pasteDirectionsArr[i]);\n        }\n    }\n\n    Object.keys(pasteDirectionsArr).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n}\n\nfunction containerHandlerEvent(directionsArr, index, pasteDirectionsArr, init) {\n    hideDirectionArr.call(this);\n    this.direction = true;\n    Object.keys(directionsArr).forEach(i => {\n        directionsArr[i].style.display = 'block';\n    });\n\n    let {selector, editor} = this;\n    if (!init) {\n        selector.hide();\n        editor.clear();\n\n        pasteDirectionsArr[index].img.css(\"z-index\", \"99999999\");\n        pasteDirectionsArr[index].state = true;\n    } else {\n        hideDirectionArr.call(this);\n    }\n}\n\nfunction equals(x, y) {\n    let f1 = x instanceof Object;\n    let f2 = y instanceof Object;\n    if (!f1 || !f2) {\n        return x === y\n    }\n    if (Object.keys(x).length !== Object.keys(y).length) {\n        return false\n    }\n    let newX = Object.keys(x);\n    for (let p in newX) {\n        p = newX[p];\n        let a = x[p] instanceof Object;\n        let b = y[p] instanceof Object;\n        if (a && b) {\n            let equal = equals(x[p], y[p])\n            if (!equal) {\n                return equal\n            }\n        } else if (x[p] != y[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isHaveStyle(styles, style) {\n    for (let i = 0; i < styles.length; i++) {\n        if (equals(styles[i], style)) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n\nfunction GetInfoFromTable(tableObj) { // class ClipboardTableProxy; .tableDom 属性  .dealColSpan() [477~483], dealStyle(), dealReferrence()， 最终得到row2； sheet层面上：（1）增加行与列。（2）setCellRange变更值。（3）给出黏贴选项\n    let {data} = this;\n    let {ri, ci} = data.selector;\n    let styles = data.styles;\n    console.time(\"paste\");\n    let tableProxy = new TableProxy(data);\n\n    tableProxy.extend(tableObj, {ri, ci});\n    tableProxy.dealColSpan(tableObj);\n    tableProxy.dealStyle(tableObj, {ri, ci});\n    let {reference} = tableProxy.dealReference(tableObj, {ri, ci});\n    this.setCellRange(reference, tableProxy, true, tableProxy.parseTableCellRange(tableObj, {ri, ci}));\n\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n    let {advice, editor} = this;\n    editor.clear();\n    advice.show(left, top, 1, reference, tableProxy);\n    console.timeEnd(\"paste\");\n    return {\n        rows: data.rows._,\n        styles: styles\n    };\n}\n\nfunction pasteType(type, ds, dei) {\n    if (type === 1) {\n\n    } else if (type === 2) {\n        xy2expr(ds[0] + dei, ds[1], 2);\n    }\n}\n\nexport {\n    mountPaste,\n    hideDirectionArr,\n    deleteImg,\n    moveArr,\n    deleteAllImg,\n    GetInfoFromTable,\n}\n\n","import dayjs from 'dayjs'\nimport {datePattern, str2Re} from \"../utils/reg_pattern\";\nimport {formatNumberRender} from \"../core/format\";\nimport {isHave, isNumber} from \"../core/helper\";\n\n\nexport function formatDate(diff) {\n    if(!isHave(diff) || !isNumber(diff)) {\n        return {\n            \"state\": false,\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n\n    let str = calcDecimals(diff, (i) => {\n        return i * 24 * 60;\n    });\n    str = formatNumberRender(str, 5);\n    let beginDate = dayjs('1900-01-01');\n    let beginDate2 = dayjs('1900-01-01');\n    let enter = false;\n\n    if (isHave(str) && str * 1 > 0) {\n        let second = calcDecimals(str, (i) => {\n            return i * 60;\n        });\n        enter = true;\n        second = formatNumberRender(second, 5);\n        beginDate2 = dayjs('1900-01-01  00:00:00').set('minute', str).set('second', second);\n    }\n\n    let date = \"\";\n    if (enter) {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n\n        let formula = beginDate2.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD  h:mm:ss');\n        return {\n            \"state\": date === 'Invalid Date' ? false : true,\n            \"date\": date,\n            \"date_formula\": formula,\n            \"minute\": true\n        }\n    } else {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n        return {\n            \"state\": date === 'Invalid Date' ? false : true,\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n}\n\nexport function changeFormat(date, format = 'YYYY年MM月DD日') {\n  return dayjs(date).format(format);\n}\n\nexport function calcDecimals(diff, cb = () => {\n}) {\n    let arr = diff.toString().split('.');\n    if (arr.length > 2) {\n        return diff;\n    }\n    let fix = arr[1] + \"\";\n    let newData = fix;\n    for (let i = 0; i < fix.length; i++) {\n        newData = newData * 0.1;\n    }\n    let str = cb(newData);\n\n    return str;\n}\n\nexport function cellDate() {\n\n}\n\n// 已写test\nexport function dateDiff(date) {\n    let valid = false;\n\n    for (let i = 0; valid === false && i < datePattern.length; i++) {\n        valid = str2Re(datePattern[i]).test(date);\n    }\n\n    if (valid === false) {\n        return {\n            \"isValid\": false,\n        };\n    } else {\n        date = date.replace(/[年|月]/g, \"-\");\n        date = date.replace(/[日]/g, \"\");\n\n        return {\n            \"diff\": dayjs(date).diff(dayjs('1900-01-01'), 'day') + 2,\n            \"isValid\": true,\n        }\n    }\n}\n","import {xy2expr} from \"./alphabet\";\nimport PreAction from \"../model/pre_action\";\nimport {testValid} from \"../utils/test\";\n\nfunction operationItem(preAction) {\n    this.undoItems.push(preAction);\n    this.redoItems = [];\n}\n\nexport default class MultiPreAction {\n    constructor(data) {\n        this.undoItems = [];\n        this.redoItems = [];\n        this.data = data;\n    }\n\n    addStep({type, action, ri, ci, expr, cellRange, cells, height, width, property, value, oldData}, {oldCell, newCell, oldMergesData, newMergesData, oldStep}) {\n        let preAction = \"\";\n\n        if(type === 1) {\n            preAction = new PreAction({\n                type,\n                action, ri, ci, expr, oldCell, newCell\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 2 || type === 5 || type === 11 || type === 12 || type === 6) {\n            preAction = new PreAction({\n                type, oldMergesData, property, value, newMergesData,\n                action, cellRange,  oldCell, newCell: cells\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 13) {\n            preAction = new PreAction({\n                type, oldData, newData: oldStep.oldData,\n                action,\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 3) {\n            preAction = new PreAction({\n                type,\n                action, height, ri, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 4) {\n            preAction = new PreAction({\n                type,\n                action, width, ci, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        }\n\n        testValid.call(this);\n    }\n\n    getStepType(type, {ri, ci, expr, text, range, cellRange, property, value, merges}) {\n        let str = \"\";\n        let {rows, cols} = this.data;\n\n        if(type === 1) {\n            str = `在${expr}中键入\"${text}\"`;\n            return {\n                action: str,\n                type,\n                ri, ci, expr\n            };\n        } else if(type === 2) {\n            let expr1 = xy2expr(range.sci, range.sri);\n            let expr2 = xy2expr(range.eci, range.eri);\n            expr = expr1 === expr2 ? expr1 : `${expr1}:${expr2}`;\n            str = `删除${expr}的单元格内容`;\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(range),\n            };\n        } else if(type === 3) {\n            let height = rows.getHeight(ri);\n            str = `行宽`;\n            return {\n                action: str,\n                type,\n                height: height,\n                ri: ri\n            };\n        } else if(type === 4) {\n            let width = cols.getWidth(ci);\n            str = `列宽`;\n            return {\n                action: str,\n                type,\n                width: width,\n                ci: ci\n            };\n        } else if(type === 5) {\n            str = '自动填充';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 12) {\n            str = '选择性粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 13) {\n            str = '插入单元格';\n\n            return {\n                action: str,\n                type, oldData: this.data.getData(),\n            };\n        }else if(type === 11) {\n            if (property === 'font-bold' || property === 'font-italic'\n                || property === 'font-name' || property === 'font-size' || property === 'color') {\n                str = \"字体\";\n            } else if (property === 'underline') {\n                str = \"下划线\";\n            } else if (property === 'bgcolor' || property === 'format') {\n                str = \"单元格格式\";\n            } else if (property === 'align') {\n                if (value === 'left') {\n                    str = \"左对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'right') {\n                    str = \"右对齐\";\n                }\n            } else if (property === 'valign') {\n                if (value === 'top') {\n                    str = \"顶端对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'bottom') {\n                    str = \"底端对齐\";\n                }\n            } else if (property === 'border') {\n                str = \"边框\";\n            } else if (property === 'strike') {\n                str = \"删除线\";\n            } else if (property === 'merge') {\n                str = '合并单元格';\n            }\n\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 6) {\n            str = '粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        }\n    }\n\n    undo() {\n        let preAction = this.does(this.getItems(1), 1);\n        this.redoItems.push(preAction);\n    }\n\n    redo() {\n        let preAction = this.does(this.getItems(2), 2);\n        this.undoItems.push(preAction);\n    }\n\n    eachRange(range) {\n        let {rows} = this.data;\n        let cells = rows.eachRange(range);\n\n        return cells;\n    }\n\n    does(actionItems, actionType) {\n        if (!this.data.settings.showEditor) {\n            return;\n        }\n\n        if (actionItems.length <= 0) {\n            return;\n        }\n        let {data} = this;\n        let {sheet} = data;\n\n        let preAction = actionItems.pop();\n        preAction.restore(data, sheet, actionType);\n\n        return preAction;\n    }\n\n    getItems(type) {\n        if (type === 1) {\n            return this.undoItems;\n        } else {\n            return this.redoItems;\n        }\n    }\n}\n","import CellProp from \"./cell_prop\";\nimport {isHave} from \"../core/helper\";\nimport {xy2expr} from \"../core/alphabet\";\n\nfunction getType(dType, sType) {\n    if (dType === 1 && sType === 1) {\n        return 1;           // 1行多列 * 1行多列\n    } else if (dType === 1 && sType === 2) {\n        return 2;\n    } else if (dType === 1 && sType === 3) {    // 多行多列 * 一行多列\n        return 3;\n    } else if (dType === 2 && sType === 1) {\n        return 4;\n    } else if (dType === 3 && sType === 1) {\n        return 5;\n    } else if (dType === 2 && sType === 2) {\n        return 6;\n    } else if (dType === 2 && sType === 3) {\n        return 7;\n    } else if (dType === 3 && sType === 2) {\n        return 8;\n    } else if (dType === 3 && sType === 3) {\n        return 9;\n    }\n}\n\nfunction changeDarrToDoubleArr(darr, selectorRange) {\n    let ri = selectorRange.sri;\n    let _darr = [];\n    let arr = [];\n    let index = 0;\n    selectorRange.each((i, j) => {\n        if (ri !== i) {\n            ri = i;\n            _darr.push(arr);\n            arr = [];\n        }\n        arr.push(darr[index]);\n        index += 1;\n    });\n    _darr.push(arr);\n\n    return _darr;\n}\n\nexport default class PaintFormat {\n    constructor(selectorRange, dstRange) {\n        this.selectorRange = selectorRange;\n        this.dstRange = dstRange;\n    }\n\n    getPaintType() {\n        let {dstRange, selectorRange} = this;\n\n        let dType = dstRange.getType();\n        let sType = selectorRange.getType();\n\n        let paintType = getType(dType, sType);\n\n        return paintType;\n    }\n\n    makePaintArr(type, darr) {\n        let {dstRange, selectorRange} = this;\n        let pArr = [];\n        // if (type === 1 || type === 6) {  // 1行多列 // 1列多行\n        //     let index = 0;\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         index += 1;\n        //         if (index === darr.length) {\n        //             index = 0;\n        //         }\n        //     });\n        // } else if (type === 3) {        // 3 多行多列 * 1行多列\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         let {cell} = _darr[0][index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //     });\n        // } else if(type === 7) {\n        //     let recordRi = dstRange.sri;\n        //     let rowIndex = 0;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === _darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = _darr[rowIndex][0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // }else if (type === 4 || type === 2) {   // 4: 1行多列 * 1列多行    6: 1列多行 * 1行多列\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //     });\n        // } else if (type === 5) {\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             index = 0;\n        //         }\n        //\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //         recordRi = i;\n        //     });\n        // } else if (type === 8) {\n        //     let rowIndex = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = darr[rowIndex];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // } else if (type === 9) {\n            let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n            let rowIndex = 0;\n\n            let _darr = changeDarrToDoubleArr(darr, selectorRange);\n\n            dstRange.each((i, j) => {\n                if (recordRi !== i) {\n                    rowIndex += 1;\n                    index = 0;\n                    if (rowIndex === _darr.length) {\n                        rowIndex = 0;\n                    }\n                }\n\n                let {cell} = _darr[rowIndex][index];\n\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j));\n                pArr.push(cellProp);\n\n                if (index === dci) {\n                    index = 0;\n                } else {\n                    index += 1;\n                }\n                recordRi = i;\n            });\n        // }\n\n        return pArr;\n    }\n}","/* global document */\n\nimport {formulaCalc} from '../core/formula';\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper, {isHave, isNumber, useOne} from './helper';\nimport {isFormula, Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\nimport Moved from '../event/move';\nimport {h} from \"../component/element\";\nimport {mountImg} from \"../event/paste\";\nimport {parseCell2} from \"../component/table\";\nimport {isLegal} from \"./operator\";\nimport Recast from \"./recast\";\nimport {changeFormat, dateDiff, formatDate} from '../utils/date';\nimport {formatNumberRender} from \"./format\";\nimport MultiPreAction from \"../core/multi_pre_action\";\nimport CellProxy from \"./cell_proxy\";\nimport CellProp from \"../model/cell_prop\";\nimport PaintFormat from \"../model/paint_format\";\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        family: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    formula: {},\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showEditor: true,\n    autoLoad: true,\n    ignore: [],\n    cellWidth: 0,\n    ignoreRi: 0,\n    minus: false,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 10,\n    },\n    rowsInit: false,\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        flexible: false,\n        underline: false,\n        autoAdapt: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n    },\n};\n\nconst toolbarHeight = 41;\n\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    if (!dst) {\n        return false;\n    }\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange, cleard) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    if (cleard)\n        clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (isHave(cell.style)) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n\n    Object.assign(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction selectorCellText(ri, ci, text, event_type) {\n    if (ri == -1 || ci == -1) {\n        return {\n            \"state\": true,\n            \"msg\": \"单元格坐标有误\"\n        };\n    }\n    if (event_type !== 'style' && (!text || text[0] !== '=')) {\n        return {\n            \"state\": false,\n            \"msg\": \"正确\"\n        };\n    }\n\n    // state\n    let args = errorPop.call(this, text);\n    if (event_type !== 'style' && args.state === true) {\n        return {\n            \"msg\": args.msg,\n            \"state\": true,\n        };\n    }\n    return {\n        \"msg\": args.msg,\n        \"state\": false,\n    };\n}\n\nfunction errorPop(text) {\n    let enter = false;\n    let msg = \"\";\n    try {\n        let recast = new Recast(text);\n        recast.parse();\n    } catch (e) {\n        msg = '您输入的公式存在问题，请更正, 错误原因: ' + e.description;\n        enter = true;\n    }\n\n    if (enter == true) {\n        if (isLegal(text) == false) {\n            msg = '缺少左括号或右括号';\n            enter = true;\n        }\n    }\n\n    if (enter) {\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else {\n        return {\n            \"state\": false,\n            \"msg\": msg\n        };\n    }\n}\n\nfunction processPasteDirectionsArr(pasteDirectionsArr, type = 'to', sheet) {\n    if (type == 'to') {\n        let arr = [];\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            console.log(item);\n            let newItem = {\n                src: item.img2.src,\n                ri: item.ri,\n                ci: item.ci,\n                top: item.top,\n                left: item.left,\n                range: item.range,\n                offsetLeft: item.offsetLeft,\n                offsetTop: item.offsetTop,\n                nextLeft: item.nextLeft,\n                nextTop: item.nextTop,\n                img: item.img,\n                arr: item.arr,\n                img2: item.img2\n            };\n\n            arr.push(newItem);\n        }\n\n        return arr;\n    } else if (type == 'from') {\n        if (typeof sheet === 'string') {\n            return;\n        }\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            let img = h('img', '');\n            img.el.src = item.src;\n            mountImg.call(sheet, img.el, true, item.ri, item.ci, item.range);\n        }\n    }\n}\n\nfunction clickCopyPasteHelp(ri, lci) {\n    let {rows} = this;\n    let lri = ri + 1;\n    let enter = true;\n    while (enter) {\n        let lcell = rows.getCellOrNew(lri, lci);\n        if (!lcell || !lcell.text) {\n            enter = false;\n        } else {\n            lri = lri + 1;\n        }\n    }\n\n    return lri;\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSignleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            setStyleBorder.call(this, ri, ci, {});\n        }\n    }\n\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci <= eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\nfunction getCellRowByAbsX(scrollOffsetx) {\n    let x = scrollOffsetx;\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: 0, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction getCellRowByAbsY(scrollOffsety) {\n    let y = scrollOffsety;\n    let {rows} = this;\n    let ri = 0;\n    let top = rows.height;\n    const frset = this.exceptRowSet;\n    let {height} = rows;\n\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n\n    if (ri <= 0) {\n        ri = 0;\n    }\n    if (height <= 0) {\n        height = 0;\n    }\n\n    return {ri: ri, top, height};\n}\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction makeFormatCell({text, formula}, {symbol, position}, cb) {\n    if (!isHave(text) || !isNumber(text)) {\n        return null;\n    }\n\n    let cText = cb(formatNumberRender(text, -1));\n    formula = isFormula(formula) ? formula : cText;\n    if (!isNaN(cText)) {\n        let _cell = {\n            \"text\": position === 'begin' ? symbol + cText : cText + symbol,\n            \"value\": text,\n            \"formulas\": formula,\n        };\n        return _cell;\n    } else {\n        return null;\n    }\n}\n\n// what = 'input' || 'change'\nfunction tryParseToNum(cell, ri, ci) {\n    return getType.call(this, ri, ci, cell);\n}\n\nfunction getType(ri, ci, cell) {\n    let data = this;\n    let {rows} = this;\n    let cellStyle = data.getCellStyle(ri, ci);\n    let {isValid, diff} = dateDiff(cell.text);\n\n    let format = rows.getCellStyleConvert(cellStyle, isValid);\n    if (format === 'number') {\n        let text = cell.text, formula = cell.formulas;\n        let _cell = {};\n        if (isValid) {\n            _cell = {\n                \"text\": diff.toFixed(2),\n                \"formulas\": formula,\n            };\n        } else {\n            text = formatNumberRender(text, 2);\n            _cell = {\n                \"text\": text,\n                \"value\": cell.text,\n                \"formulas\": formula,\n            };\n        }\n\n        if (isHave(_cell.text) && isNumber(_cell.text)) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        } else {\n            return {\n                \"state\": false,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'date' || format === 'datetime') {\n        let text = cell.text, formula = cell.formulas, minute = false;\n        let _cell = {};\n\n        if (!isValid) {\n            let args = formatDate(text);\n            let {state, date, date_formula} = args;\n            minute = args.minute;\n            isValid = state;\n            diff = cell.text;\n            text = date;\n        }\n\n        if (isValid) {\n            if (format === 'datetime') {\n                text = changeFormat(formatDate(dateDiff(text).diff).date);\n            }\n            _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n        }\n\n        return {\n            \"state\": isValid,\n            \"style\": format,\n            \"text\": !isHave(cellStyle) ? diff : text,\n        };\n    } else if (format === 'normal') {\n        if (isValid) {\n            let text = diff, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": rows.toString(formula),\n                \"text\": rows.toString(text),\n            };\n\n            return {\n                \"state\": true,\n                \"text\": _cell.text,\n                \"style\": format,\n                \"cell\": _cell,\n            }\n        } else {\n            let text = cell.text, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'rmb') {\n        let text = \"\", formula = \"\";\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = formatNumberRender(cell.text, 0);\n            formula = cell.formulas;\n        }\n\n        let _cell = makeFormatCell({text, formula}, {symbol: \"￥\", position: \"begin\"}, (s) => {\n            return s;\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    } else if (format === 'percent') {\n        let text = \"\", formula = \"\";\n\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = rows.useOne(cell.value, cell.text);\n            formula = cell.formulas;\n        }\n        let _cell = makeFormatCell({text, formula}, {symbol: \"%\", position: \"end\"}, (s) => {\n            return Number(s * 100).toFixed(2);\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    }\n\n    return {\n        \"state\": false,\n        \"style\": format,\n        \"text\": cell.text,\n        \"cell\": {},\n    };\n}\n\n\nexport default class DataProxy {\n    constructor(name, settings, methods) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.methods = methods;\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row, this);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = {};\n        this.showEquation = false;\n        this.calc = formulaCalc();\n        this.pasteDirectionsArr = [];\n        this.changeDataForCalc = null;\n\n        // save data end\n\n        // don't save object\n        this.multiPreAction = new MultiPreAction(this);\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        // this.history = new History(this);\n        this.clipboard = new Clipboard();\n        this.moved = new Moved();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    tryParseToNum(cell, ri, ci) {\n        return tryParseToNum.call(this, cell, ri, ci);\n    }\n\n    clickCopyPaste() {\n        let ri = this.selector.range.eri;\n        let ci = this.selector.range.eci;\n        let {rows} = this;\n        const cell = rows.getCellOrNew(ri, ci);\n        const cell2 = rows.getCellOrNew(ri + 1, ci);\n        if (!cell || !cell.text || (cell2 && cell2.text)) {\n            return {\n                enter: false\n            };\n        }\n\n        let left = clickCopyPasteHelp.call(this, ri, ci - 1);\n        let right = clickCopyPasteHelp.call(this, ri, ci + 1);\n        let eri = left < right ? right : left;\n\n        let enter = false;\n        for (let i = 1; i < eri && enter === false; i++) {\n            let cell3 = rows.getCellOrNew(ri + i, ci);\n\n            if (cell3 && cell3.text) {\n                eri = ri + i;\n                enter = true;\n            }\n        }\n\n\n        let dstCellRange = new CellRange(ri + 1, ci, eri - 1, ci);\n        let srcCellRange = new CellRange(ri, ci, ri, ci);\n\n        return {\n            enter: true,\n            dstCellRange: dstCellRange,\n            srcCellRange: srcCellRange\n        };\n    }\n\n\n    getSelectedValidator() {\n        const {ri, ci} = this.selector;\n        const v = this.validations.get(ri, ci);\n        return v ? v.validator : null;\n    }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.multiPreAction.getItems(1).length > 0;\n        // return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.multiPreAction.getItems(2).length > 0;\n    }\n\n    undo(sheet) {\n        this.multiPreAction.undo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.undo(this.getData(), (d) => {\n        //     this.setData(d);\n        // }, sheet);\n    }\n\n    historyList(item) {\n        return this.multiPreAction.getItems(item);\n    }\n\n    redo() {\n        this.multiPreAction.redo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.redo(this.getData(), (d) => {\n        //     this.setData(d);\n        // });\n    }\n\n    copy() {\n        document.execCommand('copy', true);\n        this.clipboard.copy(this.selector.range);\n    }\n\n    makeCellPropArr(range, dsri, dsci) {\n        let {rows} = this;\n        let darr = [];\n        let cells = rows.eachRange(range);\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n\n            if (isHave(cell) && isHave(cell.style) === false) {\n                let cstyle = this.defaultStyle();\n                cell.style = this.addStyle(cstyle);\n            }\n\n            let cellProp = new CellProp(ri + dsri, ci + dsci, cell, xy2expr(ri + dsri, ci + dsci));\n            darr.push(cellProp);\n        }\n\n        return darr;\n    }\n\n    setCellByCellProp(pArr, cb) {\n        let {rows} = this;\n        for (let i = 0; i < pArr.length; i++) {\n            let {ri, ci, cell} = pArr[i];\n            if (isHave(cell) && isHave(cell.style)) {\n                rows.setCell(ri, ci, cell, 'style');\n            }\n            cb(ri, ci);\n        }\n    }\n\n    paintFormatChange(cb) {\n        this.changeData(() => {\n            let {clipboard, rows, selector} = this;\n            let {range} = clipboard;\n            let sri = selector.ri;\n            let sci = selector.ci;\n\n            let dsri = sri - range.sri;\n            let dsci = sci - range.sci;\n            let darr = this.makeCellPropArr(range, dsri, dsci);\n\n            if (selector.range.eri - selector.range.sri === 0 && selector.range.eci - selector.range.sci === 0) {\n                this.setCellByCellProp(darr, cb);\n            } else {\n                let paintFormat = new PaintFormat(range, selector.range);\n                let paintType = paintFormat.getPaintType();\n                let pArr = paintFormat.makePaintArr(paintType, darr);\n\n                this.setCellByCellProp(pArr, cb);\n            }\n        }, {type: 12, cellRange: this.selector.range});\n    }\n\n    move() {\n        this.moved.move();\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    paste(cellRange) {\n        this.changeData(() => {\n\n        }, {type: 6, cellRange: cellRange});\n    }\n\n    // what: all | text | format\n    // paste(what = 'all', error = () => {\n    // }) {\n    //\n    //     // console.log('sIndexes:', sIndexes);\n    //     // const {clipboard, selector} = this;\n    //     // if (clipboard.isClear()) return false;\n    //     // if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n    //     //\n    //     // this.changeData(() => {\n    //     //     if (clipboard.isCopy()) {\n    //     //         copyPaste.call(this, clipboard.range, selector.range, what);\n    //     //     } else if (clipboard.isCut()) {\n    //     //         cutPaste.call(this, clipboard.range, selector.range);\n    //     //     }\n    //     // });\n    //     return true;\n    // }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        }, {type: 5, cellRange: cellRange});\n\n        return true;\n    }\n\n\n    clickAutofill(srcRange, cellRange, what, error = () => {\n    }) {\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        // row index\n        if (nri <= cri) [sri, eri] = [nri, cri];\n        else eri = nri;\n        // col index\n        if (nci <= cci) [sci, eci] = [nci, cci];\n        else eci = nci;\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n    initPercent() {\n\n    }\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                const cell = rows.getCellOrNew(selector.ri, selector.ci);\n                cell.text = `=${value}()`;\n                cell.formulas = `=${value}()`;\n            } else {\n                selector.range.each((ri, ci) => {\n                    let cell = rows.getCellOrNew(ri, ci);\n\n                    let cstyle = {};\n                    if (isHave(cell.style)) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        // cell.text = cell.text.replace(\"¥\", \"\");\n                        // cell.formulas = cell.formulas.replace(\"¥\", \"\");\n                        rows.setCellText(ri, ci, {\n                            text: cell.text,\n                            style: this.addStyle(cstyle)\n                        }, 'format');\n                        // this.rows.workbook.change(ri, ci, cell, deepCopy(cell), 'change');\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'flexible') {\n                        if (this.exceptRowSet.has(ri + 1) && this.exceptRowSet.has(ri + 2) && !this.exceptRowSet.has(ri + 3)) {\n                            this.exceptRowSet.delete(ri);\n                            this.exceptRowSet.delete(ri + 1);\n                            this.exceptRowSet.delete(ri + 2);\n                        } else {\n                            this.exceptRowSet.add(ri);\n                            this.exceptRowSet.add(ri + 1);\n                            this.exceptRowSet.add(ri + 2);\n                        }\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    }\n                });\n            }\n        }, {type: 11, cellRange: this.selector.range, property, value});\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        this.setCellText(nri, ci, {text}, state);\n        this.resetAutoFilter();\n    }\n\n    // state: input | finished\n    setSelectedCell(text, state = 'input', formulas, ri, ci) {\n        this.setCellAll(ri, ci, text, formulas, state);\n        this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    editorChangeToHistory(oldCell, {ri, ci}, type) {\n        if (ri === -1 || ci === -1) {\n            return {\"state\": false}\n        }\n        let newCell = this.rows.getCell(ri, ci);\n        // if (oldCell.text === newCell.text || oldCell.formulas === newCell.text) {\n        //     return {\n        //         \"state\": false,\n        //     };\n        // }\n        let {multiPreAction} = this;\n        let expr = xy2expr(ci, ri);\n        let step = multiPreAction.getStepType(type, {ri, ci, expr, text: newCell.text});\n\n        let oc = new CellProp(ri, ci, oldCell, expr)\n        let nc = new CellProp(ri, ci, newCell, expr)\n        multiPreAction.addStep(step, {oldCell: [oc], newCell: [nc]});\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        return {\n            \"state\": true\n        }\n    }\n\n    changeToHistory({ri, type, ci, cellRange, property, value, oldCell, oldMergesData}, oldStep) {\n        if (type === -1) {\n            return {\"state\": false,}\n        }\n\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n        multiPreAction.addStep(step, {oldCell, oldMergesData, newMergesData: this.merges.getData(), oldStep,});\n        return {\n            \"state\": true\n        }\n    }\n\n    getSelectedCellRiCi(ri, ci) {\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    isMergeCell(ri, ci) {\n        let state = false;\n        let data = \"\";\n        this.merges.each((range) => {\n            if (range.includeByRiCi(ri, ci)) {\n                state = true;\n                data = range;\n            }\n        });\n        return {\n            \"state\": state,\n            \"data\": data,\n        };\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n\n    getMoveRect(range) {\n        return this.getRect(range);\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    getCellRectByXYWithNotTotalResult(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n\n        if (ci === -1) {\n            // // width = cols.totalWidth();\n            // let args = getCellRowByAbsX.call(this, scroll.x);\n            // console.log(args);\n            // // ci = args.ci;\n        }\n        if (ri === -1) {\n            // let args = getCellRowByAbsY.call(this, scroll.y);\n            // console.log(\"1179: \", args.ri);\n            // ri = args.ri;\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    isSignleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n    dateInput(cell, ri, ci, type) {\n        // let cstyle = this.getCellStyle(ri, ci) || {};\n        // cstyle.format = type;\n        // cell.style = this.addStyle(cstyle);\n        // this.rows.setCell(ri, ci, cell, type);\n    }\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSignleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            const cell = rows.getCellOrNew(sri, sci);\n            cell.merge = [rn - 1, cn - 1];\n            this.merges.add(selector.range);\n            // delete merge cells\n            this.rows.deleteCells(selector.range);\n            // console.log('cell:', cell, this.d);\n            this.rows.setCell(sri, sci, cell);\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSignleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                let v = selector.range.toString();\n                let eri = selector.range.eri;\n                const {rows} = this;\n\n                for (let i = selector.range.sci; i <= selector.range.eci; i++) {\n                    let range = new CellRange(selector.range.sri, i, selector.range.sri, i);\n                    range = rows.autoFilterRef(v, range);\n                    if (eri < range.eri) {\n                        eri = range.eri;\n                    }\n                }\n                let range = new CellRange(selector.range.sri, selector.range.sci, eri, selector.range.eci);\n                autoFilter.ref = range.toString();\n            }\n        });\n    }\n\n    throwFormula() {\n        const {selector, rows} = this;\n\n        this.changeData(() => {\n            selector.range.each((i, j) => {\n                const cell = rows.getCellOrNew(i, j);\n                if (cell && cell.text && cell.formulas) {\n                    rows.setCellAll(i, j, cell.text, cell.text);\n                }\n            });\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        }, {type: 2});\n    }\n\n    // type: row | column\n    insert(type, n = 1, begin = -1) {\n        let {\n            mri,\n            mci\n        } = this.getMax();\n        const {sri, sci} = this.selector.range;\n        const {rows, merges, cols} = this;\n        let dri = 0, dci = 0;\n        if (type === 'row') {\n            begin = begin != -1 ? begin : sri;\n            dri = begin;\n            dci = 0;\n        } else if ('column') {\n            begin = begin != -1 ? begin : sci;\n            dci = begin;\n            dri = 0;\n        }\n\n        this.changeData(() => {\n            let si = begin;\n            if (type === 'row') {\n                rows.insert(begin, n);\n            } else if (type === 'column') {\n                rows.insertColumn(begin, n);\n                si = begin;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        }, {type: 13, data: this.getData(), property: \"insert\"});\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= 1;\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {scroll, freeze, rows} = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        // console.log('ri:', ri, ' ,y:', y1);\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getMax() {\n        let mci = this.cols.len;\n        let mri = this.rows.len;\n\n        return {\n            mri,\n            mci\n        }\n    }\n\n\n    isEmpty(cell) {\n        return this.rows.isEmpty(cell);\n    }\n\n    renderFormat(style, cell, nrindex, cindex, filter) {\n        let cellProxy = new CellProxy(cell);\n        return cellProxy.renderFormat(style, nrindex, cindex, this, filter);\n    }\n\n    isFormula(text) {\n        return this.rows.isFormula(text);\n    }\n\n    toString(text) {\n        return this.rows.toString(text);\n    }\n\n    isBackEndFunc(text) {\n        return this.rows.isBackEndFunc(text);\n    }\n\n    isReferOtherSheet(cell) {\n        return this.rows.isReferOtherSheet(cell);\n    }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    getCellStyleHandle(index, type, cell, ri, ci) {\n        let style = this.styles[index];\n\n        if (style && style.format === type) {\n            return true;\n        }\n        return false;\n    }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    getCellByExpr(src, table, name, inputText, pos) {\n        let p1 = inputText.substring(0, pos);\n        let p2 = inputText.substring(pos, inputText.length);\n        inputText = p1 + src + p2;\n        let workbook = parseCell2.call(table, this.viewRange(), true, inputText);\n        return {\n            \"text\": workbook['Sheets'][name].A1.w ? workbook['Sheets'][name].A1.w : workbook['Sheets'][name].A1.v,\n            \"formulas\": p1 + `${name}!` + src + p2\n        };\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, {text, style}, state) {\n        // text = text.replace(/\\\"/g)\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, {text: ''});\n            history.add(this.getData());\n            rows.setCellText(ri, ci, {text});\n        } else {\n            if (state === 'end') {\n                rows.setCellAll(ri, ci, text);\n            } else if (state === 'formulas') {\n                rows.setCellAll(ri, ci, text, \"-\");\n            } else if (state === 'style') {\n                rows.setCellText(ri, ci, {text, style}, 'style');\n            } else {\n                rows.setCellText(ri, ci, {text});\n                // rows.\n            }\n            // 不应该没打开一个单元格就 change一次\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    setCellWithFormulas(ri, ci, text, formulas, what = 'all') {\n        const {rows} = this;\n        rows.setCellAll(ri, ci, text, formulas, what);\n    }\n\n\n    // state: input | finished\n    setCellAll(ri, ci, text, formulas, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellAll(ri, ci, '', '');\n            history.add(this.getData());\n            rows.setCellAll(ri, ci, text, formulas);\n        } else {\n            rows.setCellAll(ri, ci, text, formulas);\n            // this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text, formulas);\n    }\n\n    equationIsActive() {\n        return this.showEquation;\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        }, {type: 3, ri: ri});\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        }, {type: 4, ci: ci});\n    }\n\n    viewHeight() {\n        const {view, showToolbar} = this.settings;\n        let h = view.height();\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    viewRange2() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) offset += 1;\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                cb(i, y, rowHeight);\n                y += rowHeight;\n                if (y > this.viewHeight()) break;\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            cb(i, x, colWidth);\n            x += colWidth;\n            if (x > this.viewWidth()) break;\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    // addPicture(pic) {\n    //     const {pictures} = this;\n    //\n    // }\n\n    getChangeDataToCalc() {\n        let {multiPreAction} = this;\n        if (multiPreAction.undoItems.length <= 0) {\n            return null;\n        }\n        let lastStep = multiPreAction.undoItems[multiPreAction.undoItems.length - 1];\n        if (!isHave(lastStep)) {\n            return null;\n        }\n\n        return lastStep;\n    }\n\n    changeData(cb, {type = -1, ri = -1, ci = -1, cellRange = \"\", property = \"\", value = \"\"} = -1) {\n        if (this.settings.showEditor === false) {\n            return;\n        }\n\n        let oldCell = {};\n        let oldMergesData = this.merges.getData();\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n\n        if (cellRange !== \"\") {\n            let {multiPreAction} = this;\n            oldCell = multiPreAction.eachRange(cellRange);\n        }\n        cb();\n        this.changeToHistory({type, ri, ci, cellRange, property, value, oldCell, oldMergesData, newData: this.getData(), }, step);\n        this.changeDataForCalc = this.getChangeDataToCalc();\n\n        this.change(this.getData());\n    }\n\n    cutPaste(srcCellRange, dstCellRange, cleard = true) {\n        cutPaste.call(this, srcCellRange, dstCellRange, cleard);\n    }\n\n    setData(d, sheet = \"\", out = false) {\n        const {autoFilter} = this;\n        Object.keys(d).forEach((property) => {\n            // this.judgeAutoWidth(d.rows);\n            if (property === 'merges'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'flex') {\n                autoFilter.addFiexRows(d[property]);\n            } else if (property === 'rows') {\n                this[property].setData(d[property], sheet, out, this.settings.rowsInit);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'pictures') {\n                if (d[property]) {\n                    processPasteDirectionsArr.call(this, d[property], 'from', sheet);\n                }\n            } else if (property === 'autofilter') {\n                if (d[property] && d[property].ref) {\n                    autoFilter.ref = d[property].ref;\n                    autoFilter.filters = d[property].filters;\n                    autoFilter.sort = d[property].sort;\n                }\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    selectorCellText(ri, ci, text, event_type) {\n        return selectorCellText.call(this, ri, ci, text, event_type);\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter, pasteDirectionsArr,\n        } = this;\n        return {\n            editor: this.settings.showEditor,\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            pictures: processPasteDirectionsArr(pasteDirectionsArr, 'to'),\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n}\n","export default {\n    toolbar: {\n        undo: '撤销',\n        redo: '恢复',\n        paintformat: '格式刷',\n        clearformat: '清除格式',\n        format: '数据格式',\n        font: '字体',\n        fontSize: '字号',\n        fontBold: '加粗',\n        fontItalic: '倾斜',\n        underline: '下划线',\n        strike: '删除线',\n        textColor: '字体颜色',\n        fillColor: '填充颜色',\n        border: '边框',\n        merge: '合并单元格',\n        align: '水平对齐',\n        valign: '垂直对齐',\n        textwrap: '自动换行',\n        freeze: '冻结',\n        autofilter: '自动筛选',\n        add: '显示公式',\n        calc: '开始计算',\n        formula: '函数',\n        more: '更多',\n        throwFormula: '清除公式',\n        comeBack: '返回',\n    },\n    revision: {\n        comeBack: '退出',\n    },\n    contextmenu: {\n        copy: '复制',\n        cut: '剪切',\n        paste: '粘贴',\n        pasteValue: '粘贴数据',\n        pasteFormat: '粘贴格式',\n        insertRow: '插入行',\n        insertColumn: '插入列',\n        deleteRow: '删除行',\n        deleteColumn: '删除列',\n        deleteCell: '删除',\n        deleteCellText: '删除数据',\n        validation: '数据验证',\n        errorPop: '出现问题',\n        recover: '恢复此版本',\n    },\n    format: {\n        normal: '常规',\n        text: '文本',\n        number: '数值',\n        percent: '百分比',\n        rmb: '人民币',\n        usd: '美元',\n        date: '短日期',\n        time: '时间',\n        datetime: '长日期',\n        duration: '持续时间',\n    },\n    date_formula: {\n        sum: '求和',\n        average: '求平均值',\n        max: '求最大值',\n        min: '求最小值',\n        concat: '字符拼接',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: '此值必填',\n        notMatch: '此值不匹配验证规则',\n        between: '此值应在 {} 和 {} 之间',\n        notBetween: '此值不应在 {} 和 {} 之间',\n        notIn: '此值不在列表中',\n        equal: '此值应该等于 {}',\n        notEqual: '此值不应该等于 {}',\n        lessThan: '此值应该小于 {}',\n        lessThanEqual: '此值应该小于等于 {}',\n        greaterThan: '此值应该大于 {}',\n        greaterThanEqual: '此值应该大于等于 {}',\n    },\n    error: {\n        pasteForMergedCell: '无法对合并的单元格执行此操作',\n    },\n    calendar: {\n        weeks: ['日', '一', '二', '三', '四', '五', '六'],\n        months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    },\n    button: {\n        cancel: '取消',\n        remove: '删除',\n        save: '保存',\n        ok: '确认',\n    },\n    sort: {\n        desc: '降序',\n        asc: '升序',\n    },\n    filter: {\n        empty: '空白',\n    },\n    dataValidation: {\n        mode: '模式',\n        range: '单元区间',\n        criteria: '条件',\n        modeType: {\n            cell: '单元格',\n            column: '列模式',\n            row: '行模式',\n        },\n        type: {\n            list: '列表',\n            number: '数字',\n            date: '日期',\n            phone: '手机号',\n            email: '电子邮件',\n        },\n        operator: {\n            be: '在区间',\n            nbe: '不在区间',\n            lt: '小于',\n            lte: '小于等于',\n            gt: '大于',\n            gte: '大于等于',\n            eq: '等于',\n            neq: '不等于',\n        },\n    },\n};\n\n","import {debugout} from \"./debugout\";\nlet bugout = \"\";\ntry {\n    bugout = new debugout();\n} catch (e) {\n\n}\n\nexport {\n    bugout,\n}","/*\n\n    debugout.js\n    by @inorganik\n    \n*/\n\n\n// save all the console.logs\nexport function debugout() {\n    var self = this;\n\n    // OPTIONS\n    self.realTimeLoggingOn = true; // log in real time (forwards to console.log)\n    self.useTimestamps = false; // insert a timestamp in front of each log\n    self.useLocalStorage = true; // store the output using window.localStorage() and continuously add to the same log each session\n    self.recordLogs = true; // set to false after you're done debugging to avoid the log eating up memory\n    self.autoTrim = true; // to avoid the log eating up potentially endless memory\n    self.maxLines = 2500; // if autoTrim is true, this many most recent lines are saved\n    self.tailNumLines = 100; // how many lines tail() will retrieve\n    self.logFilename = 'debugout.txt'; // filename of log downloaded with downloadLog()\n\n    // vars\n    self.depth = 0;\n    self.parentSizes = [0];\n    self.currentResult = '';\n    self.startTime = new Date();\n    self.output = '';\n\n    this.version = function () {\n        return '0.5.0'\n    }\n\n    /*\n        USER METHODS\n    */\n    this.getLog = function () {\n        var retrievalTime = new Date();\n        // if recording is off, so dev knows why they don't have any logs\n        if (!self.recordLogs) {\n            self.log('[debugout.js] log recording is off.');\n        }\n        // if using local storage, get values\n        if (self.useLocalStorage) {\n            var saved = window.localStorage.getItem('debugout.js');\n            if (saved) {\n                saved = JSON.parse(saved);\n                self.startTime = new Date(saved.startTime);\n                self.output = saved.log;\n                retrievalTime = new Date(saved.lastLog);\n            }\n        }\n        return self.output\n            + '\\n---- Log retrieved: ' + retrievalTime + ' ----\\n'\n            + self.formatSessionDuration(self.startTime, retrievalTime);\n    }\n    // accepts optional number or uses the default for number of lines\n    this.tail = function (numLines) {\n        var numLines = numLines || self.tailLines;\n        return self.trimLog(self.getLog(), numLines);\n    }\n    // accepts a string to search for\n    this.search = function (string) {\n        var lines = self.output.split('\\n');\n        var rgx = new RegExp(string);\n        var matched = [];\n        // can't use a simple Array.prototype.filter() here\n        // because we need to add the line number\n        for (var i = 0; i < lines.length; i++) {\n            var addr = '[' + i + '] ';\n            if (lines[i].match(rgx)) {\n                matched.push(addr + lines[i]);\n            }\n        }\n        var result = matched.join('\\n');\n        if (result.length == 0) result = 'Nothing found for \"' + string + '\".';\n        return result\n    }\n    // accepts the starting line and how many lines after the starting line you want\n    this.getSlice = function (lineNumber, numLines) {\n        var lines = self.output.split('\\n');\n        var segment = lines.slice(lineNumber, lineNumber + numLines);\n        return segment.join('\\n');\n    }\n    // immediately downloads the log - for desktop browser use\n    this.downloadLog = function () {\n        var file = \"data:text/plain;charset=utf-8,\";\n        var logFile = self.getLog();\n        var encoded = encodeURIComponent(logFile);\n        file += encoded;\n        var a = document.createElement('a');\n        a.href = file;\n        a.target = '_blank';\n        a.download = self.logFilename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    }\n    // clears the log\n    this.clear = function () {\n        var clearTime = new Date();\n        self.output = '---- Log cleared: ' + clearTime + ' ----\\n';\n        if (self.useLocalStorage) {\n            // local storage\n            var saveObject = {\n                startTime: self.startTime,\n                log: self.output,\n                lastLog: clearTime\n            }\n            saveObject = JSON.stringify(saveObject);\n            window.localStorage.setItem('debugout.js', saveObject);\n        }\n        if (self.realTimeLoggingOn) console.log('[debugout.js] clear()');\n    }\n    // records a log\n    this.log = function (obj) {\n        // log in real time\n        if (self.realTimeLoggingOn) console.log(obj);\n        // record log\n        var type = self.determineType(obj);\n        if (type != null && self.recordLogs) {\n            var addition = obj;\n            // timestamp, formatted for brevity\n            if (self.useTimestamps) {\n                var logTime = new Date();\n                self.output += self.formatTimestamp(logTime);\n            }\n            self.output += addition + '\\n';\n            if (self.autoTrim) self.output = self.trimLog(self.output, self.maxLines);\n            // local storage\n            if (self.useLocalStorage) {\n                var last = new Date();\n                var saveObject = {\n                    startTime: self.startTime,\n                    log: self.output,\n                    lastLog: last\n                }\n                saveObject = JSON.stringify(saveObject);\n                window.localStorage.setItem('debugout.js', saveObject);\n            }\n        }\n        self.depth = 0;\n        self.parentSizes = [0];\n        self.currentResult = '';\n    }\n    /*\n        METHODS FOR CONSTRUCTING THE LOG\n    */\n\n    // like typeof but classifies objects of type 'object'\n    // kept separate from formatType() so you can use at your convenience!\n    this.determineType = function (object) {\n        if (object != null) {\n            var typeResult;\n            var type = typeof object;\n            if (type == 'object') {\n                var len = object.length;\n                if (len == null) {\n                    if (typeof object.getTime == 'function') {\n                        typeResult = 'Date';\n                    }\n                    else if (typeof object.test == 'function') {\n                        typeResult = 'RegExp';\n                    }\n                    else {\n                        typeResult = 'Object';\n                    }\n                } else {\n                    typeResult = 'Array';\n                }\n            } else {\n                typeResult = type;\n            }\n            return typeResult;\n        } else {\n            return null;\n        }\n    }\n    // format type accordingly, recursively if necessary\n    this.formatType = function (type, obj) {\n        switch (type) {\n            case 'Object' :\n                self.currentResult += '{\\n';\n                self.depth++;\n                self.parentSizes.push(self.objectSize(obj));\n                var i = 0;\n                for (var prop in obj) {\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    self.currentResult += prop + ': ';\n                    var subtype = self.determineType(obj[prop]);\n                    var subresult = self.formatType(subtype, obj[prop]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    }\n                    i++;\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += self.indentsForDepth(self.depth);\n                self.currentResult += '}';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'Array' :\n                self.currentResult += '[';\n                self.depth++;\n                self.parentSizes.push(obj.length);\n                for (var i = 0; i < obj.length; i++) {\n                    var subtype = self.determineType(obj[i]);\n                    if (subtype == 'Object' || subtype == 'Array') self.currentResult += '\\n' + self.indentsForDepth(self.depth);\n                    var subresult = self.formatType(subtype, obj[i]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype == 'Array') self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype != 'Object') self.currentResult += '\\n';\n                        else if (i == self.parentSizes[self.depth] - 1) self.currentResult += '\\n';\n                    }\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += ']';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'function' :\n                obj += '';\n                var lines = obj.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    if (lines[i].match(/\\}/)) self.depth--;\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    if (lines[i].match(/\\{/)) self.depth++;\n                    self.currentResult += lines[i] + '\\n';\n                }\n                return self.currentResult;\n                break;\n            case 'RegExp' :\n                return '/' + obj.source + '/';\n                break;\n            case 'Date' :\n            case 'string' :\n                if (self.depth > 0 || obj.length == 0) {\n                    return '\"' + obj + '\"';\n                } else {\n                    return obj;\n                }\n            case 'boolean' :\n                if (obj) return 'true';\n                else return 'false';\n            case 'number' :\n                return obj + '';\n                break;\n        }\n    }\n    this.indentsForDepth = function (depth) {\n        var str = '';\n        for (var i = 0; i < depth; i++) {\n            str += '\\t';\n        }\n        return str;\n    }\n    this.trimLog = function (log, maxLines) {\n        var lines = log.split('\\n');\n        if (lines.length > maxLines) {\n            lines = lines.slice(lines.length - maxLines);\n        }\n        return lines.join('\\n');\n    }\n    this.lines = function () {\n        return self.output.split('\\n').length;\n    }\n    // calculate testing time\n    this.formatSessionDuration = function (startTime, endTime) {\n        var msec = endTime - startTime;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        var hrs = ('0' + hh).slice(-2);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        var mins = ('0' + mm).slice(-2);\n        msec -= mm * 1000 * 60;\n        var ss = Math.floor(msec / 1000);\n        var secs = ('0' + ss).slice(-2);\n        msec -= ss * 1000;\n        return '---- Session duration: ' + hrs + ':' + mins + ':' + secs + ' ----'\n    }\n    this.formatTimestamp = function (timestamp) {\n        var year = timestamp.getFullYear();\n        var date = timestamp.getDate();\n        var month = ('0' + (timestamp.getMonth() + 1)).slice(-2);\n        var hrs = Number(timestamp.getHours());\n        var mins = ('0' + timestamp.getMinutes()).slice(-2);\n        var secs = ('0' + timestamp.getSeconds()).slice(-2);\n        return '[' + year + '-' + month + '-' + date + ' ' + hrs + ':' + mins + ':' + secs + ']: ';\n    }\n    this.objectSize = function (obj) {\n        var size = 0, key;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n    }\n\n    /*\n        START/RESUME LOG\n    */\n    if (self.useLocalStorage) {\n        var saved = window.localStorage.getItem('debugout.js');\n        if (saved) {\n            saved = JSON.parse(saved);\n            self.output = saved.log;\n            var start = new Date(saved.startTime);\n            var end = new Date(saved.lastLog);\n            self.output += '\\n---- Session end: ' + saved.lastLog + ' ----\\n';\n            self.output += self.formatSessionDuration(start, end);\n            self.output += '\\n\\n';\n        }\n    }\n    self.output += '---- Session started: ' + self.startTime + ' ----\\n\\n';\n}","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\nimport zhCN from './locale/zh-cn';\nimport {bugout} from \"./log/log_proxy\";\nimport Drag from \"./external/drag\";\nclass Spreadsheet {\n    constructor(selectors, options = {}, methods = {}, alias = 'sheet1') {\n        let targetEl = selectors;\n          if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.locale('zh-cn', zhCN);\n        this.data = new DataProxy(alias, options, methods);\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n\n        this.sheet = new Sheet(rootEl, this.data);\n        this.data.sheet = this.sheet;\n    }\n\n    setDataSettings(value) {\n        this.data.settings.showEditor = value;\n    }\n\n    loadData(data) {\n        this.sheet.loadData(data);\n        return this;\n    }\n\n    getData() {\n        return this.data.getData();\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.data.change = cb;\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n\n    locale(lang, message) {\n        locale(lang, message);\n    }\n\n    getEditorStatus() {\n        let {editor} = this.sheet;\n        let { ri, ci, pos} = editor;\n        let inputText = editor.editorText.getText();\n        let args = {\n            \"status\": editor.isDisplay(),\n            \"inputText\": inputText,\n            \"ri\": ri,\n            \"ci\": ci,\n            \"pos\": pos,\n        }\n        return args;\n    }\n\n    setEditorText(text = '', pos = 1) {\n        let {editor} = this.sheet;\n        text = text != '' ? text : '=';\n        editor.inputEventHandler(text, pos, true);\n    }\n\n    setTextEnd(cell, ri, ci) {\n        let {editor, data} = this.sheet;\n        editor.setCellEnd({\n            text: cell.text,\n            formulas: cell.formulas\n        });\n        data.setCellAll(ri, ci, cell.formulas + \"\", cell.formulas + \"\", '');\n\n        this.sheet.selectorEditorReset(ri, ci);\n\n        setTimeout(() => {\n            editor.setCursorPos(cell.formulas.length);\n        }, 100)\n    }\n\n    getText(alias, inputText, pos) {\n        let {selectors, data, table} = this.sheet;\n        let text = \"\";\n        for(let i = 0; i < selectors.length; i++) {\n            let {erpx} = selectors[i];\n            text += erpx;\n        }\n        let t = data.getCellByExpr(text, table, alias, inputText, pos);\n\n        return t;\n    }\n\n    removeEvent() {\n        this.sheet.removeEvent();\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.jsSpreadsheet = require('js-spreadsheet');\n    window.drag = Drag;\n    window.x = window.x || {};\n    window.bugout = bugout;\n    window.x.spreadsheet = spreadsheet;\n    window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\nexport default Spreadsheet;\nexport {\n    spreadsheet,\n};\n","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_need_calc_cell = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\nconst CalcCell = require('./CalcCell.js');\nconst checker = require('./formula_check.js');\nconst helper = require(\"../core/helper\")\nconst CalcWorkBook = require('./CalcWorkBook')\nvar mymodule = function(rows, tileArr) {\n    if (helper.isHave(tileArr)){\n        var Calc_WorkBook = new CalcWorkBook(rows, tileArr)\n        var workbook = rows.workbook\n        workbook = Calc_WorkBook.get_workbook(workbook)\n        var formulas = find_all_need_calc_cell(workbook, tileArr, exec_formula)\n        for (var i = formulas.length - 1; i >= 0; i--) {\n            try {\n                var calc_cell = new CalcCell(formulas[i], rows)\n                var valid_res = calc_cell.check_valid()\n                if (valid_res !== true){\n                    formulas[i].cell.v = valid_res\n                }else{\n                    //对cell和sheet进行处理和转换({}参数加上'',未定义单元格置为default_0等)，计算完成后需将多余变动部分还原\n                    formulas[i].cell.f = calc_cell.trans_formula()\n                    checker.trans_sheet(formulas[i].sheet)\n                    exec_formula(formulas[i]);\n                    formulas[i].cell.f = calc_cell.recover_formula()\n                    checker.recover_sheet(formulas[i].sheet)\n                }\n                //如果是多值单元格或公式返回结果为array，进入多单元格处理\n                if (Calc_WorkBook.is_muti_cell(formulas[i]) || Array.isArray(formulas[i].cell.v)){\n                    Calc_WorkBook.deal_muti_cell(workbook, formulas[i])\n                }\n            } catch (e) {\n                console.log(e)\n            }\n        }\n        Calc_WorkBook.calcDoneToSetCells(workbook, rows)\n    }\n\n};\n\nmymodule.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nmymodule.set_fx = exec_formula.set_fx;\nmymodule.exec_fx = exec_formula.exec_fx;\nmymodule.col_str_2_int = col_str_2_int;\nmymodule.int_2_col_str = int_2_col_str;\nmymodule.import_functions = exec_formula.import_functions;\nmymodule.import_raw_functions = exec_formula.import_raw_functions;\nmymodule.xlsx_Fx = exec_formula.xlsx_Fx;\nmymodule.localizeFunctions = exec_formula.localizeFunctions;\n\nmymodule.XLSX_CALC = mymodule\n\nmodule.exports = mymodule;\n","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nclass Range{\n    constructor(str_expression, formula, possition_i){\n        var range_expression, sheet_name, sheet;\n        this.start_pst = possition_i - str_expression.length\n        this.end_pst = possition_i\n\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            range_expression = aux[1];\n            this.range_start_pst = possition_i - aux[1].length\n        }\n        else {\n            sheet_name = formula.sheet_name;\n            range_expression = str_expression;\n            this.range_start_pst = this.start_pst\n\n        }\n        this.sheet = formula.wb.Sheets[sheet_name];\n        this.range_expression = range_expression\n        this.sheet_name = sheet_name\n        this.formula = formula\n\n    }\n    calc(){\n        let sheet_name = this.sheet_name\n        let sheet = this.sheet\n        let range_expression = this.range_expression\n        let formula = this.formula\n        var arr = range_expression.split(':');\n        var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n        var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n        var max_row;\n        if (str_max_row === '' && sheet['!ref']) {\n            str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n        }\n        // the max is 1048576, but TLE\n        max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n        var min_col = col_str_2_int(arr[0]);\n        var max_col = col_str_2_int(arr[1]);\n        var matrix = [];\n        for (var i = min_row; i <= max_row; i++) {\n            var row = [];\n            matrix.push(row);\n            for (var j = min_col; j <= max_col; j++) {\n                var cell_name = int_2_col_str(j) + i;\n                var cell_full_name = sheet_name + '!' + cell_name;\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]);\n                    }\n                    else if (formula.formula_ref[cell_full_name].status === 'working') {\n                        throw new Error('Circular ref');\n                    }\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        return matrix;\n\n    }\n\n}\n\nmodule.exports = Range\n//     function Range(str_expression, formula) { // 这是一个Range 类; 把信息都封装到calc方法里面\n//     var range_expression, sheet_name, sheet;\n//     if (str_expression.indexOf('!') != -1) {\n//         var aux = str_expression.split('!');\n//         sheet_name = getSanitizedSheetName(aux[0]);\n//         range_expression = aux[1];\n//     }\n//     else {\n//         sheet_name = formula.sheet_name;\n//         range_expression = str_expression;\n//     }\n//     sheet = formula.wb.Sheets[sheet_name];\n//     this.range_expression = range_expression\n//     this.sheet_name = sheet_name\n//     console.log(this.range_expression)\n//\n//     this.calc = function() {\n//         var arr = range_expression.split(':');\n//         var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n//         var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n//         var max_row;\n//         if (str_max_row === '' && sheet['!ref']) {\n//             str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n//         }\n//         // the max is 1048576, but TLE\n//         max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n//         var min_col = col_str_2_int(arr[0]);\n//         var max_col = col_str_2_int(arr[1]);\n//         var matrix = [];\n//         for (var i = min_row; i <= max_row; i++) {\n//             var row = [];\n//             matrix.push(row);\n//             for (var j = min_col; j <= max_col; j++) {\n//                 var cell_name = int_2_col_str(j) + i;\n//                 var cell_full_name = sheet_name + '!' + cell_name;\n//                 if (formula.formula_ref[cell_full_name]) {\n//                     if (formula.formula_ref[cell_full_name].status === 'new') {\n//                         formula.exec_formula(formula.formula_ref[cell_full_name]);\n//                     }\n//                     else if (formula.formula_ref[cell_full_name].status === 'working') {\n//                         throw new Error('Circular ref');\n//                     }\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else if (sheet[cell_name]) {\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else {\n//                     row.push(null);\n//                 }\n//             }\n//         }\n//         return matrix;\n//     };\n// };\n","var utils = require('./utils');\nvar error = require('./error');\nvar numeral = require('numeral');\n\n//TODO\nexports.ASC = function(str) {\n  var tmp = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 65248 && str.charCodeAt(i) < 65375) {\n      tmp += String.fromCharCode(str.charCodeAt(i) - 65248);\n    }\n    else {\n      tmp += String.fromCharCode(str.charCodeAt(i));\n    }\n  }\n  return tmp\n};\n\n//TODO\nexports.BAHTTEXT = function() {\n throw new Error('BAHTTEXT is not implemented');\n};\n\nexports.CHAR = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return String.fromCharCode(number);\n};\n\nexports.CLEAN = function(text) {\n  text = text || '';\n  var re = /[\\0-\\x1F]/g;\n  return text.replace(re, \"\");\n};\n\nexports.CODE = function(text) {\n  text = text || '';\n  return text.charCodeAt(0);\n};\n\nexports.CONCATENATE = function() {\n  var args = utils.flatten(arguments);\n\n  var trueFound = 0;\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE';\n  }\n\n  var falseFound = 0;\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE';\n  }\n\n  return args.join('');\n};\n\n//TODO\nexports.DBCS = function() {\n throw new Error('DBCS is not implemented');\n};\n\nexports.DOLLAR = function(number, decimals) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n  var format = '';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n    format = '($0,0)';\n  } else if (decimals > 0) {\n    format = '($0,0.' + new Array(decimals + 1).join('0') + ')';\n  }\n  return numeral(number).format(format);\n};\n\nexports.EXACT = function(text1, text2) {\n  return text1 === text2;\n};\n\nexports.FIND = function (find_text, within_text, position) {\n  position = (position === undefined) ? 0 : position;\n  within_text.indexOf(find_text)\n  return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n};\nexports.FIXED = function(number, decimals, no_commas) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n  no_commas = (no_commas === undefined) ? false : no_commas;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n\n  var format = no_commas ? '0' : '0,0';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n  } else if (decimals > 0) {\n    format += '.' + new Array(decimals + 1).join('0');\n  }\n  return numeral(number).format(format);\n};\n\nexports.HTML2TEXT = function (value) {\n  var result = '';\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach(function (line) {\n        if (result !== '') {\n          result += '\\n';\n        }\n        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\n      });\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '');\n    }\n  }\n\n  return result;\n};\nexports.INDEX = function (matrix, row_num, column_num) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n  return matrix[row_num][column_num-1]\n};\nexports.LEFT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.substring(0, number) : null;\n};\n\nexports.LEN = function(text) {\n  if (arguments.length === 0) {\n    return error.error;\n  }\n\n  if (typeof text === 'string') {\n    return text ? text.length : 0;\n  }\n\n  if (text.length) {\n    return text.length;\n  }\n\n  return error.value;\n};\n\nexports.LOWER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.toLowerCase() : text;\n};\n\nexports.MID = function(text, start, number) {\n  start = utils.parseNumber(start);\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number;\n  }\n\n  var begin = start - 1;\n  var end = begin + number;\n\n  return text.substring(begin, end);\n};\n\n// TODO\nexports.NUMBERVALUE = function (text, decimal_separator, group_separator) {\n  decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;\n  group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;\n  if (text.indexOf('%') > 0){\n    text = text.replace('%', '')\n    return parseFloat(text)/100\n  }\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));\n};\n\n// TODO\nexports.PRONETIC = function() {\n throw new Error('PRONETIC is not implemented');\n};\n\nexports.PROPER = function(text) {\n  if (text === undefined || text.length === 0) {\n    return error.value;\n  }\n  if (text === true) {\n    text = 'TRUE';\n  }\n  if (text === false) {\n    text = 'FALSE';\n  }\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value;\n  }\n  if (typeof text === 'number') {\n    text = '' + text;\n  }\n\n  return text.replace(/\\w\\S*/g, function(txt) {\n    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n  });\n};\n\nexports.REGEXEXTRACT = function (text, regular_expression) {\n  var match = text.match(new RegExp(regular_expression));\n  return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\n};\n\nexports.REGEXMATCH = function (text, regular_expression, full) {\n  var match = text.match(new RegExp(regular_expression));\n  return full ? match : !!match;\n};\n\nexports.REGEXREPLACE = function (text, regular_expression, replacement) {\n  return text.replace(new RegExp(regular_expression), replacement);\n};\n\nexports.REPLACE = function(text, position, length, new_text) {\n  position = utils.parseNumber(position);\n  length = utils.parseNumber(length);\n  if (utils.anyIsError(position, length) ||\n    typeof text !== 'string' ||\n    typeof new_text !== 'string') {\n    return error.value;\n  }\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n};\n\nexports.REPT = function(text, number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return new Array(number + 1).join(text);\n};\n\nexports.RIGHT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return text ? text.substring(text.length - number) : null;\n};\n\nexports.SEARCH = function(find_text, within_text, position) {\n  var foundAt;\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value;\n  }\n  position = (position === undefined) ? 0 : position;\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\n  return (foundAt === 0)?error.value:foundAt;\n};\n\nexports.SPLIT = function (text, separator) {\n  return text.split(separator);\n};\n\nexports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\n  if (!text || !old_text || !new_text) {\n    return text;\n  } else if (occurrence === undefined) {\n    return text.replace(new RegExp(old_text, 'g'), new_text);\n  } else {\n    var index = 0;\n    var i = 0;\n    while (text.indexOf(old_text, index) > 0) {\n      index = text.indexOf(old_text, index + 1);\n      i++;\n      if (i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n      }\n    }\n  }\n};\n\nexports.T = function(value) {\n  if (value == 'TRUE' || value == 'FALSE'){\n    return ''\n  }\n  return (typeof value === \"string\") ? value : '';\n};\n\n// TODO incomplete implementation\nfunction num2e(num){\n  var p = Math.floor(Math.log(num)/Math.LN10);\n  var n = num * Math.pow(10, -p);\n  if (p.toString().length < 10){\n    p = '0' + p\n  }\n  return n + 'E+' + p;\n}\nfunction allzero(num){\n  num = num.toString()\n  for (var i=0;i<num.length;i++){\n    if (num[i] != '0'){\n      return false\n    }\n  }\n  return true\n}\nfunction decimalsToFractional(decimals){\n  formatDecimals = decimals.toFixed(2);\n  var denominator = 3;//初始化分母\n  var numerator  = formatDecimals*3;//初始化分子\n  var bigger = 0;\n  function  recursion (){\n    bigger = denominator>numerator?denominator:numerator;\n    for(let i=bigger;i>1;i--){\n      if(Number.isInteger(numerator/i)&&Number.isInteger(denominator/i)){\n        numerator=numerator/i;\n        denominator=denominator/i;\n        recursion();\n      }\n    }\n  }\n  recursion();\n  numerator = parseInt(numerator)\n  return `${numerator}/${denominator}`\n}\nexports.TEXT = function (value, format) {\n  try{\n    if (format.indexOf('%') >= 0){\n      var fixed = format.split('.')[1].length-1\n      return (parseFloat(value) *100).toFixed(fixed) + '%'\n    }\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    var result = Formulas.TEXT(value, format);\n    console.log(result)\n  }catch (e) {\n    var result = undefined\n  }\n  if (result == undefined){\n    if (format.indexOf('#') >= 0 && format.indexOf('?/?') >=0){\n      var x = parseFloat(value) - parseInt(value);\n      if (parseInt(value) != 0){\n        return parseInt(value) + ' ' + decimalsToFractional(x)\n      }\n      return decimalsToFractional(x)\n    }\n    if (format.indexOf('E+') >=0){\n      return num2e(value)\n    }else if(allzero(value)){\n      var result = ''\n      for (var i=0;i<format.length-value.length; i++){\n        result += '0'\n      }\n      return result + value\n    }else if (format.indexOf('#') >=0){\n      var fmt = format\n      if (format.indexOf('[')>=0 && format.indexOf(';')>=0){\n        var valid = format.split('#')[0]\n        fmt = format.split(']')[1].split(';')\n        valid = valid.replace('[', '').replace(']', '')\n        if (eval(value + valid)){\n          fmt = fmt[0]\n        }else {\n          fmt = fmt[1]\n        }\n      }\n      if (format.indexOf('#') >=0 && format.indexOf('.' >=0) && format.indexOf('0') >=0 && format.indexOf('°') <=0){\n        if (value.toString().split('.')[1].length > format.split('.')[1].length){\n          value = value.toFixed(format.split('.')[1].length)\n        }\n        value = value.toString()\n        var result = ''\n        var n = 0\n        for (var i=0; i< fmt.length; i ++){\n          if (fmt[i] == '#' || fmt[i] == '0' || fmt[i] == '.'){\n            result += value[n]\n            n += 1\n          }else{\n            result += fmt[i]\n          }\n        }\n        return result\n      }\n      fmt = fmt.replace('##0', '##')\n      value = value.toString()\n      var result = ''\n      var n = 0\n      for (var i=0; i< fmt.length; i ++){\n        if (fmt[i] == '#' || fmt[i] == '0'){\n          result += value[n]\n          n += 1\n        }else{\n          result += fmt[i]\n        }\n      }\n      return result\n    }\n  }\n  return result\n};\n\nexports.TRIM = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.replace(/ +/g, ' ').trim();\n};\n\nexports.UNICHAR = function (text) {\n  if (text == 0){\n    return error.value\n  }\n  return String.fromCharCode(text);\n};\n\nexports.UNICODE = function (text){\n  return text.charCodeAt(0)\n}\n\nexports.UPPER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.toUpperCase();\n};\n\nexports.VALUE = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return numeral().unformat(text);\n};\n","var error = require('./error');\n\n// TODO\nexports.CELL = function() {\n throw new Error('CELL is not implemented');\n};\n\nexports.ERROR = {};\nexports.ERROR.TYPE = function (error_val) {\n  switch (error_val) {\n    case error.nil.message:\n      return 1;\n    case error.div0.message:\n      return 2;\n    case error.value.message:\n      return 3;\n    case error.ref.message:\n      return 4;\n    case error.name.message:\n      return 5;\n    case error.num.message:\n      return 6;\n    case error.na.message:\n      return 7;\n    case error.data.message:\n      return 8;\n  }\n  return error.na;\n};\n\n// TODO\nexports.INFO = function() {\n throw new Error('INFO is not implemented');\n};\n\nexports.ISBLANK = function(value) {\n  return value === null;\n};\n\nexports.ISBINARY = function (number) {\n  return (/^[01]{1,10}$/).test(number);\n};\n\nexports.ISERR = function(value) {\n  return ([error.value.message, error.ref.message, error.div0.message, error.num.message, error.name.message, error.nil.message]).indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\n};\n\nexports.ISERROR = function(value) {\n  return exports.ISERR(value) || value === error.na;\n};\n\nexports.ISEVEN = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? false : true;\n};\n\n// TODO\nexports.ISFORMULA = function() {\n  throw new Error('ISFORMULA is not implemented');\n};\n\nexports.ISLOGICAL = function(value) {\n  if(value == 'FALSE'){\n    return false\n  }\n  return value == true || value == false;\n};\n\nexports.ISNA = function(value) {\n  return value === error.na || value === error.na.message;;\n};\n\nexports.ISNONTEXT = function(value) {\n  return typeof(value) !== 'string';\n};\n\nexports.ISNUMBER = function(value) {\n  return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\n};\n\nexports.ISODD = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? true : false;\n};\n\n// TODO\nexports.ISREF = function() {\n  return arguments['0'] != null\n};\n\nexports.ISTEXT = function(value) {\n  return typeof(value) === 'string';\n};\n\nexports.N = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return value;\n  }\n  if (value instanceof Date) {\n    return value.getTime();\n  }\n  if (value === true || value.toString().toUpperCase() == 'TRUE' || value.toString().toUpperCase() == 'FALSE') {\n    return 1;\n  }\n  if (value === false || typeof(value)=='string') {\n    return 0;\n  }\n  if (ISERROR(value)) {\n    return value;\n  }\n  return 0;\n};\n\nexports.NA = function() {\n  return error.na;\n};\n\n\n// TODO\nexports.SHEET = function() {\n  throw new Error('SHEET is not implemented');\n};\n\n// TODO\nexports.SHEETS = function() {\n  throw new Error('SHEETS is not implemented');\n};\n\nexports.TYPE = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return 1;\n  }\n  // if (typeof(value) !== 'string' && isNaN(value)){\n  //   return error.value\n  // }\n  if (typeof(value) === 'string') {\n    if (value.slice(0,1) == '{'){\n      var arr = utils.strToMatrix(value)\n      if (Array.isArray(arr)) {\n        return 64;\n      }\n    }else{\n      return 2\n    }\n  }\n  if(value == 'FALSE'){\n    return false\n  }\n  if (value == true || value == false) {\n    return 4;\n  }\n  if (exports.ISERR(value) || value === error.na) {\n    return 16;\n  }\n  if (Array.isArray(arr)) {\n    return 64;\n  }\n\n};\n","var error = require('./error');\nvar utils = require('./utils');\n\nvar d1900 = new Date(1900, 0, 1);\nvar WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n];\nvar WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n];\nvar WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined, [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n];\n\nexports.DATE = function(year, month, day) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.DATE(year, month, day)\n  // year = utils.parseNumber(year);\n  // month = utils.parseNumber(month);\n  // day = utils.parseNumber(day);\n  // if (utils.anyIsError(year, month, day)) {\n  //   return error.value;\n  // }\n  // if (year < 0 || month < 0 || day < 0) {\n  //   return error.num;\n  // }\n  // var date = new Date(year, month - 1, day);\n  // return date;\n};\n\nexports.DATEVALUE = function(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value;\n  }\n  var date = Date.parse(date_text);\n  if (isNaN(date)) {\n    return error.value;\n  }\n  if (date <= -2203891200000) {\n    return (date - d1900) / 86400000 + 1;\n  }\n  return (date - d1900) / 86400000 + 2;\n};\n\nexports.DAY = function(serial_number) {\n  var date = utils.parseDate(serial_number);\n  if (date instanceof Error) {\n    return date;\n  }\n  return date.getDate();\n};\n\nexports.DAYS = function(end_date, start_date) {\n  end_date = utils.parseDate(end_date);\n  start_date = utils.parseDate(start_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  return serial(end_date) - serial(start_date);\n};\n\nexports.DAYS360 = function(start_date, end_date, method) {\n  method = utils.parseBool(method);\n  start_date = utils.parseDate(start_date);\n  end_date = utils.parseDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (method instanceof Error) {\n    return method;\n  }\n  var sm = start_date.getMonth();\n  var em = end_date.getMonth();\n  var sd, ed;\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();\n  } else {\n    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();\n    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate();\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++;\n        ed = 1;\n      } else {\n        ed = 30;\n      }\n    } else {\n      ed = end_date.getDate();\n    }\n  }\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) +\n    30 * (em - sm) + (ed - sd);\n};\n\nexports.EDATE = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  start_date.setMonth(start_date.getMonth() + months);\n  return serial(start_date);\n};\n\nexports.EOMONTH = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n};\n\nexports.HOUR = function(serial_number) {\n  if (typeof serial_number === 'number' && !isNaN(serial_number)){\n    //XW: 参数为数字时获取对应的小时数\n    return parseInt((parseFloat(serial_number)-parseInt(serial_number)) * 24)\n    //XW: end\n  }\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getHours();\n};\n\nexports.INTERVAL = function (second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value;\n  } else {\n    second = parseInt(second, 10);\n  }\n\n  var year  = Math.floor(second/946080000);\n  second    = second%946080000;\n  var month = Math.floor(second/2592000);\n  second    = second%2592000;\n  var day   = Math.floor(second/86400);\n  second    = second%86400;\n\n  var hour  = Math.floor(second/3600);\n  second    = second%3600;\n  var min   = Math.floor(second/60);\n  second    = second%60;\n  var sec   = second;\n\n  year  = (year  > 0) ? year  + 'Y' : '';\n  month = (month > 0) ? month + 'M' : '';\n  day   = (day   > 0) ? day   + 'D' : '';\n  hour  = (hour  > 0) ? hour  + 'H' : '';\n  min   = (min   > 0) ? min   + 'M' : '';\n  sec   = (sec   > 0) ? sec   + 'S' : '';\n\n  return 'P' + year + month + day +\n  'T' + hour + min + sec;\n};\n\nexports.ISOWEEKNUM = function(date) {\n  date = utils.parseDate(date);\n  if (date instanceof Error) {\n    return date;\n  }\n\n  date.setHours(0, 0, 0);\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n  var yearStart = new Date(date.getFullYear(), 0, 1);\n  return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\n};\n\nexports.MINUTE = function(serial_number) {\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.MINUTE(serial_number);\n};\n\nexports.MONTH = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getMonth() + 1;\n};\n\nexports.NETWORKDAYS = function (start_date, end_date, holidays) {\n  if (holidays instanceof Array){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.NETWORKDAYS(start_date, end_date, holidays);\n};\nexports.NETWORKDAYSINTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays)[0])\n  }\n  try{\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.NETWORKDAYS$INTL(start_date, end_date, weekend, holidays);\n  }catch (e) {\n    start_date = utils.ExcelDateToJSDate(utils.parseDate(start_date));\n    end_date = utils.ExcelDateToJSDate(utils.parseDate(end_date));\n    if (start_date instanceof Error) {\n      return start_date;\n    }\n    if (end_date instanceof Error) {\n      return end_date;\n    }\n    if (weekend === undefined) {\n      weekend = WEEKEND_TYPES[1];\n    } else if (typeof weekend=='string' && weekend.length === 7) {\n      var arr = []\n      for (var i=0;i<weekend.length;i++){\n        if (weekend[i] == '1'){\n          arr.push(((i+1)>6)? 0: i+1)\n        }\n      }\n      weekend = arr\n    }else {\n      weekend = WEEKEND_TYPES[weekend];\n    }\n    if (!(weekend instanceof Array)) {\n      return error.value;\n    }\n    if (holidays === undefined) {\n      holidays = [];\n    } else if (!(holidays instanceof Array)) {\n      holidays = [holidays];\n    }\n    for (var i = 0; i < holidays.length; i++) {\n      var h = utils.parseDate(holidays[i]);\n      if (h instanceof Error) {\n        return h;\n      }\n      holidays[i] = h;\n    }\n    var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n    var total = days;\n    var day = start_date;\n    for (i = 0; i < days; i++) {\n      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n      var dec = false;\n      if (d === weekend[0] || d === weekend[1]) {\n        dec = true;\n      }\n      for (var j = 0; j < holidays.length; j++) {\n        var holiday = holidays[j];\n        if (holiday.getDate() === day.getDate() &&\n          holiday.getMonth() === day.getMonth() &&\n          holiday.getFullYear() === day.getFullYear()) {\n          dec = true;\n          break;\n        }\n      }\n      if (dec) {\n        total--;\n      }\n      day.setDate(day.getDate() + 1);\n    }\n    return total;\n  }\n};\n\n\nexports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays))\n  }\n  start_date = utils.ExcelDateToJSDate(start_date);\n  end_date = utils.ExcelDateToJSDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n  var total = days;\n  var day = start_date;\n  for (i = 0; i < days; i++) {\n    var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n    var dec = false;\n    if (d === weekend[0] || d === weekend[1]) {\n      dec = true;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()) {\n        dec = true;\n        break;\n      }\n    }\n    if (dec) {\n      total--;\n    }\n    day.setDate(day.getDate() + 1);\n  }\n  return total;\n};\n\nexports.NOW = function() {\n  return new Date();\n};\n\nexports.SECOND = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getSeconds();\n};\n\nexports.TIME = function(hour, minute, second) {\n  hour = utils.parseNumber(hour);\n  minute = utils.parseNumber(minute);\n  second = utils.parseNumber(second);\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value;\n  }\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num;\n  }\n  return (3600 * hour + 60 * minute + second) / 86400;\n};\n\nexports.TIMEVALUE = function(time_text) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  try{\n    return Formulas.TIMEVALUE(time_text);\n  }catch(e){\n    return error.value\n  }\n};\n\nexports.TODAY = function() {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.TODAY()\n};\n\nexports.WEEKDAY = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  var day = serial_number.getDay();\n  return WEEK_TYPES[return_type][day];\n};\n\nexports.WEEKNUM = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  if (return_type === 21) {\n    return this.ISOWEEKNUM(serial_number);\n  }\n  var week_start = WEEK_STARTS[return_type];\n  var jan = new Date(serial_number.getFullYear(), 0, 1);\n  var inc = jan.getDay() < week_start ? 1 : 0;\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;\n  return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;\n};\n\nexports.WORKDAY = function (start_date, days, holidays) {\n  if (holidays != undefined){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.WORKDAY(start_date, days, holidays);\n};\nexports.WORKDAYINTL = function (start_date, days, weekend, holidays) {\n  // var Formulas = window.jsSpreadsheet.AllFormulas;\n  // return Formulas.WORKDAY$INTL(start_date, days, weekend, holidays);\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (weekend == 0){\n    return error.num\n  }\n  days = utils.parseNumber(days);\n  if (days instanceof Error) {\n    return days;\n  }\n  if (days < 0) {\n    return error.num;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var d = 0;\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1);\n    var day = start_date.getDay();\n    if (day === weekend[0] || day === weekend[1]) {\n      continue;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()) {\n        d--;\n        break;\n      }\n    }\n    d++;\n  }\n  var year = start_date.getFullYear();\n  var month = start_date.getMonth();\n  var day = start_date.getDay();\n  return year+ '/' + month + '/' + day;\n};\n\nexports.YEAR = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getFullYear();\n};\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1;\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);\n}\n\nexports.YEARFRAC = function(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  end_date = utils.parseDate(end_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n\n  basis = basis || 0;\n  var sd = start_date.getDate();\n  var sm = start_date.getMonth() + 1;\n  var sy = start_date.getFullYear();\n  var ed = end_date.getDate();\n  var em = end_date.getMonth() + 1;\n  var ey = end_date.getFullYear();\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30;\n        ed = 30;\n      } else if (sd === 31) {\n        sd = 30;\n      } else if (sd === 30 && ed === 31) {\n        ed = 30;\n      }\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n    case 1:\n      // Actual/actual\n      var feb29Between = function(date1, date2) {\n        var year1 = date1.getFullYear();\n        var mar1year1 = new Date(year1, 2, 1);\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true;\n        }\n        var year2 = date2.getFullYear();\n        var mar1year2 = new Date(year2, 2, 1);\n        return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);\n      };\n      var ylength = 365;\n      if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) ||\n            feb29Between(start_date, end_date) ||\n            (em === 1 && ed === 29)) {\n          ylength = 366;\n        }\n        return daysBetween(start_date, end_date) / ylength;\n      }\n      var years = (ey - sy) + 1;\n      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;\n      var average = days / years;\n      return daysBetween(start_date, end_date) / average;\n    case 2:\n      // Actual/360\n      return daysBetween(start_date, end_date) / 360;\n    case 3:\n      // Actual/365\n      return daysBetween(start_date, end_date) / 365;\n    case 4:\n      // European 30/360\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n  }\n};\n\nfunction serial(date) {\n  var addOn = (date > -2203891200000)?2:1;\n  return (date - d1900) / 86400000 + addOn;\n}","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","const RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\n\nmodule.exports = function str_2_val(buffer, formula, position_i) { // buffer 在这里是但一个字符串表达式\n    var v;\n    if (!isNaN(buffer)) {\n        v = new RawValue(+buffer);\n    }\n    else if (buffer === 'TRUE') {\n        v = new RawValue(1);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n    }\n    else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n        v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n    }\n    else {\n        v = buffer;\n        v.end_pst = position_i // 后面一个字符的位置\n    }\n    return v;\n};\n","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        var resolved_ref = self.parseRef();\n        var sheet = resolved_ref.sheet;\n        var cell_name = resolved_ref.cell_name;\n        var cell_full_name = resolved_ref.cell_full_name;\n        var ref_cell = sheet[cell_name];\n        if (!ref_cell) {\n            return null;\n        }\n        var formula_ref = formula.formula_ref[cell_full_name];\n        if (formula_ref) {\n            if (formula_ref.status === 'new') {\n                formula.exec_formula(formula_ref);\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error with new formula', cell_full_name);\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n            else if (formula_ref.status === 'working') {\n                throw new Error('Circular ref');\n            }\n            else if (formula_ref.status === 'done') {\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error after formula eval');\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n        }\n        else {\n            if (ref_cell.t === 'e') {\n                console.log('ref is an error with no formula', cell_name);\n                throw new Error(ref_cell.w);\n            }\n            return ref_cell.v;\n        }\n    };\n};\n","var categories = [\n  require('./lib/compatibility'),\n  require('./lib/database'),\n  require('./lib/engineering'),\n  require('./lib/logical'),\n  require('./lib/math-trig'),\n  require('./lib/text'),\n  require('./lib/date-time'),\n  require('./lib/financial'),\n  require('./lib/information'),\n  require('./lib/lookup-reference'),\n  require('./lib/statistical'),\n  require('./lib/miscellaneous'),\n  require('./lib/custom')\n];\n\nfor (var c in categories) {\n  var category = categories[c];\n  for (var f in category) {\n    exports[f] = exports[f] || category[f];\n  }\n}\n","var utils   = require('./utils');\nvar numeral = require('numeral');\n\nexports.UNIQUE = function () {\n  var result = [];\n  for (var i = 0; i < arguments.length; ++i) {\n    var hasElement = false;\n    var element    = arguments[i];\n\n    // Check if we've already seen this element.\n    for (var j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element;\n      if (hasElement) { break; }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\nexports.FLATTEN = utils.flatten;\n\nexports.ARGS2ARRAY = function () {\n  return Array.prototype.slice.call(arguments, 0);\n};\n\nexports.REFERENCE = function (context, reference) {\n  try {\n    var path = reference.split('.');\n    var result = context;\n    for (var i = 0; i < path.length; ++i) {\n      var step = path[i];\n      if (step[step.length - 1] === ']') {\n        var opening = step.indexOf('[');\n        var index = step.substring(opening + 1, step.length - 1);\n        result = result[step.substring(0, opening)][index];\n      } else {\n        result = result[step];\n      }\n    }\n    return result;\n  } catch (error) {}\n};\n\nexports.JOIN = function (array, separator) {\n  return array.join(separator);\n};\n\nexports.NUMBERS = function () {\n  var possibleNumbers = utils.flatten(arguments);\n  return possibleNumbers.filter(function (el) {\n    return typeof el === 'number';\n  });\n};\n\nexports.NUMERAL = function (number, format) {\n  return numeral(number).format(format);\n};","var error = require('./error');\nvar jStat = require('jStat').jStat;\nvar text = require('./text');\nvar utils = require('./utils');\nvar bessel = require('bessel');\n\nfunction isValidBinaryNumber(number) {\n  return (/^[01]{1,10}$/).test(number);\n}\n\nexports.BESSELI = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besseli(x, n);\n};\n\nexports.BESSELJ = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselj(x, n);\n};\n\nexports.BESSELK = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselk(x, n);\n};\n\nexports.BESSELY = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.bessely(x, n);\n};\n\nexports.BIN2DEC = function(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Convert binary number to decimal\n  var result = parseInt(number, 2);\n\n  // Handle negative numbers\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512;\n  } else {\n    return result;\n  }\n};\n\n\nexports.BIN2HEX = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n  }\n\n  // Convert binary number to hexadecimal\n  var result = parseInt(number, 2).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BIN2OCT = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n  }\n\n  // Convert binary number to octal\n  var result = parseInt(number, 2).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BITAND = function(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2;\n};\n\nexports.BITLSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return (shift >= 0) ? number << shift : number >> -shift;\n};\n\nexports.BITOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2;\n};\n\nexports.BITRSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return (shift >= 0) ? number >> shift : number << -shift;\n};\n\nexports.BITXOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2;\n};\n\nexports.COMPLEX = function(real, imaginary, suffix) {\n  real = utils.parseNumber(real);\n  imaginary = utils.parseNumber(imaginary);\n  //XW: 参数报错\n  if (utils.anyIsError(real, imaginary)) {\n    return error.value;\n  }\n  //XW：end\n\n  // Set suffix\n  suffix = (suffix === undefined) ? 'i' : suffix;\n  suffix = suffix.toLowerCase();\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value;\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0;\n  } else if (real === 0) {\n    return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\n  } else if (imaginary === 0) {\n    return real.toString();\n  } else {\n    var sign = (imaginary > 0) ? '+' : '';\n    return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\n  }\n};\n\nexports.CONVERT = function(number, from_unit, to_unit) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  var units = [\n    [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\n    [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\n    [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\n    [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\n    [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\n    [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\n    [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\n    [\"ångström\", \"Å\", [\"ang\"], \"length\", false, true, 1e-10],\n    [\"are\", \"ar\", null, \"area\", false, true, 100],\n    [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\n    [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\n    [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\n    [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\n    [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\n    [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\n    [\"byte\", \"byte\", null, \"information\", false, true, 8],\n    [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\n    [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\n    [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\n    [\"cubic ångström\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\n    [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\n    [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\n    [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\n    [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\n    [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\n    [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\n    [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\n    [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\n    [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\n    [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\n    [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\n    [\"degree\", \"°\", null, \"angle\", false, false, 0.0174532925199433],\n    [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\n    [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\n    [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\n    [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\n    [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\n    [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\n    [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\n    [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\n    [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\n    [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\n    [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\n    [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\n    [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\n    [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\n    [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\n    [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\n    [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\n    [\"henry\", \"H\", null, \"inductance\", true, false, 1],\n    [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\n    [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\n    [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\n    [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\n    [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\n    [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\n    [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\n    [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\n    [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\n    [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\n    [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\n    [\"joule\", \"J\", null, \"energy\", true, true, 1],\n    [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\n    [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\n    [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\n    [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\n    [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\n    [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\n    [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\n    [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\n    [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\n    [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\n    [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\n    [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\n    [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\n    [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\n    [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\n    [\"metre\", \"m\", null, \"length\", true, true, 1],\n    [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\n    [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\n    [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\n    [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\n    [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\n    [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\n    [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\n    [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\n    [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\n    [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1],\n    [\"newton\", \"N\", null, \"force\", true, true, 1],\n    [\"œrsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\n    [\"ohm\", \"Ω\", null, \"electric_resistance\", true, false, 1],\n    [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\n    [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\n    [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\n    [\"pferdestärke\", \"PS\", null, \"power\", false, true, 735.49875],\n    [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\n    [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\n    [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\n    [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\n    [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\n    [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\n    [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\n    [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\n    [\"radian\", \"rad\", null, \"angle\", true, false, 1],\n    [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\n    [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\n    [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\n    [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\n    [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\n    [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\n    [\"square ångström\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\n    [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\n    [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\n    [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\n    [\"square meter\", \"m?\", null, \"area\", true, true, 1],\n    [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\n    [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\n    [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\n    [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\n    [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\n    [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\n    [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\n    [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\n    [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\n    [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\n    [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\n    [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\n    [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\n    [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\n    [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\n    [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\n    [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\n    [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\n    [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\n    [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\n    [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\n    [\"volt\", \"V\", null, \"voltage\", true, false, 1],\n    [\"watt\", \"W\", null, \"power\", true, true, 1],\n    [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\n    [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\n    [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\n    [\"year\", \"yr\", null, \"time\", false, true, 31557600]\n  ];\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  var binary_prefixes = {\n    Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n    Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n    Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n    Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n    Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n    Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n    Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n    ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n  };\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  var unit_prefixes = {\n    Y: [\"yotta\", 1e+24, \"Y\"],\n    Z: [\"zetta\", 1e+21, \"Z\"],\n    E: [\"exa\", 1e+18, \"E\"],\n    P: [\"peta\", 1e+15, \"P\"],\n    T: [\"tera\", 1e+12, \"T\"],\n    G: [\"giga\", 1e+09, \"G\"],\n    M: [\"mega\", 1e+06, \"M\"],\n    k: [\"kilo\", 1e+03, \"k\"],\n    h: [\"hecto\", 1e+02, \"h\"],\n    e: [\"dekao\", 1e+01, \"e\"],\n    d: [\"deci\", 1e-01, \"d\"],\n    c: [\"centi\", 1e-02, \"c\"],\n    m: [\"milli\", 1e-03, \"m\"],\n    u: [\"micro\", 1e-06, \"u\"],\n    n: [\"nano\", 1e-09, \"n\"],\n    p: [\"pico\", 1e-12, \"p\"],\n    f: [\"femto\", 1e-15, \"f\"],\n    a: [\"atto\", 1e-18, \"a\"],\n    z: [\"zepto\", 1e-21, \"z\"],\n    y: [\"yocto\", 1e-24, \"y\"]\n  };\n\n  // Initialize units and multipliers\n  var from = null;\n  var to = null;\n  var base_from_unit = from_unit.toLowerCase();\n  var base_to_unit = to_unit.toLowerCase();\n  var from_multiplier = 1;\n  var to_multiplier = 1;\n  var alt;\n  // Lookup from and to units\n  for (var i = 0; i < units.length; i++) {\n    alt = (units[i][2] === null) ? [] : units[i][2];\n    if (units[i][1].toLowerCase() === base_from_unit || alt.indexOf(from_unit) >= 0) {\n      from = units[i];\n    }\n    if (units[i][1].toLowerCase() === base_to_unit || alt.indexOf(to_unit) >= 0) {\n      to = units[i];\n    }\n  }\n  // Lookup from prefix\n  if (from === null) {\n    var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n    var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2];\n      base_from_unit = from_unit.substring(2);\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1];\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n    }\n\n    // Lookup from unit\n    for (var j = 0; j < units.length; j++) {\n      alt = (units[j][2] === null) ? [] : units[j][2];\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j];\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n    var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2];\n      base_to_unit = to_unit.substring(2);\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1];\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n    }\n\n    // Lookup to unit\n    for (var k = 0; k < units.length; k++) {\n      alt = (units[k][2] === null) ? [] : units[k][2];\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k];\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na;\n  }\n\n  //Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    if(from_unit == 'F' && to_unit == 'C'){\n      return (number-32)/1.8\n    }\n    if(from_unit == 'C' && to_unit == 'F'){\n      return number * 1.8 + 32\n    }\n    return error.na;\n  }\n\n  // Return converted number\n  return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n};\n\nexports.DEC2BIN = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = parseInt(number, 10).toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2HEX = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = parseInt(number, 10).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2OCT = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = parseInt(number, 10).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DELTA = function(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = (number2 === undefined) ? 0 : number2;\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return delta\n  return (number1 === number2) ? 1 : 0;\n};\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexports.ERF = function(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = (upper_bound === undefined) ? 0 : upper_bound;\n\n  lower_bound = utils.parseNumber(lower_bound);\n  upper_bound = utils.parseNumber(upper_bound);\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value;\n  }\n\n  return jStat.erf(lower_bound);\n};\n\n// TODO\nexports.ERF.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERF(x)\n};\n\nexports.ERFC = function(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value;\n  }\n\n  return jStat.erfc(x);\n};\n\n// TODO\nexports.ERFC.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERFC(x)\n};\n\nexports.GESTEP = function(number, step) {\n  step = step || 0;\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(step, number)) {\n    return number;\n  }\n\n  // Return delta\n  return (number >= step) ? 1 : 0;\n};\n\nexports.HEX2BIN = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\n\n  // Convert hexadecimal number to decimal\n  var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.HEX2DEC = function(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return decimal number\n  return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\n};\n\nexports.HEX2OCT = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = decimal.toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\nexports.ROWS = function (matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\nfunction trans_num(inumber){\n  inumber = inumber.toString()\n  inumber = inumber.replace('I', 'i').replace('J', 'j')\n  return inumber\n}\nexports.IMABS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n};\n\nexports.IMAGINARY = function (inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1;\n  }\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(plus + 1, inumber.length - 1));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        -Number(inumber.substring(minus + 1, inumber.length - 1));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\n    } else {\n      return (isNaN(inumber)) ? error.num : 0;\n    }\n  }\n};\n\nexports.IMARGUMENT = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0;\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2;\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI;\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x);\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI;\n  } else {\n    return Math.atan(y / x) - Math.PI;\n  }\n};\n\nexports.IMCONJUGATE = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return conjugate of complex number\n  return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\n};\n\nexports.IMCOS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return cosine of complex number\n  return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMCOSH = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic cosine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n};\n\nexports.IMCOT = function (inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return cotangent of complex number\n  return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n};\n\nexports.IMDIV = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num;\n  }\n\n  // Return exponential of complex number\n  var den = c * c + d * d;\n  return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n};\n\nexports.IMEXP = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  var e = Math.exp(x);\n  return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n};\n\nexports.IMLN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n};\n\nexports.IMLOG10 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n};\n\nexports.IMLOG2 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n};\n\nexports.IMPOWER = function(inumber, number) {\n  inumber = trans_num(inumber)\n  number = utils.parseNumber(number);\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n  if (utils.anyIsError(number, x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var p = Math.pow(exports.IMABS(inumber), number);\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n};\n\nexports.IMPRODUCT = function() {\n  // Initialize result\n  var result = arguments[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(arguments[i]);\n    var d = exports.IMAGINARY(arguments[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n  }\n\n  // Return product of complex numbers\n  return result;\n};\n\nexports.IMREAL = function(inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0;\n  }\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, plus));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, minus));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\n    } else {\n      return (isNaN(inumber)) ? error.num : inumber;\n    }\n  }\n};\n\nexports.IMSEC = function(inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return secant of complex number\n  return exports.IMDIV('1', exports.IMCOS(inumber));\n};\n\nexports.IMSECH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return hyperbolic secant of complex number\n  return exports.IMDIV('1', exports.IMCOSH(inumber));\n};\n\nexports.IMSIN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return sine of complex number\n  return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMSINH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic sine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n};\n\nexports.IMSQRT = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var s = Math.sqrt(exports.IMABS(inumber));\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n};\n\nexports.IMCSC = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return cosecant of complex number\n  return exports.IMDIV('1', exports.IMSIN(inumber));\n};\n\nexports.IMCSCH = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return exports.IMDIV('1', exports.IMSINH(inumber));\n};\n\nexports.IMSUB = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber1 = trans_num(inumber1)\n  inumber2 = trans_num(inumber2)\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return _ of two complex numbers\n  return exports.COMPLEX(a - c, b - d, unit);\n};\n\nexports.IMSUM = function (inumber) {\n  inumber = trans_num(inumber)\n  var args = utils.flatten(arguments);\n\n  // Initialize result\n  var result = args[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(args[i]);\n    var d = exports.IMAGINARY(args[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a + c, b + d);\n  }\n\n  // Return sum of complex numbers\n  return result;\n};\n\nexports.IMTAN = function (inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return tangent of complex number\n  return exports.IMDIV(exports.IMSIN(inumber), exports.IMCOS(inumber));\n};\n\nexports.OCT2BIN = function (number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\n\n  // Convert octal number to decimal\n  var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\n\n  // Return error if number is lower than -512 or greater than 511\n  // if (decimal < -512 || decimal > 511) {\n  //     return error.num;\n  // }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n  if (result.length >=10){\n    return result.slice(result.length-10, result.length)\n  }\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.OCT2DEC = function(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Return decimal number\n  return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\n};\n\nexports.OCT2HEX = function(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = decimal.toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};","\"use strict\";\nmodule.exports = function find_all_need_calc_cell(wb, tileArr, exec_formula) {\n    var need_calc_cells = tileArr.findAllNeedCalcCell()\n    let formula_ref = {};\n    let cells = [];\n    for (let sheet_name in wb.Sheets) {\n        let sheet = wb.Sheets[sheet_name];\n        for(let i=0; i<need_calc_cells.length; i++){\n            let cell_name = need_calc_cells[i]\n            let formula = formula_ref[sheet_name + '!' + cell_name] = {\n                formula_ref: formula_ref,\n                wb: wb,\n                sheet: sheet,\n                sheet_name: sheet_name,\n                cell: sheet[cell_name],\n                name: cell_name,\n                status: 'new',\n                exec_formula: exec_formula\n            };\n            cells.push(formula);\n        }\n    }\n    return cells;\n};\n","var helper = require(\"../core/helper\")\n//XW: end\n//XW:大括号参数判断,有大括号参数用''包起来作为一个参数\nexports.trans_params = function (cell) {\n  var reg = new RegExp('\\{(.*?)\\}', 'g')\n  var arg = cell.f.match(reg)\n  if (arg != null){\n    for (var i=0; i<arg.length; i++){\n      var param = arg[i]\n      var rep = \"'\" + param + \"'\"\n      cell.f = cell.f.replace(param, rep)\n    }\n  }\n  return cell\n}\n//XW:end\n//XW: 将空单元格置为default_0\nexports.trans_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 0 && sheet[i].f === \"\"){\n      sheet[i].v = 'default_0'\n    }\n  });\n  return sheet\n}\n\nexports.recover_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 'default_0'){\n      if (!helper.isHave(sheet[i].f)) {\n        sheet[i].f = \"\"\n      }\n      sheet[i].v = 0\n    }\n  });\n  return sheet\n}\n//XW: end\n//XW: 去除公式开头结尾的空格\nexports.strim = function (str){\n  let str1 = str.replace(/\\s+$/,'');\n  let str2 = str1.replace(/^\\s+/,'')\n  return str2;\n}\n//XW： end\n\n//xW: 公式参数转换\nexports.trans_formula = function(f){\n  //特殊公式转换 FLOOR->FLOORMATH, vap-> vara等\n  var trans_dict = {\n    'FLOOR': 'FLOORMATH',\n    'VAR': 'VARA',\n    'WORKDAY.INTL': 'WORKDAYINTL'\n  }\n  for(var i in trans_dict){\n    var b = trans_dict[i]\n    if (f.indexOf(b) < 0 && f.indexOf(i)>=0 && f.indexOf(i + '.') <=0){\n      f = f.replace(i, b)\n    }\n  }\n  //_XLFN. 开头的函数去掉开头\n  f = f.replace('_XLFN.', '')\n  //将函数公式中除\"\"中的其他部分转成大写\n  var reg = new RegExp('\"(.*?)\"', 'g')\n  var arg = f.match(reg)\n  if (f.indexOf('=') === 0){\n    f = f.toUpperCase()\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i].toUpperCase()\n        if(f.indexOf(param) >= 0){\n          f = f.replace(param, arg[i])\n        }\n      }\n    }\n  }\n  return f\n}\n//xW:end\n","exports.nil = new Error('#NULL!');\nexports.div0 = new Error('#DIV/0!');\nexports.value = new Error('#VALUE?');\nexports.ref = new Error('#REF!');\nexports.name = new Error('#NAME?');\nexports.num = new Error('#NUM!');\nexports.na = new Error('#N/A');\nexports.error = new Error('#ERROR!');\nexports.data = new Error('#GETTING_DATA');\n"],"sourceRoot":""}