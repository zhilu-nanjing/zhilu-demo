{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/core/alphabet.js","webpack:///./src/calc/formulajs/lib/utils.js","webpack:///./src/model/pre_action.js","webpack:///./src/calc/RawValue.js","webpack:///./src/calc/exec_formula.js","webpack:///./src/calc/expression_builder.js","webpack:///./src/calc/Exp.js","webpack:///./src/calc/UserFnExecutor.js","webpack:///./src/calc/UserRawFnExecutor.js","webpack:///./src/calc/formulajs/lib/compatibility.js","webpack:///./src/core/helper.js","webpack:///./src/calc/formulajs/lib/expression.js","webpack:///./src/calc/formulajs/lib/database.js","webpack:///./src/calc/formulajs/lib/logical.js","webpack:///./src/calc/formulajs/lib/financial.js","webpack:///./src/calc/formulajs/lib/lookup-reference.js","webpack:///./src/calc/formulajs/lib/custom.js","webpack:///./src/calc/formulas-raw.js","webpack:///./src/calc/Calculator.js","webpack:///./src/calc/formulajs/lib/math-trig.js","webpack:///./src/calc/CalcCell.js","webpack:///./src/calc/CalcWorkBook.js","webpack:///./src/calc/es6.js","webpack:///./src/calc/formulajs/lib/statistical.js","webpack:///./src/calc/utils.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/calc/index.js","webpack:///./src/calc/int_2_col_str.js","webpack:///./src/component/element.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/formula.js","webpack:///./src/core/cell_range.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/recast.js","webpack:///./src/core/paste_proxy.js","webpack:///./src/core/cell_proxy.js","webpack:///./src/model/cell_prop.js","webpack:///./src/model/cell.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/event/move.js","webpack:///./src/component/event.js","webpack:///./src/config.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector_cell.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/suggest_content.js","webpack:///./src/component/selector_move.js","webpack:///./src/component/selector_copy.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/formula_editor.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/utils/number_util.js","webpack:///./src/canvas/draw.js","webpack:///./src/utils/test.js","webpack:///./src/component/table.js","webpack:///./src/component/editor_text.js","webpack:///./src/component/editor.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/core/format.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/history_border.js","webpack:///./src/component/dropdown_action.js","webpack:///./src/component/toolbar.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/button.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/advice.js","webpack:///./src/event/copy.js","webpack:///./src/component/website.js","webpack:///./src/core/special_formula_process.js","webpack:///./src/component/error_pop_up.js","webpack:///./src/core/rect_proxy.js","webpack:///./src/model/Timer.js","webpack:///./src/component/sheet.js","webpack:///./src/external/drag.js","webpack:///./src/external/resize.js","webpack:///./src/core/table_proxy.js","webpack:///./src/event/paste.js","webpack:///./src/utils/date.js","webpack:///./src/core/multi_pre_action.js","webpack:///./src/model/paint_format.js","webpack:///./src/core/data_proxy.js","webpack:///./src/locale/zh-cn.js","webpack:///./src/log/log_proxy.js","webpack:///./src/log/debugout.js","webpack:///./src/index.js","webpack:///./src/calc/col_str_2_int.js","webpack:///./src/calc/Range.js","webpack:///./src/calc/formulajs/lib/text.js","webpack:///./src/calc/formulajs/lib/information.js","webpack:///./src/calc/formulajs/lib/date-time.js","webpack:///./src/calc/getSanitizedSheetName.js","webpack:///./src/calc/str_2_val.js","webpack:///./src/calc/RefValue.js","webpack:///./src/calc/formulajs/index.js","webpack:///./src/calc/formulajs/lib/miscellaneous.js","webpack:///./src/calc/formulajs/lib/engineering.js","webpack:///./src/calc/find_all_cells_with_formulas.js","webpack:///./src/calc/formula_check.js","webpack:///./src/calc/formulajs/lib/error.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","alphabets","stringAt","index","str","cindex","parseInt","last","indexAt","ret","charCodeAt","exponet","expr2xy","src","x","y","charAt","xy2expr","ab","error","require","flattenShallow","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","isFlat","parse","Error","arr","flatten","argsToArray","arguments","args","numbers","possibleNumbers","filter","el","flattenNum","div0","undefined","cleanFloat","number","Math","round","parseBool","bool","up","toUpperCase","Date","isNaN","parseNumber","string","parseFloat","parseNumberArray","len","parsed","parseMatrix","matrix","pnarr","d1900","parse_arg","arg","replace","parseDate","date","num","getTime","Copy","obj","copy","setTime","clone","attr","strToMatrix","split","toString","indexOf","ExcelDateToJSDate","utils","issue","isNumber","val","test","parseDateArray","this","anyIsError","arrayValuesToNumbers","rest","idx","initial","getCellDepend","cells","isHave","expr","cell","depend","multivalueRefsCell","PreAction","type","action","ri","ci","oldData","newData","oldStep","cellRange","height","width","oldCell","newCell","newMergesData","oldMergesData","changeArr","distinct","sheet","isRedo","_cell","deepCopy","rows","setCellText","_data","setData","_cells","merges","setHeight","cols","setWidth","setValue","v","calc","expression_builder","xlsx_Fx","xlsx_raw_Fx","import_raw_functions","functions","opts","import_functions","formulajs","prefix","override","my_assign","dest","source","JSON","stringify","k","build_expression","formula","exec_formula","update_cell_value","set_fx","fn","exec_fx","localizeFunctions","dic","newName","oldName","Exp","RawValue","UserFnExecutor","UserRawFnExecutor","common_operations","status","root_exp","str_formula","f","substr","exp_obj","buffer","was_string","fn_stack","exp","char","state","start","single_quote","stack","trim_buffer","trim","special","special_raw","sheet_name","ini_parentheses","pop","position_i","Range","str_2_val","MS_PER_DAY","exp_id","last_arg","self","isEmpty","checkVariable","exec","op","as","e","id","errorValues","message","w","str_expression","datedifference","exec_minus","pow","toLowerCase","user_function","map","mathTrig","statistical","engineering","dateTime","set","root","BETADIST","BETA","DIST","BETAINV","INV","BINOMDIST","BINOM","CEILING","ISOCEILING","MATH","CEILINGMATH","CEILINGPRECISE","PRECISE","CHIDIST","CHISQ","CHIDISTRT","RT","CHIINV","CHIINVRT","CHITEST","TEST","CONFIDENCE","NORM","COVAR","COVARIANCE","P","COVARIANCEP","COVARIANCES","S","CRITBINOM","EXPONDIST","EXPON","ERFCPRECISE","ERFC","ERFPRECISE","ERF","FDIST","F","FDISTRT","FINVRT","FINV","FLOORMATH","FLOORPRECISE","FLOORPRACE","FTEST","GAMMADIST","GAMMA","GAMMAINV","GAMMALNPRECISE","GAMMALN","HYPGEOMDIST","HYPGEOM","LOGINV","LOGNORM","LOGNORMINV","LOGNORMDIST","MODE","SNGL","MODEMULT","MULT","MODESNGL","NEGBINOMDIST","NEGBINOM","NETWORKDAYSINTL","NORMDIST","NORMINV","NORMSDIST","NORMSINV","PERCENTILE","EXC","PERCENTILEEXC","PERCENTILEINC","INC","PERCENTRANK","PERCENTRANKEXC","PERCENTRANKINC","POISSON","POISSONDIST","QUARTILE","QUARTILEEXC","QUARTILEINC","RANK","EQ","RANKAVG","AVG","RANKEQ","SKEWP","SKEW","STDEV","STDEVP","STDEVS","TDIST","T","TDISTRT","TINV","TTEST","VARP","VAR","VARS","WEIBULL","WEIBULLDIST","WORKDAYINTL","ZTEST","Z","_XLFN","FLOOR","mergeDeep","sources","forEach","keys","find","isOusideViewRange","dy","dx","orien","param","inputData","cloneDeep","merge","equals","obj1","obj2","v1","v2","ai","arrayEquals","a1","a2","sum","objOrAry","cb","total","size","rangeSum","min","max","getv","rangeReduceIf","inits","initv","ifv","defaultOperator","validSymbols","TOKEN_TYPE_OPERATOR","TOKEN_TYPE_LITERAL","SUPPORTED_TOKENS","createToken","analyzeTokens","tokens","literalValue","analyzedTokens","token","unshift","expression","expressionLength","cursorIndex","processedValue","processedSymbol","tokenizeExpression","compute","operator","values","evaluate","stats","maths","compact","find_result_idx","database","criteria","valid_arr","filter_arr","valid_str","result_idx","is_valid","eval","get_values","resultIndexes","field","field_idx","FINDFIELD","title","DAVERAGE","targetValues","DCOUNT","COUNT","DCOUNTA","COUNTA","DGET","DMAX","DMIN","DPRODUCT","DSTDEV","DSTDEVP","DSUM","SUM","DVAR","DVARP","information","AND","CHOOSE","na","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","ISERROR","IFNA","value_if_na","NOT","logical","OR","TRUE","XOR","floor","abs","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","validDate","ACCRINT","first","settlement","rate","par","frequency","basis","YEARFRAC","ACCRINTM","AMORDEGRC","cost","date_purchased","first_period","salvage","period","AMORLINC","COUPDAYBS","maturity","COUPDAYS","COUPDAYSNC","COUPNCD","numerror","COUPNUM","COUPPCD","CUMIPMT","periods","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","life","month","toFixed","current","ceiling","DDB","factor","DISC","pr","redemption","DAYS","DOLLARDE","dollar","fraction","ceil","log","LN10","power","LN2","DOLLARFR","DURATION","coupon","yld","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","investment","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","negative","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","den","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","day","discount","PRICEDISC","PRICEMAT","dsm","PV","RATE","iter","close","t1","t2","Number","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","DAYS360","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","match_less_than_or_equal","lookupValue","indexValue","match_exactly_string","match_exactly_non_string","match_greater_than_or_equal","MATCH","matchType","VLOOKUP","return_index","cumulative","HLOOKUP","needle","table","exactmatch","row","City","url","PQUERY","absArr","o1","sort","val1","val2","items","count","a4","city","area","HYPERLINK","console","lianjia","lianJiaUrl","woaiwojia","woaiwojiaUrl","fangtianxia","fangtianxiaUrl","int_2_col_str","col_str_2_int","RefValue","cell_ref","columns","ref_value","parsed_ref","parseRef","col","cell_name","col_str","end_range","onerrorvalue","Infinity","condition","_then","_else","find_all_cells_with_formulas","Calculator","workbook","expressions","variables","formulas","calcNames","var_name","variable","setVarOfExpression","vars","Workbook","Names","item","getRef","Ref","Name","ref_name","formula_ref","wb","numeric","ABS","ACOS","acos","ACOSH","sqrt","ACOT","atan","ACOTH","AGGREGATE","function_num","options","ref1","ref2","AVERAGE","MAX","MIN","PRODUCT","MEDIAN","LARGE","SMALL","ARABIC","text","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","join","significance","precision","ROUND","COMBIN","number_chosen","FACT","COMBINA","COS","cos","COSH","COT","tan","COTH","e2","CSC","sin","CSCH","DECIMAL","DEGREES","PI","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","places","GCD","range","r0","INT","ISO","LCM","LN","LOG","base","LOG10","MDETERM","det","MINVERSE","inv","MMULT","matrix1","matrix2","dot","MOD","dividend","divisor","modulus","MROUND","multiple","MULTINOMIAL","MUNIT","dimension","identity","ODD","temp","POWER","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","top","ROMAN","digits","String","roman","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","function_code","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","value1","value2","NE","POW","exponent","argsKeys","elt","SUMIF","SUMIFS","s_arr","compareValue","lastIndexOf","resultArr","enter","SUMPRODUCT","product","_i","_ij","arrays","SUMSQ","ISNUMBER","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","checker","CalcCell","formulas_i","match","fml","reg","RegExp","rep","strim","trans_formula","trans_params","CalcWorkBook","tileArr","need_calc_cells","findAllNeedCalcCell","zb","getCell","Sheets","source_v","setCell","cell_v","cell_zb","cell_x","cell_y","clean_matrix","ref","clean_all_flag","process_arr","process_matrix","jStat","misc","evalExpression","AVEDEV","subtract","mean","AVERAGEA","AVERAGEIF","average_range","average_count","isWildcard","tokenizedCriteria","filter_criteria","AVERAGEIFS","criteriaLength","isMeetCondition","computedResult","average","alpha","beta","A","B","cdf","pdf","probability","successes","trials","binomial","chisquare","observed","expected","tmp","dof","xsqr","Pi","ChiSq","COLUMN","col_list","COLUMNS","sd","normalci","tci","IFS","cond","CORREL","array1","array2","corrcoeff","COUNTBLANK","COUNTIN","element","blanks","COUNTIF","matches","COUNTIFS","results","COUNTUNIQUE","UNIQUE","mean1","mean2","covariance","DEVSQ","lambda","exponential","d1","d2","centralF","sumOfSquares","x1","x2","FISHER","FISHERINV","e2y","FORECAST","data_y","data_x","xmean","ymean","FREQUENCY","bins","gammafn","gamma","gammaln","GAUSS","z","normal","GEOMEAN","geomean","GROWTH","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","HARMEAN","N","INTERCEPT","KURT","sigma","stdev","LINEST","LOGEST","lognormal","MAXA","arr2","median","MINA","currentItem","maxItems","negbin","PEARSON","den1","den2","fl","uniques","PERMUT","PERMUTATIONA","PHI","poisson","PROB","lower","upper","sorted","quart","order","ROW","ROWS","RSQ","m2","m3","SLOPE","STANDARDIZE","STDEVA","VARA","STDEVPA","VARPA","STEYX","lft","TRANSPOSE","transpose","df","studentt","mean_x","mean_y","s_x","s_y","TREND","new_data_x","linest","TRIMMEAN","percent","helper","Rows2Workbook","_","webpackContext","req","webpackContextResolve","code","resolve","find_all_need_calc_cell","es6","mymodule","Calc_WorkBook","get_workbook","calc_cell","valid_res","check_valid","trans_sheet","recover_formula","recover_sheet","is_muti_cell","deal_muti_cell","calcDoneToSetCells","calculator","XLSX_CALC","modulo","columnName","guard","fromCharCode","Element","tag","className","document","createElement","eventNames","handler","fen","oen","eventName","navigator","userAgent","addEventListener","evt","button","stopPropagation","css","offsetTop","left","offsetLeft","offsetHeight","offsetWidth","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","childNodes","ele","child","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","removeChild","getComputedStyle","h","$lang","$messages","en","toolbar","undo","redo","paintformat","clearformat","format","font","fontSize","fontBold","fontItalic","underline","strike","textColor","fillColor","border","align","valign","textwrap","freeze","autofilter","more","flexible","throwFormula","comeBack","contextmenu","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteRow","deleteColumn","deleteCell","deleteCellText","validation","recover","rmb","usd","time","datetime","duration","date_formula","wland","wfr","rtd","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","pasteForMergedCell","calendar","weeks","months","cancel","save","ok","desc","asc","empty","dataValidation","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","spreadsheet","tf","locale","lang","baseFormulas","render","ary","formulaCalc","formulam","CellRange","sri","sci","eri","eci","refs","rowFilter","other","pos","addRet","dsr","dsc","der","dec","sarr","darr","each","Selector","Scroll","Clipboard","Filter","includes","Sort","AutoFilter","filters","flex","fitlers","it","getData","getFilter","hrange","exceptRowSet","rir","ix","set_total","cic","rset","Set","fset","ctext","valueOf","Merges","cr","within","intersects","union","deleteWithin","cbWithin","rn","cn","it1","recast","Recast","ast","preProcess","PasteProxy","srcCellRange","dstCellRange","srcOneDRange","dstOneDRange","dsri","dsci","deri","deci","drn","dcn","use","isLeftRight","isDown","getRangeByWay","line","way","offset","isAdd","diffValue","last2","CellProxy","nrindex","cellText","formatInfo","tryParseToNum","isDate","ncell","nA","isFormula","search","str2Re","datePattern2","CellProp","Cell","formatText","calcUtils","otherAutoFilter","direction","what","dri","getCellByTopCell","iText","calcFormulaCellByTopCell","calcCellByTopCell","numberAutoFilter","calcNumberCellByTopCell","dateAutoFilter","diff","calcDateCellByTopCell","Rows","pasteProxy","getOrNew","exceptSet","has","getHeight","sumHeight","isSheetVale","to_calc_num","getDependCell","setFormatText","cutStr","mergeCellExpr","mergeArr","refCell","isAbsoluteValue","e1","getCellOrNew","arr3","s1","changeFormula","ca","setCellAll","value2absolute","es","s3","s2","re","cellStyle","isValid","isInsert","ds","dei","dci","isRows","cellProp","bad","newStr","getCellTextIsAdd","ds1","ds2","sp","und","getCellDataType","last1","formatMoney","copyRender","strList","splitStr","getRangeByTopCell","getCellTextByShift","updateCellReferenceByShift","word","dayjs","getCellByCell","setSrcAndDstCellRange","autoFilterDirection","upOrDown","getOneDRangeObj","getAllDataType","getLocationArray","leftOrRight","calcDiff","nri","nci","srcCell","eachCells","ndata","rndata","entries","isReferOtherSheet","out","rowsInit","init","change","timeEnd","assign","Cols","indexWidth","minWidth","getWidth","sumWidth","rules","returnMessage","Validator","parseValue","Validation","validator","nrefs","difference","Validations","errors","Map","validate","getByValidator","addRef","Moved","removeEvent","target","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","createEvent","keyCode","metaKey","buttons","event","initEvent","eventType","dispatchEvent","bindClickoutside","detail","hide","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","cssPrefix","look","Resizer","vertical","minDistance","moving","children","hoverEl","on","mousedownHandler","lineEl","cRect","finishedFn","rect","show","startEvt","distance","movementX","movementY","Scrollbar","moveFn","contentEl","scroll","contentDistance","cssKey","SelectorCell","getRect","setOffset","includeByRiCi","selectorHeightBorderWidth","startZIndex","SelectorElement","selector","cornerEl","_selector","moveEvent","clickCopyPaste","boxinner","areaEl","clipboardEl","autofillEl","setTimeout","_cellRange","selectorMoveEl","container","setBoxinner","getCellRectByXY","layerX","layerY","move","getMoveRect","setMove","movedCell","movedCell2","cutPaste","indexes","moveIndexes","selectCell","moveChange","selectorMoveReset","pointer","calBRAreaOffset","ftwidth","freezeTotalWidth","ftheight","freezeTotalHeight","left0","top0","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","sc","areaOffset","arange","lastri","lastci","longTimeBefore","setCss","resetSelectOffset","freezeHeight","freezeWidth","getSelectedRect","coffset","getClipboardRect","resetOffset","indexesUpdated","calSelectedRangeByStart","cri","cci","setIndexes","resetAreaOffset","calSelectedRangeByEnd","setEnd","drisc","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","preventDefault","filterItems","itemIndex","scrollHeight","inputMoveNext","inputEnter","click","inputKeydownHandler","ctrlKey","Suggest","itemClick","editor","cssRemoveKeys","parent","startsWith","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","prev","next","week","selectChange","buildHeaderLeft","buildBody","getFullYear","trs","year","cdate","startDate","datess","disabled","getDate","monthDays","tds","Datepicker","calendarPattern","variableElement","txt","ct","SuggestContent","helpFormula","exampleName","example","item2","cha","SelectorMove","dict","timer","_move_selectors","selectors","msri","msci","meri","meci","clearTimeout","inputText","editorText","getText","_erpx","cuttingByPos","cuttingByPosEnd","erpx","setCursorPos","move2","color","lockCells","selectorMove","SelectorCopy","srn","ern","ecn","themeColorPlaceHolders","themeColors","selectColors","selectorColor","standardColors","buildTd","bgcolor","ColorPalette","isAb","offsetX","offsetY","cellRect","mousedownIndex","es1","es2","isCors","substring","setText","operation","setLock","makeSelector","judgeText","cutFirst","setMouseDownIndex","filterSelectors","selectors_delete","selectors_new","removeEl","div2span","cutting","cutting2","i2","mergeSelector","index2","selectorsEl","clearSelectors","editingSelectors","selectors_valid","enterCode","notTrueValue","prx","lax","prx_index","lax_index","findBracketLeft","begin","stop","findBracketRight","suggestContent","right","cutcolor","spanArr","spanEl","mount2span","baseFonts","fontSizes","pt","px","getFontSizePxByPt","evalFormula","rule","sheetbook","formulaMap","getCellText","isMinus","dpr","devicePixelRatio","thinLineWidth","npx","npxLine","drawFlexFalse","ctx","sx","sy","beginPath","fillStyle","moveTo","lineTo","stroke","strokeRect","clip","fill","restore","drawFlexTrue","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","getContext","resize","scale","cxc","indent","vIndent","canvasContext","clearRect","fillRect","fillText","box","textLine","innerWidth","selfAdaptionOneTxtWidth","italic","bold","measureText","textWrap","ignore","textx","textAlign","textBaseline","strokeStyle","txtWidth","selfAdaptionTxtWidth","selfAdaptionHeight","texty","lineWidth","setLineDash","y1","topxys","rightxys","bottomxys","leftxys","closePath","dtextcb","testValid","valid","assert","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","getChangeDataToCalc","changeData","changeDataForCalc","parseCell","changeDataArgs","renderCell","draw","sortedRowMap","getCellStyleOrDefault","dbox","setBorders","strokeBorders","showEquation","rect2","renderFormat","settings","minus","specialStyle","validations","getError","renderFlexible","autoFilter","s_t","dropUp","renderAutofilter","viewRange","afRange","dropdown","renderContent","fw","fh","filteredTranslateFunc","eachMergesInView","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","rowHeight","ii","colEach","colWidth","renderFixedLeftTopCell","renderContentGrid","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","viewWidth","theight","viewHeight","Table","autoAdaptList","getCellTextOrDefault","clear","fri","fci","vr","freezeViewRange","EditorText","getOldCell","cuttingByPosEnd2","text_b","resetTextareaSize","textlineEl","textEl","tlineWidth","maxWidth","viewFn","h1","getCursortPosition","getSelection","rangeCount","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","startContainer","startOffset","exist","findBracket","spanLeft","spanRight","suggest","set_focus","savedSel","charIndex","createRange","setStart","collapse","node","nodeStack","foundStart","nodeType","nextCharIndex","sel","removeAllRanges","addRange","mouseDownEventHandler","parse2","setOldCell","isDisplay","inputEventHandler","inputType","chinese","showEditor","innerText","nodeValue","changed","changeText","cutValue","cuttingByPos2","keyDownEventHandler","which","opacity","setTextareaRange","blur","suggestItemClick","resetSuggestContentItems","resetSuggestItems","setItems","Editor","rowWidth","display","lock","datepicker","dateFormat","setCellEnd","getSelectedCellRiCi","currentTarget","key_num","f4ShortcutKey","bindInputEvents","clp","originalEvent","clipboardData","newNode","insertNode","selection","pasteHTML","execCommand","textFormat","off","focus","setRiCi","insertBefore","cursorPos","textBegin","textEnd","suggestPosition","elOffset","sOffset","menuItems","buildMenuItem","buildMenu","ContextMenu","isHide","menus","view","Dropdown","showArrow","placement","arrowChange","historyBorder","headerEl","DropdownFont","nfonts","setTitle","DropdownFontSize","nfontSizes","formatStringRender","formatNumberRender","fixed","baseFormats","multiply","a_s","toInteger","floatNum","times","isNegative","strfi","dotPos","intNum","o2","n1","n2","formatm","DropdownFormat","nformats","DropdownFormula","nformulas","DropdownColor","iconName","icon","colorPalette","DropdownAlign","aligns","naligns","setName","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","HistoryBorder","history","els","DropdownAction","buildButton","tooltipdata","elBox","tooltip","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","undoEl","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","widthFn","btns","moreEl","ddMore","sumWidth2","list1","list2","Toolbar","defaultStyle","redoEl","paintformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","freezeEl","addEl","closeEl","autofilterEl","throwFormulaEl","reset","getSelectedCellStyle","getSelectedCell","canUndo","canRedo","canUnmerge","canAutofilter","equationIsActive","freezeIsActive","Modal","open","dimmer","documentElement","clientHeight","clientWidth","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","labelWidth","tip","pattern","Button","fieldLabelWidth","ModalValidation","mf","rf","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","attrs","isShow","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","cnt","filterClick","resetFilterHeader","filterhEl","checked","SortFilter","tindex","sortAscEl","sortDescEl","sortDesc","from","findIndex","xtoast","Advice","saveCheck","textCheck","setCellRange","reference","tableProxy","sheetReset","mountCopy","choose","getChooseImg","parseDom","img2","sheetCopy","plain","pasteDirectionsArr","styles","tbody","tr","td","hidden","tmpNode","cloneNode","Website","tableEl","timer2","isDisplay2","td2","td3","td4","td5","isSpecialWebsite","screenX","screenY","ErrorPopUp","RectProxy","ex","ey","clientX","clientY","positionAngle","Timer","clearInterval","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","fsw","fsh","selectorSet","render_timer","editorSetOffset","overlayerMousemove","rowResizer","colResizer","website","tRect","overlayerMousescroll","autoLoad","delta","deltaY","overlayerTouch","verticalScrollbarSet","totalHeight","horizontalScrollbarSet","totalWidth","sheetFreeze","fwidth","fheight","setFreezeLengths","overlayerEl","overlayerCEl","tOffset","vRect","renderAutoAdapt","autoRowResizer","toolbarChangeSelectorCell","clearClipboard","msg","toolbarChangePaintformatPaste","paintformatActive","paintFormatChange","paintformatToggle","dropDown","isAutofillEl","dstRect","getCellRectByXYWithNotTotalResult","dropGetPos","rpos","continueMove","shiftKey","getMovePos","selectorBeyondMove","rectProxy","isLocInside","getUpDownLeftRight","scrollTo","overlayerMousedown","sortFilter","advice","hideDirectionArr","includes2","getSet","getSort","point","offsetParent","getPoint","clearStopTimer","continueDropDown","autofill","autofillNext","stopTimer","stopTimer2","setInterval","loadFormula","firstRowToWidth","colResizerFinished","adviceSetOffset","pictureSetOffset","pictureOffsetLeft","pictureOffsetTop","img","sPosition","selectorsSetOffset","resetSelectorBRLAreaOffset","hasEditor","editorSet","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","viewRange2","autoAdapt","ignoreRi","getCellTextContent","getCellTextStyle","_ignore","cellWidth","record_rc","r_h","record_h","c_h","clickSelectorChangeRiCi","rowResizerFinished","setRowHeight","setColWidth","errorPop","errorPopUp","selectorCellText","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","insert","toolbarChange","setContent","historyList","getMax","mri","mci","eachRange","showFreeze","setSelectedCellAttr","borderResSet","sortFilterChange","setAutoFilter","afterSelector","getLock","pasteEvent","mountPaste","sheetInitEvents","startx","starty","contextMenu","modalValidation","xyInSelectedRect","setPosition","touches","pageX","pageY","changedTouches","itext","editorChangeToHistory","getRICI","setSelectedCell","addValidation","removeValidation","getSelectedValidation","reload","addPic","pictures","deleteImg","trigger","Sheet","targetEl","showToolbar","showContextmenu","recalc","clickAutofill","styleBool","setFreeze","Drag","register","onBegin","cursor","nl","nt","onmousemove","nx","ny","onDrag","onmouseup","onEnd","Resize","directionsArr","directions","div","onResize","querySelector","onmousedown","ox","oy","ow","oh","ol","ot","isResize","fun","mappers","ee","setLeft","setTop","se","nw","ws","ne","TableProxy","fontWeight","background","tableDom","colLen","defaultView","isHaveStyle","maxRi","maxCi","rii","cij","resizeOption","dragOption","lastCi","lastRi","spanDomPackage","spanDom","textArr","process","styleDom","GetInfoFromTable","cbd","kind","getAsString","textDom","imgDom","getElementsByTagName","mountImg","getAsFile","reader","FileReader","onload","readAsDataURL","getMaxCoord","nextLeft","nextTop","image","Image","containerHandlerEvent","direction_new","direction_delete","newX","tableObj","extend","dealColSpan","dealStyle","dealReference","parseTableCellRange","formatDate","calcDecimals","beginDate","beginDate2","second","fix","dateDiff","datePattern","operationItem","preAction","undoItems","redoItems","MultiPreAction","expr1","expr2","does","getItems","actionItems","actionType","PaintFormat","selectorRange","dstRange","dType","sType","getType","pArr","recordRi","rowIndex","_darr","changeDarrToDoubleArr","defaultSettings","canPaste","dst","scn","copyPaste","deleteCells","cleard","clipboard","setStyleBorder","bss","cstyle","addStyle","event_type","description","isLegal","processPasteDirectionsArr","newItem","clickCopyPasteHelp","lci","lri","lcell","setStyleBorders","isSignleSelected","mergeIndexes","mrl","mcl","getCellMerge","getCellRowByY","scrollOffsety","frset","getCellColByX","scrollOffsetx","makeFormatCell","symbol","position","cText","getCellStyle","getCellStyleConvert","changeFormat","useOne","DataProxy","methods","hyperlinks","comments","multiPreAction","moved","unsortedRowMap","cell2","cell3","makeCellPropArr","setCellByCellProp","paintFormat","paintType","getPaintType","makePaintArr","srcRange","getFirstIncludes","unmerge","nfont","resetAutoFilter","getStepType","oc","nc","addStep","isClear","autoFilterRef","addFilter","setSort","filteredRows","fary","oldAry","si","rsize","csize","filterIntersects","frary","nstyle","lastStep","changeToHistory","addFiexRows","revision","bugout","realTimeLoggingOn","useTimestamps","useLocalStorage","recordLogs","autoTrim","maxLines","tailNumLines","logFilename","depth","parentSizes","currentResult","startTime","output","version","getLog","retrievalTime","saved","localStorage","getItem","lastLog","formatSessionDuration","tail","numLines","tailLines","trimLog","lines","rgx","matched","addr","getSlice","lineNumber","downloadLog","file","logFile","encodeURIComponent","href","download","clearTime","saveObject","setItem","determineType","addition","logTime","formatTimestamp","typeResult","formatType","objectSize","prop","indentsForDepth","subtype","subresult","endTime","msec","hh","hrs","mm","mins","ss","timestamp","getHours","getMinutes","getSeconds","Spreadsheet","alias","zhCN","rootEl","loadData","getCellByExpr","jsSpreadsheet","drag","colstr","getSanitizedSheetName","possition_i","range_expression","start_pst","end_pst","aux","range_start_pst","max_row","min_row","str_max_row","min_col","max_col","cell_full_name","numeral","num2e","allzero","decimalsToFractional","decimals","formatDecimals","recursion","isInteger","ASC","BAHTTEXT","CHAR","CLEAN","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","EXACT","text1","text2","FIND","find_text","within_text","FIXED","no_commas","HTML2TEXT","INDEX","row_num","column_num","LEFT","LEN","LOWER","MID","NUMBERVALUE","decimal_separator","group_separator","PRONETIC","PROPER","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","REPT","RIGHT","SEARCH","foundAt","SPLIT","separator","SUBSTITUTE","old_text","occurrence","TEXT","Formulas","AllFormulas","fmt","TRIM","UNICHAR","UNICODE","UPPER","VALUE","unformat","CELL","ERROR","TYPE","error_val","nil","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISODD","ISREF","ISTEXT","NA","SHEET","SHEETS","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","isLeapYear","daysBetween","start_date","end_date","serial","DATE","DATEVALUE","date_text","DAY","serial_number","method","ed","sm","em","smd","emd","EDATE","EOMONTH","HOUR","INTERVAL","hour","sec","ISOWEEKNUM","setHours","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","weekend","NETWORKDAYS$INTL","days","getTimezoneOffset","getUTCDay","holiday","INTL","NOW","SECOND","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","week_start","jan","inc","WORKDAY","YEAR","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","quotedMatch","resolved_ref","ref_cell","categories","category","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","path","opening","JOIN","NUMBERS","NUMERAL","bessel","isValidBinaryNumber","trans_num","inumber","BESSELI","besseli","BESSELJ","besselj","BESSELK","besselk","BESSELY","bessely","BIN2DEC","stringified","BIN2HEX","BIN2OCT","BITAND","number1","number2","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","Y","E","G","u","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","lower_bound","upper_bound","erf","erfc","GESTEP","HEX2BIN","decimal","HEX2DEC","HEX2OCT","IMABS","IMREAL","IMAGINARY","plus","unit","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","trans_dict"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([260,2,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nexport function stringAt(index) {\n  let str = '';\n  let cindex = index;\n  while (cindex >= alphabets.length) {\n    cindex /= alphabets.length;\n    cindex -= 1;\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\n  }\n  const last = index % alphabets.length;\n  str += alphabets[last];\n  return str;\n}\n\nexport function  indexAt(str) {\n  let ret = 0;\n  for (let i = 0; i < str.length - 1; i += 1) {\n    const cindex = str.charCodeAt(i) - 65;\n    const exponet = str.length - 1 - i;\n    ret += (alphabets.length ** exponet) + (alphabets.length * cindex);\n  }\n  ret += str.charCodeAt(str.length - 1) - 65;\n  return ret;\n}\n\n// B10 => x,y\nexport function expr2xy(src) {\n  let x = '';\n  let y = '';\n  for (let i = 0; i < src.length; i += 1) {\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n      y += src.charAt(i);\n    } else {\n      x += src.charAt(i);\n    }\n  }\n  return [indexAt(x), parseInt(y, 10) - 1];\n}\n\n// export function expr2expr(src, xn, yn) {\n//   const [x, y] = expr2xy(src);\n//   return stringAt(x + xn) + (y + yn);\n// }\n\n// x,y => B10  x ci y ri\nexport function xy2expr(x, y, ab = 0) {\n  x = x * 1;\n  y = y * 1;\n  if(ab === 2) {\n    return `${stringAt(x)}$${y + 1}`;\n  } else if(ab === 1) {\n      return `$${stringAt(x)}${y + 1}`;\n  }\n  return `${stringAt(x)}${y + 1}`;\n}\n\nexport default {\n  expr2xy,\n  xy2expr,\n};\n","var error = require('./error');\n\nfunction flattenShallow(array) {\n  if (!array || !array.reduce) { return array; }\n  return array.reduce(function(a, b) {\n    var aIsArray = Array.isArray(a);\n    var bIsArray = Array.isArray(b);\n    if (aIsArray && bIsArray ) {\n      return a.concat(b);\n    }\n    if (aIsArray) {\n      a.push(b);\n      return a;\n    }\n    if (bIsArray) {\n      return [a].concat(b);\n    }\n    return [a, b];\n  });\n}\n\nfunction isFlat(array) {\n  if (!array) { return false; }\n  for (var i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexports.flatten = function() {\n  var result = exports.argsToArray.apply(null, arguments);\n  while (!isFlat(result)) {\n    result = flattenShallow(result);\n  }\n  return result;\n};\n\nexports.argsToArray = function(args) {\n  return Array.prototype.slice.call(args, 0);\n};\n\nexports.numbers = function() {\n\n  return possibleNumbers.filter(function(el) {\n    return typeof el === 'number';\n  });\n};\n//XW: default0\nfunction parse(a){\n  if (a instanceof Error){\n    return a\n  }\n  if (a instanceof Array){\n    var arr = []\n    for (var i=0;i<a.length;i++){\n      if (typeof a[i][0] === 'string' && a[i][0] !== 'default_0'){\n        return error.name\n      }\n      if (typeof a[i][0] === 'number'){\n        arr.push(a[i][0])\n      }\n      if (a[i][0] instanceof Object){\n        return error.name\n      }\n    }\n    return arr\n  }\n  if (typeof a === 'string'){\n    if (a === 'default_0'){\n      return 'pass'\n    }else{\n      return error.name\n    }\n  }\n  if (typeof a === 'number'){\n    return a\n  }\n}\nexports.flattenNum = function(args) {\n  try{\n    if (args.length === 1 && args[0][0] === 'default_0'){\n      return error.div0\n    }\n    var arr = []\n    for( var i=0;i<args.length;i++){\n      var p = parse(args[i])\n      if (p === undefined){\n        return error.name\n      }\n      if (p instanceof Error){\n        return p\n      }else if(p !== 'pass'){\n        if (p instanceof Array){\n          for (var n=0; n < p.length;n++){\n            arr.push(p[n])\n          }\n        }else{\n          arr.push(p)\n        }\n      }\n    }\n    return arr\n  }catch{\n    return error.name\n  }\n};\n//XW:end\n\nexports.cleanFloat = function(number) {\n  var power = 1e14;\n  return Math.round(number * power) / power;\n};\n\nexports.parseBool = function(bool) {\n  if (bool === undefined){\n    return true\n  }\n  if (typeof bool === 'boolean') {\n    return bool;\n  }\n\n  if (bool instanceof Error) {\n    return bool;\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0;\n  }\n\n  if (typeof bool === 'string') {\n    var up = bool.toUpperCase();\n    if (up === 'TRUE') {\n      return true;\n    }\n\n    if (up === 'FALSE') {\n      return false;\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true;\n  }\n\n  return error.value;\n};\n\nexports.parseNumber = function(string) {\n  if (string === undefined || string === '') {\n    return error.value;\n  }\n  if (!isNaN(string)) {\n    return parseFloat(string);\n  }\n  return error.value;\n};\n\nexports.parseNumberArray = function(arr) {\n  var len;\n  if (!arr || (len = arr.length) === 0) {\n    return error.value;\n  }\n  var parsed;\n  while (len--) {\n    parsed = exports.parseNumber(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.parseMatrix = function(matrix) {\n  var n;\n  if (!matrix || (n = matrix.length) === 0) {\n    return error.value;\n  }\n  var pnarr;\n  for (var i = 0; i < matrix.length; i++) {\n    pnarr = exports.parseNumberArray(matrix[i]);\n    matrix[i] = pnarr;\n    if (pnarr instanceof Error) {\n      return pnarr;\n    }\n  }\n  return matrix;\n};\n\nvar d1900 = new Date(1900, 0, 1);\nexports.parseDate = function(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date);\n    }\n    var d = parseInt(date, 10);\n    if (d < 0) {\n      return error.num;\n    }\n    if (d <= 60) {\n      return new Date(d1900.getTime() + (d - 1) * 86400000);\n    }\n    return new Date(d1900.getTime() + (d - 2) * 86400000);\n  }\n  if (typeof date === 'string') {\n    date = new Date(date);\n    if (!isNaN(date)) {\n      return date;\n    }\n  }\n  return error.value;\n};\nexports.Copy =  function (obj) {\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n  // Handle Date\n  if (obj instanceof Date) {\n    var copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n  // Handle Array\n  if (obj instanceof Array) {\n    var copy = [];\n    for (var i = 0; i < obj.length; ++i) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n  // Handle Object\n  if (obj instanceof Object) {\n    var copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n//XW:{},{1,2,34,5,6}\nfunction parse_arg(arg) {\n  if(!isNaN(parseInt(arg))){\n    return parseInt(arg)\n  }\n  return arg.replace('\"', '').replace('\"', '')\n}\nexports.strToMatrix = function (str) {\n  var arg = str.slice(2,str.length-2).split(',')\n  var matrix = [];\n  var arr = []\n  for (var i=0; i < arg.length; i++){\n    var num = arg[i].toString()\n    if (num.indexOf(';') > 0) {\n      arr.push(parse_arg(num.split(';')[0]))\n      matrix.push(arr)\n      arr = [parse_arg(num.split(';')[1])]\n    }else{\n      arr.push(parse_arg(num))\n    }\n  }\n  matrix.push(arr)\n  return matrix\n}\n//XW: end\n//XWexceljs\nexports.ExcelDateToJSDate = function (date) {\n  if (typeof date == 'string'){\n    date = utils.parseDate(issue)\n  }\n  return (date instanceof Date) ? date : new Date(Math.round((date - 25569)*86400*1000));\n}\n//XWend\n//XW\nexports.isNumber = function (val) {\n  var regPos = /^\\d+(\\.\\d+)?$/; //\n  var regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //\n  if(regPos.test(val) || regNeg.test(val)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n//XWend\nexports.parseDateArray = function(arr) {\n  var len = arr.length;\n  var parsed;\n  while (len--) {\n    parsed = this.parseDate(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.anyIsError = function() {\n  var n = arguments.length;\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexports.arrayValuesToNumbers = function(arr) {\n  var n = arr.length;\n  var el;\n  while (n--) {\n    el = arr[n];\n    if (typeof el === 'number') {\n      continue;\n    }\n    if (el === true) {\n      arr[n] = 1;\n      continue;\n    }\n    if (el === false) {\n      arr[n] = 0;\n      continue;\n    }\n    if (typeof el === 'string') {\n      var number = this.parseNumber(el);\n      if (number instanceof Error) {\n        arr[n] = 0;\n      } else {\n        arr[n] = number;\n      }\n    }\n  }\n  return arr;\n};\n\nexports.rest = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(idx);\n};\n\nexports.initial = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(0, array.length - idx);\n};\n","import {deepCopy, distinct} from \"../core/operator\";\nimport {isHave} from '../core/helper';\nimport {expr2xy, xy2expr} from \"../core/alphabet\";\n\nfunction getCellDepend(cells) {\n    let arr = [];\n    for (let i = 0; i < cells.length; i++) {\n        if(isHave(cells[i]) && isHave(cells[i].expr)) {\n            arr.push(cells[i].expr);\n        }\n\n        if (isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.depend)) {\n            arr.push(...cells[i].cell.depend);\n        }\n\n        if(isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.multivalueRefsCell)) {\n            arr.push(cells[i].cell.multivalueRefsCell);\n        }\n    }\n\n    return arr;\n}\n\nexport default class PreAction {\n    constructor({type = -1, action = \"\",  ri = -1, ci = -1, oldData = \"\", newData = \"\", expr = \"\", oldStep = \"\", cellRange = \"\", cells = {}, height = -1, width = -1, oldCell = {}, newCell = {}, newMergesData = \"\", oldMergesData = \"\", property = \"\", value = \"\"}, data) {\n        this.type = type;\n        this.action = action;\n        this.ri = ri;\n        this.ci = ci;\n        this.expr = expr;\n        this.cellRange = cellRange;\n        this.cells = cells;\n        this.height = height;\n        this.width = width;\n        this.oldCell = oldCell;\n        this.newCell = newCell;\n        this.oldMergesData = oldMergesData;\n        this.newMergesData = newMergesData;\n        this.property = property;\n        this.value = value;\n        this.oldStep = oldStep;\n\n        this.oldData = oldData;\n        this.newData = newData;\n        this.data = data;\n    }\n\n    findAllNeedCalcCell() {\n        let changeArr = [];\n        let {oldCell, newCell, ri, ci} = this;\n        changeArr.push(...getCellDepend(oldCell));\n        changeArr.push(...getCellDepend(newCell));\n        if (ri !== -1 && ci !== -1) {\n            changeArr.push(xy2expr(ci, ri));\n        }\n\n        changeArr = distinct(changeArr);\n        return changeArr;\n    }\n\n    restore(data, sheet, isRedo) {\n        let {type} = this;\n\n        if (type === 1) { // shuru\n            let {oldCell, newCell} = this;\n            let _cell = \"\";\n            // redo 1  undo 2\n            if (isRedo === 1) {\n                _cell = deepCopy(oldCell);\n            } else {\n                _cell = deepCopy(newCell);\n            }\n            for (let i = 0; i < _cell.length; i++) {\n                let {cell, ri, ci} = _cell[i];\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n\n        } else if(type === 13) {\n            let {oldData, newData} = this;\n            let _data = \"\";\n            if (isRedo === 1) {\n                _data = deepCopy(newData);\n            } else {\n                _data = deepCopy(oldData);\n            }\n\n            data.setData(_data);\n        } else if (type === 2 || type === 5 || type === 6 || type === 11 || type === 12) {\n            let {newCell, oldCell, oldMergesData, newMergesData, cellRange, property, value} = this;\n            let _cells = \"\";\n            if (isRedo === 1) {\n                _cells = deepCopy(oldCell);\n            } else {\n                _cells = deepCopy(newCell);\n            }\n\n            if (property === 'merge') {\n                if (isRedo === 1) {\n                    this.data.merges.setData(oldMergesData);\n                } else {\n                    this.data.merges.setData(newMergesData);\n                }\n            }\n\n            for (let i = 0; i < _cells.length; i++) {\n                let {cell, ri, ci} = _cells[i];\n\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n        } else if (type === 3) {\n            let {ri, height, oldStep} = this;\n            if (isRedo === 1) {\n                data.rows.setHeight(ri, oldStep.height);\n            } else {\n                data.rows.setHeight(ri, height);\n            }\n        } else if (type === 4) {\n            let {ci, width, oldStep} = this;\n            if (isRedo === 1) {\n                data.cols.setWidth(ci, oldStep.width);\n            } else {\n                data.cols.setWidth(ci, width);\n            }\n\n        }\n    }\n}\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","\"use strict\";\n\nconst expression_builder = require('./expression_builder.js');\n\nlet xlsx_Fx = {};\nlet xlsx_raw_Fx = {};\n\nimport_functions(require('.//formulajs/index'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            if (opts.override || !xlsx_Fx[prefix + key]) {\n                xlsx_Fx[prefix + key] = obj;\n            }\n            // else {\n            //     console.log(prefix + key, 'already exists.');\n            //     console.log('  to override:');\n            //     console.log('    XLSX_CALC.import_functions(yourlib, {override: true})');\n            // }\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    return expression_builder(formula, {xlsx_Fx: xlsx_Fx, xlsx_raw_Fx: xlsx_raw_Fx});\n    // xlsx_raw_Fx = {AND, IF, IFERROR, OFFSET}\n    // xlsx_Fx = {FLOOR, AVERGAE ... }\n}\n\nfunction exec_formula(formula) { // formula.cell.f = \"Average(1,2,3,4,5)\n    let root_exp = build_expression(formula);\n    root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.localizeFunctions = function(dic) {\n    for (let newName in dic) {\n        let oldName = dic[newName];\n        if (xlsx_Fx[oldName]) {\n            xlsx_Fx[newName] = xlsx_Fx[oldName];\n        }\n        if (xlsx_raw_Fx[oldName]) {\n            xlsx_raw_Fx[newName] = xlsx_raw_Fx[oldName];\n        }\n    }\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nexec_formula.xlsx_Fx = xlsx_Fx;\nmodule.exports = exec_formula;\n","const Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nmodule.exports = function expression_builder(formula, opts) { // \n    formula.status = 'working';\n\n    var xlsx_Fx = opts.xlsx_Fx || {};\n    var xlsx_raw_Fx = opts.xlsx_raw_Fx || {};\n\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1); // =adsf adsf\n    }\n    var exp_obj = root_exp = new Exp(formula);  // \n    var buffer = '',\n        was_string = false;\n    var fn_stack = [{ // \n        exp: exp_obj\n    }];\n\n    /**\n     * state pattern in functional way\n     */\n    function string(char) {\n        if (char === '\"') {\n            exp_obj.push(new RawValue(buffer));\n            was_string = true;\n            buffer = '';\n            state = start;\n        } else {\n            buffer += char;\n        }\n    }\n\n    function single_quote(char) {\n        if (char === \"'\") {\n            state = start;\n        }\n        buffer += char;\n    }\n\n    function ini_parentheses() {\n        var o, trim_buffer = buffer.trim(),\n            special = xlsx_Fx[trim_buffer];\n        var special_raw = xlsx_raw_Fx[trim_buffer];\n        if (special_raw) {\n            special = new UserRawFnExecutor(special_raw, formula);\n        }\n        else if (special) {\n            special = new UserFnExecutor(special, formula);\n        }\n        else if (trim_buffer) {\n            //Error: \"Worksheet 1\"!D145: Function INDEX not found\n            throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n        }\n        o = new Exp(formula);\n        fn_stack.push({\n            exp: o,\n            special: special\n        });\n        exp_obj = o;\n        buffer = '';\n    }\n\n    function end_parentheses() {\n        var v, stack = fn_stack.pop();\n        exp_obj = stack.exp;\n        exp_obj.push(buffer,position_i);\n        v = exp_obj;\n        buffer = '';\n        exp_obj = fn_stack[fn_stack.length - 1].exp;\n        if (stack.special) {\n            stack.special.push(v);\n            exp_obj.push(stack.special, position_i);\n        }\n        else {\n            exp_obj.push(v, position_i);\n        }\n    }\n\n    function add_operation(char) {\n        if (!was_string) {\n            exp_obj.push(buffer, position_i);\n        }\n        was_string = false;\n        exp_obj.push(char, position_i);\n        buffer = '';\n    }\n\n    function start(char) {\n        if (char === '\"') {\n            state = string;\n            buffer = \"\";\n        } else if (char === \"'\") {\n            state = single_quote;\n            buffer = \"'\";\n        } else if (char === '(') {\n            ini_parentheses();\n        } else if (char === ')') {\n            end_parentheses();\n        } else if (common_operations[char]) {\n            add_operation(char);\n        } else if (char === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer, position_i);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        } else {\n            buffer += char;\n        }\n    }\n\n    var state = start;\n    var position_i = 0;\n\n    for (; position_i < str_formula.length; position_i++) {\n        state(str_formula[position_i]); // \n    }\n    root_exp.push(buffer, position_i); // root_exp ExpExp\n    return root_exp;\n\n}\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst str_2_val = require('./str_2_val.js');\n//XW\nvar error = require('./formulajs/lib/error');\n//XWend\n\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\nvar exp_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;   // id root_expid1\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n\n    function update_cell_value() {\n        try {\n            if (Array.isArray(self.args)\n                    && self.args.length === 1\n                    && self.args[0] instanceof Range) {\n                throw error.value;\n            }\n            formula.cell.v = self.calc();\n\n            if (typeof(formula.cell.v) === 'string') {\n                formula.cell.t = 's';\n            }\n            else if (typeof(formula.cell.v) === 'number') {\n                formula.cell.t = 'n';\n            }\n        }\n        catch (e) {\n            var errorValues = {\n                '#NULL!': 0x00,\n                '#DIV/0!': 0x07,\n                '#VALUE!': 0x0F,\n                '#REF!': 0x17,\n                '#NAME?': 0x1D,\n                '#NUM!': 0x24,\n                '#N/A': 0x2A,\n                '#GETTING_DATA': 0x2B\n            };\n            if (errorValues[e.message] !== undefined) {\n                formula.cell.t = 'e';\n                formula.cell.w = e.message;\n                formula.cell.v = errorValues[e.message];\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            formula.status = 'done';\n        }\n    }\n    function isEmpty(value) {\n        return value === undefined || value === null || value === \"\";\n    }\n\n    function checkVariable(obj) {\n        if (typeof obj.calc !== 'function') {\n            return 0;\n        }\n        return 1;\n    }\n\n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    if (i === 0 && op === '+') {\n                        let as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = args[i + 1].calc();\n                        args.splice(i, 2, new RawValue(r));\n                    } else {\n                        let as = checkVariable(args[i - 1]);\n                        if (!as)\n                            break;\n                        as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = fn(args[i - 1].calc(), args[i + 1].calc());\n                        args.splice(i - 1, 3, new RawValue(r));\n                        i--;\n                    }\n                }\n                catch (e) {\n                    // console.log('[Exp.js] - ' + formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                checkVariable(args[i + 1]);\n                var b = args[i + 1].calc();\n                if (i > 0 && typeof args[i - 1] !== 'string') {\n                    args.splice(i, 1, '+');\n                    if (b instanceof Date) {\n                        b = Date.parse(b);\n                        checkVariable(args[i - 1]);\n                        var a = args[i - 1].calc();\n                        if (a instanceof Date) {\n                            a = Date.parse(a) / MS_PER_DAY;\n                            b = b / MS_PER_DAY;\n                            args.splice(i - 1, 1, new RawValue(a));\n                        }\n                    }\n                    args.splice(i + 1, 1, new RawValue(-b));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(-b));\n                }\n            }\n        }\n    }\n    self.calc = function() {\n        let args = self.args.concat();\n        //XW: \n        try{\n            for (var i=0;i<args.length;i++){\n                if (args[i].name == 'RefValue'){\n                    var sheet = args[i].formula.sheet\n                    //fdefault_0\n                    if (sheet[args[i].str_expression] === undefined){\n                        args[i].formula.sheet[args[i].str_expression] = {v: 'default_0'}\n                    }\n                    //=A0\n                    if (args[i].str_expression.slice(1, args[i].str_expression.length) == '0'){\n                        return error.name;\n                    }\n                }\n            }\n        }catch (e) {\n        }\n        try{\n            //201910192019-10-19\n            if (args[0].name == 'RefValue' && args[1] == '-' && args[2].name == 'RefValue'){\n                var sheet = args[0].formula.sheet\n                var a = sheet[args[0].str_expression].v\n                var b = sheet[args[2].str_expression].v\n                var a = a.replace('', '-').replace('', '-').replace('', '')\n                var b = b.replace('', '-').replace('', '-').replace('', '')\n                return datedifference(a, b)\n            }\n        }catch (e) {\n        }\n        //XWend\n        exec_minus(args);\n        exec('^', args, function(a, b) {\n            return Math.pow(+a, +b);\n        });\n        exec('/', args, function(a, b) {\n            if (b == 0) {\n                throw error.div0;\n            }\n            return (+a) / (+b);\n        });\n        exec('*', args, function(a, b) {\n            return (+a) * (+b);\n        });\n        exec('+', args, function(a, b) {\n            if (a instanceof Date && typeof b === 'number') {\n                b = b * MS_PER_DAY;\n            }\n            return (+a) + (+b);\n        });\n        exec('&', args, function(a, b) {\n            return '' + a + b;\n        });\n        exec('<', args, function(a, b) {\n            return a < b;\n        });\n        exec('>', args, function(a, b) {\n            return a > b;\n        });\n        exec('>=', args, function(a, b) {\n            return a >= b;\n        });\n        exec('<=', args, function(a, b) {\n            return a <= b;\n        });\n        exec('<>', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() !== b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return false;\n            }\n            return a != b;\n        });\n        exec('=', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return true;\n            }\n            if ((a == null && b === 0) || (a === 0 && b == null)) {\n                return true;\n            }\n            if (typeof a === 'string' && typeof b === 'string' && a.toLowerCase() === b.toLowerCase()) {\n                return true;\n            }\n            return a == b;\n        });\n        if (args.length == 1) {\n            if (typeof(args[0].calc) !== 'function') {\n                return args[0];\n            }\n            else {\n                return args[0].calc();\n            }\n        }\n    };\n\n    var last_arg;\n    self.push = function(buffer, position_i) {\n        if (buffer) {\n            var v = str_2_val(buffer, formula, position_i);\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};\n","\"use strict\";\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    self.calc = function() {\n        var errorValues = {\n            '#NULL!': 0x00,\n            '#DIV/0!': 0x07,\n            '#VALUE!': 0x0F,\n            '#REF!': 0x17,\n            '#NAME?': 0x1D,\n            '#NUM!': 0x24,\n            '#N/A': 0x2A,\n            '#GETTING_DATA': 0x2B\n        }, result;\n        try {\n            result = user_function.apply(self, self.args.map(f=>f.calc()));\n        } catch (e) {\n            if (user_function.name === 'is_blank'\n                && errorValues[e.message] !== undefined) {\n                // is_blank applied to an error cell doesn't propagate the error\n                result = 0;\n            }\n            else if (user_function.name === 'iserror'\n                && errorValues[e.message] !== undefined) {\n                // iserror applied to an error doesn't propagate the error and returns true\n                result = true;\n            }\n            else {\n                throw e;\n            }\n        }\n        return result;\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","var mathTrig = require('./math-trig');\nvar statistical = require('./statistical');\nvar engineering = require('./engineering');\nvar dateTime = require('./date-time');\n\nfunction set(fn, root) {\n  if (root) {\n    for (var i in root) {\n      fn[i] = root[i];\n    }\n  }\n  return fn;\n}\n\nexports.BETADIST = statistical.BETA.DIST;\nexports.BETAINV = statistical.BETA.INV;\nexports.BINOMDIST = statistical.BINOM.DIST;\nexports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);\nexports.CEILINGMATH = mathTrig.CEILING.MATH;\nexports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;\nexports.CHIDIST = statistical.CHISQ.DIST;\nexports.CHIDISTRT = statistical.CHISQ.DIST.RT;\nexports.CHIINV = statistical.CHISQ.INV;\nexports.CHIINVRT = statistical.CHISQ.INV.RT;\nexports.CHITEST = statistical.CHISQ.TEST;\nexports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);\nexports.COVAR = statistical.COVARIANCE.P;\nexports.COVARIANCEP = statistical.COVARIANCE.P;\nexports.COVARIANCES = statistical.COVARIANCE.S;\nexports.CRITBINOM = statistical.BINOM.INV;\nexports.EXPONDIST = statistical.EXPON.DIST;\nexports.ERFCPRECISE = engineering.ERFC.PRECISE;\nexports.ERFPRECISE = engineering.ERF.PRECISE;\nexports.FDIST = statistical.F.DIST;\nexports.FDISTRT = statistical.F.DIST.RT;\nexports.FINVRT = statistical.F.INV.RT;\nexports.FINV = statistical.F.INV;\n// XWFLOOR\n// exports.FLOOR = set(mathTrig.FLOORMATH, mathTrig.FLOOR);//11.5-\nexports.FLOORMATH = mathTrig.FLOORMATH;\nexports.FLOORPRECISE = mathTrig.FLOORPRACE;\n//XWend\nexports.FTEST = statistical.F.TEST;\nexports.GAMMADIST = statistical.GAMMA.DIST;\nexports.GAMMAINV = statistical.GAMMA.INV;\nexports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;\nexports.HYPGEOMDIST = statistical.HYPGEOM.DIST;\nexports.LOGINV = statistical.LOGNORM.INV;\nexports.LOGNORMINV = statistical.LOGNORM.INV;\nexports.LOGNORMDIST = statistical.LOGNORM.DIST;\nexports.MODE = set(statistical.MODE.SNGL, statistical.MODE);\nexports.MODEMULT = statistical.MODE.MULT;\nexports.MODESNGL = statistical.MODE.SNGL;\nexports.NEGBINOMDIST = statistical.NEGBINOM.DIST;\nexports.NETWORKDAYSINTL = dateTime.NETWORKDAYSINTL;\nexports.NORMDIST = statistical.NORM.DIST;\nexports.NORMINV = statistical.NORM.INV;\nexports.NORMSDIST = statistical.NORM.S.DIST;\nexports.NORMSINV = statistical.NORM.S.INV;\nexports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);\nexports.PERCENTILEEXC = statistical.PERCENTILE.EXC;\nexports.PERCENTILEINC = statistical.PERCENTILE.INC;\nexports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);\nexports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;\nexports.PERCENTRANKINC = statistical.PERCENTRANK.INC;\nexports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);\nexports.POISSONDIST = statistical.POISSON.DIST;\nexports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);\nexports.QUARTILEEXC = statistical.QUARTILE.EXC;\nexports.QUARTILEINC = statistical.QUARTILE.INC;\nexports.RANK = set(statistical.RANK.EQ, statistical.RANK);\nexports.RANKAVG = statistical.RANK.AVG;\nexports.RANKEQ = statistical.RANK.EQ;\nexports.SKEWP = statistical.SKEW.P;\nexports.STDEV = set(statistical.STDEV.S, statistical.STDEV);\nexports.STDEVP = statistical.STDEV.P;\nexports.STDEVS = statistical.STDEV.S;\nexports.TDIST = statistical.T.DIST;\nexports.TDISTRT = statistical.T.DIST.RT;\nexports.TINV = statistical.T.INV;\nexports.TTEST = statistical.T.TEST;\n// exports.VAR = set(statistical.VAR.S, statistical.VAR);\nexports.VARP = statistical.VAR.P;\nexports.VARS = statistical.VAR.S;\nexports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);\nexports.WEIBULLDIST = statistical.WEIBULL.DIST;\nexports.WORKDAYINTL = dateTime.WORKDAYINTL;\nexports.ZTEST = statistical.Z.TEST;\n//XW: _XLFN\nexports._XLFN = set(mathTrig.FLOOR.MATH, statistical.COVARIANCE.P, statistical.NORM.INV, statistical.VAR.P)\n// exports._XLFN.FLOOR = mathTrig.FLOOR\n// exports._XLFN.COVARIANCE = statistical.COVARIANCE\n// exports._XLFN.NORM = statistical.NORM\n// exports._XLFN.VAR = statistical.VAR\n//XWend","/* eslint-disable no-param-reassign */\nfunction cloneDeep(obj) {\n\n    return JSON.parse(JSON.stringify(obj));\n}\n\n// export function isEqual(v1, v2) {\n//     v1 = v1 + \"\";\n//     v2 = v2 + \"\";\n//     v1 = v1.toUpperCase();\n//     v2 = v2.toUpperCase();\n//\n//     return v1 === v2;\n// }\n\nconst mergeDeep = (object = {}, ...sources) => {\n    sources.forEach((source) => {\n        if (source != null && source !== undefined) {\n            Object.keys(source).forEach((key) => {\n                const v = source[key];\n                // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\n                if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n                    object[key] = v;\n                } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\n                    object[key] = object[key] || {};\n                    mergeDeep(object[key], v);\n                } else {\n                    object[key] = v;\n                }\n            });\n        }\n    });\n    // console.log('::', object);\n    return object;\n};\n\nfunction find(arr, str) {\n    for (let i = 0; i < arr.length; i++) {\n        if (str.indexOf(arr[i]) !== -1) {\n            return true;\n        }\n    }\n    return false;\n}\n\n\nfunction isOusideViewRange(y, x, dy, dx, orien) {\n    if (orien === 44 && dy - y + 100 > 0) {\n        return true;\n    } else if (orien === 11 && dx - 100 < 0) {\n        return true;\n    } else if (orien === 33 && dx - x + 100 > 0) {\n        return true;\n    } else if (orien === 22 && dy - 100 < 0) {\n        return true;\n    }\n    return false;\n}\n\nfunction equals(obj1, obj2) {\n    const keys = Object.keys(obj1);\n    if (keys.length !== Object.keys(obj2).length) return false;\n    for (let i = 0; i < keys.length; i += 1) {\n        const k = keys[i];\n        const v1 = obj1[k];\n        const v2 = obj2[k];\n        if (v2 === undefined) return false;\n        if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\n            if (v1 !== v2) return false;\n        } else if (Array.isArray(v1)) {\n            if (v1.length !== v2.length) return false;\n            for (let ai = 0; ai < v1.length; ai += 1) {\n                if (!equals(v1[ai], v2[ai])) return false;\n            }\n        } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\n            if (!equals(v1, v2)) return false;\n        }\n    }\n    return true;\n}\n\nfunction isHave(param) {\n    if (typeof param === \"undefined\") {\n        return false;\n    }\n\n    // if (param === null) {\n    //     return false;\n    // }\n\n    return param !== null;\n}\n\n/*\n  objOrAry: obejct or Array\n  cb: (value, index | key) => { return value }\n*/\nconst sum = (objOrAry, cb = value => value) => {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n        total += cb(objOrAry[key], key);\n        size += 1;\n    });\n    return [total, size];\n};\n\n// function deleteProperty(obj, property) {\n//     const oldv = obj[`${property}`];\n//     delete obj[`${property}`];\n//     return oldv;\n// }\n\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\n    let s = inits;\n    let v = initv;\n    let i = min;\n    for (; i < max; i += 1) {\n        if (s > ifv) break;\n        v = getv(i);\n        s += v;\n    }\n    return [i, s - v, v];\n}\n\nfunction rangeSum(min, max, getv) {\n    let s = 0;\n    for (let i = min; i < max; i += 1) {\n        s += getv(i);\n    }\n    return s;\n}\n\nfunction isNumber(inputData) {\n    // if (parseFloat(inputData).toString() === \"NaN\") {\n    //     return false;\n    // } else {\n    //     return parseFloat(inputData).toString() === \"NaN\";\n    // }\n    return parseFloat(inputData).toString() !== \"NaN\";\n}\n\n// function rangeEach(min, max, cb) {\n//     for (let i = min; i < max; i += 1) {\n//         cb(i);\n//     }\n// }\n\nfunction arrayEquals(a1, a2) {\n    if (a1.length === a2.length) {\n        for (let i = 0; i < a1.length; i += 1) {\n            if (a1[i] !== a2[i]) return false;\n        }\n    } else return false;\n    return true;\n}\n\nexport default {\n    cloneDeep,\n    merge: (...sources) => mergeDeep({}, ...sources),\n    equals,\n    arrayEquals,\n    sum,\n     rangeSum,\n    rangeReduceIf,\n\n};\n\nexport {\n    isNumber,\n    isOusideViewRange,\n    find,\n    isHave,\n}","var defaultOperator = '=';\nvar validSymbols = ['>', '>=', '<', '<=', '=', '<>'];\nvar TOKEN_TYPE_OPERATOR = 'operator';\nvar TOKEN_TYPE_LITERAL = 'literal';\nvar SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];\n\nexports.TOKEN_TYPE_OPERATOR = TOKEN_TYPE_OPERATOR;\nexports.TOKEN_TYPE_LITERAL = TOKEN_TYPE_LITERAL;\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @return {Object}\n */\nfunction createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type);\n  }\n\n  return {\n    value: value,\n    type: type,\n  };\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @return {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);\n  }\n\n  return value;\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @return {String[]}\n */\nfunction tokenizeExpression(expression) {\n  var expressionLength = expression.length;\n  var tokens = [];\n  var cursorIndex = 0;\n  var processedValue = '';\n  var processedSymbol = '';\n\n  while (cursorIndex < expressionLength) {\n    var char = expression.charAt(cursorIndex);\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char;\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue);\n          processedValue = '';\n        }\n        break;\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol);\n          processedSymbol = '';\n        }\n\n        processedValue = processedValue + char;\n        break;\n    }\n    cursorIndex++;\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue);\n  }\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol);\n  }\n\n  return tokens;\n};\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @return {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  var literalValue = '';\n  var analyzedTokens = [];\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));\n    } else {\n      literalValue += token;\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));\n  }\n\n  return analyzedTokens;\n};\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @return {Boolean}\n */\nfunction computeExpression(tokens) {\n  var values = [];\n  var operator;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value;\n        break;\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value);\n        break;\n    }\n  }\n\n  return evaluate(values, operator);\n};\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @return {Boolean}\n */\nfunction evaluate(values, operator) {\n  var result = false;\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1];\n      break;\n    case '>=':\n      result = values[0] >= values[1];\n      break;\n    case '<':\n      result = values[0] < values[1];\n      break;\n    case '<=':\n      result = values[0] <= values[1];\n      break;\n    case '=':\n      result = values[0] == values[1];\n      break;\n    case '<>':\n      result = values[0] != values[1];\n      break;\n  }\n\n  return result;\n}\n\nexports.parse = function(expression) {\n  return analyzeTokens(tokenizeExpression(expression));\n};\nexports.createToken = createToken;\nexports.compute = computeExpression;","var error = require('./error');\nvar stats = require('./statistical');\nvar maths = require('./math-trig');\nvar utils = require('./utils');\n\nfunction compact(array) {\n  if (!array) { return array; }\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    if (!array[i]) { continue; }\n    result.push(array[i]);\n  }\n  return result;\n}\n\nexports.FINDFIELD = function(database, title) {\n  var index = null;\n  for (var i = 0; i < database.length; i++) {\n    if (database[i][0] === title) {\n      index = i;\n      break;\n    }\n  }\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value;\n  }\n  return index;\n};\n\n//XW: \nfunction find_result_idx(database, criteria){\n  var valid_arr = []\n  var filter_arr = []\n  for (var i=0; i < criteria[0].length; i++) {\n    filter_arr.push(criteria[0][i])\n  }\n  for (var i=1; i < criteria.length; i++){\n    var arr = criteria[i]\n    var valid_str = []\n    for (var j=0; j < filter_arr.length; j++){\n      if (arr[j] != null){\n        valid_str.push(database[0].indexOf(criteria[0][j]) + '-' + arr[j])\n      }\n    }\n    valid_arr.push(valid_str)\n  }\n  var result_idx = []\n  for (var i=1; i < database.length; i++){\n    var data = database[i]\n    for(var j=0;j<valid_arr.length;j++){\n      var is_valid = true\n      for(var k=0;k<valid_arr[j].length;k++){\n        var a = data[parseInt(valid_arr[j][k].split('-')[0])]\n        var b = valid_arr[j][k].split('-')[1]\n        if (b.indexOf('=') >= 0){\n          is_valid = (a == b.replace('=', ''))\n        }else if(!eval(a+b)){\n          is_valid = false\n        }\n      }\n      if(is_valid){\n        result_idx.push(i)\n      }\n    }\n  }\n  return result_idx\n}\nfunction get_values(resultIndexes, database, field){\n  if (typeof field == 'number'){\n    var field_idx = field - 1\n  }else{\n    var field_idx = database[0].indexOf(field)\n  }\n  var values= []\n  for (var i=0; i< resultIndexes.length; i++){\n    values.push(database[resultIndexes[i]][field_idx])\n  }\n  return values\n}\n// Database functions\nexports.DAVERAGE = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  if (typeof field == 'number'){\n    var resultIndexes = [];\n    for (var i=1;i<database.length;i++){\n      resultIndexes.push(i)\n    }\n  }else{\n    var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  var sum = 0\n  for (var i=0; i < targetValues.length; i++){\n    sum += targetValues[i]\n  }\n  return resultIndexes.length === 0 ? error.div0 : sum / targetValues.length;\n};\nexports.DCOUNT = function(database, field, criteria) {\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNT(targetValues);\n};\n\nexports.DCOUNTA = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNTA(targetValues);\n};\n\nexports.DGET = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  if (resultIndexes.length > 1){\n    return error.num\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  return targetValues[0];\n};\n\nexports.DMAX = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var max = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] > max){\n      max = targetValues[i]\n    }\n  }\n  return max\n};\n\nexports.DMIN = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var min = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] < min){\n      min = targetValues[i]\n    }\n  }\n  return min\n};\n\nexports.DPRODUCT = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var result = 1;\n  for (var i=0; i < targetValues.length; i++){\n    result *= targetValues[i]\n  }\n  return result;\n};\n\nexports.DSTDEV = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.S(targetValues);\n};\n\nexports.DSTDEVP = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.P(targetValues);\n};\n\nexports.DSUM = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return maths.SUM(targetValues);\n};\n\nexports.DVAR = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.S(targetValues);\n};\n\nexports.DVARP = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.P(targetValues);\n};\n//XWend\n","var error = require('./error');\nvar utils = require('./utils');\nvar information = require('./information');\n\nexports.AND = function() {\n  var args = utils.flatten(arguments);\n  var result = true;\n  for (var i = 0; i < args.length; i++) {\n    if (!args[i]) {\n      result = false;\n    }\n  }\n  return result;\n};\n\nexports.CHOOSE = function() {\n  if (arguments.length < 2) {\n    return error.na;\n  }\n\n  var index = arguments[0];\n  if (index < 1 || index > 254) {\n    return error.value;\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value;\n  }\n\n  return arguments[index];\n};\n\nexports.FALSE = function() {\n  return false;\n};\n\nexports.IF = function(test, then_value, otherwise_value) {\n  return test ? then_value : otherwise_value;\n};\n\nexports.IFERROR = function(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError;\n  }\n  return value;\n};\n\nexports.IFNA = function(value, value_if_na) {\n  return value === error.na ? value_if_na : value;\n};\n\nexports.NOT = function(logical) {\n  return !logical;\n};\n\nexports.OR = function() {\n  var args = utils.flatten(arguments);\n  var result = false;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result = true;\n    }\n  }\n  return result;\n};\n\nexports.TRUE = function() {\n  return true;\n};\n\nexports.XOR = function() {\n  var args = utils.flatten(arguments);\n  var result = 0;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result++;\n    }\n  }\n  return (Math.floor(Math.abs(result)) & 1) ? true : false;\n};\n\nexports.SWITCH = function () {\n  var result;\n  if (arguments.length > 0) {\n    var targetValue = arguments[0];\n    var argc = arguments.length - 1;\n    var switchCount = Math.floor(argc / 2);\n    var switchSatisfied = false;\n    var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n    if (switchCount) {\n      for (var index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2];\n          switchSatisfied = true;\n          break;\n        }\n      }\n    }\n\n    if (!switchSatisfied && defaultClause) {\n      result = defaultClause;\n    }\n  }\n  if (result == undefined){\n    return error.na\n  }\n  return result;\n};\n","var error = require('./error');\nvar dateTime = require('./date-time');\nvar utils = require('./utils');\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime());\n}\n\nfunction ensureDate(d) {\n  return (d instanceof Date)?d:new Date(d);\n}\n\nexports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\n  if (typeof issue=='string'){\n    issue = utils.parseDate(issue)\n  }\n  //XW: \n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    first = utils.ExcelDateToJSDate(first);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XWend\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value;\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n};\n\n// XW: ACCRINTM\nexports.ACCRINTM = function(issue, settlement, rate, par, basis) {\n  //XW: \n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XWend\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  var result = par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n  if (isNaN(result)){\n    return error.value;\n  }else{\n    return result\n  }\n};\n//XW: end\n\n// TODO\n//XW: \nexports.AMORDEGRC = function (cost, date_purchased, first_period, salvage, period, rate, basis) {\n  if (!validDate(issue) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n};\n\n// TODO\nexports.AMORLINC = function() {\n throw new Error('AMORLINC is not implemented');\n};\n\n// TODO\nexports.COUPDAYBS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement >= maturity) {\n    return error.num;\n  }\n};\n\nexports.COUPDAYS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPDAYSNC = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.numerror.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNUM = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPPCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n//XWend\n\nexports.CUMIPMT = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  // Requires exports.FV() and exports.PMT() from exports.js [http://stoic.com/exports/]\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative interest\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var interest = 0;\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value;\n      start++;\n    }\n  }\n\n  for (var i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n    } else {\n      interest += exports.FV(rate, i - 1, payment, value, 0);\n    }\n  }\n  interest *= rate;\n\n  // Return cumulative interest\n  return interest;\n};\n\nexports.CUMPRINC = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative principal\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var principal = 0;\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate;\n    } else {\n      principal = payment;\n    }\n    start++;\n  }\n  for (var i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n    } else {\n      principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n    }\n  }\n\n  // Return cumulative principal\n  return principal;\n};\n\nexports.DB = function(cost, salvage, life, period, month) {\n  // Initialize month\n  month = (month === undefined) ? 12 : month;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  month = utils.parseNumber(month);\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num;\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Rate is rounded to three decimals places\n  var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\n\n  // Compute initial depreciation\n  var initial = cost * rate * month / 12;\n\n  // Compute total depreciation\n  var total = initial;\n  var current = 0;\n  var ceiling = (period === life) ? life - 1 : period;\n  for (var i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate;\n    total += current;\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial;\n  } else if (period === life) {\n    // Last period\n    return (cost - total) * rate;\n  } else {\n    return current;\n  }\n};\n\nexports.DDB = function(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = (factor === undefined) ? 2 : factor;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  factor = utils.parseNumber(factor);\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Compute depreciation\n  var total = 0;\n  var current = 0;\n  for (var i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\n    total += current;\n  }\n\n  // Return depreciation\n  return current;\n};\n\n// TODO\nexports.DISC = function (settlement,maturity,pr,redemption,basis) {\n  if (pr<=0 || redemption<=0){\n    return error.num\n  }\n  if (basis<0 || basis >4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 360\n  var DSM = Math.abs(dateTime.DAYS(maturity, settlement, false))\n  return (redemption-pr)/pr * B /DSM\n};\n\nexports.DOLLARDE = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\n\n  // Round result\n  var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n  result = Math.round(result * power) / power;\n\n  // Return converted dollar price\n  return result;\n};\n\nexports.DOLLARFR = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\n\n  // Return converted dollar price\n  return result;\n};\n\n// TODO\n//XW\nexports.DURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n};\n//XWend\n\nexports.EFFECT = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1;\n};\n\nexports.FV = function(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  value = value || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  value = utils.parseNumber(value);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value;\n  }\n\n  // Return future value\n  var result;\n  if (rate === 0) {\n    result = value + payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = value * term + payment * (1 + rate) * (term - 1) / rate;\n    } else {\n      result = value * term + payment * (term - 1) / rate;\n    }\n  }\n  return -result;\n};\n\nexports.FVSCHEDULE = function (principal, schedule) {\n  principal = utils.parseNumber(principal);\n  if (typeof schedule === 'string'){\n    schedule = utils.strToMatrix(schedule)\n  }\n  schedule = utils.parseNumberArray(utils.flatten(schedule));\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value;\n  }\n\n  var n = schedule.length;\n  var future = principal;\n\n  // Apply all interests in schedule\n  for (var i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i];\n  }\n\n  // Return future value\n  return future;\n};\n\n// XWINTRATE\nexports.INTRATE = function (settlement, maturity, investment, redemption, basis) {\n  //https://support.office.com/zh-cn/article/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f\n  if (investment<=0 || redemption<=0){\n    return error.value\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 1//\n  var DIM = 2// \n  return (redemption-investment)/investment *(B/DIM)\n};\n//XWend\n\nexports.IPMT = function(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Compute payment\n  var payment = exports.PMT(rate, periods, present, future, type);\n\n  // Compute interest\n  var interest;\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0;\n    } else {\n      interest = -present;\n    }\n  } else {\n    if (type === 1) {\n      interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n    } else {\n      interest = exports.FV(rate, period - 1, payment, present, 0);\n    }\n  }\n\n  // Return interest\n  return interest * rate;\n};\n\nexports.IRR = function(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  guess = guess || 0;\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = (dates[i] - dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  var dates = [];\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = (guess === undefined) ? 0.1 : guess;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.ISPMT = function(rate, period, periods, value) {\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value;\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1);\n};\n\n// XW\nexports.MDURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  if (coupon < 0 || yld < 0){\n    return error.num\n  }\n  if (basis < 0 || basis > 4){\n    return error.num\n  }\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n};\n//xW:end\n\nexports.MIRR = function(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values));\n  finance_rate = utils.parseNumber(finance_rate);\n  reinvest_rate = utils.parseNumber(reinvest_rate);\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value;\n  }\n\n  // Initialize number of values\n  var n = values.length;\n\n  // Lookup payments (negative values) and incomes (positive values)\n  var payments = [];\n  var incomes = [];\n  for (var i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i]);\n    } else {\n      incomes.push(values[i]);\n    }\n  }\n\n  // Return modified internal rate of return\n  var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n  var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n  return Math.pow(num / den, 1 / (n - 1)) - 1;\n};\n\nexports.NOMINAL = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n};\n\nexports.NPER = function(rate, payment, present, future, type) {\n  type = (type === undefined) ? 0 : type;\n  future = (future === undefined) ? 0 : future;\n\n  rate = utils.parseNumber(rate);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value;\n  }\n\n  // Return number of periods\n  var num = payment * (1 + rate * type) - future * rate;\n  var den = (present * rate + payment * (1 + rate * type));\n  return Math.log(num / den) / Math.log(1 + rate);\n};\n\nexports.NPV = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n\n  // Lookup rate\n  var rate = args[0];\n\n  // Initialize net present value\n  var value = 0;\n\n  // Loop on all values\n  for (var j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j);\n  }\n\n  // Return net present value\n  return value;\n};\n\n// XW:\nexports.ODDFPRICE = function() {\n throw new Error('ODDFPRICE is not implemented');\n};\n\n// TODO\nexports.ODDFYIELD = function() {\n throw new Error('ODDFYIELD is not implemented');\n};\n\n// TODO\nexports.ODDLPRICE = function() {\n throw new Error('ODDLPRICE is not implemented');\n};\n\n// TODO\nexports.ODDLYIELD = function() {\n throw new Error('ODDLYIELD is not implemented');\n};\n//XWend\nexports.PDURATION = function(rate, present, future) {\n  rate = utils.parseNumber(rate);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num;\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n};\n\nexports.PMT = function(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Return payment\n  var result;\n  if (rate === 0) {\n    result = (present + future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n    } else {\n      result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n    }\n  }\n  return -result;\n};\n\nexports.PPMT = function(rate, period, periods, present, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n};\n//XW\nexports.PRICE = function (settlement, maturity, rate, yld, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEDISC = function (settlement, maturity, discount, redemption, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEMAT = function (settlement, maturity, issue, rate, yld, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  issue = utils.parseDate(issue);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var dsm = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  var dim = Math.abs(dateTime.DAYS(maturity, issue, false))\n  var B = 360\n  var A = Math.abs(dateTime.DAYS(issue, settlement, false))\n  var result = (100 + ((dim/B)*rate*100))/(1+(dsm/B)*yld)-(A/B)*rate*100\n  return result\n};\n//XWend\nexports.PV = function(rate, periods, payment, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value;\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future;\n  } else {\n    return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n  }\n};\n\nexports.RATE = function(periods, payment, present, future, type, guess) {\n  // Credits: rabugento\n\n  guess = (guess === undefined) ? 0.01 : guess;\n  future = (future === undefined) ? 0 : future;\n  type = (type === undefined) ? 0 : type;\n\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value;\n  }\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-6;\n\n  // Set maximum number of iterations\n  var iterMax = 100;\n  var iter = 0;\n  var close = false;\n  var rate = guess;\n\n  while (iter < iterMax && !close) {\n    var t1 = Math.pow(rate + 1, periods);\n    var t2 = Math.pow(rate + 1, periods - 1);\n\n    var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n    var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\n    var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n\n    var newRate = rate - f1 / (f2 + f3);\n\n    if (Math.abs(newRate - rate) < epsMax) close = true;\n    iter++\n    rate = newRate;\n  }\n\n  if (!close) return Number.NaN + rate;\n  return rate;\n};\n//XW\nexports.RECEIVED = function (settlement, maturity, investment, discount, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (investment <= 0 || discount <= 0){\n    return error.na\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return investment/(1-(discount*day/360))\n};\n//XWend\n\nexports.RRI = function(periods, present, future) {\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value;\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num;\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1;\n};\n\nexports.SLN = function(cost, salvage, life) {\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life;\n};\n\nexports.SYD = function(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num;\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10);\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\n};\n\nexports.TBILLEQ = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));\n};\n\nexports.TBILLPRICE = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);\n};\n\nexports.TBILLYIELD = function(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  price = utils.parseNumber(price);\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value;\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));\n};\n\n// XW\nexports.VDB = function() {\n throw new Error('VDB is not implemented');\n};\n//XWend\n\n\nexports.XIRR = function(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = dateTime.DAYS(dates[i], dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Check that values contains at least one positive value and one negative value\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.XNPV = function(rate, values, dates) {\n  rate = utils.parseNumber(rate);\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value;\n  }\n\n  var result = 0;\n  for (var i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);\n  }\n  return result;\n};\n\n// XW\nexports.YIELD = function (settlement, maturity, rate, pr, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if(rate <= 0){\n    return error.num;\n  }\n  // Return error if price is lower than or equal to zero\n  if (pr <= 0) {\n    return error.num;\n  }\n  if (redemption <= 0){\n    return error.num\n  }\n  // Return error if settlement is greater than maturity\n  if (settlement >= maturity  ) {\n    return error.num;\n  }\n  var A = Math.abs(dateTime.DAYS(settlement, maturity, false))\n\n};\n\n\n// TODO\nexports.YIELDDISC = function() {\n throw new Error('YIELDDISC is not implemented');\n};\n\n// TODO\nexports.YIELDMAT = function() {\n throw new Error('YIELDMAT is not implemented');\n};\n//XWend","var error = require('./error');\nvar utils = require('./utils');\nfunction match_less_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] < lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] > indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\n\nfunction match_exactly_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    lookupValue = lookupValue.replace(/\\?/g, '.');\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1\n        && typeof matrix[idx][0] === 'string') {\n        if (matrix[idx][0].toLowerCase() === lookupValue.toLowerCase()) {\n          return idx + 1;\n        }\n      }\n    } else if (typeof matrix[idx] === 'string') {\n      if (matrix[idx].toLowerCase() === lookupValue.toLowerCase()) {\n        return idx + 1;\n      }\n    }\n\n  }\n  return error.na;\n}\n\nfunction match_exactly_non_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1) {\n        if (matrix[idx][0] === lookupValue) {\n          return idx + 1;\n        }\n      }\n    } else if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    }\n  }\n  //XW:\n  return error.na;\n  //XWend\n}\n\nfunction match_greater_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] > lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] < indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\nexports.MATCH = function (lookupValue, matrix, matchType) {\n  if (Array.isArray(matrix)\n    && matrix.length === 1\n    && Array.isArray(matrix[0])) {\n    matrix = matrix[0];\n  }\n  if (!lookupValue && !matrix) {\n    return error.na;\n  }\n  if (arguments.length === 2) {\n    matchType = 1;\n  }\n  if (!(matrix instanceof Array)) {\n    return error.na;\n  }\n  if (matchType === 0) {\n    if (typeof lookupValue === 'string') {\n      return match_exactly_string(matrix, lookupValue);\n    } else {\n      return match_exactly_non_string(matrix, lookupValue);\n    }\n  } else if (matchType === 1) {\n    return match_less_than_or_equal(matrix, lookupValue);\n  } else if (matchType === -1) {\n    var a = matrix[0][0]\n    for (var i=1;i<matrix.length;i++){\n      if (matrix[i][0] > a){\n        return error.na;\n      }\n    }\n    return match_greater_than_or_equal(matrix, lookupValue);\n  } else {\n    return error.na;\n  }\n}\n//XW: vlookup\nexports.VLOOKUP = function (key, matrix, return_index, cumulative) {\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value;\n  }\n  if (cumulative == 'FALSE') {\n    cumulative = false\n  }else{\n    cumulative = true\n  }\n  for (var i = 0; i < matrix.length; i++) {\n    if (matrix[i][0] == key) {\n      return matrix[i][return_index - 1];\n    }\n  }\n  return error.na;\n};\n//XWend\n\n\n//XW:hlookup\nexports.HLOOKUP = function (needle, table, index, exactmatch) {\n  if (exactmatch == 'TRUE'){\n    exactmatch = true\n  }\n  if (exactmatch == 'FALSE'){\n    exactmatch = false\n  }\n  if (typeof table == 'string' && table.indexOf('{') >=0){\n    table = utils.strToMatrix(table)\n  }\n  if (typeof needle === \"undefined\" || table[0].indexOf(needle) < 0) {\n    return error.na;\n  }\n\n  index = index || 0;\n  let row = table[0];\n\n  for (let i = 0; i < row.length; i++) {\n    if (exactmatch && row[i] === needle || row[i].toString().toLowerCase().indexOf(needle.toString().toLowerCase()) !== -1) {\n      return index < table.length + 1 ? table[index - 1][i] : table[0][i];\n    }\n  }\n\n  return error.na;\n}\n//XWend\n","var error = require('./error');\n//XW: \nexports.PQUERY = function () {\n  if (arguments.length !== 5) {\n    return error.error;\n  }\n\n  if (arguments[0].length !== arguments[1].length) {\n    return error.error;\n  }\n\n  if (arguments[1].length !== arguments[3].length) {\n    return error.error;\n  }\n\n  // \n  let absArr = [];\n  let o1 = arguments[4];\n  for (let i = 0; i < arguments[3].length; i++) {\n    arguments[3][i] = parseFloat(arguments[3][i]);\n    if (!isNaN(arguments[3][i])) {\n      absArr.push({\n        number: i,\n        value: Math.abs(arguments[3][i] - o1)\n      });\n    }\n  }\n  absArr = absArr.sort((obj1, obj2) => {\n    var val1 = obj1.value;\n    var val2 = obj2.value;\n    if (val1 < val2) {\n      return -1;\n    } else if (val1 > val2) {\n      return 1;\n    } else {\n      return 0;\n    }\n  });\n\n\n  let items = [];\n  let count = 1;\n  for (let i = 0; i < absArr.length; i++) {\n    let {number, value} = absArr[i];\n    let a1 = arguments[0][number][0];\n    let a2 = arguments[1][number][0];\n    let a4 = arguments[3][number];\n\n    if (a2 === arguments[2]) {\n      items.push({\n        number: count,\n        name: a1,\n        city: a2,\n        area: a4,\n        value: value\n      });\n      count = count + 1;\n    }\n  }\n\n  return '**!' + JSON.stringify(items);\n};\n\nexports.HYPERLINK = function () {\n  console.log(arguments);\n  if (!arguments || !arguments[0] || !arguments[1]) {\n    return error.na;\n  }\n  let url = arguments[0];\n  if (url.substr(0, 7).toLowerCase() == \"http://\" || url.substr(0, 8).toLowerCase() == \"https://\") {\n    url = url;\n  } else {\n    url = \"http://\" + url;\n  }\n\n  let cell = {\n    \"text\": arguments[1],\n    \"url\": url\n  }\n  return \"*HYPERLINK*!\" + JSON.stringify(cell) + \" \";\n}\n\nfunction City(name, type, url) {\n  this.name = name;\n  this.type = type;\n  this.url = url;\n}\n\nfunction lianJiaUrl(lianjia) {\n  lianjia.push(new City(\"\", 0, \"https://hf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://aq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cz.fang.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://mas.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://bj.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://quanzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xm.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhangzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hui.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jiangmen.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhanjiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://fcg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://gl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://liuzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nn.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://lz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://ez.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://huangshi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yichang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://changde.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zhuzhou.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://lf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qhd.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sjz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ts.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zjk.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://bt.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://cm.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hk.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://lg.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ld.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ls.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qh.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://san.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wzs.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wc.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://kf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://luoyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xinxiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://kf.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://changzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ha.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ks.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nj.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://nt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://su.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cc.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"\", 0, \"https://jl.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://ganzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jiujiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jian.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sr.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://dl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://hhht.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://sh.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://cd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dy.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://dazhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://leshan.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://liangshan.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://mianyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ms.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nanchong.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://jn.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://linyi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://qd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://weihai.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://yt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://zb.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://baoji.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://hanzhong.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xa.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xianyang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://jz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://ty.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://tj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://dali.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://km.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://xsbn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"\", 0, \"https://hz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://huzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://jh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://nb.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://sx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://taizhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"\", 0, \"https://wz.lianjia.comditu\"));\n}\n\nfunction woaiwojiaUrl(woaiwojia) {\n  woaiwojia.push(new City(\"\", 0, \"https://bj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://hz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://qd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://tj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://cd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://cs.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nc.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://nn.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://sh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://sz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://wh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"\", 0, \"https://wx.5i5j.com/map\"));\n}\n\nfunction fangtianxiaUrl(fangtianxia) {\n  fangtianxia.push(new City(\"\", 0, \"https://www1.fang.com\"));\n}\n\nfunction find(name, arr, str = true) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i].name === name || (typeof name === 'string' && str === false)) {\n      let {url} = arr[i];\n      return url;\n    }\n  }\n\n  return \"\";\n}\n\nlet lianjia = [];\nlianJiaUrl(lianjia);\nlet woaiwojia = [];\nwoaiwojiaUrl(woaiwojia);\nlet fangtianxia = [];\nfangtianxiaUrl(fangtianxia);","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    try {\n        var value = cell_ref.calc();\n        if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n            return onerrorvalue.calc();\n        }\n        return value;\n    } catch(e) {\n        return onerrorvalue.calc();\n    }\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition.calc()) {\n        return _then.calc();\n    }\n    else {\n        return _else.calc();\n    }\n}\n\nfunction and() {\n    for (var i = 0; i < arguments.length; i++) {\n        if(!arguments[i].calc()) return false;\n    }\n    return true;\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror,\n    'IF': _if,\n    'AND': and\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst str_2_val = require('./str_2_val.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator { // \n\n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        this.formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = this.formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(this.formulas[i]);\n            this.expressions.push(exp);\n        }\n        this.calcNames();\n    }\n\n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n\n    getVars() {\n        let vars = {};\n        for (let k in this.variables) {\n            vars[k] = this.variables[k].calc();\n        }\n        return vars;\n    }\n\n    calcNames() {\n        if (!this.workbook || !this.workbook.Workbook || !this.workbook.Workbook.Names) {\n            return;\n        }\n        this.workbook.Workbook.Names.forEach(item => {\n            let val = this.getRef(item.Ref);\n            this.variables[item.Name] = val;\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, item.Name);\n            });\n        });\n    }\n\n    getRef(ref_name) {\n        if (!this.formulas.length) {\n            throw new Error(\"No formula found.\");\n        }\n        let first_formula = this.formulas[0];\n        let formula_ref = first_formula.formula_ref;\n        let formula = {\n            formula_ref: formula_ref,\n            wb: this.workbook,\n            exec_formula: this.exec_formula\n        };\n        return str_2_val(ref_name, formula);\n    }\n\n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n\n    execute() {\n        this.expressions.forEach(exp => {\n            exp.update_cell_value();\n        });\n    }\n}\n\nmodule.exports = Calculator;\n","var numeric = require('numeric');\nvar utils = require('./utils');\nvar error = require('./error');\nvar statistical = require('./statistical');\nvar information = require('./information');\n\nexports.ABS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.abs(utils.parseNumber(number));\n};\n\nexports.ACOS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.acos(number);\n};\n\nexports.ACOSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number - 1));\n};\n\nexports.ACOT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(1 / number);\n};\n\nexports.ACOTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 0.5 * Math.log((number + 1) / (number - 1));\n};\n\n//TODO: use options\nexports.AGGREGATE = function(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num);\n  options = utils.parseNumber(options);\n  //XW: \n  if (typeof ref1 == 'string') {\n    return error.value\n  }//XW:end\n  if (utils.anyIsError(function_num, options)) {\n    return error.value;\n  }\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n    case 12:\n      return statistical.MEDIAN(ref1, ref2);\n    case 13:\n      return statistical.MODE.SNGL(ref1);\n    case 14:\n      return statistical.LARGE(ref1, ref2);\n    case 15:\n      if (ref2 == undefined){\n        return error.value\n      }\n      return statistical.SMALL(ref1, ref2);\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2);\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2);\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2);\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2);\n  }\n};\n\nexports.ARABIC = function(text) {\n  // Credits: Rafa? Kukawski\n  text = text.toUpperCase()\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value;\n  }\n  var r = 0;\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i];\n  });\n  return r;\n};\n\nexports.ASIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.asin(number);\n};\n\nexports.ASINH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number + 1));\n};\n\nexports.ATAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(number);\n};\n\nexports.ATAN2 = function(number_x, number_y) {\n  number_x = utils.parseNumber(number_x);\n  number_y = utils.parseNumber(number_y);\n  if (utils.anyIsError(number_x, number_y)) {\n    return error.value;\n  }\n  return Math.atan2(number_x, number_y);\n};\n\nexports.ATANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log((1 + number) / (1 - number)) / 2;\n};\n\nexports.BASE = function(number, radix, min_length) {\n  min_length = min_length || 0;\n\n  number = utils.parseNumber(number);\n  radix = utils.parseNumber(radix);\n  min_length = utils.parseNumber(min_length);\n  if (utils.anyIsError(number, radix, min_length)) {\n    return error.value;\n  }\n  min_length = (min_length === undefined) ? 0 : min_length;\n  var result = number.toString(radix);\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n};\n\nexports.CEILING = function(number, significance, mode) {\n  significance = (significance === undefined) ? 1 : Math.abs(significance);\n  mode = mode || 0;\n\n  number = utils.parseNumber(number);\n  significance = utils.parseNumber(significance);\n  mode = utils.parseNumber(mode);\n  if (utils.anyIsError(number, significance, mode)) {\n    return error.value;\n  }\n  if (significance === 0) {\n    return 0;\n  }\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return exports.ROUND(Math.ceil(number / significance) * significance, precision);\n  } else {\n    if (mode === 0) {\n      return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n    } else {\n      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n    }\n  }\n};\n\nexports.CEILING.MATH = exports.CEILING;\n\nexports.CEILING.PRECISE = exports.CEILING;\n\nexports.COMBIN = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n};\n\nexports.COMBINA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n};\n\nexports.COS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.cos(number);\n};\n\nexports.COSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return (Math.exp(number) + Math.exp(-number)) / 2;\n};\n\nexports.COT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.tan(number);\n};\n\nexports.COTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 + 1) / (e2 - 1);\n};\n\nexports.CSC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.sin(number);\n};\n\nexports.CSCH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) - Math.exp(-number));\n};\n\nexports.DECIMAL = function(number, radix) {\n  if (arguments.length < 1) {\n    return error.value;\n  }\n\n\n  return parseInt(number, radix);\n};\n\nexports.DEGREES = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * 180 / Math.PI;\n};\n\nexports.EVEN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return exports.CEILING(number, -2, -1);\n};\n\nexports.EXP = Math.exp;\n\nvar MEMOIZED_FACT = [];\nexports.FACT = function (number) {\n  number = utils.parseNumber(number);\n  if (number < 0){\n    return error.num\n  }\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n === 0 || n === 1) {\n    return 1;\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n];\n  } else {\n    MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n    return MEMOIZED_FACT[n];\n  }\n};\n\nexports.FACTDOUBLE = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n <= 0) {\n    return 1;\n  } else {\n    return n * exports.FACTDOUBLE(n - 2);\n  }\n};\n\n//TODO: Verify\n// XW: \nexports.FLOOR = {};\nvar ROUND = function (value, places) {\n  var n = value;\n  var d = places;\n  return Math.round(n * Math.pow(10, d)) / Math.pow(10, d);\n};\nexports.FLOORMATH = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number>0&&significance<0){\n    return error.num\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\nexports.FLOORPRACE = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\n\n// Deprecated\nexports.FLOOR.MATH = exports.FLOORMATH;\nexports.FLOOR.PRECISE = exports.FLOORPRACE;\n//XW: end\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexports.GCD = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var r0 = range[0];\n  var x = r0 < 0 ? -r0 : r0;\n  for (var i = 1; i < n; i++) {\n    var ri = range[i];\n    var y = ri < 0 ? -ri : ri;\n    while (x && y) {\n      if (x > y) {\n        x %= y;\n      } else {\n        y %= x;\n      }\n    }\n    x += y;\n  }\n  return x;\n};\n\n\nexports.INT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.floor(number);\n};\n\n//TODO: verify\nexports.ISO = {\n  CEILING: exports.CEILING\n};\n\nexports.LCM = function() {\n  // Credits: Jonas Raoni Soares Silva\n  var o = utils.parseNumberArray(utils.flatten(arguments));\n  if (o instanceof Error) {\n    return o;\n  }\n  for (var i, j, n, d, r = 1;\n    (n = o.pop()) !== undefined;) {\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          //empty\n        }\n        d = (i <= j) ? i : n;\n      } else {\n        d = 2;\n      }\n      for (n /= d, r *= d, i = o.length; i;\n        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        //empty\n      }\n    }\n  }\n  return r;\n};\n\nexports.LN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number);\n};\n\nexports.LOG = function (number, base) {\n  number = utils.parseNumber(number);\n  base = utils.parseNumber(base);\n  if (utils.anyIsError(base)) {\n    base = 10\n  }\n  base = (base === undefined) ? 10 : base;\n  return Math.log(number) / Math.log(base);\n};\n\nexports.LOG10 = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number) / Math.log(10);\n};\n\nexports.MDETERM = function(matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix);\n  }\n  try{\n    return numeric.det(matrix);\n  }catch (e) {\n    return error.value\n  }\n};\n\nexports.MINVERSE = function(matrix) {\n  matrix = utils.parseMatrix(matrix);\n  if (matrix instanceof Error) {\n    return matrix;\n  }\n  return numeric.inv(matrix);\n};\n\nexports.MMULT = function(matrix1, matrix2) {\n  matrix1 = utils.parseMatrix(matrix1);\n  matrix2 = utils.parseMatrix(matrix2);\n  if (utils.anyIsError(matrix1, matrix2)) {\n    return error.value;\n  }\n  console.log(numeric.dot(matrix1, matrix2))\n  return numeric.dot(matrix1, matrix2);\n};\n\nexports.MOD = function(dividend, divisor) {\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n  if (divisor === 0) {\n    return error.div0;\n  }\n  var modulus = Math.abs(dividend % divisor);\n  return (divisor > 0) ? modulus : -modulus;\n};\n\n  exports.MROUND = function(number, multiple) {\n  number = utils.parseNumber(number);\n  multiple = utils.parseNumber(multiple);\n  if (utils.anyIsError(number, multiple)) {\n    return error.value;\n  }\n  if (number * multiple < 0) {\n    return error.num;\n  }\n\n  return Math.round(number / multiple) * multiple;\n};\n\nexports.MULTINOMIAL = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var sum = 0;\n  var divisor = 1;\n  for (var i = 0; i < args.length; i++) {\n    sum += args[i];\n    divisor *= exports.FACT(args[i]);\n  }\n  return exports.FACT(sum) / divisor;\n};\n\nexports.MUNIT = function(dimension) {\n  dimension = utils.parseNumber(dimension);\n  if (dimension instanceof Error) {\n    return dimension;\n  }\n  return numeric.identity(dimension);\n};\n\nexports.ODD = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var temp = Math.ceil(Math.abs(number));\n  temp = (temp & 1) ? temp : temp + 1;\n  return (number > 0) ? temp : -temp;\n};\n\nexports.PI = function() {\n  return Math.PI;\n};\n\nexports.POWER = function(number, power) {\n  number = utils.parseNumber(number);\n  power = utils.parseNumber(power);\n  if (utils.anyIsError(number, power)) {\n    return error.value;\n  }\n  var result = Math.pow(number, power);\n  if (isNaN(result)) {\n    return error.num;\n  }\n\n  return result;\n};\n\nexports.PRODUCT = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var result = 1;\n  for (var i = 0; i < args.length; i++) {\n    result *= args[i];\n  }\n  return result;\n};\n\nexports.QUOTIENT = function(numerator, denominator) {\n  numerator = utils.parseNumber(numerator);\n  denominator = utils.parseNumber(denominator);\n  if (utils.anyIsError(numerator, denominator)) {\n    return error.value;\n  }\n  return parseInt(numerator / denominator, 10);\n};\n\nexports.RADIANS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * Math.PI / 180;\n};\n\nexports.RAND = function() {\n  if (arguments.length > 0 && arguments[0] !== undefined){\n    return error.value\n  }\n  return Math.random();\n};\n\nexports.RANDBETWEEN = function(bottom, top) {\n  bottom = utils.parseNumber(bottom);\n  top = utils.parseNumber(top);\n  if (utils.anyIsError(bottom, top)) {\n    return error.value;\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n};\n\n// TODO\nexports.ROMAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  var digits = String(number).split('');\n  var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];\n  var roman = '';\n  var i = 3;\n  while (i--) {\n    roman = (key[+digits.pop() + (i * 10)] || '') + roman;\n  }\n  return new Array(+digits.join('') + 1).join('M') + roman;\n};\n\nexports.ROUND = function (number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  if (number < 0){\n    number = 0-number\n    return 0-Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n  }\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n};\n\nexports.ROUNDDOWN = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.ROUNDUP = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.SEC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.cos(number);\n};\n\nexports.SECH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) + Math.exp(-number));\n};\n\nexports.SERIESSUM = function(x, n, m, coefficients) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  m = utils.parseNumber(m);\n  coefficients = utils.parseNumberArray(coefficients);\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value;\n  }\n  var result = coefficients[0] * Math.pow(x, n);\n  for (var i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m);\n  }\n  return result;\n};\n\nexports.SIGN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  if (number < 0) {\n    return -1;\n  } else if (number === 0) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\nexports.SIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.sin(number);\n};\n\n  exports.SINH = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return (Math.exp(number) - Math.exp(-number)) / 2;\n  };\n\n  exports.SQRT = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    if (number < 0) {\n      return error.num;\n    }\n    return Math.sqrt(number);\n  };\n\n  exports.SQRTPI = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return Math.sqrt(number * Math.PI);\n  };\n\nexports.SUBTOTAL = function(function_code, ref1) {\n  function_code = utils.parseNumber(function_code);\n  if (function_code instanceof Error) {\n    return function_code;\n  }\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n      // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1);\n    case 102:\n      return statistical.COUNT(ref1);\n    case 103:\n      return statistical.COUNTA(ref1);\n    case 104:\n      return statistical.MAX(ref1);\n    case 105:\n      return statistical.MIN(ref1);\n    case 106:\n      return exports.PRODUCT(ref1);\n    case 107:\n      return statistical.STDEV.S(ref1);\n    case 108:\n      return statistical.STDEV.P(ref1);\n    case 109:\n      return exports.SUM(ref1);\n    case 110:\n      return statistical.VAR.S(ref1);\n    case 111:\n      return statistical.VAR.P(ref1);\n\n  }\n};\n\nexports.ADD = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.name;\n  }\n\n  return num1 + num2;\n};\n\nexports.MINUS = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.value;\n  }\n\n  return num1 - num2;\n};\n\nexports.DIVIDE = function (dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n\n  if (divisor === 0) {\n    return error.div0;\n  }\n\n  return dividend / divisor;\n};\n\nexports.MULTIPLY = function (factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  factor1 = utils.parseNumber(factor1);\n  factor2 = utils.parseNumber(factor2);\n  if (utils.anyIsError(factor1, factor2)) {\n    return error.value;\n  }\n\n  return factor1 * factor2;\n};\n\nexports.GTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 >= num2;\n};\n\nexports.LT = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 < num2;\n};\n\n\nexports.LTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 <= num2;\n};\n\nexports.EQ = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 === value2;\n};\n\nexports.NE = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 !== value2;\n};\n\nexports.POW = function (base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  base = utils.parseNumber(base);\n  exponent = utils.parseNumber(exponent);\n  if (utils.anyIsError(base, exponent)) {\n    return error.error;\n  }\n\n  return exports.POWER(base, exponent);\n};\n\nexports.SUM = function() {\n  var result = 0;\n  var argsKeys = Object.keys(arguments);\n  for (var i = 0; i < argsKeys.length; ++i) {\n    var elt = arguments[argsKeys[i]];\n    if (typeof elt === 'number') {\n      result += elt;\n    } else if (typeof elt === 'string') {\n      var parsed = parseFloat(elt);\n      !isNaN(parsed) && (result += parsed);\n    } else if (Array.isArray(elt)) {\n      result += exports.SUM.apply(null, elt);\n    }\n  }\n  return result;\n};\n\nexports.SUMIF = function(range, criteria) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (range instanceof Error) {\n    return range;\n  }\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\n  }\n  return result;\n};\n//XW SUMIFS\nexports.SUMIFS = function() {\n  var args = utils.argsToArray(arguments);\n  var range = utils.flatten(args.shift());\n  if (range instanceof Error) {\n    return range;\n  }\n  if (args.length % 2 !== 0) {\n    return error.value;\n  }\n  for (let i = 0; i < args.length; i += 2) {\n    if (args[i].length !== range.length || !args[i + 1]) {\n      return error.value;\n    }\n  }\n  let arr = [];\n  var result = 0;\n  for (let i = 0; i < args.length; i += 2) {\n    let s_arr = [];\n    for (let j = 0; j < args[i].length; j++) {\n      let compareValue = args[i + 1] + \"\";\n      if (compareValue.lastIndexOf(\">=\") == 0) {\n        compareValue = compareValue.replace(/>=/, \"\");\n        if (isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 <= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }else if (compareValue.lastIndexOf(\"<=\") == 0) {\n        compareValue = compareValue.replace(/<=/, \"\");\n        if(isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 >= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }\n      compareValue = compareValue.replace(\"=\", \"\");\n      if (compareValue.lastIndexOf(\"<>\") == 0) {\n        compareValue = compareValue.replace(/<>/, \"\");\n        if (compareValue !== args[i][j][0]) {\n          s_arr.push(j);\n        }\n      } else {\n        let str = false;\n        if (compareValue.lastIndexOf(\"<\") == 0) {\n          compareValue = compareValue.replace(/</, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 > args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else if (compareValue.lastIndexOf(\">\") == 0) {\n          compareValue = compareValue.replace(/>/, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 < args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else {\n          if (compareValue.indexOf('*') > 0){\n            var v = compareValue\n            v = v.replace('*', '')\n            if (typeof args[i][j][0] == 'string' && args[i][j][0].indexOf(v) >= 0){\n              s_arr.push(j);\n            }\n          }\n          if(isNaN(compareValue)) {\n            if(compareValue === args[i][j][0]) {\n              s_arr.push(j);\n            }\n          } else {\n            if(compareValue * 1 === args[i][j][0]) {\n              s_arr.push(j);\n            }\n\n          }\n        }\n        if(str) {\n          return error.value;\n        }\n      }\n\n    }\n    arr.push(s_arr);\n  }\n\n  let resultArr = [];\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = 0; j < arr[i].length; j++) {\n      let value = arr[i][j];\n      let enter = 1;\n      for (let k = 0; enter !== 3 && k < arr.length; k++) {\n        if (k !== i && arr[k].indexOf(value) != -1) {\n          enter = 2;\n        } else if (k !== i) {\n          enter = 3;\n        }\n      }\n      if (enter == 1 && arr.length > 1) {\n        enter = 3;\n      } else if (enter == 1 && arr.length === 1) {\n        enter = 2;\n      }\n      if (enter == 2 && resultArr.indexOf(value) == -1) {\n        resultArr.push(value);\n      }\n    }\n  }\n\n  if (arr.length <= 0) {\n    return error.value;\n  }\n\n  for (let i = 0; i < resultArr.length; i++) {\n    let a = range[resultArr[i]];\n    if (a && !isNaN(a)) {\n      result += a;\n    } else {\n      return 0;\n    }\n  }\n\n  return result;\n};\n//XWend\n\nexports.SUMPRODUCT = function() {\n  if (!arguments || arguments.length === 0) {\n    return error.value;\n  }\n  var arrays = arguments.length + 1;\n  var result = 0;\n  var product;\n  var k;\n  var _i;\n  var _ij;\n  for (var i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1;\n      for (k = 1; k < arrays; k++) {\n        _i = utils.parseNumber(arguments[k - 1][i]);\n        if (_i instanceof Error) {\n          return _i;\n        }\n        product *= _i;\n      }\n      result += product;\n    } else {\n      for (var j = 0; j < arguments[0][i].length; j++) {\n        product = 1;\n        for (k = 1; k < arrays; k++) {\n          _ij = utils.parseNumber(arguments[k - 1][i][j]);\n          if (_ij instanceof Error) {\n            return _ij;\n          }\n          product *= _ij;\n        }\n        result += product;\n      }\n    }\n  }\n  return result;\n};\n\nexports.SUMSQ = function() {\n  var numbers = utils.parseNumberArray(utils.flatten(arguments));\n  if (numbers instanceof Error) {\n    return numbers;\n  }\n  var result = 0;\n  var length = numbers.length;\n  for (var i = 0; i < length; i++) {\n    result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\n  }\n  return result;\n};\n\nexports.SUMX2MY2 = function (array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMX2PY2 = function (array_x, array_y) {\n  //XW: \n  if (typeof array_x == \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y == \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  //XWend\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMXMY2 = function(array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.flatten(array_x);\n  array_y = utils.flatten(array_y);\n  for (var i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2);\n  }\n  return result;\n};\n\nexports.TAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.tan(number);\n};\n\nexports.TANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 - 1) / (e2 + 1);\n};\n\nexports.TRUNC = function(number, digits) {\n  digits = (digits === undefined) ? 0 : digits;\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};","const checker = require('./formula_check.js');\nconst error = require('./formulajs/lib/error');\nclass CalcCell { // cell,\n  constructor(formulas_i, rows) {\n    this.cell = formulas_i.cell\n    this.rows = rows\n    this.f = formulas_i.cell.f\n    this.name = formulas_i.name\n    this.sheet = formulas_i.sheet\n  }\n\n  //\n  check_valid() {\n    var text = this.f\n    //==A1\n    if (text[1] === '='){\n      return error.name\n    }\n    var params = text.match('=[a-z|A-Z]{2,100}')\n    if (params != null && this.f.indexOf('(') <0 && this.f.indexOf(')')<0){\n      return error.name\n    }\n    // \"\" \"\"\n    if (this.f.indexOf('\"\"') >= 1 && this.f.indexOf('(') < 0 && this.f.indexOf(')') < 0) {\n      return this.f.slice(2, this.f.length - 1).replace('\"\"', '\"')\n    }\n    return true\n  }\n\n  //{}''\n  trans_params(fml) {\n    var reg = new RegExp('\\{(.*?)\\}', 'g')\n    var arg = fml.match(reg)\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i]\n        var rep = \"'\" + param + \"'\"\n        fml = fml.replace(param, rep)\n      }\n    }\n    return fml\n  }\n\n  //\n  trans_formula() {\n    var fml = this.f\n    //\n    fml = checker.strim(fml)\n    //\n    fml = checker.trans_formula(fml)\n    if (fml.indexOf('{') >= 0 && fml.indexOf('}') >= 0 && fml.indexOf(\"'{\") < 0) {// XW: \n      fml = this.trans_params(fml)\n    }\n    return fml\n  }\n\n  //\n  recover_formula() {\n    return checker.strim(this.f)\n  }\n}\n\nmodule.exports = CalcCell;","var exp = require(\"../core/alphabet\");\nvar error = require('./formulajs/lib/error');\n\n\nfunction isEqual(v1, v2) {\n  v1 = v1 + \"\";\n  v2 = v2 + \"\";\n  v1 = v1.toUpperCase();\n  v2 = v2.toUpperCase();\n  if (v1 === v2) {\n    return true;\n  }\n  return false;\n}\n\nfunction isHave(param) {\n  if (typeof param === \"undefined\") {\n    return false;\n  }\n  if (param === null) {\n    return false;\n  }\n  return true;\n}\nclass CalcWorkBook { // workbook\n  constructor(rows, tileArr) {\n    this.rows = rows\n    this.tileArr = tileArr\n  }\n\n  // workbook\n  get_workbook(workbook){\n    let {data} = this.rows;\n    let name = data['name']\n    var need_calc_cells = this.tileArr.findAllNeedCalcCell()\n    for (var i=0;i<need_calc_cells.length;i++){\n      var cell_name = need_calc_cells[i]\n      var zb = exp.expr2xy(cell_name)\n      var cell = this.rows.getCell(zb[1], zb[0])\n      if(isHave(cell)){\n        workbook.Sheets[name][cell_name] = {v: cell.text, f: cell.formulas, multivalueRefsCell: cell.multivalueRefsCell, source_v: cell.source_v}\n      }\n    }\n    return workbook\n  }\n\n  //workbookrows\n  calcDoneToSetCells(workbook, rows) {\n    let {data} = rows;\n    let name = data['name']\n    var sheet = workbook.Sheets[name]\n    Object.keys(sheet).forEach(i => {\n      let arg = exp.expr2xy(i);\n      if (isHave(sheet[i]) && isHave(sheet[i].v) && isHave(sheet[i].f)) {\n        var cell = rows.getCell(arg[1], arg[0])\n        if (!isHave(cell)){\n          cell = {}\n        }\n        cell.text = sheet[i].v\n        cell.formulas = sheet[i].f\n        cell.multivalueRefsCell = sheet[i].multivalueRefsCell\n        if (isHave(sheet[i].source_v)){\n          cell.source_v = sheet[i].source_v\n        }\n        rows.setCell(arg[1], arg[0], cell);\n      }\n    });\n    rows.workbook = workbook\n  }\n\n  // \n  is_muti_cell(formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    if (multivalueRefsCell !== null) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    }\n    return isHave(multivalueRefsCell) ? true : false\n  }\n\n  //\n  process_arr(){\n\n  }\n\n\n  //\n  process_matrix(formulas_i, multivalueRefsCell){\n    let enter = true\n    var cell_v = formulas_i.cell.v\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    let cell = \"\", expr = 0;\n    var wb = formulas_i.sheet\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        var v = cell_v[i][j]\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": v,\n            \"f\": formulas_i.cell.f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          var source = this.rows.getCell( cell_y + j,  cell_x + i);\n          if (!isHave(source) || !isHave(source.text) || (isHave(source.text) && (isEqual(source.text, v) || source.text === \"\"))) {\n            wb[c] = {\n              \"v\": cell_v[i][j],\n              \"f\": cell_v[i][j],\n              'multivalueRefsCell': multivalueRefsCell\n            }\n          } else {\n            wb[c] = {\n              \"v\": source.v,\n              \"f\": source.f,\n              'multivalueRefsCell': multivalueRefsCell\n            }\n            enter = false;\n            cell = source;\n            expr = c;\n          }\n        }\n      }\n    }\n    if(!enter) {\n      return this.clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr)\n    }else{\n      return wb\n    }\n  }\n\n\n  //\n  clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr){\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": error.ref,\n            \"f\": wb[c].f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else if (expr === c) {\n          wb[c] = {\n            \"v\": cell.text,\n            \"f\": cell.formulas,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n  //\n  clean_all_flag(formulas_i, multivalueRefsCell){\n    var wb = formulas_i.sheet\n    var zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = zb[0]\n    var cell_y = zb[1]\n    var cell = this.rows.getCell(zb[1], zb[0])\n    var cell_v = cell.source_v\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": formulas_i.cell.v,\n            \"f\": formulas_i.cell.f,\n            \"source_v\": \"\"\n          }\n        } else if (this.rows.getCell(cell_y + j, cell_x + i).text !== cell_v[i][j]) {\n          wb[c] = {\n            \"v\": this.rows.getCell(cell_y + j, cell_x + i).text,\n            \"f\": this.rows.getCell(cell_y + j, cell_x + i).formulas,\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n\n  //\n  deal_muti_cell(workbook, formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    let {data} = this.rows;\n    let name = data['name']\n    if (isHave(multivalueRefsCell) && isHave(multivalueRefsCell.multivalueRefsCell)) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    } else {\n      multivalueRefsCell = formulas_i.name;\n    }\n    var cell_v = formulas_i.cell.v\n    if (formulas_i.name !== multivalueRefsCell){\n      if (cell_v instanceof Array){\n        workbook.Sheets[name][formulas_i.name].v = error.ref\n        workbook.Sheets[name][formulas_i.name].source_v = cell_v\n      }else if(isHave(cell_v)){\n        workbook.Sheets[name][formulas_i.name].v = cell_v\n      }\n    }else {\n      if(!(cell_v instanceof Array)) {\n        workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n      }else{\n        var zb = exp.expr2xy(multivalueRefsCell)\n        if (isHave(this.rows.getCell(zb[1], zb[0]).source_v) && this.rows.getCell(zb[1], zb[0]).source_v !== cell_v){\n          workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n        }\n        var len = cell_v.length\n        if (len === 1){\n          workbook.Sheets[name] = this.process_arr(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }else{\n          workbook.Sheets[name] = this.process_matrix(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CalcWorkBook;","import PreAction from \"../model/pre_action\";\n\nmodule.exports = {\n    PreAction\n};","var mathTrig = require('./math-trig');\nvar text = require('./text');\nvar jStat = require('jStat').jStat;\nvar utils = require('./utils');\nvar error = require('./error');\nvar misc = require('./miscellaneous');\nvar evalExpression = require('./expression')\nvar SQRT2PI = 2.5066282746310002;\n\nexports.AVEDEV = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length;\n};\n\nexports.AVERAGE = function() {\n  var range = utils.flattenNum(arguments);\n  if (range instanceof Error) {\n    return range;\n  }\n  if (range.length === 0){\n    return error.div0\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    sum += range[i];\n    count += 1;\n  }\n  return sum / count;\n};\n\nexports.AVERAGEA = function() {\n  var range = utils.flattenNum(arguments);\n  if (range.length == 1 && isNaN(range[0])){\n    return error.value\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sum += el;\n    }\n    if (el === true) {\n      sum++;\n    }\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sum / count;\n};\n\nexports.AVERAGEIF = function (range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na;\n  }\n  average_range = average_range || range;\n  range = utils.flatten(range);\n  average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n  if (average_range instanceof Error) {\n    return average_range;\n  }\n  var average_count = 0;\n  var result = 0;\n  var isWildcard = criteria === void 0 || criteria === '*';\n  var tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '');\n  var filter_criteria = criteria.replace('=', '').replace('*', '').replace('<>', '')\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n\n    if (isWildcard) {\n      result += average_range[i];\n      average_count++;\n    } else {\n      var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n      if (criteria.indexOf('<>') >= 0){\n        if (value.indexOf(filter_criteria) < 0) {\n          result += average_range[i];\n          average_count++;\n        }\n      }else if (evalExpression.compute(tokens) || value.toString().indexOf(filter_criteria) >= 0) {\n        result += average_range[i];\n        average_count++;\n      }\n    }\n  }\n  if (average_count == 0){\n    return error.div0\n  }\n  return result / average_count;\n};\n\nexports.AVERAGEIFS = function () {\n  // Does not work with multi dimensional ranges yet!\n  //http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  var args = utils.argsToArray(arguments);\n  var criteriaLength = (args.length - 1) / 2;\n  var range = utils.flatten(args[0]);\n  var count = 0;\n  var result = 0;\n\n  for (var i = 0; i < range.length; i++) {\n    var isMeetCondition = false;\n\n    for (var j = 0; j < criteriaLength; j++) {\n      var value = args[2 * j + 1][i];\n      var criteria = args[2 * j + 2];\n      var isWildcard = criteria === void 0 || criteria === '*';\n      var computedResult = false;\n\n      if (isWildcard) {\n        computedResult = true;\n      } else {\n        var tokenizedCriteria = evalExpression.parse(criteria + '');\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n        computedResult = evalExpression.compute(tokens);\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false;\n        break;\n      }\n\n      isMeetCondition = true;\n    }\n\n    if (isMeetCondition) {\n      result += range[i];\n      count++;\n    }\n  }\n\n  var average = result / count;\n\n  if (isNaN(average)) {\n    return error.div0;\n  } else {\n    return average;\n  }\n};\n\nexports.BETA = {};\n\nexports.BETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value;\n  }\n\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value;\n  }\n  cumulative = utils.parseBool(cumulative)\n  x = (x - A) / (B - A);\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)/2;\n};\n\nexports.BETA.INV = function(probability, alpha, beta, A, B) {\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value;\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A;\n};\n\nexports.BINOM = {};\n\nexports.BINOM.DIST = function (successes, trials, probability, cumulative) {\n  successes = utils.parseNumber(successes);\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  cumulative = utils.parseBool(cumulative)\n  cumulative = utils.parseNumber(cumulative);\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.binomial.cdf(successes, trials, probability) : jStat.binomial.pdf(successes, trials, probability);\n};\n\nexports.BINOM.INV = function(trials, probability, alpha) {\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value;\n  }\n\n  var x = 0;\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x;\n    }\n    x++;\n  }\n};\n\nexports.CHISQ = {};\n\nexports.CHISQ.DIST = function(x, k, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (x < 0){\n    return error.num\n  }\n  x = utils.parseNumber(x);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(x, k)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k);\n};\n\nexports.CHISQ.DIST.RT = function(x, k) {\n  if (!x | !k) {\n    return error.na;\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return 1 -  jStat.chisquare.cdf(x, k);\n};\n\nexports.CHISQ.INV = function(probability, k) {\n  probability = utils.parseNumber(probability);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(probability, k)) {\n    return error.value;\n  }\n  return jStat.chisquare.inv(probability, k);\n};\n\nexports.CHISQ.INV.RT = function(p, k) {\n  if (!p | !k) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k);\n};\n\nexports.CHISQ.TEST = function(observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {\n    return error.value;\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value;\n  }\n\n  if (observed[0] && expected[0] &&\n      observed[0].length !== expected[0].length) {\n    return error.value;\n  }\n\n  var row = observed.length;\n  var tmp, i, j;\n\n  // Convert single-dimension array into two-dimension array\n  for (i = 0; i < row; i ++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i];\n      observed[i] = [];\n      observed[i].push(tmp);\n    }\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i];\n      expected[i] = [];\n      expected[i].push(tmp);\n    }\n  }\n\n  var col = observed[0].length;\n  var dof = (col === 1) ? row-1 : (row-1)*(col-1);\n  var xsqr = 0;\n  var Pi =Math.PI;\n\n  for (i = 0; i < row; i ++) {\n    for (j = 0; j < col; j ++) {\n      xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    var p = Math.exp(-0.5 * xsqr);\n    if((dof%2) === 1) {\n      p = p * Math.sqrt(2 * xsqr/Pi);\n    }\n    var k = dof;\n    while(k >= 2) {\n      p = p * xsqr/k;\n      k = k - 2;\n    }\n    var t = p;\n    var a = dof;\n    while (t > 0.0000000001*p) {\n      a = a + 2;\n      t = t * xsqr/a;\n      p = p + t;\n    }\n    return 1-p;\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;\n};\n\nexports.COLUMN = function() {\n  col_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n  cell_name = this.args[0].formula.name\n  cell_name = cell_name.replace(/\\d+/g,'')\n  return col_list.indexOf(cell_name)+1\n};\n\nexports.COLUMNS = function(matrix) {\n  if (typeof matrix === 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.cols(matrix);\n};\n\nexports.CONFIDENCE = {};\n\nexports.CONFIDENCE.NORM = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.normalci(1, alpha, sd, n)[1] - 1;\n};\n\nexports.CONFIDENCE.T = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.tci(1, alpha, sd, n)[1] - 1;\n};\nexports.IFS = function() {\n  for (var i = 0; i + 1 < arguments.length; i += 2) {\n    var cond = arguments[i];\n    var val = arguments[i + 1];\n    if (cond) {\n      return val;\n    }\n  }\n  return error.na;\n}\nexports.CORREL = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.corrcoeff(array1, array2);\n};\n\nexports.COUNT = function() {\n  return utils.numbers(utils.flatten(arguments)).length;\n};\n\nexports.COUNTA = function() {\n  var range = utils.flatten(arguments);\n  return range.length - exports.COUNTBLANK(range);\n};\n\nexports.COUNTIN = function (range, value) {\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++;\n    }\n  }\n  return result;\n};\n\n\nexports.COUNTBLANK = function() {\n  var range = utils.flatten(arguments);\n  var blanks = 0;\n  var element;\n  for (var i = 0; i < range.length; i++) {\n    element = range[i];\n    if (element === null || element === '') {\n      blanks++;\n    }\n  }\n  return blanks;\n};\n\nexports.COUNTIF = function (range, criteria) {\n  range = utils.flatten(range);\n  if (criteria === undefined) {\n    return error.value;\n  }\n  var isWildcard = criteria === void 0 || criteria === '*';\n\n  if (isWildcard) {\n    return range.length;\n  }\n\n  var matches = 0;\n  var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n    var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n    if (evalExpression.compute(tokens)) {\n      matches++;\n    }\n  }\n\n  return matches;\n};\n\nexports.COUNTIFS = function () {\n  var args = utils.argsToArray(arguments);\n  var results = new Array(utils.flatten(args[0]).length);\n\n  for (var i = 0; i < results.length; i++) {\n    results[i] = true;\n  }\n  for (i = 0; i < args.length; i += 2) {\n    var range = utils.flatten(args[i]);\n    var criteria = args[i + 1];\n    var isWildcard = criteria === void 0 || criteria === '*';\n\n    if (!isWildcard) {\n      var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n      for (var j = 0; j < range.length; j++) {\n        var value = range[j];\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n        results[j] = results[j] && evalExpression.compute(tokens);\n      }\n    }\n  }\n  var result = 0;\n  for (i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++;\n    }\n  }\n  return result;\n};\n\nexports.COUNTUNIQUE = function () {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length;\n};\n\nexports.COVARIANCE = {};\n\nexports.COVARIANCE.P = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  var mean1 = jStat.mean(array1);\n  var mean2 = jStat.mean(array2);\n  var result = 0;\n  var n = array1.length;\n  for (var i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2);\n  }\n  return result / n;\n};\n\nexports.COVARIANCE.S = function(array1, array2) {\n  if (typeof array1 == \"string\") {\n    array1 = utils.strToMatrix(array1);\n  }\n  if (typeof array2 == \"string\") {\n    array2 = utils.strToMatrix(array2);\n  }\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.covariance(array1, array2);\n};\n\nexports.DEVSQ = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += Math.pow((range[i] - mean), 2);\n  }\n  return result;\n};\n\nexports.EXPON = {};\n\nexports.EXPON.DIST = function(x, lambda, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  lambda = utils.parseNumber(lambda);\n  if (utils.anyIsError(x, lambda)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda);\n};\n\nexports.F = {};\n\nexports.F.DIST = function (x, d1, d2, cumulative) {\n  x = utils.parseNumber(x);\n  d1 = utils.parseNumber(d1);\n  d2 = utils.parseNumber(d2);\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value;\n  }\n  if (cumulative == undefined){\n    cumulative = true\n  }\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value\n  }\n  if (cumulative == 'FALSE'){\n    cumulative = false\n  }\n  return (cumulative) ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2);\n};\n\nexports.F.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2);\n};\n\nexports.F.INV = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.TEST = function (array1, array2) {\n  if (!array1 || !array2) {\n    return error.na;\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na;\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0;\n  }\n\n  var sumOfSquares = function (values, x1) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n      sum += Math.pow((values[i] - x1), 2);\n    }\n    return sum;\n  };\n\n  var x1 = mathTrig.SUM(array1) / array1.length;\n  var x2 = mathTrig.SUM(array2) / array2.length;\n  var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);\n  var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);\n\n  return sum1 / sum2;\n};\n\nexports.FISHER = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return x;\n  }\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n\nexports.FISHERINV = function(y) {\n  y = utils.parseNumber(y);\n  if (y instanceof Error) {\n    return y;\n  }\n  var e2y = Math.exp(2 * y);\n  return (e2y - 1) / (e2y + 1);\n};\n\nexports.FORECAST = function(x, data_y, data_x) {\n  x = utils.parseNumber(x);\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var b = num / den;\n  var a = ymean - b * xmean;\n  return a + b * x;\n};\n\nexports.FREQUENCY = function(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data));\n  bins = utils.parseNumberArray(utils.flatten(bins));\n  if (utils.anyIsError(data, bins)) {\n    return error.value;\n  }\n  var n = data.length;\n  var b = bins.length;\n  var r = [];\n  for (var i = 0; i <= b; i++) {\n    r[i] = 0;\n    for (var j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1;\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1;\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1;\n        }\n      }\n    }\n  }\n  return r;\n};\n\n\nexports.GAMMA = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  if (number === 0) {\n    return error.num;\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num;\n  }\n\n  return jStat.gammafn(number);\n};\n\nexports.GAMMA.DIST = function(value, alpha, beta, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (arguments.length !== 4) {\n    return error.na;\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value;\n  }\n\n  if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false);\n};\n\nexports.GAMMA.INV = function(probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num;\n  }\n\n  if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta);\n};\n\nexports.GAMMALN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return jStat.gammaln(number);\n};\n\nexports.GAMMALN.PRECISE = function(x) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (x <= 0) {\n    return error.num;\n  }\n\n  if (typeof x !== 'number') {\n    return error.value;\n  }\n\n  return jStat.gammaln(x);\n};\n\nexports.GAUSS = function(z) {\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return z;\n  }\n  return jStat.normal.cdf(z, 0, 1) - 0.5;\n};\n\nexports.GEOMEAN = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  return jStat.geomean(args);\n};\n\nexports.GROWTH = function(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n\n  known_y = utils.parseNumberArray(known_y);\n  if (known_y instanceof Error) {\n    return known_y;\n  }\n\n  // Default values for optional parameters:\n  var i;\n  if (known_x === undefined) {\n    known_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i);\n    }\n  }\n  if (new_x === undefined) {\n    new_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i);\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x);\n  new_x = utils.parseNumberArray(new_x);\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value;\n  }\n\n\n  if (use_const === undefined) {\n    use_const = true;\n  }\n\n  // Calculate sums over the data:\n  var n = known_y.length;\n  var avg_x = 0;\n  var avg_y = 0;\n  var avg_xy = 0;\n  var avg_xx = 0;\n  for (i = 0; i < n; i++) {\n    var x = known_x[i];\n    var y = Math.log(known_y[i]);\n    avg_x += x;\n    avg_y += y;\n    avg_xy += x * y;\n    avg_xx += x * x;\n  }\n  avg_x /= n;\n  avg_y /= n;\n  avg_xy /= n;\n  avg_xx /= n;\n\n  // Compute linear regression coefficients:\n  var beta;\n  var alpha;\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);\n    alpha = avg_y - beta * avg_x;\n  } else {\n    beta = avg_xy / avg_xx;\n    alpha = 0;\n  }\n\n  // Compute and return result array:\n  var new_y = [];\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]));\n  }\n  return new_y;\n};\n\nexports.HARMEAN = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    den += 1 / range[i];\n  }\n  return n / den;\n};\n\nexports.HYPGEOM = {};\n\nexports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  M = utils.parseNumber(M);\n  N = utils.parseNumber(N);\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value;\n  }\n\n  function pdf(x, n, M, N) {\n    return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);\n  }\n\n  function cdf(x, n, M, N) {\n    var result = 0;\n    for (var i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N);\n    }\n    return result;\n  }\n\n  return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);\n};\n\nexports.INTERCEPT = function(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y);\n  known_x = utils.parseNumberArray(known_x);\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value;\n  }\n  if (known_y.length !== known_x.length) {\n    return error.na;\n  }\n  return exports.FORECAST(0, known_y, known_x);\n};\n\nexports.KURT = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4);\n  }\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4);\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));\n};\n\nexports.LARGE = function(range, k) {\n  range = utils.flatten(range)\n  var arr = []\n  for ( var i=0;i<range.length;i++){\n    if (parseFloat(range[i])){\n      arr.push((parseFloat(range[i])))\n    }\n  }\n  range = arr;\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function (a, b) {\n    return b - a;\n  })[k - 1];\n};\n\nexports.LINEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var ymean = jStat.mean(data_y);\n  var xmean = jStat.mean(data_x);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var m = num / den;\n  var b = ymean - m * xmean;\n  return [m, b];\n};\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexports.LOGEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  for (var i = 0; i < data_y.length; i ++) {\n    data_y[i] = Math.log(data_y[i]);\n  }\n\n  var result = exports.LINEST(data_y, data_x);\n  result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;\n  result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;\n  return result;\n};\n\nexports.LOGNORM = {};\n\nexports.LOGNORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd);\n};\n\nexports.LOGNORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.lognormal.inv(probability, mean, sd);\n};\n\nexports.MAX = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MAXA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MEDIAN = function() {\n  var arr = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  var arr2 = []\n  for (var i=0;i<arr.length;i++){\n    if (typeof arr[i] === 'number'){\n      arr2.push(arr[i])\n    }\n  }\n  var range = utils.arrayValuesToNumbers(utils.flatten(arr2));\n  return jStat.median(range);\n};\n\nexports.MIN = function() {\n  var range = utils.flatten(arguments);\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MINA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MODE = {};\n\nexports.MODE.MULT = function() {\n  // Credits: Ronan\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var count = {};\n  var maxItems = [];\n  var max = 0;\n  var currentItem;\n\n  for (var i = 0; i < n; i++) {\n    currentItem = range[i];\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n    if (count[currentItem] > max) {\n      max = count[currentItem];\n      maxItems = [];\n    }\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem;\n    }\n  }\n  return maxItems;\n};\n\nexports.MODE.SNGL = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return exports.MODE.MULT(range).sort(function(a, b) {\n    return a - b;\n  })[0];\n};\n\nexports.NEGBINOM = {};\n\nexports.NEGBINOM.DIST = function(k, r, p, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  k = utils.parseNumber(k);\n  r = utils.parseNumber(r);\n  p = utils.parseNumber(p);\n  if (utils.anyIsError(k, r, p)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p);\n};\n\nexports.NORM = {};\n\nexports.NORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  if (sd <= 0) {\n    return error.num;\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return (cumulative) ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd);\n};\n\nexports.NORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, mean, sd);\n};\n\nexports.NORM.S = {};\n\nexports.NORM.S.DIST = function(z, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1);\n};\n\nexports.NORM.S.INV = function(probability) {\n  probability = utils.parseNumber(probability);\n  if (probability instanceof Error) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, 0, 1);\n};\n\nexports.PEARSON = function(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den1 = 0;\n  var den2 = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den1 += Math.pow(data_x[i] - xmean, 2);\n    den2 += Math.pow(data_y[i] - ymean, 2);\n  }\n  return num / Math.sqrt(den1 * den2);\n};\n\nexports.PERCENTILE = {};\n\nexports.PERCENTILE.EXC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    {\n      return a - b;\n    }\n  });\n  var n = array.length;\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num;\n  }\n  var l = k * (n + 1) - 1;\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTILE.INC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var n = array.length;\n  var l = k * (n - 1);\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTRANK = {};\n\nexports.PERCENTRANK.EXC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERCENTRANK.INC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERMUT = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);\n};\n\nexports.PERMUTATIONA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return Math.pow(number, number_chosen);\n};\n\nexports.PHI = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return error.value;\n  }\n  return Math.exp(-0.5 * x * x) / SQRT2PI;\n};\n\nexports.POISSON = {};\n\nexports.POISSON.DIST = function(x, mean, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  if (utils.anyIsError(x, mean)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean);\n};\n\nexports.PROB = function(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0;\n  }\n  upper = (upper === undefined) ? lower : upper;\n\n  range = utils.parseNumberArray(utils.flatten(range));\n  probability = utils.parseNumberArray(utils.flatten(probability));\n  lower = utils.parseNumber(lower);\n  upper = utils.parseNumber(upper);\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value;\n  }\n\n  if (lower === upper) {\n    return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\n  }\n\n  var sorted = range.sort(function(a, b) {\n    return a - b;\n  });\n  var n = sorted.length;\n  var result = 0;\n  for (var i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])];\n    }\n  }\n  return result;\n};\n\nexports.QUARTILE = {};\n\nexports.QUARTILE.EXC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.EXC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.EXC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.EXC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.QUARTILE.INC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.INC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.INC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.INC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.RANK = {};\n\nexports.RANK.AVG = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  range = utils.flatten(range);\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n\n  var length = range.length;\n  var count = 0;\n  for (var i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++;\n    }\n  }\n\n  return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n};\n\nexports.RANK.EQ = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n  return range.indexOf(number) + 1;\n};\n\nexports.ROW = function(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (index < 0) {\n    return error.num;\n  }\n\n  if (!(matrix instanceof Array) || (typeof index !== 'number')) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return undefined;\n  }\n\n  return jStat.row(matrix, index);\n};\n\nexports.ROWS = function(matrix) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\n\nexports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n  return Math.pow(exports.PEARSON(data_x, data_y), 2);\n};\n\nexports.SKEW = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3);\n  }\n  return n * sigma / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3));\n};\n\nexports.SKEW.P = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var m2 = 0;\n  var m3 = 0;\n  for (var i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3);\n    m2 += Math.pow(range[i] - mean, 2);\n  }\n  m3 = m3 / n;\n  m2 = m2 / n;\n  return m3 / Math.pow(m2, 3 / 2);\n};\n\nexports.SLOPE = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return num / den;\n};\n\nexports.SMALL = function(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function(a, b) {\n    return a - b;\n  })[k - 1];\n};\n\nexports.STANDARDIZE = function(x, mean, sd) {\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (x - mean) / sd;\n};\n\nexports.STDEV = {};\n\nexports.STDEV.P = function() {\n  var v = exports.VAR.P.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEV.S = function() {\n  var v = exports.VAR.S.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVA = function() {\n  var v = exports.VARA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVPA = function() {\n  var v = exports.VARPA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\n\nexports.STEYX = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var lft = 0;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2);\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return Math.sqrt((lft - num * num / den) / (n - 2));\n};\n\nexports.TRANSPOSE = function(matrix) {\n  if (!matrix) {\n    return error.na;\n  }\n  return jStat.transpose(matrix);\n};\n\nexports.T = text.T;\n\nexports.T.DIST = function (x, df, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  df = utils.parseNumber(df);\n  if (utils.anyIsError(x, df)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.studentt.cdf(x, df) : jStat.studentt.pdf(x, df);\n};\n\nexports.T.DIST['2T'] = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return (1 - jStat.studentt.cdf(x , df)) * 2;\n};\n\nexports.T.DIST.RT = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.studentt.cdf(x , df);\n};\n\nexports.T.INV = function (probability, df) {\n  // probability = utils.parseNumber(probability);\n  // df = utils.parseNumber(df);\n  // if (utils.anyIsError(probability, df)) {\n  //   return error.value;\n  // }\n  // var res = jStat.studentt.inv(probability, df);\n  // return res\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\nexports.T.INV['2T'] = function(probability, df) {\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nexports.T.TEST = function(data_x, data_y) {\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n\n  var mean_x = jStat.mean(data_x);\n  var mean_y = jStat.mean(data_y);\n  var s_x = 0;\n  var s_y = 0;\n  var i;\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2);\n  }\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2);\n  }\n\n  s_x = s_x / (data_x.length-1);\n  s_y = s_y / (data_y.length-1);\n\n  var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);\n\n  return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);\n};\n\nexports.TREND = function (data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  var linest = exports.LINEST(data_y, data_x);\n  var m = linest[0];\n  var b = linest[1];\n  return m * new_data_x + b\n};\n\nexports.TRIMMEAN = function (range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  percent = utils.parseNumber(percent);\n  if (utils.anyIsError(range, percent)) {\n    return error.value;\n  }\n  var trim = mathTrig.FLOORMATH(range.length * percent, 2) / 2;\n  return jStat.mean(utils.initial(utils.rest(range.sort(function (a, b) {\n    return a - b;\n  }), trim), trim));\n};\n\nexports.VAR = {};\n\nexports.VAR.P = function () {\n  var range = utils.numbers(utils.flatten(arguments));\n  if (range.length==0){\n    return error.value\n  }\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  if (isNaN(sigma / n)){\n    return error.value\n  }else{\n    return sigma / n;\n  }\n};\n\nexports.VAR.S = function() {\n  var range = utils.numbers(utils.flatten(arguments));\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  return sigma / (n - 1);\n};\n\nexports.VARA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / (count - 1);\n};\n\nexports.VARPA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / count;\n};\n\nexports.WEIBULL = {};\n\nexports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\n  //XW:\n  cumulative = utils.parseBool(cumulative)\n  //XWend\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value;\n  }\n  return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n};\n\nexports.Z = {};\n\nexports.Z.TEST = function (range, x, sd) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  x = utils.parseNumber(x);\n  if (utils.anyIsError(range, x)) {\n    return error.value;\n  }\n\n  sd = sd || exports.STDEV.S(range);\n  var n = range.length;\n  return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n};\n","var exp = require(\"../core/alphabet\");\nconst helper = require(\"../core/helper\");\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};\n\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};","var map = {\n\t\"./af\": 64,\n\t\"./af.js\": 64,\n\t\"./ar\": 65,\n\t\"./ar-dz\": 66,\n\t\"./ar-dz.js\": 66,\n\t\"./ar-kw\": 67,\n\t\"./ar-kw.js\": 67,\n\t\"./ar-ly\": 68,\n\t\"./ar-ly.js\": 68,\n\t\"./ar-ma\": 69,\n\t\"./ar-ma.js\": 69,\n\t\"./ar-sa\": 70,\n\t\"./ar-sa.js\": 70,\n\t\"./ar-tn\": 71,\n\t\"./ar-tn.js\": 71,\n\t\"./ar.js\": 65,\n\t\"./az\": 72,\n\t\"./az.js\": 72,\n\t\"./be\": 73,\n\t\"./be.js\": 73,\n\t\"./bg\": 74,\n\t\"./bg.js\": 74,\n\t\"./bm\": 75,\n\t\"./bm.js\": 75,\n\t\"./bn\": 76,\n\t\"./bn.js\": 76,\n\t\"./bo\": 77,\n\t\"./bo.js\": 77,\n\t\"./br\": 78,\n\t\"./br.js\": 78,\n\t\"./bs\": 79,\n\t\"./bs.js\": 79,\n\t\"./ca\": 80,\n\t\"./ca.js\": 80,\n\t\"./cs\": 81,\n\t\"./cs.js\": 81,\n\t\"./cv\": 82,\n\t\"./cv.js\": 82,\n\t\"./cy\": 83,\n\t\"./cy.js\": 83,\n\t\"./da\": 84,\n\t\"./da.js\": 84,\n\t\"./de\": 85,\n\t\"./de-at\": 86,\n\t\"./de-at.js\": 86,\n\t\"./de-ch\": 87,\n\t\"./de-ch.js\": 87,\n\t\"./de.js\": 85,\n\t\"./dv\": 88,\n\t\"./dv.js\": 88,\n\t\"./el\": 89,\n\t\"./el.js\": 89,\n\t\"./en-SG\": 90,\n\t\"./en-SG.js\": 90,\n\t\"./en-au\": 91,\n\t\"./en-au.js\": 91,\n\t\"./en-ca\": 92,\n\t\"./en-ca.js\": 92,\n\t\"./en-gb\": 93,\n\t\"./en-gb.js\": 93,\n\t\"./en-ie\": 94,\n\t\"./en-ie.js\": 94,\n\t\"./en-il\": 95,\n\t\"./en-il.js\": 95,\n\t\"./en-nz\": 96,\n\t\"./en-nz.js\": 96,\n\t\"./eo\": 97,\n\t\"./eo.js\": 97,\n\t\"./es\": 98,\n\t\"./es-do\": 99,\n\t\"./es-do.js\": 99,\n\t\"./es-us\": 100,\n\t\"./es-us.js\": 100,\n\t\"./es.js\": 98,\n\t\"./et\": 101,\n\t\"./et.js\": 101,\n\t\"./eu\": 102,\n\t\"./eu.js\": 102,\n\t\"./fa\": 103,\n\t\"./fa.js\": 103,\n\t\"./fi\": 104,\n\t\"./fi.js\": 104,\n\t\"./fo\": 105,\n\t\"./fo.js\": 105,\n\t\"./fr\": 106,\n\t\"./fr-ca\": 107,\n\t\"./fr-ca.js\": 107,\n\t\"./fr-ch\": 108,\n\t\"./fr-ch.js\": 108,\n\t\"./fr.js\": 106,\n\t\"./fy\": 109,\n\t\"./fy.js\": 109,\n\t\"./ga\": 110,\n\t\"./ga.js\": 110,\n\t\"./gd\": 111,\n\t\"./gd.js\": 111,\n\t\"./gl\": 112,\n\t\"./gl.js\": 112,\n\t\"./gom-latn\": 113,\n\t\"./gom-latn.js\": 113,\n\t\"./gu\": 114,\n\t\"./gu.js\": 114,\n\t\"./he\": 115,\n\t\"./he.js\": 115,\n\t\"./hi\": 116,\n\t\"./hi.js\": 116,\n\t\"./hr\": 117,\n\t\"./hr.js\": 117,\n\t\"./hu\": 118,\n\t\"./hu.js\": 118,\n\t\"./hy-am\": 119,\n\t\"./hy-am.js\": 119,\n\t\"./id\": 120,\n\t\"./id.js\": 120,\n\t\"./is\": 121,\n\t\"./is.js\": 121,\n\t\"./it\": 122,\n\t\"./it-ch\": 123,\n\t\"./it-ch.js\": 123,\n\t\"./it.js\": 122,\n\t\"./ja\": 124,\n\t\"./ja.js\": 124,\n\t\"./jv\": 125,\n\t\"./jv.js\": 125,\n\t\"./ka\": 126,\n\t\"./ka.js\": 126,\n\t\"./kk\": 127,\n\t\"./kk.js\": 127,\n\t\"./km\": 128,\n\t\"./km.js\": 128,\n\t\"./kn\": 129,\n\t\"./kn.js\": 129,\n\t\"./ko\": 130,\n\t\"./ko.js\": 130,\n\t\"./ku\": 131,\n\t\"./ku.js\": 131,\n\t\"./ky\": 132,\n\t\"./ky.js\": 132,\n\t\"./lb\": 133,\n\t\"./lb.js\": 133,\n\t\"./lo\": 134,\n\t\"./lo.js\": 134,\n\t\"./lt\": 135,\n\t\"./lt.js\": 135,\n\t\"./lv\": 136,\n\t\"./lv.js\": 136,\n\t\"./me\": 137,\n\t\"./me.js\": 137,\n\t\"./mi\": 138,\n\t\"./mi.js\": 138,\n\t\"./mk\": 139,\n\t\"./mk.js\": 139,\n\t\"./ml\": 140,\n\t\"./ml.js\": 140,\n\t\"./mn\": 141,\n\t\"./mn.js\": 141,\n\t\"./mr\": 142,\n\t\"./mr.js\": 142,\n\t\"./ms\": 143,\n\t\"./ms-my\": 144,\n\t\"./ms-my.js\": 144,\n\t\"./ms.js\": 143,\n\t\"./mt\": 145,\n\t\"./mt.js\": 145,\n\t\"./my\": 146,\n\t\"./my.js\": 146,\n\t\"./nb\": 147,\n\t\"./nb.js\": 147,\n\t\"./ne\": 148,\n\t\"./ne.js\": 148,\n\t\"./nl\": 149,\n\t\"./nl-be\": 150,\n\t\"./nl-be.js\": 150,\n\t\"./nl.js\": 149,\n\t\"./nn\": 151,\n\t\"./nn.js\": 151,\n\t\"./pa-in\": 152,\n\t\"./pa-in.js\": 152,\n\t\"./pl\": 153,\n\t\"./pl.js\": 153,\n\t\"./pt\": 154,\n\t\"./pt-br\": 155,\n\t\"./pt-br.js\": 155,\n\t\"./pt.js\": 154,\n\t\"./ro\": 156,\n\t\"./ro.js\": 156,\n\t\"./ru\": 157,\n\t\"./ru.js\": 157,\n\t\"./sd\": 158,\n\t\"./sd.js\": 158,\n\t\"./se\": 159,\n\t\"./se.js\": 159,\n\t\"./si\": 160,\n\t\"./si.js\": 160,\n\t\"./sk\": 161,\n\t\"./sk.js\": 161,\n\t\"./sl\": 162,\n\t\"./sl.js\": 162,\n\t\"./sq\": 163,\n\t\"./sq.js\": 163,\n\t\"./sr\": 164,\n\t\"./sr-cyrl\": 165,\n\t\"./sr-cyrl.js\": 165,\n\t\"./sr.js\": 164,\n\t\"./ss\": 166,\n\t\"./ss.js\": 166,\n\t\"./sv\": 167,\n\t\"./sv.js\": 167,\n\t\"./sw\": 168,\n\t\"./sw.js\": 168,\n\t\"./ta\": 169,\n\t\"./ta.js\": 169,\n\t\"./te\": 170,\n\t\"./te.js\": 170,\n\t\"./tet\": 171,\n\t\"./tet.js\": 171,\n\t\"./tg\": 172,\n\t\"./tg.js\": 172,\n\t\"./th\": 173,\n\t\"./th.js\": 173,\n\t\"./tl-ph\": 174,\n\t\"./tl-ph.js\": 174,\n\t\"./tlh\": 175,\n\t\"./tlh.js\": 175,\n\t\"./tr\": 176,\n\t\"./tr.js\": 176,\n\t\"./tzl\": 177,\n\t\"./tzl.js\": 177,\n\t\"./tzm\": 178,\n\t\"./tzm-latn\": 179,\n\t\"./tzm-latn.js\": 179,\n\t\"./tzm.js\": 178,\n\t\"./ug-cn\": 180,\n\t\"./ug-cn.js\": 180,\n\t\"./uk\": 181,\n\t\"./uk.js\": 181,\n\t\"./ur\": 182,\n\t\"./ur.js\": 182,\n\t\"./uz\": 183,\n\t\"./uz-latn\": 184,\n\t\"./uz-latn.js\": 184,\n\t\"./uz.js\": 183,\n\t\"./vi\": 185,\n\t\"./vi.js\": 185,\n\t\"./x-pseudo\": 186,\n\t\"./x-pseudo.js\": 186,\n\t\"./yo\": 187,\n\t\"./yo.js\": 187,\n\t\"./zh-cn\": 188,\n\t\"./zh-cn.js\": 188,\n\t\"./zh-hk\": 189,\n\t\"./zh-hk.js\": 189,\n\t\"./zh-tw\": 190,\n\t\"./zh-tw.js\": 190\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 248;","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_need_calc_cell = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\nconst CalcCell = require('./CalcCell.js');\nconst checker = require('./formula_check.js');\nconst helper = require(\"../core/helper\");\nconst CalcWorkBook = require('./CalcWorkBook')\nconst es6 = require('./es6');\nvar mymodule = function(rows, tileArr) {\n    console.log(es6);\n    if (helper.isHave(tileArr)){\n        var Calc_WorkBook = new CalcWorkBook(rows, tileArr)\n        var workbook = rows.workbook\n        workbook = Calc_WorkBook.get_workbook(workbook)\n        var formulas = find_all_need_calc_cell(workbook, tileArr, exec_formula)\n        for (var i = formulas.length - 1; i >= 0; i--) {\n            try {\n                var calc_cell = new CalcCell(formulas[i], rows)\n                var valid_res = calc_cell.check_valid()\n                if (valid_res !== true){\n                    formulas[i].cell.v = valid_res\n                }else{\n                    //cellsheet({}'',default_0)\n                    formulas[i].cell.f = calc_cell.trans_formula()\n                    checker.trans_sheet(formulas[i].sheet)\n                    exec_formula(formulas[i]);\n                    formulas[i].cell.f = calc_cell.recover_formula()\n                    checker.recover_sheet(formulas[i].sheet)\n                }\n                //array\n                if (Calc_WorkBook.is_muti_cell(formulas[i]) || Array.isArray(formulas[i].cell.v)){\n                    Calc_WorkBook.deal_muti_cell(workbook, formulas[i])\n                }\n            } catch (e) {\n                console.log(e)\n            }\n        }\n        Calc_WorkBook.calcDoneToSetCells(workbook, rows)\n    }\n\n};\n\nmymodule.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nmymodule.set_fx = exec_formula.set_fx;\nmymodule.exec_fx = exec_formula.exec_fx;\nmymodule.col_str_2_int = col_str_2_int;\nmymodule.int_2_col_str = int_2_col_str;\nmymodule.import_functions = exec_formula.import_functions;\nmymodule.import_raw_functions = exec_formula.import_raw_functions;\nmymodule.xlsx_Fx = exec_formula.xlsx_Fx;\nmymodule.localizeFunctions = exec_formula.localizeFunctions;\n\nmymodule.XLSX_CALC = mymodule\n\nmodule.exports = mymodule;\n","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","/* global document */\n\n/* global window */\nclass Element {\n    constructor(tag, className = '') {\n        if (typeof tag === 'string') {\n            this.el = document.createElement(tag);\n            this.el.className = className;\n        } else {\n            this.el = tag;\n        }\n        this.data = {};\n    }\n\n    data(key, value) {\n        if (value !== undefined) {\n            this.data[key] = value;\n            return this;\n        }\n        return this.data[key];\n    }\n\n    on(eventNames, handler) {\n        const [fen, ...oen] = eventNames.split('.');\n        let eventName = fen;\n        if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n            eventName = 'DOMMouseScroll';\n        }\n        this.el.addEventListener(eventName, (evt) => {\n            handler(evt);\n            for (let i = 0; i < oen.length; i += 1) {\n                const k = oen[i];\n                if (k === 'left' && evt.button !== 0) {\n                    return;\n                }\n                if (k === 'right' && evt.button !== 2) {\n                    return;\n                }\n                if (k === 'stop') {\n                    evt.stopPropagation();\n                }\n            }\n        });\n        return this;\n    }\n\n    offset(value) {\n        if (value !== undefined) {\n            Object.keys(value).forEach((k) => {\n                this.css(k, `${value[k]}px`);\n            });\n            return this;\n        }\n        const {\n            offsetTop, offsetLeft, offsetHeight, offsetWidth,\n        } = this.el;\n        return {\n            top: offsetTop,\n            left: offsetLeft,\n            height: offsetHeight,\n            width: offsetWidth,\n        };\n    }\n\n    scroll(v) {\n        const {el} = this;\n        if (v !== undefined) {\n            if (v.left !== undefined) {\n                el.scrollLeft = v.left;\n            }\n            if (v.top !== undefined) {\n                el.scrollTop = v.top;\n            }\n        }\n\n        return {left: el.scrollLeft, top: el.scrollTop};\n    }\n\n    box() {\n        return this.el.getBoundingClientRect();\n    }\n\n    parent() {\n        return new Element(this.el.parentNode);\n    }\n\n    children(...eles) {\n        if (arguments.length === 0) {\n            return this.el.childNodes;\n        }\n        eles.forEach(ele => this.child(ele));\n        return this;\n    }\n\n    /*\n    first() {\n      return this.el.firstChild;\n    }\n\n    last() {\n      return this.el.lastChild;\n    }\n\n    remove(ele) {\n      return this.el.removeChild(ele);\n    }\n\n    prepend(ele) {\n      const { el } = this;\n      if (el.children.length > 0) {\n        el.insertBefore(ele, el.firstChild);\n      } else {\n        el.appendChild(ele);\n      }\n      return this;\n    }\n\n    prev() {\n      return this.el.previousSibling;\n    }\n\n    next() {\n      return this.el.nextSibling;\n    }\n    */\n\n    child(arg) {\n        let ele = arg;\n        if (typeof arg === 'string') {\n            ele = document.createTextNode(arg);\n        } else if (arg instanceof Element) {\n            ele = arg.el;\n        }\n        this.el.appendChild(ele);\n\n        return this;\n    }\n\n    contains(ele) {\n        return this.el.contains(ele);\n    }\n\n    className(v) {\n        if (v !== undefined) {\n            this.el.className = v;\n            return this;\n        }\n        return this.el.className;\n    }\n\n    addClass(name) {\n        this.el.classList.add(name);\n        return this;\n    }\n\n    hasClass(name) {\n        return this.el.classList.contains(name);\n    }\n\n    removeClass(name) {\n        this.el.classList.remove(name);\n        return this;\n    }\n\n    toggle(cls = 'active') {\n        return this.toggleClass(cls);\n    }\n\n    toggleClass(name) {\n        return this.el.classList.toggle(name);\n    }\n\n    active(flag = true, cls = 'active') {\n        if (flag) this.addClass(cls);\n        else this.removeClass(cls);\n        return this;\n    }\n\n    checked(flag = true) {\n        this.active(flag, 'checked');\n        return this;\n    }\n\n    disabled(flag = true) {\n        if (flag) this.addClass('disabled');\n        else this.removeClass('disabled');\n        return this;\n    }\n\n    // key, value\n    // key\n    // {k, v}...\n    attr(key, value) {\n        if (value !== undefined) {\n            this.el.setAttribute(key, value);\n        } else {\n            if (typeof key === 'string') {\n                return this.el.getAttribute(key);\n            }\n            Object.keys(key).forEach((k) => {\n                this.el.setAttribute(k, key[k]);\n            });\n        }\n        return this;\n    }\n\n    removeAttr(key) {\n        this.el.removeAttribute(key);\n        return this;\n    }\n\n    html(content) {\n        if (content !== undefined) {\n            this.el.innerHTML = content;\n            return this;\n        }\n        return this.el.innerHTML;\n    }\n\n    val(v) {\n        if (v !== undefined) {\n            this.el.value = v;\n            return this;\n        }\n        return this.el.value;\n    }\n\n    cssRemoveKeys(...keys) {\n        keys.forEach(k => this.el.style.removeProperty(k));\n        return this;\n    }\n\n    // css( propertyName )\n    // css( propertyName, value )\n    // css( properties )\n    css(name, value) {\n        if (value === undefined && typeof name !== 'string') {\n            Object.keys(name).forEach((k) => {\n                this.el.style[k] = name[k];\n            });\n            return this;\n        }\n        if (value !== undefined) {\n            this.el.style[name] = value;\n            return this;\n        }\n        return this.el.style[name];\n    }\n\n    removeEl() {\n        if (!this.el || !this.el.parentNode) {\n            return;\n        }\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    computedStyle() {\n        return window.getComputedStyle(this.el, null);\n    }\n\n    isShow() {\n        return this.el.style['display'] === 'block';\n    }\n\n    show(key = 'display', text = 'block') {\n        this.css(key, text);\n        return this;\n    }\n\n    hide(key = 'display', value = 'none') {\n        this.css(key, value);\n        return this;\n    }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n    Element,\n    h,\n};\n","/* global window */\nimport en from './en';\n\nlet $lang = 'en';\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages && messages[$lang]) {\n        let message = messages[$lang];\n        const keys = key.split('.');\n        for (let i = 0; i < keys.length; i += 1) {\n            const property = keys[i];\n            const value = message[property];\n            if (i === keys.length - 1) return value;\n            if (!value) return undefined;\n            message = value;\n        }\n    }\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x && window.x.spreadsheet && window.x.spreadsheet.$messages) {\n        v = translate(key, window.x.spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\nfunction locale(lang, message) {\n    $lang = lang;\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        font: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        textColor: 'Text color',\n        fillColor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        add: 'display equation',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n        flexible: 'Flexible',\n        throwFormula: 'Throw formulas',\n        comeBack: 'come back',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        insertRow: 'Insert row',\n        insertColumn: 'Insert column',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        recover: 'recover',\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    date_formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        concat: 'Concat',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","/**\n formulas:\n key\n title\n render\n */\nimport {tf} from '../locale/locale';\nimport XLSX_CALC from \"../calc\"\nlet formulajs = require('../calc/formulajs/index'); // jobs: todo: 3formulajs\nconst baseFormulas = [\n    {\n        key: 'MD.WLAND',\n        title: tf('formula.wland'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.WFR',\n        title: tf('formula.wfr'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.RTD',\n        title: tf('formula.rtd'),\n        render: ary => ary.join(''),\n    },\n];\n\nlet formulas = deepCopy(baseFormulas);\n\nconst formulaCalc = () => {\n    XLSX_CALC.import_functions(formulajs);\n    let xlsx_Fx = XLSX_CALC.xlsx_Fx;\n    formulas = deepCopy(baseFormulas);\n    Object.keys(xlsx_Fx).forEach(i => {\n        let args = {\n            key: i,\n            title: i,\n            render: xlsx_Fx[i]\n        };\n        formulas.push(args);\n    });\n\n\n    return XLSX_CALC;\n};\n\nfunction deepCopy(obj) {\n    let result = Array.isArray(obj) ? [] : {};\n    for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n                result[key] = deepCopy(obj[key]);\n            } else {\n                result[key] = obj[key];\n            }\n        }\n    }\n    return result;\n}\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n    formulaCalc,\n};\n","import {expr2xy, xy2expr} from './alphabet';\n\nclass CellRange {\n    constructor(sri, sci, eri, eci, w = 0, h = 0) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n        this.w = w;\n        this.h = h;\n    }\n\n    set(sri, sci, eri, eci) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    multiple() {\n        return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n    }\n\n    // cell-index: ri, ci\n    // cell-ref: A10\n    includes(...args) {\n        let [ri, ci] = [0, 0];\n        if (args.length === 1) {\n            [ci, ri] = expr2xy(args[0]);\n        } else if (args.length === 2) {\n            [ri, ci] = args;\n        }\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n    }\n\n    each(cb, rowFilter = () => true) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        for (let i = sri; i <= eri; i += 1) {\n            if (rowFilter(i)) {\n                for (let j = sci; j <= eci; j += 1) {\n                    cb(i, j);\n                }\n            }\n        }\n    }\n\n    // 1 * n  /  n * 1 / n * n\n    getType() {\n        let {\n            sri, sci, eri, eci,\n        } = this;\n\n        if(sri === eri && sci !== eci) {\n            return 1;\n        } else if(sri !== eri && sci === eci) {\n            return 2;\n        } else if(sri !== eri && sci !== eci) {\n            return 3;\n        } else if(sri === eri && sci === eci) {\n            return 1;\n        }\n\n        console.error(\"\");\n        return 4;\n    }\n\n    // each2(cb, rowFilter = () => true) {\n    //     let {\n    //         sri, sci, eri, eci,\n    //     } = this;\n    //     let extraRiValue = eri;\n    //     let extraCiValue = eci;\n    //\n    //     if (sri - extraRiValue <= 0) {\n    //         sri = 0;\n    //     } else {\n    //         sri = sri - extraRiValue;\n    //     }\n    //\n    //     if (sci - extraCiValue <= 0) {\n    //         sci = 0;\n    //     } else {\n    //         sci = sci - extraCiValue;\n    //     }\n    //\n    //     for (let i = sri; i <= eri + extraRiValue; i += 1) {\n    //         if (rowFilter(i)) {\n    //             for (let j = sci; j <= eci + extraCiValue; j += 1) {\n    //                 cb(i, j, eri, eci);\n    //             }\n    //         }\n    //     }\n    // }\n\n    // eachGivenRange(cb, mri, mci) {\n    //     let sri = 0;\n    //     let sci = 0;\n    //     let eri = mri;\n    //     let eci = mci;\n    //\n    //     for (let i = sri; i <= eri; i += 1) {\n    //         for (let j = sci; j <= eci; j += 1) {\n    //             cb(i, j, eri, eci);\n    //         }\n    //     }\n    // }\n\n    move(ri, ci) {\n        let d = this.eri - this.sri;        //   \n        let d2 = this.eci - this.sci;            //   \n        this.sri = ri;\n        this.sci = ci;\n        this.eri = this.sri + d;\n        this.eci = this.sci + d2;\n    }\n\n    move2(ri, ci, eri, eci) {\n        this.sri = ri;\n        this.sci = ci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    contains(other) {\n        return this.sri <= other.sri\n            && this.sci <= other.sci\n            && this.eri >= other.eri\n            && this.eci >= other.eci;\n    }\n\n    // within\n    within(other) {\n        return this.sri >= other.sri\n            && this.sci >= other.sci\n            && this.eri <= other.eri\n            && this.eci <= other.eci;\n    }\n\n    // disjoint\n    disjoint(other) {\n        return this.sri > other.eri\n            || this.sci > other.eci\n            || other.sri > this.eri\n            || other.sci > this.eci;\n    }\n\n    // intersects\n    intersects(other) {\n        return this.sri <= other.eri\n            && this.sci <= other.eci\n            && other.sri <= this.eri\n            && other.sci <= this.eci;\n    }\n\n    getMovePos(ri, ci) {\n        let {sri, sci, eri, eci} = this;\n\n        let pos = 0;\n        if (ri > eri && ci > eci) {\n            pos = 1;        // \n        } else if(ri > eri && ci < sci) {\n            pos = 7;        // \n        } else if(ri < sri && ci > eci) {\n            pos = 8;        // \n        } else if(ci < sci && ri < sri) {\n            pos = 4;        // \n        } else if(ri > eri) {\n            pos = 2;        // \n        } else if(ci > eci) {\n            pos = 3;        // \n        }  else if(ci < sci) {\n            pos = 5;        // \n        } else if(ri < sri) {\n            pos = 6;        // \n        }\n\n        return pos;\n    }\n\n    // union\n    union(other) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return new CellRange(\n            other.sri < sri ? other.sri : sri,\n            other.sci < sci ? other.sci : sci,\n            other.eri > eri ? other.eri : eri,\n            other.eci > eci ? other.eci : eci,\n        );\n    }\n\n    // intersection\n    // intersection(other) {}\n\n    // Returns Array<CellRange> that represents that part of this that does not intersect with other\n    // difference\n    difference(other) {\n        const ret = [];\n        const addRet = (sri, sci, eri, eci) => {\n            ret.push(new CellRange(sri, sci, eri, eci));\n        };\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        const dsr = other.sri - sri;\n        const dsc = other.sci - sci;\n        const der = eri - other.eri;\n        const dec = eci - other.eci;\n        if (dsr > 0) {\n            addRet(sri, sci, other.sri - 1, eci);\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, eci);\n                if (dsc > 0) {\n                    addRet(other.sri, sci, other.eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, other.eri, eci);\n                }\n            } else {\n                if (dsc > 0) {\n                    addRet(other.sri, sci, eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, eri, eci);\n                }\n            }\n        } else if (der > 0) {\n            addRet(other.eri + 1, sci, eri, eci);\n            if (dsc > 0) {\n                addRet(sri, sci, other.eri, other.sci - 1);\n            }\n            if (dec > 0) {\n                addRet(sri, other.eci + 1, other.eri, eci);\n            }\n        }\n        if (dsc > 0) {\n            addRet(sri, sci, eri, other.sci - 1);\n            if (dec > 0) {\n                addRet(sri, other.eri + 1, eri, eci);\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, other.eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, other.eci);\n                }\n            } else {\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, eci);\n                }\n            }\n        } else if (dec > 0) {\n            addRet(eri, other.eci + 1, eri, eci);\n            if (dsr > 0) {\n                addRet(sri, sci, other.sri - 1, other.eci);\n            }\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, other.eci);\n            }\n        }\n        return ret;\n    }\n\n    size() {\n        return [\n            this.eri - this.sri + 1,\n            this.eci - this.sci + 1,\n        ];\n    }\n\n    toString() {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        let ref = xy2expr(sci, sri);\n        if (this.multiple()) {\n            ref = `${ref}:${xy2expr(eci, eri)}`;\n        }\n        return ref;\n    }\n\n    includeByRiCi(ri, ci) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n\n        return sri <= ri && eri >= ri && sci <= ci && eci >= ci;\n    }\n\n    // clone() {\n    //     const {\n    //         sri, sci, eri, eci, w, h,\n    //     } = this;\n    //     return new CellRange(sri, sci, eri, eci, w, h);\n    // }\n\n    getLocationArray(sarr) {\n        let darr = [];\n        let index = 0;\n        this.each((i, j) => {\n            darr.push({ri: i, ci: j, v: sarr[index % sarr.length].tmp, type: sarr[index % sarr.length].type});\n            index = index + 1;\n        });\n\n        return darr;\n    }\n\n    /*\n    toJSON() {\n      return this.toString();\n    }\n    */\n\n    equals(other) {\n        return this.eri === other.eri\n            && this.eci === other.eci\n            && this.sri === other.sri\n            && this.sci === other.sci;\n    }\n\n    static valueOf(ref) {\n        // B1:B8, B1 => 1 x 1 cell range\n        const refs = ref.split(':');\n        const [sci, sri] = expr2xy(refs[0]);\n        let [eri, eci] = [sri, sci];\n        if (refs.length > 1) {\n            [eci, eri] = expr2xy(refs[1]);\n        }\n        return new CellRange(sri, sci, eri, eci);\n    }\n}\n\nexport default CellRange;\n\nexport {\n    CellRange,\n};\n","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  // isCopy() {\n  //   return this.state === 'copy';\n  // }\n  //\n  // isCut() {\n  //   return this.state === 'cut';\n  // }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    // vlength() {\n    //     const {operator, value} = this;\n    //     if (operator === 'in') {\n    //         return value.length;\n    //     }\n    //     return 0;\n    // }\n\n    getData() {\n\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n\n        this.flex = [];\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.fitlers = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    addFiexRows(args) {\n        this.flex = args;\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSet(exceptRowSet, rir) {\n        for (let ix = 0; ix < this.flex.length; ix++) {\n            let {ri,   set_total, state} = this.flex[ix];\n            for (let i = ri; i < set_total + ri; i++) {\n                console.log(state, \"114\", rir, ri, state);\n                if (state === false && rir === ri) {\n                    exceptRowSet.add(i + 1);\n                    this.flex[ix].state = true;\n                } else if (state === true && rir === ri) {\n                    exceptRowSet.delete(i + 1);\n                    this.flex[ix].state = false;\n                }\n            }\n        }\n\n        return exceptRowSet;\n    }\n\n    includes2(rir, cic) {\n        let b = false;\n\n        for (let i = 0; i < this.flex.length; i++) {\n            let {ri, ci} = this.flex[i];\n            if (rir === ri && cic === ci) {\n                b = true;\n            }\n        }\n\n        return b;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    m[key] = (m[key] || 0) + 1;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  each(cb) {\n      this._.forEach(it => cb(it));\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri >= index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    return this;\n  }\n\n  getData() {\n    return this._.map(merge => merge.toString());\n  }\n}\n\nexport {\n  Merges,\n};\n","const recast = require(\"recast\");\n\nconst colon = \"$$$\";\nconst fqm = '';\nconst exclamationPoint = \"\";\nconst braceLeft = \"\";\nconst braceRight = \"\";\n\nexport default class Recast {\n    constructor(formula) {\n        this.formula = formula;\n        this.ast = \"\";\n    }\n    preProcess() {\n        this.formula = this.formula.replace(/=/g, '');\n        this.formula = this.formula.replace(/:/g, colon);\n        this.formula = this.formula.replace(/\"\"\"\"/g, fqm);\n        this.formula = this.formula.replace(/!/g, exclamationPoint);\n        this.formula = this.formula.replace(/{/g, braceLeft);\n        this.formula = this.formula.replace(/}/g, braceRight);\n        this.formula = this.formula.replace(/#/g, '');\n        this.formula = this.formula.replace(/\\./g, 'a');\n        this.formula = this.formula.replace(/[0-9][0-9]*/g, 'a');\n        this.formula = this.formula.replace(/\\/g, '\"');\n        this.formula = this.formula.replace(/\\/g, '(');\n        this.formula = this.formula.replace(/\\/g, ')');\n        this.formula = this.formula.replace(/\\/g, '\"');\n        this.formula = this.formula.replace(/\\%/g, '');\n        this.formula = this.formula.replace(/\\,/g, '');\n        this.formula = this.formula.replace(/\\/g, '');\n        // this.formula = this.formula.replace(/\"([\\s\\S]{1,})\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"([\\s\\S]+)\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"\"/, \"\")\n    }\n\n    parse() {\n        this.preProcess();\n        let {formula} = this;\n        this.ast = recast.parse(formula);\n    }\n\n    ignoreSpace() {\n\n    }\n}","import CellRange from \"./cell_range\";\n\nexport default class PasteProxy {\n    constructor() {\n        this.srcCellRange = \"\";\n        this.dstCellRange = \"\";\n        this.srcOneDRange = \"\";\n        this.dstOneDRange = \"\";\n    }\n\n    setSrcAndDstCellRange(srcCellRange, dstCellRange) {\n        this.srcCellRange = srcCellRange;\n        this.dstCellRange = dstCellRange;\n    }\n\n    use() {\n        let {srcCellRange, dstCellRange} = this;\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n\n        return {\n            sri, sci, eri, eci, dsri, dsci, deri, deci, rn, cn, drn, dcn\n        }\n    }\n\n    autoFilterDirection() {\n        let {sri, dsri, deri, eri} = this.use();\n\n        let isLeftRight = false; //   falsetrue\n        if (sri === dsri && deri === eri) {\n            isLeftRight = true;\n        }\n\n        return isLeftRight;\n    }\n\n    upOrDown() {\n        let {deri, sri, deci, sci,} = this.use();\n        let isDown = true;       // false, true     // isDown\n        if (deri < sri || deci < sci) {\n            isDown = false;\n        }\n\n        return isDown;\n    }\n\n    leftOrRight() {\n        let {\n            srcOneDRange,\n            dstOneDRange\n        } = this.getRangeByWay();\n\n        let line = 1;       // \n        if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci > srcOneDRange.eci) {\n            line = 2;       // \n        } else if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci < srcOneDRange.eci) {\n            line = 3;       // \n        }\n        return line;\n    }\n\n    getOneDRangeObj(way, offset) {\n        let {sri, sci, eri, eci, dsri, dsci, deri, deci} = this.use();\n\n        if (!way) {\n            this.srcOneDRange = new CellRange(sri, sci + offset, eri, sci + offset);\n            this.dstOneDRange = new CellRange(dsri, dsci + offset, deri, dsci + offset);\n        } else {\n            this.srcOneDRange = new CellRange(sri + offset, sci, sri + offset, eci);\n            this.dstOneDRange = new CellRange(dsri + offset, dsci, dsri + offset, deci);\n        }\n\n        return this.getRangeByWay();\n    }\n\n    getRangeByWay() {\n        return {\n            \"srcOneDRange\": this.srcOneDRange,\n            \"dstOneDRange\": this.dstOneDRange\n        }\n    }\n\n    // todo \n    // isCopy(sarr, i) {\n    //     let {sri, sci, eri} = this.use();\n    //     let isCopy = false;\n    //     if (sarr.length > 1) {\n    //         isCopy = true;\n    //     }\n    //     if (sri === eri && sci + i === sci + i) {\n    //         isCopy = true;\n    //     }\n    //\n    //     return isCopy;\n    // }\n\n    calcDiff(sarr, isAdd) {\n        let diffValue = 1;\n\n        if (!isAdd) {\n            diffValue = 1;\n        }\n\n        if (isAdd && sarr.length > 1) {\n            let last2 = sarr[sarr.length - 2];\n            let last1 = sarr[sarr.length - 1];\n            diffValue = last1.text * 1 - last2.text * 1;\n        } else if (sarr.length > 1) {\n            let last2 = sarr[1];\n            let last1 = sarr[0];\n            diffValue = last1.text * 1 - last2.text * 1;\n        }\n\n        if(isNaN(diffValue)) {\n            diffValue = 1;\n        }\n\n        return diffValue;\n    }\n}","import {isHave} from \"./helper\";\nimport {isFormula} from \"./row\";\nimport {datePattern2, str2Re} from \"../utils/reg_pattern\";\n\nexport default class CellProxy {\n    constructor(cell) {\n        this.cell = cell;\n    }\n\n    renderFormat(style, nrindex, cindex, data, filter) {\n        if(isHave(style) === false || isHave(style.format) === false) {\n            return {\n                \"cellText\": \"\",\n                \"state\": false,\n            };\n        }\n\n        let {cell} = this;\n        let cellText = \"\";\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            let formatInfo = data.tryParseToNum(cell, nrindex, cindex);\n            if(formatInfo.state) {\n                if(filter) {\n                    if((formatInfo.style === 'date' || formatInfo.style === 'datetime')) {\n                        cellText = formatInfo.text;\n                    } else {\n                        formatInfo.state = false;\n                    }\n                }  else {\n                    cellText = formatInfo.text;\n                }\n            } else {\n                if( isHave(cell.text) === false) {\n                    cell.text = \"\";\n                }\n                cellText = cell.text;\n            }\n            return {\n                \"cellText\": cellText,\n                \"state\": formatInfo.state,\n            };\n        }\n        return {\n            \"cellText\": cellText,\n            \"state\": false,\n        };\n    }\n\n    getCellDataType(sarr, {isDate, isNumber}) {\n        let ncell = this.cell;\n        // let enter = false;\n        let nA = true;\n\n\n        if (!isHave(ncell.formulas)) {\n            ncell.formulas = \"\";\n        }\n        if (!isHave(ncell.text)) {\n            ncell.text = \"\";\n        }\n\n        let value = ncell.formulas !== \"\" ? ncell.formulas + \"\" : ncell.text + \"\";\n        // value = value.replace(/,/g, \"\").replace(\"=\", \"\");\n        value = value.replace(/,/g, \"\");        // =123 =\n        let ns = value * 1;\n\n        if ((ns || ns === 0) && typeof ns === 'number' && !isNaN(ns) && /^\\d+$/.test(value) === true) {\n            if(isNumber === true) {\n                isNumber = true;\n                nA = false;\n                isDate = false;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'number';\n        } else if (value && nA === true && isFormula(value)) {\n            nA = true;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'na';\n        } else if (value && value.search(str2Re(datePattern2), '') !== -1) {\n            if( isDate === true) { // jobs: todo: \n                nA = false;\n                isNumber = false;\n                isDate = true;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'date';\n        } else {//\n            nA = false;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'other';\n        }\n        ncell.tmp = value;\n        sarr.push(ncell);\n\n        return {\n            nA, isDate: isDate, isNumber: isNumber\n        }\n    }\n}\n","import {isHave} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\n\nexport default class CellProp {\n    constructor(ri, ci, cell, expr, empty) {\n        this.ri = ri;\n        this.ci = ci;\n        this.cell = cell;\n        this.expr = expr;\n        this.empty = empty;\n    }\n\n    isInclude() {\n\n    }\n\n\n    each(cb) {\n        let {cell} = this;\n        if(isHave(cell.depend) === false) {\n            return;\n        }\n        for(let i = 0; i < cell.depend.length; i++) {\n            let expr = cell.depend[i];\n            let [ci, ri] = expr2xy(expr);\n            cb(ri, ci);\n        }\n    }\n}","import {isHave} from \"../core/helper\";\n\n\n/**\n * Cell\n */\nexport default class Cell {\n    /**\n     * @constructor\n     * @param text - \n     * @param formulas - \n     * @param style - , null,\n     * @param depend - \n     * @param merge - null\n     * @param formatText - null\n     * @param multivalueRefsCell - \n     */\n    constructor() {\n        this.text = \"\";\n        this.depend = [];\n        this.formulas = \"\";\n\n        this.style = null;\n        this.merge = null;\n        this.formatText = null;\n        this.multivalueRefsCell = null;\n        this.source_v = null;\n    }\n\n    /**\n     * \n     */\n    setCell(cell) {\n        if (!isHave(cell)) {\n            return;\n        }\n\n        if (isHave(cell.text)) {\n            this.text = cell.text;\n        }\n\n        if (isHave(cell.formulas)) {\n            this.formulas = cell.formulas;\n        }\n\n        if(isHave(cell.formatText)) {\n            this.formatText = cell.formatText;\n        }\n\n        if (isHave(cell.depend)) {\n            this.depend = cell.depend;\n        }\n\n        if (isHave(cell.style)) {\n            this.style = cell.style;\n        }\n\n        if (isHave(cell.multivalueRefsCell)) {\n            this.multivalueRefsCell = cell.multivalueRefsCell;\n        }\n\n        if (isHave(cell.merge)) {\n            this.merge = cell.merge;\n        }\n\n        if (isHave(cell.source_v)) {\n            this.source_v = cell.source_v;\n        }\n    }\n\n    /**\n     * \n     * @param args args.state truefalse, text \n     */\n    setFormatText(args) {\n        if(args.state) {\n            this.formatText = args.text;\n        }\n    }\n}","import helper, {isHave} from './helper';\nimport {xy2expr} from './alphabet';\nimport {changeFormula, cutStr, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport dayjs from 'dayjs'\nimport {deepCopy, distinct, isSheetVale, splitStr} from \"./operator\";\nimport Recast from \"./recast\";\nimport PasteProxy from \"./paste_proxy\";\nimport CellProxy from \"./cell_proxy\";\nimport CellRange from \"./cell_range\";\nimport CellProp from \"../model/cell_prop\";\nimport Cell from \"../model/cell\";\nlet calcUtils = require('../calc/utils');\n\nexport function isFormula(text) {\n    // if (text && text[0] === \"=\") {\n    //     return true;\n    // }\n\n    return text && text[0] === \"=\";\n}\n\nfunction isEmpty(text, formulas, formatText) {\n    if(isHave(text) && text !== \"\") {\n        return false;\n    }\n\n    if(isHave(formulas) && formulas !== \"\") {\n        return false;\n    }\n\n    // if(isHave(formatText)) {\n    //     return false;\n    // }\n\n    return !isHave(formatText);\n}\n\nfunction otherAutoFilter(d, darr, direction, isAdd, what, cb, other, dri) {\n    // other  '=asd''asd'false\n    let ncell = this.getCellByTopCell(d, direction, isAdd, 'other', dri, 0);\n\n    let {text, formulas} = ncell;\n    let iText = formulas !== \"\" ? formulas : text;\n\n    // if (other) {\n    //     this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    // } else\n    if (this.isFormula(iText)) {\n        this.calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb);\n    } else {\n        //  '=asd''asd' \n        this.calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text);\n    }\n}\n\nfunction numberAutoFilter(d, darr, direction, isAdd, diffValue, what, cb, isNumber) {\n    let ncell = \"\";\n\n    if (isAdd) {\n        diffValue = Math.abs(diffValue);\n    } else {\n        diffValue = diffValue * -1;\n    }\n\n    if (!isNumber) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diffValue = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isAdd);\n    }\n\n    this.calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb);\n}\n\nfunction dateAutoFilter(d, line, isDown, darr, what, cb, isDate) {\n    let direction = line;\n    let ncell = \"\";\n    let diff = isDown ? 1 : -1;\n    if (!isDate) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diff = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isDown, 'date');\n    }\n    this.calcDateCellByTopCell(ncell, darr, d, isDown, what, cb, diff);\n}\n\nclass Rows {\n    constructor({len, height}, data = \"\") {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n        this.data = data;\n        this.pasteProxy = new PasteProxy();\n        this.workbook = null;\n    }\n\n    getHeight(ri) {\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined\n            && (isHave(row.cells[ci].text) || isHave(row.cells[ci].formulas) || isHave(row.cells[ci].style || typeof row.cells[ci] === 'object'))) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    toString(text) {\n        if (isHave(text) === false) {\n            text = \"\";\n        }\n        return text + \"\";\n    }\n\n    isBackEndFunc(text) {\n        // if (text.indexOf(\"MD.RTD\") !== -1) {\n        //     return true;\n        // }\n\n        return text.indexOf(\"MD.RTD\") !== -1;\n    }\n\n    isReferOtherSheet(cell, state = false) {\n        return cell.formulas && cell.formulas[0] === \"=\" && (state || isSheetVale(cell.formulas));\n    }\n\n    isEmpty(cell) {\n\n        return cell && (cell.text || cell.formulas || cell.depend);\n    }\n\n    isFormula(text) {\n        return isFormula(text);\n    }\n\n    setValue(type, value, cell) {\n        cell[type] = value;\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        let {data} = this;\n        const row = this.getOrNew(ri);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        if (what === 'all') {\n            row.cells[ci] = _cell;\n        } else if(what === 'formulas') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].formulas = _cell.formulas;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = _cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = _cell.style;\n            if (cell.merge) row.cells[ci].merge = _cell.merge;\n        } else if (what === 'date' || what === 'datetime') {\n            // row.cells[ci] = {};\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n            row.cells[ci].to_calc_num = _cell.to_calc_num;\n        } else if (what === 'normal' || what === 'number') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            // row.cells[ci].value = cell.value;\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'rmb' || what === 'percent') {        // rmb  text123, formalus 123,123\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].formulas = _cell.formulas;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'all_with_no_workbook') {\n            row.cells[ci] = _cell;\n\n            return;\n        } else if (what === 'style') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {};\n            }\n\n            row.cells[ci].style = _cell.style;\n            return;\n        }\n        // cell\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n        _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n    }\n\n    getDependCell(expr, cell) {\n        let {formulas} = cell;\n        if (isHave(formulas) === false) {\n            return;\n        }\n        if (isFormula(formulas)) {\n            let arr = cutStr(formulas, true, true);\n\n            for (let i = 0; i < arr.length; i++) {\n                let args = this.mergeCellExpr(arr[i]);\n                if (args.state) {\n                    arr.push(...args.mergeArr);\n                }\n            }\n            arr = distinct(arr);\n\n            if (isHave(cell.depend) === false) {\n                cell.depend = [];\n            }\n            for (let i = 0; i < arr.length; i++) {\n                let ref = arr[i];\n                let [ci, ri] = expr2xy(ref);\n                let refCell = this.getCell(ri, ci);\n                if (isHave(refCell) === false) {\n                    refCell = {};\n                }\n\n                if (isHave(refCell.depend) === false) {\n                    refCell.depend = [];\n                }\n                refCell.depend.push(expr);\n                refCell.depend = distinct(refCell.depend);\n                this.setCell(ri, ci, refCell, 'all_with_no_workbook');\n            }\n        }\n    }\n\n    mergeCellExpr(d) {\n        if (!isAbsoluteValue(d, 6)) {\n            return {\n                \"state\": false,\n            }\n        }\n        d = d.replace(/\\$/g, '');\n        d = d.split(\":\");\n        let e1 = expr2xy(d[0]);\n        let e2 = expr2xy(d[1]);\n\n        if (e1[0] > e2[0]) {\n            let t = e2[0];\n            e2[0] = e1[0];\n            e1[0] = t;\n        }\n        if (e1[1] > e2[1]) {\n            let t = e2[1];\n            e2[1] = e1[1];\n            e1[1] = t;\n        }\n        let cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0]);\n        let arr = [];\n        cellRange.each((i, j) => {\n            arr.push(xy2expr(j, i));\n        });\n\n        return {\n            \"state\": true,\n            \"mergeArr\": arr,\n        };\n    }\n\n    useOne(param, other, value = true) {\n        if (isHave(param) === false) {\n            return other;\n        }\n\n        if (value && this.isFormula(param)) {\n            return other;\n        }\n        return param;\n    }\n\n    // what === cell cell merge   merge\n    setCellText(ri, ci, {text, style, formulas, merge = \"\"},  what = 'all') {\n        if(what === 'all_with_no_workbook') {\n            this.setCell(ri, ci, {}, 'all_with_no_workbook');\n            return;\n        }\n\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        // _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n        if (what === 'style') {\n            _cell.style = style;\n            _cell.formulas = text;   //    cell.formulas = cell.formulas;\n        }   else if (what === 'format') {\n            _cell.formulas = cell.formulas;\n            _cell.style = style;\n        } else if (what === 'cell') {\n            _cell.style = style;\n            _cell.formulas = formulas;\n            _cell['merge'] = undefined;\n            if (merge !== \"\") {\n                _cell.merge = merge;\n            }\n        } else {\n            _cell.formulas = text;\n        }\n        _cell.text = text;\n        this.setCell(ri, ci, _cell);\n\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    setCellAll(ri, ci, text, formulas = \"\") {\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.formulas = formulas === \"\" ? cell.formulas : formulas;\n        _cell.text = text;\n\n        this.setCell(ri, ci, _cell, 'formulas');\n        this.setCell(ri, ci, _cell, 'text');\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    moveChange(arr, arr2, arr3) {\n        if (arr.length !== arr2.length && arr3.length !== arr2.length) {\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n\n            let s1 = arr[i].expr;\n            arr[i].each((ri, ci) => {\n                let cell = this.getCell(ri, ci);\n                if (isHave(cell) === false) {\n                    cell = {};\n                }\n                if (!isHave(cell.formulas)) {\n                    cell.formulas = \"\";\n                }\n\n                let formulas = changeFormula(cutStr(cell.formulas));\n\n                if (formulas.indexOf(s1) !== -1) {\n                    let ca = arr3[i].expr.replace(/\\$/g, \"\\\\$\");\n\n                    this.setCellAll(ri, ci, cell.text.replace(new RegExp(ca, 'g'), arr2[i].expr), cell.formulas.replace(ca, arr2[i].expr));\n                } else {\n                    let s = value2absolute(s1);\n                    let es = value2absolute(arr2[i].expr);\n                    if (formulas.indexOf(s.s3) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n\n                        s.s3 = s.s3.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s3, 'g'), es.s3), cell.formulas.replace(new RegExp(s.s3, 'g'), es.s3));\n                    } else if (formulas.indexOf(s.s2) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s2 = s.s2.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s2, 'g'), es.s2), cell.formulas.replace(new RegExp(s.s2, 'g'), es.s2));\n                    } else if (formulas.indexOf(s.s1) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s1 = s.s1.replace(/\\$/g, \"\\\\$\");\n\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s1, 'g'), es.s1), cell.formulas.replace(new RegExp(s.s1, 'g'), es.s1));\n                    }\n                }\n            });\n        }\n    }\n\n    formatMoney(s, type) {\n        if (/[^0-9\\.]/.test(s))\n            return \"0\";\n        if (s == null || s === \"\")\n            return \"0\";\n        s = s.toString().replace(/^(\\d*)$/, \"$1.\");\n        s = (s + \"00\").replace(/(\\d*\\.\\d\\d)\\d*/, \"$1\");\n        s = s.replace(\".\", \",\");\n        let re = /(\\d)(\\d{3},)/;\n        while (re.test(s))\n            s = s.replace(re, \"$1,$2\");\n        s = s.replace(/,(\\d\\d)$/, \".$1\");\n        if (type === 0) {\n            let a = s.split(\".\");\n            if (a[1] === \"00\") {\n                s = a[0];\n            }\n        }\n        return s;\n    }\n\n    // isValid => true   false  \n    getCellStyleConvert(cellStyle, isValid) {\n        if (cellStyle && cellStyle.format && cellStyle.format === 'number') {\n            return \"number\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'rmb') {\n            return 'rmb';\n        } else if ((cellStyle && cellStyle.format && cellStyle.format === 'normal')) {\n            return \"normal\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'percent') {\n            return \"percent\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'datetime') {\n            return \"datetime\";\n        } else if (\n            (isValid && !isHave(cellStyle))\n            || (isValid && cellStyle && cellStyle.format !== 'normal')\n            || cellStyle && cellStyle.format && cellStyle.format === 'date') {\n            return \"date\";\n        }\n\n        return \"\";\n    }\n\n    getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, abs = 0, isRows) {\n        let enter = false;\n        let s = \"\";\n        if (isInsert) {\n            if (sri <= ds[1] && isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[1] && !isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[0] && isAdd && isRows === false) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            }\n        }\n\n        return {\n            \"enter\": enter,\n            \"data\": s,\n        }\n    }\n\n    eachRange(range) {\n        let cells = [];\n        range.each((i, j) => {\n            let cell = this.getCell(i, j);\n            if (isHave(cell)) {\n                let empty = isEmpty(cell);\n                cell = deepCopy(cell);\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), empty);\n                cells.push(cellProp);\n            } else  {\n                cell = {};\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), true);\n                cells.push(cellProp);\n            }\n        });\n\n        return cells;\n    }\n\n    getCellTextByShift(arr, dei, dci, isInsert = false, isAdd = false, sri = 0, isRows = false) {\n        let bad = false;\n        let enter = false;\n        let newStr = \"\";\n\n        for (let i = 0; i < arr.length; i++) {\n            // if(isInsert && isHave(arr[i])) {\n            //     arr[i] = arr[i].replace(/\\$/, '');\n            // }\n            if (typeof arr[i] === 'string') {\n                arr[i] = arr[i].toUpperCase();\n            }\n            if (arr[i].search(/^[A-Z]+\\d+$/) !== -1) {\n                let ds = expr2xy(arr[i]);\n                if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    arr[i] = args.data;\n                } else if (isInsert === false) {\n                    arr[i] = xy2expr(ds[0] + dei, ds[1] + dci);\n                }\n                enter = true;\n            } else if (arr[i].search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                let a1 = arr[i].split(\":\")[0];\n                let a2 = arr[i].split(\":\")[1];\n                let ds1 = expr2xy(a1);\n                let ds2 = expr2xy(a2);\n\n                if (ds1[0] + dei < 0 || ds1[1] + dci < 0) {\n                    bad = true;\n                }\n                if (ds2[0] + dei < 0 || ds2[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let s = \"\";\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds1, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s = args.data + \":\";\n                } else if (isInsert === false) {\n                    s = xy2expr(ds1[0] + dei, ds1[1] + dci) + \":\";\n                } else {\n                    s = a1 + \":\";\n                }\n\n                args = this.getCellTextIsAdd(isInsert, sri, ds2, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s += args.data;\n                } else if (isInsert === false) {\n                    s += xy2expr(ds2[0] + dei, ds2[1] + dci);\n                } else {\n                    s += a2;\n                }\n\n                enter = true;\n                arr[i] = s;\n            } else {\n                let value = isAbsoluteValue(arr[i], 5);\n\n                if (value === 2) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0] + dei, ds[1], 2);\n                    }\n                    enter = true;\n                } else if (value === 1) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0], ds[1] + dci, 1);\n                    }\n\n                    enter = true;\n                } else if (value === 4) {\n                    let sp = arr[i].split(\":\");\n                    console.log(arr[i], sp);\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 5) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 7) {\n                    let sp = arr[i].split(':');\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 6) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 8) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 9) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 10) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 11) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                }\n            }\n            newStr += arr[i];\n        }\n\n        return {\n            \"bad\": bad,\n            \"enter\": enter,\n            \"result\": newStr\n        };\n    }\n\n    autoFilterRef(ref, range) {\n        let [ci, ri] = expr2xy(ref);\n        let cell = this.getCell(ri, ci);\n        while (cell !== null) {\n            ri += 1;\n            cell = this.getCell(ri, ci);\n        }\n        range.eri = ri;\n\n        return range;\n    }\n\n    // getAllDataType(cellRange)\n    getAllDataType(cellRange) {\n        let isNumber = true, isDate = true, sarr = [];\n\n        cellRange.each((i, j) => {\n            let und = false, cell = this.getCell(i, j);\n            if (cell) {\n                cell = deepCopy(cell);\n                let args = new CellProxy(cell).getCellDataType(sarr, {isDate, isNumber});\n                // pasteProxy.getCellDataType(cell, sarr, {isDate, isNumber}); // let args = CellProxy(cell).getCellDataType()\n                isDate = args.isDate;\n                isNumber = args.isNumber;\n            } else {\n                und = true;\n                isNumber = false;\n                isDate = false;\n            }\n\n            if (und) {\n                sarr.push({\n                    text: 0,\n                    formulas: 0,\n                    tmp: \"\",\n                    type: \"other\",\n                });\n            }\n        });\n\n        return {\n            isDate: isDate, isNumber: isNumber, sarr\n        }\n    }\n\n    calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb) {\n        let {text, formulas} = ncell;\n        text = this.toString(text);\n        formulas = this.toString(formulas);\n        let cell = {};\n        if (this.isFormula(formulas)) {\n            let last1 = text.replace(\"=\", \"\") * 1;\n\n            let value = last1 + diffValue;\n            cell = {\n                \"text\": \"=\" + value + \"\",\n                \"formulas\": \"=\" + value + \"\",\n            };\n        } else if (text !== '') {\n            let last1 = text * 1;\n            if (text.indexOf(\",\") !== -1) {\n                last1 = last1.replace(/,/g, '');\n                let value = parseFloat(last1) + diffValue;\n                last1 = this.formatMoney(value, 0);\n            } else {\n                last1 = last1 + diffValue;\n            }\n\n            cell = {\n                \"text\": last1 + \"\",\n                \"formulas\": last1 + \"\",\n            };\n        }\n\n        this.copyRender(darr, d.ri, d.ci, cell, what, cb);\n    }\n\n    calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb) {\n        let strList = splitStr(iText);\n        let args = this.getRangeByTopCell({ri: d.ri, ci: d.ci}, direction, isAdd);\n        let dci = d.ri - args.ri;\n        let dri = d.ci - args.ci;\n        let {bad, result} = this.getCellTextByShift(strList, dri, dci);\n        this.updateCellReferenceByShift(bad, result, d.ri, d.ci, cb);\n    }\n\n    calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text) {\n\n        if (!isHave(iText)) {\n            iText = \"\";\n        }\n        if (!isNaN(iText)) {\n            ncell.text = iText;\n            ncell.formulas = ncell.text;\n        } else {\n            let arr = this.toString(iText).split(/\\d+/g);\n            if (arr) {\n                let count = 0;\n                if (isAdd) {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 + 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                } else {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 - 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                }\n                ncell.formulas = ncell.text;\n            }\n        }\n        this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    }\n\n    calcDateCellByTopCell(ncell, darr, d, isAdd, what, cb, diff) {\n        if (ncell.text !== '') {\n            let last1 = ncell.text;\n\n            let value = \"\";\n            if (isAdd) {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            } else {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            }\n            ncell.text = this.toString(value);\n            ncell.formulas = this.toString(value);\n            this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n        }\n    }\n\n    getRangeByTopCell({ri, ci}, direction, isAdd) {\n        if (isAdd) {\n            ri = !direction ? ri - 1 : ri;\n            ci = !direction ? ci : ci - 1;\n        } else {\n            ri = !direction ? ri + 1 : ri;\n            ci = !direction ? ci : ci + 1;\n        }\n\n        return {ri, ci};\n    }\n\n    // logProxy.log({\"msg\":\"12312\"})  console.log --> logProxy.log\n    getCellByTopCell(d, direction, isAdd, what = 'all', dri = 0, dci = 0) {\n        if (what === 'date') {\n            if (direction === 1) {\n                let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, false, isAdd);\n                return this.getCellByCell(ri, ci);\n            } else if (direction === 2) {\n                return this.getCellByCell(d.ri, d.ci - 1);\n            } else if (direction === 3) {\n                return this.getCellByCell(d.ri, d.ci + 1);\n            }\n        } else {\n            let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, direction, isAdd);\n            return this.getCellByCell(ri, ci);\n        }\n    }\n\n    getCellByCell(ri, ci) {\n        let ncell = this.getCell(ri, ci);\n        if (!ncell) {\n            ncell = {\n                text: '',\n                formulas: '',\n            }\n        }\n\n        return helper.cloneDeep(ncell);\n    }\n\n    updateCellReferenceByShift(bad, result, ri, ci, cb = () => {\n    }) {\n        let _cell = {};\n        if (bad) {\n            _cell.text = \"#REF!\";\n            _cell.formulas = \"#REF!\";\n        } else {\n            _cell.text = result !== \"\" ? result : '';\n            _cell.formulas = result !== \"\" ? result : '';\n        }\n        // rows.setCellText(ri, ci, {text, style}, proxy, this.name, 'style');\n        this.setCell(ri, ci, _cell, 'all');\n        cb(ri, ci, _cell);\n    }\n\n    // what: all | format | text\n    // \n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {pasteProxy} = this;\n        pasteProxy.setSrcAndDstCellRange(srcCellRange, dstCellRange);\n        let {rn, cn} = pasteProxy.use();\n        let isLeftRight = pasteProxy.autoFilterDirection();\n\n        let len = isLeftRight ? rn : cn;\n        for (let i = 0; i < len; i++) {\n            let isDown = pasteProxy.upOrDown();\n            let {srcOneDRange, dstOneDRange} = pasteProxy.getOneDRangeObj(isLeftRight, i);\n            let {isNumber, isDate, sarr} = this.getAllDataType(srcOneDRange);\n            // let isCopy = pasteProxy.isCopy(sarr, i);\n\n            let darr = dstOneDRange.getLocationArray(sarr); //let dstOneDLocationAarray = dstOneDRange.getLocationArray()\n            let line = pasteProxy.leftOrRight(); // \n            let other = false;\n\n            for (let i = 0; i < darr.length; i++) {\n                let d = darr[i];\n                if (isNumber || d.type === 'number' || isDate || d.type === 'date') {\n                    other = true;\n                }\n            }\n\n            if (isDown) {\n                for (let i = 0; i < darr.length; i++) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            } else {\n                for (let i = darr.length - 1; i >= 0; i--) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            }\n        }\n    }\n\n\n    copyRender(darr, nri, nci, ncell, what, cb) {\n        let as = false;\n        for (let k = 0; as === false && k < darr.length; k++) {\n            if (darr[k].ri === nri && darr[k].ci === nci) {\n                as = true;\n            }\n        }\n        if (as) {\n            this.setCell(nri, nci, ncell, what);\n            cb(nri, nci, ncell);\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        let srcCell = [];\n        // const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n\n                if (ri * 1 !== nri || ci * 1 !== nci) {\n                    // ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                    if (this._[ri].cells[ci].text !== '' && this._[ri].cells[ci].formulas !== '') {\n                        srcCell.push({\n                            nri: nri,\n                            nci: nci,\n                            ri: ri,\n                            ci: ci,\n                            cell: deepCopy(this._[ri].cells[ci]),\n                        })\n                        // this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    }\n\n                    // if (this._[ri].cells[ci].style) {\n                    //     this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    // }\n                }\n            });\n        });\n        for (let i = 0; i < srcCell.length; i++) {\n            let {ri, ci} = srcCell[i];\n            this.setCell(ri, ci, {}, 'all');\n        }\n\n        for (let i = 0; i < srcCell.length; i++) {\n            let {nri, nci, cell} = srcCell[i];\n            this.setCell(nri, nci, cell, 'all');\n        }\n\n        // this._ = ncellmm;\n    }\n\n    insert(sri, n = 1) {\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= sri) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n, true, true, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n\n            ndata[nri] = row;\n        });\n\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n * -1, true, false, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri - n, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1) {\n        let cells = [];\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= sci) {\n                    nci += n;\n\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), n, 0, true, true, sci, false);\n                        if (enter && !bad) {\n                            cells.push({ri: ri, ci: nci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (isHave(cell.text)) delete cell.text;\n                    if (isHave(cell.value)) delete cell.value;\n                    if (isHave(cell.formulas)) delete cell.formulas;\n                    // if (isHave(cell.depend)) delete cell.depend;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    recast(cell) {\n        try {\n            if (this.isReferOtherSheet(cell, true)) {\n                let recast = new Recast(cell.formulas);\n                recast.parse();\n                cell['recast'] = recast;\n            } else {\n                cell['recast'] = null;\n            }\n        } catch (e) {\n            cell['recast'] = null;\n        }\n    }\n\n    init() {\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n            });\n        });\n    }\n\n    setData(d, sheet = \"\", out = false, rowsInit = false) {\n        try {\n            if (d.len) {\n                this.len = d.len;\n                delete d.len;\n            }\n            this._ = d;\n\n\n            if (out) {\n\n            } else if (sheet !== '') {\n                console.time(\"setData\");\n                if (rowsInit) {\n                    this.init();\n                    this.workbook = calcUtils.Rows2Workbook(this);\n                    sheet.toolbar.change('close', '');\n                }\n                console.timeEnd(\"setData\");\n\n            }\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n}\n\nexport {\n    Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  // setStyle(ci, style) {\n  //   const col = this.getOrNew(ci);\n  //   col.style = style;\n  // }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport {\n  Cols,\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport {\n  Validations,\n};\n","export default class Moved {\n    constructor() {\n        this.range = null;\n        this.state = 'move';\n    }\n\n    move(cellRange) {\n        this.range = cellRange;\n        this.state = 'move';\n\n        return this;\n    }\n}","/* global window */\n\n// import {setColor} from \"../plug-in/revision\";\n\nlet removeEvent = [];\n\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n    removeEvent.push({\n        name: name,\n        fn: fn,\n        target: target\n    })\n}\n\nexport function remove() {\n    for (let i = 0; i < removeEvent.length; i++) {\n        let re = removeEvent[i];\n        unbind(re.target, re.name, re.fn);\n    }\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\nexport function createEvent(keyCode, metaKey, name = \"keydown\", buttons = -1) {\n    let event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventType = 'message';\n    event.buttons = buttons;\n    event.keyCode = keyCode;\n    event.metaKey = metaKey;\n    document.dispatchEvent(event);\n}\n\n// the left mouse button: mousedown  mouseup  click\n// the right mouse button: mousedown  contenxtmenu  mouseup\n// the right mouse button in firefox(>65.0): mousedown  contenxtmenu  mouseup  click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\n// export function bindClickoutside2(el, revision) {\n//     el.xclickoutside = (evt) => {\n//         // ignore double click\n//         // console.log('evt:', evt);\n//         if (evt.buttons === 2 || el.contains(evt.target)) return false;\n//         else {\n//             // setColor.call(revision);\n//             el.hide();\n//             unbindClickoutside(el);\n//         }\n//     };\n//     bind(window.document.body, 'mousedown', el.xclickoutside);\n// }\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    target.xEvtUp = (evt) => {\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n","/* global window */\nexport const cssPrefix = 'fin-cell';\nexport const look = ['**', '*HYPERLINK*', '*MULTIPLECELLS*'];\nexport const look2 = '#CHECK';\nexport const filterFormula = ['CITY'];\nexport const offsetLeft = 60;\nexport const offsetTop = 70;\n\n// export const edgeRight = 30;\n// export const dpr = window.devicePixelRatio  || 1;\n// export const dpr = 1;\n","/* global window */\nimport {h} from './element';\nimport {mouseMoveUp} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Resizer {\n    constructor(vertical = false, minDistance) {\n        this.moving = false;\n        this.vertical = vertical;\n        this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n            this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n                .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n            this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n        ).hide();\n        // cell rect\n        this.cRect = null;\n        this.finishedFn = null;\n        this.minDistance = minDistance;\n    }\n\n    // rect : {top, left, width, height}\n    // line : {width, height}\n    show(rect, line) {\n        const {\n            moving, vertical, hoverEl, lineEl, el,\n        } = this;\n        if (moving) return;\n        this.cRect = rect;\n        const {\n            left, top, width, height,\n        } = rect;\n        el.offset({\n            left: vertical ? left + width - 5 : left,\n            top: vertical ? top : top + height - 5,\n        }).show();\n        hoverEl.offset({\n            width: vertical ? 5 : width,\n            height: vertical ? height : 5,\n        });\n        lineEl.offset({\n            width: vertical ? 0 : line.width,\n            height: vertical ? line.height : 0,\n        });\n    }\n\n    hide() {\n        this.el.offset({\n            left: 0,\n            top: 0,\n        }).hide();\n    }\n\n    mousedownHandler(evt) {\n        let startEvt = evt;\n        const {\n            el, lineEl, cRect, vertical, minDistance,\n        } = this;\n        let distance = vertical ? cRect.width : cRect.height;\n        // console.log('distance:', distance);\n        lineEl.show();\n        mouseMoveUp(window, (e) => {\n            this.moving = true;\n            if (startEvt !== null && e.buttons === 1) {\n                // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n                if (vertical) {\n                    distance += e.movementX;\n                    if (distance > minDistance) {\n                        el.css('left', `${cRect.left + distance}px`);\n                    }\n                } else {\n                    distance += e.movementY;\n                    if (distance > minDistance) {\n                        el.css('top', `${cRect.top + distance}px`);\n                    }\n                }\n                startEvt = e;\n            }\n        }, () => {\n            startEvt = null;\n            lineEl.hide();\n            this.moving = false;\n            this.hide();\n            if (this.finishedFn) {\n                if (distance < minDistance) distance = minDistance;\n                this.finishedFn(cRect, distance);\n            }\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n// import {moveArr} from \"../event/paste\";\n\nexport default class Scrollbar {\n    constructor(vertical) {\n        this.vertical = vertical;\n        this.moveFn = null;\n        this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n            .child(this.contentEl = h('div', ''))\n            .on('mousemove.stop', () => {\n            })\n            .on('scroll.stop', (evt) => {\n                let {scrollTop, scrollLeft} = evt.target;\n                // scrollTop = scrollTop * 2;\n                // moveArr.call(this.sheet, scrollTop, scrollLeft);\n                if (this.moveFn) {\n                    this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n                }\n\n                // console.log('evt:::', evt);\n            });\n    }\n\n    move(v) {\n        // debugger\n        this.el.scroll(v);\n        return this;\n    }\n\n    scroll() {\n        return this.el.scroll();\n    }\n\n    set(distance, contentDistance) {\n        const d = distance - 1;\n        // console.log('distance:', distance, ', contentDistance:', contentDistance);\n        if (contentDistance > d) {\n            const cssKey = this.vertical ? 'height' : 'width';\n            this.el.css(cssKey, `${d - 15}px`).show();\n            this.contentEl\n                .css(this.vertical ? 'width' : 'height', '1px')\n                .css(cssKey, `${contentDistance}px`);\n        } else {\n            this.el.hide();\n        }\n        return this;\n    }\n}\n","import {CellRange} from \"../core/cell_range\";\nimport {cssPrefix} from \"../config\";\nimport {h} from \"./element\";\nimport {selectorHeightBorderWidth} from \"./selector\";\n\nexport default class SelectorCell {\n    constructor(data) {\n        this.el = h('div', `${cssPrefix}-selector-cell`);\n        this.data = data;\n        this._ = new CellRange(0, 0, 0, 0);\n    }\n\n    resetSelectOffset() {\n        let rect = this.data.getRect(this._);\n        this.setOffset(rect);\n    }\n\n    setData(ri, ci) {\n        ri = ri === -1 ? 0 : ri;\n        ci = ci === -1 ? 0 : ci;\n\n        let {data} = this;\n        let {merges} = data;\n\n        let enter = false;\n        merges.each(range => {\n            if (range.includeByRiCi(ri, ci)) {\n                this._ = range;\n                enter = true;\n            }\n        });\n\n        if (!enter) {\n            this._ = new CellRange(ri, ci, ri, ci);\n        }\n    }\n\n    toolbarChangeSelectorCell() {\n        let ri = this._.sri;\n        let ci = this._.sci;\n\n        this.setData(ri, ci);\n    }\n\n    setOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.el.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {xy2expr} from \"../core/alphabet\";\nimport {deepCopy} from '../core/operator';\nimport SelectorCell from \"./selector_cell\";\nimport CellProp from \"../model/cell_prop\";\n\nexport const selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n\n                } else {\n                    this.moveEvent(1);\n                }\n\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(2);\n                }\n            }).on('click', (evt) => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                }\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    evt.stopPropagation();\n                }\n                this.moveEvent(3);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(4);\n                }\n            });\n\n\n        this.cornerEl.on('mousedown', evt => {\n            let {detail} = evt;\n            if (detail === 2) {\n                sheet.clickCopyPaste();\n                evt.stopPropagation();\n            }\n        });\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .children(this.cornerEl, this.boxinner).hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    border(value) {\n        this.areaEl.css('border', value);\n    }\n\n    longTimeBefore(time = 500) {\n        this.boxinner.hide();\n\n        setTimeout(() => {\n            this.boxinner.show();\n        }, time);\n    }\n\n    moveEvent(direction) {\n        console.log(60);\n        let {data, _selector, sheet,} = this;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = _selector.range;\n        let _cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let {selectorMoveEl} = sheet;\n        selectorMoveEl.set(-1, -1, true);\n        selectorMoveEl.hide();\n\n        mouseMoveUp(window, (e) => {\n            sheet.container.css('pointer-events', 'none');\n            _selector.setBoxinner(\"none\");\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                cellRange.move(ri, ci);\n                //     if(direction == 4) {\n                //         cellRange = new CellRange(eri, eci, eri, eci, w, h);\n                //     } else if(direction == 2) {\n                //         cellRange = new CellRange(sri, eci, eri, eci, w, h);\n                //     } else if(direction == 1) {\n                //         cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                // }\n\n                const rect = data.getMoveRect(cellRange);\n                selectorMoveEl.range = cellRange;\n                selectorMoveEl.setMove(rect);\n                selectorMoveEl.el.show();\n            }\n        }, () => {\n            // \n            let {rows} = data;\n            let arr = [], arr2 = [], arr3 = [];\n\n            _cellRange.each((i, j) => {\n                console.log(rows.getCell(i, j), i, j);\n                let cell = rows.getCell(i, j);\n                let movedCell = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}:${xy2expr(j, i)}`);\n                let movedCell2 = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}`);\n                arr.push(movedCell);\n                arr3.push(movedCell2);\n            });\n            cellRange.each((i, j) => {\n                let movedCell = new CellProp(i, j, deepCopy(rows.getCell(i, j) || {}), xy2expr(j, i));\n                arr2.push(movedCell);\n            });\n\n            data.cutPaste(_cellRange, cellRange, false);\n            sheet.container.css('pointer-events', 'auto');\n            _selector.setBoxinner(\"auto\");\n            selectorMoveEl.hide();\n\n            const rect = data.getMoveRect(cellRange);\n            selector.range = cellRange;\n            selector.ci = cellRange.sci;\n            selector.ri = cellRange.sri;\n\n            _selector.indexes = [selector.ri, selector.ci];\n            _selector.moveIndexes = [cellRange.sri, cellRange.sci];\n            _selector.range = cellRange;\n            _selector.setMove(rect);\n\n            sheet.selector.selectCell.setData(cellRange.sri, cellRange.sci);\n            // sheet.selectorMoveReset();\n\n            // \n            // if (_cellRange.eri != _cellRange.sri || _cellRange.eci != _cellRange.sci) {\n            //     let erpxArr = [];\n            //     let erpxArr2 = [];\n            //     let erpxArr3 = [];\n            //     for (let i = _cellRange.sci; i <= _cellRange.eci; i++) {\n            //         for (let j = _cellRange.sri; j <= _cellRange.eri; j++) {\n            //             erpxArr.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr.length; i++) {\n            //         for (let j = 0; j < erpxArr.length; j++) {\n            //             if (i <= j) {\n            //                 erpxArr2.push([i, j])\n            //             }\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr[a];\n            //         let a1 = erpxArr[b];\n            //         arr.push(`${a2}:${a1}`);\n            //         arr3.push(`${a2}:${a1}`);\n            //     }\n            //\n            //     for (let i = cellRange.sci; i <= cellRange.eci; i++) {\n            //         for (let j = cellRange.sri; j <= cellRange.eri; j++) {\n            //             erpxArr3.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr3[a];\n            //         let a1 = erpxArr3[b];\n            //\n            //         arr2.push(`${a2}:${a1}`);\n            //     }\n            //\n\n            // let {worker} = this;\n            // worker.terminate();\n            // worker = new Worker();\n            // worker.postMessage({ arr: arr, arr2: arr2, arr3: arr3, rows: rows });\n            //\n            // worker.onmessage = function (event) {\n            // };\n            //\n            // worker.addEventListener(\"message\", function (event) {\n            //     rows._ = event.data.rrows;\n            //     sheet.editor.display = true;\n            //     rows.moveChange(arr, arr2, arr3);\n            //     sheet.selectorMoveReset();\n            // });\n            console.time(\"move\");\n            rows.moveChange(arr, arr2, arr3);\n            console.timeEnd(\"move\");\n\n            sheet.selectorMoveReset();\n        });\n    }\n\n    setCss(b) {\n        this.areaEl.css('border', `2px dashed ${b}`);\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n\n        this.cornerEl.css(\"pointer-events\", pointer);\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n    constructor(data, sheet, sc = false) {\n        this.data = data;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.sheet = sheet;\n\n        // this.selectT = new SelectorElement(data, this, sheet);\n        // this.selectL = new SelectorElement(data, this, sheet);\n        // this.selectTl = new SelectorElement(data, this, sheet);\n\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        if (sc) {\n            this.selectCell = new SelectorCell(data, sc);\n            this.el.child(this.selectCell.el);\n        } else {\n            this.selectCell = new SelectorCell(data, sc);\n        }\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n\n    longTimeBefore() {\n        this.tl.longTimeBefore();\n        this.br.longTimeBefore();\n        this.t.longTimeBefore();\n        this.l.longTimeBefore();\n    }\n\n    setCss(b) {\n        this.br.setCss(b);\n        this.t.setCss(b);\n        this.l.setCss(b);\n        this.tl.setCss(b);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n\n        this.selectCell.resetSelectOffset();\n\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n\n\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        // this.resetSelectOffset(cellRange);\n\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    autoFilterRef() {\n        console.log(this.range);\n    }\n\n    setEnd(ri, ci, moving = true, enter = false) {\n        const {data } = this;\n        if (moving) {\n            // if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci, sci, sri} = this.data.selector.range;\n        //  ctrl + c bug  \n        this.set(sri, sci);\n\n        this.setEnd(eri, eci, true, true);\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    //\n    showAutofill(ri, ci, pos) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n\n        // pos == 1 pos == 3  pos == 2  pos == 4 \n        let drisc = 0;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        // const srn = sri - ri;\n        // const scn = sci - ci;\n        // const ern = eri - ri;\n        // const ecn = eci - ci;\n        // console.log(srn, scn, ern, ecn, ri, ci);\n        if (pos === 2) {\n            drisc = 11;\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // console.log(this.arange);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (pos === 4) {\n            drisc = 22;\n\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (pos === 3) {\n            drisc = 33;\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (pos === 1) {\n            drisc = 44;\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return drisc;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n        return drisc;\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {bind, bindClickoutside, createEvent, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport CellRange from \"../core/cell_range\";\n\nfunction inputMovePrev(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex -= 1;\n    if (this.itemIndex < 0) {\n        this.itemIndex = filterItems.length - 1;\n        this.el.el.scrollTop = this.el.el.scrollHeight;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0 || filterItems.length < this.itemIndex) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex += 1;\n    if (this.itemIndex > filterItems.length - 1) {\n        this.itemIndex = 0;\n        this.el.el.scrollTop = 0;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n    console.log(filterItems.length);\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n    evt.preventDefault();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    evt.stopPropagation();\n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n        this.hide();\n             createEvent.call(this, 13, false);\n\n        return\n    }\n\n    filterItems[this.itemIndex].el.click();\n    this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n    const {keyCode} = evt;\n    if (evt.ctrlKey) {\n        evt.stopPropagation();\n    }\n    switch (keyCode) {\n        case 37: // left\n            evt.stopPropagation();\n            break;\n        case 38: // up\n            inputMovePrev.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 39: // right\n            evt.stopPropagation();\n            break;\n        case 40: // down\n            inputMoveNext.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 13: // enter\n            inputEnter.call(this, evt);\n            break;\n        case 9:\n            inputEnter.call(this, evt);\n            break;\n        default:\n            evt.stopPropagation();\n            break;\n    }\n}\n\nexport default class Suggest {\n    constructor(items, itemClick, data, editor, width = '200px') {\n        this.filterItems = [];\n        this.items = items;\n        this.data = data;\n        this.editor = editor;\n        this.el = h('div', `${cssPrefix}-suggest`)\n            .css('width', width)\n            .css('overflow-y', 'auto')\n            .css('max-height', '306px').hide();\n        this.el.attr('tabindex', 0);\n\n\n        this.itemClick = itemClick;\n        this.itemIndex = -1;\n        this.show = false;\n    }\n\n    setOffset(v) {\n        this.el.cssRemoveKeys('top', 'bottom')\n            .offset(v);\n    }\n\n    hide() {\n        const {el} = this;\n        this.filterItems = [];\n        this.itemIndex = -1;\n        el.hide();\n        this.show = false;\n        unbindClickoutside(this.el.parent());\n    }\n\n    setItems(items) {\n        this.items = items;\n        // this.search('');\n    }\n\n    search(word) {\n        let {items, data, editor} = this;\n        if (!/^\\s*$/.test(word)) {\n            items = items.filter(it => (it.key.toUpperCase() || it.toUpperCase()).startsWith(word.toUpperCase()));\n        }\n        items = items.map((it) => {\n            let {title} = it;\n            if (title) {\n                if (typeof title === 'function') {\n                    title = title();\n                }\n            } else {\n                title = it;\n            }\n            const item = h('div', `${cssPrefix}-item`)\n                .child(title)\n                .on('click.stop', () => {\n                    this.itemClick(it);\n                });\n            if (it.label) {\n                item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        this.filterItems = items;\n        if (items.length <= 0) {\n            this.hide();\n            this.show = false;\n            return;\n        }\n        const {el} = this;\n        // items[0].toggle();\n        let rect = data.getRect(new CellRange(editor.ri, editor.ci, editor.ri, editor.ci));\n        let left = rect.left + 55;\n        let top = rect.top + 50;\n\n        if( items.length >= 9 && rect.top - 306 >= 50) {\n            top -= 306;\n            top -= rect.height;\n        }\n        el.css('left', `${left}px`);\n        el.css('top', `${top}px`);\n\n        el.html('').children(...items).show();\n        this.show = true;\n        bindClickoutside(el.parent(), () => {\n            this.hide();\n            this.show = false;\n        });\n    }\n\n    bindInputEvents(input) {\n        input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n    }\n}\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'fin-cell-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport {calendarPattern, str2Re} from \"../utils/reg_pattern\";\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (str2Re(calendarPattern).test(date)) { // jobs: todo: \n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","import {cssPrefix} from \"../config\";\nimport {h} from \"../component/element\";\nimport {helpFormula} from \"../core/operator\";\nimport {bind} from \"./event\";\n\nfunction variableElement(content, txt, pos, className, s = \"\", s2 = \"\") {\n    let item = h('div', className);\n    for (let i = 0; i < content[txt].length; i++) {\n        let ct = content[txt][i];\n        let {name, editor, index} = ct;\n\n        if (pos === i) {\n            item.child(h('span', s).child(name));\n        } else if (editor === true && pos >= index) {\n            item.child(h('span', s).child(name));\n        } else {\n            item.child(h('span', s2).child(name));\n        }\n    }\n\n    return item;\n}\n\nexport default class SuggestContent {\n    constructor(width = \"300px\") {\n        this.el = h('div', `${cssPrefix}-suggest-content`).css('width', width).css('z-index', \"10000\").css('position', \"absolute\").hide();\n        this.el.attr('tabindex', 0);\n        bind(this.el.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n    }\n\n    hide() {\n        const {el} = this;\n        el.hide();\n    }\n\n    content(cut = \"\", pos = -1) {\n        const {el} = this;\n\n        cut = cut.toUpperCase();\n        // cut \n        let content = {};\n        Object.keys(helpFormula).forEach(i => {\n            if (i === cut) {\n                content = helpFormula[i];\n            }\n        });\n\n        if (!content || JSON.stringify(content) === '{}') {\n            return;\n        }\n\n        let items = [];\n        let title = variableElement.call(this, content, \"title\", pos, `${cssPrefix}-help-title`, `${cssPrefix}-help-span-title`, `${cssPrefix}-help-span2-title`);\n        let exampleName = h('div', `${cssPrefix}-help-section-title`).child(\"\");\n        let example = variableElement.call(this, content, \"example\", pos, `${cssPrefix}-help-section-content`, `${cssPrefix}-help-span3-title`);\n        items.push(...[title, exampleName, example]);\n        Object.keys(content.content).forEach(i => {\n            let c = content.content[i];\n            let item = h('div', `${cssPrefix}-help-section-title`).child(i);\n            let item2 = h('div', `${cssPrefix}-help-section-content`).child(c);\n            items.push(...[item, item2]);\n        });\n\n        el.html('').children(...items).show();\n    }\n}","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\nimport {cuttingByPos, cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {lockCells} from \"./formula_editor\";\nimport {CellRange} from \"../core/cell_range\";\nimport {mouseMoveUp} from \"./event\";\n\nfunction find(str, cha) {\n\n    return str.lastIndexOf(cha);\n}\n\nexport default class SelectorMove {\n    constructor(boxinner, data, sheet, selector) {\n        this.l = h('div', `${cssPrefix}-selector-box-l-move-l`);\n        this.r = h('div', `${cssPrefix}-selector-box-l-move-r`);\n        this.t = h('div', `${cssPrefix}-selector-box-l-move-t`);\n        this.b = h('div', `${cssPrefix}-selector-box-l-move-b`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n\n        this.event(this.l, 1);\n        this.event(this.r, 2);\n        this.event(this.t, 3);\n        this.event(this.b, 4);\n        this.boxinner = boxinner;\n        this.boxinner.children(\n            this.l,\n            this.r,\n            this.t,\n            this.b,\n        );\n    }\n\n    event(target, dict) {\n        let timer = null;\n        target.on('mousedown.stop', evt => {\n            let {data, sheet, _selector} = this;\n            let p = -1;\n            let {selector} = data;\n            let _move_selectors = null;\n            let {sri, sci, eri, eci, w, h} = selector.range;\n            let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n            let _cellRange = null;\n            let {selectors} = sheet;\n            let msri = -1, msci = -1, meri = -1, meci = -1;\n\n            mouseMoveUp(window, (e) => {\n                clearTimeout(timer);\n                timer = setTimeout(() => {\n                    sheet.container.css('pointer-events', 'none');\n                    for (let i = 0; i < selectors.length; i++) {\n                        let selector = selectors[i];\n                        selector.selector.setBoxinner(\"none\");\n                    }\n\n                    let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n                    if (ri !== -1 && ci !== -1) {\n                        let {pos} = this.sheet.editor;\n                        let inputText = this.sheet.editor.editorText.getText();\n                        let _erpx = cuttingByPos(inputText, pos - 1, true);\n                        if (inputText.length > pos - 1) {\n                            _erpx += cuttingByPosEnd(inputText, pos - 1);\n                        }\n                        for (let i = 0; i < selectors.length; i++) {\n                            let selector = selectors[i];\n                            let {className, erpx} = selector;\n\n                            if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n                                if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    cellRange.move(ri, ci);\n                                    const rect = data.getMoveRect(cellRange);\n                                    _move_selectors.selector.range = cellRange;\n                                    _move_selectors.selector.setMove(rect);\n                                } else {\n                                    _move_selectors.selector.set(ri, ci, true);\n                                }\n                                break;\n                            } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                                p = p !== -1 ? p : find(inputText, selector.erpx);\n                                this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                                if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    if (_cellRange === null) {\n                                        _cellRange = cellRange;\n                                    }\n                                    if (dict === 4) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        // console.log(cellRange, _cellRange);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                } else {\n                                    let e1 = expr2xy(selector.erpx);\n                                    let e2 = expr2xy(selector.erpx);\n                                    let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                    if (dict === 4) {\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                }\n                                break;\n                            }\n                        }\n\n                        if (_move_selectors\n                            && (msri !== cellRange.sri\n                                || msci !== cellRange.sci\n                                || meri !== cellRange.eri\n                                || meci !== cellRange.eci)) {\n                            _move_selectors.selector.setCss(_move_selectors.color, false);\n                            lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                        }\n                        msri = cellRange.sri;\n                        msci = cellRange.sci;\n                        meri = cellRange.eri;\n                        meci = cellRange.eci;\n                    }\n                }, 6);\n            }, () => {\n                clearTimeout(timer);\n                let {selectors} = this.sheet;\n                sheet.container.css('pointer-events', 'auto');\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    selector.selector.setBoxinner(\"all\");\n                }\n                p = -1;\n                if (_move_selectors && _move_selectors.selector)\n                    _move_selectors.selector.setCss(_move_selectors.color, true);\n                _move_selectors = null;\n            })\n        });\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {lockCells} from \"../component/formula_editor\";\nimport {cuttingByPos} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport SelectorMove from \"./selector_move\";\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nfunction  find(str, cha) {\n    return str.lastIndexOf(cha);\n}\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        // this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this._selector = selector;\n        this.sheet = sheet;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n\n\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.selectorMove = new SelectorMove(this.boxinner, data, sheet, selector);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .child(this.boxinner)\n            .hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    moveEvent(evt) {\n        let {data, _selector, sheet} = this;\n        let _move_selectors = null;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = selector.range;\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let p = -1;\n        mouseMoveUp(window, (e) => {\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'none');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"none\");\n            }\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                let { pos} = this.sheet.editor;\n                let inputText = this.sheet.editor.editorText.getText();\n                let _erpx = cuttingByPos(inputText, pos - 1, true);\n                if (inputText.length > pos - 1) {\n                    _erpx += cuttingByPosEnd(inputText, pos - 1);\n                }\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    let {className, erpx} = selector;\n\n                    if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n                        if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                        p = p !== -1 ? p : find(inputText, selector.erpx);\n                        this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                        if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    }\n                }\n                if (_move_selectors) {\n                    _move_selectors.selector.setCss(_move_selectors.color, false);\n                    lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                }\n            }\n        }, () => {\n            //   e.layerX, e.layerY   xy\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'auto');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"all\");\n            }\n            p = -1;\n            if (_move_selectors && _move_selectors.selector)\n                _move_selectors.selector.setCss(_move_selectors.color, true);\n            _move_selectors = null;\n        });\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n        this.selectorMove.l.css(\"pointer-events\", pointer);\n        this.selectorMove.r.css(\"pointer-events\", pointer);\n        this.selectorMove.t.css(\"pointer-events\", pointer);\n        this.selectorMove.b.css(\"pointer-events\", pointer);\n    }\n\n    setCss(b, key = true) {\n        if (!key) {\n            this.areaEl.css(\"border\", `2px solid ${b}`);\n        } else {\n            this.areaEl.css(\"border\", `2px dashed ${b}`);\n        }\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class SelectorCopy {\n    constructor(data, sheet, className) {\n        this.data = data;\n        this.className = className;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n    setCss(b, key = true) {\n        this.br.setCss(b, key);\n        this.t.setCss(b, key);\n        this.l.setCss(b, key);\n        this.tl.setCss(b, key);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    setEnd(ri, ci, moving = true) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    // reset() {\n    //     // console.log('::::', this.data);\n    //     const {eri, eci} = this.data.selector.range;\n    //     this.setEnd(eri, eci);\n    // }\n\n    showAutofill(ri, ci) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        if (scn > 0) {\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (srn > 0) {\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (ecn < 0) {\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (ern < 0) {\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n    ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n    ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n    ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n    ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n    ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst selectColors = [\"#EE0000\", \"#8A2BE2\", \"#FF3E96\", \"#8B4500\", \"#3A5FCD\", \"#FF7F24\"];\n\nexport function selectorColor(index) {\n    index = index % selectColors.length;\n    return {\n        color: selectColors[index],\n        index: index,\n    };\n}\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nfunction buildTd(bgcolor) {\n    let item = h('div', `${cssPrefix}-color-palette-cell`)\n        .on('click.stop', () => this.change(bgcolor))\n        .css('background-color', bgcolor);\n\n    this.items.push(\n        item\n    );\n    return h('td', '').child(item);\n}\n\nexport default class ColorPalette {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-color-palette`);\n        this.change = () => {\n        };\n        this.items = [];\n        const table = h('table', '').children(\n            h('tbody', '').children(\n                h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n                    ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n                ),\n                ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n                    ...it.map(color => buildTd.call(this, color)),\n                )),\n                h('tr', `${cssPrefix}-standard-colors`).children(\n                    ...standardColors.map(color => buildTd.call(this, color)),\n                ),\n            ),\n        );\n        this.el.child(table);\n    }\n}\n","import SelectorCopy from '../component/selector_copy';\nimport {\n    cutFirst,\n    cutStr,\n    cutting,\n    cutting2,\n    cuttingByPos,\n    isAbsoluteValue,\n    operation,\n    value2absolute,\n} from '../core/operator';\nimport {expr2xy, xy2expr} from '../core/alphabet';\nimport {selectorColor} from './color_palette';\nimport {h} from './element';\n\n/**\n * sheet.js\n */\n\n\nfunction lockCells(evt, _selector, isAb = false, p = -1) {\n    const {data, editor} = this;\n    const {offsetX, offsetY} = evt;\n\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {ri, ci} = cellRect;\n\n    let {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let input = '';\n\n    editor.handler(inputText);\n    const {mousedownIndex} = editor;\n    if (isAbsoluteValue(cuttingByPos(inputText, pos), 2) || _selector) {\n        if (_selector) {\n            const {\n                sri, sci, eri, eci,\n            } = _selector.selector.range;\n\n            const s1 = xy2expr(sci, sri);\n            const s2 = xy2expr(eci, eri);\n            let text = s1 === s2 ? s1 : `${s1}:${s2}`;\n\n            if (isAb === 2) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s1 === es2.s1 ? es1.s1 : `${es1.s1}:${es2.s1}`;\n            } else if (isAb === 1) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s2 === es2.s2 ? es1.s2 : `${es1.s2}:${es2.s2}`;\n            } else if (isAb === 3) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s3 === es2.s3 ? es1.s3 : `${es1.s3}:${es2.s3}`;\n            }\n            _selector.erpx = text;\n            let {isCors} = editor;\n            if (isCors) {\n                pos = 1;\n            }\n\n            let sp = p !== -1 ? p : pos - cuttingByPos(inputText, pos).length;\n            input = inputText.substring(0, sp) + text + inputText.substring(pos, inputText.length);\n            editor.setText(input);\n            editor.setCursorPos(inputText.substring(0, sp).length + text.length);\n        } else {\n            // : =A1  -> A2  : =A2\n            let enter = 0;\n            for (let i = 0; i < this.selectors.length && enter === 0; i++) {\n                const selector = this.selectors[i];\n                const {erpx} = selector;\n                if (erpx === cuttingByPos(inputText, pos)) {\n                    const {ri, ci} = cellRect;\n                    this.selectors[i].ri = ri;\n                    this.selectors[i].ci = ci;\n                    this.selectors[i].erpx = xy2expr(ci, ri);\n                    this.selectors[i].selector.set(ri, ci);\n                    input = `${inputText.substring(0, pos - erpx.length)}${xy2expr(ci, ri)}${inputText.substring(pos, inputText.length)}`;\n                    editor.setText(input);\n                    editor.setCursorPos(inputText.substring(0, pos - erpx.length).length + xy2expr(ci, ri).length);\n                    enter = 1;\n                }\n            }\n        }\n    } else if (mousedownIndex.length > 0) {\n        if (operation(mousedownIndex[1][0]) && isAbsoluteValue(cuttingByPos(mousedownIndex[1], mousedownIndex[1].length), 2)) {\n            editor.setLock(false);\n            return;\n        }\n\n        const args = makeSelector.call(this, ri, ci);\n        this.selectors.push(args);\n        input = `${mousedownIndex[0]}${xy2expr(ci, ri)}${mousedownIndex[1]}`;\n        const judgeText = input.substring(mousedownIndex[0].length + xy2expr(ci, ri).length, input.length);\n        // \n        let number = cutFirst(judgeText.substring(1));\n        if (operation(judgeText[0]) && !isAbsoluteValue(number, 2)) {\n            editor.setText(input);\n            editor.setMouseDownIndex([]);\n            return;\n        }\n        // \n        number = cutFirst(mousedownIndex[1]);\n\n        console.log(xy2expr(ci, ri));\n        const cut = cutStr(`${mousedownIndex[0]}${xy2expr(ci, ri)}+4${mousedownIndex[1]}`);\n        const {selectors_delete, selectors_new} = filterSelectors.call(this, cut);\n        Object.keys(selectors_delete).forEach((i) => {\n            const selector = selectors_delete[i];\n            selector.removeEl();\n        });\n\n        this.selectors = selectors_new;\n\n        input = input.replace(number, '');\n        editor.setText(input);\n        // const content = suggestContent.call(this, pos - 1, cutting(inputText), inputText);\n        editor.setCursorPos(mousedownIndex[0].length + xy2expr(ci, ri).length);\n    } else {\n        const {pos} = editor;\n\n        const args = _selector || makeSelector.call(this, ri, ci);\n        if (pos !== -1) {\n            let str = '';\n            let enter = false;\n            let step = pos;\n            let first = '';\n            for (let i = pos; i < inputText.length; i++) first += inputText[i];\n            let len = cutFirst(first).length;\n            for (let i = 0; i < inputText.length; i++) {\n                if (pos === i) {\n                    enter = true;\n                    str += xy2expr(ci, ri);\n                }\n\n                if (step === i && len > 0) {\n                    step += 1;\n                    len -= 1;\n                } else {\n                    str += inputText[i];\n                }\n            }\n\n            if (_selector) {\n                const {\n                    sri, sci, eri, eci,\n                } = data.selector.range;\n                const s1 = xy2expr(sci, sri);\n                const s2 = xy2expr(eci, eri);\n\n                input = s1 === s2 ? s1 : `${s1}:${s2}`;\n                str = !enter ? str + input : str;\n            } else {\n                this.selectors.push(args);\n                str = !enter ? str + xy2expr(ci, ri) : str;\n            }\n            editor.setText(str);\n            editor.setCursorPos(str.length);\n            editor.parse();\n        } else {\n            this.selectors.push(args);\n            input = `${inputText}${xy2expr(ci, ri)}`;\n            editor.setText(input);\n        }\n    }\n    editor.parse(editor.pos);\n    if (this.selectors.length > 0 || _selector) {\n        // const {inputText} = editor;\n        let inputText = editor.editorText.getText();\n        //  \n        let it = inputText, enter = false;\n        let {merges} = this.data;\n        Object.keys(merges._).forEach(i => {\n            let m = merges._[i];\n            const cut = cutStr(it, true);\n            for (let i = 0; i < cut.length; i++) {\n                if (cut[i].indexOf(\":\") !== -1) {\n                    let a1 = cut[i].split(\":\")[0];\n                    let a2 = cut[i].split(\":\")[1];\n                    let e1 = expr2xy(a1);\n                    let e2 = expr2xy(a2);\n\n                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                        it = it.replace(new RegExp(cut[i], 'g'), a1);\n                        enter = true;\n                    }\n                }\n            }\n        });\n\n\n        // clearSelectors.call(this);\n        // console.log(it);\n        div2span.call(this, cutting(it), cutting2(it));\n        if (enter) {\n            setTimeout(() => {\n                editor.setCursorPos(it.length);\n            }, 10);\n        }\n    }\n    // step 3.  entercell\n    // dataSetCellText.call(this, input, 'input');\n}\n\nfunction filterSelectors(cut) {\n    const selectors_new = [];\n    const selectors_delete = [];\n    Object.keys(this.selectors).forEach((i) => {\n        const selector = this.selectors[i];\n        const {erpx} = selector;\n        let enter = 0;\n        for (let i2 = 0; i2 < cut.length && enter === 0; i2++) {\n            if (cut[i2].replace(/\\$/g, '') === erpx) {\n                enter = 1;\n                selectors_new.push(selector);\n            }\n        }\n\n        if (enter === 0) {\n            selectors_delete.push(selector.selector.el);\n        }\n    });\n    return {\n        selectors_delete,\n        selectors_new,\n    };\n}\n\nfunction makeSelector(ri, ci, selectors = this.selectors, multiple = false, _selector, mergeSelector) {\n    const {data} = this;\n    let selector = null;\n    // const {inputText} = this.editor;\n    let inputText = this.editor.editorText.getText();\n    const {color, index} = selectorColor(selectors.length);\n    if (_selector) {\n        selector = _selector;\n    } else {\n        const className = `selector${Math.random() * 999999}`;\n        selector = new SelectorCopy(data, this, className);\n        selector.el.attr('class', `${className} clear_selector`);\n        selector.setCss(color);\n    }\n\n    if (multiple) {\n        if (mergeSelector) {\n            selector.setEnd(ri, ci);\n        } else {\n            selector.set(ri, ci, true);\n        }\n    } else {\n        selector.set(ri, ci, false);\n    }\n\n    selector.el.css('z-index', '100');\n    const len = inputText.split(xy2expr(ci, ri)).length - 2;\n\n    let it = xy2expr(ci, ri);\n    let {merges} = data;\n    Object.keys(merges._).forEach(i => {\n        let m = merges._[i];\n        const cut = cutStr(it, true);\n        for (let i = 0; i < cut.length; i++) {\n            if (cut[i].indexOf(\":\") !== -1) {\n                let a1 = cut[i].split(\":\")[0];\n                let a2 = cut[i].split(\":\")[1];\n                let e1 = expr2xy(a1);\n                let e2 = expr2xy(a2);\n\n                if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                    it = it.replace(new RegExp(cut[i], 'g'), a1);\n                }\n            }\n        }\n    });\n\n    const args = {\n        ri,\n        ci,\n        index: len,\n        color,\n        index2: index,\n        className: selector.el.el.className,\n        erpx: it,\n        selector,\n    };\n    if (!mergeSelector) {\n        selector.el.show();\n        this.selectorsEl.child(selector.el);\n    }\n\n    if (multiple) {\n        return args;\n    }\n\n    this.selectorsEl.child(selector.el);\n    return args;\n}\n\nfunction clearSelectors() {\n    this.selectorsEl.html('');\n    this.selectors = [];\n    const {editor, selector} = this;\n    editor.setLock(false);\n\n    // //  @~esc ri ci-1\n    // editor.setRiCi(-1, -1);\n    editor.state = 1;\n    selector.el.show();\n}\n\n//  input\nfunction editingSelectors(text = '') {\n    if (typeof text === 'number') {\n        return;\n    }\n    const selectors_new = [];\n    const cut = cutStr(text, true);\n    // case 1   selectors\n    const {selectors_delete} = filterSelectors.call(this, cut);\n\n    Object.keys(selectors_delete).forEach((i) => {\n        const selector = selectors_delete[i];\n        selector.removeEl();\n    });\n\n\n    const selectors_valid = selectors_new;\n    // case 2   selectors\n    Object.keys(cut).forEach((i) => {\n        let enterCode = 1;\n        Object.keys(this.selectors).forEach((i) => {\n            const {selector} = this.selectors[i];\n            selector.el.removeEl();\n        });\n\n        // \n        let arr = '';\n        let sc = cut[i].replace(/\\$/g, \"\");\n        if (isAbsoluteValue(cut[i])) {\n            const notTrueValue = cut[i].replace(/\\$/g, '');\n            arr = expr2xy(notTrueValue);\n        } else if (sc.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n            enterCode = 2;\n        } else {\n            arr = expr2xy(cut[i]);\n        }\n\n        if (enterCode === 1) {\n            const ri = arr[1];\n            const\n                ci = arr[0];\n            const args = makeSelector.call(this, ri, ci, selectors_valid);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        } else if (enterCode === 2) {\n            const prx = cut[i].replace(/\\$/g, '').split(':')[0];\n            const lax = cut[i].replace(/\\$/g, '').split(':')[1];\n\n            const prx_index = expr2xy(prx);\n            const lax_index = expr2xy(lax);\n            let args = makeSelector.call(this, prx_index[1], prx_index[0], selectors_valid, true, null, false);\n            args = makeSelector.call(this, lax_index[1], lax_index[0], selectors_valid, true, args.selector, true);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        }\n    });\n    this.selectors = selectors_valid;\n\n    if (this.selectors.length > 0 || text[0] === '=') {\n        div2span.call(this, cutting(text), cutting2(text));\n    }\n}\n\n//  ( index\nfunction findBracketLeft(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i - 1; j > 0 && stop === false; j--) {\n        if (cut[j] === '(') {\n            stop = true;\n        }\n        if (cut[j] === ')') {\n            has++;\n        }\n    }\n\n    for (let j = i; j > 0 && begin === -1; j--) {\n        if (cut[j] === '(') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n// => { left: 0, right: 0,  exist: false }\nfunction findBracket(pos, cut, text) {\n    let args = {left: 0, right: 0, exist: false};\n    if (text[pos] !== ')') {\n        return args;\n    }\n    const right = pos;\n    const left = findBracketLeft.call(this, cut, right);\n\n    if (left !== -1 && right !== -1) {\n        args = {left, right, exist: true};\n    }\n    return args;\n}\n\n\n//  )  index\nfunction findBracketRight(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i + 1; j < cut.length && stop === false; j++) {\n        if (cut[j] === ')') {\n            stop = true;\n        }\n        if (cut[j] === '(') {\n            has++;\n        }\n    }\n\n    for (let j = i; j < cut.length && begin === -1; j++) {\n        if (cut[j] === ')') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n\nfunction suggestContent(pos, cut, inputText) {\n    // \n    // step 1. posindex\n    // step 2. 1\n    // step 3. \n    const content = {suggestContent: false, cut: '', pos: 1};\n    const begin = pos - 1;\n    const left = findBracketLeft.call(this, cut, begin);\n    const right = findBracketRight.call(this, cut, left);\n\n    if (left <= begin && left !== -1 && (right >= begin || right === -1)) {\n        content.suggestContent = true;\n        content.cut = cuttingByPos(inputText, left);\n    }\n\n    for (let i = left; i < begin + 1; i++) {\n        if (inputText[i] === ',') {\n            content.pos += 2;\n        }\n    }\n\n    return content;\n}\n\nfunction div2span(cut, cutcolor) {\n    const {editor} = this;\n\n    const spanArr = [];\n    let begin = -1;\n    let end = -1;\n\n    Object.keys(cut).forEach((i) => {\n        const spanEl = h('span', `formula_span${i}`);\n        Object.keys(cutcolor).forEach(() => {\n            if (cutcolor[i] && cutcolor[i].code !== -1 && cutcolor[i].data === cut[i]) {\n                const {color} = selectorColor(cutcolor[i].code);\n                spanEl.css('color', color);\n            }\n        });\n        spanEl.css('display', 'inline-block');\n        spanEl.css('cursor', 'text');\n\n        if (cut[i] === ' ') {\n            spanEl.html('&emsp;');\n        } else {\n            spanEl.html(cut[i]);\n        }\n\n        spanArr.push(spanEl);\n    });\n\n    // \n    const {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let content = {suggestContent: false, cut: ''};\n    if (inputText[pos - 1] === ')') {\n        begin = pos - 1;\n        end = findBracketLeft.call(this, cut, begin);\n    } else {\n        content = suggestContent.call(this, pos + 1, cut, inputText);\n    }\n\n\n    if (inputText !== '' && spanArr.length <= 0) {\n        const spanEl = h('span', 'formula_span');\n        spanArr.push(spanEl);\n    }\n    // \n    editor.mount2span(spanArr, begin, end, content);\n}\n\n\nexport {\n    lockCells,\n    clearSelectors,\n    editingSelectors,\n    findBracket,\n    suggestContent,\n    makeSelector,\n};\n","const baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\n// const fonts = (ary = []) => {\n//   const map = {};\n//   baseFonts.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\n\nexport {\n  fontSizes,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","import {expr2xy, xy2expr} from './alphabet';\nimport {look, look2} from \"../config\";\n// import XLSX_CALC from \"calc\"\n// var formulajs = require('formulajs');\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgsLen = 1; // A1,A2,A3...\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        // console.log('c:', c);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1) {\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log(operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    if (!subExpr) {\n        subExpr = \"\";\n    }\n    if (subExpr[0] >= '0' && subExpr[0] <= '9') {\n        return Number(subExpr);\n    }\n    if (subExpr[0] === '\"') {\n        return subExpr.substring(1);\n    }\n    const [x, y] = expr2xy(subExpr);\n    return cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        if (srcStack[i] === '+') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) + Number(top));\n        } else if (srcStack[i] === '-') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) - Number(top));\n        } else if (srcStack[i] === '*') {\n            stack.push(Number(stack.pop()) * Number(stack.pop()));\n        } else if (srcStack[i] === '/') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) / Number(top));\n        } else if (Array.isArray(srcStack[i])) {\n            const [formula, len] = srcStack[i];\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(srcStack[i])) {\n                return 0;\n            }\n            cellList.push(srcStack[i]);\n            let s = evalSubExpr(srcStack[i], cellRender);\n            stack.push(evalSubExpr(srcStack[i], cellRender));\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nfunction evalFormula(text, rule) {\n    if (typeof text !== 'string') {\n        return false;\n    }\n    // if (text.toUpperCase().indexOf(rule.toUpperCase()) === -1) {\n    //     return false;\n    // }\n    return text.toUpperCase().indexOf(rule.toUpperCase()) !== -1;\n}\n\nconst cellRender = (data, sheetbook, y, x, src, formulaMap, getCellText, cellList = []) => {\n    if (typeof src === 'undefined') {\n        return \"\";\n    }\n\n    if (typeof src === 'string' && look.indexOf(src.split(\"!\")[0]) !== -1) {\n        let len = src.length;\n        if(src.split(\" \")[0]) {\n            len = src.split(\" \")[0].length;\n        }\n        let a = JSON.parse(src.substring(src.indexOf(\"!\") + 1, len));\n        let s = look.indexOf(src.split(\"!\")[0]);\n\n        if (s === 1) {\n            return a.text;\n        } else if (s === 0) {\n            if (a && a[0]) {\n                let {name, value} = a[0];\n\n                if (value === 0 && a[1] && a[1].value !== 0) {\n                    return name;\n                } else if (value === 0 && !a[1]) {\n                    return name;\n                }\n            }\n        }\n\n        return look2;\n    }\n\n    if (src[0] === '=' && src[1] !== '=') {\n        // console.log(\"156\", sheetbook.Sheets.Sheet1[xy2expr(x, y)], xy2expr(x, y))\n        if (evalFormula(src.substring(1), \"wland\") || evalFormula(src.substring(1), \"wfr\") || evalFormula(src.substring(1), \"rtd\")\n            || evalFormula(src.substring(1), \"city\")) {\n            // let {date_formula} = data.settings;=MD.RTD(\"sina\", \"162411\", \"now\")\n            // date_formula.wland(date_formula, data);\n            return src.toUpperCase();\n        } else if (src.substring(1) && sheetbook && sheetbook.Sheets && sheetbook.Sheets[data.name] && sheetbook.Sheets[data.name][xy2expr(x, y)]) {\n            // sheetbook.Sheets.Sheet1[xy2expr(x, y)].f = src.substring(1).toUpperCase();\n            // XLSX_CALC.import_functions(formulajs);\n            // XLSX_CALC(sheetbook);\n\n            if ((sheetbook.Sheets[data.name][xy2expr(x, y)].f && sheetbook.Sheets[data.name][xy2expr(x, y)].f.search(/\\((\\+|\\-|\\*|\\/)/) !== -1) || sheetbook.Sheets[data.name][xy2expr(x, y)].v === undefined || sheetbook.Sheets[data.name][xy2expr(x, y)].v === \"\") {\n                return \"#ERROR!\";\n            }\n            sheetbook.Sheets[data.name][xy2expr(x, y)].v = sheetbook.Sheets[data.name][xy2expr(x, y)].v + \"\";\n\n            // let value = sheetbook.Sheets.Sheet1[xy2expr(x, y)].v ? sheetbook.Sheets.Sheet1[xy2expr(x, y)].v : \"NaN\";\n            return sheetbook.Sheets[data.name][xy2expr(x, y)].w ? sheetbook.Sheets[data.name][xy2expr(x, y)].w : sheetbook.Sheets[data.name][xy2expr(x, y)].v.replace(/'/g, \"\\\"\");\n        }\n        // const stack = infixExprToSuffixExpr(src.substring(1));\n        // if (stack.length <= 0) return src;\n\n        return src;\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","export const isMinus = (text) => {\n    if(isNaN(text)) {\n        return false;\n    } else if(text === \"\") {\n        return false;\n    }\n\n    // if(parseInt(text) >= 0)\n    //     return false;\n\n    return parseInt(text) < 0;\n};","/* global window */\nimport {isHave} from \"../core/helper\";\n\nfunction dpr() {\n    return window.devicePixelRatio || 1;       // \n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    let d = px * dpr() + \"\";\n    return parseInt(d, 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nfunction drawFlexFalse(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nfunction drawFlexTrue(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx + 6, sy);\n    ctx.lineTo(sx + 6, sy + 12);\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n                   top, bottom, left, right,\n               }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2);\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2);\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, fontSize, hoffset) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y = y + height / 2 - hoffset;\n            // y = y1;\n            // const y2 = y + padding + fontSize / 2 + 1;\n            // if (y1 < y2) y = y2;\n            // else y = y1;\n        } else if (align === 'bottom') {\n            y += height - hoffset * 2 - padding;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr() * 1, dpr() * 1);\n        this.cxc = {\n            indent: 250,\n            vIndent: 200,\n            canvasContext: this.ctx\n        }\n\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        // this.ctx.font.size = 30;\n        // console.log(\"203:\", this.ctx.font);\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    selfAdaptionHeight(box, txt, font) {\n        if (font === undefined || txt === undefined)\n            return;\n        let n = 1;\n        const textLine = {len: 0, start: 0};\n        let innerWidth = box.width - box.padding * 2;\n        for (let i = 0; i < txt.length; i += 1) {\n            if (textLine.len + box.padding >= innerWidth) {\n                n = n + 1;\n                textLine.len = 0;\n                textLine.start = i;\n            }\n            textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n        }\n\n        return n;\n    }\n\n    selfAdaptionTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width + box.padding * 2;\n    }\n\n    selfAdaptionOneTxtWidth(txt, font) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(txt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        // const {\n        //     align, valign, font, color, strike, underline, ignore, cindex\n        // } = attr;\n        const {\n            align, valign, font, color, strike, underline, ignore\n        } = attr;\n\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n\n        let txtWidth = this.selfAdaptionTxtWidth(txt, font, box);\n        let hoffset = 0;\n        let innerWidth = box.innerWidth();\n        if (textWrap) {\n            innerWidth = box.width - box.padding * 2;\n            const n = this.selfAdaptionHeight(box, txt, font);\n            hoffset = ((n - 1) * font.size) / 2;\n            // for (let i = 0; i < ignore.length; i++) {\n            //     if (cindex != ignore[i]) {\n            //         // hoffset = 0;\n            //     } else if (cindex == ignore[i]) {\n            //     }\n            // }\n        }\n        let ty = box.texty(valign, font.size, hoffset);\n        if (textWrap && txtWidth > innerWidth) {\n            const textLine = {len: 0, start: 0};\n            for (let i = 0; i < txt.length; i += 1) {\n                if (textLine.len + box.padding >= innerWidth) {\n                    // debugger\n                    this.fillText(txt.substring(textLine.start, i), tx, ty);\n                    if (strike) {\n                        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    if (underline) {\n                        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    ty += font.size + 2;\n                    textLine.len = 0;\n                    textLine.start = i;\n                }\n                textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n            }\n            if (textLine.len > 0) {\n                this.fillText(txt.substring(textLine.start), tx, ty);\n                if (strike) {\n                    drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                }\n                if (underline) {\n                    drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                }\n            }\n        } else {\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'striket', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n        }\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        ctx.beginPath();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropUp(box, state, diff) {\n        const {ctx} = this;\n        const {\n            x, y, height,\n        } = box;\n\n        const sx = x + 10;\n        const sy = y + height - 18 - diff;\n\n        // if (state) {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278539177.svg\";\n        // } else {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278579742.svg\";\n        // }\n        // img.onload = function () {\n        //   ctx.drawImage(img, npx(sx), npx(sy), 16, 16);\n        // }\n        if (state) {\n            drawFlexTrue.call(this, ctx, npx(sx), npx(sy))\n        } else {\n            drawFlexFalse.call(this, ctx, npx(sx), npx(sy))\n        }\n    }\n\n\n\n    lineTo(x, y) {\n        this.cxc.canvasContext.lineTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    moveTo(x, y) {\n        this.cxc.canvasContext.moveTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    };\n\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n\n    rect2(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, bgcolor,\n        } = box;\n        let {height} = box;\n        // if (textwrap == true) {\n        //     console.log(\"487\")\n        //     const n = this.selfAdaptionHeight(box, cellText);\n        //     height = height * n;\n        //     console.log(\"495\", height)\n        // }\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor === \"rgba(0, 0, 0, 0)\" ? '#fff' : bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","import {isHave} from \"../core/helper\";\n\nexport function testValid(valid = this.valid) {\n    if(isHave(valid)) {\n       valid.assert();\n    }\n}","import { stringAt} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {isMinus} from \"../utils/number_util\";\nimport {Draw, DrawBox, npx, thinLineWidth,} from '../canvas/draw';\nimport {look} from \"../config\";\n// import {deepCopy, distinct} from \"../core/operator\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n// import Worker from 'worker-loader!../external/Worker2.js';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(rindex, cindex) {\n    const {data} = this;\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\n// function getAutoDrawBox(rindex, cindex, width) {\n//     const {data} = this;\n//     const {\n//         left, top, height\n//     } = data.cellRect(rindex, cindex);\n//     return new DrawBox(left, top, width, height, cellPaddingWidth);\n// }\n\n// function getCellTextStyle(rindex, cindex) {\n//     const {data} = this;\n//     const {sortedRowMap} = data;\n//     let nrindex = rindex;\n//     if (sortedRowMap.has(rindex)) {\n//         nrindex = sortedRowMap.get(rindex);\n//     }\n//\n//     return data.getCellStyleOrDefault(nrindex, cindex);\n// }\n\nexport function toUpperCase(text) {\n    text = text.toString().toUpperCase();\n\n    return text;\n}\n\nfunction getChangeDataToCalc() {\n    let {data} = this;\n    let changeData = data.changeDataForCalc;\n    if (!isHave(changeData)) {\n        return {\n            \"state\": false,\n            \"data\": null,\n        }\n    } else {\n        return {\n            \"state\": true,\n            \"data\": changeData\n        }\n    }\n}\n\nfunction parseCell() {\n    let {data} = this;\n\n    let changeDataArgs = getChangeDataToCalc.call(this);\n    try {\n        data.calc(data.rows, changeDataArgs.data);\n    } catch(e) {\n        console.error(\"\" + e);\n    }\n\n    if (changeDataArgs.state) {\n        data.changeDataForCalc = null;\n    }\n}\n\n// export function parseCell2(viewRange, state = false, src = '') {\n//     let {data} = this;\n//     let {calc, rows} = data;\n//     let workbook = [];\n//     workbook.Sheets = {};\n//     workbook.Sheets[data.name] = {};\n//\n//     viewRange.each2((ri, ci) => {\n//         let cell = data.getCell(ri, ci);\n//         let expr = xy2expr(ci, ri);\n//         if (cell && cell.text) {\n//             cell.text = cell.text + \"\";\n//             if (cell.text.indexOf(\"MD.RTD\") !== -1) {\n//                 workbook.Sheets[data.name][expr] = {v: \"\", f: \"\"};\n//             } else {\n//                 if (cell.text && cell.text.lastIndexOf(\"=\") === 0) {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: '',\n//                         f: cell.text.replace(//g, '').replace(/\\\"/g, \"\\\"\").replace(/\\\"\\\"\\\"\\\"&/g, \"\\\"'\\\"&\")\n//                     };\n//                 } else {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: cell.text.replace(//g, '').toUpperCase().replace(/\\\"/g, \"\\\"\"),\n//                         f: ''\n//                     };\n//                 }\n//             }\n//         }\n//         else {\n//             workbook.Sheets[data.name][expr] = {v: 0, f: 0};\n//         }\n//     });\n//\n//\n//     if (state) {\n//         workbook.Sheets[data.name]['A1'] = {v: '', f: `${src}`};\n//     }\n//\n//     try {\n//         calc(workbook);\n//     } catch (e) {\n//         console.error(e);\n//     }\n//     return workbook;\n// }\n\nfunction specialStyle(text) {\n    text = text + \"\";\n    if (!text) {\n        return false;\n    }\n\n    return look.indexOf(text.split(\"!\")[0]) === 1;\n}\n\nfunction renderCell(rindex, cindex) {\n    const {draw, data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (!isHave(cell)) return;\n    // data.rows.setHeight(1, 50);\n\n    // console.log(rindex, nrindex, \"63\")\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox.call(this, rindex, cindex);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n\n    let cellText = \"\";\n\n    if (data.showEquation) {\n        if(isHave(cell.formulas)) {\n            cellText = cell.formulas;\n        }\n    } else if(isHave(cell.text)) {\n        cellText = cell.text;\n    }\n    draw.rect2(dbox, () => {\n        // render text\n        let args = data.renderFormat(style, cell, nrindex, cindex, false);\n        cellText = args.state ? args.cellText : cellText;\n        const font = Object.assign({}, style.font);\n\n        font.size = getFontSizePxByPt(font.size);\n        let {ignore, minus} = data.settings;\n        let color = style.color;\n        // console.log('style:', cellText);\n        if (minus === true && isMinus(cellText)) {\n            color = 'red'\n        }\n        let underline = style.underline;\n        let regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\n        cellText = cellText + \"\";\n        let text = cellText.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + cellText : cellText;\n        if (regex.test(text) || specialStyle(cell.text)) {\n            color = \"#4b89ff\";\n            underline = true;\n        }\n\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: color,\n            strike: style.strike,\n            underline: underline,\n            ignore: ignore,\n            cindex: cindex,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            draw.error(dbox);\n        }\n    });\n}\n\nfunction renderFlexible() {\n    const {draw, data} = this;\n    const {autoFilter} = data;\n    const {flex} = autoFilter;\n\n    for (let i = 0; i < flex.length; i++) {\n        let {ri, ci, state} = flex[i];\n        let s_t = 0;\n        for (let j = 0; j < i; j++) {\n            let {set_total, state} = flex[j];\n            if (state === true) {\n                s_t += set_total;\n            }\n        }\n\n        const dbox = getDrawBox.call(this, ri, ci);\n        draw.dropUp(dbox, state, s_t * 25);\n    }\n\n    // const dbox = getDrawBox.call(this, ri, ci);\n    // draw.dropUp(dbox);\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n\n        if (!autoFilter.active()) {\n            return;\n        }\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                const dbox = getDrawBox.call(this, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n    // renderFlexible.call(this, 1, 1)\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n    // 1 render cell\n    draw.save();\n\n    viewRange.each((ri, ci) => {\n        renderCell.call(this, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n    // 2 render cell border\n    // draw.save();\n    // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));\n    // draw.restore();\n\n    // / bboxes = [];\n    // 3 render mergeCell\n    const rset = new Set();\n    draw.save();\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell.call(this, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n\n    // 4 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    // 5 render flex\n    renderFlexible.call(this);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n                               sri, sci, eri, eci, w, h,\n                           }, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data, editor) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        // this.factory = new ApplicationFactory(data.methods, data.name, this);\n        this.editor = editor;\n        this.data = data;\n        this.timer = null;\n        // this.worker = new Worker();\n        this.autoAdaptList = [];\n    }\n\n\n    getCellTextContent(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const cell = data.getCell(nrindex, cindex);\n        if (cell === null) return;\n        // console.log(\"62\", cell.adapt);\n\n        return _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n    }\n\n    getDrawBox(rindex, cindex) {\n        const {data} = this;\n        const {\n            left, top, width, height,\n        } = data.cellRect(rindex, cindex);\n        return new DrawBox(left, top, width, height, cellPaddingWidth);\n    }\n\n    getCellTextStyle(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        return data.getCellStyleOrDefault(nrindex, cindex);\n    }\n\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        let viewRange = data.viewRange();\n\n        parseCell.call(this);\n        this.clear();\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        let fh = rows.height;\n\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n\n        renderFixedLeftTopCell.call(this, fw, fh);\n\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3x\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n        testValid.call(this);\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","import {cuttingByPos, cuttingByPosEnd2, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {toUpperCase} from \"./table\";\n\nexport default class EditorText {\n    constructor() {\n        this.inputText = \"\";\n        this.oldCell = \"\";\n        this.ri = -1;\n        this.ci = -1;\n    }\n\n    setText(text) {\n        this.inputText = text;\n        return this.getText();\n    }\n\n    getText() {\n        return this.inputText;\n    }\n\n    setOldCell(oldCell, {ri = -1, ci = -1} = -1) {\n        this.oldCell = oldCell;\n        this.ri = ri;\n        this.ci = ci;\n        return this.getOldCell();\n    }\n\n    // setRICI(ri, ci) {\n    //    this.ri = ri;\n    //     this.ci = ci;\n    // }\n\n    getOldCell() {\n        return this.oldCell;\n    }\n\n    getRICI() {\n        return {\n            \"ri\": this.ri,\n            \"ci\": this.ci,\n        };\n    }\n\n    changeText(type) {\n        if (type === 1) {\n            this.setText(this.getText().replace(//g, ','));\n        }\n    }\n\n    isFormula() {\n        let inputText = this.getText();\n\n        return inputText.lastIndexOf(\"=\") === 0;\n    }\n\n    f4ShortcutKey(pos) {\n        let inputText = this.setText(toUpperCase(this.inputText));\n        let value = cuttingByPos(inputText, pos, true);\n        let value2 = cuttingByPosEnd2(inputText, pos + 1);\n        console.log(value2);\n        let type = isAbsoluteValue(value, 5);\n        let d = \"\";\n        let n = value.split(\":\")[1];\n        if (n) {\n            type = isAbsoluteValue(n, 5);\n            type = type === 3 ? 6 : type;\n            type = type === 12 ? 9 : type;\n            type = type === 1 ? 7 : type;\n            type = type === 2 ? 8 : type;\n            console.log(type);\n        }\n\n        if (type !== false) {\n            switch (type) {\n                case 13:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    let text_b = inputText.substring(0, inputText.lastIndexOf(n));\n                    inputText = this.setText(text_b + d);\n                    break;\n                case 12:\n                    n = value;\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    console.log(value2absolute(value));\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    console.log(this.getText());\n                    break;\n                case 11:\n                case 10:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 9:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 8:\n                    n = value.split(\":\")[1];\n                    d = n.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 7:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 6:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 5:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 4:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 3:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 2:\n                    d = value.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 1:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n            }\n        }\n        let newPos = inputText.length;\n        inputText = this.setText(inputText + value2);\n        return {\n            \"pos\": newPos,\n            \"inputText\": inputText\n        };\n    }\n}\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\nimport {\n    cutting,\n    cuttingByPos,\n    cuttingByPos2,\n    cuttingByPosEnd,\n    deepCopy,\n    isAbsoluteValue,\n    operation\n} from '../core/operator';\nimport SuggestContent from './suggest_content';\nimport {findBracket, suggestContent} from './formula_editor';\nimport {createEvent} from './event';\nimport EditorText from \"./editor_text\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n\nfunction resetTextareaSize() {\n    const {\n        textlineEl, textEl, areaOffset,\n    } = this;\n    if (!areaOffset) {\n        return;\n    }\n    const tlineWidth = textlineEl.offset().width + 9 + 15;\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\n    if (tlineWidth > areaOffset.width && areaOffset.width !== 0) {\n        let twidth = tlineWidth;\n        if (tlineWidth > maxWidth) {\n            twidth = maxWidth - 15;\n            let h1 = parseInt(tlineWidth / (maxWidth - 15), 10);\n            h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            h1 *= this.rowHeight;\n            if (h1 > areaOffset.height) {\n                textEl.css('height', `${h1}px`);\n            }\n        }\n        textEl.css('width', `${twidth}px`);\n    }\n}\n\nfunction textFormat(e) {\n    e.preventDefault();\n    let text = \"\";\n    let clp = (e.originalEvent || e).clipboardData;\n    if (clp === undefined || clp === null) {\n        text = window.clipboardData.getData('text') || '';\n        if (text !== '') {\n            if (window.getSelection) {\n                let newNode = document.createElement('span');\n                newNode.innerHTML = text;\n                window.getSelection().getRangeAt(0).insertNode(newNode)\n            } else {\n                document.selection.createRange().pasteHTML(text)\n            }\n        }\n    } else {\n        text = clp.getData('text/plain') || '';\n        if (text !== '') {\n            document.execCommand('insertText', false, text)\n        }\n    }\n}\n\nconst getCursortPosition = function () {\n    let selection = window.getSelection();\n    if (selection.rangeCount <= 0) {\n        return 0;\n    }\n    const range = window.getSelection().getRangeAt(0);\n    const preSelectionRange = range.cloneRange();\n    preSelectionRange.selectNodeContents(this.textEl.el);\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n    const start = preSelectionRange.toString().length;\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    const {exist, left, right} = findBracket(start - 1, cutting(inputText), inputText);\n    Object.keys(this.spanArr).forEach((i) => {\n        this.spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n    });\n    const spanLeft = this.spanArr[left];\n    const spanRight = this.spanArr[right];\n    this.suggestContent.hide();\n    if (exist && spanLeft && spanRight) {\n        spanLeft.css('background-color', 'rgb(229, 229, 229)');\n        spanRight.css('background-color', 'rgb(229, 229, 229)');\n    } else {\n        const {show} = this.suggest;\n        const content = suggestContent.call(this, start, cutting(inputText), inputText);\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        }\n    }\n\n    return start;\n};\n\nfunction set_focus(el) {\n    if (!this) {\n        return;\n    }\n    const savedSel = {\n        start: this.pos,\n        end: this.pos,\n    };\n    let charIndex = 0;\n    const\n        range = document.createRange();\n    range.setStart(el, 0);\n    range.collapse(true);\n    const nodeStack = [el];\n    let node;\n    let foundStart = false;\n    let\n        stop = false;\n\n    while (!stop && (node = nodeStack.pop())) {\n        if (node.nodeType === 3) {\n            const nextCharIndex = charIndex + node.length;\n            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\n                range.setStart(node, savedSel.start - charIndex);\n                foundStart = true;\n            }\n            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\n                range.setEnd(node, savedSel.end - charIndex);\n                stop = true;\n            }\n            charIndex = nextCharIndex;\n        } else {\n            let i = node.childNodes.length;\n            while (i--) {\n                nodeStack.push(node.childNodes[i]);\n            }\n        }\n    }\n\n    const sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\n// const setCursorPosition = (elem, index) => {\n//     const val = elem.value || elem.textContent;\n//     const len = val.length;\n//\n//     // \n//     if (len < index) return;\n//     set_focus.call(this, elem);\n// };\n\nfunction mouseDownEventHandler() {\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    this.pos = getCursortPosition.call(this);\n    parse2.call(this, inputText, this.pos);\n}\n\nfunction setOldCell() {\n    let d = isDisplay.call(this);\n    if (d === false) {\n        let cell = this.data.getCell(this.ri, this.ci);\n        this.editorText.setOldCell(deepCopy(cell), {ri: this.ri, ci: this.ci});\n    }\n}\n\nfunction inputEventHandler(evt, txt = '', formulas = '', state = \"input\") {\n    setOldCell.call(this);\n\n    if (evt) {\n        const {\n            inputType,\n        } = evt;\n\n        if (inputType === 'insertFromPaste' && this.textEl.el.style['caret-color'] !== 'black') {\n            this.copy = true;\n            return;\n        }\n\n        if (inputType === 'historyUndo') {\n            return;\n        }\n    }\n\n\n    let {editorText} = this;\n    // let inputText = editorText.getText();\n\n    // if (inputText === '') {\n    //     const {data} = this;\n    //     const {history} = data;\n    //     history.add(data.getData());\n    // }\n\n    setTimeout(() => {\n        if (this.chinese === false) return;\n        let v = '';\n        if (this.data.settings.showEditor) {\n            this.sheet.selector.hide();\n        } else {\n            return;\n        }\n\n        if (txt === '' && evt && evt.target && evt.target.childNodes) {\n            let t1 = '';\n            for (let i = 0, len = evt.target.childNodes.length; i < len; i++) {\n                if (evt.target.childNodes[i].nodeType === 1) {\n                    v += evt.target.childNodes[i].innerText;\n                } else if (evt.target.childNodes[i].nodeType === 3) {\n                    t1 += evt.target.childNodes[i].nodeValue;\n                }\n            }\n            v = t1 !== '' ? t1 : v;\n        } else if (txt === '' && evt && isHave(evt.data)) {\n            v = evt.data !== '' ? evt.data : v;\n        } else {\n            v = txt;\n        }\n\n        if (this.copy) {\n            this.copy = false;\n            v = (evt && evt.data) ? evt.data : '';\n            this.textEl.html(v);\n            this.pos = v.length;\n            set_focus.call(this, this.textEl.el, -1);\n        }\n        this.changed = true;\n        const {\n            suggest, textlineEl, validator, textEl,\n        } = this;\n        editorText.setText(`${v}`);\n        // inputText = `${v}`;\n        editorText.changeText(1);\n        // inputText = inputText.replace(//g, ',');\n        this.pos = getCursortPosition.call(this);\n\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            v = v + \"\";\n            const start = v.lastIndexOf('=');\n            if (this.pos !== -1) {\n                parse2.call(this, v, this.pos);\n            } else parse.call(this, v);\n            let show = false;\n            let cutValue = cuttingByPos2(v, this.pos, true);\n            if (v.length >= this.pos) {\n                const isNumber = `${v[this.pos]}`;\n                if (isNumber.search(/^[0-9]+.?[0-9]*$/) !== -1) {\n                    show = true;\n                } else if (isNumber) {\n                    cutValue += cuttingByPosEnd(v, this.pos + 1);\n                }\n            }\n\n            if (start === 0 && v.length > 1 && cutValue !== '' && !show && cutValue.trim().length > 0) {\n                suggest.search(cutValue);\n            } else {\n                suggest.hide();\n            }\n        }\n\n\n        textlineEl.html(formulas || v);\n        editorText.setText(formulas || v);\n        this.suggest.itemIndex = -1;\n        resetTextareaSize.call(this);\n        if (v && v[0] !== '=') {\n            set_focus.call(this, textEl.el, -1);\n        }\n\n        if (formulas && formulas[0] === '=') {\n            v = formulas;\n        }\n        this.change(state, v);\n        // testValid.call(this);\n        setTimeout(() => {\n            this.show();\n        });\n    });\n\n}\n\nfunction keyDownEventHandler(evt) {\n    this.pos = getCursortPosition.call(this);\n    if (evt.code === 'ArrowRight') {\n        this.pos = this.pos + 1;\n    } else if (evt.code === 'ArrowLeft') {\n        this.pos = this.pos - 1;\n    }\n\n    const keyCode = evt.keyCode || evt.which;\n    // this.textEl.el.style['caret-color'] != 'black' esc\n    if (keyCode === 27 && this.textEl.el.style['caret-color'] === 'black' && this.textEl.el.style.opacity === '1') {\n        this.change('input', '@~esc');\n    } else if (keyCode === 37 || keyCode === 38 || keyCode === 39 || keyCode === 40) {\n    }\n}\n\nfunction parse(v) {\n    const start = v.lastIndexOf('=');\n\n\n    if (start === 0 && v.length >= 1 && operation(v[v.length - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, this.pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction parse2(v, pos) {\n    v = v + \"\";\n    const start = v.lastIndexOf('=');\n    if (start === 0 && v.length >= 1 && operation(v[pos - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction setTextareaRange() {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        // el.focus();\n        set_focus.call(this, el);\n        // el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text) {\n    const {textEl, textlineEl, tmp} = this;\n    // firefox bug\n    textEl.el.blur();\n    tmp.html(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this);\n}\n\n\nfunction suggestItemClick(it) {\n    const {validator, editorText} = this;\n    let inputText = editorText.getText();\n    if (validator && validator.type === 'list') {\n        // this.inputText = it;\n        inputText = editorText.setText(it);\n    } else {\n        this.pos = getCursortPosition.call(this);\n        const begin = this.pos - cuttingByPos(inputText, this.pos).length;\n        const c = cuttingByPosEnd(inputText, this.pos + 1);\n        const arr = ['', ''];\n        const end = this.pos + c.length;\n        for (let i = 0; i < inputText.length; i++) {\n            if (i < begin) {\n                arr[0] += inputText[i];\n            }\n\n            if (i > end - 1) {\n                arr[1] += inputText[i];\n            }\n        }\n        inputText = editorText.setText(`${arr[0] + it.key}(`);\n        // this.inputText = `${arr[0] + it.key}(`;\n        this.pos = editorText.getText().length;\n        inputText = editorText.setText(inputText + `)${arr[1]}`);\n        // this.inputText += `)${arr[1]}`;\n    }\n    this.textEl.html(inputText);\n    this.textlineEl.html(inputText);\n    this.suggest.hide();\n    parse2.call(this, inputText, this.pos);\n    this.change('input', inputText);\n    set_focus.call(this, this.textEl.el, -1);\n    resetTextareaSize.call(this);\n}\n\nfunction resetSuggestContentItems() {\n    this.suggestContent.hide();\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nfunction isDisplay() {\n    // if (this.textEl.el.style['caret-color'] === 'black'\n    //     && this.textEl.el.style.opacity === '1') return true;\n    return this.textEl.el.style['caret-color'] === 'black'\n        && this.textEl.el.style.opacity === '1';\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight, rowWidth, data, sheet) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.sheet = sheet;\n        this.display = true;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        }, data, this);\n        this.suggestContent = new SuggestContent();\n        this.lock = false;\n        this.state = 1;\n        this.data = data;\n        this.datepicker = new Datepicker();\n        this.isCors = false;\n        this.datepicker.change((d) => {\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.ri = -1;\n        this.ci = -1;\n        this.spanArr = [];\n        this.mousedownIndex = [];\n        this.changed = false;\n        this.chinese = true;\n\n        this.editorText = new EditorText('');\n\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('div', `${cssPrefix}-editor-textEl`)\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('click', () => mouseDownEventHandler.call(this,))\n                    .on('keyup', evt => keyDownEventHandler.call(this, evt))\n                    .on('mousedown', (evt) => {\n                        if (evt.detail === 2) {\n                            if (isDisplay.call(this)) {\n                                return;\n                            }\n                            this.show();\n                            setTimeout(() => {\n                                const {ri, ci} = this;\n                                console.log(ri, ci);\n                                this.setCellEnd(data.getSelectedCellRiCi(ri, ci));\n                            });\n                        }\n                    })\n                    .on('compositionstart', () => {\n                        this.chinese = false;\n                    })\n                    .on('compositionend', ( ) => {\n                        this.chinese = true;\n                    })\n                    .on('paste', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 67, true, \"paste\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('copy', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 86, true, \"sheetCopy\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('keydown', (evt) => {\n                        resetTextareaSize.call(this);\n                        this.textlineEl.html(evt.currentTarget.innerText);\n                        const key_num = evt.keyCode;\n                        // ctrl + v 67     ctrl + v  86\n                        if (key_num === 38 || key_num === 40) {\n                            evt.preventDefault();\n                        }\n                        if (key_num === 115) {       // F4\n                            let {inputText, pos} = this.editorText.f4ShortcutKey(getCursortPosition.call(this));\n                            inputEventHandler.call(this, null, inputText, inputText);\n                            setTimeout(() => {\n                                this.pos = pos;\n                                set_focus.call(this, this.textEl.el, -1);\n                            });\n                            return;\n                        }\n                        if (this.textEl.el.style['caret-color'] === 'black') return;\n                        const {\n                            ctrlKey, metaKey,\n                        } = evt;\n\n                        if (key_num === 8 || key_num === 46) {\n                            createEvent.call(this, 8, false);\n                        } else if (key_num === 40) {\n                            this.clear();\n                            createEvent.call(this, 40, false);\n                        } else if (key_num === 39) {\n                            this.clear();\n                            createEvent.call(this, 39, false);\n                        } else if (key_num === 37) {\n                            this.clear();\n                            createEvent.call(this, 37, false);\n                        } else if (key_num === 38) {\n                            this.clear();\n                            createEvent.call(this, 38, false);\n                        } else if (ctrlKey || metaKey) {\n                            if (key_num === 67) {\n                                createEvent.call(this, 67, true);\n                            } else if (key_num === 86) {\n                                createEvent.call(this, 86, true);\n                            } else if (key_num === 88) {\n                                createEvent.call(this, 88, true);\n                            } else if (key_num === 90) {\n                                createEvent.call(this, 90, true);\n                            } else if (key_num === 66) {\n                                createEvent.call(this, 66, true);\n                            }\n                        }\n                    }),\n                this.textlineEl = h('div', 'textline'),\n                this.suggestContent.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n\n        sheet.el.child(this.suggest.el);\n        this.el = h('div', `${cssPrefix}-editor`)\n            .children(this.areaEl);\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.textEl.on('paste', (evt) => {\n            if (isDisplay.call(this) === false)\n                return;\n            textFormat(evt);\n        });\n        this.tmp = h('span', 'span_tmp').hide();\n        this.textEl.attr('contenteditable', 'true');\n        this.textEl.css('width', `${rowWidth - 3}px`);\n        this.textEl.css('height', `${rowHeight - 2}px`);\n        this.textEl.child(this.tmp);\n        this.pos = 0;\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n\n        setTimeout(() => {\n            this.show(false);\n        });\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    setMouseDownIndex(index) {\n        this.mousedownIndex = index;\n    }\n\n    setRiCi(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n        // if (this.ri === -1 || this.ci === -1) {\n        //     return false;\n        // }\n        // const cell = this.data.rows.getCell(ri, ci);\n        //\n        // this.editorText.setOldCell(deepCopy(cell));\n    }\n\n    setLock(lock) {\n        this.lock = lock;\n    }\n\n    getLock() {\n        return this.lock;\n    }\n\n\n    show(off = true) {\n\n        if (off && this.data.settings.showEditor) {\n            this.textEl.css('caret-color', 'black');\n            this.textEl.css('cursor', 'text');\n            this.textEl.css('opacity', '1');\n            this.textEl.el.focus();\n            this.areaEl.css('pointer-events', 'auto');\n            this.areaEl.css('border', '2px solid #4b89ff');\n            this.areaEl.css('background', 'white');\n        } else {\n            this.textEl.css('caret-color', 'white');\n            this.textEl.css('cursor', 'default');\n            this.textEl.css('opacity', '0');\n            this.textEl.el.blur();\n            this.areaEl.css('pointer-events', 'none');\n            this.areaEl.css('background', 'rgba(75, 137, 255, 0)');\n            this.areaEl.css('border', 'none');\n        }\n    }\n\n    parse(pos = -1) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n        if (pos !== -1) {\n            this.pos = getCursortPosition.call(this);\n            parse2.call(this, inputText, this.pos);\n        } else {\n            parse.call(this, inputText);\n        }\n    }\n\n    clear(c = false) {\n\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        this.display = isDisplay.call(this);\n\n        if (inputText !== '' && isNaN(inputText) && inputText.replace(/\\s/g, \"\").lastIndexOf('') === 0) {\n            this.change('format', inputText);\n\n        } else if (this.changed) {\n\n            this.change('finish', inputText);\n\n        }\n\n        this.changed = false;\n        this.cell = null;\n        this.areaOffset = null;\n        editorText.setText('');\n        // this.inputText = '';\n        this.show(false);\n        this.copy = false;\n        set_focus.call(this, this.textEl.el, -1);\n        this.pos = 0;\n        this.tmp.hide();\n        this.textEl.html('');\n        this.textlineEl.html('');\n        resetSuggestContentItems.call(this);\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n\n        if (c) {\n            return false;\n        }\n\n        setTimeout(() => {\n            const {ri, ci} = this.data.selector;\n            this.setRiCi(ri, ci);\n        });\n\n        return this.display;\n    }\n\n    mount2span(spanArr, pos = -1, begin = -1, content = {suggestContent: false, cut: '', pos: -1}) {\n        if (this.spanArr === spanArr) {\n            return;\n        }\n\n        const {show} = this.suggest;\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        } else {\n            this.suggestContent.hide();\n        }\n        Object.keys(spanArr).forEach((i) => {\n            spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n        });\n        if (pos !== '-1' && begin !== -1 && spanArr[pos]) {\n            spanArr[pos].css('background-color', '#e5e5e5');\n            spanArr[begin].css('background-color', '#e5e5e5');\n        }\n\n        if (spanArr.length > 0) {\n            this.textEl.html('');\n            this.tmp = h('span', 'span_tmp').children(...spanArr)\n                .css('top', '0px').css('color', 'black').css('font-size', '14px').css('font-family', 'm-inconsolata,monospace,arial,sans,sans-serif');\n            this.textEl.el.insertBefore(this.tmp.el, this.textEl.el.childNodes[0]);\n            // this.textEl.el.removeChild(this.textEl.el.childNodes[this.textEl.el.childNodes.length - 1]);\n            set_focus.call(this, this.textEl.el, -1);\n        }\n\n        this.spanArr = spanArr;\n    }\n\n    handler(text) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        const cursorPos = this.pos;\n        if (cursorPos >= inputText) {\n            this.setMouseDownIndex([]);\n            return;\n        }\n        const textBegin = text.substring(0, cursorPos);\n        const textEnd = text.substring(cursorPos, text.length);\n        parse.call(this, textBegin);\n        if (textEnd !== '') {\n            this.setMouseDownIndex([textBegin, textEnd]);\n        } else {\n            this.setMouseDownIndex([]);\n        }\n    }\n\n    setOffset(offset, suggestPosition = 'top', show = true) {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 2 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            // suggest.setOffset(sOffset);\n            suggest.hide();\n            resetTextareaSize.call(this);\n            if (show) {\n                this.show(false);\n            }\n        }\n    }\n\n    setCellEnd(cell) {\n        let text = '';\n        let formulas = (cell && cell.formulas) || '';\n        if (isHave(cell) && isHave(cell.text)) {\n            text = cell.text;\n        }\n\n        if (isHave(cell) && isHave(cell.formulas)) {\n            text = cell.formulas;\n        }\n\n        let {data} = this;\n        let {rows} = data;\n        const style = data.getCellStyleOrDefault(this.ri, this.ci);\n        let args = data.renderFormat(style, cell, this.ri, this.ci, true);\n        if(args.state) {\n            text = args.cellText;\n            formulas = args.cellText;\n        }\n\n        this.textEl.child(text + \"\");\n        this.pos = text.length;\n        set_focus.call(this, this.textEl.el, -1);\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n\n        testValid.call(this);\n        inputEventHandler.call(this, null, text, formulas, \"end\");\n\n        setTimeout(() => {\n            this.pos = rows.toString(text).length;\n            set_focus.call(this, this.textEl.el, -1);\n        }, 20)\n    }\n\n    setCell(cell, validator, type = 1) {\n        this.cell = cell;\n        this.show();\n\n        let text = (cell && cell.formulas) || '';\n        text = text === '' ? (cell && cell.text) || '' : text;\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.textEl.show();\n        set_focus.call(this, this.textEl.el, -1);\n        setTimeout(() => {\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el);\n        }, 10);\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n\n        if (type === 2 && text !== '' && text[0] === '=') {\n            inputEventHandler.call(this, null, text);\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el, text.length);\n        } else if (type === 2 && text[0] !== '=') {\n            this.textEl.child(text);\n        }\n        setTimeout(() => {\n            this.textlineEl.html(text);\n            resetTextareaSize.call(this);\n        });\n    }\n\n    // inputEventHandler(text = '', pos = 1, hide = false) {\n    //     if (hide) {\n    //         this.areaEl.hide();\n    //         this.sheet.selector.hide();\n    //         this.isCors = true;\n    //     }\n    //     this.setCursorPos(pos);\n    //     inputEventHandler.call(this, null, text);\n    // }\n\n    // isDisplay() {\n    //     let {editorText} = this;\n    //\n    //     return isDisplay.call(this) && editorText.isFormula();\n    // }\n\n    isDisplay2() {\n        return isDisplay.call(this)\n    }\n\n    setCursorPos(pos) {\n        this.pos = pos;\n        set_focus.call(this, this.textEl.el);\n    }\n\n    setText(text) {\n        let {editorText} = this;\n        editorText.setText(text);\n        // this.inputText = text;\n        setText.call(this, text);\n        resetTextareaSize.call(this);\n        this.textEl.child(this.tmp);\n    }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  // { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  // { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  // { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', (evt) => {\n      this.itemClick(item.key, evt);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false) {\n    this.menus = buildMenu.call(this);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menus)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { height, width } = el.show().offset();\n    const view = this.viewFn();\n    let top = y;\n    let left = x;\n    if (view.height - y <= height) {\n      top -= height;\n    }\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.offset({ left, top });\n    bindClickoutside(el);\n  }\n}\n","import {Element, h} from './element';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Dropdown extends Element {\n    constructor(title, width, showArrow, placement, {type, change, arrowChange, historyBorder}, ...children) {\n        super('div', `${cssPrefix}-dropdown ${placement}`);\n\n        this.title = title;\n        this.change = () => {\n        };\n        if (typeof title === 'string') {\n            this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n        } else if (showArrow) {\n            this.title.addClass('arrow-left');\n        }\n        this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n            .children(...children)\n            .css('width', width)\n            .hide();\n\n        if (type) {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`).on('click', change);\n            this.headerEl.children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right_d`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`).on('click.stop', (evt) => {\n                        arrowChange(historyBorder);\n                        if (this.contentEl.css('display') !== 'block') {\n                            this.show();\n                        } else {\n                            this.hide();\n                        }\n                    }),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        } else {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n            this.headerEl.on('click', () => {\n                if (this.contentEl.css('display') !== 'block') {\n                    this.show();\n                } else {\n                    this.hide();\n                }\n            }).children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        }\n    }\n\n    setTitle(title) {\n        this.title.html(title);\n        this.hide();\n    }\n\n    show() {\n        const {contentEl} = this;\n        contentEl.show();\n        this.parent().active();\n        bindClickoutside(this.parent(), () => {\n            this.hide();\n        });\n    }\n\n    hide() {\n        this.parent().active(false);\n        this.contentEl.hide();\n        unbindClickoutside(this.parent());\n    }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', {type: false}, ...nfonts );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', {type: false}, ...nfontSizes );\n  }\n}\n","import {tf} from '../locale/locale';\nimport {isHave, isNumber} from \"./helper\";\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v, fixed = 2) => {\n    if(!isHave(v) || !isNumber(v)) {\n        return v;\n    }\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = fixed === -1 ? v.toString() : Number(v).toFixed(fixed).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        let value = first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1');\n        return value === 'NaN' ? v : value;\n    }\n\n    return v === 'NaN' ? v : v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'text',\n    //     title: tf('format.text'),\n    //     type: 'string',\n    //     render: formatStringRender,\n    // },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: (v) => {\n            const a = multiply(v, 100);\n            const a_s = `${a}`;\n            return `${a_s}%`;\n        },\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '10.00',\n        render: v => `${formatNumberRender(v)}`,\n    },\n    // {\n    //     key: 'usd',\n    //     title: tf('format.usd'),\n    //     type: 'number',\n    //     label: '$10.00',\n    //     render: v => `$${formatNumberRender(v)}`,\n    // },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '2009-01-01',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'datetime',\n        label: '20090101',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'time',\n    //     title: tf('format.time'),\n    //     type: 'date',\n    //     label: '15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'datetime',\n    //     title: tf('format.datetime'),\n    //     type: 'date',\n    //     label: '26/09/2008 15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'duration',\n    //     title: tf('format.duration'),\n    //     type: 'date',\n    //     label: '24:01:00',\n    //     render: formatStringRender,\n    // },\n];\n\nfunction isInteger(obj) {\n    return Math.floor(obj) === obj;\n}\n\n\n// function add(a, b, digits) {\n//     return operation(a, b, digits, 'add');\n// }\n//\n// function subtract(a, b, digits) {\n//     return operation(a, b, digits, 'subtract');\n// }\n\nexport function multiply(a, b, digits) {\n    return operation(a, b, digits, 'multiply');\n}\n\nfunction divide(a, b, digits) {\n    return operation(a, b, digits, 'divide');\n}\n\n/*\n *  3.14 >> 314 100\n * @param floatNum {number} \n * @return {object}\n *   {times:100, num: 314}\n */\nfunction toInteger(floatNum) {\n    const ret = {times: 1, num: 0};\n    const isNegative = floatNum < 0;\n    if (isInteger(floatNum)) {\n        ret.num = floatNum;\n        return ret;\n    }\n    const strfi = `${floatNum}`;\n    const dotPos = strfi.indexOf('.');\n    const len = strfi.substr(dotPos + 1).length;\n    const times = Math.pow(10, len);\n    let intNum = parseInt(Math.abs(floatNum) * times + 0.5, 10);\n    ret.times = times;\n    if (isNegative) {\n        intNum = -intNum;\n    }\n    ret.num = intNum;\n    return ret;\n}\n\nfunction operation(a, b, digits, op) {\n    const o1 = toInteger(a);\n    const o2 = toInteger(b);\n    const n1 = o1.num;\n    const n2 = o2.num;\n    const t1 = o1.times;\n    const t2 = o2.times;\n    const max = t1 > t2 ? t1 : t2;\n    let result = null;\n    switch (op) {\n        case 'add':\n            if (t1 === t2) { // \n                result = n1 + n2;\n            } else if (t1 > t2) { // o1   o2\n                result = n1 + n2 * (t1 / t2);\n            } else { // o1   o2\n                result = n1 * (t2 / t1) + n2;\n            }\n            return result / max;\n        case 'subtract':\n            if (t1 === t2) {\n                result = n1 - n2;\n            } else if (t1 > t2) {\n                result = n1 - n2 * (t1 / t2);\n            } else {\n                result = n1 * (t2 / t1) - n2;\n            }\n            return result / max;\n        case 'multiply':\n            result = (n1 * n2) / (t1 * t2);\n            return result;\n        case 'divide':\n            result = (n1 / n2) * (t2 / t1);\n            return result;\n    }\n}\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport {\n    formatm,\n    baseFormats,\n    formatNumberRender\n};\n","import Dropdown from './dropdown';\nimport {h} from './element';\nimport {baseFormats} from '../core/format';\nimport {cssPrefix} from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n    constructor() {\n        let nformats = baseFormats.slice(0);\n        nformats.splice(1, 0, {key: 'divider'});\n        nformats.splice(5, 0, {key: 'divider'});\n        nformats = nformats.map((it) => {\n            const item = h('div', `${cssPrefix}-item`);\n            if (it.key === 'divider') {\n                item.addClass('divider');\n            } else {\n                item.child(it.title())\n                    .on('click', () => {\n                        this.setTitle(it.title());\n                        this.change(it);\n                    });\n                if (it.label) item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        super('Normal', '220px', true, 'bottom-left', {type: false}, ...nformats );\n    }\n\n    setTitle(key) {\n        for (let i = 0; i < baseFormats.length; i += 1) {\n            if (baseFormats[i].key === key) {\n                this.title.html(baseFormats[i].title);\n            }\n        }\n        this.hide();\n    }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', {type: false}, ...nformulas );\n  }\n}\n","/* global describe, it */\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, colorPalette.el);\n    this.colorPalette = colorPalette;  // \n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left',  {type: false}, ...naligns );\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', {type: false}, ...lineTypeEls );\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  let item =  h('div', `${cssPrefix}-border-palette-cell`);\n  this.items.push(item);\n  return h('td', '').child(\n    item.child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    this.items = [];\n\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, borderPalette.el );\n    this.borderPalette = borderPalette;\n  }\n}\n","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\n\nexport default class HistoryBorder {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-history-border`);\n        this.history = h('div', `${cssPrefix}-history-content`).html('');\n        this.el.child( this.history);\n    }\n\n    setContent(items) {\n        items = items.slice(items.length - 100 < 0 ? 0 : items.length, items.length);\n        this.el.html('');\n        let els = [];\n        for(let i = items.length - 1; i >= 0; i--) {\n            let d = h('div', '');\n            let {action} = items[i];\n            d.html(action);\n            els.push(d);\n        }\n\n        console.log(this, this.el);\n        this.el.children(...els);\n    }\n}","import Dropdown from \"./dropdown\";\nimport Icon from \"./icon\";\nimport HistoryBorder from \"./history_border\";\n\nexport default class DropdownAction extends Dropdown {\n    constructor(iconName, change, arrowChange) {\n        const icon = new Icon(iconName)\n            .css('height', '18px');\n        const historyBorder = new HistoryBorder();\n        super(icon, 'auto', true, 'bottom-left', {type: true, change: change, arrowChange: arrowChange, historyBorder}, historyBorder.el);\n    }\n}","/* global window */\nimport {h} from './element';\nimport {bind} from './event';\nimport tooltip from './tooltip';\nimport DropdownFont from './dropdown_font';\nimport DropdownFontSize from './dropdown_fontsize';\nimport DropdownFormat from './dropdown_format';\nimport DropdownFormula from './dropdown_formula';\nimport DropdownColor from './dropdown_color';\nimport DropdownAlign from './dropdown_align';\nimport DropdownBorder from './dropdown_border';\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\nimport DropdownAction from \"./dropdown_action\";\n\nfunction buildIcon(name) {\n    return new Icon(name);\n}\n\nexport function buildButton(tooltipdata) {\n    return h('div', `${cssPrefix}-toolbar-btn`)\n        .on('mouseenter', (evt) => {\n            tooltip(tooltipdata, evt.target);\n        })\n        .attr('data-tooltip', tooltipdata);\n}\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nexport function buildButtonWithIcon(tooltipdata, iconName, change = () => {\n}) {\n    return buildButton(tooltipdata)\n        .child(buildIcon(iconName))\n        .on('click', () => change());\n}\n\nfunction bindDropdownChange() {\n    this.ddFormat.change = it => this.change('format', it.key);\n    this.ddFont.change = it => this.change('font-name', it.key);\n    this.ddFormula.change = it => this.change('formula', it.key);\n    this.ddFontSize.change = it => this.change('font-size', it.pt);\n    this.ddTextColor.change = it => this.change('color', it);\n    this.ddFillColor.change = it => this.change('bgcolor', it);\n    this.ddAlign.change = it => this.change('align', it);\n    this.ddVAlign.change = it => this.change('valign', it);\n    this.ddBorder.change = it => this.change('border', it);\n    this.undoEl.change = it => this.change('undo', it);\n}\n\n\nfunction toggleChange(type) {\n    let elName = type;\n    const types = type.split('-');\n    if (types.length > 1) {\n        types.forEach((it, i) => {\n            if (i === 0) elName = it;\n            else elName += it[0].toUpperCase() + it.substring(1);\n        });\n    }\n    const el = this[`${elName}El`];\n    el.toggle();\n    this.change(type, el.hasClass('active'));\n}\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', false,  moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nfunction initBtns2() {\n    this.btns2 = this.btnChildren.map((it) => {\n        const rect = it.box();\n        const {marginLeft, marginRight} = it.computedStyle();\n        return [it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)];\n    });\n}\n\nfunction moreResize(widthFn = this.widthFn) {\n    const {\n        el, btns, moreEl, ddMore, btns2,\n    } = this;\n    const {moreBtns, contentEl} = ddMore;\n    el.css('width', `${ widthFn() - 60}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        const style = data.defaultStyle();\n        this.ddFormat = new DropdownFormat();\n        this.ddFont = new DropdownFont();\n        this.ddFormula = new DropdownFormula();\n        this.ddFontSize = new DropdownFontSize();\n        this.ddTextColor = new DropdownColor('text-color', style.color);\n        this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\n        this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\n        this.ddVAlign = new DropdownAlign(['top', 'middle', 'bottom'], style.valign);\n        this.ddBorder = new DropdownBorder();\n        this.ddMore = new DropdownMore();\n        this.undoEl = new DropdownAction('undo',  () => this.change('undo'), (v) => this.change('undoList', v));\n        this.redoEl = new DropdownAction('redo',  () => this.change('redo'), (v) => this.change('redoList', v));\n        this.btnChildren = [\n            // this.undoEl = buildButtonWithIcon(`${t('toolbar.undo')} (Ctrl+Z)`, 'undo', () => this.change('undo')),\n\n            // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\n            buildButton(`${t('toolbar.undo')}`).child(this.undoEl.el),\n            buildButton(`${t('toolbar.redo')}`).child(this.redoEl.el),\n            this.paintformatEl = buildButtonWithIcon(`${t('toolbar.paintformat')}`, 'paintformat', () => toggleChange.call(this, 'paintformat')),\n            // this.clearformatEl = buildButtonWithIcon(`${t('toolbar.clearformat')}`, 'clearformat', () => this.change('clearformat')),\n            buildDivider(),\n            buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\n            buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\n            buildDivider(),\n            this.fontBoldEl = buildButtonWithIcon(`${t('toolbar.fontBold')} (Ctrl+B)`, 'bold', () => toggleChange.call(this, 'font-bold')),\n            this.fontItalicEl = buildButtonWithIcon(`${t('toolbar.fontItalic')} (Ctrl+I)`, 'italic', () => toggleChange.call(this, 'font-italic')),\n            this.underlineEl = buildButtonWithIcon(`${t('toolbar.underline')} (Ctrl+U)`, 'underline', () => toggleChange.call(this, 'underline')),\n            // this.flexibleEl = buildButtonWithIcon(`${t('toolbar.flexibleEl')} `, 'flexible', () => toggleChange.call(this, 'flexible')),\n            this.strikeEl = buildButtonWithIcon(`${t('toolbar.strike')}`, 'strike', () => toggleChange.call(this, 'strike')),\n            buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\n            buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\n            this.mergeEl = buildButtonWithIcon(`${t('toolbar.merge')}`, 'merge', () => toggleChange.call(this, 'merge')),\n            buildDivider(),\n            buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\n            buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\n            this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.call(this, 'textwrap')),\n            buildDivider(),\n            // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\n            // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\n            this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\n            this.addEl = buildButtonWithIcon(`${t('toolbar.add')}`, 'add', () => toggleChange.call(this, 'add')),\n            this.closeEl = buildButtonWithIcon(`${t('toolbar.calc')}`, 'close', () => toggleChange.call(this, 'close')),\n            this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleChange.call(this, 'autofilter')),\n            this.throwFormulaEl = buildButtonWithIcon(`${t('toolbar.throwFormula')}`, 'chevron-right', () => toggleChange.call(this, 'throwFormula')),\n            // buildButton(`${t('toolbar.date_formula')}`).child(this.ddFormula.el),\n            // buildDivider(),\n            this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),\n        ];\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(...this.btnChildren);\n        this.el.child(this.btns);\n        if (isHide) this.el.hide();\n        bindDropdownChange.call(this);\n        this.reset();\n        setTimeout(() => {\n            initBtns2.call(this);\n            moreResize.call(this);\n        }, 0);\n        bind(window, 'resize', () => {\n            moreResize.call(this, data.settings.view.width);\n        });\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.hasClass('active');\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        toggleChange.call(this, type);\n    }\n\n    reset() {\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        const cell = data.getSelectedCell();\n        this.undoEl.disabled(!data.canUndo());\n        this.redoEl.disabled(!data.canRedo());\n        this.mergeEl.active(data.canUnmerge())\n            .disabled(!data.selector.multiple());\n        this.autofilterEl.active(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font} = style;\n        this.ddFont.setTitle(font.name);\n        this.ddFontSize.setTitle(font.size);\n        this.fontBoldEl.active(font.bold);\n        this.fontItalicEl.active(font.italic);\n        this.underlineEl.active(style.underline);\n        // this.flexibleEl.active(style.flexible);\n        this.strikeEl.active(style.strike);\n        this.ddTextColor.setTitle(style.color);\n        this.ddFillColor.setTitle(style.bgcolor);\n        this.ddAlign.setTitle(style.align);\n        this.ddVAlign.setTitle(style.valign);\n        this.textwrapEl.active(style.textwrap);\n        this.addEl.active(data.equationIsActive());\n        this.closeEl.active(false);\n        this.throwFormulaEl.active(false);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.active(data.freezeIsActive());\n        if (cell) {\n            if (cell.format) {\n                this.ddFormat.setTitle(cell.format);\n            }\n        }\n    }\n}\n","/* global document */\nimport {h} from './element';\nimport {bind} from './event';\nimport {cssPrefix} from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n      if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n      this.open = false;\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n      this.open = true;\n      bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n      this.open = false;\n      document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import {Element} from './element';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nexport default class Button extends Element {\n    // type: primary\n    constructor(title, type = '') {\n        super('div', `${cssPrefix}-button ${type}`);\n        this.child(t(`button.${title}`));\n    }\n}\n","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  // showVf(it) {\n  //   const hint = it === 'date' ? '2018-11-12' : '10';\n  //   const { vf } = this;\n  //   vf.input.hint(hint);\n  //   vf.show();\n  // }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import {h} from './element';\nimport Button from './button';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nfunction buildMenu(clsName) {\n    return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n    return buildMenu('state').child(t(`sort.${it}`))\n        .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n    const {filterbEl, filterValues} = this;\n    filterbEl.html('');\n    const itemKeys = Object.keys(items);\n    itemKeys.forEach((it, index) => {\n        const cnt = items[it];\n        const active = filterValues.includes(it) ? 'checked' : '';\n        filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n            .on('click.stop', () => this.filterClick(index, it))\n            .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n    });\n}\n\nfunction resetFilterHeader() {\n    const {filterhEl, filterValues, values} = this;\n    filterhEl.html(`${filterValues.length} / ${values.length}`);\n    filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n    constructor() {\n        this.filterbEl = h('div', `${cssPrefix}-body`);\n        this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n        this.tindex = 1;\n        this.el = h('div', `${cssPrefix}-sort-filter`).children(\n            this.sortAscEl = buildSortItem.call(this, 'asc'),\n            this.sortDescEl = buildSortItem.call(this, 'desc'),\n            buildMenu('divider'),\n            h('div', `${cssPrefix}-filter`).children(\n                this.filterhEl,\n                this.filterbEl,\n            ),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', () => this.btnClick('cancel')),\n                new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n            ),\n        ).hide();\n        // this.setFilters(['test1', 'test2', 'text3']);\n        this.el.on('mousedown.stop', evt => {\n            this.tindex = 1;\n        });\n\n        this.ci = null;\n        this.sortDesc = null;\n        this.values = null;\n        this.filterValues = [];\n    }\n\n    btnClick(it) {\n        if (it === 'ok') {\n            const {ci, sort, filterValues} = this;\n            if (this.ok) {\n                this.ok(ci, sort, 'in', filterValues);\n            }\n        }\n        this.hide();\n    }\n\n    itemClick(it) {\n        // console.log('it:', it);\n        this.sort = it;\n        const {sortAscEl, sortDescEl} = this;\n        sortAscEl.checked(it === 'asc');\n        sortDescEl.checked(it === 'desc');\n    }\n\n    filterClick(index, it) {\n        const {filterbEl, filterValues, values} = this;\n        const children = filterbEl.children();\n        if (it === 'all') {\n            if (children.length === filterValues.length) {\n                this.filterValues = [];\n                children.forEach(i => h(i).checked(false));\n            } else {\n                this.filterValues = Array.from(values);\n                children.forEach(i => h(i).checked(true));\n            }\n        } else {\n            const checked = h(children[index]).toggle('checked');\n            // console.log(h(children[index]), \"92\")\n            if (checked) {\n                filterValues.push(it);\n            } else {\n                filterValues.splice(filterValues.findIndex(i => i === it), 1);\n            }\n        }\n\n        resetFilterHeader.call(this);\n    }\n\n    // v: autoFilter\n    // items: {value: cnt}\n    // sort { ci, order }\n    set(ci, items, filter, sort) {\n        this.ci = ci;\n        const {sortAscEl, sortDescEl} = this;\n        if (sort !== null) {\n            this.sort = sort.order;\n            sortAscEl.checked(sort.asc());\n            sortDescEl.checked(sort.desc());\n        } else {\n            this.sortDesc = null;\n            sortAscEl.checked(false);\n            sortDescEl.checked(false);\n        }\n        // this.setFilters(items, filter);\n        this.values = Object.keys(items);\n        this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n        buildFilterBody.call(this, items, filter);\n        resetFilterHeader.call(this);\n    }\n\n    setOffset(v) {\n        if(this.el.isShow()) {\n            this.hide();\n            return;\n        }\n\n        this.el.offset(v).show();\n        let tindex = 1;\n\n\n        console.log(this.el);\n        bindClickoutside(this.el, () => {\n\n            if (tindex === 0) {\n                this.hide();\n            }\n\n            tindex = 0;\n        });\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n        unbindClickoutside(this.el);\n    }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {sheetReset} from './sheet';\n\nexport default class Advice {\n    constructor(data, sheet) {\n        this.el = h('div', `${cssPrefix}-advice`)\n            .children(\n                this.save = h('div', `${cssPrefix}-advice-style`)\n                    .css('border-bottom', '1px solid'),\n                this.text = h('div', `${cssPrefix}-advice-style`),\n            )\n            .hide();\n        this.save.children(\n            this.saveCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html(''),\n        );\n        this.text.children(\n            this.textCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html(''),\n        );\n        this.data = data;\n        this.sheet = sheet;\n        this.left = 0;\n        this.top = 0;\n\n        this.save.on('mousedown.stop', () => {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n            this.sheet.setCellRange(this.reference, this.tableProxy, true);\n            sheetReset.call(this.sheet);\n        });\n\n        this.text.on('mousedown.stop', () => {\n            this.sheet.setCellRange(this.reference, this.tableProxy, false);\n            this.saveCheck.show('visibility', 'hidden');\n            this.textCheck.hide('visibility', 'initial');\n            sheetReset.call(this.sheet);\n        });\n    }\n\n    show(left, top, type = 1, reference, tableProxy ) {\n        this.el.css('left', `${left}px`);\n        this.el.css('top', `${top}px`);\n        if (type === 1) {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n        }\n        this.left = parseInt(left);\n        this.top = parseInt(top);\n        this.tableProxy = tableProxy;\n        this.reference = reference;\n        this.el.show();\n    }\n}\n","import {h} from \"../component/element\";\nimport {cutStr} from \"../core/operator\";\n\nfunction mountCopy(event) {\n    event.preventDefault();\n    let choose = getChooseImg.call(this);\n    if (choose) {\n        if (event.clipboardData) {\n            event.clipboardData.setData(\"text/html\", parseDom(choose.img2));\n            event.clipboardData.setData(\"text/plain\", \"\");\n        }\n        return;\n    }\n\n    let args = sheetCopy.call(this);\n    if (event.clipboardData) {\n        event.clipboardData.setData(\"text/html\", parseDom(args.html.el));\n        event.clipboardData.setData(\"text/plain\", args.plain);\n    }\n}\n\nfunction getChooseImg() {\n    let {pasteDirectionsArr} = this.data;\n\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true) {\n                this.container.css('pointer-events', 'auto');\n                return pasteDirectionsArr[i];\n            }\n        }\n    }\n    return null;\n}\n\nfunction sheetCopy() {\n    let args = {\n        plain: \"\",\n        html: h(\"table\", \"\"),\n    };\n\n    let {selector, rows, styles} = this.data;\n    let {sri, eri, sci, eci} = selector.range;\n    let tbody = h('tbody', '');\n    for (let i = sri; i <= eri; i += 1) {\n        let tr = h('tr', '');\n        for (let j = sci; j <= eci; j += 1) {\n            let td = h('td', '');\n            if (rows._[i] && rows._[i].cells && rows._[i].cells[j]) {\n                if (rows._[i].cells[j] && styles[rows._[i].cells[j].style]) {\n                    td.css('color', styles[rows._[i].cells[j].style].color);\n                    if (styles[rows._[i].cells[j].style]\n                        && styles[rows._[i].cells[j].style].font\n                        && styles[rows._[i].cells[j].style].font.bold) {\n                        let bold = styles[rows._[i].cells[j].style].font.bold ? '900' : '';\n                        td.css('font-weight', bold);\n                    }\n                    td.css('background', styles[rows._[i].cells[j].style].bgcolor);\n                }\n\n                if(!rows._[i].cells[j].text) {\n                    rows._[i].cells[j].text = \"\";\n                }\n                if(!rows._[i].cells[j].formulas) {\n                    rows._[i].cells[j].formulas = \"\";\n                }\n\n                let text = rows._[i].cells[j].formulas !== \"\" ? rows._[i].cells[j].formulas : rows._[i].cells[j].text;\n                if(rows._[i].cells[j].formulas && cutStr(rows._[i].cells[j].formulas, false, true).length > 0) {\n                    let hidden = h('reference', '');\n                    hidden.html(text);\n                    hidden.attr('ri', i);\n                    hidden.attr('ci', j);\n                    td.child(hidden.el);\n                } else\n                    td.html(text);\n                args.plain += text;\n                args.plain += \"\\t\";\n            } else {\n                args.plain += \"\\t\";\n            }\n            tr.child(td);\n        }\n\n        tbody.child(tr);\n        args.plain += \"\\n\";\n    }\n    args.html.child(tbody);\n\n    return args;\n}\n\nfunction parseDom(node) {\n    let tmpNode = document.createElement(\"div\");\n    tmpNode.appendChild(node.cloneNode(true));\n\n    return  tmpNode.innerHTML;\n}\n\nexport {\n    mountCopy,\n    getChooseImg,\n    sheetCopy\n}","import {h} from \"../component/element\";\nimport {cssPrefix, look} from \"../config\";\nimport CellRange from \"../core/cell_range\";\nimport {  isSpecialWebsite} from \"../core/special_formula_process\";\n\nexport default class Website {\n    constructor(data, editor) {\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n\n        this.tableEl = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n        this.editor = editor;\n        this.tableEl.attr('tabindex', 0);\n        this.tableEl.css('overflow-y', 'auto');\n        this.tableEl.css('max-height', '400px');\n        // bind(this.tableEl.el, 'paste', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'copy', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'keydown', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'keyup', evt => {\n        //     evt.stopPropagation();\n        // });\n        this.timer = null;\n        this.timer2 = null;\n    }\n\n    show(ri, ci) {\n        if(this.editor.isDisplay2()) {\n            this.el.hide();\n            this.tableEl.hide();\n\n            return;\n        }\n\n        let {data} = this;\n        let text = data.getCellTextOrDefault(ri, ci) + \"\";\n        clearTimeout(this.timer);\n        clearTimeout(this.timer2);\n\n        if (look.indexOf(text.split(\"!\")[0]) === 0) {\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 50;\n            let arr = JSON.parse(text.substring(text.indexOf(\"!\") + 1, text.length));\n\n            this.tableEl.css('left', `${left}px`);\n            this.tableEl.css('top', `${top}px`);\n            this.tableEl.css('user-select', 'text');\n\n            this.tableEl.html('');\n            let table = h('table', '');\n            table.css('border-spacing', '0px');\n            let tr = h('tr', '');\n            tr.children(\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html(''),\n                h('td', '').css('border', '1px solid black').html('')\n            );\n            table.children(\n                tr\n            );\n\n            for (let j = 0; j < arr.length; j++) {\n                let {number, name, city, area, value} = arr[j];\n                let tr = h('tr', '');\n                let td = h('td', '');\n                td.html(number);\n                td.css('border', '1px solid black');\n\n                let td2 = h('td', '');\n                td2.html(name);\n                td2.css('border', '1px solid black');\n\n                let td3 = h('td', '');\n                td3.html(city);\n                td3.css('border', '1px solid black');\n\n                let td4 = h('td', '');\n                td4.html(area);\n                td4.css('border', '1px solid black');\n\n                let td5 = h('td', '');\n                td5.html(value);\n                td5.css('border', '1px solid black');\n                tr.children(\n                    td,\n                    td2,\n                    td3,\n                    td4,\n                    td5\n                );\n                table.children(\n                    tr\n                );\n            }\n\n            this.tableEl.children(\n                table\n            );\n\n            this.timer = setTimeout(() => {\n                this.tableEl.show();\n                this.el.hide();\n            }, 150);\n        } else {\n            let args = isSpecialWebsite(text);\n            if(args.state) {\n                text = args.text;\n            }\n            text = text.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + text : text;\n            // console.log(regex.test(text))\n            if (text.substr(0, 7).toLowerCase() !== 'http://' &&\n                text.substr(0, 8).toLowerCase() !== 'https://') {\n                this.el.hide();\n                this.tableEl.hide();\n                return;\n            }\n\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 5;\n            this.el.html('');\n            this.el.css('color', 'blue');\n            this.el.children(\n                h('div', 'aaa').css(\"border-bottom\", \"1px solid blue\")\n                    .on('click', evt => {\n                        let iWidth = 650; //;\n                        let iHeight = 500; //;\n\n                        console.log(evt);\n                        let {screenX, screenY} = evt;\n                        window.open(text, \"\", `width=${iWidth},height=${iHeight},left=${screenX + rect.width},top=${screenY}`);\n                    })\n                    .html(text)\n            );\n            this.el.css('left', `${left}px`);\n            this.el.css('top', `${top}px`);\n\n            this.timer2 = setTimeout(() => {\n                this.el.show();\n                this.tableEl.hide();\n            }, 150);\n        }\n    }\n}","import {look} from \"../config\";\n\nlet v1 = \"HYPERLINK\";\n\n\nfunction isSpecialWebsite(text) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return {\n            \"state\": true,\n            \"text\": JSON.parse(text.split(\"!\")[1]).url,\n        };\n    }\n    return {\n        \"state\": false,\n        \"text\": \"\",\n    };\n}\n\nfunction indexOf(text, formula) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1 && formula.toUpperCase().indexOf(v1) === -1) {\n        return 2;\n    }\n    return 0;\n}\n\nfunction multipleCellsRender(cells, mc) {\n    let tailArr = [];\n    Object.keys(mc).forEach(i => {\n        cells[i] = mc[i];\n        tailArr.push(i);\n    });\n\n    return tailArr;\n}\n\nfunction specialWebsiteValue(text, formula) {\n    let index = indexOf(text, formula);\n\n    if (index === 2) {\n        let arr = text.split(\" \");\n        let s = \"\";\n        if (arr.length >= 1) {\n            text = arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                s += arr[i];\n            }\n        }\n        return {\n            \"state\": true,\n            \"type\": index,\n            \"text\": JSON.parse(text.split(\"!\")[1]).text + s,\n        };\n    }\n    return {\n        \"state\": false,\n        \"type\": index,\n        \"text\": \"\",\n    };\n}\n\nexport {\n    isSpecialWebsite,\n    specialWebsiteValue,\n    multipleCellsRender,\n}","import Modal from \"./modal\";\nimport {h} from \"./element\";\nimport Button from \"./button\";\nimport {t} from \"../locale/locale\";\nimport {cssPrefix} from \"../config\";\n\nexport default class ErrorPopUp extends Modal {\n    constructor() {\n        let tip = h('span', '').html(\"\");\n        super(t('contextmenu.errorPop'), [\n            h('div', `${cssPrefix}-form-fields`).children(\n                tip,\n            ),\n            h('div', `${cssPrefix}-form-fields`),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('ok', 'primary')\n                    .on('click', () => this.btnClick('ok')),\n            ),\n        ]);\n        this.tip = tip;\n    }\n\n    show(t) {\n        this.tip.html(t);\n        super.show();\n    }\n\n    btnClick(action) {\n        if (action === 'ok') {\n            this.hide();\n        }\n    }\n\n}","import {offsetTop} from \"../config\";\nimport {positionAngle} from \"../core/operator\";\n\nexport default class RectProxy {\n    constructor(rect) {\n        this.rect = rect;\n    }\n\n    isLocInside(x, y) {\n        let {rect} = this;\n\n        // if (x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height) {\n        //     return true;\n        // }\n        return x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height;\n    }\n\n    getUpDownLeftRight(ex, ey, clientX, clientY) {\n        let {rect} = this;\n\n        let pos = 0;\n        if (ex < rect.width + rect.left && ex > rect.left) {\n            if (ey > rect.top + rect.height + offsetTop) {\n                pos = 1;\n            } else if (ey - offsetTop < rect.top) {\n                pos = 4;\n            }\n\n        } else if (ey - ( rect.top - rect.height + offsetTop) > 0 && (rect.height + rect.top + offsetTop) > ey) {\n            if (ex > rect.width + rect.left) {\n                pos = 3;\n            } else if (ex < rect.left) {\n                pos = 2;\n            }\n        }\n\n        if (pos === 0) {\n            pos = positionAngle(clientX, ex, clientY, ey);\n        }\n        if (pos === 1 && ey < 0) {\n            pos = 4;\n        } else if (document.body.clientHeight < ey && pos === 4) {\n            pos = 1;\n        }\n        if (pos === 3 && ex < 0) {\n            pos = 2;\n        } else if (document.body.clientWidth < ex && pos === 2) {\n            pos = 3;\n        }\n\n        return pos;\n    }\n}","export default class Timer {\n    constructor() {\n        this.timer = [];\n    }\n\n    push(t) {\n        this.timer.push(t);\n    }\n\n    clear() {\n        for(let i = 0; i < this.timer.length; i++) {\n            let t = this.timer[i];\n            clearTimeout(t);\n            clearInterval(t);\n        }\n    }\n}","/* global window */\nimport {h} from './element';\nimport {bind, bindTouch, mouseMoveUp, remove} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix, offsetLeft, offsetTop} from '../config';\nimport {formulas} from '../core/formula';\nimport {getFontSizePxByPt} from \"../core/font\";\n// import {baseFormats, multiply} from \"../core/format\";\nimport Advice from \"../component/advice\";\nimport {clearSelectors, editingSelectors, lockCells, makeSelector} from \"../component/formula_editor\";\nimport {deleteImg, hideDirectionArr, mountPaste} from \"../event/paste\";\nimport {getChooseImg, mountCopy} from \"../event/copy\";\nimport Website from \"../component/website\";\nimport {cutStr, cuttingByPos, deepCopy} from \"../core/operator\";\nimport {moveCell} from \"../event/move\";\nimport CellRange from \"../core/cell_range\";\nimport {isHave, isOusideViewRange} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\nimport ErrorPopUp from \"./error_pop_up\";\nimport RectProxy from \"../core/rect_proxy\";\nimport {testValid} from \"../utils/test\";\nimport Timer from \"../model/Timer\";\nimport PreAction from \"../model/pre_action\";\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top * 1) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    // console.log(multiple, ', ri:', ri, ', ci:', ci);\n    const {\n        table, selector, toolbar,\n    } = this;\n\n    if (multiple) {\n        selector.setEnd(ri, ci, moving, true);\n    } else {\n        selector.set(ri, ci, indexesUpdated);\n    }\n\n    toolbar.reset();\n\n    // add\n    clearTimeout(this.render_timer);\n\n    this.render_timer = setTimeout(() => {\n        table.render();\n    }, 100);\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data, editor\n    } = this;\n    const {rows, cols} = data;\n    if (editor.isCors) {\n        selector.indexes = [editor.ri, editor.ci];\n    }\n    let [ri, ci] = selector.indexes;\n    const { eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n\n\n    // console.log(\"92\", ri, ci, editor.ri, editor.ci)\n    // if((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n    //     return;\n    // }\n\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        // if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selector.selectCell.setData(ri, ci);\n    selector.selectCell.resetSelectOffset();\n    selectorSet.call(this, multiple, ri, ci);\n    // editor.clear();\n\n    editorSetOffset.call(this);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    if (evt.buttons !== 0) return;\n    if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n    const {offsetX, offsetY} = evt;\n\n    const {\n        rowResizer, colResizer, tableEl, data, website\n    } = this;\n    const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n\n    // moveCell.call(this);\n\n    // url \n    website.show(cRect.ri, cRect.ci);\n    const {rows, cols} = data;\n    if (offsetX > cols.indexWidth && offsetY > rows.height) {\n        rowResizer.hide();\n        colResizer.hide();\n        return;\n    }\n    const tRect = tableEl.box();\n    if (cRect.ri >= 0 && cRect.ci === -1) {\n        cRect.width = cols.indexWidth;\n        rowResizer.show(cRect, {\n            width: tRect.width,\n        });\n    } else {\n        rowResizer.hide();\n    }\n    if (cRect.ri === -1 && cRect.ci >= 0) {\n        cRect.height = rows.height;\n        colResizer.show(cRect, {\n            height: tRect.height,\n        });\n    } else {\n        colResizer.hide();\n    }\n}\n\nfunction overlayerMousescroll(evt) {\n    const {verticalScrollbar, data} = this;\n    const {autoLoad} = data.settings;\n    const {top} = verticalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n    let delta = evt.deltaY;\n    const {rows} = data;\n    if (evt.detail) delta = evt.detail * 40;\n    if (delta > 0 && autoLoad === true) {\n        // up\n        const ri = data.scroll.ri + 1;\n        if (ri < rows.len) {\n            verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n        }\n    } else if (autoLoad === true) {\n        // down\n        const ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    }\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('direction:', direction, ', distance:', distance, left);\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    verticalScrollbar.set(height, data.rows.totalHeight());\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset() {\n    // debugger\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    renderAutoAdapt.call(this);\n    autoRowResizer.call(this);\n\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    selector.selectCell.toolbarChangeSelectorCell();\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy() {\n    const {data, selector} = this;\n    data.copy();\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    data.cut();\n    selector.showClipboard();\n}\n\n// const a = () => {\n// }\n\nfunction paste(what, cb = (p) => {\n    if (p) {\n        clearClipboard.call(this);\n        sheetReset.call(this);\n    }\n}) {\n    const {data} = this;\n    let p = data.paste(what, msg => xtoast('Tip', msg));\n    cb(p);\n\n    return p;\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar, data} = this;\n    if (toolbar.paintformatActive()) {\n        // paste.call(this, 'format');\n        data.paintFormatChange((ri, ci) => {\n            selectorSet.call(this, true, ri, ci, true, true);\n        });\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n        toolbar.reset();\n    }\n}\n\nfunction getPoint(obj) { //\n    let t = obj.offsetTop; //\n    let l = obj.offsetLeft; //\n    //\n    while (obj = obj.offsetParent) {// obj = obj.offsetParent;while (obj != undefined)\n        t += obj.offsetTop; //\n        l += obj.offsetLeft; //\n    }\n\n    return {\n        t: t,\n        l: l\n    }\n}\n\nfunction dropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, pos = 0, offset, horizontalScrollbar, cols) {\n    this.selector.setBoxinner(\"none\");\n    this.container.css('pointer-events', 'none');\n    let dstRect = data.getCellRectByXYWithNotTotalResult(e.layerX || e.clientX, e.layerY || e.clientY);\n    let {ri, ci} = dstRect;\n\n    if (isAutofillEl) {\n        let {rpos, ey, ex,} = dropGetPos.call(this, data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos);\n\n        let orien = selector.showAutofill(ri, ci, rpos);\n        if (isOusideViewRange(this.data.settings.view.height(), this.data.settings.view.width(), ey, ex, orien)) {\n            // if (Math.round(Math.random()) === 1) {\n            continueMove.call(this, orien, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n            // }\n        }\n\n    } else if (e.buttons === 1 && !e.shiftKey) {\n        ri = ri <= 0 ? 0 : ri;\n        ci = ci <= 0 ? 0 : ci;\n        let cell = data.viewRange();\n        let pos = cell.getMovePos(ri, ci);\n\n        selectorBeyondMove.call(this, pos, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n\n        console.log(\"ri: \", ri, \"ci: \", ci);\n        selectorSet.call(this, true, ri, ci, true, true);\n    }\n}\n\n\nfunction dropGetPos(data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos) {\n    let rect = data.getRect(selector.range);\n    let rectProxy = new RectProxy(rect);\n    let clientX = rect.width + rect.left;\n    let clientY = rect.height + rect.top + offsetTop;\n    let ex = e.clientX - offset.l - offsetLeft;\n    let ey = e.clientY;\n\n    if (rectProxy.isLocInside(ex, ey)) {\n        pos = -1;\n        selector.arange = null;\n    } else {\n        pos = rectProxy.getUpDownLeftRight(ex, ey, clientX, clientY)\n    }\n\n    return {\n        rpos: pos,\n        ex,\n        ey\n    };\n}\n\nfunction selectorBeyondMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    if (orien === 2) {   //\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 6) {    // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 3) {        //\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 5) {    // \n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 1) { // \n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 7) {         // \n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 8) {     // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 4) {       // \n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    }\n}\n\nfunction scrollTo(orien, verticalScrollbar, horizontalScrollbar, rows, data, cols) {\n    if (Math.round(Math.random()) !== 1) {\n        return;\n    }\n    // 1  2  3 4 \n    let ri = 0, ci = 0;\n    if (orien === 1) {\n        const {top} = verticalScrollbar.scroll();  // toolbar\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 2) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n\n        verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n    } else if (orien === 4) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 3) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\nfunction continueMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    let ri = 0, ci = 0;\n    if (orien === 44) {\n        const {top} = verticalScrollbar.scroll();  // toolbar\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 22) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    } else if (orien === 33 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 11 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data,  sortFilter, editor, advice\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    editor.setRiCi(ri, ci);\n\n    // sort or filter\n    const {autoFilter} = data;\n\n    // trait add\n    hideDirectionArr.call(this);\n    advice.el.hide();\n\n    if (autoFilter.includes2(ri, ci)) {\n        autoFilter.getSet(data.exceptRowSet, ri);\n    }\n\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n\n        // let {pageX, pageY} = evt;\n        let {verticalScrollbar, horizontalScrollbar} = this;\n        const {rows, cols} = data;\n        // const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri + 1;\n        // let ttop = top + rows.getHeight(ri) - 1;\n\n        let point = getPoint(this.el.el);\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            console.log(\"dropdown\");\n            clearStopTimer.call(this);\n\n            continueDropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols);\n\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols);\n        }, () => {\n            clearStopTimer.call(this);\n\n            if (isAutofillEl) {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    testValid.call(this);\n                    autofillNext.call(this);\n                }\n            }\n            this.selector.setBoxinner(\"auto\");\n\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n            this.container.css('pointer-events', 'auto');\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction continueDropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols) {\n    let stopTimer = setTimeout(() => {\n        let stopTimer2 = setInterval(() => {\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols,);\n        }, 50);\n        this.stopTimer2.push(stopTimer2);\n    }, 200);\n\n    this.stopTimer.push(stopTimer);\n}\n\nfunction clearStopTimer() {\n    this.stopTimer.clear();\n    this.stopTimer2.clear();\n}\n\nfunction autofillNext() {\n    const {\n        data, table, editor\n    } = this;\n    editor.display = true;\n    let enter = false;\n    // this.selector.arange.each((ri, ci) => {\n    //     // let cell = data.rows.getCell(ri, ci);\n    //     // if (cell && cell.formulas) {\n    //     //     let enter2 = this.editorProxy.change(ri, ci, cell.formulas, data.rows, data, true);\n    //     //     if (enter2 === true) {\n    //     //         enter = true;\n    //     //     }\n    //     // }\n    // });\n    if (enter) {\n        data.change(data.getData());\n    }\n    this.selector.arange = null;\n    loadFormula.call(this);\n    table.render();\n}\n\nfunction loadFormula(load = false) {\n    // this.table.proxy.diff = 305;\n    // this.table.proxy.oldData = \"\";\n    // sheetReset.call(this);\n    // clearTimeout(this.formulaTime);\n    // let {data, table} = this;\n    // this.formulaTime = setTimeout(() => {\n    //     let {date_formula} = data.settings;\n    //     if (date_formula && typeof date_formula.wland == \"function\") {\n    //         date_formula.wland(date_formula, data, table, load);\n    //     }\n    // }, 1500);\n}\n\nfunction firstRowToWidth(width) {\n    let cRect = {ri: -1, ci: 0, left: 60, top: 0, width: 100};\n    colResizerFinished.call(this, cRect, width);\n}\n\nfunction adviceSetOffset() {\n    const {data} = this;\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n\n    this.advice.el.el.style['top'] = `${top}px`;\n    this.advice.el.el.style['left'] = `${ left}px`;\n}\n\nfunction pictureSetOffset() {\n    const {data} = this;\n    let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n\n    this.data.pasteDirectionsArr.forEach(i => {\n        const sOffset = data.getMoveRect(i.range);\n\n        i.img.el.style['top'] = `${sOffset.top + pictureOffsetTop + i.number * 15 + i.offsetTop }px`;\n        i.img.el.style['left'] = `${sOffset.left + pictureOffsetLeft + i.number * 15 + i.offsetLeft}px`;\n    });\n}\n\n\nfunction editorSetOffset(show = true, cri = -1, cci = -1) {\n    const {\n        selector, data, editor\n    } = this;\n    let [ri, ci] = selector.indexes;\n    ri = cri === -1 ? ri : cri;\n    ci = cci === -1 ? ci : cci;\n\n    const sOffset = data.getMoveRect(new CellRange(ri, ci, selector.range.eri, selector.range.eci));\n    const tOffset = this.getTableOffset();\n\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n\n    editor.setOffset(sOffset, sPosition, show);\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction selectorsSetOffset() {\n    for (let i = 0; i < this.selectors.length; i++) {\n        let selector = this.selectors[i];\n        selector.selector.resetSelectorBRLAreaOffset(new CellRange(selector.ri, selector.ci, selector.ri, selector.ci));\n    }\n}\n\nfunction hasEditor(showEditor = true) {\n    // let {selector} = this;\n    if (showEditor === true) {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selectorMoveEl.el,\n                this.selector.el,\n            );\n    } else {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                // this.editor.el,\n                // this.selector.el,\n                this.selectorMoveEl.el\n            );\n    }\n}\n\nfunction editorSet() {\n    const {editor, data, selector} = this;\n    editorSetOffset.call(this);\n    editor.setCellEnd(data.getSelectedCell());\n    // editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), type);\n    if (this.data.settings.showEditor) {\n        selector.el.hide();\n    }\n    clearClipboard.call(this);\n\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrolly(distance, () => {\n        editor.display = false;\n        selector.resetBRLAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrollx(distance, () => {\n        editor.display = false;\n        selector.resetBRTAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction renderAutoAdapt() {\n    let {data, table} = this;\n    const viewRange = data.viewRange2();\n    let {autoAdapt} = data.settings.style;\n    let {ignoreRi} = data.settings;\n    let viewWidth = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            let txt = table.getCellTextContent(ri, ci);\n            const dbox = table.getDrawBox(ri, ci);\n\n            if (txt !== undefined) {\n                const style = table.getCellTextStyle(ri, ci);\n                const font = Object.assign({}, style.font);\n                font.size = getFontSizePxByPt(font.size);\n                // width\n                let txtWidth = null;\n                if (style.format !== undefined) {\n                    // txtWidth = table.draw.selfAdaptionTxtWidth(formatm[style.format].render(txt), font, dbox);\n\n                } else {\n                    txtWidth = table.draw.selfAdaptionTxtWidth(txt, font, dbox);\n                }\n                if ((table.autoAdaptList[ci] === undefined || table.autoAdaptList[ci] < txtWidth) && ri > ignoreRi - 1) {\n                    table.autoAdaptList[ci] = txtWidth;\n                }\n            }\n        });\n        if (table.autoAdaptList.length < 0) {\n            return;\n        }\n        let {ignore} = data.settings;\n        for (let i = 0; i < table.autoAdaptList.length; i++) {\n            let _ignore = false;\n            for (let j = 0; j < ignore.length; j++) {\n                if (i === ignore[j]) _ignore = true;\n            }\n            if (_ignore === false) {\n                if (table.autoAdaptList[i] === undefined) {\n                    viewWidth += 50;\n                    data.cols.setWidth(i, 50);\n                } else {\n                    if (table.autoAdaptList[i] < 30) {\n                        table.autoAdaptList[i] = 30;\n                    }\n                    data.cols.setWidth(i, table.autoAdaptList[i]);\n                }\n            }\n            viewWidth += table.autoAdaptList[i];\n\n        }\n        if (viewWidth > 0)\n            data.settings.cellWidth = () => viewWidth;\n    }\n}\n\nfunction autoRowResizer() {\n    let {data, table} = this;\n    let viewRange = data.viewRange2();\n    let record_rc = 0, max = 0;\n    let r_h = data.settings.row.height;\n    let {autoAdapt} = data.settings.style;\n    let viewHeight = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            const txt = table.getCellTextContent(record_rc, ci);\n            const style = table.getCellTextStyle(ri, ci);\n            const font = Object.assign({}, style.font);\n            font.size = getFontSizePxByPt(font.size);\n            const dbox = table.getDrawBox(record_rc, ci);\n            // 1. \n            // 2.   max\n            if (record_rc !== ri && txt !== undefined) {\n                let record_h = data.rows.getHeight(record_rc);\n                if (r_h * max !== record_h) {\n                    let c_h = font.size * max + dbox.padding * 2 + 2 * max;\n                    // console.log(\"451\", view.height(r_h * max));\n                    data.rows.setHeight(record_rc, c_h);\n                    viewHeight += c_h;\n                } else {\n                    viewHeight += record_h;\n                }\n                max = 0;\n            } else if (txt !== undefined && record_rc === ri) {\n                if (txt !== undefined) {\n                    const n = table.draw.selfAdaptionHeight(dbox, txt, font);\n                    if (n > max || max === 0) {\n                        max = n;\n                    }\n                }\n            }\n            record_rc = ri;\n        });\n        let record_h = data.rows.getHeight(record_rc);\n        const style = table.getCellTextStyle(record_h, 0);\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        const dbox = table.getDrawBox(record_rc, 0);\n        if (r_h * max !== record_h && viewHeight > 0) {\n            let c_h = font.size * max + dbox.padding * 2;\n            viewHeight += c_h;\n            data.rows.setHeight(record_rc, c_h);\n        } else if (viewHeight > 0) {\n            viewHeight += record_h;\n        }\n    }\n    console.log(503, viewHeight);\n    if (viewHeight > 0)\n        data.settings.view.height = () => viewHeight + 40;\n}\n\nfunction clickSelectorChangeRiCi(evt) {\n    const overlayer = evt.target.className === `${cssPrefix}-overlayer`;\n    if (!overlayer) {\n        return;\n    }\n\n    let {selector, data} = this;\n\n    const {offsetX, offsetY} = evt;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n\n    selector.selectCell.setData(cellRect.ri, cellRect.ci);\n    selector.selectCell.resetSelectOffset();\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setRowHeight(ri, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setColWidth(ci, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    // console.log('data:', data);\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction errorPop(enter, msg) {\n    const {errorPopUp} = this;\n\n    if (enter && !errorPopUp.open) {\n        errorPopUp.show(msg);\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else if (errorPopUp.open) {\n        errorPopUp.hide();\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    }\n    return {\n        \"state\": false,\n        \"msg\": msg\n    };\n}\n\nexport function selectorCellText(ri, ci, {text, style}, state) {\n    const {data, editor,} = this;\n    let args = data.selectorCellText(ri, ci, text + \"\", state);\n    if (args.state) {\n        args = errorPop.call(this, true, args.msg);\n        if (args.state) {\n            return true;\n        }\n    }\n\n    data.setCellText(ri, ci, {text, style});\n    editor.setRiCi(-1, -1);\n\n    return false;\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table, editor} = this;\n    // const [ri, ci] = selector.indexes;\n    let {ri, ci} = data.selector;\n    if ((editor.ri !== ri && editor.ri !== -1) || (editor.ci !== ci && editor.ci !== -1)) {\n        return;\n    }\n\n    data.setSelectedCellText(text, state);\n    if (state === 'finished') table.render();\n}\n\nfunction throwFormula() {\n    const {data} = this;\n    data.throwFormula();\n    // sheetReset.call(this);\n}\n\nexport function insertDeleteRowColumn(type) {\n    const {data} = this;\n    if (type === 'insert-row') {\n        data.insert('row');\n    } else if (type === 'delete-row') {\n        data.delete('row');\n    } else if (type === 'insert-column') {\n        data.insert('column');\n    } else if (type === 'delete-column') {\n        data.delete('column');\n    } else if (type === 'delete-cell') {\n        data.deleteCell();\n    } else if (type === 'delete-cell-format') {\n        data.deleteCell('format');\n    } else if (type === 'delete-cell-text') {\n        data.deleteCell('text');\n    }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'undoList') {\n        value.setContent(data.historyList(1));\n    } else if (type === 'redoList') {\n        value.setContent(data.historyList(2));\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        // print\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'throwFormula') {\n        throwFormula.call(this);\n    } else if (type === 'close') {\n        let {mri, mci} = data.getMax();\n\n        data.changeDataForCalc = new PreAction({\n            type: 999,\n            action: \"\", ri: -1, ci: -1, oldCell: {}, newCell: data.rows.eachRange(new CellRange(0, 0, mri, mci))\n        }, this.data);\n        sheetReset.call(this);\n        // loadFormula.call(this, true);\n    } else if (type === 'freeze') {\n        let {showFreeze} = data.settings;\n        if (value && showFreeze === true) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else if (type === 'add') {\n        data.showEquation = !data.showEquation;\n        sheetReset.call(this, true);\n    } else {\n        //format percent 473\n        data.setSelectedCellAttr(type, value);\n        if (type === 'border') {\n            borderResSet.call(this, 'none');\n        }\n        if (type === 'formula') {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction borderResSet(value = \"1px solid rgb(75, 137, 255\") {\n    this.selector.br.border(value);\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction afterSelector(editor) {\n    if (editor.getLock() || editor.state === 2) {\n        let {ri, ci} = editor;\n        let inputText = editor.editorText.getText();\n        let {selector} = this;\n        selector.indexes = [ri, ci];\n        return selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n    }\n    return false;\n}\n\nfunction pasteEvent(evt) {\n    clearClipboard.call(this);\n    mountPaste.call(this, evt, () => {\n        sheetReset.call(this);\n        let {data} = this;\n        data.change(data.getData());\n    });\n}\n\nfunction sheetInitEvents() {\n    const {\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n         contextMenu,\n        data,\n        toolbar,\n        modalValidation,\n        sortFilter,\n    } = this;\n\n    // pasteOverlay.on('mousedown', evt => {\n    //   console.log(\"669\");\n    //   pasteOverlay.hide();\n    // });\n\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            // renderAutoAdapt.call(this);\n            // autoRowResizer.call(this);\n            // the left mouse button: mousedown  mouseup  click\n            // the right mouse button: mousedown  contenxtmenu  mouseup\n            if (evt.buttons === 2) {\n                if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                    evt.stopPropagation();\n                } else {\n                    contextMenu.hide();\n                    overlayerMousedown.call(this, evt);\n                    setTimeout(() => {\n                        contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                        evt.stopPropagation();\n                    }, 100);\n                }\n                clickSelectorChangeRiCi.call(this, evt);\n            } else if (evt.detail === 2) {\n                clearTimeout(this.render_timer);\n                editor.setMouseDownIndex([]);\n\n                if (editor.getLock()) {\n                    return;\n                }\n                editorSet.call(this);\n            } else {\n                if (editor.getLock() || editor.isCors) {\n                    let _selector = null;\n                    let change = 0;\n                    mouseMoveUp(window, (e) => {\n                        this.container.css('pointer-events', 'none');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"none\");\n                        }\n\n                        let enter = true;\n                        let {merges} = data;\n                        // let {inputText} = editor;\n                        let inputText = editor.editorText.getText();\n                        let it = inputText;\n\n                        Object.keys(merges._).forEach(i => {\n                            let m = merges._[i];\n                            const cut = cutStr(it, true);\n                            for (let i = 0; i < cut.length; i++) {\n                                if (cut[i].indexOf(\":\") !== -1) {\n                                    let a1 = cut[i].split(\":\")[0];\n                                    let a2 = cut[i].split(\":\")[1];\n                                    let e1 = expr2xy(a1);\n                                    let e2 = expr2xy(a2);\n\n                                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                                        enter = false;\n                                    }\n                                }\n                            }\n                        });\n\n                        if (enter) {\n                            if (e.buttons === 1 && !e.shiftKey) {\n                                let {ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY);\n                                if (_selector && _selector.selector) {\n                                    _selector = makeSelector.call(this, ri, ci, this.selectors, true, _selector.selector, true);\n                                    lockCells.call(this, evt, _selector);\n                                    this.mergeSelector = true;\n                                } else {\n                                    let {pos} = editor;\n                                    let inputText = editor.editorText.getText();\n                                    for (let i = 0; i < this.selectors.length; i++) {\n                                        let selector = this.selectors[i];\n                                        let {erpx} = selector;\n\n                                        if (erpx === cuttingByPos(inputText, pos)) {\n                                            _selector = selector;\n                                            change = 1;\n                                            _selector.selector.set(ri, ci, true);\n                                            break;\n                                        }\n                                    }\n\n                                    _selector = _selector ? _selector : makeSelector.call(this, ri, ci, this.selectors, true, null, false);\n                                }\n                            }\n                        }\n                    }, () => {\n                        this.container.css('pointer-events', 'auto');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"auto\");\n                        }\n\n                        if (this.mergeSelector === false) {\n                            if (_selector && !change) {\n                                this.selectors.push(_selector);\n                            }\n                            lockCells.call(this, evt, _selector);\n                        } else if (_selector && !change && _selector.selector) {\n                            this.selectors.push(_selector);\n                        }\n                        if (_selector) {\n                            for (let i = 0; i < this.selectors.length; i++) {\n                                let selector = this.selectors[i];\n\n                                if (selector.className === _selector.className) {\n                                    selector.erpx = _selector.erpx;\n                                    break;\n                                }\n                            }\n                        }\n                        _selector = null;\n                        change = 0;\n                        this.mergeSelector = false;\n                    });\n                }\n\n                console.time(\"dbclick time1\");\n\n                if (!editor.getLock() && !editor.isCors) {\n                    console.time(\"dbclick time2\");\n\n                    let {ri, ci} = editor;\n                    let inputText = editor.editorText.getText();\n                    if (ri !== -1 && ci !== -1 && inputText[0] === \"=\") {\n                        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n\n                        if (error) {\n                            return;\n                        }\n                    }\n                    console.timeEnd(\"dbclick time2\");\n\n                    let state = editor.clear();\n\n                    if (state) {\n\n                        // let cell = data.rows.getCell(ri, ci);\n                        // if (cell && cell.formulas) {\n                        //     this.editorProxy.change(ri, ci, cell.formulas, data.rows, data);\n                        // }\n                        loadFormula.call(this);\n\n                    }\n\n\n                    this.selector.longTimeBefore();\n                    overlayerMousedown.call(this, evt);\n                    clickSelectorChangeRiCi.call(this, evt);\n                    borderResSet.call(this);\n                    clearSelectors.call(this);\n                    editorSetOffset.call(this);\n                }\n                testValid.call(this);\n                console.timeEnd(\"dbclick time1\");\n\n            }\n        }).on('mousewheel.stop', (evt) => {\n        overlayerMousescroll.call(this, evt);\n    });\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        }\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        if (state === 'finish') { //  \n            data.editorChangeToHistory(editor.editorText.getOldCell(), editor.editorText.getRICI(), 1);\n            editor.editorText.setOldCell({}, {ri: -1, ci: -1});\n            return;\n        }\n\n        //  esc\n        if (itext === \"@~esc\") {\n            let {text, formulas} = editor.editorText.getOldCell();\n            editor.editorText.setOldCell({\n                text: '',\n                formulas: '',\n            });\n            let {ri, ci} = editor;\n            data.setSelectedCell(text, 'input', formulas, ri, ci);\n            editor.setText(\"\");\n            clearSelectors.call(this);\n            editor.clear(true);\n            // editor.setRiCi(-1, -1);\n            return;\n        }\n\n        if (state === \"format\") {\n            data.setSelectedCellAttr(state, \"rmb\");\n            // return;\n        }\n        // let {selector} = this;\n        // selector.el.hide();\n        //this.selectors\n        let {lock} = editor;\n        editor.setMouseDownIndex(data.rows, []);\n        editingSelectors.call(this, itext);\n\n        if (lock && itext !== '=') {\n            return;\n        }\n\n        // if (this.selectors.length > 0) {\n        //     return;\n        // }\n\n        if (state === \"format\") {\n            return;\n        }\n\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            data.addValidation(...args);\n        } else {\n            data.removeValidation();\n        }\n    };\n    // contextmenu\n    contextMenu.itemClick = (type) => {\n        // console.log('type:', type);\n        if (type === 'validation') {\n            modalValidation.setValue(data.getSelectedValidation());\n        } else if (type === 'copy') {\n            copy.call(this);\n        } else if (type === 'cut') {\n            cut.call(this);\n        } else if (type === 'paste') {\n            // paste.call(this, 'all');\n            // process.call(this, document.execCommand(\"sheetCopy\"));\n            // createEvent(1, false, \"paste\");\n            // console.log(  document.execCommand(\"paste\"));\n        } else if (type === 'paste-value') {\n            paste.call(this, 'text');\n        } else if (type === 'paste-format') {\n            paste.call(this, 'format');\n        } else {\n            insertDeleteRowColumn.call(this, type);\n        }\n    };\n\n\n    // let windows = this.el.el;\n    bind(window, 'resize', () => {\n        this.reload();\n    });\n\n    bind(window, 'click', (evt) => {\n        overlayerEl.contains(evt.target);\n        // this.focusing = overlayerEl.contains(evt.target);\n    });\n\n    bind(window, 'copy', (evt) => {\n        mountCopy.call(this, evt);\n        // data.history.add(data.getData());\n    });\n\n    bind(window, 'cut', (evt) => {\n        console.log(\"cut\", evt);\n        cut.call(this);\n        mountCopy.call(this, evt);\n        let {data} = this;\n        data.history.add(data.getData());\n    });\n\n    bind(window, 'paste', (evt) => {\n        pasteEvent.call(this, evt);\n    });\n\n    // for selector\n    bind(window, 'keydown', evt => {\n        // if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key, ctrlKey, shiftKey,   metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (getChooseImg.call(this)) {\n            console.log(keyCode);\n            switch (keyCode) {\n                case 8:         // delete\n                    data.history.addPic(data.getData().pictures, \"add\");\n                    deleteImg.call(this);\n                    break;\n                // case 90:         // delete\n                //     data.history.addPic(data.getData().pictures, \"add\");\n                //     deleteImg.call(this);\n                //     break;\n            }\n\n            if (ctrlKey || metaKey) {\n                if (90 === keyCode) {\n                    this.undo();\n                    evt.preventDefault();\n                }\n            }\n        } else if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            // let what = 'all';\n            // if (shiftKey) what = 'text';\n            // if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    //   \n                    if (getChooseImg.call(this))\n                        return;\n                    copy.call(this);\n                    // table.render();\n                    // sheetReset.call(this);\n                    evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // paste.call(this, what, () => {\n                    //     console.log(\"837\")\n                    // });\n                    break;\n                case 37:\n                    // ctrl + left\n\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('font-bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('font-italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error = afterSelector.call(this, editor);\n                    if (error) {\n                        return;\n                    }\n\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    // \n                    clearSelectors.call(this);\n                    break;\n                case 13: // enter\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error2 = afterSelector.call(this, editor);\n                    if (error2) {\n                        return;\n                    }\n                    editor.clear();\n                    renderAutoAdapt.call(this);\n                    autoRowResizer.call(this);\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    loadFormula.call(this);\n\n                    evt.preventDefault();\n                    editorSetOffset.call(this, true);\n                    // \n                    clearSelectors.call(this);\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    // evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                // dataSetCellText.call(this, evt.key, 'input');\n                // editorSet.call(this);\n                // editor.inputEventHandler();\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    });\n}\n\nexport {\n    sheetReset,\n    selectorSet,\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        const {view, showToolbar, showContextmenu, showEditor, rowWidth} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n\n        targetEl.children(this.toolbar.el, this.el);\n        this.pictureOffsetLeft = 10;\n        this.pictureOffsetTop = 10;\n\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n            data.cols.width,\n            data,\n            this,\n        );\n        this.stopTimer = new Timer();\n        this.stopTimer2 = new Timer();\n        this.website = new Website(data, this.editor);\n\n        // data validation\n        this.modalValidation = new ModalValidation();\n        this.errorPopUp = new ErrorPopUp();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);\n        // selector\n        this.selector = new Selector(data, this, true);\n        this.selectorMoveEl = new Selector(data, this, false);\n        // this.editorProxy = new EditorProxy();\n\n        this.advice = new Advice(data, this);\n        // this.pasteDirectionsArr = [];\n        // this.pasteOverlay = h('div', `${cssPrefix}-paste-overlay-container`).hide();\n\n        this.overlayerCEl = hasEditor.call(this, showEditor);\n        this.selectors = [];\n        this.container = h('div', '');\n        this.selectorsEl = h('div', `selector_clear`).attr(\"id\", \"selector_clear\");\n\n        //  overlayerCEl   overlayerEl \n        this.overlayerCEl.children(this.selectorsEl, this.container);\n\n        this.mergeSelector = false;\n\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        this.direction = false;   // \n\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.rowResizer.el,\n            this.overlayerEl.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.errorPopUp.el,\n            this.sortFilter.el,\n            this.advice.el,\n            this.website.el,\n            this.website.tableEl,\n            // this.pasteOverlay.el,\n        );\n\n        // table\n        this.table = new Table(this.tableEl.el, data, this.editor);\n        sheetInitEvents.call(this);\n        sheetReset.call(this, false);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n\n        if (rowWidth && rowWidth.state) {\n            firstRowToWidth.call(this, rowWidth.width)\n        }\n    }\n\n    selectorMoveReset() {\n        editorSetOffset.call(this);\n        this.editor.setRiCi(this.data.selector.ri, this.data.selector.ci)\n        sheetReset.call(this);\n    }\n\n    getTable() {\n        let {table} = this;\n        return {\n            recalc: false,\n            table: table\n        }\n    }\n\n    clickCopyPaste() {\n        let {data} = this;\n        let args = data.clickCopyPaste();\n        if (args.enter) {\n            this.selector.arange = args.dstCellRange;\n            data.clickAutofill(args.srcCellRange, args.dstCellRange, \"all\", msg => xtoast('Tip', msg));\n            autofillNext.call(this);\n        }\n    }\n\n    setCellRange(reference, tableProxy, styleBool, cellRange) {\n        let {  data} = this;\n        data.paste(cellRange);\n        for (let i = 0; i < reference.length; i++) {\n            let {ri, ci} = reference[i];\n            let cell = deepCopy(tableProxy.rows.getCellOrNew(ri, ci));\n            if (styleBool === false) {\n                delete cell['style'];\n            }\n            selectorCellText.call(this, ri, ci, cell, 'style');\n            selectorSet.call(this, true, ri, ci, true, true);\n        }\n    }\n\n    selectorEditorReset(ri, ci) {\n        let {selector} = this;\n        editorSetOffset.call(this, true, ri, ci);\n        this.editor.setRiCi(ri, ci);\n        selector.hide();\n        sheetReset.call(this);\n    }\n\n    loadData(data) {\n        this.data.setData(data, this);\n        // \n        // this.editorProxy.associatedArr(this.data.rows);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo(this);\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    removeEvent() {\n        remove.call(this);\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n}\n\n","function Drag(options, self) {\n\n    /**\n     *\n     * @param el \n     */\n    this.register = function (el) {\n        el.addEventListener('mousedown', function (e) {\n            if (e.button !== 0) {\n                //\n                return;\n            }\n\n\n            //xy\n            let x = e.clientX;\n            let y = e.clientY;\n\n            //\n            let l = el.offsetLeft;\n            let t = el.offsetTop;\n\n            if (options && options.onBegin) {\n                options.onBegin.call(el, {\n                    left: x - l,\n                    top: y - t\n                });\n            }\n\n\n            //\n            let isDown = true;\n            //\n            el.style.cursor = 'move';\n\n            let nl = x, nt = y;\n\n\n            window.onmousemove = function (e) {\n                if (!isDown) {\n                    return;\n                }\n                //xy\n                let nx = e.clientX;\n                let ny = e.clientY;\n\n\n                //\n                nl = nx - (x - l);\n                nt = ny - (y - t);\n\n                // console.log( nl, nt);\n                // let drag = false;\n                if (nl > 0) {\n                    // drag = false;\n                    el.style.left = nl + 'px';\n                } else {\n                    // drag = true;\n                    el.style.left = 0 + 'px';\n                }\n                if (nt > 0) {\n                    // drag = false;\n                    el.style.top = nt + 'px';\n                } else {\n                    // drag = true;\n                    el.style.top = 0 + 'px';\n                }\n                // el.style.left = nl + 'px';\n                // el.style.top = nt + 'px';\n\n\n                if (options && options.onDrag) {\n                    options.onDrag.call(el, {\n                        left: nl,\n                        top: nt,\n                        x: nx - x,\n                        y: ny - y,\n                        isDown: isDown\n                    });\n                }\n\n                return false;\n            };\n\n            window.onmouseup = function () {\n                //\n                isDown = false;\n                el.style.cursor = 'default';\n\n                if (options && options.onEnd) {\n                    options.onEnd.call(el, {left: parseInt(el.style.left), top: parseInt(el.style.top)}, self);\n                }\n\n                return false;\n            };\n            // e.stopPropagation();\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            } else if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                // window.event.returnValue === false;\n            }\n        });\n    }\n}\n\nexport default Drag;","function Resize(options, self) {\n\n    this.register = function (el) {\n        let directionsArr = [];\n        let directions = ['nw', 'w', 'ws', 's', 'se', 'e', 'ne', 'n'];\n        //\n        directions.forEach(str => {\n            //direction ws\n\n            let div = document.createElement('div');\n            div.style.display = \"block\";\n            div.className = 'direction ' + str;\n            //\n\n            directionsArr.push(div);\n            el.appendChild(div);\n        });\n\n        for(let i = 0; i < 4; i++) {\n            let line = document.createElement('div');\n            line.style.display = \"block\";\n            line.className = `line${i+1}`;\n            el.appendChild(line);\n            directionsArr.push(line);\n        }\n\n\n        let border = document.createElement('div');\n        border.className = 'border';\n        el.appendChild(border);\n\n\n        //\n\n        directions.forEach(str => {\n            let obj = el.querySelector(\".\" + str);\n            obj.onmousedown = function (e) {\n\n                if (e.button !== 0) {\n                    return;\n                }\n\n                let ox = e.clientX;\n                let oy = e.clientY;\n\n                let data = {\n                    ox: ox,\n                    oy: oy,\n                    ow: el.offsetWidth,\n                    oh: el.offsetHeight,\n                    ol: el.offsetLeft,\n                    ot: el.offsetTop\n\n                };\n\n                if (options && options.onBegin) {\n                    options.onBegin.call(el,data)\n                }\n\n                let isResize = true;\n                window.onmousemove = function (event) {\n                    if (!isResize) {\n                        return;\n                    }\n                    let x = event.clientX;\n                    let y = event.clientY;\n\n                    // widthheight \n\n                    let width = x - data.ox;\n                    let height = y - data.oy;\n\n\n                    data.width = width;\n                    data.height = height;\n\n                    let fun = mappers[str];\n                    if (fun) {\n                        fun.call(obj, data, event);\n                    }\n\n                    event.stopPropagation();\n                };\n                window.onmouseup = function (ee) {\n                    isResize = false;\n                    ee.stopPropagation();\n\n                    if (options && options.onEnd) {\n                        options.onEnd.call(el)\n                    }\n                };\n\n                //\n                e.stopPropagation()\n            }\n\n        });\n\n\n        if (!options) {\n            options = {\n                onResize: function () {\n\n                }\n            }\n        } else if (!options.onResize) {\n            options.onResize = function () {\n\n            }\n        }\n\n        function setLeft(l) {\n            options.onResize({left: l}, self);\n            el.style.left = l + 'px';\n        }\n\n        function setTop(t) {\n            options.onResize({top: t}, self);\n            el.style.top = t + 'px';\n        }\n\n        function setWidth(w) {\n            if (w < 20) {\n                w = 20;\n            }\n            options.onResize({width: w}, self);\n            el.style.width = w + 'px';\n        }\n\n        function setHeight(h) {\n\n            if (h < 20) {\n                h = 20;\n            }\n            options.onResize({height: h}, self);\n            el.style.height = h + 'px';\n        }\n\n        let mappers = {\n            s: function (data) {\n                setHeight(data.oh + data.height);\n            },\n            e: function (data) {\n                setWidth(data.ow + data.width)\n            },\n            w: function (data) {\n                let value = data.width;\n\n\n                let l = data.ol + value;\n                let w = data.ow + Math.abs(value);\n\n                if (value > 0) {\n                    w = data.ow - value;\n                }\n\n                if (w > 20) {\n                    setLeft(l);\n                    setWidth(w);\n                }\n            },\n            n: function (data) {\n                let value = data.height;\n\n                let t = data.ot + value;\n                let h = data.oh + Math.abs(value);\n\n                if (value > 0) {\n                    h = data.oh - value;\n                }\n                if (h > 20) {\n                    setHeight(h);\n                    setTop(t);\n                }\n            },\n            se: function (data) {\n                mappers.s(data);\n                mappers.e(data);\n            },\n            nw: function (data) {\n                mappers.n(data);\n                mappers.w(data);\n            },\n            ws: function (data) {\n                mappers.w(data);\n                mappers.s(data);\n            },\n            ne: function (data) {\n                mappers.n(data);\n                mappers.e(data);\n            }\n        };\n\n        // el.querySelector()\n        return directionsArr;\n    }\n}\n\nexport default Resize;\n","import {isHaveStyle} from \"../event/paste\";\nimport {Rows} from \"../core/row\";\nimport {splitStr} from \"../core/operator\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from '../core/cell_range';\nimport {isHave} from \"../core/helper\";\n// jobs: todo: TableProxyeventcore\nexport default class TableProxy {\n    constructor(data ) {\n        this.data = data;\n         this.rows = new Rows({len: 0, height: 0}, data);\n    }\n\n    getComputedStyle(computedStyle) {\n        let bold = false;\n        if (computedStyle.fontWeight > 400) {\n            bold = true;\n        }\n\n        return {\n            color: computedStyle.color,\n            bgcolor: computedStyle.background.substring(0,\n                computedStyle.background.indexOf(\")\") + 1),\n            font: {\n                bold: bold,\n            },\n        };\n    }\n\n    extend(tableDom, {ri, ci}) {\n        let {data} = this;\n        if (tableDom.rows.length >= data.rows.len - ri) {\n            let diff = tableDom.rows.length - (data.rows.len - ri);\n            if(diff > 0) {\n                data.insert('row', diff);\n            }\n        }\n\n        if (isHave(tableDom.rows[0]) === false || isHave(tableDom.rows[0].cells) === false) {\n            return;\n        }\n\n        let colLen = tableDom.rows[0].cells.length;\n        if (colLen >= data.cols.len) {\n            let diff = colLen - (data.cols.len - ci);\n            if(diff > 0) {\n                data.insert('column', diff, data.cols.len);\n            }\n        }\n    }\n\n    each(obj, cb) {\n        for (let i = 0; i < obj.rows.length; i++) {\n            for (let j = 0; j < obj.rows[i].cells.length; j++) {\n                cb(i, j, obj.rows[i].cells[j]);\n            }\n        }\n    }\n\n    dealColSpan(tableDom) {\n        this.each(tableDom, (i, j, cell) => {\n            let len = cell.getAttribute(\"colspan\");\n            if (len && len > 1) {\n                for (let c = 0; c < len - 1; c++) {\n                    tableDom.rows[i].insertBefore(document.createElement(\"td\"), tableDom.rows[i].cells[j + 1]);\n                }\n            }\n        });\n    }\n\n    dealStyle(tableDom, {ri, ci}) {\n        let {data, rows} = this;\n        let styles = data.styles;\n\n        this.each(tableDom, (i, j, cell) => {\n            let computedStyle = document.defaultView.getComputedStyle(cell, null);\n            let args = this.getComputedStyle(computedStyle);\n            let index = isHaveStyle(styles, args);\n            if (index === -1) {\n                styles.push(args);\n            }\n            rows.setCell(ri + i, ci + j, {\"style\": index === -1 ? styles.length - 1 : index}, 'all');\n        });\n    }\n\n    parseTableCellRange(tableDom, {ri, ci}) {\n      let maxRi = ri, maxCi = ci;\n      this.each(tableDom, (i, j) => {\n        let rii = ri + i;\n        let cij = ci + j;\n            if(maxRi < rii) {\n              maxRi = rii;\n            }\n            if(maxCi < cij) {\n              maxCi = cij;\n            }\n        });\n        return new CellRange(ri, ci, maxRi, maxCi);\n    }\n\n    dealReference(tableDom, {ri, ci}) {\n        let {rows} = this;\n         let reference = [];\n\n        this.each(tableDom, (i, j, cell) => { // reference updateCEllReferenceByShift \n            let node = cell.querySelector(\"reference\");\n            let innerText = cell.innerText || \"\";\n            if (node) {\n                let eri = node.getAttribute('ri');\n                let eci = node.getAttribute('ci');\n\n                let strList = splitStr(innerText);\n                let dci = i + ri - eri;\n                let dei = j + ci - eci;\n\n                let {bad, result} = rows.getCellTextByShift(strList, dei, dci);\n                rows.updateCellReferenceByShift(bad, result, ri + i, ci + j);\n            } else {\n                let _cell = rows.getCell(ri + i, ci + j) || {};\n                _cell.text = innerText;\n                _cell.formulas = innerText;\n\n                rows.setCell(ri + i, ci + j, _cell, 'all');\n            }\n            // proxy.setCell(data.name, xy2expr(ci + j, ri + i));\n\n            reference.push({\n                ri: ri + i,\n                ci: ci + j\n            });\n        });\n        return {\"reference\": reference};\n    }\n}\n","import {sheetReset} from \"../component/sheet\";\nimport {h} from \"../component/element\";\nimport Drag from \"../external/drag\";\nimport Resize from \"../external/resize\";\nimport {cssPrefix} from \"../config\";\nimport {getChooseImg} from \"../event/copy\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from \"../core/cell_range\";\n// import {deepCopy} from \"../core/operator\";\nimport TableProxy from \"../core/table_proxy\";\n\nexport let resizeOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n\n    onEnd(data) {\n\n    },\n    onResize(data, self) {\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n\n        img.img2.style['width'] = img.img.el.style['width'];\n        img.img2.style['height'] = img.img.el.style['height'];\n    }\n};\n\nexport let dragOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n    onEnd(data, self) {\n        let {left, top} = data;\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n        // img.left = left + 70;\n        // img.top = top + 31;\n\n        if (top - 31 < 0) {\n            top = 0;\n        } else if (left - 60 < 0) {\n            left = 0;\n        }\n\n        let range = self.data.getCellRectByXY(left + 60, top + 31);\n        range.sri = range.ri;\n        range.sci = range.ci;\n        range.eri = range.ri;\n        range.eci = range.ci;\n        let offsetLeft = left - range.left + 50;\n        let offsetTop = top - range.top + 21;\n\n        img.offsetLeft = offsetLeft;\n        img.offsetTop = offsetTop;\n        img.range = range;\n        if (typeof img.lastCi !== 'undefined' && typeof img.lastRi !== 'undefined') {\n            img.ri = img.lastRi;\n            img.ci = img.lastCi;\n        }\n        img.lastCi = range.ci;\n        img.lastRi = range.ri;\n\n        // self.data.history.addPic(deepCopy(self.data.pasteDirectionsArr), \"delete\");\n    },\n    onDrag(data) {\n    },\n};\n\nfunction spanDomPackage(spanDom, tableDom) {\n    let table = h(\"table\", \"\");\n    let tbody = h('tbody', '');\n\n    let textArr = spanDom.innerText.split(\"\\n\");\n    for (let i = 0; i < textArr.length; i++) {\n        let text = textArr[i];\n        let tr = h('tr', '');\n        let td = h('td', '');\n        td.html(text);\n        td.css('background', spanDom.style['background']);\n        td.css('font-weight', spanDom.style['font-weight']);\n        td.css('color', spanDom.style['color']);\n        tr.child(td);\n        tbody.child(tr);\n    }\n\n    table.child(tbody);\n    tableDom = table.el;\n\n    return tableDom;\n}\n\nexport function process(tableDom, styleDom = \"\") {\n    let {el, data} = this;\n    data.history.add(data.getData());\n    el.child(tableDom);\n    GetInfoFromTable.call(this, tableDom);\n    tableDom.parentNode.removeChild(tableDom);\n    if (styleDom) {\n        styleDom.parentNode.removeChild(styleDom);\n    }\n    sheetReset.call(this);\n}\n\nfunction mountPaste(e, cb) {\n    let cbd = e.clipboardData;\n    let p = false;\n\n    for (let i = 0; i < cbd.items.length; i++) {\n        let item = cbd.items[i];\n        if (item.kind === \"string\") {\n            item.getAsString((str) => {\n                let textDom = h('head', '');\n                let d = h('span', '');\n                if ((str.indexOf('<span') === -1 && str.indexOf('span>') === -1) && (str.indexOf('<table') === -1 && str.indexOf('table>') === -1)) {\n                    d.html(str);\n                    textDom.child(d.el);\n                    textDom = textDom.el;\n                }\n                else {\n                    textDom.html(str);\n                    textDom = textDom.el;\n                }\n                let imgDom = textDom.getElementsByTagName(\"img\")[0];\n                let styleDom = textDom.getElementsByTagName(\"style\")[0];\n                let tableDom = textDom.getElementsByTagName(\"table\")[0];\n                let spanDom = textDom.getElementsByTagName(\"span\")[0];\n                if (imgDom && !styleDom) {\n                    mountImg.call(this, imgDom);\n                    p = true;\n                } else {\n                    if (!tableDom) {\n                        setTimeout(() => {\n                            if (p) {\n                                return;\n                            }\n                            if (spanDom) {\n                                tableDom = spanDomPackage.call(this, spanDom, tableDom);\n                            }\n                            if (styleDom) {\n                                let {el} = this;\n                                el.child(styleDom);\n                            }\n\n                            if (tableDom && p === false) {\n                                let {el} = this;\n                                el.child(tableDom);\n                                GetInfoFromTable.call(this, tableDom);\n                                tableDom.parentNode.removeChild(tableDom);\n                                if (styleDom) {\n                                    styleDom.parentNode.removeChild(styleDom);\n                                }\n                                sheetReset.call(this);\n                                p = true;\n                            }\n                        }, 100)\n                    } else {\n                        if (styleDom) {\n                            let {el} = this;\n                            el.child(styleDom);\n                        }\n\n                        if (tableDom && p === false) {\n                            process.call(this, tableDom, styleDom);\n                            p = true;\n                        }\n                    }\n                }\n            });\n        } else if (item.kind === \"file\" && !p) {\n            let f = item.getAsFile();\n            let reader = new FileReader();\n            reader.onload = (evt) => {\n                // let {x, y, overlayerEl} = this;\n                // let {pasteDirectionsArr} = this.data;\n                let img = h('img', 'paste-img');\n                img.el.src = evt.target.result;\n\n                setTimeout(() => {\n                    if (p) {\n                        return;\n                    }\n                    p = true;\n                    mountImg.call(this, img.el);\n                }, 0);\n            };\n\n            if (!f)\n                return;\n            reader.readAsDataURL(f);\n        }\n    }\n    setTimeout(() => {\n        if (!p)\n            cb();\n        else {\n            let {data} = this;\n            data.change(data.getData());\n        }\n    })\n}\n\n// function processImg(item) {\n//     let f = item.getAsFile();\n//     let reader = new FileReader();\n//     reader.onload = (evt) => {\n//         // let {x, y, overlayerEl, pasteDirectionsArr} = this;\n//         let img = h('img', 'paste-img');\n//         img.el.src = evt.target.result;\n//\n//         setTimeout(() => {\n//             if (p) {\n//                 return;\n//             }\n//             p = true;\n//             mountImg.call(this, img.el);\n//         }, 0);\n//     };\n//\n//     reader.readAsDataURL(f);\n// }\n\n// function moveArr(top, left) {\n//     let {pasteDirectionsArr} = this.data;\n//     for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//         let p = pasteDirectionsArr[i];\n//         console.log(p.img.el['style'].top, \"108\");\n//         p.img.css(\"top\", `${top }px`)\n//             .css(\"left\", `${left  }px`)\n//     }\n// }\n\nfunction getMaxCoord(ri, ci) {\n    let top = 0;\n    let left = 0;\n    let {pasteDirectionsArr} = this.data;\n    let number = 0;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        if (p.ri === ri && p.ci === ci) {\n            if (left < p.nextLeft) {\n                left = p.nextLeft;\n            }\n            if (top < p.nextTop) {\n                top = p.nextTop;\n            }\n            number++;\n        }\n    }\n\n    return {\n        top: top,\n        left: left,\n        number: number,\n    }\n}\n\n\n//     add = true\nexport function mountImg(imgDom, init = false, sri, sci, range) {\n    let image = new Image();\n    image.src = imgDom.src;\n    image.onload = () => {\n        let width = image.width;\n        let height = image.height;\n        let img = imgDom;\n        let {container, data} = this;\n        let {pasteDirectionsArr} = data;\n        // if (add) {\n        //     // data.history.addPic(Object.assign([], pasteDirectionsArr), \"delete\");\n        // }\n\n        let {ri, ci} = data.selector;\n        if (init) {\n            ri = sri;\n            ci = sci;\n        }\n        let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n        const rect = data.getMoveRect(new CellRange(ri, ci, ri, ci));\n        let left = rect.left + pictureOffsetLeft;\n        let top = rect.top + pictureOffsetTop;\n        let number = 0;\n        let choose = getChooseImg.call(this);\n        if (choose) {\n            let args = getMaxCoord.call(this, choose.ri, choose.ci);\n            left = args.left;\n            top = args.top;\n            ri = choose.ri;\n            ci = choose.ci;\n            number = args.number;\n        }\n\n        let div = h('div', `${cssPrefix}-object-container`)\n            .css(\"position\", \"absolute\")\n            .css(\"top\", `${top}px`)\n            .css(\"width\", `${width}px`)\n            .css(\"height\", `${height}px`)\n            .css(\"z-index\", `100000`)\n            .css(\"left\", `${left}px`)\n            .child(img);\n        container.child(div);\n        new Drag(dragOption, this).register(div.el);\n        setTimeout(() => {\n            let {data} = this;\n            let directionsArr = new Resize(resizeOption, this).register(div.el);\n            let index = pasteDirectionsArr.length;\n\n            pasteDirectionsArr.push({\n                \"src\": img.src,\n                \"state\": true,\n                \"arr\": directionsArr,\n                \"img\": div,\n                \"index\": index,\n                \"img2\": img,\n                \"ri\": ri,\n                \"ci\": ci,\n                \"offsetLeft\": 0,\n                \"offsetTop\": 0,\n                \"number\": number,\n                \"range\": init ? range : data.selector.range,\n                \"top\": top,\n                \"left\": left,\n                \"nextLeft\": left + 15,\n                \"nextTop\": top + 15,\n            });\n            if (!init) {\n                this.data.change(this.data.getData());\n            }\n            this.direction = true;\n            div.css(\"width\", `${img.offsetWidth}px`);\n            div.css(\"height\", `${img.offsetHeight}px`);\n            containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr, init);\n            div.on('mousedown', () => containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr));\n        }, 0);\n    };\n}\n\nfunction hideDirectionArr() {\n    let {pasteDirectionsArr} = this.data;\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let arr = pasteDirectionsArr[i].arr;\n            if (arr.length > 0) {\n                for (let j = 0; j < arr.length; j++) {\n                    arr[j].style.display = 'none';\n                }\n            }\n            pasteDirectionsArr[i].state = false;\n            pasteDirectionsArr[i].img.css(\"z-index\", \"10000\");\n            pasteDirectionsArr[i].img2.style['border'] = \"none\";\n        }\n    }\n}\n\nfunction deleteImg(d = false) {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true || d === true) {\n                direction_delete.push(pasteDirectionsArr[i]);\n            } else {\n                direction_new.push(pasteDirectionsArr[i]);\n            }\n        }\n    }\n\n    Object.keys(direction_delete).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n\n    let {data} = this;\n    data.pasteDirectionsArr = direction_new;\n    data.change(data.getData());\n}\n\n// function deleteAllImg() {\n//     let {pasteDirectionsArr} = this.data;\n//     let direction_new = [];\n//     let direction_delete = [];\n//     this.direction = false;\n//     if (pasteDirectionsArr.length > 0) {\n//         for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//             direction_delete.push(pasteDirectionsArr[i]);\n//         }\n//     }\n//\n//     Object.keys(pasteDirectionsArr).forEach(i => {\n//         direction_delete[i].img.removeEl();\n//     });\n//\n//     this.pasteDirectionsArr = direction_new;\n// }\n\nfunction containerHandlerEvent(directionsArr, index, pasteDirectionsArr, init) {\n    hideDirectionArr.call(this);\n    this.direction = true;\n    Object.keys(directionsArr).forEach(i => {\n        directionsArr[i].style.display = 'block';\n    });\n\n    let {selector, editor} = this;\n    if (!init) {\n        selector.hide();\n        editor.clear();\n\n        pasteDirectionsArr[index].img.css(\"z-index\", \"99999999\");\n        pasteDirectionsArr[index].state = true;\n    } else {\n        hideDirectionArr.call(this);\n    }\n}\n\nfunction equals(x, y) {\n    let f1 = x instanceof Object;\n    let f2 = y instanceof Object;\n    if (!f1 || !f2) {\n        return x === y\n    }\n    if (Object.keys(x).length !== Object.keys(y).length) {\n        return false\n    }\n    let newX = Object.keys(x);\n    for (let p in newX) {\n        p = newX[p];\n        let a = x[p] instanceof Object;\n        let b = y[p] instanceof Object;\n        if (a && b) {\n            let equal = equals(x[p], y[p]);\n            if (!equal) {\n                return equal\n            }\n        } else if (x[p] !== y[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isHaveStyle(styles, style) {\n    for (let i = 0; i < styles.length; i++) {\n        if (equals(styles[i], style)) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n\nfunction GetInfoFromTable(tableObj) { // class ClipboardTableProxy; .tableDom   .dealColSpan() [477~483], dealStyle(), dealReferrence() row2 sheet12setCellRange3\n    let {data} = this;\n    let {ri, ci} = data.selector;\n    let styles = data.styles;\n    console.time(\"paste\");\n    let tableProxy = new TableProxy(data);\n\n    tableProxy.extend(tableObj, {ri, ci});\n    tableProxy.dealColSpan(tableObj);\n    tableProxy.dealStyle(tableObj, {ri, ci});\n    let {reference} = tableProxy.dealReference(tableObj, {ri, ci});\n    this.setCellRange(reference, tableProxy, true, tableProxy.parseTableCellRange(tableObj, {ri, ci}));\n\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n    let {advice, editor} = this;\n    editor.clear();\n    advice.show(left, top, 1, reference, tableProxy);\n    console.timeEnd(\"paste\");\n    return {\n        rows: data.rows._,\n        styles: styles\n    };\n}\n\n// function pasteType(type, ds, dei) {\n//     if (type === 1) {\n//\n//     } else if (type === 2) {\n//         xy2expr(ds[0] + dei, ds[1], 2);\n//     }\n// }\n\nexport {\n    mountPaste,\n    hideDirectionArr,\n    deleteImg,\n    // moveArr,\n    // deleteAllImg,\n    GetInfoFromTable,\n}\n\n","import dayjs from 'dayjs'\nimport {datePattern, str2Re} from \"../utils/reg_pattern\";\nimport {formatNumberRender} from \"../core/format\";\nimport {isHave, isNumber} from \"../core/helper\";\n\n\nexport function formatDate(diff) {\n    if(!isHave(diff) || !isNumber(diff)) {\n        return {\n            \"state\": false,\n            // \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n\n    let str = calcDecimals(diff, (i) => {\n        return i * 24 * 60;\n    });\n    str = formatNumberRender(str, 5);\n    let beginDate = dayjs('1900-01-01');\n    let beginDate2 = dayjs('1900-01-01');\n    let enter = false;\n\n    if (isHave(str) && str * 1 > 0) {\n        let second = calcDecimals(str, (i) => {\n            return i * 60;\n        });\n        enter = true;\n        second = formatNumberRender(second, 5);\n        beginDate2 = dayjs('1900-01-01  00:00:00').set('minute', str).set('second', second);\n    }\n\n    let date = \"\";\n    if (enter) {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n\n        let formula = beginDate2.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD  h:mm:ss');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": formula,\n            \"minute\": true\n        }\n    } else {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n}\n\nexport function changeFormat(date, format = 'YYYYMMDD') {\n  return dayjs(date).format(format);\n}\n\nexport function calcDecimals(diff, cb = () => {\n}) {\n    let arr = diff.toString().split('.');\n    if (arr.length > 2) {\n        return diff;\n    }\n    let fix = arr[1] + \"\";\n    let newData = fix;\n    for (let i = 0; i < fix.length; i++) {\n        newData = newData * 0.1;\n    }\n\n    return cb(newData);\n}\n\n// export function cellDate() {\n//\n// }\n\n// test\nexport function dateDiff(date) {\n    let valid = false;\n\n    for (let i = 0; valid === false && i < datePattern.length; i++) {\n        valid = str2Re(datePattern[i]).test(date);\n    }\n\n    if (valid === false) {\n        return {\n            \"isValid\": false,\n        };\n    } else {\n        date = date.replace(/[|]/g, \"-\");\n        date = date.replace(/[]/g, \"\");\n\n        return {\n            \"diff\": dayjs(date).diff(dayjs('1900-01-01'), 'day') + 2,\n            \"isValid\": true,\n        }\n    }\n}\n","import {xy2expr} from \"./alphabet\";\nimport PreAction from \"../model/pre_action\";\nimport {testValid} from \"../utils/test\";\n\nfunction operationItem(preAction) {\n    this.undoItems.push(preAction);\n    this.redoItems = [];\n}\n\nexport default class MultiPreAction {\n    constructor(data) {\n        this.undoItems = [];\n        this.redoItems = [];\n        this.data = data;\n    }\n\n    addStep({type, action, ri, ci, expr, cellRange, cells, height, width, property, value, oldData}, {oldCell, newCell, oldMergesData, newMergesData, oldStep}) {\n        let preAction = \"\";\n\n        if(type === 1) {\n            preAction = new PreAction({\n                type,\n                action, ri, ci, expr, oldCell, newCell\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 2 || type === 5 || type === 11 || type === 12 || type === 6) {\n            preAction = new PreAction({\n                type, oldMergesData, property, value, newMergesData,\n                action, cellRange,  oldCell, newCell: cells\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 13) {\n            preAction = new PreAction({\n                type, oldData, newData: oldStep.oldData,\n                action,\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 3) {\n            preAction = new PreAction({\n                type,\n                action, height, ri, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 4) {\n            preAction = new PreAction({\n                type,\n                action, width, ci, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        }\n\n        testValid.call(this);\n    }\n\n    // merges\n    getStepType(type, {ri, ci, expr, text, range, cellRange, property, value}) {\n        let str = \"\";\n        let {rows, cols} = this.data;\n\n        if(type === 1) {\n            str = `${expr}\"${text}\"`;\n            return {\n                action: str,\n                type,\n                ri, ci, expr\n            };\n        } else if(type === 2) {\n            let expr1 = xy2expr(range.sci, range.sri);\n            let expr2 = xy2expr(range.eci, range.eri);\n            expr = expr1 === expr2 ? expr1 : `${expr1}:${expr2}`;\n            str = `${expr}`;\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(range),\n            };\n        } else if(type === 3) {\n            let height = rows.getHeight(ri);\n            str = ``;\n            return {\n                action: str,\n                type,\n                height: height,\n                ri: ri\n            };\n        } else if(type === 4) {\n            let width = cols.getWidth(ci);\n            str = ``;\n            return {\n                action: str,\n                type,\n                width: width,\n                ci: ci\n            };\n        } else if(type === 5) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 12) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 13) {\n            str = '';\n\n            return {\n                action: str,\n                type, oldData: this.data.getData(),\n            };\n        }else if(type === 11) {\n            if (property === 'font-bold' || property === 'font-italic'\n                || property === 'font-name' || property === 'font-size' || property === 'color') {\n                str = \"\";\n            } else if (property === 'underline') {\n                str = \"\";\n            } else if (property === 'bgcolor' || property === 'format') {\n                str = \"\";\n            } else if (property === 'align') {\n                if (value === 'left') {\n                    str = \"\";\n                } else if (value === 'center') {\n                    str = \"\";\n                } else if (value === 'right') {\n                    str = \"\";\n                }\n            } else if (property === 'valign') {\n                if (value === 'top') {\n                    str = \"\";\n                } else if (value === 'center') {\n                    str = \"\";\n                } else if (value === 'bottom') {\n                    str = \"\";\n                }\n            } else if (property === 'border') {\n                str = \"\";\n            } else if (property === 'strike') {\n                str = \"\";\n            } else if (property === 'merge') {\n                str = '';\n            }\n\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 6) {\n            str = '';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        }\n    }\n\n    undo() {\n        let preAction = this.does(this.getItems(1), 1);\n        this.redoItems.push(preAction);\n    }\n\n    redo() {\n        let preAction = this.does(this.getItems(2), 2);\n        this.undoItems.push(preAction);\n    }\n\n    eachRange(range) {\n        let {rows} = this.data;\n\n        return rows.eachRange(range);\n    }\n\n    does(actionItems, actionType) {\n        if (!this.data.settings.showEditor) {\n            return;\n        }\n\n        if (actionItems.length <= 0) {\n            return;\n        }\n        let {data} = this;\n        let {sheet} = data;\n\n        let preAction = actionItems.pop();\n        preAction.restore(data, sheet, actionType);\n\n        return preAction;\n    }\n\n    getItems(type) {\n        if (type === 1) {\n            return this.undoItems;\n        } else {\n            return this.redoItems;\n        }\n    }\n}\n","import CellProp from \"./cell_prop\";\nimport {isHave} from \"../core/helper\";\nimport {xy2expr} from \"../core/alphabet\";\n\nfunction getType(dType, sType) {\n    if (dType === 1 && sType === 1) {\n        return 1;           // 1 * 1\n    } else if (dType === 1 && sType === 2) {\n        return 2;\n    } else if (dType === 1 && sType === 3) {    //  * \n        return 3;\n    } else if (dType === 2 && sType === 1) {\n        return 4;\n    } else if (dType === 3 && sType === 1) {\n        return 5;\n    } else if (dType === 2 && sType === 2) {\n        return 6;\n    } else if (dType === 2 && sType === 3) {\n        return 7;\n    } else if (dType === 3 && sType === 2) {\n        return 8;\n    } else if (dType === 3 && sType === 3) {\n        return 9;\n    }\n}\n\nfunction changeDarrToDoubleArr(darr, selectorRange) {\n    let ri = selectorRange.sri;\n    let _darr = [];\n    let arr = [];\n    let index = 0;\n    selectorRange.each((i, j) => {\n        if (ri !== i) {\n            ri = i;\n            _darr.push(arr);\n            arr = [];\n        }\n        arr.push(darr[index]);\n        index += 1;\n    });\n    _darr.push(arr);\n\n    return _darr;\n}\n\nexport default class PaintFormat {\n    constructor(selectorRange, dstRange) {\n        this.selectorRange = selectorRange;\n        this.dstRange = dstRange;\n    }\n\n    getPaintType() {\n        let {dstRange, selectorRange} = this;\n\n        let dType = dstRange.getType();\n        let sType = selectorRange.getType();\n\n        let paintType = getType(dType, sType);\n\n        return paintType;\n    }\n\n    makePaintArr(type, darr) {\n        let {dstRange, selectorRange} = this;\n        let pArr = [];\n        // if (type === 1 || type === 6) {  // 1 // 1\n        //     let index = 0;\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         index += 1;\n        //         if (index === darr.length) {\n        //             index = 0;\n        //         }\n        //     });\n        // } else if (type === 3) {        // 3  * 1\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         let {cell} = _darr[0][index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //     });\n        // } else if(type === 7) {\n        //     let recordRi = dstRange.sri;\n        //     let rowIndex = 0;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === _darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = _darr[rowIndex][0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // }else if (type === 4 || type === 2) {   // 4: 1 * 1    6: 1 * 1\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //     });\n        // } else if (type === 5) {\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             index = 0;\n        //         }\n        //\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //         recordRi = i;\n        //     });\n        // } else if (type === 8) {\n        //     let rowIndex = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = darr[rowIndex];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // } else if (type === 9) {\n            let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n            let rowIndex = 0;\n\n            let _darr = changeDarrToDoubleArr(darr, selectorRange);\n\n            dstRange.each((i, j) => {\n                if (recordRi !== i) {\n                    rowIndex += 1;\n                    index = 0;\n                    if (rowIndex === _darr.length) {\n                        rowIndex = 0;\n                    }\n                }\n\n                let {cell} = _darr[rowIndex][index];\n\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j));\n                pArr.push(cellProp);\n\n                if (index === dci) {\n                    index = 0;\n                } else {\n                    index += 1;\n                }\n                recordRi = i;\n            });\n        // }\n\n        return pArr;\n    }\n}","/* global document */\n\nimport {formulaCalc} from '../core/formula';\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper, {isHave, isNumber, useOne} from './helper';\nimport {isFormula, Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\nimport Moved from '../event/move';\nimport {h} from \"../component/element\";\nimport {mountImg} from \"../event/paste\";\nimport {parseCell2} from \"../component/table\";\nimport {isLegal} from \"./operator\";\nimport Recast from \"./recast\";\nimport {changeFormat, dateDiff, formatDate} from '../utils/date';\nimport {formatNumberRender} from \"./format\";\nimport MultiPreAction from \"../core/multi_pre_action\";\nimport CellProxy from \"./cell_proxy\";\nimport CellProp from \"../model/cell_prop\";\nimport PaintFormat from \"../model/paint_format\";\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        family: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    formula: {},\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showEditor: true,\n    autoLoad: true,\n    ignore: [],\n    cellWidth: 0,\n    ignoreRi: 0,\n    minus: false,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 10,\n    },\n    rowsInit: false,\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        flexible: false,\n        underline: false,\n        autoAdapt: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n    },\n};\n\nconst toolbarHeight = 41;\n\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    if (!dst) {\n        return false;\n    }\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange, cleard) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    if (cleard)\n        clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (isHave(cell.style)) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n\n    Object.assign(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction selectorCellText(ri, ci, text, event_type) {\n    if (ri === -1 || ci === -1) {\n        return {\n            \"state\": true,\n            \"msg\": \"\"\n        };\n    }\n    if (event_type !== 'style' && (!text || text[0] !== '=')) {\n        return {\n            \"state\": false,\n            \"msg\": \"\"\n        };\n    }\n\n    // state\n    let args = errorPop.call(this, text);\n    if (event_type !== 'style' && args.state === true) {\n        return {\n            \"msg\": args.msg,\n            \"state\": true,\n        };\n    }\n    return {\n        \"msg\": args.msg,\n        \"state\": false,\n    };\n}\n\nfunction errorPop(text) {\n    let enter = false;\n    let msg = \"\";\n    try {\n        let recast = new Recast(text);\n        recast.parse();\n    } catch (e) {\n        msg = ', : ' + e.description;\n        enter = true;\n    }\n\n    if (enter === true) {\n        if (isLegal(text) === false) {\n            msg = '';\n            enter = true;\n        }\n    }\n\n    if (enter) {\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else {\n        return {\n            \"state\": false,\n            \"msg\": msg\n        };\n    }\n}\n\nfunction processPasteDirectionsArr(pasteDirectionsArr, type = 'to', sheet) {\n    if (type === 'to') {\n        let arr = [];\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            console.log(item);\n            let newItem = {\n                src: item.img2.src,\n                ri: item.ri,\n                ci: item.ci,\n                top: item.top,\n                left: item.left,\n                range: item.range,\n                offsetLeft: item.offsetLeft,\n                offsetTop: item.offsetTop,\n                nextLeft: item.nextLeft,\n                nextTop: item.nextTop,\n                img: item.img,\n                arr: item.arr,\n                img2: item.img2\n            };\n\n            arr.push(newItem);\n        }\n\n        return arr;\n    } else if (type === 'from') {\n        if (typeof sheet === 'string') {\n            return;\n        }\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            let img = h('img', '');\n            img.el.src = item.src;\n            mountImg.call(sheet, img.el, true, item.ri, item.ci, item.range);\n        }\n    }\n}\n\nfunction clickCopyPasteHelp(ri, lci) {\n    let {rows} = this;\n    let lri = ri + 1;\n    let enter = true;\n    while (enter) {\n        let lcell = rows.getCellOrNew(lri, lci);\n        if (!lcell || !lcell.text) {\n            enter = false;\n        } else {\n            lri = lri + 1;\n        }\n    }\n\n    return lri;\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSignleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            setStyleBorder.call(this, ri, ci, {});\n        }\n    }\n\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci <= eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\n// function getCellRowByAbsX(scrollOffsetx) {\n//     let x = scrollOffsetx;\n//     const {cols} = this;\n//     const fsw = this.freezeTotalWidth();\n//     let inits = cols.indexWidth;\n//     if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n//     const [ci, left, width] = helper.rangeReduceIf(\n//         0,\n//         cols.len,\n//         inits,\n//         cols.indexWidth,\n//         x,\n//         i => cols.getWidth(i),\n//     );\n//     if (left <= 0) {\n//         return {ci: 0, left: 0, width: cols.indexWidth};\n//     }\n//     return {ci: ci - 1, left, width};\n// }\n\n// function getCellRowByAbsY(scrollOffsety) {\n//     let y = scrollOffsety;\n//     let {rows} = this;\n//     let ri = 0;\n//     let top = rows.height;\n//     const frset = this.exceptRowSet;\n//     let {height} = rows;\n//\n//     for (; ri < rows.len; ri += 1) {\n//         if (top > y) break;\n//         if (!frset.has(ri)) {\n//             height = rows.getHeight(ri);\n//             top += height;\n//         }\n//     }\n//\n//     if (ri <= 0) {\n//         ri = 0;\n//     }\n//     if (height <= 0) {\n//         height = 0;\n//     }\n//\n//     return {ri: ri, top, height};\n// }\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction makeFormatCell({text, formula}, {symbol, position}, cb) {\n    if (!isHave(text) || !isNumber(text)) {\n        return null;\n    }\n\n    let cText = cb(formatNumberRender(text, -1));\n    formula = isFormula(formula) ? formula : cText;\n    if (!isNaN(cText)) {\n\n        return {\n            \"text\": position === 'begin' ? symbol + cText : cText + symbol,\n            \"value\": text,\n            \"formulas\": formula,\n        };\n    } else {\n        return null;\n    }\n}\n\n// what = 'input' || 'change'\nfunction tryParseToNum(cell, ri, ci) {\n    return getType.call(this, ri, ci, cell);\n}\n\nfunction getType(ri, ci, cell) {\n    let data = this;\n    let {rows} = this;\n    let cellStyle = data.getCellStyle(ri, ci);\n    let {isValid, diff} = dateDiff(cell.text);\n\n    let format = rows.getCellStyleConvert(cellStyle, isValid);\n    if (format === 'number') {\n        let text = cell.text, formula = cell.formulas;\n        let _cell = {};\n        if (isValid) {\n            _cell = {\n                \"text\": diff.toFixed(2),\n                \"formulas\": formula,\n            };\n        } else {\n            text = formatNumberRender(text, 2);\n            _cell = {\n                \"text\": text,\n                \"value\": cell.text,\n                \"formulas\": formula,\n            };\n        }\n\n        if (isHave(_cell.text) && isNumber(_cell.text)) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        } else {\n            return {\n                \"state\": false,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'date' || format === 'datetime') {\n        let text = cell.text;\n\n        if (!isValid) {\n            let args = formatDate(text);\n            let {state, date} = args;\n            // minute = args.minute;\n            isValid = state;\n            diff = cell.text;\n            text = date;\n        }\n\n        if (isValid) {\n            if (format === 'datetime') {\n                text = changeFormat(formatDate(dateDiff(text).diff).date);\n            }\n\n        }\n\n        return {\n            \"state\": isValid,\n            \"style\": format,\n            \"text\": !isHave(cellStyle) ? diff : text,\n        };\n    } else if (format === 'normal') {\n        if (isValid) {\n            let text = diff, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": rows.toString(formula),\n                \"text\": rows.toString(text),\n            };\n\n            return {\n                \"state\": true,\n                \"text\": _cell.text,\n                \"style\": format,\n                \"cell\": _cell,\n            }\n        } else {\n            let text = cell.text, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'rmb') {\n        let text = \"\", formula = \"\";\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = formatNumberRender(cell.text, 0);\n            formula = cell.formulas;\n        }\n\n        let _cell = makeFormatCell({text, formula}, {symbol: \"\", position: \"begin\"}, (s) => {\n            return s;\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    } else if (format === 'percent') {\n        let text = \"\", formula = \"\";\n\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = rows.useOne(cell.value, cell.text);\n            formula = cell.formulas;\n        }\n        let _cell = makeFormatCell({text, formula}, {symbol: \"%\", position: \"end\"}, (s) => {\n            return Number(s * 100).toFixed(2);\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    }\n\n    return {\n        \"state\": false,\n        \"style\": format,\n        \"text\": cell.text,\n        \"cell\": {},\n    };\n}\n\n\nexport default class DataProxy {\n    constructor(name, settings, methods) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.methods = methods;\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row, this);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = {};\n        this.showEquation = false;\n        this.calc = formulaCalc();\n        this.pasteDirectionsArr = [];\n        this.changeDataForCalc = null;\n\n        // save data end\n\n        // don't save object\n        this.multiPreAction = new MultiPreAction(this);\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        // this.history = new History(this);\n        this.clipboard = new Clipboard();\n        this.moved = new Moved();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    tryParseToNum(cell, ri, ci) {\n        return tryParseToNum.call(this, cell, ri, ci);\n    }\n\n    clickCopyPaste() {\n        let ri = this.selector.range.eri;\n        let ci = this.selector.range.eci;\n        let {rows} = this;\n        const cell = rows.getCellOrNew(ri, ci);\n        const cell2 = rows.getCellOrNew(ri + 1, ci);\n        if (!cell || !cell.text || (cell2 && cell2.text)) {\n            return {\n                enter: false\n            };\n        }\n\n        let left = clickCopyPasteHelp.call(this, ri, ci - 1);\n        let right = clickCopyPasteHelp.call(this, ri, ci + 1);\n        let eri = left < right ? right : left;\n\n        let enter = false;\n        for (let i = 1; i < eri && enter === false; i++) {\n            let cell3 = rows.getCellOrNew(ri + i, ci);\n\n            if (cell3 && cell3.text) {\n                eri = ri + i;\n                enter = true;\n            }\n        }\n\n\n        let dstCellRange = new CellRange(ri + 1, ci, eri - 1, ci);\n        let srcCellRange = new CellRange(ri, ci, ri, ci);\n\n        return {\n            enter: true,\n            dstCellRange: dstCellRange,\n            srcCellRange: srcCellRange\n        };\n    }\n\n\n    // getSelectedValidator() {\n    //     const {ri, ci} = this.selector;\n    //     const v = this.validations.get(ri, ci);\n    //     return v ? v.validator : null;\n    // }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.multiPreAction.getItems(1).length > 0;\n        // return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.multiPreAction.getItems(2).length > 0;\n    }\n\n    undo() {\n        this.multiPreAction.undo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.undo(this.getData(), (d) => {\n        //     this.setData(d);\n        // }, sheet);\n    }\n\n    historyList(item) {\n        return this.multiPreAction.getItems(item);\n    }\n\n    redo() {\n        this.multiPreAction.redo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.redo(this.getData(), (d) => {\n        //     this.setData(d);\n        // });\n    }\n\n    copy() {\n        document.execCommand('copy', true);\n        this.clipboard.copy(this.selector.range);\n    }\n\n    makeCellPropArr(range, dsri, dsci) {\n        let {rows} = this;\n        let darr = [];\n        let cells = rows.eachRange(range);\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n\n            if (isHave(cell) && isHave(cell.style) === false) {\n                let cstyle = this.defaultStyle();\n                cell.style = this.addStyle(cstyle);\n            }\n\n            let cellProp = new CellProp(ri + dsri, ci + dsci, cell, xy2expr(ri + dsri, ci + dsci));\n            darr.push(cellProp);\n        }\n\n        return darr;\n    }\n\n    setCellByCellProp(pArr, cb) {\n        let {rows} = this;\n        for (let i = 0; i < pArr.length; i++) {\n            let {ri, ci, cell} = pArr[i];\n            if (isHave(cell) && isHave(cell.style)) {\n                rows.setCell(ri, ci, cell, 'style');\n            }\n            cb(ri, ci);\n        }\n    }\n\n    paintFormatChange(cb) {\n        this.changeData(() => {\n            let {clipboard,   selector} = this;\n            let {range} = clipboard;\n            let sri = selector.ri;\n            let sci = selector.ci;\n\n            let dsri = sri - range.sri;\n            let dsci = sci - range.sci;\n            let darr = this.makeCellPropArr(range, dsri, dsci);\n\n            if (selector.range.eri - selector.range.sri === 0 && selector.range.eci - selector.range.sci === 0) {\n                this.setCellByCellProp(darr, cb);\n            } else {\n                let paintFormat = new PaintFormat(range, selector.range);\n                let paintType = paintFormat.getPaintType();\n                let pArr = paintFormat.makePaintArr(paintType, darr);\n\n                this.setCellByCellProp(pArr, cb);\n            }\n        }, {type: 12, cellRange: this.selector.range});\n    }\n\n    move() {\n        this.moved.move();\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    paste(cellRange) {\n        this.changeData(() => {\n\n        }, {type: 6, cellRange: cellRange});\n    }\n\n    // what: all | text | format\n    // paste(what = 'all', error = () => {\n    // }) {\n    //\n    //     // console.log('sIndexes:', sIndexes);\n    //     // const {clipboard, selector} = this;\n    //     // if (clipboard.isClear()) return false;\n    //     // if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n    //     //\n    //     // this.changeData(() => {\n    //     //     if (clipboard.isCopy()) {\n    //     //         copyPaste.call(this, clipboard.range, selector.range, what);\n    //     //     } else if (clipboard.isCut()) {\n    //     //         cutPaste.call(this, clipboard.range, selector.range);\n    //     //     }\n    //     // });\n    //     return true;\n    // }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        }, {type: 5, cellRange: cellRange});\n\n        return true;\n    }\n\n\n    clickAutofill(srcRange, cellRange, what, error = () => {\n    }) {\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        // row index\n        if (nri <= cri) [sri, eri] = [nri, cri];\n        else eri = nri;\n        // col index\n        if (nci <= cci) [sci, eci] = [nci, cci];\n        else eci = nci;\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                const cell = rows.getCellOrNew(selector.ri, selector.ci);\n                cell.text = `=${value}()`;\n                cell.formulas = `=${value}()`;\n            } else {\n                selector.range.each((ri, ci) => {\n                    let cell = rows.getCellOrNew(ri, ci);\n\n                    let cstyle = {};\n                    if (isHave(cell.style)) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        // cell.text = cell.text.replace(\"\", \"\");\n                        // cell.formulas = cell.formulas.replace(\"\", \"\");\n                        rows.setCellText(ri, ci, {\n                            text: cell.text,\n                            style: this.addStyle(cstyle)\n                        }, 'format');\n                        // this.rows.workbook.change(ri, ci, cell, deepCopy(cell), 'change');\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'flexible') {\n                        if (this.exceptRowSet.has(ri + 1) && this.exceptRowSet.has(ri + 2) && !this.exceptRowSet.has(ri + 3)) {\n                            this.exceptRowSet.delete(ri);\n                            this.exceptRowSet.delete(ri + 1);\n                            this.exceptRowSet.delete(ri + 2);\n                        } else {\n                            this.exceptRowSet.add(ri);\n                            this.exceptRowSet.add(ri + 1);\n                            this.exceptRowSet.add(ri + 2);\n                        }\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    }\n                });\n            }\n        }, {type: 11, cellRange: this.selector.range, property, value});\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        this.setCellText(nri, ci, {text}, state);\n        this.resetAutoFilter();\n    }\n\n    // state: input | finished\n    setSelectedCell(text, state = 'input', formulas, ri, ci) {\n        this.setCellAll(ri, ci, text, formulas, state);\n        this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    editorChangeToHistory(oldCell, {ri, ci}, type) {\n        if (ri === -1 || ci === -1) {\n            return {\"state\": false}\n        }\n        let newCell = this.rows.getCell(ri, ci);\n        // if (oldCell.text === newCell.text || oldCell.formulas === newCell.text) {\n        //     return {\n        //         \"state\": false,\n        //     };\n        // }\n        let {multiPreAction} = this;\n        let expr = xy2expr(ci, ri);\n        let step = multiPreAction.getStepType(type, {ri, ci, expr, text: newCell.text});\n\n        let oc = new CellProp(ri, ci, oldCell, expr);\n        let nc = new CellProp(ri, ci, newCell, expr);\n        multiPreAction.addStep(step, {oldCell: [oc], newCell: [nc]});\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        return {\n            \"state\": true\n        }\n    }\n\n    changeToHistory({ri, type, ci, cellRange, property, value, oldCell, oldMergesData}, oldStep) {\n        if (type === -1) {\n            return {\"state\": false,}\n        }\n\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n        multiPreAction.addStep(step, {oldCell, oldMergesData, newMergesData: this.merges.getData(), oldStep,});\n        return {\n            \"state\": true\n        }\n    }\n\n    getSelectedCellRiCi(ri, ci) {\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n\n    getMoveRect(range) {\n        return this.getRect(range);\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    getCellRectByXYWithNotTotalResult(x, y) {\n        const {\n            scroll, merges,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n\n        if (ci === -1) {\n            // // width = cols.totalWidth();\n            // let args = getCellRowByAbsX.call(this, scroll.x);\n            // console.log(args);\n            // // ci = args.ci;\n        }\n        if (ri === -1) {\n            // let args = getCellRowByAbsY.call(this, scroll.y);\n            // console.log(\"1179: \", args.ri);\n            // ri = args.ri;\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    isSignleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSignleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            const cell = rows.getCellOrNew(sri, sci);\n            cell.merge = [rn - 1, cn - 1];\n            this.merges.add(selector.range);\n            // delete merge cells\n            this.rows.deleteCells(selector.range);\n            // console.log('cell:', cell, this.d);\n            this.rows.setCell(sri, sci, cell);\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSignleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                let v = selector.range.toString();\n                let eri = selector.range.eri;\n                const {rows} = this;\n\n                for (let i = selector.range.sci; i <= selector.range.eci; i++) {\n                    let range = new CellRange(selector.range.sri, i, selector.range.sri, i);\n                    range = rows.autoFilterRef(v, range);\n                    if (eri < range.eri) {\n                        eri = range.eri;\n                    }\n                }\n                let range = new CellRange(selector.range.sri, selector.range.sci, eri, selector.range.eci);\n                autoFilter.ref = range.toString();\n            }\n        });\n    }\n\n    throwFormula() {\n        const {selector, rows} = this;\n\n        this.changeData(() => {\n            selector.range.each((i, j) => {\n                const cell = rows.getCellOrNew(i, j);\n                if (cell && cell.text && cell.formulas) {\n                    rows.setCellAll(i, j, cell.text, cell.text);\n                }\n            });\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        }, {type: 2});\n    }\n\n    // type: row | column\n    insert(type, n = 1, begin = -1) {\n        const {sri, sci} = this.selector.range;\n        const {rows, merges, cols} = this;\n        if (type === 'row') {\n            begin = begin !== -1 ? begin : sri;\n        } else if ('column') {\n            begin = begin !== -1 ? begin : sci;\n        }\n\n        this.changeData(() => {\n            let si = begin;\n            if (type === 'row') {\n                rows.insert(begin, n);\n            } else if (type === 'column') {\n                rows.insertColumn(begin, n);\n                si = begin;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        }, {type: 13, data: this.getData(), property: \"insert\"});\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= 1;\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {scroll, freeze, rows} = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        // console.log('ri:', ri, ' ,y:', y1);\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getMax() {\n        let mci = this.cols.len;\n        let mri = this.rows.len;\n\n        return {\n            mri,\n            mci\n        }\n    }\n\n\n    // isEmpty(cell) {\n    //     return this.rows.isEmpty(cell);\n    // }\n\n    renderFormat(style, cell, nrindex, cindex, filter) {\n        let cellProxy = new CellProxy(cell);\n        return cellProxy.renderFormat(style, nrindex, cindex, this, filter);\n    }\n\n    isFormula(text) {\n        return this.rows.isFormula(text);\n    }\n\n    toString(text) {\n        return this.rows.toString(text);\n    }\n\n    // isBackEndFunc(text) {\n    //     return this.rows.isBackEndFunc(text);\n    // }\n\n    // isReferOtherSheet(cell) {\n    //     return this.rows.isReferOtherSheet(cell);\n    // }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    // getCellStyleHandle(index, type, cell, ri, ci) {\n    //     let style = this.styles[index];\n    //\n    //     if (style && style.format === type) {\n    //         return true;\n    //     }\n    //     return false;\n    // }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    getCellByExpr(src, table, name, inputText, pos) {\n        // let p1 = inputText.substring(0, pos);\n        // let p2 = inputText.substring(pos, inputText.length);\n        // inputText = p1 + src + p2;\n        // let workbook = parseCell2.call(table, this.viewRange(), true, inputText);\n        // return {\n        //     \"text\": workbook['Sheets'][name].A1.w ? workbook['Sheets'][name].A1.w : workbook['Sheets'][name].A1.v,\n        //     \"formulas\": p1 + `${name}!` + src + p2\n        // };\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, {text, style}, state) {\n        // text = text.replace(/\\\"/g)\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, {text: ''});\n            history.add(this.getData());\n            rows.setCellText(ri, ci, {text});\n        } else {\n            if (state === 'end') {\n                rows.setCellAll(ri, ci, text);\n            } else if (state === 'formulas') {\n                rows.setCellAll(ri, ci, text, \"-\");\n            } else if (state === 'style') {\n                rows.setCellText(ri, ci, {text, style}, 'style');\n            } else {\n                rows.setCellText(ri, ci, {text});\n                // rows.\n            }\n            //  change\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    // setCellWithFormulas(ri, ci, text, formulas, what = 'all') {\n    //     const {rows} = this;\n    //     rows.setCellAll(ri, ci, text, formulas, what);\n    // }\n\n\n    // state: input | finished\n    setCellAll(ri, ci, text, formulas, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellAll(ri, ci, '', '');\n            history.add(this.getData());\n            rows.setCellAll(ri, ci, text, formulas);\n        } else {\n            rows.setCellAll(ri, ci, text, formulas);\n            // this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text, formulas);\n    }\n\n    equationIsActive() {\n        return this.showEquation;\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        }, {type: 3, ri: ri});\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        }, {type: 4, ci: ci});\n    }\n\n    viewHeight() {\n        const {view, showToolbar} = this.settings;\n        let h = view.height();\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    viewRange2() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) offset += 1;\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                cb(i, y, rowHeight);\n                y += rowHeight;\n                if (y > this.viewHeight()) break;\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            cb(i, x, colWidth);\n            x += colWidth;\n            if (x > this.viewWidth()) break;\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    // addPicture(pic) {\n    //     const {pictures} = this;\n    //\n    // }\n\n    getChangeDataToCalc() {\n        let {multiPreAction} = this;\n        if (multiPreAction.undoItems.length <= 0) {\n            return null;\n        }\n        let lastStep = multiPreAction.undoItems[multiPreAction.undoItems.length - 1];\n        if (!isHave(lastStep)) {\n            return null;\n        }\n\n        return lastStep;\n    }\n\n    changeData(cb, {type = -1, ri = -1, ci = -1, cellRange = \"\", property = \"\", value = \"\"} = -1) {\n        if (this.settings.showEditor === false) {\n            return;\n        }\n\n        let oldCell = {};\n        let oldMergesData = this.merges.getData();\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n\n        if (cellRange !== \"\") {\n            let {multiPreAction} = this;\n            oldCell = multiPreAction.eachRange(cellRange);\n        }\n        cb();\n        this.changeToHistory({type, ri, ci, cellRange, property, value, oldCell, oldMergesData, newData: this.getData(), }, step);\n        this.changeDataForCalc = this.getChangeDataToCalc();\n\n        this.change(this.getData());\n    }\n\n    cutPaste(srcCellRange, dstCellRange, cleard = true) {\n        cutPaste.call(this, srcCellRange, dstCellRange, cleard);\n    }\n\n    setData(d, sheet = \"\", out = false) {\n        const {autoFilter} = this;\n        Object.keys(d).forEach((property) => {\n            // this.judgeAutoWidth(d.rows);\n            if (property === 'merges'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'flex') {\n                autoFilter.addFiexRows(d[property]);\n            } else if (property === 'rows') {\n                this[property].setData(d[property], sheet, out, this.settings.rowsInit);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'pictures') {\n                if (d[property]) {\n                    processPasteDirectionsArr.call(this, d[property], 'from', sheet);\n                }\n            } else if (property === 'autofilter') {\n                if (d[property] && d[property].ref) {\n                    autoFilter.ref = d[property].ref;\n                    autoFilter.filters = d[property].filters;\n                    autoFilter.sort = d[property].sort;\n                }\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    selectorCellText(ri, ci, text, event_type) {\n        return selectorCellText.call(this, ri, ci, text, event_type);\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter, pasteDirectionsArr,\n        } = this;\n        return {\n            editor: this.settings.showEditor,\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            pictures: processPasteDirectionsArr(pasteDirectionsArr, 'to'),\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n}\n","export default {\n    toolbar: {\n        undo: '',\n        redo: '',\n        paintformat: '',\n        clearformat: '',\n        format: '',\n        font: '',\n        fontSize: '',\n        fontBold: '',\n        fontItalic: '',\n        underline: '',\n        strike: '',\n        textColor: '',\n        fillColor: '',\n        border: '',\n        merge: '',\n        align: '',\n        valign: '',\n        textwrap: '',\n        freeze: '',\n        autofilter: '',\n        add: '',\n        calc: '',\n        formula: '',\n        more: '',\n        throwFormula: '',\n        comeBack: '',\n    },\n    revision: {\n        comeBack: '',\n    },\n    contextmenu: {\n        copy: '',\n        cut: '',\n        paste: '',\n        pasteValue: '',\n        pasteFormat: '',\n        insertRow: '',\n        insertColumn: '',\n        deleteRow: '',\n        deleteColumn: '',\n        deleteCell: '',\n        deleteCellText: '',\n        validation: '',\n        errorPop: '',\n        recover: '',\n    },\n    format: {\n        normal: '',\n        text: '',\n        number: '',\n        percent: '',\n        rmb: '',\n        usd: '',\n        date: '',\n        time: '',\n        datetime: '',\n        duration: '',\n    },\n    date_formula: {\n        sum: '',\n        average: '',\n        max: '',\n        min: '',\n        concat: '',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: '',\n        notMatch: '',\n        between: ' {}  {} ',\n        notBetween: ' {}  {} ',\n        notIn: '',\n        equal: ' {}',\n        notEqual: ' {}',\n        lessThan: ' {}',\n        lessThanEqual: ' {}',\n        greaterThan: ' {}',\n        greaterThanEqual: ' {}',\n    },\n    error: {\n        pasteForMergedCell: '',\n    },\n    calendar: {\n        weeks: ['', '', '', '', '', '', ''],\n        months: ['', '', '', '', '', '', '', '', '', '', '', ''],\n    },\n    button: {\n        cancel: '',\n        remove: '',\n        save: '',\n        ok: '',\n    },\n    sort: {\n        desc: '',\n        asc: '',\n    },\n    filter: {\n        empty: '',\n    },\n    dataValidation: {\n        mode: '',\n        range: '',\n        criteria: '',\n        modeType: {\n            cell: '',\n            column: '',\n            row: '',\n        },\n        type: {\n            list: '',\n            number: '',\n            date: '',\n            phone: '',\n            email: '',\n        },\n        operator: {\n            be: '',\n            nbe: '',\n            lt: '',\n            lte: '',\n            gt: '',\n            gte: '',\n            eq: '',\n            neq: '',\n        },\n    },\n};\n\n","import {debugout} from \"./debugout\";\nlet bugout = \"\";\ntry {\n    bugout = new debugout();\n} catch (e) {\n    console.error(e);\n}\n\nexport {\n    bugout,\n}","/*\n\n    debugout.js\n    by @inorganik\n    \n*/\n\n\n// save all the console.logs\nexport function debugout() {\n    var self = this;\n\n    // OPTIONS\n    self.realTimeLoggingOn = true; // log in real time (forwards to console.log)\n    self.useTimestamps = false; // insert a timestamp in front of each log\n    self.useLocalStorage = true; // store the output using window.localStorage() and continuously add to the same log each session\n    self.recordLogs = true; // set to false after you're done debugging to avoid the log eating up memory\n    self.autoTrim = true; // to avoid the log eating up potentially endless memory\n    self.maxLines = 2500; // if autoTrim is true, this many most recent lines are saved\n    self.tailNumLines = 100; // how many lines tail() will retrieve\n    self.logFilename = 'debugout.txt'; // filename of log downloaded with downloadLog()\n\n    // vars\n    self.depth = 0;\n    self.parentSizes = [0];\n    self.currentResult = '';\n    self.startTime = new Date();\n    self.output = '';\n\n    this.version = function () {\n        return '0.5.0'\n    }\n\n    /*\n        USER METHODS\n    */\n    this.getLog = function () {\n        var retrievalTime = new Date();\n        // if recording is off, so dev knows why they don't have any logs\n        if (!self.recordLogs) {\n            self.log('[debugout.js] log recording is off.');\n        }\n        // if using local storage, get values\n        if (self.useLocalStorage) {\n            var saved = window.localStorage.getItem('debugout.js');\n            if (saved) {\n                saved = JSON.parse(saved);\n                self.startTime = new Date(saved.startTime);\n                self.output = saved.log;\n                retrievalTime = new Date(saved.lastLog);\n            }\n        }\n        return self.output\n            + '\\n---- Log retrieved: ' + retrievalTime + ' ----\\n'\n            + self.formatSessionDuration(self.startTime, retrievalTime);\n    }\n    // accepts optional number or uses the default for number of lines\n    this.tail = function (numLines) {\n        var numLines = numLines || self.tailLines;\n        return self.trimLog(self.getLog(), numLines);\n    }\n    // accepts a string to search for\n    this.search = function (string) {\n        var lines = self.output.split('\\n');\n        var rgx = new RegExp(string);\n        var matched = [];\n        // can't use a simple Array.prototype.filter() here\n        // because we need to add the line number\n        for (var i = 0; i < lines.length; i++) {\n            var addr = '[' + i + '] ';\n            if (lines[i].match(rgx)) {\n                matched.push(addr + lines[i]);\n            }\n        }\n        var result = matched.join('\\n');\n        if (result.length == 0) result = 'Nothing found for \"' + string + '\".';\n        return result\n    }\n    // accepts the starting line and how many lines after the starting line you want\n    this.getSlice = function (lineNumber, numLines) {\n        var lines = self.output.split('\\n');\n        var segment = lines.slice(lineNumber, lineNumber + numLines);\n        return segment.join('\\n');\n    }\n    // immediately downloads the log - for desktop browser use\n    this.downloadLog = function () {\n        var file = \"data:text/plain;charset=utf-8,\";\n        var logFile = self.getLog();\n        var encoded = encodeURIComponent(logFile);\n        file += encoded;\n        var a = document.createElement('a');\n        a.href = file;\n        a.target = '_blank';\n        a.download = self.logFilename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    }\n    // clears the log\n    this.clear = function () {\n        var clearTime = new Date();\n        self.output = '---- Log cleared: ' + clearTime + ' ----\\n';\n        if (self.useLocalStorage) {\n            // local storage\n            var saveObject = {\n                startTime: self.startTime,\n                log: self.output,\n                lastLog: clearTime\n            }\n            saveObject = JSON.stringify(saveObject);\n            window.localStorage.setItem('debugout.js', saveObject);\n        }\n        if (self.realTimeLoggingOn) console.log('[debugout.js] clear()');\n    }\n    // records a log\n    this.log = function (obj) {\n        // log in real time\n        if (self.realTimeLoggingOn) console.log(obj);\n        // record log\n        var type = self.determineType(obj);\n        if (type != null && self.recordLogs) {\n            var addition = obj;\n            // timestamp, formatted for brevity\n            if (self.useTimestamps) {\n                var logTime = new Date();\n                self.output += self.formatTimestamp(logTime);\n            }\n            self.output += addition + '\\n';\n            if (self.autoTrim) self.output = self.trimLog(self.output, self.maxLines);\n            // local storage\n            if (self.useLocalStorage) {\n                var last = new Date();\n                var saveObject = {\n                    startTime: self.startTime,\n                    log: self.output,\n                    lastLog: last\n                }\n                saveObject = JSON.stringify(saveObject);\n                window.localStorage.setItem('debugout.js', saveObject);\n            }\n        }\n        self.depth = 0;\n        self.parentSizes = [0];\n        self.currentResult = '';\n    }\n    /*\n        METHODS FOR CONSTRUCTING THE LOG\n    */\n\n    // like typeof but classifies objects of type 'object'\n    // kept separate from formatType() so you can use at your convenience!\n    this.determineType = function (object) {\n        if (object != null) {\n            var typeResult;\n            var type = typeof object;\n            if (type == 'object') {\n                var len = object.length;\n                if (len == null) {\n                    if (typeof object.getTime == 'function') {\n                        typeResult = 'Date';\n                    }\n                    else if (typeof object.test == 'function') {\n                        typeResult = 'RegExp';\n                    }\n                    else {\n                        typeResult = 'Object';\n                    }\n                } else {\n                    typeResult = 'Array';\n                }\n            } else {\n                typeResult = type;\n            }\n            return typeResult;\n        } else {\n            return null;\n        }\n    }\n    // format type accordingly, recursively if necessary\n    this.formatType = function (type, obj) {\n        switch (type) {\n            case 'Object' :\n                self.currentResult += '{\\n';\n                self.depth++;\n                self.parentSizes.push(self.objectSize(obj));\n                var i = 0;\n                for (var prop in obj) {\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    self.currentResult += prop + ': ';\n                    var subtype = self.determineType(obj[prop]);\n                    var subresult = self.formatType(subtype, obj[prop]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    }\n                    i++;\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += self.indentsForDepth(self.depth);\n                self.currentResult += '}';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'Array' :\n                self.currentResult += '[';\n                self.depth++;\n                self.parentSizes.push(obj.length);\n                for (var i = 0; i < obj.length; i++) {\n                    var subtype = self.determineType(obj[i]);\n                    if (subtype == 'Object' || subtype == 'Array') self.currentResult += '\\n' + self.indentsForDepth(self.depth);\n                    var subresult = self.formatType(subtype, obj[i]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype == 'Array') self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype != 'Object') self.currentResult += '\\n';\n                        else if (i == self.parentSizes[self.depth] - 1) self.currentResult += '\\n';\n                    }\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += ']';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'function' :\n                obj += '';\n                var lines = obj.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    if (lines[i].match(/\\}/)) self.depth--;\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    if (lines[i].match(/\\{/)) self.depth++;\n                    self.currentResult += lines[i] + '\\n';\n                }\n                return self.currentResult;\n                break;\n            case 'RegExp' :\n                return '/' + obj.source + '/';\n                break;\n            case 'Date' :\n            case 'string' :\n                if (self.depth > 0 || obj.length == 0) {\n                    return '\"' + obj + '\"';\n                } else {\n                    return obj;\n                }\n            case 'boolean' :\n                if (obj) return 'true';\n                else return 'false';\n            case 'number' :\n                return obj + '';\n                break;\n        }\n    }\n    this.indentsForDepth = function (depth) {\n        var str = '';\n        for (var i = 0; i < depth; i++) {\n            str += '\\t';\n        }\n        return str;\n    }\n    this.trimLog = function (log, maxLines) {\n        var lines = log.split('\\n');\n        if (lines.length > maxLines) {\n            lines = lines.slice(lines.length - maxLines);\n        }\n        return lines.join('\\n');\n    }\n    this.lines = function () {\n        return self.output.split('\\n').length;\n    }\n    // calculate testing time\n    this.formatSessionDuration = function (startTime, endTime) {\n        var msec = endTime - startTime;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        var hrs = ('0' + hh).slice(-2);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        var mins = ('0' + mm).slice(-2);\n        msec -= mm * 1000 * 60;\n        var ss = Math.floor(msec / 1000);\n        var secs = ('0' + ss).slice(-2);\n        msec -= ss * 1000;\n        return '---- Session duration: ' + hrs + ':' + mins + ':' + secs + ' ----'\n    }\n    this.formatTimestamp = function (timestamp) {\n        var year = timestamp.getFullYear();\n        var date = timestamp.getDate();\n        var month = ('0' + (timestamp.getMonth() + 1)).slice(-2);\n        var hrs = Number(timestamp.getHours());\n        var mins = ('0' + timestamp.getMinutes()).slice(-2);\n        var secs = ('0' + timestamp.getSeconds()).slice(-2);\n        return '[' + year + '-' + month + '-' + date + ' ' + hrs + ':' + mins + ':' + secs + ']: ';\n    }\n    this.objectSize = function (obj) {\n        var size = 0, key;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n    }\n\n    /*\n        START/RESUME LOG\n    */\n    if (self.useLocalStorage) {\n        var saved = window.localStorage.getItem('debugout.js');\n        if (saved) {\n            saved = JSON.parse(saved);\n            self.output = saved.log;\n            var start = new Date(saved.startTime);\n            var end = new Date(saved.lastLog);\n            self.output += '\\n---- Session end: ' + saved.lastLog + ' ----\\n';\n            self.output += self.formatSessionDuration(start, end);\n            self.output += '\\n\\n';\n        }\n    }\n    self.output += '---- Session started: ' + self.startTime + ' ----\\n\\n';\n}","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\nimport zhCN from './locale/zh-cn';\nimport {bugout} from \"./log/log_proxy\";\nimport Drag from \"./external/drag\";\n\nclass Spreadsheet {\n    constructor(selectors, options = {}, methods = {}, alias = 'sheet1') {\n        let targetEl = selectors;\n          if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.locale('zh-cn', zhCN);\n        this.data = new DataProxy(alias, options, methods);\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n\n        this.sheet = new Sheet(rootEl, this.data);\n        this.data.sheet = this.sheet;\n    }\n\n    setDataSettings(value) {\n        this.data.settings.showEditor = value;\n    }\n\n    loadData(data) {\n        this.sheet.loadData(data);\n        return this;\n    }\n\n    getData() {\n        return this.data.getData();\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.data.change = cb;\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n\n    locale(lang, message) {\n        locale(lang, message);\n    }\n\n    // getEditorStatus() {\n    //     let {editor} = this.sheet;\n    //     let { ri, ci, pos} = editor;\n    //     let inputText = editor.editorText.getText();\n    //\n    //     return  {\n    //         \"status\": editor.isDisplay(),\n    //         \"inputText\": inputText,\n    //         \"ri\": ri,\n    //         \"ci\": ci,\n    //         \"pos\": pos,\n    //     };\n    // }\n\n    // setEditorText(text = '', pos = 1) {\n    //     let {editor} = this.sheet;\n    //     text = text !== '' ? text : '=';\n    //     editor.inputEventHandler(text, pos, true);\n    // }\n    //\n    // setTextEnd(cell, ri, ci) {\n    //     let {editor, data} = this.sheet;\n    //     editor.setCellEnd({\n    //         text: cell.text,\n    //         formulas: cell.formulas\n    //     });\n    //     data.setCellAll(ri, ci, cell.formulas + \"\", cell.formulas + \"\", '');\n    //\n    //     this.sheet.selectorEditorReset(ri, ci);\n    //\n    //     setTimeout(() => {\n    //         editor.setCursorPos(cell.formulas.length);\n    //     }, 100)\n    // }\n\n    getText(alias, inputText, pos) {\n        let {selectors, data, table} = this.sheet;\n        let text = \"\";\n        for(let i = 0; i < selectors.length; i++) {\n            let {erpx} = selectors[i];\n            text += erpx;\n        }\n\n        return data.getCellByExpr(text, table, alias, inputText, pos);\n    }\n\n    removeEvent() {\n        this.sheet.removeEvent();\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.jsSpreadsheet = require('js-spreadsheet');\n    window.drag = Drag;\n    window.x = window.x || {};\n    window.bugout = bugout;\n    window.x.spreadsheet = spreadsheet;\n    window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\n// export default Spreadsheet;\nexport {\n    spreadsheet,\n};\n","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nclass Range{\n    constructor(str_expression, formula, possition_i){\n        var range_expression, sheet_name, sheet;\n        this.start_pst = possition_i - str_expression.length\n        this.end_pst = possition_i\n\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            range_expression = aux[1];\n            this.range_start_pst = possition_i - aux[1].length\n        }\n        else {\n            sheet_name = formula.sheet_name;\n            range_expression = str_expression;\n            this.range_start_pst = this.start_pst\n\n        }\n        this.sheet = formula.wb.Sheets[sheet_name];\n        this.range_expression = range_expression\n        this.sheet_name = sheet_name\n        this.formula = formula\n\n    }\n    calc(){\n        let sheet_name = this.sheet_name\n        let sheet = this.sheet\n        let range_expression = this.range_expression\n        let formula = this.formula\n        var arr = range_expression.split(':');\n        var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n        var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n        var max_row;\n        if (str_max_row === '' && sheet['!ref']) {\n            str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n        }\n        // the max is 1048576, but TLE\n        max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n        var min_col = col_str_2_int(arr[0]);\n        var max_col = col_str_2_int(arr[1]);\n        var matrix = [];\n        for (var i = min_row; i <= max_row; i++) {\n            var row = [];\n            matrix.push(row);\n            for (var j = min_col; j <= max_col; j++) {\n                var cell_name = int_2_col_str(j) + i;\n                var cell_full_name = sheet_name + '!' + cell_name;\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]);\n                    }\n                    else if (formula.formula_ref[cell_full_name].status === 'working') {\n                        throw new Error('Circular ref');\n                    }\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        return matrix;\n\n    }\n\n}\n\nmodule.exports = Range\n//     function Range(str_expression, formula) { // Range ; calc\n//     var range_expression, sheet_name, sheet;\n//     if (str_expression.indexOf('!') != -1) {\n//         var aux = str_expression.split('!');\n//         sheet_name = getSanitizedSheetName(aux[0]);\n//         range_expression = aux[1];\n//     }\n//     else {\n//         sheet_name = formula.sheet_name;\n//         range_expression = str_expression;\n//     }\n//     sheet = formula.wb.Sheets[sheet_name];\n//     this.range_expression = range_expression\n//     this.sheet_name = sheet_name\n//     console.log(this.range_expression)\n//\n//     this.calc = function() {\n//         var arr = range_expression.split(':');\n//         var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n//         var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n//         var max_row;\n//         if (str_max_row === '' && sheet['!ref']) {\n//             str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n//         }\n//         // the max is 1048576, but TLE\n//         max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n//         var min_col = col_str_2_int(arr[0]);\n//         var max_col = col_str_2_int(arr[1]);\n//         var matrix = [];\n//         for (var i = min_row; i <= max_row; i++) {\n//             var row = [];\n//             matrix.push(row);\n//             for (var j = min_col; j <= max_col; j++) {\n//                 var cell_name = int_2_col_str(j) + i;\n//                 var cell_full_name = sheet_name + '!' + cell_name;\n//                 if (formula.formula_ref[cell_full_name]) {\n//                     if (formula.formula_ref[cell_full_name].status === 'new') {\n//                         formula.exec_formula(formula.formula_ref[cell_full_name]);\n//                     }\n//                     else if (formula.formula_ref[cell_full_name].status === 'working') {\n//                         throw new Error('Circular ref');\n//                     }\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else if (sheet[cell_name]) {\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else {\n//                     row.push(null);\n//                 }\n//             }\n//         }\n//         return matrix;\n//     };\n// };\n","var utils = require('./utils');\nvar error = require('./error');\nvar numeral = require('numeral');\n\n//TODO\nexports.ASC = function(str) {\n  var tmp = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 65248 && str.charCodeAt(i) < 65375) {\n      tmp += String.fromCharCode(str.charCodeAt(i) - 65248);\n    }\n    else {\n      tmp += String.fromCharCode(str.charCodeAt(i));\n    }\n  }\n  return tmp\n};\n\n//TODO\nexports.BAHTTEXT = function() {\n throw new Error('BAHTTEXT is not implemented');\n};\n\nexports.CHAR = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return String.fromCharCode(number);\n};\n\nexports.CLEAN = function(text) {\n  text = text || '';\n  var re = /[\\0-\\x1F]/g;\n  return text.replace(re, \"\");\n};\n\nexports.CODE = function(text) {\n  text = text || '';\n  return text.charCodeAt(0);\n};\n\nexports.CONCATENATE = function() {\n  var args = utils.flatten(arguments);\n\n  var trueFound = 0;\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE';\n  }\n\n  var falseFound = 0;\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE';\n  }\n\n  return args.join('');\n};\n\n//TODO\nexports.DBCS = function() {\n throw new Error('DBCS is not implemented');\n};\n\nexports.DOLLAR = function(number, decimals) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n  var format = '';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n    format = '($0,0)';\n  } else if (decimals > 0) {\n    format = '($0,0.' + new Array(decimals + 1).join('0') + ')';\n  }\n  return numeral(number).format(format);\n};\n\nexports.EXACT = function(text1, text2) {\n  return text1 === text2;\n};\n\nexports.FIND = function (find_text, within_text, position) {\n  position = (position === undefined) ? 0 : position;\n  within_text.indexOf(find_text)\n  return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n};\nexports.FIXED = function(number, decimals, no_commas) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n  no_commas = (no_commas === undefined) ? false : no_commas;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n\n  var format = no_commas ? '0' : '0,0';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n  } else if (decimals > 0) {\n    format += '.' + new Array(decimals + 1).join('0');\n  }\n  return numeral(number).format(format);\n};\n\nexports.HTML2TEXT = function (value) {\n  var result = '';\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach(function (line) {\n        if (result !== '') {\n          result += '\\n';\n        }\n        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\n      });\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '');\n    }\n  }\n\n  return result;\n};\nexports.INDEX = function (matrix, row_num, column_num) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n  return matrix[row_num][column_num-1]\n};\nexports.LEFT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.substring(0, number) : null;\n};\n\nexports.LEN = function(text) {\n  if (arguments.length === 0) {\n    return error.error;\n  }\n\n  if (typeof text === 'string') {\n    return text ? text.length : 0;\n  }\n\n  if (text.length) {\n    return text.length;\n  }\n\n  return error.value;\n};\n\nexports.LOWER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.toLowerCase() : text;\n};\n\nexports.MID = function(text, start, number) {\n  start = utils.parseNumber(start);\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number;\n  }\n\n  var begin = start - 1;\n  var end = begin + number;\n\n  return text.substring(begin, end);\n};\n\n// TODO\nexports.NUMBERVALUE = function (text, decimal_separator, group_separator) {\n  decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;\n  group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;\n  if (text.indexOf('%') > 0){\n    text = text.replace('%', '')\n    return parseFloat(text)/100\n  }\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));\n};\n\n// TODO\nexports.PRONETIC = function() {\n throw new Error('PRONETIC is not implemented');\n};\n\nexports.PROPER = function(text) {\n  if (text === undefined || text.length === 0) {\n    return error.value;\n  }\n  if (text === true) {\n    text = 'TRUE';\n  }\n  if (text === false) {\n    text = 'FALSE';\n  }\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value;\n  }\n  if (typeof text === 'number') {\n    text = '' + text;\n  }\n\n  return text.replace(/\\w\\S*/g, function(txt) {\n    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n  });\n};\n\nexports.REGEXEXTRACT = function (text, regular_expression) {\n  var match = text.match(new RegExp(regular_expression));\n  return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\n};\n\nexports.REGEXMATCH = function (text, regular_expression, full) {\n  var match = text.match(new RegExp(regular_expression));\n  return full ? match : !!match;\n};\n\nexports.REGEXREPLACE = function (text, regular_expression, replacement) {\n  return text.replace(new RegExp(regular_expression), replacement);\n};\n\nexports.REPLACE = function(text, position, length, new_text) {\n  position = utils.parseNumber(position);\n  length = utils.parseNumber(length);\n  if (utils.anyIsError(position, length) ||\n    typeof text !== 'string' ||\n    typeof new_text !== 'string') {\n    return error.value;\n  }\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n};\n\nexports.REPT = function(text, number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return new Array(number + 1).join(text);\n};\n\nexports.RIGHT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return text ? text.substring(text.length - number) : null;\n};\n\nexports.SEARCH = function(find_text, within_text, position) {\n  var foundAt;\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value;\n  }\n  position = (position === undefined) ? 0 : position;\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\n  return (foundAt === 0)?error.value:foundAt;\n};\n\nexports.SPLIT = function (text, separator) {\n  return text.split(separator);\n};\n\nexports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\n  if (!text || !old_text || !new_text) {\n    return text;\n  } else if (occurrence === undefined) {\n    return text.replace(new RegExp(old_text, 'g'), new_text);\n  } else {\n    var index = 0;\n    var i = 0;\n    while (text.indexOf(old_text, index) > 0) {\n      index = text.indexOf(old_text, index + 1);\n      i++;\n      if (i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n      }\n    }\n  }\n};\n\nexports.T = function(value) {\n  if (value == 'TRUE' || value == 'FALSE'){\n    return ''\n  }\n  return (typeof value === \"string\") ? value : '';\n};\n\n// TODO incomplete implementation\nfunction num2e(num){\n  var p = Math.floor(Math.log(num)/Math.LN10);\n  var n = num * Math.pow(10, -p);\n  if (p.toString().length < 10){\n    p = '0' + p\n  }\n  return n + 'E+' + p;\n}\nfunction allzero(num){\n  num = num.toString()\n  for (var i=0;i<num.length;i++){\n    if (num[i] != '0'){\n      return false\n    }\n  }\n  return true\n}\nfunction decimalsToFractional(decimals){\n  formatDecimals = decimals.toFixed(2);\n  var denominator = 3;//\n  var numerator  = formatDecimals*3;//\n  var bigger = 0;\n  function  recursion (){\n    bigger = denominator>numerator?denominator:numerator;\n    for(let i=bigger;i>1;i--){\n      if(Number.isInteger(numerator/i)&&Number.isInteger(denominator/i)){\n        numerator=numerator/i;\n        denominator=denominator/i;\n        recursion();\n      }\n    }\n  }\n  recursion();\n  numerator = parseInt(numerator)\n  return `${numerator}/${denominator}`\n}\nexports.TEXT = function (value, format) {\n  try{\n    if (format.indexOf('%') >= 0){\n      var fixed = format.split('.')[1].length-1\n      return (parseFloat(value) *100).toFixed(fixed) + '%'\n    }\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    var result = Formulas.TEXT(value, format);\n    console.log(result)\n  }catch (e) {\n    var result = undefined\n  }\n  if (result == undefined){\n    if (format.indexOf('#') >= 0 && format.indexOf('?/?') >=0){\n      var x = parseFloat(value) - parseInt(value);\n      if (parseInt(value) != 0){\n        return parseInt(value) + ' ' + decimalsToFractional(x)\n      }\n      return decimalsToFractional(x)\n    }\n    if (format.indexOf('E+') >=0){\n      return num2e(value)\n    }else if(allzero(value)){\n      var result = ''\n      for (var i=0;i<format.length-value.length; i++){\n        result += '0'\n      }\n      return result + value\n    }else if (format.indexOf('#') >=0){\n      var fmt = format\n      if (format.indexOf('[')>=0 && format.indexOf(';')>=0){\n        var valid = format.split('#')[0]\n        fmt = format.split(']')[1].split(';')\n        valid = valid.replace('[', '').replace(']', '')\n        if (eval(value + valid)){\n          fmt = fmt[0]\n        }else {\n          fmt = fmt[1]\n        }\n      }\n      if (format.indexOf('#') >=0 && format.indexOf('.' >=0) && format.indexOf('0') >=0 && format.indexOf('') <=0){\n        if (value.toString().split('.')[1].length > format.split('.')[1].length){\n          value = value.toFixed(format.split('.')[1].length)\n        }\n        value = value.toString()\n        var result = ''\n        var n = 0\n        for (var i=0; i< fmt.length; i ++){\n          if (fmt[i] == '#' || fmt[i] == '0' || fmt[i] == '.'){\n            result += value[n]\n            n += 1\n          }else{\n            result += fmt[i]\n          }\n        }\n        return result\n      }\n      fmt = fmt.replace('##0', '##')\n      value = value.toString()\n      var result = ''\n      var n = 0\n      for (var i=0; i< fmt.length; i ++){\n        if (fmt[i] == '#' || fmt[i] == '0'){\n          result += value[n]\n          n += 1\n        }else{\n          result += fmt[i]\n        }\n      }\n      return result\n    }\n  }\n  return result\n};\n\nexports.TRIM = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.replace(/ +/g, ' ').trim();\n};\n\nexports.UNICHAR = function (text) {\n  if (text == 0){\n    return error.value\n  }\n  return String.fromCharCode(text);\n};\n\nexports.UNICODE = function (text){\n  return text.charCodeAt(0)\n}\n\nexports.UPPER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.toUpperCase();\n};\n\nexports.VALUE = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return numeral().unformat(text);\n};\n","var error = require('./error');\n\n// TODO\nexports.CELL = function() {\n throw new Error('CELL is not implemented');\n};\n\nexports.ERROR = {};\nexports.ERROR.TYPE = function (error_val) {\n  switch (error_val) {\n    case error.nil.message:\n      return 1;\n    case error.div0.message:\n      return 2;\n    case error.value.message:\n      return 3;\n    case error.ref.message:\n      return 4;\n    case error.name.message:\n      return 5;\n    case error.num.message:\n      return 6;\n    case error.na.message:\n      return 7;\n    case error.data.message:\n      return 8;\n  }\n  return error.na;\n};\n\n// TODO\nexports.INFO = function() {\n throw new Error('INFO is not implemented');\n};\n\nexports.ISBLANK = function(value) {\n  return value === null;\n};\n\nexports.ISBINARY = function (number) {\n  return (/^[01]{1,10}$/).test(number);\n};\n\nexports.ISERR = function(value) {\n  return ([error.value.message, error.ref.message, error.div0.message, error.num.message, error.name.message, error.nil.message]).indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\n};\n\nexports.ISERROR = function(value) {\n  return exports.ISERR(value) || value === error.na;\n};\n\nexports.ISEVEN = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? false : true;\n};\n\n// TODO\nexports.ISFORMULA = function() {\n  throw new Error('ISFORMULA is not implemented');\n};\n\nexports.ISLOGICAL = function(value) {\n  if(value == 'FALSE'){\n    return false\n  }\n  return value == true || value == false;\n};\n\nexports.ISNA = function(value) {\n  return value === error.na || value === error.na.message;;\n};\n\nexports.ISNONTEXT = function(value) {\n  return typeof(value) !== 'string';\n};\n\nexports.ISNUMBER = function(value) {\n  return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\n};\n\nexports.ISODD = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? true : false;\n};\n\n// TODO\nexports.ISREF = function() {\n  return arguments['0'] != null\n};\n\nexports.ISTEXT = function(value) {\n  return typeof(value) === 'string';\n};\n\nexports.N = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return value;\n  }\n  if (value instanceof Date) {\n    return value.getTime();\n  }\n  if (value === true || value.toString().toUpperCase() == 'TRUE' || value.toString().toUpperCase() == 'FALSE') {\n    return 1;\n  }\n  if (value === false || typeof(value)=='string') {\n    return 0;\n  }\n  if (ISERROR(value)) {\n    return value;\n  }\n  return 0;\n};\n\nexports.NA = function() {\n  return error.na;\n};\n\n\n// TODO\nexports.SHEET = function() {\n  throw new Error('SHEET is not implemented');\n};\n\n// TODO\nexports.SHEETS = function() {\n  throw new Error('SHEETS is not implemented');\n};\n\nexports.TYPE = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return 1;\n  }\n  // if (typeof(value) !== 'string' && isNaN(value)){\n  //   return error.value\n  // }\n  if (typeof(value) === 'string') {\n    if (value.slice(0,1) == '{'){\n      var arr = utils.strToMatrix(value)\n      if (Array.isArray(arr)) {\n        return 64;\n      }\n    }else{\n      return 2\n    }\n  }\n  if(value == 'FALSE'){\n    return false\n  }\n  if (value == true || value == false) {\n    return 4;\n  }\n  if (exports.ISERR(value) || value === error.na) {\n    return 16;\n  }\n  if (Array.isArray(arr)) {\n    return 64;\n  }\n\n};\n","var error = require('./error');\nvar utils = require('./utils');\n\nvar d1900 = new Date(1900, 0, 1);\nvar WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n];\nvar WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n];\nvar WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined, [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n];\n\nexports.DATE = function(year, month, day) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.DATE(year, month, day)\n  // year = utils.parseNumber(year);\n  // month = utils.parseNumber(month);\n  // day = utils.parseNumber(day);\n  // if (utils.anyIsError(year, month, day)) {\n  //   return error.value;\n  // }\n  // if (year < 0 || month < 0 || day < 0) {\n  //   return error.num;\n  // }\n  // var date = new Date(year, month - 1, day);\n  // return date;\n};\n\nexports.DATEVALUE = function(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value;\n  }\n  var date = Date.parse(date_text);\n  if (isNaN(date)) {\n    return error.value;\n  }\n  if (date <= -2203891200000) {\n    return (date - d1900) / 86400000 + 1;\n  }\n  return (date - d1900) / 86400000 + 2;\n};\n\nexports.DAY = function(serial_number) {\n  var date = utils.parseDate(serial_number);\n  if (date instanceof Error) {\n    return date;\n  }\n  return date.getDate();\n};\n\nexports.DAYS = function(end_date, start_date) {\n  end_date = utils.parseDate(end_date);\n  start_date = utils.parseDate(start_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  return serial(end_date) - serial(start_date);\n};\n\nexports.DAYS360 = function(start_date, end_date, method) {\n  method = utils.parseBool(method);\n  start_date = utils.parseDate(start_date);\n  end_date = utils.parseDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (method instanceof Error) {\n    return method;\n  }\n  var sm = start_date.getMonth();\n  var em = end_date.getMonth();\n  var sd, ed;\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();\n  } else {\n    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();\n    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate();\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++;\n        ed = 1;\n      } else {\n        ed = 30;\n      }\n    } else {\n      ed = end_date.getDate();\n    }\n  }\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) +\n    30 * (em - sm) + (ed - sd);\n};\n\nexports.EDATE = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  start_date.setMonth(start_date.getMonth() + months);\n  return serial(start_date);\n};\n\nexports.EOMONTH = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n};\n\nexports.HOUR = function(serial_number) {\n  if (typeof serial_number === 'number' && !isNaN(serial_number)){\n    //XW: \n    return parseInt((parseFloat(serial_number)-parseInt(serial_number)) * 24)\n    //XW: end\n  }\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getHours();\n};\n\nexports.INTERVAL = function (second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value;\n  } else {\n    second = parseInt(second, 10);\n  }\n\n  var year  = Math.floor(second/946080000);\n  second    = second%946080000;\n  var month = Math.floor(second/2592000);\n  second    = second%2592000;\n  var day   = Math.floor(second/86400);\n  second    = second%86400;\n\n  var hour  = Math.floor(second/3600);\n  second    = second%3600;\n  var min   = Math.floor(second/60);\n  second    = second%60;\n  var sec   = second;\n\n  year  = (year  > 0) ? year  + 'Y' : '';\n  month = (month > 0) ? month + 'M' : '';\n  day   = (day   > 0) ? day   + 'D' : '';\n  hour  = (hour  > 0) ? hour  + 'H' : '';\n  min   = (min   > 0) ? min   + 'M' : '';\n  sec   = (sec   > 0) ? sec   + 'S' : '';\n\n  return 'P' + year + month + day +\n  'T' + hour + min + sec;\n};\n\nexports.ISOWEEKNUM = function(date) {\n  date = utils.parseDate(date);\n  if (date instanceof Error) {\n    return date;\n  }\n\n  date.setHours(0, 0, 0);\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n  var yearStart = new Date(date.getFullYear(), 0, 1);\n  return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\n};\n\nexports.MINUTE = function(serial_number) {\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.MINUTE(serial_number);\n};\n\nexports.MONTH = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getMonth() + 1;\n};\n\nexports.NETWORKDAYS = function (start_date, end_date, holidays) {\n  if (holidays instanceof Array){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.NETWORKDAYS(start_date, end_date, holidays);\n};\nexports.NETWORKDAYSINTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays)[0])\n  }\n  try{\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.NETWORKDAYS$INTL(start_date, end_date, weekend, holidays);\n  }catch (e) {\n    start_date = utils.ExcelDateToJSDate(utils.parseDate(start_date));\n    end_date = utils.ExcelDateToJSDate(utils.parseDate(end_date));\n    if (start_date instanceof Error) {\n      return start_date;\n    }\n    if (end_date instanceof Error) {\n      return end_date;\n    }\n    if (weekend === undefined) {\n      weekend = WEEKEND_TYPES[1];\n    } else if (typeof weekend=='string' && weekend.length === 7) {\n      var arr = []\n      for (var i=0;i<weekend.length;i++){\n        if (weekend[i] == '1'){\n          arr.push(((i+1)>6)? 0: i+1)\n        }\n      }\n      weekend = arr\n    }else {\n      weekend = WEEKEND_TYPES[weekend];\n    }\n    if (!(weekend instanceof Array)) {\n      return error.value;\n    }\n    if (holidays === undefined) {\n      holidays = [];\n    } else if (!(holidays instanceof Array)) {\n      holidays = [holidays];\n    }\n    for (var i = 0; i < holidays.length; i++) {\n      var h = utils.parseDate(holidays[i]);\n      if (h instanceof Error) {\n        return h;\n      }\n      holidays[i] = h;\n    }\n    var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n    var total = days;\n    var day = start_date;\n    for (i = 0; i < days; i++) {\n      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n      var dec = false;\n      if (d === weekend[0] || d === weekend[1]) {\n        dec = true;\n      }\n      for (var j = 0; j < holidays.length; j++) {\n        var holiday = holidays[j];\n        if (holiday.getDate() === day.getDate() &&\n          holiday.getMonth() === day.getMonth() &&\n          holiday.getFullYear() === day.getFullYear()) {\n          dec = true;\n          break;\n        }\n      }\n      if (dec) {\n        total--;\n      }\n      day.setDate(day.getDate() + 1);\n    }\n    return total;\n  }\n};\n\n\nexports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays))\n  }\n  start_date = utils.ExcelDateToJSDate(start_date);\n  end_date = utils.ExcelDateToJSDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n  var total = days;\n  var day = start_date;\n  for (i = 0; i < days; i++) {\n    var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n    var dec = false;\n    if (d === weekend[0] || d === weekend[1]) {\n      dec = true;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()) {\n        dec = true;\n        break;\n      }\n    }\n    if (dec) {\n      total--;\n    }\n    day.setDate(day.getDate() + 1);\n  }\n  return total;\n};\n\nexports.NOW = function() {\n  return new Date();\n};\n\nexports.SECOND = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getSeconds();\n};\n\nexports.TIME = function(hour, minute, second) {\n  hour = utils.parseNumber(hour);\n  minute = utils.parseNumber(minute);\n  second = utils.parseNumber(second);\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value;\n  }\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num;\n  }\n  return (3600 * hour + 60 * minute + second) / 86400;\n};\n\nexports.TIMEVALUE = function(time_text) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  try{\n    return Formulas.TIMEVALUE(time_text);\n  }catch(e){\n    return error.value\n  }\n};\n\nexports.TODAY = function() {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.TODAY()\n};\n\nexports.WEEKDAY = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  var day = serial_number.getDay();\n  return WEEK_TYPES[return_type][day];\n};\n\nexports.WEEKNUM = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  if (return_type === 21) {\n    return this.ISOWEEKNUM(serial_number);\n  }\n  var week_start = WEEK_STARTS[return_type];\n  var jan = new Date(serial_number.getFullYear(), 0, 1);\n  var inc = jan.getDay() < week_start ? 1 : 0;\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;\n  return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;\n};\n\nexports.WORKDAY = function (start_date, days, holidays) {\n  if (holidays != undefined){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.WORKDAY(start_date, days, holidays);\n};\nexports.WORKDAYINTL = function (start_date, days, weekend, holidays) {\n  // var Formulas = window.jsSpreadsheet.AllFormulas;\n  // return Formulas.WORKDAY$INTL(start_date, days, weekend, holidays);\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (weekend == 0){\n    return error.num\n  }\n  days = utils.parseNumber(days);\n  if (days instanceof Error) {\n    return days;\n  }\n  if (days < 0) {\n    return error.num;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var d = 0;\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1);\n    var day = start_date.getDay();\n    if (day === weekend[0] || day === weekend[1]) {\n      continue;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()) {\n        d--;\n        break;\n      }\n    }\n    d++;\n  }\n  var year = start_date.getFullYear();\n  var month = start_date.getMonth();\n  var day = start_date.getDay();\n  return year+ '/' + month + '/' + day;\n};\n\nexports.YEAR = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getFullYear();\n};\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1;\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);\n}\n\nexports.YEARFRAC = function(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  end_date = utils.parseDate(end_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n\n  basis = basis || 0;\n  var sd = start_date.getDate();\n  var sm = start_date.getMonth() + 1;\n  var sy = start_date.getFullYear();\n  var ed = end_date.getDate();\n  var em = end_date.getMonth() + 1;\n  var ey = end_date.getFullYear();\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30;\n        ed = 30;\n      } else if (sd === 31) {\n        sd = 30;\n      } else if (sd === 30 && ed === 31) {\n        ed = 30;\n      }\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n    case 1:\n      // Actual/actual\n      var feb29Between = function(date1, date2) {\n        var year1 = date1.getFullYear();\n        var mar1year1 = new Date(year1, 2, 1);\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true;\n        }\n        var year2 = date2.getFullYear();\n        var mar1year2 = new Date(year2, 2, 1);\n        return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);\n      };\n      var ylength = 365;\n      if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) ||\n            feb29Between(start_date, end_date) ||\n            (em === 1 && ed === 29)) {\n          ylength = 366;\n        }\n        return daysBetween(start_date, end_date) / ylength;\n      }\n      var years = (ey - sy) + 1;\n      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;\n      var average = days / years;\n      return daysBetween(start_date, end_date) / average;\n    case 2:\n      // Actual/360\n      return daysBetween(start_date, end_date) / 360;\n    case 3:\n      // Actual/365\n      return daysBetween(start_date, end_date) / 365;\n    case 4:\n      // European 30/360\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n  }\n};\n\nfunction serial(date) {\n  var addOn = (date > -2203891200000)?2:1;\n  return (date - d1900) / 86400000 + addOn;\n}","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","const RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\n\nmodule.exports = function str_2_val(buffer, formula, position_i) { // buffer \n    var v;\n    if (!isNaN(buffer)) {\n        v = new RawValue(+buffer);\n    }\n    else if (buffer === 'TRUE') {\n        v = new RawValue(1);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // \n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // \n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n    }\n    else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n        v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n    }\n    else {\n        v = buffer;\n        v.end_pst = position_i // \n    }\n    return v;\n};\n","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        var resolved_ref = self.parseRef();\n        var sheet = resolved_ref.sheet;\n        var cell_name = resolved_ref.cell_name;\n        var cell_full_name = resolved_ref.cell_full_name;\n        var ref_cell = sheet[cell_name];\n        if (!ref_cell) {\n            return null;\n        }\n        var formula_ref = formula.formula_ref[cell_full_name];\n        if (formula_ref) {\n            if (formula_ref.status === 'new') {\n                formula.exec_formula(formula_ref);\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error with new formula', cell_full_name);\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n            else if (formula_ref.status === 'working') {\n                throw new Error('Circular ref');\n            }\n            else if (formula_ref.status === 'done') {\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error after formula eval');\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n        }\n        else {\n            if (ref_cell.t === 'e') {\n                console.log('ref is an error with no formula', cell_name);\n                throw new Error(ref_cell.w);\n            }\n            return ref_cell.v;\n        }\n    };\n};\n","var categories = [\n  require('./lib/compatibility'),\n  require('./lib/database'),\n  require('./lib/engineering'),\n  require('./lib/logical'),\n  require('./lib/math-trig'),\n  require('./lib/text'),\n  require('./lib/date-time'),\n  require('./lib/financial'),\n  require('./lib/information'),\n  require('./lib/lookup-reference'),\n  require('./lib/statistical'),\n  require('./lib/miscellaneous'),\n  require('./lib/custom')\n];\n\nfor (var c in categories) {\n  var category = categories[c];\n  for (var f in category) {\n    exports[f] = exports[f] || category[f];\n  }\n}\n","var utils   = require('./utils');\nvar numeral = require('numeral');\n\nexports.UNIQUE = function () {\n  var result = [];\n  for (var i = 0; i < arguments.length; ++i) {\n    var hasElement = false;\n    var element    = arguments[i];\n\n    // Check if we've already seen this element.\n    for (var j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element;\n      if (hasElement) { break; }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\nexports.FLATTEN = utils.flatten;\n\nexports.ARGS2ARRAY = function () {\n  return Array.prototype.slice.call(arguments, 0);\n};\n\nexports.REFERENCE = function (context, reference) {\n  try {\n    var path = reference.split('.');\n    var result = context;\n    for (var i = 0; i < path.length; ++i) {\n      var step = path[i];\n      if (step[step.length - 1] === ']') {\n        var opening = step.indexOf('[');\n        var index = step.substring(opening + 1, step.length - 1);\n        result = result[step.substring(0, opening)][index];\n      } else {\n        result = result[step];\n      }\n    }\n    return result;\n  } catch (error) {}\n};\n\nexports.JOIN = function (array, separator) {\n  return array.join(separator);\n};\n\nexports.NUMBERS = function () {\n  var possibleNumbers = utils.flatten(arguments);\n  return possibleNumbers.filter(function (el) {\n    return typeof el === 'number';\n  });\n};\n\nexports.NUMERAL = function (number, format) {\n  return numeral(number).format(format);\n};","var error = require('./error');\nvar jStat = require('jStat').jStat;\nvar text = require('./text');\nvar utils = require('./utils');\nvar bessel = require('bessel');\n\nfunction isValidBinaryNumber(number) {\n  return (/^[01]{1,10}$/).test(number);\n}\n\nexports.BESSELI = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besseli(x, n);\n};\n\nexports.BESSELJ = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselj(x, n);\n};\n\nexports.BESSELK = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselk(x, n);\n};\n\nexports.BESSELY = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.bessely(x, n);\n};\n\nexports.BIN2DEC = function(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Convert binary number to decimal\n  var result = parseInt(number, 2);\n\n  // Handle negative numbers\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512;\n  } else {\n    return result;\n  }\n};\n\n\nexports.BIN2HEX = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n  }\n\n  // Convert binary number to hexadecimal\n  var result = parseInt(number, 2).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BIN2OCT = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n  }\n\n  // Convert binary number to octal\n  var result = parseInt(number, 2).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BITAND = function(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2;\n};\n\nexports.BITLSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return (shift >= 0) ? number << shift : number >> -shift;\n};\n\nexports.BITOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2;\n};\n\nexports.BITRSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return (shift >= 0) ? number >> shift : number << -shift;\n};\n\nexports.BITXOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2;\n};\n\nexports.COMPLEX = function(real, imaginary, suffix) {\n  real = utils.parseNumber(real);\n  imaginary = utils.parseNumber(imaginary);\n  //XW: \n  if (utils.anyIsError(real, imaginary)) {\n    return error.value;\n  }\n  //XWend\n\n  // Set suffix\n  suffix = (suffix === undefined) ? 'i' : suffix;\n  suffix = suffix.toLowerCase();\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value;\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0;\n  } else if (real === 0) {\n    return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\n  } else if (imaginary === 0) {\n    return real.toString();\n  } else {\n    var sign = (imaginary > 0) ? '+' : '';\n    return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\n  }\n};\n\nexports.CONVERT = function(number, from_unit, to_unit) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  var units = [\n    [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\n    [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\n    [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\n    [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\n    [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\n    [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\n    [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\n    [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\n    [\"are\", \"ar\", null, \"area\", false, true, 100],\n    [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\n    [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\n    [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\n    [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\n    [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\n    [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\n    [\"byte\", \"byte\", null, \"information\", false, true, 8],\n    [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\n    [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\n    [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\n    [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\n    [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\n    [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\n    [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\n    [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\n    [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\n    [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\n    [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\n    [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\n    [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\n    [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\n    [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\n    [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\n    [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\n    [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\n    [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\n    [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\n    [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\n    [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\n    [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\n    [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\n    [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\n    [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\n    [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\n    [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\n    [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\n    [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\n    [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\n    [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\n    [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\n    [\"henry\", \"H\", null, \"inductance\", true, false, 1],\n    [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\n    [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\n    [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\n    [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\n    [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\n    [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\n    [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\n    [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\n    [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\n    [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\n    [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\n    [\"joule\", \"J\", null, \"energy\", true, true, 1],\n    [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\n    [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\n    [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\n    [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\n    [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\n    [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\n    [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\n    [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\n    [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\n    [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\n    [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\n    [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\n    [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\n    [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\n    [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\n    [\"metre\", \"m\", null, \"length\", true, true, 1],\n    [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\n    [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\n    [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\n    [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\n    [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\n    [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\n    [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\n    [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\n    [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\n    [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1],\n    [\"newton\", \"N\", null, \"force\", true, true, 1],\n    [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\n    [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\n    [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\n    [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\n    [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\n    [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\n    [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\n    [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\n    [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\n    [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\n    [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\n    [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\n    [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\n    [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\n    [\"radian\", \"rad\", null, \"angle\", true, false, 1],\n    [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\n    [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\n    [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\n    [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\n    [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\n    [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\n    [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\n    [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\n    [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\n    [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\n    [\"square meter\", \"m?\", null, \"area\", true, true, 1],\n    [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\n    [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\n    [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\n    [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\n    [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\n    [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\n    [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\n    [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\n    [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\n    [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\n    [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\n    [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\n    [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\n    [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\n    [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\n    [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\n    [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\n    [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\n    [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\n    [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\n    [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\n    [\"volt\", \"V\", null, \"voltage\", true, false, 1],\n    [\"watt\", \"W\", null, \"power\", true, true, 1],\n    [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\n    [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\n    [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\n    [\"year\", \"yr\", null, \"time\", false, true, 31557600]\n  ];\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  var binary_prefixes = {\n    Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n    Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n    Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n    Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n    Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n    Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n    Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n    ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n  };\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  var unit_prefixes = {\n    Y: [\"yotta\", 1e+24, \"Y\"],\n    Z: [\"zetta\", 1e+21, \"Z\"],\n    E: [\"exa\", 1e+18, \"E\"],\n    P: [\"peta\", 1e+15, \"P\"],\n    T: [\"tera\", 1e+12, \"T\"],\n    G: [\"giga\", 1e+09, \"G\"],\n    M: [\"mega\", 1e+06, \"M\"],\n    k: [\"kilo\", 1e+03, \"k\"],\n    h: [\"hecto\", 1e+02, \"h\"],\n    e: [\"dekao\", 1e+01, \"e\"],\n    d: [\"deci\", 1e-01, \"d\"],\n    c: [\"centi\", 1e-02, \"c\"],\n    m: [\"milli\", 1e-03, \"m\"],\n    u: [\"micro\", 1e-06, \"u\"],\n    n: [\"nano\", 1e-09, \"n\"],\n    p: [\"pico\", 1e-12, \"p\"],\n    f: [\"femto\", 1e-15, \"f\"],\n    a: [\"atto\", 1e-18, \"a\"],\n    z: [\"zepto\", 1e-21, \"z\"],\n    y: [\"yocto\", 1e-24, \"y\"]\n  };\n\n  // Initialize units and multipliers\n  var from = null;\n  var to = null;\n  var base_from_unit = from_unit.toLowerCase();\n  var base_to_unit = to_unit.toLowerCase();\n  var from_multiplier = 1;\n  var to_multiplier = 1;\n  var alt;\n  // Lookup from and to units\n  for (var i = 0; i < units.length; i++) {\n    alt = (units[i][2] === null) ? [] : units[i][2];\n    if (units[i][1].toLowerCase() === base_from_unit || alt.indexOf(from_unit) >= 0) {\n      from = units[i];\n    }\n    if (units[i][1].toLowerCase() === base_to_unit || alt.indexOf(to_unit) >= 0) {\n      to = units[i];\n    }\n  }\n  // Lookup from prefix\n  if (from === null) {\n    var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n    var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2];\n      base_from_unit = from_unit.substring(2);\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1];\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n    }\n\n    // Lookup from unit\n    for (var j = 0; j < units.length; j++) {\n      alt = (units[j][2] === null) ? [] : units[j][2];\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j];\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n    var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2];\n      base_to_unit = to_unit.substring(2);\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1];\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n    }\n\n    // Lookup to unit\n    for (var k = 0; k < units.length; k++) {\n      alt = (units[k][2] === null) ? [] : units[k][2];\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k];\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na;\n  }\n\n  //Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    if(from_unit == 'F' && to_unit == 'C'){\n      return (number-32)/1.8\n    }\n    if(from_unit == 'C' && to_unit == 'F'){\n      return number * 1.8 + 32\n    }\n    return error.na;\n  }\n\n  // Return converted number\n  return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n};\n\nexports.DEC2BIN = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = parseInt(number, 10).toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2HEX = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = parseInt(number, 10).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2OCT = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = parseInt(number, 10).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DELTA = function(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = (number2 === undefined) ? 0 : number2;\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return delta\n  return (number1 === number2) ? 1 : 0;\n};\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexports.ERF = function(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = (upper_bound === undefined) ? 0 : upper_bound;\n\n  lower_bound = utils.parseNumber(lower_bound);\n  upper_bound = utils.parseNumber(upper_bound);\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value;\n  }\n\n  return jStat.erf(lower_bound);\n};\n\n// TODO\nexports.ERF.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERF(x)\n};\n\nexports.ERFC = function(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value;\n  }\n\n  return jStat.erfc(x);\n};\n\n// TODO\nexports.ERFC.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERFC(x)\n};\n\nexports.GESTEP = function(number, step) {\n  step = step || 0;\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(step, number)) {\n    return number;\n  }\n\n  // Return delta\n  return (number >= step) ? 1 : 0;\n};\n\nexports.HEX2BIN = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\n\n  // Convert hexadecimal number to decimal\n  var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.HEX2DEC = function(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return decimal number\n  return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\n};\n\nexports.HEX2OCT = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = decimal.toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\nexports.ROWS = function (matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\nfunction trans_num(inumber){\n  inumber = inumber.toString()\n  inumber = inumber.replace('I', 'i').replace('J', 'j')\n  return inumber\n}\nexports.IMABS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n};\n\nexports.IMAGINARY = function (inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1;\n  }\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(plus + 1, inumber.length - 1));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        -Number(inumber.substring(minus + 1, inumber.length - 1));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\n    } else {\n      return (isNaN(inumber)) ? error.num : 0;\n    }\n  }\n};\n\nexports.IMARGUMENT = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0;\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2;\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI;\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x);\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI;\n  } else {\n    return Math.atan(y / x) - Math.PI;\n  }\n};\n\nexports.IMCONJUGATE = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return conjugate of complex number\n  return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\n};\n\nexports.IMCOS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return cosine of complex number\n  return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMCOSH = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic cosine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n};\n\nexports.IMCOT = function (inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return cotangent of complex number\n  return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n};\n\nexports.IMDIV = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num;\n  }\n\n  // Return exponential of complex number\n  var den = c * c + d * d;\n  return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n};\n\nexports.IMEXP = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  var e = Math.exp(x);\n  return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n};\n\nexports.IMLN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n};\n\nexports.IMLOG10 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n};\n\nexports.IMLOG2 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n};\n\nexports.IMPOWER = function(inumber, number) {\n  inumber = trans_num(inumber)\n  number = utils.parseNumber(number);\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n  if (utils.anyIsError(number, x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var p = Math.pow(exports.IMABS(inumber), number);\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n};\n\nexports.IMPRODUCT = function() {\n  // Initialize result\n  var result = arguments[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(arguments[i]);\n    var d = exports.IMAGINARY(arguments[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n  }\n\n  // Return product of complex numbers\n  return result;\n};\n\nexports.IMREAL = function(inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0;\n  }\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, plus));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, minus));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\n    } else {\n      return (isNaN(inumber)) ? error.num : inumber;\n    }\n  }\n};\n\nexports.IMSEC = function(inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return secant of complex number\n  return exports.IMDIV('1', exports.IMCOS(inumber));\n};\n\nexports.IMSECH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return hyperbolic secant of complex number\n  return exports.IMDIV('1', exports.IMCOSH(inumber));\n};\n\nexports.IMSIN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return sine of complex number\n  return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMSINH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic sine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n};\n\nexports.IMSQRT = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var s = Math.sqrt(exports.IMABS(inumber));\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n};\n\nexports.IMCSC = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return cosecant of complex number\n  return exports.IMDIV('1', exports.IMSIN(inumber));\n};\n\nexports.IMCSCH = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return exports.IMDIV('1', exports.IMSINH(inumber));\n};\n\nexports.IMSUB = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber1 = trans_num(inumber1)\n  inumber2 = trans_num(inumber2)\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return _ of two complex numbers\n  return exports.COMPLEX(a - c, b - d, unit);\n};\n\nexports.IMSUM = function (inumber) {\n  inumber = trans_num(inumber)\n  var args = utils.flatten(arguments);\n\n  // Initialize result\n  var result = args[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(args[i]);\n    var d = exports.IMAGINARY(args[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a + c, b + d);\n  }\n\n  // Return sum of complex numbers\n  return result;\n};\n\nexports.IMTAN = function (inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return tangent of complex number\n  return exports.IMDIV(exports.IMSIN(inumber), exports.IMCOS(inumber));\n};\n\nexports.OCT2BIN = function (number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\n\n  // Convert octal number to decimal\n  var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\n\n  // Return error if number is lower than -512 or greater than 511\n  // if (decimal < -512 || decimal > 511) {\n  //     return error.num;\n  // }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n  if (result.length >=10){\n    return result.slice(result.length-10, result.length)\n  }\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.OCT2DEC = function(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Return decimal number\n  return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\n};\n\nexports.OCT2HEX = function(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = decimal.toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};","\"use strict\";\nmodule.exports = function find_all_need_calc_cell(wb, tileArr, exec_formula) {\n    var need_calc_cells = tileArr.findAllNeedCalcCell()\n    let formula_ref = {};\n    let cells = [];\n    for (let sheet_name in wb.Sheets) {\n        let sheet = wb.Sheets[sheet_name];\n        for(let i=0; i<need_calc_cells.length; i++){\n            let cell_name = need_calc_cells[i]\n            let formula = formula_ref[sheet_name + '!' + cell_name] = {\n                formula_ref: formula_ref,\n                wb: wb,\n                sheet: sheet,\n                sheet_name: sheet_name,\n                cell: sheet[cell_name],\n                name: cell_name,\n                status: 'new',\n                exec_formula: exec_formula\n            };\n            cells.push(formula);\n        }\n    }\n    return cells;\n};\n","var helper = require(\"../core/helper\")\n//XW: end\n//XW:,''\nexports.trans_params = function (cell) {\n  var reg = new RegExp('\\{(.*?)\\}', 'g')\n  var arg = cell.f.match(reg)\n  if (arg != null){\n    for (var i=0; i<arg.length; i++){\n      var param = arg[i]\n      var rep = \"'\" + param + \"'\"\n      cell.f = cell.f.replace(param, rep)\n    }\n  }\n  return cell\n}\n//XW:end\n//XW: default_0\nexports.trans_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 0 && sheet[i].f === \"\"){\n      sheet[i].v = 'default_0'\n    }\n  });\n  return sheet\n}\n\nexports.recover_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 'default_0'){\n      if (!helper.isHave(sheet[i].f)) {\n        sheet[i].f = \"\"\n      }\n      sheet[i].v = 0\n    }\n  });\n  return sheet\n}\n//XW: end\n//XW: \nexports.strim = function (str){\n  let str1 = str.replace(/\\s+$/,'');\n  let str2 = str1.replace(/^\\s+/,'')\n  return str2;\n}\n//XW end\n\n//xW: \nexports.trans_formula = function(f){\n  // FLOOR->FLOORMATH, vap-> vara\n  var trans_dict = {\n    'FLOOR': 'FLOORMATH',\n    'VAR': 'VARA',\n    'WORKDAY.INTL': 'WORKDAYINTL'\n  }\n  for(var i in trans_dict){\n    var b = trans_dict[i]\n    if (f.indexOf(b) < 0 && f.indexOf(i)>=0 && f.indexOf(i + '.') <=0){\n      f = f.replace(i, b)\n    }\n  }\n  //_XLFN. \n  f = f.replace('_XLFN.', '')\n  //\"\"\n  var reg = new RegExp('\"(.*?)\"', 'g')\n  var arg = f.match(reg)\n  if (f.indexOf('=') === 0){\n    f = f.toUpperCase()\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i].toUpperCase()\n        if(f.indexOf(param) >= 0){\n          f = f.replace(param, arg[i])\n        }\n      }\n    }\n  }\n  return f\n}\n//xW:end\n","exports.nil = new Error('#NULL!');\nexports.div0 = new Error('#DIV/0!');\nexports.value = new Error('#VALUE?');\nexports.ref = new Error('#REF!');\nexports.name = new Error('#NAME?');\nexports.num = new Error('#NUM!');\nexports.na = new Error('#N/A');\nexports.error = new Error('#ERROR!');\nexports.data = new Error('#GETTING_DATA');\n"],"sourceRoot":""}