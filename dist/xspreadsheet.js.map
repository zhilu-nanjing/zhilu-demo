{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/component/element.js","webpack:///./src/config.js","webpack:///./src/core/helper.js","webpack:///./src/core/alphabet.js","webpack:///./src/core/cell_range.js","webpack:///./src/calc/formulajs/lib/error.js","webpack:///./src/component/event.js","webpack:///./src/locale/locale.js","webpack:///./src/component/icon.js","webpack:///./src/calc/formulajs/lib/utils.js","webpack:///./src/component/dropdown.js","webpack:///./src/calc/RawValue.js","webpack:///./src/core/formula.js","webpack:///./src/calc/formulajs/lib/math-trig.js","webpack:///./src/calc/formulajs/lib/statistical.js","webpack:///./src/model/cell_prop.js","webpack:///./src/component/formula_editor.js","webpack:///./src/core/font.js","webpack:///./src/utils/test.js","webpack:///./src/model/pre_action.js","webpack:///./src/calc/int_2_col_str.js","webpack:///./src/calc/col_str_2_int.js","webpack:///./src/calc/Range.js","webpack:///./src/calc/formulajs/lib/text.js","webpack:///./src/calc/formulajs/lib/information.js","webpack:///./src/calc/formulajs/lib/date-time.js","webpack:///./src/core/row.js","webpack:///./src/event/paste.js","webpack:///./src/component/sheet.js","webpack:///./src/component/table.js","webpack:///./src/core/format.js","webpack:///./src/component/button.js","webpack:///./src/calc/getSanitizedSheetName.js","webpack:///./src/calc/str_2_val.js","webpack:///./src/calc/RefValue.js","webpack:///./src/calc/formulajs/index.js","webpack:///./src/calc/formulajs/lib/miscellaneous.js","webpack:///./src/calc/formulajs/lib/engineering.js","webpack:///./src/calc/find_all_cells_with_formulas.js","webpack:///./src/calc/formula_check.js","webpack:///./src/core/recast.js","webpack:///./src/core/cell_proxy.js","webpack:///./src/event/move.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/modal.js","webpack:///./src/event/copy.js","webpack:///./src/external/drag.js","webpack:///./src/index.js","webpack:///./src/core/data_proxy.js","webpack:///./src/locale/en.js","webpack:///./src/calc/index.js","webpack:///./src/calc/es6.js","webpack:///./src/calc/exec_formula.js","webpack:///./src/calc/expression_builder.js","webpack:///./src/calc/Exp.js","webpack:///./src/calc/UserFnExecutor.js","webpack:///./src/calc/UserRawFnExecutor.js","webpack:///./src/calc/formulajs/lib/compatibility.js","webpack:///./src/calc/formulajs/lib/expression.js","webpack:///./src/calc/formulajs/lib/database.js","webpack:///./src/calc/formulajs/lib/logical.js","webpack:///./src/calc/formulajs/lib/financial.js","webpack:///./src/calc/formulajs/lib/lookup-reference.js","webpack:///./src/calc/formulajs/lib/custom.js","webpack:///./src/calc/formulas-raw.js","webpack:///./src/calc/Calculator.js","webpack:///./src/calc/CalcCell.js","webpack:///./src/calc/CalcWorkBook.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/paste_proxy.js","webpack:///./src/model/cell.js","webpack:///./src/calc/utils.js","webpack:///./src/core/col.js","webpack:///./src/core/validation.js","webpack:///./src/core/validator.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector_cell.js","webpack:///./src/component/editor.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/calendar.js","webpack:///./src/component/suggest_content.js","webpack:///./src/component/selector_copy.js","webpack:///./src/component/selector_move.js","webpack:///./src/component/editor_text.js","webpack:///./src/core/cell.js","webpack:///./src/utils/number_util.js","webpack:///./src/canvas/draw.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/toolbar.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/dropdown_action.js","webpack:///./src/component/history_border.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/advice.js","webpack:///./src/component/website.js","webpack:///./src/core/special_formula_process.js","webpack:///./src/component/error_pop_up.js","webpack:///./src/core/rect_proxy.js","webpack:///./src/model/Timer.js","webpack:///./src/external/resize.js","webpack:///./src/core/table_proxy.js","webpack:///./src/utils/date.js","webpack:///./src/core/multi_pre_action.js","webpack:///./src/model/paint_format.js","webpack:///./src/locale/zh-cn.js","webpack:///./src/log/log_proxy.js","webpack:///./src/log/debugout.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Element","tag","className","this","el","document","createElement","undefined","eventNames","handler","split","fen","oen","eventName","test","navigator","userAgent","addEventListener","evt","k","button","stopPropagation","keys","forEach","css","top","offsetTop","left","offsetLeft","height","offsetHeight","width","offsetWidth","v","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","arguments","childNodes","ele","child","arg","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","removeChild","getComputedStyle","text","inputData","parseFloat","toString","y","x","dy","dx","orien","arr","str","indexOf","param","mergeDeep","sources","source","Array","isArray","cloneDeep","obj","JSON","parse","stringify","merge","equals","obj1","obj2","v1","v2","ai","arrayEquals","a1","a2","sum","objOrAry","cb","total","size","rangeSum","min","max","getv","rangeReduceIf","inits","initv","ifv","alphabets","stringAt","index","cindex","parseInt","last","indexAt","ret","charCodeAt","exponet","expr2xy","src","charAt","xy2expr","ab","CellRange","sri","sci","eri","eci","w","h","ref","refs","ri","ci","args","rowFilter","console","error","d2","other","pos","addRet","dsr","dsc","der","dec","multiple","sarr","darr","each","tmp","type","nil","Error","div0","num","na","removeEvent","re","unbind","target","fn","keyCode","metaKey","buttons","event","createEvent","initEvent","eventType","dispatchEvent","xclickoutside","detail","hide","unbindClickoutside","body","movefunc","upfunc","xEvtUp","move","end","startx","starty","touches","pageX","pageY","changedTouches","spanx","spany","Math","abs","calTouchDirection","preventDefault","removeEventListener","lang","message","$lang","$messages","en","translate","messages","spreadsheet","Icon","cssPrefix","iconNameEl","require","flattenShallow","array","reduce","a","b","aIsArray","bIsArray","concat","isFlat","flatten","argsToArray","numbers","possibleNumbers","filter","flattenNum","cleanFloat","number","round","parseBool","bool","up","toUpperCase","Date","isNaN","parseNumber","string","parseNumberArray","len","parsed","parseMatrix","matrix","pnarr","d1900","parse_arg","replace","parseDate","date","getTime","Copy","copy","setTime","clone","attr","strToMatrix","ExcelDateToJSDate","utils","issue","isNumber","val","parseDateArray","anyIsError","arrayValuesToNumbers","rest","idx","initial","Dropdown","title","showArrow","placement","change","arrowChange","historyBorder","children","contentEl","headerEl","on","show","html","parent","bindClickoutside","setValue","calc","formulajs","baseFormulas","tf","render","ary","join","formulas","deepCopy","XLSX_CALC","import_functions","xlsx_Fx","formulam","f","numeric","statistical","information","ABS","ACOS","acos","ACOSH","log","sqrt","ACOT","atan","ACOTH","AGGREGATE","function_num","options","ref1","ref2","AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV","S","P","SUM","VAR","MEDIAN","MODE","SNGL","LARGE","SMALL","PERCENTILE","INC","QUARTILE","EXC","ARABIC","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","CEILING","significance","precision","floor","ROUND","ceil","MATH","PRECISE","COMBIN","number_chosen","FACT","COMBINA","COS","cos","COSH","exp","COT","tan","COTH","e2","CSC","sin","CSCH","DECIMAL","DEGREES","PI","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","places","pow","FLOORMATH","FLOORPRACE","GCD","range","r0","INT","ISO","LCM","pop","LN","LOG","base","LOG10","MDETERM","det","e","MINVERSE","inv","MMULT","matrix1","matrix2","dot","MOD","dividend","divisor","modulus","MROUND","MULTINOMIAL","MUNIT","dimension","identity","ODD","temp","POWER","power","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","ROMAN","digits","String","roman","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","function_code","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","argsKeys","elt","SUMIF","criteria","eval","SUMIFS","s_arr","compareValue","lastIndexOf","resultArr","enter","SUMPRODUCT","product","_i","_ij","arrays","SUMSQ","ISNUMBER","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","mathTrig","jStat","misc","evalExpression","AVEDEV","subtract","mean","count","AVERAGEA","AVERAGEIF","average_range","average_count","isWildcard","tokenizedCriteria","filter_criteria","tokens","createToken","TOKEN_TYPE_LITERAL","compute","AVERAGEIFS","criteriaLength","isMeetCondition","computedResult","average","BETA","DIST","alpha","beta","cumulative","A","B","cdf","pdf","INV","probability","BINOM","successes","trials","binomial","CHISQ","chisquare","RT","TEST","observed","expected","row","col","dof","xsqr","Pi","ChiSq","COLUMN","col_list","cell_name","formula","COLUMNS","cols","CONFIDENCE","NORM","sd","normalci","T","tci","IFS","cond","CORREL","array1","array2","corrcoeff","COUNTBLANK","COUNTIN","element","blanks","COUNTIF","matches","COUNTIFS","results","COUNTUNIQUE","UNIQUE","COVARIANCE","mean1","mean2","covariance","DEVSQ","EXPON","lambda","exponential","F","d1","centralF","sumOfSquares","values","x1","x2","FISHER","FISHERINV","e2y","FORECAST","data_y","data_x","xmean","ymean","den","FREQUENCY","bins","GAMMA","gammafn","gamma","GAMMALN","gammaln","GAUSS","z","normal","GEOMEAN","geomean","GROWTH","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","HARMEAN","HYPGEOM","N","INTERCEPT","KURT","sigma","stdev","sort","LINEST","LOGEST","LOGNORM","lognormal","MAXA","arr2","median","MINA","MULT","currentItem","maxItems","NEGBINOM","negbin","PEARSON","den1","den2","fl","PERCENTRANK","uniques","match","PERMUT","PERMUTATIONA","PHI","POISSON","poisson","PROB","lower","upper","sorted","quart","RANK","AVG","order","ROW","ROWS","rows","RSQ","SKEW","m2","m3","SLOPE","STANDARDIZE","STDEVA","VARA","STDEVPA","VARPA","STEYX","lft","TRANSPOSE","transpose","df","studentt","mean_x","mean_y","s_x","s_y","TREND","new_data_x","linest","TRIMMEAN","percent","trim","WEIBULL","Z","CellProp","cell","expr","empty","isHave","depend","_selector","isAb","editor","offsetX","offsetY","cellRect","getCellRectByXY","inputText","editorText","getText","input","mousedownIndex","isAbsoluteValue","cuttingByPos","selector","s1","s2","es1","value2absolute","es2","s3","erpx","isCors","sp","substring","setText","setCursorPos","selectors","set","operation","setLock","makeSelector","judgeText","cutFirst","setMouseDownIndex","cut","cutStr","filterSelectors","selectors_delete","selectors_new","removeEl","step","first","it","merges","_","e1","RegExp","div2span","cutting","cutting2","setTimeout","selectorsEl","state","selectors_valid","enterCode","sc","notTrueValue","search","prx","lax","prx_index","lax_index","right","exist","findBracketLeft","i2","mergeSelector","selectorColor","color","SelectorCopy","setCss","setEnd","index2","begin","has","stop","findBracketRight","suggestContent","cutcolor","spanArr","spanEl","code","mount2span","pt","fontSizes","fontSize","px","valid","assert","getCellDepend","cells","multivalueRefsCell","PreAction","action","oldData","newData","oldStep","cellRange","oldCell","newCell","newMergesData","oldMergesData","changeArr","distinct","sheet","isRedo","_cell","setCellText","_data","setData","_cells","setHeight","setWidth","modulo","columnName","guard","fromCharCode","col_str","colstr","col_str_2_int","int_2_col_str","getSanitizedSheetName","Range","str_expression","possition_i","range_expression","sheet_name","start_pst","end_pst","aux","range_start_pst","wb","Sheets","max_row","min_row","str_max_row","min_col","max_col","cell_full_name","formula_ref","status","exec_formula","numeral","num2e","LN10","allzero","decimalsToFractional","decimals","formatDecimals","toFixed","recursion","Number","isInteger","ASC","BAHTTEXT","CHAR","CLEAN","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","format","EXACT","text1","text2","FIND","find_text","within_text","position","FIXED","no_commas","HTML2TEXT","line","INDEX","row_num","column_num","LEFT","LEN","LOWER","toLowerCase","MID","start","NUMBERVALUE","decimal_separator","group_separator","PRONETIC","PROPER","txt","substr","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","REPT","RIGHT","SEARCH","foundAt","SPLIT","separator","SUBSTITUTE","old_text","occurrence","TEXT","fixed","Formulas","jsSpreadsheet","AllFormulas","fmt","TRIM","UNICHAR","UNICODE","UPPER","VALUE","unformat","CELL","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISODD","ISREF","ISTEXT","NA","SHEET","SHEETS","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","isLeapYear","year","getMonth","daysBetween","start_date","end_date","serial","DATE","month","day","DATEVALUE","date_text","DAY","serial_number","getDate","DAYS","DAYS360","method","ed","sm","em","smd","getFullYear","emd","EDATE","months","setMonth","EOMONTH","HOUR","getHours","INTERVAL","second","hour","sec","ISOWEEKNUM","setHours","setDate","getDay","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","NETWORKDAYSINTL","weekend","NETWORKDAYS$INTL","days","getTimezoneOffset","getUTCDay","holiday","INTL","NOW","SECOND","getSeconds","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","week_start","jan","inc","WORKDAY","WORKDAYINTL","YEAR","YEARFRAC","basis","sy","ey","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","calcUtils","isFormula","otherAutoFilter","direction","isAdd","what","dri","ncell","getCellByTopCell","iText","calcFormulaCellByTopCell","calcCellByTopCell","numberAutoFilter","diffValue","calcNumberCellByTopCell","dateAutoFilter","isDown","isDate","diff","calcDateCellByTopCell","Rows","pasteProxy","PasteProxy","workbook","getOrNew","exceptSet","helper","getHeight","sumHeight","getCell","isSheetVale","Cell","setCell","to_calc_num","getDependCell","setFormatText","tryParseToNum","mergeCellExpr","mergeArr","refCell","getCellOrNew","arr3","changeFormula","ca","setCellAll","es","cellStyle","isValid","isInsert","ds","dei","dci","isRows","formatText","cellProp","bad","newStr","getCellTextIsAdd","ds1","ds2","item","und","CellProxy","getCellDataType","last1","formatMoney","copyRender","strList","splitStr","getRangeByTopCell","getCellTextByShift","updateCellReferenceByShift","word","getCellByCell","srcCellRange","dstCellRange","setSrcAndDstCellRange","use","rn","cn","isLeftRight","autoFilterDirection","upOrDown","getOneDRangeObj","srcOneDRange","dstOneDRange","getAllDataType","getLocationArray","leftOrRight","calcDiff","nri","nci","as","srcCell","eachCells","includes","ndata","rndata","deleteCell","entries","isReferOtherSheet","recast","Recast","out","rowsInit","time","init","Rows2Workbook","toolbar","timeEnd","assign","styles","cbd","clipboardData","items","kind","getAsString","textDom","imgDom","getElementsByTagName","styleDom","tableDom","spanDom","mountImg","process","spanDomPackage","GetInfoFromTable","sheetReset","getAsFile","reader","FileReader","onload","img","readAsDataURL","getData","pasteDirectionsArr","direction_new","direction_delete","resizeOption","onBegin","onEnd","onResize","self","getChooseImg","img2","dragOption","lastCi","lastRi","onDrag","table","tbody","textArr","innerText","tr","td","history","getMaxCoord","nextLeft","nextTop","image","Image","container","pictureOffsetLeft","pictureOffsetTop","rect","getMoveRect","choose","div","Drag","register","directionsArr","Resize","containerHandlerEvent","hideDirectionArr","display","clear","newX","equal","tableObj","tableProxy","TableProxy","extend","dealColSpan","dealStyle","reference","dealReference","setCellRange","parseTableCellRange","getSelectedRect","advice","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","fsw","freezeTotalWidth","fsh","freezeTotalHeight","selectorSet","indexesUpdated","moving","reset","clearTimeout","render_timer","selectorMove","indexes","moveIndexes","selectCell","resetSelectOffset","editorSetOffset","overlayerMousemove","rowResizer","colResizer","tableEl","website","cRect","indexWidth","tRect","box","overlayerMousescroll","autoLoad","settings","scroll","delta","deltaY","overlayerTouch","distance","verticalScrollbarSet","totalHeight","horizontalScrollbarSet","totalWidth","sheetFreeze","freeze","fwidth","fheight","setFreezeLengths","resetAreaOffset","overlayerEl","overlayerCEl","tOffset","vRect","getRect","offset","renderAutoAdapt","autoRowResizer","toolbarChangeSelectorCell","clearClipboard","hideClipboard","showClipboard","paste","msg","xtoast","autofilter","toolbarChangePaintformatPaste","paintformatActive","paintFormatChange","paintformatToggle","dropDown","isAutofillEl","setBoxinner","dstRect","getCellRectByXYWithNotTotalResult","layerX","clientX","layerY","clientY","dropGetPos","rpos","ex","showAutofill","isOusideViewRange","view","continueMove","shiftKey","viewRange","getMovePos","selectorBeyondMove","rectProxy","RectProxy","isLocInside","arange","getUpDownLeftRight","scrollTo","getWidth","overlayerMousedown","sortFilter","setRiCi","autoFilter","includes2","getSet","exceptRowSet","getFilter","getSort","setOffset","point","offsetParent","getPoint","mouseMoveUp","clearStopTimer","continueDropDown","autofill","testValid","autofillNext","hideAutofill","stopTimer","stopTimer2","setInterval","loadFormula","firstRowToWidth","colResizerFinished","adviceSetOffset","pictureSetOffset","sOffset","cri","cci","sPosition","selectorsSetOffset","resetSelectorBRLAreaOffset","hasEditor","showEditor","selectorMoveEl","editorSet","setCellEnd","getSelectedCell","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","viewRange2","autoAdapt","ignoreRi","viewWidth","getCellTextContent","dbox","getDrawBox","getCellTextStyle","font","getFontSizePxByPt","txtWidth","draw","selfAdaptionTxtWidth","autoAdaptList","ignore","_ignore","cellWidth","record_rc","r_h","viewHeight","record_h","c_h","padding","selfAdaptionHeight","clickSelectorChangeRiCi","rowResizerFinished","setRowHeight","setColWidth","errorPop","errorPopUp","open","selectorCellText","dataSetCellText","setSelectedCellText","throwFormula","insertDeleteRowColumn","insert","toolbarChange","undo","setContent","historyList","redo","getMax","mri","mci","changeDataForCalc","eachRange","showFreeze","showEquation","setSelectedCellAttr","borderResSet","br","border","sortFilterChange","operator","setAutoFilter","afterSelector","getLock","pasteEvent","mountPaste","sheetInitEvents","contextMenu","modalValidation","xyInSelectedRect","setPosition","lockCells","longTimeBefore","clearSelectors","bindTouch","ok","finishedFn","moveFn","itext","editorChangeToHistory","getOldCell","getRICI","setOldCell","setSelectedCell","lock","editingSelectors","addValidation","removeValidation","itemClick","getSelectedValidation","reload","mountCopy","which","ctrlKey","addPic","pictures","deleteImg","trigger","Sheet","targetEl","showToolbar","showContextmenu","rowWidth","Toolbar","Resizer","minWidth","Scrollbar","Editor","Timer","Website","ModalValidation","ErrorPopUp","ContextMenu","Selector","Advice","SortFilter","Table","recalc","clickCopyPaste","clickAutofill","styleBool","setFreeze","cellPaddingWidth","tableFixedHeaderCleanStyle","fillStyle","tableGridStyle","lineWidth","thinLineWidth","strokeStyle","rindex","DrawBox","getChangeDataToCalc","changeData","parseCell","changeDataArgs","renderCell","sortedRowMap","nrindex","getCellStyleOrDefault","bgcolor","setBorders","strokeBorders","cellText","rect2","renderFormat","minus","isMinus","underline","look","specialStyle","align","valign","strike","textwrap","validations","getError","renderFlexible","flex","s_t","set_total","dropUp","renderAutofilter","afRange","hrange","intersects","dropdown","renderContent","fw","fh","tx","ty","save","filteredTranslateFunc","restore","rset","Set","eachMergesInView","renderSelectedHeaderCell","fillRect","renderFixedHeaders","sumWidth","nty","ntx","textAlign","textBaseline","npx","rowEach","y1","rowHeight","ii","fillText","colEach","colWidth","renderFixedLeftTopCell","renderContentGrid","clearRect","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","theight","Draw","timer","getCellTextOrDefault","resize","fri","fci","vr","freezeViewRange","formatStringRender","formatNumberRender","baseFormats","label","multiply","a_s","toInteger","floatNum","times","isNegative","strfi","dotPos","intNum","op","o1","o2","n1","n2","t1","t2","formatm","Button","quotedMatch","RawValue","RefValue","buffer","position_i","parseRef","resolved_ref","ref_cell","categories","category","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","path","opening","JOIN","NUMBERS","NUMERAL","bessel","isValidBinaryNumber","trans_num","inumber","BESSELI","besseli","BESSELJ","besselj","BESSELK","besselk","BESSELY","bessely","BIN2DEC","stringified","BIN2HEX","BIN2OCT","BITAND","number1","number2","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","Y","E","G","u","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","erf","ERFC","erfc","GESTEP","HEX2BIN","negative","decimal","HEX2DEC","HEX2OCT","IMABS","IMREAL","IMAGINARY","plus","unit","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","tileArr","need_calc_cells","findAllNeedCalcCell","trans_params","reg","rep","trans_sheet","recover_sheet","strim","trans_formula","trans_dict","ast","preProcess","formatInfo","nA","str2Re","datePattern2","Moved","startZIndex","SelectorElement","cornerEl","moveEvent","boxinner","areaEl","clipboardEl","autofillEl","_cellRange","setMove","movedCell","movedCell2","cutPaste","moveChange","selectorMoveReset","pointer","calBRAreaOffset","ftwidth","ftheight","left0","top0","calTAreaOffset","calLAreaOffset","setBRAreaOffset","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","areaOffset","SelectorCell","lastri","lastci","freezeHeight","freezeWidth","coffset","getClipboardRect","resetOffset","calSelectedRangeByStart","setIndexes","calSelectedRangeByEnd","drisc","inputMovePrev","filterItems","itemIndex","scrollHeight","inputMoveNext","inputEnter","click","inputKeydownHandler","Suggest","cssRemoveKeys","startsWith","map","selectColors","themeColorPlaceHolders","themeColors","standardColors","buildTd","DropdownColor","iconName","icon","colorPalette","ColorPalette","setTitle","Modal","dimmer","documentElement","clientHeight","clientWidth","xkeydownEsc","parseDom","sheetCopy","plain","bold","hidden","node","tmpNode","cloneNode","cursor","nl","nt","onmousemove","nx","ny","onmouseup","Spreadsheet","methods","alias","querySelector","locale","zhCN","DataProxy","rootEl","loadData","errors","getCellByExpr","drag","bugout","defaultSettings","flexible","italic","canPaste","dst","srn","scn","drn","dcn","copyPaste","deleteCells","deleteWithin","cleard","clipboard","setStyleBorder","bss","cstyle","addStyle","event_type","description","isLegal","processPasteDirectionsArr","newItem","clickCopyPasteHelp","lci","lri","lcell","setStyleBorders","isSignleSelected","mergeIndexes","mrl","mcl","getCellMerge","getCellRowByY","scrollOffsety","frset","getCellColByX","scrollOffsetx","makeFormatCell","symbol","cText","getType","getCellStyle","dateDiff","getCellStyleConvert","formatDate","changeFormat","useOne","Merges","Cols","Validations","hyperlinks","comments","formulaCalc","multiPreAction","MultiPreAction","Scroll","Clipboard","moved","AutoFilter","Map","unsortedRowMap","validator","cell2","cell3","getItems","execCommand","dsri","dsci","defaultStyle","pArr","makeCellPropArr","setCellByCellProp","paintFormat","PaintFormat","paintType","getPaintType","makePaintArr","srcRange","union","getFirstIncludes","unmerge","nfont","resetAutoFilter","getStepType","oc","nc","addStep","isClear","autoFilterRef","addFilter","setSort","filteredRows","fset","fary","oldAry","si","insertColumn","rsize","csize","deleteColumn","validate","filterIntersects","frary","nstyle","undoItems","lastStep","changeToHistory","addFiexRows","filters","paintformat","clearformat","fontBold","fontItalic","textColor","fillColor","more","comeBack","contextmenu","pasteValue","pasteFormat","insertRow","deleteRow","deleteCellText","validation","recover","rmb","usd","datetime","duration","date_formula","wland","wfr","rtd","required","notMatch","between","notBetween","notIn","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","pasteForMergedCell","calendar","weeks","cancel","desc","asc","dataValidation","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","find_all_need_calc_cell","Calculator","CalcCell","checker","CalcWorkBook","mymodule","Calc_WorkBook","get_workbook","calc_cell","valid_res","check_valid","recover_formula","is_muti_cell","deal_muti_cell","calcDoneToSetCells","calculator","set_fx","exec_fx","import_raw_functions","localizeFunctions","expression_builder","xlsx_raw_Fx","functions","opts","prefix","override","my_assign","dest","build_expression","update_cell_value","dic","newName","oldName","Exp","UserFnExecutor","UserRawFnExecutor","common_operations","root_exp","str_formula","exp_obj","was_string","fn_stack","char","single_quote","stack","trim_buffer","special","special_raw","ini_parentheses","str_2_val","MS_PER_DAY","exp_id","last_arg","isEmpty","checkVariable","exec","id","errorValues","datedifference","exec_minus","user_function","engineering","dateTime","root","BETADIST","BETAINV","BINOMDIST","ISOCEILING","CEILINGMATH","CEILINGPRECISE","CHIDIST","CHIDISTRT","CHIINV","CHIINVRT","CHITEST","COVAR","COVARIANCEP","COVARIANCES","CRITBINOM","EXPONDIST","ERFCPRECISE","ERFPRECISE","FDIST","FDISTRT","FINVRT","FINV","FLOORPRECISE","FTEST","GAMMADIST","GAMMAINV","GAMMALNPRECISE","HYPGEOMDIST","LOGINV","LOGNORMINV","LOGNORMDIST","MODEMULT","MODESNGL","NEGBINOMDIST","NORMDIST","NORMINV","NORMSDIST","NORMSINV","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","POISSONDIST","QUARTILEEXC","QUARTILEINC","RANKAVG","RANKEQ","SKEWP","STDEVP","STDEVS","TDIST","TDISTRT","TINV","TTEST","VARP","VARS","WEIBULLDIST","ZTEST","_XLFN","defaultOperator","validSymbols","TOKEN_TYPE_OPERATOR","SUPPORTED_TOKENS","analyzeTokens","literalValue","analyzedTokens","token","unshift","expression","expressionLength","cursorIndex","processedValue","processedSymbol","tokenizeExpression","evaluate","stats","maths","compact","find_result_idx","database","valid_arr","filter_arr","valid_str","result_idx","is_valid","get_values","resultIndexes","field","field_idx","FINDFIELD","DAVERAGE","targetValues","DCOUNT","DCOUNTA","DGET","DMAX","DMIN","DPRODUCT","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","AND","CHOOSE","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","IFNA","value_if_na","NOT","logical","OR","TRUE","XOR","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","validDate","ACCRINT","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","cost","date_purchased","first_period","salvage","period","AMORLINC","COUPDAYBS","maturity","COUPDAYS","COUPDAYSNC","COUPNCD","numerror","COUPNUM","COUPPCD","CUMIPMT","periods","payment","PMT","interest","FV","CUMPRINC","principal","DB","life","current","ceiling","DDB","factor","DISC","pr","redemption","DOLLARDE","dollar","fraction","LN2","DOLLARFR","DURATION","coupon","yld","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","investment","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","discount","PRICEDISC","PRICEMAT","dsm","PV","RATE","iter","close","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","match_less_than_or_equal","lookupValue","indexValue","match_exactly_string","match_exactly_non_string","match_greater_than_or_equal","MATCH","matchType","VLOOKUP","return_index","HLOOKUP","needle","exactmatch","City","url","PQUERY","absArr","val1","val2","a4","city","area","HYPERLINK","lianjia","lianJiaUrl","woaiwojia","woaiwojiaUrl","fangtianxia","fangtianxiaUrl","cell_ref","columns","ref_value","parsed_ref","end_range","onerrorvalue","Infinity","condition","_then","_else","find_all_cells_with_formulas","expressions","variables","calcNames","var_name","variable","setVarOfExpression","vars","Workbook","Names","getRef","Ref","Name","ref_name","formulas_i","fml","zb","source_v","cell_v","cell_zb","cell_x","cell_y","clean_matrix","clean_all_flag","process_arr","process_matrix","Filter","Sort","fitlers","rir","ix","cic","ctext","valueOf","cr","within","cbWithin","it1","deri","deci","getRangeByWay","way","last2","Validation","nrefs","difference","Validator","getByValidator","addRef","rules","returnMessage","parseValue","vertical","minDistance","hoverEl","mousedownHandler","lineEl","startEvt","movementX","movementY","contentDistance","cssKey","includeByRiCi","selectorHeightBorderWidth","resetTextareaSize","textlineEl","textEl","tlineWidth","maxWidth","viewFn","h1","getCursortPosition","getSelection","rangeCount","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","startContainer","startOffset","findBracket","spanLeft","spanRight","suggest","set_focus","savedSel","charIndex","createRange","setStart","collapse","nodeStack","foundStart","nodeType","nextCharIndex","sel","removeAllRanges","addRange","mouseDownEventHandler","parse2","isDisplay","inputEventHandler","inputType","chinese","nodeValue","changed","changeText","cutValue","cuttingByPos2","cuttingByPosEnd","keyDownEventHandler","opacity","setTextareaRange","blur","suggestItemClick","resetSuggestContentItems","resetSuggestItems","setItems","SuggestContent","datepicker","Datepicker","dateFormat","EditorText","getSelectedCellRiCi","currentTarget","key_num","f4ShortcutKey","bindInputEvents","clp","originalEvent","newNode","insertNode","selection","pasteHTML","textFormat","off","focus","insertBefore","cursorPos","textBegin","textEnd","suggestPosition","elOffset","Calendar","calendarPattern","selectChange","addMonth","weekday","cvalue","headerLeftEl","bodyEl","buildAll","prev","next","week","buildHeaderLeft","buildBody","trs","cdate","startDate","datess","disabled","monthDays","tds","variableElement","ct","helpFormula","exampleName","example","item2","find","cha","SelectorMove","_move_selectors","_erpx","ern","ecn","dict","msri","msci","meri","meci","move2","cuttingByPosEnd2","text_b","operatorStack","subStrs","fnArgType","fnArgsLen","c1","sx","rangelen","evalFormula","rule","sheetbook","formulaMap","getCellText","look2","dpr","devicePixelRatio","npxLine","drawFlexFalse","ctx","beginPath","moveTo","lineTo","stroke","strokeRect","clip","fill","drawFlexTrue","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","blheight","blwidth","floffset","getContext","scale","cxc","indent","vIndent","canvasContext","textLine","innerWidth","selfAdaptionOneTxtWidth","measureText","textWrap","textx","texty","setLineDash","topxys","rightxys","bottomxys","leftxys","closePath","dtextcb","menuItems","buildMenuItem","buildMenu","isHide","menus","buildButton","tooltipdata","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","undoEl","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","widthFn","btns","moreEl","ddMore","elBox","sumWidth2","list1","list2","DropdownFormat","DropdownFont","DropdownFormula","DropdownFontSize","DropdownAlign","DropdownBorder","DropdownAction","redoEl","paintformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","freezeEl","addEl","closeEl","autofilterEl","throwFormulaEl","getSelectedCellStyle","canUndo","canRedo","canUnmerge","canAutofilter","equationIsActive","freezeIsActive","nfonts","baseFonts","nfontSizes","nformats","nformulas","aligns","naligns","setName","borderPalette","BorderPalette","buildTable","ddColor","ddType","DropdownLineType","lineTypes","beforei","lineTypeEls","iti","HistoryBorder","els","fieldLabelWidth","mf","FormField","FormSelect","rf","FormInput","pattern","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","hint","attrs","isShow","vchange","getTitle","itemEl","patterns","labelWidth","tip","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","cnt","filterClick","resetFilterHeader","filterhEl","checked","tindex","sortAscEl","sortDescEl","sortDesc","findIndex","saveCheck","textCheck","timer2","isDisplay2","td2","td3","td4","td5","isSpecialWebsite","screenX","screenY","mc","tailArr","positionAngle","clearInterval","directions","onmousedown","ox","oy","ow","oh","ol","ot","isResize","fun","mappers","ee","setLeft","setTop","se","nw","ws","ne","fontWeight","background","colLen","defaultView","isHaveStyle","maxRi","maxCi","rii","cij","calcDecimals","beginDate","beginDate2","datePattern","fix","operationItem","preAction","redoItems","expr1","expr2","does","actionItems","actionType","selectorRange","dstRange","dType","sType","recordRi","rowIndex","_darr","changeDarrToDoubleArr","revision","debugout","realTimeLoggingOn","useTimestamps","useLocalStorage","recordLogs","autoTrim","maxLines","tailNumLines","logFilename","depth","parentSizes","currentResult","startTime","output","version","getLog","retrievalTime","saved","localStorage","getItem","lastLog","formatSessionDuration","tail","numLines","tailLines","trimLog","lines","rgx","matched","addr","getSlice","lineNumber","downloadLog","file","logFile","encodeURIComponent","href","download","clearTime","saveObject","setItem","determineType","addition","logTime","formatTimestamp","typeResult","formatType","objectSize","prop","indentsForDepth","subtype","subresult","endTime","msec","hh","hrs","mm","mins","ss","timestamp","getMinutes","webpackContext","req","webpackContextResolve","resolve"],"mappings":"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,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,gBAAiB,IACjB,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,YAAa,IACb,eAAgB,IAChB,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,QAAS,IACT,WAAY,IACZ,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,QAAS,IACT,WAAY,IACZ,OAAQ,IACR,UAAW,IACX,QAAS,IACT,WAAY,IACZ,QAAS,IACT,aAAc,IACd,gBAAiB,IACjB,WAAY,IACZ,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,YAAa,IACb,eAAgB,IAChB,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,gBAAiB,IACjB,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,KAIf,SAAS6gC,EAAeC,GACvB,IAAIpwB,EAAKqwB,EAAsBD,GAC/B,OAAO1yF,EAAoBsiE,GAE5B,SAASqwB,EAAsBD,GAC9B,IAAI1yF,EAAoBY,EAAEgxD,EAAK8gC,GAAM,CACpC,IAAIl3E,EAAI,IAAIxP,MAAM,uBAAyB0mF,EAAM,KAEjD,MADAl3E,EAAEqX,KAAO,mBACHrX,EAEP,OAAOo2C,EAAI8gC,GAEZD,EAAehvF,KAAO,WACrB,OAAO3E,OAAO2E,KAAKmuD,IAEpB6gC,EAAeG,QAAUD,EACzBtyF,EAAOD,QAAUqyF,EACjBA,EAAenwB,GAAK","file":"xspreadsheet.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([221,2,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/* global document */\n\n/* global window */\nclass Element {\n    constructor(tag, className = '') {\n        if (typeof tag === 'string') {\n            this.el = document.createElement(tag);\n            this.el.className = className;\n        } else {\n            this.el = tag;\n        }\n        this.data = {};\n    }\n\n    data(key, value) {\n        if (value !== undefined) {\n            this.data[key] = value;\n            return this;\n        }\n        return this.data[key];\n    }\n\n    on(eventNames, handler) {\n        const [fen, ...oen] = eventNames.split('.');\n        let eventName = fen;\n        if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n            eventName = 'DOMMouseScroll';\n        }\n        this.el.addEventListener(eventName, (evt) => {\n            handler(evt);\n            for (let i = 0; i < oen.length; i += 1) {\n                const k = oen[i];\n                if (k === 'left' && evt.button !== 0) {\n                    return;\n                }\n                if (k === 'right' && evt.button !== 2) {\n                    return;\n                }\n                if (k === 'stop') {\n                    evt.stopPropagation();\n                }\n            }\n        });\n        return this;\n    }\n\n    offset(value) {\n        if (value !== undefined) {\n            Object.keys(value).forEach((k) => {\n                this.css(k, `${value[k]}px`);\n            });\n            return this;\n        }\n        const {\n            offsetTop, offsetLeft, offsetHeight, offsetWidth,\n        } = this.el;\n        return {\n            top: offsetTop,\n            left: offsetLeft,\n            height: offsetHeight,\n            width: offsetWidth,\n        };\n    }\n\n    scroll(v) {\n        const {el} = this;\n        if (v !== undefined) {\n            if (v.left !== undefined) {\n                el.scrollLeft = v.left;\n            }\n            if (v.top !== undefined) {\n                el.scrollTop = v.top;\n            }\n        }\n\n        return {left: el.scrollLeft, top: el.scrollTop};\n    }\n\n    box() {\n        return this.el.getBoundingClientRect();\n    }\n\n    parent() {\n        return new Element(this.el.parentNode);\n    }\n\n    children(...eles) {\n        if (arguments.length === 0) {\n            return this.el.childNodes;\n        }\n        eles.forEach(ele => this.child(ele));\n        return this;\n    }\n\n    /*\n    first() {\n      return this.el.firstChild;\n    }\n\n    last() {\n      return this.el.lastChild;\n    }\n\n    remove(ele) {\n      return this.el.removeChild(ele);\n    }\n\n    prepend(ele) {\n      const { el } = this;\n      if (el.children.length > 0) {\n        el.insertBefore(ele, el.firstChild);\n      } else {\n        el.appendChild(ele);\n      }\n      return this;\n    }\n\n    prev() {\n      return this.el.previousSibling;\n    }\n\n    next() {\n      return this.el.nextSibling;\n    }\n    */\n\n    child(arg) {\n        let ele = arg;\n        if (typeof arg === 'string') {\n            ele = document.createTextNode(arg);\n        } else if (arg instanceof Element) {\n            ele = arg.el;\n        }\n        this.el.appendChild(ele);\n\n        return this;\n    }\n\n    contains(ele) {\n        return this.el.contains(ele);\n    }\n\n    className(v) {\n        if (v !== undefined) {\n            this.el.className = v;\n            return this;\n        }\n        return this.el.className;\n    }\n\n    addClass(name) {\n        this.el.classList.add(name);\n        return this;\n    }\n\n    hasClass(name) {\n        return this.el.classList.contains(name);\n    }\n\n    removeClass(name) {\n        this.el.classList.remove(name);\n        return this;\n    }\n\n    toggle(cls = 'active') {\n        return this.toggleClass(cls);\n    }\n\n    toggleClass(name) {\n        return this.el.classList.toggle(name);\n    }\n\n    active(flag = true, cls = 'active') {\n        if (flag) this.addClass(cls);\n        else this.removeClass(cls);\n        return this;\n    }\n\n    checked(flag = true) {\n        this.active(flag, 'checked');\n        return this;\n    }\n\n    disabled(flag = true) {\n        if (flag) this.addClass('disabled');\n        else this.removeClass('disabled');\n        return this;\n    }\n\n    // key, value\n    // key\n    // {k, v}...\n    attr(key, value) {\n        if (value !== undefined) {\n            this.el.setAttribute(key, value);\n        } else {\n            if (typeof key === 'string') {\n                return this.el.getAttribute(key);\n            }\n            Object.keys(key).forEach((k) => {\n                this.el.setAttribute(k, key[k]);\n            });\n        }\n        return this;\n    }\n\n    removeAttr(key) {\n        this.el.removeAttribute(key);\n        return this;\n    }\n\n    html(content) {\n        if (content !== undefined) {\n            this.el.innerHTML = content;\n            return this;\n        }\n        return this.el.innerHTML;\n    }\n\n    val(v) {\n        if (v !== undefined) {\n            this.el.value = v;\n            return this;\n        }\n        return this.el.value;\n    }\n\n    cssRemoveKeys(...keys) {\n        keys.forEach(k => this.el.style.removeProperty(k));\n        return this;\n    }\n\n    // css( propertyName )\n    // css( propertyName, value )\n    // css( properties )\n    css(name, value) {\n        if (value === undefined && typeof name !== 'string') {\n            Object.keys(name).forEach((k) => {\n                this.el.style[k] = name[k];\n            });\n            return this;\n        }\n        if (value !== undefined) {\n            this.el.style[name] = value;\n            return this;\n        }\n        return this.el.style[name];\n    }\n\n    removeEl() {\n        if (!this.el || !this.el.parentNode) {\n            return;\n        }\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    computedStyle() {\n        return window.getComputedStyle(this.el, null);\n    }\n\n    isShow() {\n        return this.el.style['display'] === 'block';\n    }\n\n    show(key = 'display', text = 'block') {\n        this.css(key, text);\n        return this;\n    }\n\n    hide(key = 'display', value = 'none') {\n        this.css(key, value);\n        return this;\n    }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n    Element,\n    h,\n};\n","/* global window */\nexport const cssPrefix = 'fin-cell';\nexport const look = ['*悬浮查看*', '*HYPERLINK*', '*MULTIPLECELLS*'];\nexport const look2 = '#CHECK！';\nexport const filterFormula = ['CITY'];\nexport const offsetLeft = 60;\nexport const offsetTop = 70;\n\n// export const edgeRight = 30;\n// export const dpr = window.devicePixelRatio  || 1;\n// export const dpr = 1;\n","/* eslint-disable no-param-reassign */\nfunction cloneDeep(obj) {\n\n    return JSON.parse(JSON.stringify(obj));\n}\n\n// export function isEqual(v1, v2) {\n//     v1 = v1 + \"\";\n//     v2 = v2 + \"\";\n//     v1 = v1.toUpperCase();\n//     v2 = v2.toUpperCase();\n//\n//     return v1 === v2;\n// }\n\nconst mergeDeep = (object = {}, ...sources) => {\n    sources.forEach((source) => {\n        if (source != null && source !== undefined) {\n            Object.keys(source).forEach((key) => {\n                const v = source[key];\n                // console.log('k:', key, ', v:', source[key], typeof v, v instanceof Object);\n                if (typeof v === 'string' || typeof v === 'number' || typeof v === 'boolean') {\n                    object[key] = v;\n                } else if (typeof v !== 'function' && !Array.isArray(v) && v instanceof Object) {\n                    object[key] = object[key] || {};\n                    mergeDeep(object[key], v);\n                } else {\n                    object[key] = v;\n                }\n            });\n        }\n    });\n    // console.log('::', object);\n    return object;\n};\n\nfunction find(arr, str) {\n    for (let i = 0; i < arr.length; i++) {\n        if (str.indexOf(arr[i]) !== -1) {\n            return true;\n        }\n    }\n    return false;\n}\n\n\nfunction isOusideViewRange(y, x, dy, dx, orien) {\n    if (orien === 44 && dy - y + 100 > 0) {\n        return true;\n    } else if (orien === 11 && dx - 100 < 0) {\n        return true;\n    } else if (orien === 33 && dx - x + 100 > 0) {\n        return true;\n    } else if (orien === 22 && dy - 100 < 0) {\n        return true;\n    }\n    return false;\n}\n\nfunction equals(obj1, obj2) {\n    const keys = Object.keys(obj1);\n    if (keys.length !== Object.keys(obj2).length) return false;\n    for (let i = 0; i < keys.length; i += 1) {\n        const k = keys[i];\n        const v1 = obj1[k];\n        const v2 = obj2[k];\n        if (v2 === undefined) return false;\n        if (typeof v1 === 'string' || typeof v1 === 'number' || typeof v1 === 'boolean') {\n            if (v1 !== v2) return false;\n        } else if (Array.isArray(v1)) {\n            if (v1.length !== v2.length) return false;\n            for (let ai = 0; ai < v1.length; ai += 1) {\n                if (!equals(v1[ai], v2[ai])) return false;\n            }\n        } else if (typeof v1 !== 'function' && !Array.isArray(v1) && v1 instanceof Object) {\n            if (!equals(v1, v2)) return false;\n        }\n    }\n    return true;\n}\n\nfunction isHave(param) {\n    if (typeof param === \"undefined\") {\n        return false;\n    }\n\n    // if (param === null) {\n    //     return false;\n    // }\n\n    return param !== null;\n}\n\n/*\n  objOrAry: obejct or Array\n  cb: (value, index | key) => { return value }\n*/\nconst sum = (objOrAry, cb = value => value) => {\n    let total = 0;\n    let size = 0;\n    Object.keys(objOrAry).forEach((key) => {\n        total += cb(objOrAry[key], key);\n        size += 1;\n    });\n    return [total, size];\n};\n\n// function deleteProperty(obj, property) {\n//     const oldv = obj[`${property}`];\n//     delete obj[`${property}`];\n//     return oldv;\n// }\n\nfunction rangeReduceIf(min, max, inits, initv, ifv, getv) {\n    let s = inits;\n    let v = initv;\n    let i = min;\n    for (; i < max; i += 1) {\n        if (s > ifv) break;\n        v = getv(i);\n        s += v;\n    }\n    return [i, s - v, v];\n}\n\nfunction rangeSum(min, max, getv) {\n    let s = 0;\n    for (let i = min; i < max; i += 1) {\n        s += getv(i);\n    }\n    return s;\n}\n\nfunction isNumber(inputData) {\n    // if (parseFloat(inputData).toString() === \"NaN\") {\n    //     return false;\n    // } else {\n    //     return parseFloat(inputData).toString() === \"NaN\";\n    // }\n    return parseFloat(inputData).toString() !== \"NaN\";\n}\n\n// function rangeEach(min, max, cb) {\n//     for (let i = min; i < max; i += 1) {\n//         cb(i);\n//     }\n// }\n\nfunction arrayEquals(a1, a2) {\n    if (a1.length === a2.length) {\n        for (let i = 0; i < a1.length; i += 1) {\n            if (a1[i] !== a2[i]) return false;\n        }\n    } else return false;\n    return true;\n}\n\nexport default {\n    cloneDeep,\n    merge: (...sources) => mergeDeep({}, ...sources),\n    equals,\n    arrayEquals,\n    sum,\n     rangeSum,\n    rangeReduceIf,\n\n};\n\nexport {\n    isNumber,\n    isOusideViewRange,\n    find,\n    isHave,\n}","const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n\nexport function stringAt(index) {\n  let str = '';\n  let cindex = index;\n  while (cindex >= alphabets.length) {\n    cindex /= alphabets.length;\n    cindex -= 1;\n    str += alphabets[parseInt(cindex, 10) % alphabets.length];\n  }\n  const last = index % alphabets.length;\n  str += alphabets[last];\n  return str;\n}\n\nexport function  indexAt(str) {\n  let ret = 0;\n  for (let i = 0; i < str.length - 1; i += 1) {\n    const cindex = str.charCodeAt(i) - 65;\n    const exponet = str.length - 1 - i;\n    ret += (alphabets.length ** exponet) + (alphabets.length * cindex);\n  }\n  ret += str.charCodeAt(str.length - 1) - 65;\n  return ret;\n}\n\n// B10 => x,y\nexport function expr2xy(src) {\n  let x = '';\n  let y = '';\n  for (let i = 0; i < src.length; i += 1) {\n    if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {\n      y += src.charAt(i);\n    } else {\n      x += src.charAt(i);\n    }\n  }\n  return [indexAt(x), parseInt(y, 10) - 1];\n}\n\n// export function expr2expr(src, xn, yn) {\n//   const [x, y] = expr2xy(src);\n//   return stringAt(x + xn) + (y + yn);\n// }\n\n// x,y => B10  x ci y ri\nexport function xy2expr(x, y, ab = 0) {\n  x = x * 1;\n  y = y * 1;\n  if(ab === 2) {\n    return `${stringAt(x)}$${y + 1}`;\n  } else if(ab === 1) {\n      return `$${stringAt(x)}${y + 1}`;\n  }\n  return `${stringAt(x)}${y + 1}`;\n}\n\nexport default {\n  expr2xy,\n  xy2expr,\n};\n","import {expr2xy, xy2expr} from './alphabet';\n\nclass CellRange {\n    constructor(sri, sci, eri, eci, w = 0, h = 0) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n        this.w = w;\n        this.h = h;\n    }\n\n    set(sri, sci, eri, eci) {\n        this.sri = sri;\n        this.sci = sci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    multiple() {\n        return this.eri - this.sri > 0 || this.eci - this.sci > 0;\n    }\n\n    // cell-index: ri, ci\n    // cell-ref: A10\n    includes(...args) {\n        let [ri, ci] = [0, 0];\n        if (args.length === 1) {\n            [ci, ri] = expr2xy(args[0]);\n        } else if (args.length === 2) {\n            [ri, ci] = args;\n        }\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\n    }\n\n    each(cb, rowFilter = () => true) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        for (let i = sri; i <= eri; i += 1) {\n            if (rowFilter(i)) {\n                for (let j = sci; j <= eci; j += 1) {\n                    cb(i, j);\n                }\n            }\n        }\n    }\n\n    // 1 * n  /  n * 1 / n * n\n    getType() {\n        let {\n            sri, sci, eri, eci,\n        } = this;\n\n        if(sri === eri && sci !== eci) {\n            return 1;\n        } else if(sri !== eri && sci === eci) {\n            return 2;\n        } else if(sri !== eri && sci !== eci) {\n            return 3;\n        } else if(sri === eri && sci === eci) {\n            return 1;\n        }\n\n        console.error(\"未知情况\");\n        return 4;\n    }\n\n    // each2(cb, rowFilter = () => true) {\n    //     let {\n    //         sri, sci, eri, eci,\n    //     } = this;\n    //     let extraRiValue = eri;\n    //     let extraCiValue = eci;\n    //\n    //     if (sri - extraRiValue <= 0) {\n    //         sri = 0;\n    //     } else {\n    //         sri = sri - extraRiValue;\n    //     }\n    //\n    //     if (sci - extraCiValue <= 0) {\n    //         sci = 0;\n    //     } else {\n    //         sci = sci - extraCiValue;\n    //     }\n    //\n    //     for (let i = sri; i <= eri + extraRiValue; i += 1) {\n    //         if (rowFilter(i)) {\n    //             for (let j = sci; j <= eci + extraCiValue; j += 1) {\n    //                 cb(i, j, eri, eci);\n    //             }\n    //         }\n    //     }\n    // }\n\n    // eachGivenRange(cb, mri, mci) {\n    //     let sri = 0;\n    //     let sci = 0;\n    //     let eri = mri;\n    //     let eci = mci;\n    //\n    //     for (let i = sri; i <= eri; i += 1) {\n    //         for (let j = sci; j <= eci; j += 1) {\n    //             cb(i, j, eri, eci);\n    //         }\n    //     }\n    // }\n\n    move(ri, ci) {\n        let d = this.eri - this.sri;        // 格子的长 单位 格\n        let d2 = this.eci - this.sci;            // 格子的 宽 单位格\n        this.sri = ri;\n        this.sci = ci;\n        this.eri = this.sri + d;\n        this.eci = this.sci + d2;\n    }\n\n    move2(ri, ci, eri, eci) {\n        this.sri = ri;\n        this.sci = ci;\n        this.eri = eri;\n        this.eci = eci;\n    }\n\n    contains(other) {\n        return this.sri <= other.sri\n            && this.sci <= other.sci\n            && this.eri >= other.eri\n            && this.eci >= other.eci;\n    }\n\n    // within\n    within(other) {\n        return this.sri >= other.sri\n            && this.sci >= other.sci\n            && this.eri <= other.eri\n            && this.eci <= other.eci;\n    }\n\n    // disjoint\n    disjoint(other) {\n        return this.sri > other.eri\n            || this.sci > other.eci\n            || other.sri > this.eri\n            || other.sci > this.eci;\n    }\n\n    // intersects\n    intersects(other) {\n        return this.sri <= other.eri\n            && this.sci <= other.eci\n            && other.sri <= this.eri\n            && other.sci <= this.eci;\n    }\n\n    getMovePos(ri, ci) {\n        let {sri, sci, eri, eci} = this;\n\n        let pos = 0;\n        if (ri > eri && ci > eci) {\n            pos = 1;        // 往下往右\n        } else if(ri > eri && ci < sci) {\n            pos = 7;        // 往下往左\n        } else if(ri < sri && ci > eci) {\n            pos = 8;        // 往上往右\n        } else if(ci < sci && ri < sri) {\n            pos = 4;        // 往上往左\n        } else if(ri > eri) {\n            pos = 2;        // 往下\n        } else if(ci > eci) {\n            pos = 3;        // 往右\n        }  else if(ci < sci) {\n            pos = 5;        // 往左\n        } else if(ri < sri) {\n            pos = 6;        // 往上\n        }\n\n        return pos;\n    }\n\n    // union\n    union(other) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        return new CellRange(\n            other.sri < sri ? other.sri : sri,\n            other.sci < sci ? other.sci : sci,\n            other.eri > eri ? other.eri : eri,\n            other.eci > eci ? other.eci : eci,\n        );\n    }\n\n    // intersection\n    // intersection(other) {}\n\n    // Returns Array<CellRange> that represents that part of this that does not intersect with other\n    // difference\n    difference(other) {\n        const ret = [];\n        const addRet = (sri, sci, eri, eci) => {\n            ret.push(new CellRange(sri, sci, eri, eci));\n        };\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        const dsr = other.sri - sri;\n        const dsc = other.sci - sci;\n        const der = eri - other.eri;\n        const dec = eci - other.eci;\n        if (dsr > 0) {\n            addRet(sri, sci, other.sri - 1, eci);\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, eci);\n                if (dsc > 0) {\n                    addRet(other.sri, sci, other.eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, other.eri, eci);\n                }\n            } else {\n                if (dsc > 0) {\n                    addRet(other.sri, sci, eri, other.sci - 1);\n                }\n                if (dec > 0) {\n                    addRet(other.sri, other.eci + 1, eri, eci);\n                }\n            }\n        } else if (der > 0) {\n            addRet(other.eri + 1, sci, eri, eci);\n            if (dsc > 0) {\n                addRet(sri, sci, other.eri, other.sci - 1);\n            }\n            if (dec > 0) {\n                addRet(sri, other.eci + 1, other.eri, eci);\n            }\n        }\n        if (dsc > 0) {\n            addRet(sri, sci, eri, other.sci - 1);\n            if (dec > 0) {\n                addRet(sri, other.eri + 1, eri, eci);\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, other.eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, other.eci);\n                }\n            } else {\n                if (dsr > 0) {\n                    addRet(sri, other.sci, other.sri - 1, eci);\n                }\n                if (der > 0) {\n                    addRet(other.sri + 1, other.sci, eri, eci);\n                }\n            }\n        } else if (dec > 0) {\n            addRet(eri, other.eci + 1, eri, eci);\n            if (dsr > 0) {\n                addRet(sri, sci, other.sri - 1, other.eci);\n            }\n            if (der > 0) {\n                addRet(other.eri + 1, sci, eri, other.eci);\n            }\n        }\n        return ret;\n    }\n\n    size() {\n        return [\n            this.eri - this.sri + 1,\n            this.eci - this.sci + 1,\n        ];\n    }\n\n    toString() {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n        let ref = xy2expr(sci, sri);\n        if (this.multiple()) {\n            ref = `${ref}:${xy2expr(eci, eri)}`;\n        }\n        return ref;\n    }\n\n    includeByRiCi(ri, ci) {\n        const {\n            sri, sci, eri, eci,\n        } = this;\n\n        return sri <= ri && eri >= ri && sci <= ci && eci >= ci;\n    }\n\n    // clone() {\n    //     const {\n    //         sri, sci, eri, eci, w, h,\n    //     } = this;\n    //     return new CellRange(sri, sci, eri, eci, w, h);\n    // }\n\n    getLocationArray(sarr) {\n        let darr = [];\n        let index = 0;\n        this.each((i, j) => {\n            darr.push({ri: i, ci: j, v: sarr[index % sarr.length].tmp, type: sarr[index % sarr.length].type});\n            index = index + 1;\n        });\n\n        return darr;\n    }\n\n    /*\n    toJSON() {\n      return this.toString();\n    }\n    */\n\n    equals(other) {\n        return this.eri === other.eri\n            && this.eci === other.eci\n            && this.sri === other.sri\n            && this.sci === other.sci;\n    }\n\n    static valueOf(ref) {\n        // B1:B8, B1 => 1 x 1 cell range\n        const refs = ref.split(':');\n        const [sci, sri] = expr2xy(refs[0]);\n        let [eri, eci] = [sri, sci];\n        if (refs.length > 1) {\n            [eci, eri] = expr2xy(refs[1]);\n        }\n        return new CellRange(sri, sci, eri, eci);\n    }\n}\n\nexport default CellRange;\n\nexport {\n    CellRange,\n};\n","exports.nil = new Error('#NULL!');\nexports.div0 = new Error('#DIV/0!');\nexports.value = new Error('#VALUE?');\nexports.ref = new Error('#REF!');\nexports.name = new Error('#NAME?');\nexports.num = new Error('#NUM!');\nexports.na = new Error('#N/A');\nexports.error = new Error('#ERROR!');\nexports.data = new Error('#GETTING_DATA');\n","/* global window */\n\n// import {setColor} from \"../plug-in/revision\";\n\nlet removeEvent = [];\n\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n    removeEvent.push({\n        name: name,\n        fn: fn,\n        target: target\n    })\n}\n\nexport function remove() {\n    for (let i = 0; i < removeEvent.length; i++) {\n        let re = removeEvent[i];\n        unbind(re.target, re.name, re.fn);\n    }\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\nexport function createEvent(keyCode, metaKey, name = \"keydown\", buttons = -1) {\n    let event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventType = 'message';\n    event.buttons = buttons;\n    event.keyCode = keyCode;\n    event.metaKey = metaKey;\n    document.dispatchEvent(event);\n}\n\n// the left mouse button: mousedown → mouseup → click\n// the right mouse button: mousedown → contenxtmenu → mouseup\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\n// export function bindClickoutside2(el, revision) {\n//     el.xclickoutside = (evt) => {\n//         // ignore double click\n//         // console.log('evt:', evt);\n//         if (evt.buttons === 2 || el.contains(evt.target)) return false;\n//         else {\n//             // setColor.call(revision);\n//             el.hide();\n//             unbindClickoutside(el);\n//         }\n//     };\n//     bind(window.document.body, 'mousedown', el.xclickoutside);\n// }\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    target.xEvtUp = (evt) => {\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n","/* global window */\nimport en from './en';\n\nlet $lang = 'en';\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages && messages[$lang]) {\n        let message = messages[$lang];\n        const keys = key.split('.');\n        for (let i = 0; i < keys.length; i += 1) {\n            const property = keys[i];\n            const value = message[property];\n            if (i === keys.length - 1) return value;\n            if (!value) return undefined;\n            message = value;\n        }\n    }\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x && window.x.spreadsheet && window.x.spreadsheet.$messages) {\n        v = translate(key, window.x.spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\nfunction locale(lang, message) {\n    $lang = lang;\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","var error = require('./error');\n\nfunction flattenShallow(array) {\n  if (!array || !array.reduce) { return array; }\n  return array.reduce(function(a, b) {\n    var aIsArray = Array.isArray(a);\n    var bIsArray = Array.isArray(b);\n    if (aIsArray && bIsArray ) {\n      return a.concat(b);\n    }\n    if (aIsArray) {\n      a.push(b);\n      return a;\n    }\n    if (bIsArray) {\n      return [a].concat(b);\n    }\n    return [a, b];\n  });\n}\n\nfunction isFlat(array) {\n  if (!array) { return false; }\n  for (var i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexports.flatten = function() {\n  var result = exports.argsToArray.apply(null, arguments);\n  while (!isFlat(result)) {\n    result = flattenShallow(result);\n  }\n  return result;\n};\n\nexports.argsToArray = function(args) {\n  return Array.prototype.slice.call(args, 0);\n};\n\nexports.numbers = function() {\n\n  return possibleNumbers.filter(function(el) {\n    return typeof el === 'number';\n  });\n};\n//XW: 将参数解析成数字数组，若有不符合要求的报错，default0忽略\nfunction parse(a){\n  if (a instanceof Error){\n    return a\n  }\n  if (a instanceof Array){\n    var arr = []\n    for (var i=0;i<a.length;i++){\n      if (typeof a[i][0] === 'string' && a[i][0] !== 'default_0'){\n        return error.name\n      }\n      if (typeof a[i][0] === 'number'){\n        arr.push(a[i][0])\n      }\n      if (a[i][0] instanceof Object){\n        return error.name\n      }\n    }\n    return arr\n  }\n  if (typeof a === 'string'){\n    if (a === 'default_0'){\n      return 'pass'\n    }else{\n      return error.name\n    }\n  }\n  if (typeof a === 'number'){\n    return a\n  }\n}\nexports.flattenNum = function(args) {\n  try{\n    if (args.length === 1 && args[0][0] === 'default_0'){\n      return error.div0\n    }\n    var arr = []\n    for( var i=0;i<args.length;i++){\n      var p = parse(args[i])\n      if (p === undefined){\n        return error.name\n      }\n      if (p instanceof Error){\n        return p\n      }else if(p !== 'pass'){\n        if (p instanceof Array){\n          for (var n=0; n < p.length;n++){\n            arr.push(p[n])\n          }\n        }else{\n          arr.push(p)\n        }\n      }\n    }\n    return arr\n  }catch{\n    return error.name\n  }\n};\n//XW:end\n\nexports.cleanFloat = function(number) {\n  var power = 1e14;\n  return Math.round(number * power) / power;\n};\n\nexports.parseBool = function(bool) {\n  if (bool === undefined){\n    return true\n  }\n  if (typeof bool === 'boolean') {\n    return bool;\n  }\n\n  if (bool instanceof Error) {\n    return bool;\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0;\n  }\n\n  if (typeof bool === 'string') {\n    var up = bool.toUpperCase();\n    if (up === 'TRUE') {\n      return true;\n    }\n\n    if (up === 'FALSE') {\n      return false;\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true;\n  }\n\n  return error.value;\n};\n\nexports.parseNumber = function(string) {\n  if (string === undefined || string === '') {\n    return error.value;\n  }\n  if (!isNaN(string)) {\n    return parseFloat(string);\n  }\n  return error.value;\n};\n\nexports.parseNumberArray = function(arr) {\n  var len;\n  if (!arr || (len = arr.length) === 0) {\n    return error.value;\n  }\n  var parsed;\n  while (len--) {\n    parsed = exports.parseNumber(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.parseMatrix = function(matrix) {\n  var n;\n  if (!matrix || (n = matrix.length) === 0) {\n    return error.value;\n  }\n  var pnarr;\n  for (var i = 0; i < matrix.length; i++) {\n    pnarr = exports.parseNumberArray(matrix[i]);\n    matrix[i] = pnarr;\n    if (pnarr instanceof Error) {\n      return pnarr;\n    }\n  }\n  return matrix;\n};\n\nvar d1900 = new Date(1900, 0, 1);\nexports.parseDate = function(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date);\n    }\n    var d = parseInt(date, 10);\n    if (d < 0) {\n      return error.num;\n    }\n    if (d <= 60) {\n      return new Date(d1900.getTime() + (d - 1) * 86400000);\n    }\n    return new Date(d1900.getTime() + (d - 2) * 86400000);\n  }\n  if (typeof date === 'string') {\n    date = new Date(date);\n    if (!isNaN(date)) {\n      return date;\n    }\n  }\n  return error.value;\n};\nexports.Copy =  function (obj) {\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n  // Handle Date\n  if (obj instanceof Date) {\n    var copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n  // Handle Array\n  if (obj instanceof Array) {\n    var copy = [];\n    for (var i = 0; i < obj.length; ++i) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n  // Handle Object\n  if (obj instanceof Object) {\n    var copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n//XW:{}中参数解析,将{1,2,3；4,5,6}这样的参数解析为数组结构\nfunction parse_arg(arg) {\n  if(!isNaN(parseInt(arg))){\n    return parseInt(arg)\n  }\n  return arg.replace('\"', '').replace('\"', '')\n}\nexports.strToMatrix = function (str) {\n  var arg = str.slice(2,str.length-2).split(',')\n  var matrix = [];\n  var arr = []\n  for (var i=0; i < arg.length; i++){\n    var num = arg[i].toString()\n    if (num.indexOf(';') > 0) {\n      arr.push(parse_arg(num.split(';')[0]))\n      matrix.push(arr)\n      arr = [parse_arg(num.split(';')[1])]\n    }else{\n      arr.push(parse_arg(num))\n    }\n  }\n  matrix.push(arr)\n  return matrix\n}\n//XW: end\n//XW：excel日期转js日期\nexports.ExcelDateToJSDate = function (date) {\n  if (typeof date == 'string'){\n    date = utils.parseDate(issue)\n  }\n  return (date instanceof Date) ? date : new Date(Math.round((date - 25569)*86400*1000));\n}\n//XW：end\n//XW：判定是否是数字\nexports.isNumber = function (val) {\n  var regPos = /^\\d+(\\.\\d+)?$/; //非负浮点数\n  var regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //负浮点数\n  if(regPos.test(val) || regNeg.test(val)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n//XW：end\nexports.parseDateArray = function(arr) {\n  var len = arr.length;\n  var parsed;\n  while (len--) {\n    parsed = this.parseDate(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.anyIsError = function() {\n  var n = arguments.length;\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexports.arrayValuesToNumbers = function(arr) {\n  var n = arr.length;\n  var el;\n  while (n--) {\n    el = arr[n];\n    if (typeof el === 'number') {\n      continue;\n    }\n    if (el === true) {\n      arr[n] = 1;\n      continue;\n    }\n    if (el === false) {\n      arr[n] = 0;\n      continue;\n    }\n    if (typeof el === 'string') {\n      var number = this.parseNumber(el);\n      if (number instanceof Error) {\n        arr[n] = 0;\n      } else {\n        arr[n] = number;\n      }\n    }\n  }\n  return arr;\n};\n\nexports.rest = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(idx);\n};\n\nexports.initial = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(0, array.length - idx);\n};\n","import {Element, h} from './element';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Dropdown extends Element {\n    constructor(title, width, showArrow, placement, {type, change, arrowChange, historyBorder}, ...children) {\n        super('div', `${cssPrefix}-dropdown ${placement}`);\n\n        this.title = title;\n        this.change = () => {\n        };\n        if (typeof title === 'string') {\n            this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n        } else if (showArrow) {\n            this.title.addClass('arrow-left');\n        }\n        this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n            .children(...children)\n            .css('width', width)\n            .hide();\n\n        if (type) {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`).on('click', change);\n            this.headerEl.children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right_d`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`).on('click.stop', (evt) => {\n                        arrowChange(historyBorder);\n                        if (this.contentEl.css('display') !== 'block') {\n                            this.show();\n                        } else {\n                            this.hide();\n                        }\n                    }),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        } else {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n            this.headerEl.on('click', () => {\n                if (this.contentEl.css('display') !== 'block') {\n                    this.show();\n                } else {\n                    this.hide();\n                }\n            }).children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        }\n    }\n\n    setTitle(title) {\n        this.title.html(title);\n        this.hide();\n    }\n\n    show() {\n        const {contentEl} = this;\n        contentEl.show();\n        this.parent().active();\n        bindClickoutside(this.parent(), () => {\n            this.hide();\n        });\n    }\n\n    hide() {\n        this.parent().active(false);\n        this.contentEl.hide();\n        unbindClickoutside(this.parent());\n    }\n}\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","/**\n formulas:\n key\n title\n render\n */\nimport {tf} from '../locale/locale';\nimport XLSX_CALC from \"../calc\"\nlet formulajs = require('../calc/formulajs/index'); // jobs: todo: 这里为何又多出3个函数？似乎应该统一放到formulajs中解决。\nconst baseFormulas = [\n    {\n        key: 'MD.WLAND',\n        title: tf('formula.wland'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.WFR',\n        title: tf('formula.wfr'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.RTD',\n        title: tf('formula.rtd'),\n        render: ary => ary.join(''),\n    },\n];\n\nlet formulas = deepCopy(baseFormulas);\n\nconst formulaCalc = () => {\n    XLSX_CALC.import_functions(formulajs);\n    let xlsx_Fx = XLSX_CALC.xlsx_Fx;\n    formulas = deepCopy(baseFormulas);\n    Object.keys(xlsx_Fx).forEach(i => {\n        let args = {\n            key: i,\n            title: i,\n            render: xlsx_Fx[i]\n        };\n        formulas.push(args);\n    });\n\n\n    return XLSX_CALC;\n};\n\nfunction deepCopy(obj) {\n    let result = Array.isArray(obj) ? [] : {};\n    for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n                result[key] = deepCopy(obj[key]);\n            } else {\n                result[key] = obj[key];\n            }\n        }\n    }\n    return result;\n}\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n    formulaCalc,\n};\n","var numeric = require('numeric');\nvar utils = require('./utils');\nvar error = require('./error');\nvar statistical = require('./statistical');\nvar information = require('./information');\n\nexports.ABS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.abs(utils.parseNumber(number));\n};\n\nexports.ACOS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.acos(number);\n};\n\nexports.ACOSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number - 1));\n};\n\nexports.ACOT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(1 / number);\n};\n\nexports.ACOTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 0.5 * Math.log((number + 1) / (number - 1));\n};\n\n//TODO: use options\nexports.AGGREGATE = function(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num);\n  options = utils.parseNumber(options);\n  //XW: 函数报错\n  if (typeof ref1 == 'string') {\n    return error.value\n  }//XW:end\n  if (utils.anyIsError(function_num, options)) {\n    return error.value;\n  }\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n    case 12:\n      return statistical.MEDIAN(ref1, ref2);\n    case 13:\n      return statistical.MODE.SNGL(ref1);\n    case 14:\n      return statistical.LARGE(ref1, ref2);\n    case 15:\n      if (ref2 == undefined){\n        return error.value\n      }\n      return statistical.SMALL(ref1, ref2);\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2);\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2);\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2);\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2);\n  }\n};\n\nexports.ARABIC = function(text) {\n  // Credits: Rafa? Kukawski\n  text = text.toUpperCase()\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value;\n  }\n  var r = 0;\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i];\n  });\n  return r;\n};\n\nexports.ASIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.asin(number);\n};\n\nexports.ASINH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number + 1));\n};\n\nexports.ATAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(number);\n};\n\nexports.ATAN2 = function(number_x, number_y) {\n  number_x = utils.parseNumber(number_x);\n  number_y = utils.parseNumber(number_y);\n  if (utils.anyIsError(number_x, number_y)) {\n    return error.value;\n  }\n  return Math.atan2(number_x, number_y);\n};\n\nexports.ATANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log((1 + number) / (1 - number)) / 2;\n};\n\nexports.BASE = function(number, radix, min_length) {\n  min_length = min_length || 0;\n\n  number = utils.parseNumber(number);\n  radix = utils.parseNumber(radix);\n  min_length = utils.parseNumber(min_length);\n  if (utils.anyIsError(number, radix, min_length)) {\n    return error.value;\n  }\n  min_length = (min_length === undefined) ? 0 : min_length;\n  var result = number.toString(radix);\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n};\n\nexports.CEILING = function(number, significance, mode) {\n  significance = (significance === undefined) ? 1 : Math.abs(significance);\n  mode = mode || 0;\n\n  number = utils.parseNumber(number);\n  significance = utils.parseNumber(significance);\n  mode = utils.parseNumber(mode);\n  if (utils.anyIsError(number, significance, mode)) {\n    return error.value;\n  }\n  if (significance === 0) {\n    return 0;\n  }\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return exports.ROUND(Math.ceil(number / significance) * significance, precision);\n  } else {\n    if (mode === 0) {\n      return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n    } else {\n      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n    }\n  }\n};\n\nexports.CEILING.MATH = exports.CEILING;\n\nexports.CEILING.PRECISE = exports.CEILING;\n\nexports.COMBIN = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n};\n\nexports.COMBINA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n};\n\nexports.COS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.cos(number);\n};\n\nexports.COSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return (Math.exp(number) + Math.exp(-number)) / 2;\n};\n\nexports.COT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.tan(number);\n};\n\nexports.COTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 + 1) / (e2 - 1);\n};\n\nexports.CSC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.sin(number);\n};\n\nexports.CSCH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) - Math.exp(-number));\n};\n\nexports.DECIMAL = function(number, radix) {\n  if (arguments.length < 1) {\n    return error.value;\n  }\n\n\n  return parseInt(number, radix);\n};\n\nexports.DEGREES = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * 180 / Math.PI;\n};\n\nexports.EVEN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return exports.CEILING(number, -2, -1);\n};\n\nexports.EXP = Math.exp;\n\nvar MEMOIZED_FACT = [];\nexports.FACT = function (number) {\n  number = utils.parseNumber(number);\n  if (number < 0){\n    return error.num\n  }\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n === 0 || n === 1) {\n    return 1;\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n];\n  } else {\n    MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n    return MEMOIZED_FACT[n];\n  }\n};\n\nexports.FACTDOUBLE = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n <= 0) {\n    return 1;\n  } else {\n    return n * exports.FACTDOUBLE(n - 2);\n  }\n};\n\n//TODO: Verify\n// XW: 自己写的函数\nexports.FLOOR = {};\nvar ROUND = function (value, places) {\n  var n = value;\n  var d = places;\n  return Math.round(n * Math.pow(10, d)) / Math.pow(10, d);\n};\nexports.FLOORMATH = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number>0&&significance<0){\n    return error.num\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\nexports.FLOORPRACE = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\n\n// Deprecated\nexports.FLOOR.MATH = exports.FLOORMATH;\nexports.FLOOR.PRECISE = exports.FLOORPRACE;\n//XW: end\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexports.GCD = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var r0 = range[0];\n  var x = r0 < 0 ? -r0 : r0;\n  for (var i = 1; i < n; i++) {\n    var ri = range[i];\n    var y = ri < 0 ? -ri : ri;\n    while (x && y) {\n      if (x > y) {\n        x %= y;\n      } else {\n        y %= x;\n      }\n    }\n    x += y;\n  }\n  return x;\n};\n\n\nexports.INT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.floor(number);\n};\n\n//TODO: verify\nexports.ISO = {\n  CEILING: exports.CEILING\n};\n\nexports.LCM = function() {\n  // Credits: Jonas Raoni Soares Silva\n  var o = utils.parseNumberArray(utils.flatten(arguments));\n  if (o instanceof Error) {\n    return o;\n  }\n  for (var i, j, n, d, r = 1;\n    (n = o.pop()) !== undefined;) {\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          //empty\n        }\n        d = (i <= j) ? i : n;\n      } else {\n        d = 2;\n      }\n      for (n /= d, r *= d, i = o.length; i;\n        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        //empty\n      }\n    }\n  }\n  return r;\n};\n\nexports.LN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number);\n};\n\nexports.LOG = function (number, base) {\n  number = utils.parseNumber(number);\n  base = utils.parseNumber(base);\n  if (utils.anyIsError(base)) {\n    base = 10\n  }\n  base = (base === undefined) ? 10 : base;\n  return Math.log(number) / Math.log(base);\n};\n\nexports.LOG10 = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number) / Math.log(10);\n};\n\nexports.MDETERM = function(matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix);\n  }\n  try{\n    return numeric.det(matrix);\n  }catch (e) {\n    return error.value\n  }\n};\n\nexports.MINVERSE = function(matrix) {\n  matrix = utils.parseMatrix(matrix);\n  if (matrix instanceof Error) {\n    return matrix;\n  }\n  return numeric.inv(matrix);\n};\n\nexports.MMULT = function(matrix1, matrix2) {\n  matrix1 = utils.parseMatrix(matrix1);\n  matrix2 = utils.parseMatrix(matrix2);\n  if (utils.anyIsError(matrix1, matrix2)) {\n    return error.value;\n  }\n  console.log(numeric.dot(matrix1, matrix2))\n  return numeric.dot(matrix1, matrix2);\n};\n\nexports.MOD = function(dividend, divisor) {\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n  if (divisor === 0) {\n    return error.div0;\n  }\n  var modulus = Math.abs(dividend % divisor);\n  return (divisor > 0) ? modulus : -modulus;\n};\n\n  exports.MROUND = function(number, multiple) {\n  number = utils.parseNumber(number);\n  multiple = utils.parseNumber(multiple);\n  if (utils.anyIsError(number, multiple)) {\n    return error.value;\n  }\n  if (number * multiple < 0) {\n    return error.num;\n  }\n\n  return Math.round(number / multiple) * multiple;\n};\n\nexports.MULTINOMIAL = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var sum = 0;\n  var divisor = 1;\n  for (var i = 0; i < args.length; i++) {\n    sum += args[i];\n    divisor *= exports.FACT(args[i]);\n  }\n  return exports.FACT(sum) / divisor;\n};\n\nexports.MUNIT = function(dimension) {\n  dimension = utils.parseNumber(dimension);\n  if (dimension instanceof Error) {\n    return dimension;\n  }\n  return numeric.identity(dimension);\n};\n\nexports.ODD = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var temp = Math.ceil(Math.abs(number));\n  temp = (temp & 1) ? temp : temp + 1;\n  return (number > 0) ? temp : -temp;\n};\n\nexports.PI = function() {\n  return Math.PI;\n};\n\nexports.POWER = function(number, power) {\n  number = utils.parseNumber(number);\n  power = utils.parseNumber(power);\n  if (utils.anyIsError(number, power)) {\n    return error.value;\n  }\n  var result = Math.pow(number, power);\n  if (isNaN(result)) {\n    return error.num;\n  }\n\n  return result;\n};\n\nexports.PRODUCT = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var result = 1;\n  for (var i = 0; i < args.length; i++) {\n    result *= args[i];\n  }\n  return result;\n};\n\nexports.QUOTIENT = function(numerator, denominator) {\n  numerator = utils.parseNumber(numerator);\n  denominator = utils.parseNumber(denominator);\n  if (utils.anyIsError(numerator, denominator)) {\n    return error.value;\n  }\n  return parseInt(numerator / denominator, 10);\n};\n\nexports.RADIANS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * Math.PI / 180;\n};\n\nexports.RAND = function() {\n  if (arguments.length > 0 && arguments[0] !== undefined){\n    return error.value\n  }\n  return Math.random();\n};\n\nexports.RANDBETWEEN = function(bottom, top) {\n  bottom = utils.parseNumber(bottom);\n  top = utils.parseNumber(top);\n  if (utils.anyIsError(bottom, top)) {\n    return error.value;\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n};\n\n// TODO\nexports.ROMAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  var digits = String(number).split('');\n  var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];\n  var roman = '';\n  var i = 3;\n  while (i--) {\n    roman = (key[+digits.pop() + (i * 10)] || '') + roman;\n  }\n  return new Array(+digits.join('') + 1).join('M') + roman;\n};\n\nexports.ROUND = function (number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  if (number < 0){\n    number = 0-number\n    return 0-Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n  }\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n};\n\nexports.ROUNDDOWN = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.ROUNDUP = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.SEC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.cos(number);\n};\n\nexports.SECH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) + Math.exp(-number));\n};\n\nexports.SERIESSUM = function(x, n, m, coefficients) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  m = utils.parseNumber(m);\n  coefficients = utils.parseNumberArray(coefficients);\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value;\n  }\n  var result = coefficients[0] * Math.pow(x, n);\n  for (var i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m);\n  }\n  return result;\n};\n\nexports.SIGN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  if (number < 0) {\n    return -1;\n  } else if (number === 0) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\nexports.SIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.sin(number);\n};\n\n  exports.SINH = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return (Math.exp(number) - Math.exp(-number)) / 2;\n  };\n\n  exports.SQRT = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    if (number < 0) {\n      return error.num;\n    }\n    return Math.sqrt(number);\n  };\n\n  exports.SQRTPI = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return Math.sqrt(number * Math.PI);\n  };\n\nexports.SUBTOTAL = function(function_code, ref1) {\n  function_code = utils.parseNumber(function_code);\n  if (function_code instanceof Error) {\n    return function_code;\n  }\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n      // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1);\n    case 102:\n      return statistical.COUNT(ref1);\n    case 103:\n      return statistical.COUNTA(ref1);\n    case 104:\n      return statistical.MAX(ref1);\n    case 105:\n      return statistical.MIN(ref1);\n    case 106:\n      return exports.PRODUCT(ref1);\n    case 107:\n      return statistical.STDEV.S(ref1);\n    case 108:\n      return statistical.STDEV.P(ref1);\n    case 109:\n      return exports.SUM(ref1);\n    case 110:\n      return statistical.VAR.S(ref1);\n    case 111:\n      return statistical.VAR.P(ref1);\n\n  }\n};\n\nexports.ADD = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.name;\n  }\n\n  return num1 + num2;\n};\n\nexports.MINUS = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.value;\n  }\n\n  return num1 - num2;\n};\n\nexports.DIVIDE = function (dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n\n  if (divisor === 0) {\n    return error.div0;\n  }\n\n  return dividend / divisor;\n};\n\nexports.MULTIPLY = function (factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  factor1 = utils.parseNumber(factor1);\n  factor2 = utils.parseNumber(factor2);\n  if (utils.anyIsError(factor1, factor2)) {\n    return error.value;\n  }\n\n  return factor1 * factor2;\n};\n\nexports.GTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 >= num2;\n};\n\nexports.LT = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 < num2;\n};\n\n\nexports.LTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 <= num2;\n};\n\nexports.EQ = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 === value2;\n};\n\nexports.NE = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 !== value2;\n};\n\nexports.POW = function (base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  base = utils.parseNumber(base);\n  exponent = utils.parseNumber(exponent);\n  if (utils.anyIsError(base, exponent)) {\n    return error.error;\n  }\n\n  return exports.POWER(base, exponent);\n};\n\nexports.SUM = function() {\n  var result = 0;\n  var argsKeys = Object.keys(arguments);\n  for (var i = 0; i < argsKeys.length; ++i) {\n    var elt = arguments[argsKeys[i]];\n    if (typeof elt === 'number') {\n      result += elt;\n    } else if (typeof elt === 'string') {\n      var parsed = parseFloat(elt);\n      !isNaN(parsed) && (result += parsed);\n    } else if (Array.isArray(elt)) {\n      result += exports.SUM.apply(null, elt);\n    }\n  }\n  return result;\n};\n\nexports.SUMIF = function(range, criteria) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (range instanceof Error) {\n    return range;\n  }\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\n  }\n  return result;\n};\n//XW： SUMIFS函数\nexports.SUMIFS = function() {\n  var args = utils.argsToArray(arguments);\n  var range = utils.flatten(args.shift());\n  if (range instanceof Error) {\n    return range;\n  }\n  if (args.length % 2 !== 0) {\n    return error.value;\n  }\n  for (let i = 0; i < args.length; i += 2) {\n    if (args[i].length !== range.length || !args[i + 1]) {\n      return error.value;\n    }\n  }\n  let arr = [];\n  var result = 0;\n  for (let i = 0; i < args.length; i += 2) {\n    let s_arr = [];\n    for (let j = 0; j < args[i].length; j++) {\n      let compareValue = args[i + 1] + \"\";\n      if (compareValue.lastIndexOf(\">=\") == 0) {\n        compareValue = compareValue.replace(/>=/, \"\");\n        if (isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 <= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }else if (compareValue.lastIndexOf(\"<=\") == 0) {\n        compareValue = compareValue.replace(/<=/, \"\");\n        if(isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 >= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }\n      compareValue = compareValue.replace(\"=\", \"\");\n      if (compareValue.lastIndexOf(\"<>\") == 0) {\n        compareValue = compareValue.replace(/<>/, \"\");\n        if (compareValue !== args[i][j][0]) {\n          s_arr.push(j);\n        }\n      } else {\n        let str = false;\n        if (compareValue.lastIndexOf(\"<\") == 0) {\n          compareValue = compareValue.replace(/</, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 > args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else if (compareValue.lastIndexOf(\">\") == 0) {\n          compareValue = compareValue.replace(/>/, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 < args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else {\n          if (compareValue.indexOf('*') > 0){\n            var v = compareValue\n            v = v.replace('*', '')\n            if (typeof args[i][j][0] == 'string' && args[i][j][0].indexOf(v) >= 0){\n              s_arr.push(j);\n            }\n          }\n          if(isNaN(compareValue)) {\n            if(compareValue === args[i][j][0]) {\n              s_arr.push(j);\n            }\n          } else {\n            if(compareValue * 1 === args[i][j][0]) {\n              s_arr.push(j);\n            }\n\n          }\n        }\n        if(str) {\n          return error.value;\n        }\n      }\n\n    }\n    arr.push(s_arr);\n  }\n\n  let resultArr = [];\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = 0; j < arr[i].length; j++) {\n      let value = arr[i][j];\n      let enter = 1;\n      for (let k = 0; enter !== 3 && k < arr.length; k++) {\n        if (k !== i && arr[k].indexOf(value) != -1) {\n          enter = 2;\n        } else if (k !== i) {\n          enter = 3;\n        }\n      }\n      if (enter == 1 && arr.length > 1) {\n        enter = 3;\n      } else if (enter == 1 && arr.length === 1) {\n        enter = 2;\n      }\n      if (enter == 2 && resultArr.indexOf(value) == -1) {\n        resultArr.push(value);\n      }\n    }\n  }\n\n  if (arr.length <= 0) {\n    return error.value;\n  }\n\n  for (let i = 0; i < resultArr.length; i++) {\n    let a = range[resultArr[i]];\n    if (a && !isNaN(a)) {\n      result += a;\n    } else {\n      return 0;\n    }\n  }\n\n  return result;\n};\n//XW：end\n\nexports.SUMPRODUCT = function() {\n  if (!arguments || arguments.length === 0) {\n    return error.value;\n  }\n  var arrays = arguments.length + 1;\n  var result = 0;\n  var product;\n  var k;\n  var _i;\n  var _ij;\n  for (var i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1;\n      for (k = 1; k < arrays; k++) {\n        _i = utils.parseNumber(arguments[k - 1][i]);\n        if (_i instanceof Error) {\n          return _i;\n        }\n        product *= _i;\n      }\n      result += product;\n    } else {\n      for (var j = 0; j < arguments[0][i].length; j++) {\n        product = 1;\n        for (k = 1; k < arrays; k++) {\n          _ij = utils.parseNumber(arguments[k - 1][i][j]);\n          if (_ij instanceof Error) {\n            return _ij;\n          }\n          product *= _ij;\n        }\n        result += product;\n      }\n    }\n  }\n  return result;\n};\n\nexports.SUMSQ = function() {\n  var numbers = utils.parseNumberArray(utils.flatten(arguments));\n  if (numbers instanceof Error) {\n    return numbers;\n  }\n  var result = 0;\n  var length = numbers.length;\n  for (var i = 0; i < length; i++) {\n    result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\n  }\n  return result;\n};\n\nexports.SUMX2MY2 = function (array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMX2PY2 = function (array_x, array_y) {\n  //XW: 参数转数组\n  if (typeof array_x == \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y == \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  //XW：end\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMXMY2 = function(array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.flatten(array_x);\n  array_y = utils.flatten(array_y);\n  for (var i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2);\n  }\n  return result;\n};\n\nexports.TAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.tan(number);\n};\n\nexports.TANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 - 1) / (e2 + 1);\n};\n\nexports.TRUNC = function(number, digits) {\n  digits = (digits === undefined) ? 0 : digits;\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};","var mathTrig = require('./math-trig');\nvar text = require('./text');\nvar jStat = require('jStat').jStat;\nvar utils = require('./utils');\nvar error = require('./error');\nvar misc = require('./miscellaneous');\nvar evalExpression = require('./expression')\nvar SQRT2PI = 2.5066282746310002;\n\nexports.AVEDEV = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length;\n};\n\nexports.AVERAGE = function() {\n  var range = utils.flattenNum(arguments);\n  if (range instanceof Error) {\n    return range;\n  }\n  if (range.length === 0){\n    return error.div0\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    sum += range[i];\n    count += 1;\n  }\n  return sum / count;\n};\n\nexports.AVERAGEA = function() {\n  var range = utils.flattenNum(arguments);\n  if (range.length == 1 && isNaN(range[0])){\n    return error.value\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sum += el;\n    }\n    if (el === true) {\n      sum++;\n    }\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sum / count;\n};\n\nexports.AVERAGEIF = function (range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na;\n  }\n  average_range = average_range || range;\n  range = utils.flatten(range);\n  average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n  if (average_range instanceof Error) {\n    return average_range;\n  }\n  var average_count = 0;\n  var result = 0;\n  var isWildcard = criteria === void 0 || criteria === '*';\n  var tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '');\n  var filter_criteria = criteria.replace('=', '').replace('*', '').replace('<>', '')\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n\n    if (isWildcard) {\n      result += average_range[i];\n      average_count++;\n    } else {\n      var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n      if (criteria.indexOf('<>') >= 0){\n        if (value.indexOf(filter_criteria) < 0) {\n          result += average_range[i];\n          average_count++;\n        }\n      }else if (evalExpression.compute(tokens) || value.toString().indexOf(filter_criteria) >= 0) {\n        result += average_range[i];\n        average_count++;\n      }\n    }\n  }\n  if (average_count == 0){\n    return error.div0\n  }\n  return result / average_count;\n};\n\nexports.AVERAGEIFS = function () {\n  // Does not work with multi dimensional ranges yet!\n  //http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  var args = utils.argsToArray(arguments);\n  var criteriaLength = (args.length - 1) / 2;\n  var range = utils.flatten(args[0]);\n  var count = 0;\n  var result = 0;\n\n  for (var i = 0; i < range.length; i++) {\n    var isMeetCondition = false;\n\n    for (var j = 0; j < criteriaLength; j++) {\n      var value = args[2 * j + 1][i];\n      var criteria = args[2 * j + 2];\n      var isWildcard = criteria === void 0 || criteria === '*';\n      var computedResult = false;\n\n      if (isWildcard) {\n        computedResult = true;\n      } else {\n        var tokenizedCriteria = evalExpression.parse(criteria + '');\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n        computedResult = evalExpression.compute(tokens);\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false;\n        break;\n      }\n\n      isMeetCondition = true;\n    }\n\n    if (isMeetCondition) {\n      result += range[i];\n      count++;\n    }\n  }\n\n  var average = result / count;\n\n  if (isNaN(average)) {\n    return error.div0;\n  } else {\n    return average;\n  }\n};\n\nexports.BETA = {};\n\nexports.BETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value;\n  }\n\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value;\n  }\n  cumulative = utils.parseBool(cumulative)\n  x = (x - A) / (B - A);\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)/2;\n};\n\nexports.BETA.INV = function(probability, alpha, beta, A, B) {\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value;\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A;\n};\n\nexports.BINOM = {};\n\nexports.BINOM.DIST = function (successes, trials, probability, cumulative) {\n  successes = utils.parseNumber(successes);\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  cumulative = utils.parseBool(cumulative)\n  cumulative = utils.parseNumber(cumulative);\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.binomial.cdf(successes, trials, probability) : jStat.binomial.pdf(successes, trials, probability);\n};\n\nexports.BINOM.INV = function(trials, probability, alpha) {\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value;\n  }\n\n  var x = 0;\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x;\n    }\n    x++;\n  }\n};\n\nexports.CHISQ = {};\n\nexports.CHISQ.DIST = function(x, k, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (x < 0){\n    return error.num\n  }\n  x = utils.parseNumber(x);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(x, k)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k);\n};\n\nexports.CHISQ.DIST.RT = function(x, k) {\n  if (!x | !k) {\n    return error.na;\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return 1 -  jStat.chisquare.cdf(x, k);\n};\n\nexports.CHISQ.INV = function(probability, k) {\n  probability = utils.parseNumber(probability);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(probability, k)) {\n    return error.value;\n  }\n  return jStat.chisquare.inv(probability, k);\n};\n\nexports.CHISQ.INV.RT = function(p, k) {\n  if (!p | !k) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k);\n};\n\nexports.CHISQ.TEST = function(observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {\n    return error.value;\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value;\n  }\n\n  if (observed[0] && expected[0] &&\n      observed[0].length !== expected[0].length) {\n    return error.value;\n  }\n\n  var row = observed.length;\n  var tmp, i, j;\n\n  // Convert single-dimension array into two-dimension array\n  for (i = 0; i < row; i ++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i];\n      observed[i] = [];\n      observed[i].push(tmp);\n    }\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i];\n      expected[i] = [];\n      expected[i].push(tmp);\n    }\n  }\n\n  var col = observed[0].length;\n  var dof = (col === 1) ? row-1 : (row-1)*(col-1);\n  var xsqr = 0;\n  var Pi =Math.PI;\n\n  for (i = 0; i < row; i ++) {\n    for (j = 0; j < col; j ++) {\n      xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    var p = Math.exp(-0.5 * xsqr);\n    if((dof%2) === 1) {\n      p = p * Math.sqrt(2 * xsqr/Pi);\n    }\n    var k = dof;\n    while(k >= 2) {\n      p = p * xsqr/k;\n      k = k - 2;\n    }\n    var t = p;\n    var a = dof;\n    while (t > 0.0000000001*p) {\n      a = a + 2;\n      t = t * xsqr/a;\n      p = p + t;\n    }\n    return 1-p;\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;\n};\n\nexports.COLUMN = function() {\n  col_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n  cell_name = this.args[0].formula.name\n  cell_name = cell_name.replace(/\\d+/g,'')\n  return col_list.indexOf(cell_name)+1\n};\n\nexports.COLUMNS = function(matrix) {\n  if (typeof matrix === 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.cols(matrix);\n};\n\nexports.CONFIDENCE = {};\n\nexports.CONFIDENCE.NORM = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.normalci(1, alpha, sd, n)[1] - 1;\n};\n\nexports.CONFIDENCE.T = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.tci(1, alpha, sd, n)[1] - 1;\n};\nexports.IFS = function() {\n  for (var i = 0; i + 1 < arguments.length; i += 2) {\n    var cond = arguments[i];\n    var val = arguments[i + 1];\n    if (cond) {\n      return val;\n    }\n  }\n  return error.na;\n}\nexports.CORREL = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.corrcoeff(array1, array2);\n};\n\nexports.COUNT = function() {\n  return utils.numbers(utils.flatten(arguments)).length;\n};\n\nexports.COUNTA = function() {\n  var range = utils.flatten(arguments);\n  return range.length - exports.COUNTBLANK(range);\n};\n\nexports.COUNTIN = function (range, value) {\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++;\n    }\n  }\n  return result;\n};\n\n\nexports.COUNTBLANK = function() {\n  var range = utils.flatten(arguments);\n  var blanks = 0;\n  var element;\n  for (var i = 0; i < range.length; i++) {\n    element = range[i];\n    if (element === null || element === '') {\n      blanks++;\n    }\n  }\n  return blanks;\n};\n\nexports.COUNTIF = function (range, criteria) {\n  range = utils.flatten(range);\n  if (criteria === undefined) {\n    return error.value;\n  }\n  var isWildcard = criteria === void 0 || criteria === '*';\n\n  if (isWildcard) {\n    return range.length;\n  }\n\n  var matches = 0;\n  var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n    var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n    if (evalExpression.compute(tokens)) {\n      matches++;\n    }\n  }\n\n  return matches;\n};\n\nexports.COUNTIFS = function () {\n  var args = utils.argsToArray(arguments);\n  var results = new Array(utils.flatten(args[0]).length);\n\n  for (var i = 0; i < results.length; i++) {\n    results[i] = true;\n  }\n  for (i = 0; i < args.length; i += 2) {\n    var range = utils.flatten(args[i]);\n    var criteria = args[i + 1];\n    var isWildcard = criteria === void 0 || criteria === '*';\n\n    if (!isWildcard) {\n      var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n      for (var j = 0; j < range.length; j++) {\n        var value = range[j];\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n        results[j] = results[j] && evalExpression.compute(tokens);\n      }\n    }\n  }\n  var result = 0;\n  for (i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++;\n    }\n  }\n  return result;\n};\n\nexports.COUNTUNIQUE = function () {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length;\n};\n\nexports.COVARIANCE = {};\n\nexports.COVARIANCE.P = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  var mean1 = jStat.mean(array1);\n  var mean2 = jStat.mean(array2);\n  var result = 0;\n  var n = array1.length;\n  for (var i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2);\n  }\n  return result / n;\n};\n\nexports.COVARIANCE.S = function(array1, array2) {\n  if (typeof array1 == \"string\") {\n    array1 = utils.strToMatrix(array1);\n  }\n  if (typeof array2 == \"string\") {\n    array2 = utils.strToMatrix(array2);\n  }\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.covariance(array1, array2);\n};\n\nexports.DEVSQ = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += Math.pow((range[i] - mean), 2);\n  }\n  return result;\n};\n\nexports.EXPON = {};\n\nexports.EXPON.DIST = function(x, lambda, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  lambda = utils.parseNumber(lambda);\n  if (utils.anyIsError(x, lambda)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda);\n};\n\nexports.F = {};\n\nexports.F.DIST = function (x, d1, d2, cumulative) {\n  x = utils.parseNumber(x);\n  d1 = utils.parseNumber(d1);\n  d2 = utils.parseNumber(d2);\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value;\n  }\n  if (cumulative == undefined){\n    cumulative = true\n  }\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value\n  }\n  if (cumulative == 'FALSE'){\n    cumulative = false\n  }\n  return (cumulative) ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2);\n};\n\nexports.F.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2);\n};\n\nexports.F.INV = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.TEST = function (array1, array2) {\n  if (!array1 || !array2) {\n    return error.na;\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na;\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0;\n  }\n\n  var sumOfSquares = function (values, x1) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n      sum += Math.pow((values[i] - x1), 2);\n    }\n    return sum;\n  };\n\n  var x1 = mathTrig.SUM(array1) / array1.length;\n  var x2 = mathTrig.SUM(array2) / array2.length;\n  var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);\n  var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);\n\n  return sum1 / sum2;\n};\n\nexports.FISHER = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return x;\n  }\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n\nexports.FISHERINV = function(y) {\n  y = utils.parseNumber(y);\n  if (y instanceof Error) {\n    return y;\n  }\n  var e2y = Math.exp(2 * y);\n  return (e2y - 1) / (e2y + 1);\n};\n\nexports.FORECAST = function(x, data_y, data_x) {\n  x = utils.parseNumber(x);\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var b = num / den;\n  var a = ymean - b * xmean;\n  return a + b * x;\n};\n\nexports.FREQUENCY = function(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data));\n  bins = utils.parseNumberArray(utils.flatten(bins));\n  if (utils.anyIsError(data, bins)) {\n    return error.value;\n  }\n  var n = data.length;\n  var b = bins.length;\n  var r = [];\n  for (var i = 0; i <= b; i++) {\n    r[i] = 0;\n    for (var j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1;\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1;\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1;\n        }\n      }\n    }\n  }\n  return r;\n};\n\n\nexports.GAMMA = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  if (number === 0) {\n    return error.num;\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num;\n  }\n\n  return jStat.gammafn(number);\n};\n\nexports.GAMMA.DIST = function(value, alpha, beta, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (arguments.length !== 4) {\n    return error.na;\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value;\n  }\n\n  if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false);\n};\n\nexports.GAMMA.INV = function(probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num;\n  }\n\n  if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta);\n};\n\nexports.GAMMALN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return jStat.gammaln(number);\n};\n\nexports.GAMMALN.PRECISE = function(x) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (x <= 0) {\n    return error.num;\n  }\n\n  if (typeof x !== 'number') {\n    return error.value;\n  }\n\n  return jStat.gammaln(x);\n};\n\nexports.GAUSS = function(z) {\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return z;\n  }\n  return jStat.normal.cdf(z, 0, 1) - 0.5;\n};\n\nexports.GEOMEAN = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  return jStat.geomean(args);\n};\n\nexports.GROWTH = function(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n\n  known_y = utils.parseNumberArray(known_y);\n  if (known_y instanceof Error) {\n    return known_y;\n  }\n\n  // Default values for optional parameters:\n  var i;\n  if (known_x === undefined) {\n    known_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i);\n    }\n  }\n  if (new_x === undefined) {\n    new_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i);\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x);\n  new_x = utils.parseNumberArray(new_x);\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value;\n  }\n\n\n  if (use_const === undefined) {\n    use_const = true;\n  }\n\n  // Calculate sums over the data:\n  var n = known_y.length;\n  var avg_x = 0;\n  var avg_y = 0;\n  var avg_xy = 0;\n  var avg_xx = 0;\n  for (i = 0; i < n; i++) {\n    var x = known_x[i];\n    var y = Math.log(known_y[i]);\n    avg_x += x;\n    avg_y += y;\n    avg_xy += x * y;\n    avg_xx += x * x;\n  }\n  avg_x /= n;\n  avg_y /= n;\n  avg_xy /= n;\n  avg_xx /= n;\n\n  // Compute linear regression coefficients:\n  var beta;\n  var alpha;\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);\n    alpha = avg_y - beta * avg_x;\n  } else {\n    beta = avg_xy / avg_xx;\n    alpha = 0;\n  }\n\n  // Compute and return result array:\n  var new_y = [];\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]));\n  }\n  return new_y;\n};\n\nexports.HARMEAN = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    den += 1 / range[i];\n  }\n  return n / den;\n};\n\nexports.HYPGEOM = {};\n\nexports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  M = utils.parseNumber(M);\n  N = utils.parseNumber(N);\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value;\n  }\n\n  function pdf(x, n, M, N) {\n    return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);\n  }\n\n  function cdf(x, n, M, N) {\n    var result = 0;\n    for (var i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N);\n    }\n    return result;\n  }\n\n  return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);\n};\n\nexports.INTERCEPT = function(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y);\n  known_x = utils.parseNumberArray(known_x);\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value;\n  }\n  if (known_y.length !== known_x.length) {\n    return error.na;\n  }\n  return exports.FORECAST(0, known_y, known_x);\n};\n\nexports.KURT = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4);\n  }\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4);\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));\n};\n\nexports.LARGE = function(range, k) {\n  range = utils.flatten(range)\n  var arr = []\n  for ( var i=0;i<range.length;i++){\n    if (parseFloat(range[i])){\n      arr.push((parseFloat(range[i])))\n    }\n  }\n  range = arr;\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function (a, b) {\n    return b - a;\n  })[k - 1];\n};\n\nexports.LINEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var ymean = jStat.mean(data_y);\n  var xmean = jStat.mean(data_x);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var m = num / den;\n  var b = ymean - m * xmean;\n  return [m, b];\n};\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexports.LOGEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  for (var i = 0; i < data_y.length; i ++) {\n    data_y[i] = Math.log(data_y[i]);\n  }\n\n  var result = exports.LINEST(data_y, data_x);\n  result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;\n  result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;\n  return result;\n};\n\nexports.LOGNORM = {};\n\nexports.LOGNORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd);\n};\n\nexports.LOGNORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.lognormal.inv(probability, mean, sd);\n};\n\nexports.MAX = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MAXA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MEDIAN = function() {\n  var arr = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  var arr2 = []\n  for (var i=0;i<arr.length;i++){\n    if (typeof arr[i] === 'number'){\n      arr2.push(arr[i])\n    }\n  }\n  var range = utils.arrayValuesToNumbers(utils.flatten(arr2));\n  return jStat.median(range);\n};\n\nexports.MIN = function() {\n  var range = utils.flatten(arguments);\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MINA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MODE = {};\n\nexports.MODE.MULT = function() {\n  // Credits: Roönaän\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var count = {};\n  var maxItems = [];\n  var max = 0;\n  var currentItem;\n\n  for (var i = 0; i < n; i++) {\n    currentItem = range[i];\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n    if (count[currentItem] > max) {\n      max = count[currentItem];\n      maxItems = [];\n    }\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem;\n    }\n  }\n  return maxItems;\n};\n\nexports.MODE.SNGL = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return exports.MODE.MULT(range).sort(function(a, b) {\n    return a - b;\n  })[0];\n};\n\nexports.NEGBINOM = {};\n\nexports.NEGBINOM.DIST = function(k, r, p, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  k = utils.parseNumber(k);\n  r = utils.parseNumber(r);\n  p = utils.parseNumber(p);\n  if (utils.anyIsError(k, r, p)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p);\n};\n\nexports.NORM = {};\n\nexports.NORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  if (sd <= 0) {\n    return error.num;\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return (cumulative) ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd);\n};\n\nexports.NORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, mean, sd);\n};\n\nexports.NORM.S = {};\n\nexports.NORM.S.DIST = function(z, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1);\n};\n\nexports.NORM.S.INV = function(probability) {\n  probability = utils.parseNumber(probability);\n  if (probability instanceof Error) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, 0, 1);\n};\n\nexports.PEARSON = function(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den1 = 0;\n  var den2 = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den1 += Math.pow(data_x[i] - xmean, 2);\n    den2 += Math.pow(data_y[i] - ymean, 2);\n  }\n  return num / Math.sqrt(den1 * den2);\n};\n\nexports.PERCENTILE = {};\n\nexports.PERCENTILE.EXC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    {\n      return a - b;\n    }\n  });\n  var n = array.length;\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num;\n  }\n  var l = k * (n + 1) - 1;\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTILE.INC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var n = array.length;\n  var l = k * (n - 1);\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTRANK = {};\n\nexports.PERCENTRANK.EXC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERCENTRANK.INC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERMUT = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);\n};\n\nexports.PERMUTATIONA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return Math.pow(number, number_chosen);\n};\n\nexports.PHI = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return error.value;\n  }\n  return Math.exp(-0.5 * x * x) / SQRT2PI;\n};\n\nexports.POISSON = {};\n\nexports.POISSON.DIST = function(x, mean, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  if (utils.anyIsError(x, mean)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean);\n};\n\nexports.PROB = function(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0;\n  }\n  upper = (upper === undefined) ? lower : upper;\n\n  range = utils.parseNumberArray(utils.flatten(range));\n  probability = utils.parseNumberArray(utils.flatten(probability));\n  lower = utils.parseNumber(lower);\n  upper = utils.parseNumber(upper);\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value;\n  }\n\n  if (lower === upper) {\n    return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\n  }\n\n  var sorted = range.sort(function(a, b) {\n    return a - b;\n  });\n  var n = sorted.length;\n  var result = 0;\n  for (var i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])];\n    }\n  }\n  return result;\n};\n\nexports.QUARTILE = {};\n\nexports.QUARTILE.EXC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.EXC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.EXC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.EXC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.QUARTILE.INC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.INC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.INC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.INC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.RANK = {};\n\nexports.RANK.AVG = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  range = utils.flatten(range);\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n\n  var length = range.length;\n  var count = 0;\n  for (var i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++;\n    }\n  }\n\n  return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n};\n\nexports.RANK.EQ = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n  return range.indexOf(number) + 1;\n};\n\nexports.ROW = function(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (index < 0) {\n    return error.num;\n  }\n\n  if (!(matrix instanceof Array) || (typeof index !== 'number')) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return undefined;\n  }\n\n  return jStat.row(matrix, index);\n};\n\nexports.ROWS = function(matrix) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\n\nexports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n  return Math.pow(exports.PEARSON(data_x, data_y), 2);\n};\n\nexports.SKEW = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3);\n  }\n  return n * sigma / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3));\n};\n\nexports.SKEW.P = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var m2 = 0;\n  var m3 = 0;\n  for (var i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3);\n    m2 += Math.pow(range[i] - mean, 2);\n  }\n  m3 = m3 / n;\n  m2 = m2 / n;\n  return m3 / Math.pow(m2, 3 / 2);\n};\n\nexports.SLOPE = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return num / den;\n};\n\nexports.SMALL = function(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function(a, b) {\n    return a - b;\n  })[k - 1];\n};\n\nexports.STANDARDIZE = function(x, mean, sd) {\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (x - mean) / sd;\n};\n\nexports.STDEV = {};\n\nexports.STDEV.P = function() {\n  var v = exports.VAR.P.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEV.S = function() {\n  var v = exports.VAR.S.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVA = function() {\n  var v = exports.VARA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVPA = function() {\n  var v = exports.VARPA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\n\nexports.STEYX = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var lft = 0;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2);\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return Math.sqrt((lft - num * num / den) / (n - 2));\n};\n\nexports.TRANSPOSE = function(matrix) {\n  if (!matrix) {\n    return error.na;\n  }\n  return jStat.transpose(matrix);\n};\n\nexports.T = text.T;\n\nexports.T.DIST = function (x, df, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  df = utils.parseNumber(df);\n  if (utils.anyIsError(x, df)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.studentt.cdf(x, df) : jStat.studentt.pdf(x, df);\n};\n\nexports.T.DIST['2T'] = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return (1 - jStat.studentt.cdf(x , df)) * 2;\n};\n\nexports.T.DIST.RT = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.studentt.cdf(x , df);\n};\n\nexports.T.INV = function (probability, df) {\n  // probability = utils.parseNumber(probability);\n  // df = utils.parseNumber(df);\n  // if (utils.anyIsError(probability, df)) {\n  //   return error.value;\n  // }\n  // var res = jStat.studentt.inv(probability, df);\n  // return res\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\nexports.T.INV['2T'] = function(probability, df) {\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nexports.T.TEST = function(data_x, data_y) {\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n\n  var mean_x = jStat.mean(data_x);\n  var mean_y = jStat.mean(data_y);\n  var s_x = 0;\n  var s_y = 0;\n  var i;\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2);\n  }\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2);\n  }\n\n  s_x = s_x / (data_x.length-1);\n  s_y = s_y / (data_y.length-1);\n\n  var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);\n\n  return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);\n};\n\nexports.TREND = function (data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  var linest = exports.LINEST(data_y, data_x);\n  var m = linest[0];\n  var b = linest[1];\n  return m * new_data_x + b\n};\n\nexports.TRIMMEAN = function (range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  percent = utils.parseNumber(percent);\n  if (utils.anyIsError(range, percent)) {\n    return error.value;\n  }\n  var trim = mathTrig.FLOORMATH(range.length * percent, 2) / 2;\n  return jStat.mean(utils.initial(utils.rest(range.sort(function (a, b) {\n    return a - b;\n  }), trim), trim));\n};\n\nexports.VAR = {};\n\nexports.VAR.P = function () {\n  var range = utils.numbers(utils.flatten(arguments));\n  if (range.length==0){\n    return error.value\n  }\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  if (isNaN(sigma / n)){\n    return error.value\n  }else{\n    return sigma / n;\n  }\n};\n\nexports.VAR.S = function() {\n  var range = utils.numbers(utils.flatten(arguments));\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  return sigma / (n - 1);\n};\n\nexports.VARA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / (count - 1);\n};\n\nexports.VARPA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / count;\n};\n\nexports.WEIBULL = {};\n\nexports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\n  //XW:参数判断\n  cumulative = utils.parseBool(cumulative)\n  //XW：end\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value;\n  }\n  return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n};\n\nexports.Z = {};\n\nexports.Z.TEST = function (range, x, sd) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  x = utils.parseNumber(x);\n  if (utils.anyIsError(range, x)) {\n    return error.value;\n  }\n\n  sd = sd || exports.STDEV.S(range);\n  var n = range.length;\n  return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n};\n","import {isHave} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\n\nexport default class CellProp {\n    constructor(ri, ci, cell, expr, empty) {\n        this.ri = ri;\n        this.ci = ci;\n        this.cell = cell;\n        this.expr = expr;\n        this.empty = empty;\n    }\n\n    isInclude() {\n\n    }\n\n\n    each(cb) {\n        let {cell} = this;\n        if(isHave(cell.depend) === false) {\n            return;\n        }\n        for(let i = 0; i < cell.depend.length; i++) {\n            let expr = cell.depend[i];\n            let [ci, ri] = expr2xy(expr);\n            cb(ri, ci);\n        }\n    }\n}","import SelectorCopy from '../component/selector_copy';\nimport {\n    cutFirst,\n    cutStr,\n    cutting,\n    cutting2,\n    cuttingByPos,\n    isAbsoluteValue,\n    operation,\n    value2absolute,\n} from '../core/operator';\nimport {expr2xy, xy2expr} from '../core/alphabet';\nimport {selectorColor} from './color_palette';\nimport {h} from './element';\n\n/**\n * 这个文件是sheet.js的衍生文件\n */\n\n\nfunction lockCells(evt, _selector, isAb = false, p = -1) {\n    const {data, editor} = this;\n    const {offsetX, offsetY} = evt;\n\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {ri, ci} = cellRect;\n\n    let {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let input = '';\n\n    editor.handler(inputText);\n    const {mousedownIndex} = editor;\n    if (isAbsoluteValue(cuttingByPos(inputText, pos), 2) || _selector) {\n        if (_selector) {\n            const {\n                sri, sci, eri, eci,\n            } = _selector.selector.range;\n\n            const s1 = xy2expr(sci, sri);\n            const s2 = xy2expr(eci, eri);\n            let text = s1 === s2 ? s1 : `${s1}:${s2}`;\n\n            if (isAb === 2) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s1 === es2.s1 ? es1.s1 : `${es1.s1}:${es2.s1}`;\n            } else if (isAb === 1) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s2 === es2.s2 ? es1.s2 : `${es1.s2}:${es2.s2}`;\n            } else if (isAb === 3) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s3 === es2.s3 ? es1.s3 : `${es1.s3}:${es2.s3}`;\n            }\n            _selector.erpx = text;\n            let {isCors} = editor;\n            if (isCors) {\n                pos = 1;\n            }\n\n            let sp = p !== -1 ? p : pos - cuttingByPos(inputText, pos).length;\n            input = inputText.substring(0, sp) + text + inputText.substring(pos, inputText.length);\n            editor.setText(input);\n            editor.setCursorPos(inputText.substring(0, sp).length + text.length);\n        } else {\n            // 此情况是例如: =A1  -> 这时再点A2  则变成: =A2\n            let enter = 0;\n            for (let i = 0; i < this.selectors.length && enter === 0; i++) {\n                const selector = this.selectors[i];\n                const {erpx} = selector;\n                if (erpx === cuttingByPos(inputText, pos)) {\n                    const {ri, ci} = cellRect;\n                    this.selectors[i].ri = ri;\n                    this.selectors[i].ci = ci;\n                    this.selectors[i].erpx = xy2expr(ci, ri);\n                    this.selectors[i].selector.set(ri, ci);\n                    input = `${inputText.substring(0, pos - erpx.length)}${xy2expr(ci, ri)}${inputText.substring(pos, inputText.length)}`;\n                    editor.setText(input);\n                    editor.setCursorPos(inputText.substring(0, pos - erpx.length).length + xy2expr(ci, ri).length);\n                    enter = 1;\n                }\n            }\n        }\n    } else if (mousedownIndex.length > 0) {\n        if (operation(mousedownIndex[1][0]) && isAbsoluteValue(cuttingByPos(mousedownIndex[1], mousedownIndex[1].length), 2)) {\n            editor.setLock(false);\n            return;\n        }\n\n        const args = makeSelector.call(this, ri, ci);\n        this.selectors.push(args);\n        input = `${mousedownIndex[0]}${xy2expr(ci, ri)}${mousedownIndex[1]}`;\n        const judgeText = input.substring(mousedownIndex[0].length + xy2expr(ci, ri).length, input.length);\n        // 不是的话，需要删除这个\n        let number = cutFirst(judgeText.substring(1));\n        if (operation(judgeText[0]) && !isAbsoluteValue(number, 2)) {\n            editor.setText(input);\n            editor.setMouseDownIndex([]);\n            return;\n        }\n        // 不是的话，需要删除这个\n        number = cutFirst(mousedownIndex[1]);\n\n        console.log(xy2expr(ci, ri));\n        const cut = cutStr(`${mousedownIndex[0]}${xy2expr(ci, ri)}+4${mousedownIndex[1]}`);\n        const {selectors_delete, selectors_new} = filterSelectors.call(this, cut);\n        Object.keys(selectors_delete).forEach((i) => {\n            const selector = selectors_delete[i];\n            selector.removeEl();\n        });\n\n        this.selectors = selectors_new;\n\n        input = input.replace(number, '');\n        editor.setText(input);\n        // const content = suggestContent.call(this, pos - 1, cutting(inputText), inputText);\n        editor.setCursorPos(mousedownIndex[0].length + xy2expr(ci, ri).length);\n    } else {\n        const {pos} = editor;\n\n        const args = _selector || makeSelector.call(this, ri, ci);\n        if (pos !== -1) {\n            let str = '';\n            let enter = false;\n            let step = pos;\n            let first = '';\n            for (let i = pos; i < inputText.length; i++) first += inputText[i];\n            let len = cutFirst(first).length;\n            for (let i = 0; i < inputText.length; i++) {\n                if (pos === i) {\n                    enter = true;\n                    str += xy2expr(ci, ri);\n                }\n\n                if (step === i && len > 0) {\n                    step += 1;\n                    len -= 1;\n                } else {\n                    str += inputText[i];\n                }\n            }\n\n            if (_selector) {\n                const {\n                    sri, sci, eri, eci,\n                } = data.selector.range;\n                const s1 = xy2expr(sci, sri);\n                const s2 = xy2expr(eci, eri);\n\n                input = s1 === s2 ? s1 : `${s1}:${s2}`;\n                str = !enter ? str + input : str;\n            } else {\n                this.selectors.push(args);\n                str = !enter ? str + xy2expr(ci, ri) : str;\n            }\n            editor.setText(str);\n            editor.setCursorPos(str.length);\n            editor.parse();\n        } else {\n            this.selectors.push(args);\n            input = `${inputText}${xy2expr(ci, ri)}`;\n            editor.setText(input);\n        }\n    }\n    editor.parse(editor.pos);\n    if (this.selectors.length > 0 || _selector) {\n        // const {inputText} = editor;\n        let inputText = editor.editorText.getText();\n        // 处理 合并单元格\n        let it = inputText, enter = false;\n        let {merges} = this.data;\n        Object.keys(merges._).forEach(i => {\n            let m = merges._[i];\n            const cut = cutStr(it, true);\n            for (let i = 0; i < cut.length; i++) {\n                if (cut[i].indexOf(\":\") !== -1) {\n                    let a1 = cut[i].split(\":\")[0];\n                    let a2 = cut[i].split(\":\")[1];\n                    let e1 = expr2xy(a1);\n                    let e2 = expr2xy(a2);\n\n                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                        it = it.replace(new RegExp(cut[i], 'g'), a1);\n                        enter = true;\n                    }\n                }\n            }\n        });\n\n\n        // clearSelectors.call(this);\n        // console.log(it);\n        div2span.call(this, cutting(it), cutting2(it));\n        if (enter) {\n            setTimeout(() => {\n                editor.setCursorPos(it.length);\n            }, 10);\n        }\n    }\n    // step 3.  在enter或者点击的时候写入到cell中\n    // dataSetCellText.call(this, input, 'input');\n}\n\nfunction filterSelectors(cut) {\n    const selectors_new = [];\n    const selectors_delete = [];\n    Object.keys(this.selectors).forEach((i) => {\n        const selector = this.selectors[i];\n        const {erpx} = selector;\n        let enter = 0;\n        for (let i2 = 0; i2 < cut.length && enter === 0; i2++) {\n            if (cut[i2].replace(/\\$/g, '') === erpx) {\n                enter = 1;\n                selectors_new.push(selector);\n            }\n        }\n\n        if (enter === 0) {\n            selectors_delete.push(selector.selector.el);\n        }\n    });\n    return {\n        selectors_delete,\n        selectors_new,\n    };\n}\n\nfunction makeSelector(ri, ci, selectors = this.selectors, multiple = false, _selector, mergeSelector) {\n    const {data} = this;\n    let selector = null;\n    // const {inputText} = this.editor;\n    let inputText = this.editor.editorText.getText();\n    const {color, index} = selectorColor(selectors.length);\n    if (_selector) {\n        selector = _selector;\n    } else {\n        const className = `selector${Math.random() * 999999}`;\n        selector = new SelectorCopy(data, this, className);\n        selector.el.attr('class', `${className} clear_selector`);\n        selector.setCss(color);\n    }\n\n    if (multiple) {\n        if (mergeSelector) {\n            selector.setEnd(ri, ci);\n        } else {\n            selector.set(ri, ci, true);\n        }\n    } else {\n        selector.set(ri, ci, false);\n    }\n\n    selector.el.css('z-index', '100');\n    const len = inputText.split(xy2expr(ci, ri)).length - 2;\n\n    let it = xy2expr(ci, ri);\n    let {merges} = data;\n    Object.keys(merges._).forEach(i => {\n        let m = merges._[i];\n        const cut = cutStr(it, true);\n        for (let i = 0; i < cut.length; i++) {\n            if (cut[i].indexOf(\":\") !== -1) {\n                let a1 = cut[i].split(\":\")[0];\n                let a2 = cut[i].split(\":\")[1];\n                let e1 = expr2xy(a1);\n                let e2 = expr2xy(a2);\n\n                if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                    it = it.replace(new RegExp(cut[i], 'g'), a1);\n                }\n            }\n        }\n    });\n\n    const args = {\n        ri,\n        ci,\n        index: len,\n        color,\n        index2: index,\n        className: selector.el.el.className,\n        erpx: it,\n        selector,\n    };\n    if (!mergeSelector) {\n        selector.el.show();\n        this.selectorsEl.child(selector.el);\n    }\n\n    if (multiple) {\n        return args;\n    }\n\n    this.selectorsEl.child(selector.el);\n    return args;\n}\n\nfunction clearSelectors() {\n    this.selectorsEl.html('');\n    this.selectors = [];\n    const {editor, selector} = this;\n    editor.setLock(false);\n\n    // // 这行是在 @~esc的时候加的 原因是要把ri ci赋值为-1\n    // editor.setRiCi(-1, -1);\n    editor.state = 1;\n    selector.el.show();\n}\n\n// 输入 input\nfunction editingSelectors(text = '') {\n    if (typeof text === 'number') {\n        return;\n    }\n    const selectors_new = [];\n    const cut = cutStr(text, true);\n    // case 1  过滤 selectors\n    const {selectors_delete} = filterSelectors.call(this, cut);\n\n    Object.keys(selectors_delete).forEach((i) => {\n        const selector = selectors_delete[i];\n        selector.removeEl();\n    });\n\n\n    const selectors_valid = selectors_new;\n    // case 2  验证 selectors\n    Object.keys(cut).forEach((i) => {\n        let enterCode = 1;\n        Object.keys(this.selectors).forEach((i) => {\n            const {selector} = this.selectors[i];\n            selector.el.removeEl();\n        });\n\n        // 绝对值\n        let arr = '';\n        let sc = cut[i].replace(/\\$/g, \"\");\n        if (isAbsoluteValue(cut[i])) {\n            const notTrueValue = cut[i].replace(/\\$/g, '');\n            arr = expr2xy(notTrueValue);\n        } else if (sc.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n            enterCode = 2;\n        } else {\n            arr = expr2xy(cut[i]);\n        }\n\n        if (enterCode === 1) {\n            const ri = arr[1];\n            const\n                ci = arr[0];\n            const args = makeSelector.call(this, ri, ci, selectors_valid);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        } else if (enterCode === 2) {\n            const prx = cut[i].replace(/\\$/g, '').split(':')[0];\n            const lax = cut[i].replace(/\\$/g, '').split(':')[1];\n\n            const prx_index = expr2xy(prx);\n            const lax_index = expr2xy(lax);\n            let args = makeSelector.call(this, prx_index[1], prx_index[0], selectors_valid, true, null, false);\n            args = makeSelector.call(this, lax_index[1], lax_index[0], selectors_valid, true, args.selector, true);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        }\n    });\n    this.selectors = selectors_valid;\n\n    if (this.selectors.length > 0 || text[0] === '=') {\n        div2span.call(this, cutting(text), cutting2(text));\n    }\n}\n\n// 找 ( 的index\nfunction findBracketLeft(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i - 1; j > 0 && stop === false; j--) {\n        if (cut[j] === '(') {\n            stop = true;\n        }\n        if (cut[j] === ')') {\n            has++;\n        }\n    }\n\n    for (let j = i; j > 0 && begin === -1; j--) {\n        if (cut[j] === '(') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n// => { left: 0, right: 0,  exist: false }\nfunction findBracket(pos, cut, text) {\n    let args = {left: 0, right: 0, exist: false};\n    if (text[pos] !== ')') {\n        return args;\n    }\n    const right = pos;\n    const left = findBracketLeft.call(this, cut, right);\n\n    if (left !== -1 && right !== -1) {\n        args = {left, right, exist: true};\n    }\n    return args;\n}\n\n\n// 找 ) 的 index\nfunction findBracketRight(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i + 1; j < cut.length && stop === false; j++) {\n        if (cut[j] === ')') {\n            stop = true;\n        }\n        if (cut[j] === '(') {\n            has++;\n        }\n    }\n\n    for (let j = i; j < cut.length && begin === -1; j++) {\n        if (cut[j] === ')') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n\nfunction suggestContent(pos, cut, inputText) {\n    // 如果在括号内\n    // step 1. 找到距离pos最近的左、右括号的index\n    // step 2. 若1成立，找到该函数名\n    // step 3. 找光标前有几个逗号\n    const content = {suggestContent: false, cut: '', pos: 1};\n    const begin = pos - 1;\n    const left = findBracketLeft.call(this, cut, begin);\n    const right = findBracketRight.call(this, cut, left);\n\n    if (left <= begin && left !== -1 && (right >= begin || right === -1)) {\n        content.suggestContent = true;\n        content.cut = cuttingByPos(inputText, left);\n    }\n\n    for (let i = left; i < begin + 1; i++) {\n        if (inputText[i] === ',') {\n            content.pos += 2;\n        }\n    }\n\n    return content;\n}\n\nfunction div2span(cut, cutcolor) {\n    const {editor} = this;\n\n    const spanArr = [];\n    let begin = -1;\n    let end = -1;\n\n    Object.keys(cut).forEach((i) => {\n        const spanEl = h('span', `formula_span${i}`);\n        Object.keys(cutcolor).forEach(() => {\n            if (cutcolor[i] && cutcolor[i].code !== -1 && cutcolor[i].data === cut[i]) {\n                const {color} = selectorColor(cutcolor[i].code);\n                spanEl.css('color', color);\n            }\n        });\n        spanEl.css('display', 'inline-block');\n        spanEl.css('cursor', 'text');\n\n        if (cut[i] === ' ') {\n            spanEl.html('&emsp;');\n        } else {\n            spanEl.html(cut[i]);\n        }\n\n        spanArr.push(spanEl);\n    });\n\n    // 高亮\n    const {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let content = {suggestContent: false, cut: ''};\n    if (inputText[pos - 1] === ')') {\n        begin = pos - 1;\n        end = findBracketLeft.call(this, cut, begin);\n    } else {\n        content = suggestContent.call(this, pos + 1, cut, inputText);\n    }\n\n\n    if (inputText !== '' && spanArr.length <= 0) {\n        const spanEl = h('span', 'formula_span');\n        spanArr.push(spanEl);\n    }\n    // 挂载\n    editor.mount2span(spanArr, begin, end, content);\n}\n\n\nexport {\n    lockCells,\n    clearSelectors,\n    editingSelectors,\n    findBracket,\n    suggestContent,\n    makeSelector,\n};\n","const baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\n// const fonts = (ary = []) => {\n//   const map = {};\n//   baseFonts.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\n\nexport {\n  fontSizes,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","import {isHave} from \"../core/helper\";\n\nexport function testValid(valid = this.valid) {\n    if(isHave(valid)) {\n       valid.assert();\n    }\n}","import {deepCopy, distinct} from \"../core/operator\";\nimport {isHave} from '../core/helper';\nimport {expr2xy, xy2expr} from \"../core/alphabet\";\n\nfunction getCellDepend(cells) {\n    let arr = [];\n    for (let i = 0; i < cells.length; i++) {\n        if(isHave(cells[i]) && isHave(cells[i].expr)) {\n            arr.push(cells[i].expr);\n        }\n\n        if (isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.depend)) {\n            arr.push(...cells[i].cell.depend);\n        }\n\n        if(isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.multivalueRefsCell)) {\n            arr.push(cells[i].cell.multivalueRefsCell);\n        }\n    }\n\n    return arr;\n}\n\n\nexport default class PreAction {\n    constructor({type = -1, action = \"\",  ri = -1, ci = -1, oldData = \"\", newData = \"\", expr = \"\", oldStep = \"\", cellRange = \"\", cells = {}, height = -1, width = -1, oldCell = {}, newCell = {}, newMergesData = \"\", oldMergesData = \"\", property = \"\", value = \"\"}, data) {\n        this.type = type;\n        this.action = action;\n        this.ri = ri;\n        this.ci = ci;\n        this.expr = expr;\n        this.cellRange = cellRange;\n        this.cells = cells;\n        this.height = height;\n        this.width = width;\n        this.oldCell = oldCell;\n        this.newCell = newCell;\n        this.oldMergesData = oldMergesData;\n        this.newMergesData = newMergesData;\n        this.property = property;\n        this.value = value;\n        this.oldStep = oldStep;\n\n        this.oldData = oldData;\n        this.newData = newData;\n        this.data = data;\n    }\n\n    findAllNeedCalcCell() {\n        let changeArr = [];\n        let {oldCell, newCell, ri, ci} = this;\n        changeArr.push(...getCellDepend(oldCell));\n        changeArr.push(...getCellDepend(newCell));\n        if (ri !== -1 && ci !== -1) {\n            changeArr.push(xy2expr(ci, ri));\n        }\n\n        changeArr = distinct(changeArr);\n        return changeArr;\n    }\n\n    restore(data, sheet, isRedo) {\n        let {type} = this;\n\n        if (type === 1) { // shuru\n            let {oldCell, newCell} = this;\n            let _cell = \"\";\n            // redo 1  undo 2\n            if (isRedo === 1) {\n                _cell = deepCopy(oldCell);\n            } else {\n                _cell = deepCopy(newCell);\n            }\n            for (let i = 0; i < _cell.length; i++) {\n                let {cell, ri, ci} = _cell[i];\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n\n        } else if(type === 13) {\n            let {oldData, newData} = this;\n            let _data = \"\";\n            if (isRedo === 1) {\n                _data = deepCopy(newData);\n            } else {\n                _data = deepCopy(oldData);\n            }\n\n            data.setData(_data);\n        } else if (type === 2 || type === 5 || type === 6 || type === 11 || type === 12) {\n            let {newCell, oldCell, oldMergesData, newMergesData, cellRange, property, value} = this;\n            let _cells = \"\";\n            if (isRedo === 1) {\n                _cells = deepCopy(oldCell);\n            } else {\n                _cells = deepCopy(newCell);\n            }\n\n            if (property === 'merge') {\n                if (isRedo === 1) {\n                    this.data.merges.setData(oldMergesData);\n                } else {\n                    this.data.merges.setData(newMergesData);\n                }\n            }\n\n            for (let i = 0; i < _cells.length; i++) {\n                let {cell, ri, ci} = _cells[i];\n\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n        } else if (type === 3) {\n            let {ri, height, oldStep} = this;\n            if (isRedo === 1) {\n                data.rows.setHeight(ri, oldStep.height);\n            } else {\n                data.rows.setHeight(ri, height);\n            }\n        } else if (type === 4) {\n            let {ci, width, oldStep} = this;\n            if (isRedo === 1) {\n                data.cols.setWidth(ci, oldStep.width);\n            } else {\n                data.cols.setWidth(ci, width);\n            }\n\n        }\n    }\n}\n","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nclass Range{\n    constructor(str_expression, formula, possition_i){\n        var range_expression, sheet_name, sheet;\n        this.start_pst = possition_i - str_expression.length\n        this.end_pst = possition_i\n\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            range_expression = aux[1];\n            this.range_start_pst = possition_i - aux[1].length\n        }\n        else {\n            sheet_name = formula.sheet_name;\n            range_expression = str_expression;\n            this.range_start_pst = this.start_pst\n\n        }\n        this.sheet = formula.wb.Sheets[sheet_name];\n        this.range_expression = range_expression\n        this.sheet_name = sheet_name\n        this.formula = formula\n\n    }\n    calc(){\n        let sheet_name = this.sheet_name\n        let sheet = this.sheet\n        let range_expression = this.range_expression\n        let formula = this.formula\n        var arr = range_expression.split(':');\n        var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n        var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n        var max_row;\n        if (str_max_row === '' && sheet['!ref']) {\n            str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n        }\n        // the max is 1048576, but TLE\n        max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n        var min_col = col_str_2_int(arr[0]);\n        var max_col = col_str_2_int(arr[1]);\n        var matrix = [];\n        for (var i = min_row; i <= max_row; i++) {\n            var row = [];\n            matrix.push(row);\n            for (var j = min_col; j <= max_col; j++) {\n                var cell_name = int_2_col_str(j) + i;\n                var cell_full_name = sheet_name + '!' + cell_name;\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]);\n                    }\n                    else if (formula.formula_ref[cell_full_name].status === 'working') {\n                        throw new Error('Circular ref');\n                    }\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        return matrix;\n\n    }\n\n}\n\nmodule.exports = Range\n//     function Range(str_expression, formula) { // 这是一个Range 类; 把信息都封装到calc方法里面\n//     var range_expression, sheet_name, sheet;\n//     if (str_expression.indexOf('!') != -1) {\n//         var aux = str_expression.split('!');\n//         sheet_name = getSanitizedSheetName(aux[0]);\n//         range_expression = aux[1];\n//     }\n//     else {\n//         sheet_name = formula.sheet_name;\n//         range_expression = str_expression;\n//     }\n//     sheet = formula.wb.Sheets[sheet_name];\n//     this.range_expression = range_expression\n//     this.sheet_name = sheet_name\n//     console.log(this.range_expression)\n//\n//     this.calc = function() {\n//         var arr = range_expression.split(':');\n//         var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n//         var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n//         var max_row;\n//         if (str_max_row === '' && sheet['!ref']) {\n//             str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n//         }\n//         // the max is 1048576, but TLE\n//         max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n//         var min_col = col_str_2_int(arr[0]);\n//         var max_col = col_str_2_int(arr[1]);\n//         var matrix = [];\n//         for (var i = min_row; i <= max_row; i++) {\n//             var row = [];\n//             matrix.push(row);\n//             for (var j = min_col; j <= max_col; j++) {\n//                 var cell_name = int_2_col_str(j) + i;\n//                 var cell_full_name = sheet_name + '!' + cell_name;\n//                 if (formula.formula_ref[cell_full_name]) {\n//                     if (formula.formula_ref[cell_full_name].status === 'new') {\n//                         formula.exec_formula(formula.formula_ref[cell_full_name]);\n//                     }\n//                     else if (formula.formula_ref[cell_full_name].status === 'working') {\n//                         throw new Error('Circular ref');\n//                     }\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else if (sheet[cell_name]) {\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else {\n//                     row.push(null);\n//                 }\n//             }\n//         }\n//         return matrix;\n//     };\n// };\n","var utils = require('./utils');\nvar error = require('./error');\nvar numeral = require('numeral');\n\n//TODO\nexports.ASC = function(str) {\n  var tmp = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 65248 && str.charCodeAt(i) < 65375) {\n      tmp += String.fromCharCode(str.charCodeAt(i) - 65248);\n    }\n    else {\n      tmp += String.fromCharCode(str.charCodeAt(i));\n    }\n  }\n  return tmp\n};\n\n//TODO\nexports.BAHTTEXT = function() {\n throw new Error('BAHTTEXT is not implemented');\n};\n\nexports.CHAR = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return String.fromCharCode(number);\n};\n\nexports.CLEAN = function(text) {\n  text = text || '';\n  var re = /[\\0-\\x1F]/g;\n  return text.replace(re, \"\");\n};\n\nexports.CODE = function(text) {\n  text = text || '';\n  return text.charCodeAt(0);\n};\n\nexports.CONCATENATE = function() {\n  var args = utils.flatten(arguments);\n\n  var trueFound = 0;\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE';\n  }\n\n  var falseFound = 0;\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE';\n  }\n\n  return args.join('');\n};\n\n//TODO\nexports.DBCS = function() {\n throw new Error('DBCS is not implemented');\n};\n\nexports.DOLLAR = function(number, decimals) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n  var format = '';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n    format = '($0,0)';\n  } else if (decimals > 0) {\n    format = '($0,0.' + new Array(decimals + 1).join('0') + ')';\n  }\n  return numeral(number).format(format);\n};\n\nexports.EXACT = function(text1, text2) {\n  return text1 === text2;\n};\n\nexports.FIND = function (find_text, within_text, position) {\n  position = (position === undefined) ? 0 : position;\n  within_text.indexOf(find_text)\n  return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n};\nexports.FIXED = function(number, decimals, no_commas) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n  no_commas = (no_commas === undefined) ? false : no_commas;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n\n  var format = no_commas ? '0' : '0,0';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n  } else if (decimals > 0) {\n    format += '.' + new Array(decimals + 1).join('0');\n  }\n  return numeral(number).format(format);\n};\n\nexports.HTML2TEXT = function (value) {\n  var result = '';\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach(function (line) {\n        if (result !== '') {\n          result += '\\n';\n        }\n        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\n      });\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '');\n    }\n  }\n\n  return result;\n};\nexports.INDEX = function (matrix, row_num, column_num) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n  return matrix[row_num][column_num-1]\n};\nexports.LEFT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.substring(0, number) : null;\n};\n\nexports.LEN = function(text) {\n  if (arguments.length === 0) {\n    return error.error;\n  }\n\n  if (typeof text === 'string') {\n    return text ? text.length : 0;\n  }\n\n  if (text.length) {\n    return text.length;\n  }\n\n  return error.value;\n};\n\nexports.LOWER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.toLowerCase() : text;\n};\n\nexports.MID = function(text, start, number) {\n  start = utils.parseNumber(start);\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number;\n  }\n\n  var begin = start - 1;\n  var end = begin + number;\n\n  return text.substring(begin, end);\n};\n\n// TODO\nexports.NUMBERVALUE = function (text, decimal_separator, group_separator) {\n  decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;\n  group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;\n  if (text.indexOf('%') > 0){\n    text = text.replace('%', '')\n    return parseFloat(text)/100\n  }\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));\n};\n\n// TODO\nexports.PRONETIC = function() {\n throw new Error('PRONETIC is not implemented');\n};\n\nexports.PROPER = function(text) {\n  if (text === undefined || text.length === 0) {\n    return error.value;\n  }\n  if (text === true) {\n    text = 'TRUE';\n  }\n  if (text === false) {\n    text = 'FALSE';\n  }\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value;\n  }\n  if (typeof text === 'number') {\n    text = '' + text;\n  }\n\n  return text.replace(/\\w\\S*/g, function(txt) {\n    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n  });\n};\n\nexports.REGEXEXTRACT = function (text, regular_expression) {\n  var match = text.match(new RegExp(regular_expression));\n  return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\n};\n\nexports.REGEXMATCH = function (text, regular_expression, full) {\n  var match = text.match(new RegExp(regular_expression));\n  return full ? match : !!match;\n};\n\nexports.REGEXREPLACE = function (text, regular_expression, replacement) {\n  return text.replace(new RegExp(regular_expression), replacement);\n};\n\nexports.REPLACE = function(text, position, length, new_text) {\n  position = utils.parseNumber(position);\n  length = utils.parseNumber(length);\n  if (utils.anyIsError(position, length) ||\n    typeof text !== 'string' ||\n    typeof new_text !== 'string') {\n    return error.value;\n  }\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n};\n\nexports.REPT = function(text, number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return new Array(number + 1).join(text);\n};\n\nexports.RIGHT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return text ? text.substring(text.length - number) : null;\n};\n\nexports.SEARCH = function(find_text, within_text, position) {\n  var foundAt;\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value;\n  }\n  position = (position === undefined) ? 0 : position;\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\n  return (foundAt === 0)?error.value:foundAt;\n};\n\nexports.SPLIT = function (text, separator) {\n  return text.split(separator);\n};\n\nexports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\n  if (!text || !old_text || !new_text) {\n    return text;\n  } else if (occurrence === undefined) {\n    return text.replace(new RegExp(old_text, 'g'), new_text);\n  } else {\n    var index = 0;\n    var i = 0;\n    while (text.indexOf(old_text, index) > 0) {\n      index = text.indexOf(old_text, index + 1);\n      i++;\n      if (i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n      }\n    }\n  }\n};\n\nexports.T = function(value) {\n  if (value == 'TRUE' || value == 'FALSE'){\n    return ''\n  }\n  return (typeof value === \"string\") ? value : '';\n};\n\n// TODO incomplete implementation\nfunction num2e(num){\n  var p = Math.floor(Math.log(num)/Math.LN10);\n  var n = num * Math.pow(10, -p);\n  if (p.toString().length < 10){\n    p = '0' + p\n  }\n  return n + 'E+' + p;\n}\nfunction allzero(num){\n  num = num.toString()\n  for (var i=0;i<num.length;i++){\n    if (num[i] != '0'){\n      return false\n    }\n  }\n  return true\n}\nfunction decimalsToFractional(decimals){\n  formatDecimals = decimals.toFixed(2);\n  var denominator = 3;//初始化分母\n  var numerator  = formatDecimals*3;//初始化分子\n  var bigger = 0;\n  function  recursion (){\n    bigger = denominator>numerator?denominator:numerator;\n    for(let i=bigger;i>1;i--){\n      if(Number.isInteger(numerator/i)&&Number.isInteger(denominator/i)){\n        numerator=numerator/i;\n        denominator=denominator/i;\n        recursion();\n      }\n    }\n  }\n  recursion();\n  numerator = parseInt(numerator)\n  return `${numerator}/${denominator}`\n}\nexports.TEXT = function (value, format) {\n  try{\n    if (format.indexOf('%') >= 0){\n      var fixed = format.split('.')[1].length-1\n      return (parseFloat(value) *100).toFixed(fixed) + '%'\n    }\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    var result = Formulas.TEXT(value, format);\n    console.log(result)\n  }catch (e) {\n    var result = undefined\n  }\n  if (result == undefined){\n    if (format.indexOf('#') >= 0 && format.indexOf('?/?') >=0){\n      var x = parseFloat(value) - parseInt(value);\n      if (parseInt(value) != 0){\n        return parseInt(value) + ' ' + decimalsToFractional(x)\n      }\n      return decimalsToFractional(x)\n    }\n    if (format.indexOf('E+') >=0){\n      return num2e(value)\n    }else if(allzero(value)){\n      var result = ''\n      for (var i=0;i<format.length-value.length; i++){\n        result += '0'\n      }\n      return result + value\n    }else if (format.indexOf('#') >=0){\n      var fmt = format\n      if (format.indexOf('[')>=0 && format.indexOf(';')>=0){\n        var valid = format.split('#')[0]\n        fmt = format.split(']')[1].split(';')\n        valid = valid.replace('[', '').replace(']', '')\n        if (eval(value + valid)){\n          fmt = fmt[0]\n        }else {\n          fmt = fmt[1]\n        }\n      }\n      if (format.indexOf('#') >=0 && format.indexOf('.' >=0) && format.indexOf('0') >=0 && format.indexOf('°') <=0){\n        if (value.toString().split('.')[1].length > format.split('.')[1].length){\n          value = value.toFixed(format.split('.')[1].length)\n        }\n        value = value.toString()\n        var result = ''\n        var n = 0\n        for (var i=0; i< fmt.length; i ++){\n          if (fmt[i] == '#' || fmt[i] == '0' || fmt[i] == '.'){\n            result += value[n]\n            n += 1\n          }else{\n            result += fmt[i]\n          }\n        }\n        return result\n      }\n      fmt = fmt.replace('##0', '##')\n      value = value.toString()\n      var result = ''\n      var n = 0\n      for (var i=0; i< fmt.length; i ++){\n        if (fmt[i] == '#' || fmt[i] == '0'){\n          result += value[n]\n          n += 1\n        }else{\n          result += fmt[i]\n        }\n      }\n      return result\n    }\n  }\n  return result\n};\n\nexports.TRIM = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.replace(/ +/g, ' ').trim();\n};\n\nexports.UNICHAR = function (text) {\n  if (text == 0){\n    return error.value\n  }\n  return String.fromCharCode(text);\n};\n\nexports.UNICODE = function (text){\n  return text.charCodeAt(0)\n}\n\nexports.UPPER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.toUpperCase();\n};\n\nexports.VALUE = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return numeral().unformat(text);\n};\n","var error = require('./error');\n\n// TODO\nexports.CELL = function() {\n throw new Error('CELL is not implemented');\n};\n\nexports.ERROR = {};\nexports.ERROR.TYPE = function (error_val) {\n  switch (error_val) {\n    case error.nil.message:\n      return 1;\n    case error.div0.message:\n      return 2;\n    case error.value.message:\n      return 3;\n    case error.ref.message:\n      return 4;\n    case error.name.message:\n      return 5;\n    case error.num.message:\n      return 6;\n    case error.na.message:\n      return 7;\n    case error.data.message:\n      return 8;\n  }\n  return error.na;\n};\n\n// TODO\nexports.INFO = function() {\n throw new Error('INFO is not implemented');\n};\n\nexports.ISBLANK = function(value) {\n  return value === null;\n};\n\nexports.ISBINARY = function (number) {\n  return (/^[01]{1,10}$/).test(number);\n};\n\nexports.ISERR = function(value) {\n  return ([error.value.message, error.ref.message, error.div0.message, error.num.message, error.name.message, error.nil.message]).indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\n};\n\nexports.ISERROR = function(value) {\n  return exports.ISERR(value) || value === error.na;\n};\n\nexports.ISEVEN = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? false : true;\n};\n\n// TODO\nexports.ISFORMULA = function() {\n  throw new Error('ISFORMULA is not implemented');\n};\n\nexports.ISLOGICAL = function(value) {\n  if(value == 'FALSE'){\n    return false\n  }\n  return value == true || value == false;\n};\n\nexports.ISNA = function(value) {\n  return value === error.na || value === error.na.message;;\n};\n\nexports.ISNONTEXT = function(value) {\n  return typeof(value) !== 'string';\n};\n\nexports.ISNUMBER = function(value) {\n  return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\n};\n\nexports.ISODD = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? true : false;\n};\n\n// TODO\nexports.ISREF = function() {\n  return arguments['0'] != null\n};\n\nexports.ISTEXT = function(value) {\n  return typeof(value) === 'string';\n};\n\nexports.N = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return value;\n  }\n  if (value instanceof Date) {\n    return value.getTime();\n  }\n  if (value === true || value.toString().toUpperCase() == 'TRUE' || value.toString().toUpperCase() == 'FALSE') {\n    return 1;\n  }\n  if (value === false || typeof(value)=='string') {\n    return 0;\n  }\n  if (ISERROR(value)) {\n    return value;\n  }\n  return 0;\n};\n\nexports.NA = function() {\n  return error.na;\n};\n\n\n// TODO\nexports.SHEET = function() {\n  throw new Error('SHEET is not implemented');\n};\n\n// TODO\nexports.SHEETS = function() {\n  throw new Error('SHEETS is not implemented');\n};\n\nexports.TYPE = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return 1;\n  }\n  // if (typeof(value) !== 'string' && isNaN(value)){\n  //   return error.value\n  // }\n  if (typeof(value) === 'string') {\n    if (value.slice(0,1) == '{'){\n      var arr = utils.strToMatrix(value)\n      if (Array.isArray(arr)) {\n        return 64;\n      }\n    }else{\n      return 2\n    }\n  }\n  if(value == 'FALSE'){\n    return false\n  }\n  if (value == true || value == false) {\n    return 4;\n  }\n  if (exports.ISERR(value) || value === error.na) {\n    return 16;\n  }\n  if (Array.isArray(arr)) {\n    return 64;\n  }\n\n};\n","var error = require('./error');\nvar utils = require('./utils');\n\nvar d1900 = new Date(1900, 0, 1);\nvar WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n];\nvar WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n];\nvar WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined, [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n];\n\nexports.DATE = function(year, month, day) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.DATE(year, month, day)\n  // year = utils.parseNumber(year);\n  // month = utils.parseNumber(month);\n  // day = utils.parseNumber(day);\n  // if (utils.anyIsError(year, month, day)) {\n  //   return error.value;\n  // }\n  // if (year < 0 || month < 0 || day < 0) {\n  //   return error.num;\n  // }\n  // var date = new Date(year, month - 1, day);\n  // return date;\n};\n\nexports.DATEVALUE = function(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value;\n  }\n  var date = Date.parse(date_text);\n  if (isNaN(date)) {\n    return error.value;\n  }\n  if (date <= -2203891200000) {\n    return (date - d1900) / 86400000 + 1;\n  }\n  return (date - d1900) / 86400000 + 2;\n};\n\nexports.DAY = function(serial_number) {\n  var date = utils.parseDate(serial_number);\n  if (date instanceof Error) {\n    return date;\n  }\n  return date.getDate();\n};\n\nexports.DAYS = function(end_date, start_date) {\n  end_date = utils.parseDate(end_date);\n  start_date = utils.parseDate(start_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  return serial(end_date) - serial(start_date);\n};\n\nexports.DAYS360 = function(start_date, end_date, method) {\n  method = utils.parseBool(method);\n  start_date = utils.parseDate(start_date);\n  end_date = utils.parseDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (method instanceof Error) {\n    return method;\n  }\n  var sm = start_date.getMonth();\n  var em = end_date.getMonth();\n  var sd, ed;\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();\n  } else {\n    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();\n    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate();\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++;\n        ed = 1;\n      } else {\n        ed = 30;\n      }\n    } else {\n      ed = end_date.getDate();\n    }\n  }\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) +\n    30 * (em - sm) + (ed - sd);\n};\n\nexports.EDATE = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  start_date.setMonth(start_date.getMonth() + months);\n  return serial(start_date);\n};\n\nexports.EOMONTH = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n};\n\nexports.HOUR = function(serial_number) {\n  if (typeof serial_number === 'number' && !isNaN(serial_number)){\n    //XW: 参数为数字时获取对应的小时数\n    return parseInt((parseFloat(serial_number)-parseInt(serial_number)) * 24)\n    //XW: end\n  }\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getHours();\n};\n\nexports.INTERVAL = function (second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value;\n  } else {\n    second = parseInt(second, 10);\n  }\n\n  var year  = Math.floor(second/946080000);\n  second    = second%946080000;\n  var month = Math.floor(second/2592000);\n  second    = second%2592000;\n  var day   = Math.floor(second/86400);\n  second    = second%86400;\n\n  var hour  = Math.floor(second/3600);\n  second    = second%3600;\n  var min   = Math.floor(second/60);\n  second    = second%60;\n  var sec   = second;\n\n  year  = (year  > 0) ? year  + 'Y' : '';\n  month = (month > 0) ? month + 'M' : '';\n  day   = (day   > 0) ? day   + 'D' : '';\n  hour  = (hour  > 0) ? hour  + 'H' : '';\n  min   = (min   > 0) ? min   + 'M' : '';\n  sec   = (sec   > 0) ? sec   + 'S' : '';\n\n  return 'P' + year + month + day +\n  'T' + hour + min + sec;\n};\n\nexports.ISOWEEKNUM = function(date) {\n  date = utils.parseDate(date);\n  if (date instanceof Error) {\n    return date;\n  }\n\n  date.setHours(0, 0, 0);\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n  var yearStart = new Date(date.getFullYear(), 0, 1);\n  return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\n};\n\nexports.MINUTE = function(serial_number) {\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.MINUTE(serial_number);\n};\n\nexports.MONTH = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getMonth() + 1;\n};\n\nexports.NETWORKDAYS = function (start_date, end_date, holidays) {\n  if (holidays instanceof Array){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.NETWORKDAYS(start_date, end_date, holidays);\n};\nexports.NETWORKDAYSINTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays)[0])\n  }\n  try{\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.NETWORKDAYS$INTL(start_date, end_date, weekend, holidays);\n  }catch (e) {\n    start_date = utils.ExcelDateToJSDate(utils.parseDate(start_date));\n    end_date = utils.ExcelDateToJSDate(utils.parseDate(end_date));\n    if (start_date instanceof Error) {\n      return start_date;\n    }\n    if (end_date instanceof Error) {\n      return end_date;\n    }\n    if (weekend === undefined) {\n      weekend = WEEKEND_TYPES[1];\n    } else if (typeof weekend=='string' && weekend.length === 7) {\n      var arr = []\n      for (var i=0;i<weekend.length;i++){\n        if (weekend[i] == '1'){\n          arr.push(((i+1)>6)? 0: i+1)\n        }\n      }\n      weekend = arr\n    }else {\n      weekend = WEEKEND_TYPES[weekend];\n    }\n    if (!(weekend instanceof Array)) {\n      return error.value;\n    }\n    if (holidays === undefined) {\n      holidays = [];\n    } else if (!(holidays instanceof Array)) {\n      holidays = [holidays];\n    }\n    for (var i = 0; i < holidays.length; i++) {\n      var h = utils.parseDate(holidays[i]);\n      if (h instanceof Error) {\n        return h;\n      }\n      holidays[i] = h;\n    }\n    var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n    var total = days;\n    var day = start_date;\n    for (i = 0; i < days; i++) {\n      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n      var dec = false;\n      if (d === weekend[0] || d === weekend[1]) {\n        dec = true;\n      }\n      for (var j = 0; j < holidays.length; j++) {\n        var holiday = holidays[j];\n        if (holiday.getDate() === day.getDate() &&\n          holiday.getMonth() === day.getMonth() &&\n          holiday.getFullYear() === day.getFullYear()) {\n          dec = true;\n          break;\n        }\n      }\n      if (dec) {\n        total--;\n      }\n      day.setDate(day.getDate() + 1);\n    }\n    return total;\n  }\n};\n\n\nexports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays))\n  }\n  start_date = utils.ExcelDateToJSDate(start_date);\n  end_date = utils.ExcelDateToJSDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n  var total = days;\n  var day = start_date;\n  for (i = 0; i < days; i++) {\n    var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n    var dec = false;\n    if (d === weekend[0] || d === weekend[1]) {\n      dec = true;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()) {\n        dec = true;\n        break;\n      }\n    }\n    if (dec) {\n      total--;\n    }\n    day.setDate(day.getDate() + 1);\n  }\n  return total;\n};\n\nexports.NOW = function() {\n  return new Date();\n};\n\nexports.SECOND = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getSeconds();\n};\n\nexports.TIME = function(hour, minute, second) {\n  hour = utils.parseNumber(hour);\n  minute = utils.parseNumber(minute);\n  second = utils.parseNumber(second);\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value;\n  }\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num;\n  }\n  return (3600 * hour + 60 * minute + second) / 86400;\n};\n\nexports.TIMEVALUE = function(time_text) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  try{\n    return Formulas.TIMEVALUE(time_text);\n  }catch(e){\n    return error.value\n  }\n};\n\nexports.TODAY = function() {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.TODAY()\n};\n\nexports.WEEKDAY = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  var day = serial_number.getDay();\n  return WEEK_TYPES[return_type][day];\n};\n\nexports.WEEKNUM = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  if (return_type === 21) {\n    return this.ISOWEEKNUM(serial_number);\n  }\n  var week_start = WEEK_STARTS[return_type];\n  var jan = new Date(serial_number.getFullYear(), 0, 1);\n  var inc = jan.getDay() < week_start ? 1 : 0;\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;\n  return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;\n};\n\nexports.WORKDAY = function (start_date, days, holidays) {\n  if (holidays != undefined){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.WORKDAY(start_date, days, holidays);\n};\nexports.WORKDAYINTL = function (start_date, days, weekend, holidays) {\n  // var Formulas = window.jsSpreadsheet.AllFormulas;\n  // return Formulas.WORKDAY$INTL(start_date, days, weekend, holidays);\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (weekend == 0){\n    return error.num\n  }\n  days = utils.parseNumber(days);\n  if (days instanceof Error) {\n    return days;\n  }\n  if (days < 0) {\n    return error.num;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var d = 0;\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1);\n    var day = start_date.getDay();\n    if (day === weekend[0] || day === weekend[1]) {\n      continue;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()) {\n        d--;\n        break;\n      }\n    }\n    d++;\n  }\n  var year = start_date.getFullYear();\n  var month = start_date.getMonth();\n  var day = start_date.getDay();\n  return year+ '/' + month + '/' + day;\n};\n\nexports.YEAR = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getFullYear();\n};\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1;\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);\n}\n\nexports.YEARFRAC = function(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  end_date = utils.parseDate(end_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n\n  basis = basis || 0;\n  var sd = start_date.getDate();\n  var sm = start_date.getMonth() + 1;\n  var sy = start_date.getFullYear();\n  var ed = end_date.getDate();\n  var em = end_date.getMonth() + 1;\n  var ey = end_date.getFullYear();\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30;\n        ed = 30;\n      } else if (sd === 31) {\n        sd = 30;\n      } else if (sd === 30 && ed === 31) {\n        ed = 30;\n      }\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n    case 1:\n      // Actual/actual\n      var feb29Between = function(date1, date2) {\n        var year1 = date1.getFullYear();\n        var mar1year1 = new Date(year1, 2, 1);\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true;\n        }\n        var year2 = date2.getFullYear();\n        var mar1year2 = new Date(year2, 2, 1);\n        return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);\n      };\n      var ylength = 365;\n      if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) ||\n            feb29Between(start_date, end_date) ||\n            (em === 1 && ed === 29)) {\n          ylength = 366;\n        }\n        return daysBetween(start_date, end_date) / ylength;\n      }\n      var years = (ey - sy) + 1;\n      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;\n      var average = days / years;\n      return daysBetween(start_date, end_date) / average;\n    case 2:\n      // Actual/360\n      return daysBetween(start_date, end_date) / 360;\n    case 3:\n      // Actual/365\n      return daysBetween(start_date, end_date) / 365;\n    case 4:\n      // European 30/360\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n  }\n};\n\nfunction serial(date) {\n  var addOn = (date > -2203891200000)?2:1;\n  return (date - d1900) / 86400000 + addOn;\n}","import helper, {isHave} from './helper';\nimport {xy2expr} from './alphabet';\nimport {changeFormula, cutStr, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport dayjs from 'dayjs'\nimport {deepCopy, distinct, isSheetVale, splitStr} from \"./operator\";\nimport Recast from \"./recast\";\nimport PasteProxy from \"./paste_proxy\";\nimport CellProxy from \"./cell_proxy\";\nimport CellRange from \"./cell_range\";\nimport CellProp from \"../model/cell_prop\";\nimport Cell from \"../model/cell\";\nlet calcUtils = require('../calc/utils');\n\nexport function isFormula(text) {\n    // if (text && text[0] === \"=\") {\n    //     return true;\n    // }\n\n    return text && text[0] === \"=\";\n}\n\nfunction isEmpty(text, formulas, formatText) {\n    if(isHave(text) && text !== \"\") {\n        return false;\n    }\n\n    if(isHave(formulas) && formulas !== \"\") {\n        return false;\n    }\n\n    // if(isHave(formatText)) {\n    //     return false;\n    // }\n\n    return !isHave(formatText);\n}\n\nfunction otherAutoFilter(d, darr, direction, isAdd, what, cb, other, dri) {\n    // other 为 '=asd'或者'asd'也为false\n    let ncell = this.getCellByTopCell(d, direction, isAdd, 'other', dri, 0);\n\n    let {text, formulas} = ncell;\n    let iText = formulas !== \"\" ? formulas : text;\n\n    // if (other) {\n    //     this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    // } else\n    if (this.isFormula(iText)) {\n        this.calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb);\n    } else {\n        // 为 '=asd'或者'asd' 进这里\n        this.calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text);\n    }\n}\n\nfunction numberAutoFilter(d, darr, direction, isAdd, diffValue, what, cb, isNumber) {\n    let ncell = \"\";\n\n    if (isAdd) {\n        diffValue = Math.abs(diffValue);\n    } else {\n        diffValue = diffValue * -1;\n    }\n\n    if (!isNumber) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diffValue = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isAdd);\n    }\n\n    this.calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb);\n}\n\nfunction dateAutoFilter(d, line, isDown, darr, what, cb, isDate) {\n    let direction = line;\n    let ncell = \"\";\n    let diff = isDown ? 1 : -1;\n    if (!isDate) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diff = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isDown, 'date');\n    }\n    this.calcDateCellByTopCell(ncell, darr, d, isDown, what, cb, diff);\n}\n\nclass Rows {\n    constructor({len, height}, data = \"\") {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n        this.data = data;\n        this.pasteProxy = new PasteProxy();\n        this.workbook = null;\n    }\n\n    getHeight(ri) {\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined\n            && (isHave(row.cells[ci].text) || isHave(row.cells[ci].formulas) || isHave(row.cells[ci].style || typeof row.cells[ci] === 'object'))) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    toString(text) {\n        if (isHave(text) === false) {\n            text = \"\";\n        }\n        return text + \"\";\n    }\n\n    isBackEndFunc(text) {\n        // if (text.indexOf(\"MD.RTD\") !== -1) {\n        //     return true;\n        // }\n\n        return text.indexOf(\"MD.RTD\") !== -1;\n    }\n\n    isReferOtherSheet(cell, state = false) {\n        return cell.formulas && cell.formulas[0] === \"=\" && (state || isSheetVale(cell.formulas));\n    }\n\n    isEmpty(cell) {\n\n        return cell && (cell.text || cell.formulas || cell.depend);\n    }\n\n    isFormula(text) {\n        return isFormula(text);\n    }\n\n    setValue(type, value, cell) {\n        cell[type] = value;\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        let {data} = this;\n        const row = this.getOrNew(ri);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        if (what === 'all') {\n            row.cells[ci] = _cell;\n        } else if(what === 'formulas') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].formulas = _cell.formulas;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = _cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = _cell.style;\n            if (cell.merge) row.cells[ci].merge = _cell.merge;\n        } else if (what === 'date' || what === 'datetime') {\n            // row.cells[ci] = {};\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n            row.cells[ci].to_calc_num = _cell.to_calc_num;\n        } else if (what === 'normal' || what === 'number') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            // row.cells[ci].value = cell.value;\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'rmb' || what === 'percent') {        // rmb 单独拿出来是因为 text是￥123, 而formalus不能是 ￥123,应该是123\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].formulas = _cell.formulas;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'all_with_no_workbook') {\n            row.cells[ci] = _cell;\n\n            return;\n        } else if (what === 'style') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {};\n            }\n\n            row.cells[ci].style = _cell.style;\n            return;\n        }\n        // cell\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n        _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n    }\n\n    getDependCell(expr, cell) {\n        let {formulas} = cell;\n        if (isHave(formulas) === false) {\n            return;\n        }\n        if (isFormula(formulas)) {\n            let arr = cutStr(formulas, true, true);\n\n            for (let i = 0; i < arr.length; i++) {\n                let args = this.mergeCellExpr(arr[i]);\n                if (args.state) {\n                    arr.push(...args.mergeArr);\n                }\n            }\n            arr = distinct(arr);\n\n            if (isHave(cell.depend) === false) {\n                cell.depend = [];\n            }\n            for (let i = 0; i < arr.length; i++) {\n                let ref = arr[i];\n                let [ci, ri] = expr2xy(ref);\n                let refCell = this.getCell(ri, ci);\n                if (isHave(refCell) === false) {\n                    refCell = {};\n                }\n\n                if (isHave(refCell.depend) === false) {\n                    refCell.depend = [];\n                }\n                refCell.depend.push(expr);\n                refCell.depend = distinct(refCell.depend);\n                this.setCell(ri, ci, refCell, 'all_with_no_workbook');\n            }\n        }\n    }\n\n    mergeCellExpr(d) {\n        if (!isAbsoluteValue(d, 6)) {\n            return {\n                \"state\": false,\n            }\n        }\n        d = d.replace(/\\$/g, '');\n        d = d.split(\":\");\n        let e1 = expr2xy(d[0]);\n        let e2 = expr2xy(d[1]);\n\n        if (e1[0] > e2[0]) {\n            let t = e2[0];\n            e2[0] = e1[0];\n            e1[0] = t;\n        }\n        if (e1[1] > e2[1]) {\n            let t = e2[1];\n            e2[1] = e1[1];\n            e1[1] = t;\n        }\n        let cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0]);\n        let arr = [];\n        cellRange.each((i, j) => {\n            arr.push(xy2expr(j, i));\n        });\n\n        return {\n            \"state\": true,\n            \"mergeArr\": arr,\n        };\n    }\n\n    useOne(param, other, value = true) {\n        if (isHave(param) === false) {\n            return other;\n        }\n\n        if (value && this.isFormula(param)) {\n            return other;\n        }\n        return param;\n    }\n\n    // what === cell 把原本的cell 的merge 清空， 原因是不清空 merge还会存在\n    setCellText(ri, ci, {text, style, formulas, merge = \"\"},  what = 'all') {\n        if(what === 'all_with_no_workbook') {\n            this.setCell(ri, ci, {}, 'all_with_no_workbook');\n            return;\n        }\n\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        // _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n        if (what === 'style') {\n            _cell.style = style;\n            _cell.formulas = text;   //    cell.formulas = cell.formulas;\n        }   else if (what === 'format') {\n            _cell.formulas = cell.formulas;\n            _cell.style = style;\n        } else if (what === 'cell') {\n            _cell.style = style;\n            _cell.formulas = formulas;\n            _cell['merge'] = undefined;\n            if (merge !== \"\") {\n                _cell.merge = merge;\n            }\n        } else {\n            _cell.formulas = text;\n        }\n        _cell.text = text;\n        this.setCell(ri, ci, _cell);\n\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    setCellAll(ri, ci, text, formulas = \"\") {\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.formulas = formulas === \"\" ? cell.formulas : formulas;\n        _cell.text = text;\n\n        this.setCell(ri, ci, _cell, 'formulas');\n        this.setCell(ri, ci, _cell, 'text');\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    moveChange(arr, arr2, arr3) {\n        if (arr.length !== arr2.length && arr3.length !== arr2.length) {\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n\n            let s1 = arr[i].expr;\n            arr[i].each((ri, ci) => {\n                let cell = this.getCell(ri, ci);\n                if (isHave(cell) === false) {\n                    cell = {};\n                }\n                if (!isHave(cell.formulas)) {\n                    cell.formulas = \"\";\n                }\n\n                let formulas = changeFormula(cutStr(cell.formulas));\n\n                if (formulas.indexOf(s1) !== -1) {\n                    let ca = arr3[i].expr.replace(/\\$/g, \"\\\\$\");\n\n                    this.setCellAll(ri, ci, cell.text.replace(new RegExp(ca, 'g'), arr2[i].expr), cell.formulas.replace(ca, arr2[i].expr));\n                } else {\n                    let s = value2absolute(s1);\n                    let es = value2absolute(arr2[i].expr);\n                    if (formulas.indexOf(s.s3) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n\n                        s.s3 = s.s3.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s3, 'g'), es.s3), cell.formulas.replace(new RegExp(s.s3, 'g'), es.s3));\n                    } else if (formulas.indexOf(s.s2) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s2 = s.s2.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s2, 'g'), es.s2), cell.formulas.replace(new RegExp(s.s2, 'g'), es.s2));\n                    } else if (formulas.indexOf(s.s1) !== -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s1 = s.s1.replace(/\\$/g, \"\\\\$\");\n\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s1, 'g'), es.s1), cell.formulas.replace(new RegExp(s.s1, 'g'), es.s1));\n                    }\n                }\n            });\n        }\n    }\n\n    formatMoney(s, type) {\n        if (/[^0-9\\.]/.test(s))\n            return \"0\";\n        if (s == null || s === \"\")\n            return \"0\";\n        s = s.toString().replace(/^(\\d*)$/, \"$1.\");\n        s = (s + \"00\").replace(/(\\d*\\.\\d\\d)\\d*/, \"$1\");\n        s = s.replace(\".\", \",\");\n        let re = /(\\d)(\\d{3},)/;\n        while (re.test(s))\n            s = s.replace(re, \"$1,$2\");\n        s = s.replace(/,(\\d\\d)$/, \".$1\");\n        if (type === 0) {\n            let a = s.split(\".\");\n            if (a[1] === \"00\") {\n                s = a[0];\n            }\n        }\n        return s;\n    }\n\n    // isValid => true 为日期  false 为 数字\n    getCellStyleConvert(cellStyle, isValid) {\n        if (cellStyle && cellStyle.format && cellStyle.format === 'number') {\n            return \"number\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'rmb') {\n            return 'rmb';\n        } else if ((cellStyle && cellStyle.format && cellStyle.format === 'normal')) {\n            return \"normal\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'percent') {\n            return \"percent\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'datetime') {\n            return \"datetime\";\n        } else if (\n            (isValid && !isHave(cellStyle))\n            || (isValid && cellStyle && cellStyle.format !== 'normal')\n            || cellStyle && cellStyle.format && cellStyle.format === 'date') {\n            return \"date\";\n        }\n\n        return \"\";\n    }\n\n    getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, abs = 0, isRows) {\n        let enter = false;\n        let s = \"\";\n        if (isInsert) {\n            if (sri <= ds[1] && isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[1] && !isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[0] && isAdd && isRows === false) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            }\n        }\n\n        return {\n            \"enter\": enter,\n            \"data\": s,\n        }\n    }\n\n    eachRange(range) {\n        let cells = [];\n        range.each((i, j) => {\n            let cell = this.getCell(i, j);\n            if (isHave(cell)) {\n                let empty = isEmpty(cell);\n                cell = deepCopy(cell);\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), empty);\n                cells.push(cellProp);\n            } else  {\n                cell = {};\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), true);\n                cells.push(cellProp);\n            }\n        });\n\n        return cells;\n    }\n\n    getCellTextByShift(arr, dei, dci, isInsert = false, isAdd = false, sri = 0, isRows = false) {\n        let bad = false;\n        let enter = false;\n        let newStr = \"\";\n\n        for (let i = 0; i < arr.length; i++) {\n            // if(isInsert && isHave(arr[i])) {\n            //     arr[i] = arr[i].replace(/\\$/, '');\n            // }\n            if (typeof arr[i] === 'string') {\n                arr[i] = arr[i].toUpperCase();\n            }\n            if (arr[i].search(/^[A-Z]+\\d+$/) !== -1) {\n                let ds = expr2xy(arr[i]);\n                if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    arr[i] = args.data;\n                } else if (isInsert === false) {\n                    arr[i] = xy2expr(ds[0] + dei, ds[1] + dci);\n                }\n                enter = true;\n            } else if (arr[i].search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                let a1 = arr[i].split(\":\")[0];\n                let a2 = arr[i].split(\":\")[1];\n                let ds1 = expr2xy(a1);\n                let ds2 = expr2xy(a2);\n\n                if (ds1[0] + dei < 0 || ds1[1] + dci < 0) {\n                    bad = true;\n                }\n                if (ds2[0] + dei < 0 || ds2[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let s = \"\";\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds1, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s = args.data + \":\";\n                } else if (isInsert === false) {\n                    s = xy2expr(ds1[0] + dei, ds1[1] + dci) + \":\";\n                } else {\n                    s = a1 + \":\";\n                }\n\n                args = this.getCellTextIsAdd(isInsert, sri, ds2, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s += args.data;\n                } else if (isInsert === false) {\n                    s += xy2expr(ds2[0] + dei, ds2[1] + dci);\n                } else {\n                    s += a2;\n                }\n\n                enter = true;\n                arr[i] = s;\n            } else {\n                let value = isAbsoluteValue(arr[i], 5);\n\n                if (value === 2) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0] + dei, ds[1], 2);\n                    }\n                    enter = true;\n                } else if (value === 1) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0], ds[1] + dci, 1);\n                    }\n\n                    enter = true;\n                } else if (value === 4) {\n                    let sp = arr[i].split(\":\");\n                    console.log(arr[i], sp);\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 5) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 7) {\n                    let sp = arr[i].split(':');\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 6) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 8) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 9) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 10) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 11) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                }\n            }\n            newStr += arr[i];\n        }\n\n        return {\n            \"bad\": bad,\n            \"enter\": enter,\n            \"result\": newStr\n        };\n    }\n\n    autoFilterRef(ref, range) {\n        let [ci, ri] = expr2xy(ref);\n        let cell = this.getCell(ri, ci);\n        while (cell !== null) {\n            ri += 1;\n            cell = this.getCell(ri, ci);\n        }\n        range.eri = ri;\n\n        return range;\n    }\n\n    // getAllDataType(cellRange)\n    getAllDataType(cellRange) {\n        let isNumber = true, isDate = true, sarr = [];\n\n        cellRange.each((i, j) => {\n            let und = false, cell = this.getCell(i, j);\n            if (cell) {\n                cell = deepCopy(cell);\n                let args = new CellProxy(cell).getCellDataType(sarr, {isDate, isNumber});\n                // pasteProxy.getCellDataType(cell, sarr, {isDate, isNumber}); // let args = CellProxy(cell).getCellDataType()\n                isDate = args.isDate;\n                isNumber = args.isNumber;\n            } else {\n                und = true;\n                isNumber = false;\n                isDate = false;\n            }\n\n            if (und) {\n                sarr.push({\n                    text: 0,\n                    formulas: 0,\n                    tmp: \"\",\n                    type: \"other\",\n                });\n            }\n        });\n\n        return {\n            isDate: isDate, isNumber: isNumber, sarr\n        }\n    }\n\n    calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb) {\n        let {text, formulas} = ncell;\n        text = this.toString(text);\n        formulas = this.toString(formulas);\n        let cell = {};\n        if (this.isFormula(formulas)) {\n            let last1 = text.replace(\"=\", \"\") * 1;\n\n            let value = last1 + diffValue;\n            cell = {\n                \"text\": \"=\" + value + \"\",\n                \"formulas\": \"=\" + value + \"\",\n            };\n        } else if (text !== '') {\n            let last1 = text * 1;\n            if (text.indexOf(\",\") !== -1) {\n                last1 = last1.replace(/,/g, '');\n                let value = parseFloat(last1) + diffValue;\n                last1 = this.formatMoney(value, 0);\n            } else {\n                last1 = last1 + diffValue;\n            }\n\n            cell = {\n                \"text\": last1 + \"\",\n                \"formulas\": last1 + \"\",\n            };\n        }\n\n        this.copyRender(darr, d.ri, d.ci, cell, what, cb);\n    }\n\n    calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb) {\n        let strList = splitStr(iText);\n        let args = this.getRangeByTopCell({ri: d.ri, ci: d.ci}, direction, isAdd);\n        let dci = d.ri - args.ri;\n        let dri = d.ci - args.ci;\n        let {bad, result} = this.getCellTextByShift(strList, dri, dci);\n        this.updateCellReferenceByShift(bad, result, d.ri, d.ci, cb);\n    }\n\n    calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text) {\n\n        if (!isHave(iText)) {\n            iText = \"\";\n        }\n        if (!isNaN(iText)) {\n            ncell.text = iText;\n            ncell.formulas = ncell.text;\n        } else {\n            let arr = this.toString(iText).split(/\\d+/g);\n            if (arr) {\n                let count = 0;\n                if (isAdd) {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 + 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                } else {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 - 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                }\n                ncell.formulas = ncell.text;\n            }\n        }\n        this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    }\n\n    calcDateCellByTopCell(ncell, darr, d, isAdd, what, cb, diff) {\n        if (ncell.text !== '') {\n            let last1 = ncell.text;\n\n            let value = \"\";\n            if (isAdd) {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            } else {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            }\n            ncell.text = this.toString(value);\n            ncell.formulas = this.toString(value);\n            this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n        }\n    }\n\n    getRangeByTopCell({ri, ci}, direction, isAdd) {\n        if (isAdd) {\n            ri = !direction ? ri - 1 : ri;\n            ci = !direction ? ci : ci - 1;\n        } else {\n            ri = !direction ? ri + 1 : ri;\n            ci = !direction ? ci : ci + 1;\n        }\n\n        return {ri, ci};\n    }\n\n    // logProxy.log({\"msg\":\"12312\"})  console.log --> logProxy.log\n    getCellByTopCell(d, direction, isAdd, what = 'all', dri = 0, dci = 0) {\n        if (what === 'date') {\n            if (direction === 1) {\n                let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, false, isAdd);\n                return this.getCellByCell(ri, ci);\n            } else if (direction === 2) {\n                return this.getCellByCell(d.ri, d.ci - 1);\n            } else if (direction === 3) {\n                return this.getCellByCell(d.ri, d.ci + 1);\n            }\n        } else {\n            let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, direction, isAdd);\n            return this.getCellByCell(ri, ci);\n        }\n    }\n\n    getCellByCell(ri, ci) {\n        let ncell = this.getCell(ri, ci);\n        if (!ncell) {\n            ncell = {\n                text: '',\n                formulas: '',\n            }\n        }\n\n        return helper.cloneDeep(ncell);\n    }\n\n    updateCellReferenceByShift(bad, result, ri, ci, cb = () => {\n    }) {\n        let _cell = {};\n        if (bad) {\n            _cell.text = \"#REF!\";\n            _cell.formulas = \"#REF!\";\n        } else {\n            _cell.text = result !== \"\" ? result : '';\n            _cell.formulas = result !== \"\" ? result : '';\n        }\n        // rows.setCellText(ri, ci, {text, style}, proxy, this.name, 'style');\n        this.setCell(ri, ci, _cell, 'all');\n        cb(ri, ci, _cell);\n    }\n\n    // what: all | format | text\n    // 填充\n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {pasteProxy} = this;\n        pasteProxy.setSrcAndDstCellRange(srcCellRange, dstCellRange);\n        let {rn, cn} = pasteProxy.use();\n        let isLeftRight = pasteProxy.autoFilterDirection();\n\n        let len = isLeftRight ? rn : cn;\n        for (let i = 0; i < len; i++) {\n            let isDown = pasteProxy.upOrDown();\n            let {srcOneDRange, dstOneDRange} = pasteProxy.getOneDRangeObj(isLeftRight, i);\n            let {isNumber, isDate, sarr} = this.getAllDataType(srcOneDRange);\n            // let isCopy = pasteProxy.isCopy(sarr, i);\n\n            let darr = dstOneDRange.getLocationArray(sarr); //let dstOneDLocationAarray = dstOneDRange.getLocationArray()\n            let line = pasteProxy.leftOrRight(); // 向左或者向右\n            let other = false;\n\n            for (let i = 0; i < darr.length; i++) {\n                let d = darr[i];\n                if (isNumber || d.type === 'number' || isDate || d.type === 'date') {\n                    other = true;\n                }\n            }\n\n            if (isDown) {\n                for (let i = 0; i < darr.length; i++) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            } else {\n                for (let i = darr.length - 1; i >= 0; i--) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            }\n        }\n    }\n\n\n    copyRender(darr, nri, nci, ncell, what, cb) {\n        let as = false;\n        for (let k = 0; as === false && k < darr.length; k++) {\n            if (darr[k].ri === nri && darr[k].ci === nci) {\n                as = true;\n            }\n        }\n        if (as) {\n            this.setCell(nri, nci, ncell, what);\n            cb(nri, nci, ncell);\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        let srcCell = [];\n        // const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n\n                if (ri * 1 !== nri || ci * 1 !== nci) {\n                    // ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                    if (this._[ri].cells[ci].text !== '' && this._[ri].cells[ci].formulas !== '') {\n                        srcCell.push({\n                            nri: nri,\n                            nci: nci,\n                            ri: ri,\n                            ci: ci,\n                            cell: deepCopy(this._[ri].cells[ci]),\n                        })\n                        // this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    }\n\n                    // if (this._[ri].cells[ci].style) {\n                    //     this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    // }\n                }\n            });\n        });\n        for (let i = 0; i < srcCell.length; i++) {\n            let {ri, ci} = srcCell[i];\n            this.setCell(ri, ci, {}, 'all');\n        }\n\n        for (let i = 0; i < srcCell.length; i++) {\n            let {nri, nci, cell} = srcCell[i];\n            this.setCell(nri, nci, cell, 'all');\n        }\n\n        // this._ = ncellmm;\n    }\n\n    insert(sri, n = 1) {\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= sri) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n, true, true, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n\n            ndata[nri] = row;\n        });\n\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n * -1, true, false, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri - n, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1) {\n        let cells = [];\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= sci) {\n                    nci += n;\n\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), n, 0, true, true, sci, false);\n                        if (enter && !bad) {\n                            cells.push({ri: ri, ci: nci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (isHave(cell.text)) delete cell.text;\n                    if (isHave(cell.value)) delete cell.value;\n                    if (isHave(cell.formulas)) delete cell.formulas;\n                    // if (isHave(cell.depend)) delete cell.depend;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    recast(cell) {\n        try {\n            if (this.isReferOtherSheet(cell, true)) {\n                let recast = new Recast(cell.formulas);\n                recast.parse();\n                cell['recast'] = recast;\n            } else {\n                cell['recast'] = null;\n            }\n        } catch (e) {\n            cell['recast'] = null;\n        }\n    }\n\n    init() {\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n            });\n        });\n    }\n\n    setData(d, sheet = \"\", out = false, rowsInit = false) {\n        try {\n            if (d.len) {\n                this.len = d.len;\n                delete d.len;\n            }\n            this._ = d;\n\n\n            if (out) {\n\n            } else if (sheet !== '') {\n                console.time(\"setData\");\n                if (rowsInit) {\n                    this.init();\n                    this.workbook = calcUtils.Rows2Workbook(this);\n                    sheet.toolbar.change('close', '');\n                }\n                console.timeEnd(\"setData\");\n\n            }\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n}\n\nexport {\n    Rows,\n};\n","import {sheetReset} from \"../component/sheet\";\nimport {h} from \"../component/element\";\nimport Drag from \"../external/drag\";\nimport Resize from \"../external/resize\";\nimport {cssPrefix} from \"../config\";\nimport {getChooseImg} from \"../event/copy\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from \"../core/cell_range\";\n// import {deepCopy} from \"../core/operator\";\nimport TableProxy from \"../core/table_proxy\";\n\nexport let resizeOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n\n    onEnd(data) {\n\n    },\n    onResize(data, self) {\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n\n        img.img2.style['width'] = img.img.el.style['width'];\n        img.img2.style['height'] = img.img.el.style['height'];\n    }\n};\n\nexport let dragOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n    onEnd(data, self) {\n        let {left, top} = data;\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n        // img.left = left + 70;\n        // img.top = top + 31;\n\n        if (top - 31 < 0) {\n            top = 0;\n        } else if (left - 60 < 0) {\n            left = 0;\n        }\n\n        let range = self.data.getCellRectByXY(left + 60, top + 31);\n        range.sri = range.ri;\n        range.sci = range.ci;\n        range.eri = range.ri;\n        range.eci = range.ci;\n        let offsetLeft = left - range.left + 50;\n        let offsetTop = top - range.top + 21;\n\n        img.offsetLeft = offsetLeft;\n        img.offsetTop = offsetTop;\n        img.range = range;\n        if (typeof img.lastCi !== 'undefined' && typeof img.lastRi !== 'undefined') {\n            img.ri = img.lastRi;\n            img.ci = img.lastCi;\n        }\n        img.lastCi = range.ci;\n        img.lastRi = range.ri;\n\n        // self.data.history.addPic(deepCopy(self.data.pasteDirectionsArr), \"delete\");\n    },\n    onDrag(data) {\n    },\n};\n\nfunction spanDomPackage(spanDom, tableDom) {\n    let table = h(\"table\", \"\");\n    let tbody = h('tbody', '');\n\n    let textArr = spanDom.innerText.split(\"\\n\");\n    for (let i = 0; i < textArr.length; i++) {\n        let text = textArr[i];\n        let tr = h('tr', '');\n        let td = h('td', '');\n        td.html(text);\n        td.css('background', spanDom.style['background']);\n        td.css('font-weight', spanDom.style['font-weight']);\n        td.css('color', spanDom.style['color']);\n        tr.child(td);\n        tbody.child(tr);\n    }\n\n    table.child(tbody);\n    tableDom = table.el;\n\n    return tableDom;\n}\n\nexport function process(tableDom, styleDom = \"\") {\n    let {el, data} = this;\n    data.history.add(data.getData());\n    el.child(tableDom);\n    GetInfoFromTable.call(this, tableDom);\n    tableDom.parentNode.removeChild(tableDom);\n    if (styleDom) {\n        styleDom.parentNode.removeChild(styleDom);\n    }\n    sheetReset.call(this);\n}\n\nfunction mountPaste(e, cb) {\n    let cbd = e.clipboardData;\n    let p = false;\n\n    for (let i = 0; i < cbd.items.length; i++) {\n        let item = cbd.items[i];\n        if (item.kind === \"string\") {\n            item.getAsString((str) => {\n                let textDom = h('head', '');\n                let d = h('span', '');\n                if ((str.indexOf('<span') === -1 && str.indexOf('span>') === -1) && (str.indexOf('<table') === -1 && str.indexOf('table>') === -1)) {\n                    d.html(str);\n                    textDom.child(d.el);\n                    textDom = textDom.el;\n                }\n                else {\n                    textDom.html(str);\n                    textDom = textDom.el;\n                }\n                let imgDom = textDom.getElementsByTagName(\"img\")[0];\n                let styleDom = textDom.getElementsByTagName(\"style\")[0];\n                let tableDom = textDom.getElementsByTagName(\"table\")[0];\n                let spanDom = textDom.getElementsByTagName(\"span\")[0];\n                if (imgDom && !styleDom) {\n                    mountImg.call(this, imgDom);\n                    p = true;\n                } else {\n                    if (!tableDom) {\n                        setTimeout(() => {\n                            if (p) {\n                                return;\n                            }\n                            if (spanDom) {\n                                tableDom = spanDomPackage.call(this, spanDom, tableDom);\n                            }\n                            if (styleDom) {\n                                let {el} = this;\n                                el.child(styleDom);\n                            }\n\n                            if (tableDom && p === false) {\n                                let {el} = this;\n                                el.child(tableDom);\n                                GetInfoFromTable.call(this, tableDom);\n                                tableDom.parentNode.removeChild(tableDom);\n                                if (styleDom) {\n                                    styleDom.parentNode.removeChild(styleDom);\n                                }\n                                sheetReset.call(this);\n                                p = true;\n                            }\n                        }, 100)\n                    } else {\n                        if (styleDom) {\n                            let {el} = this;\n                            el.child(styleDom);\n                        }\n\n                        if (tableDom && p === false) {\n                            process.call(this, tableDom, styleDom);\n                            p = true;\n                        }\n                    }\n                }\n            });\n        } else if (item.kind === \"file\" && !p) {\n            let f = item.getAsFile();\n            let reader = new FileReader();\n            reader.onload = (evt) => {\n                // let {x, y, overlayerEl} = this;\n                // let {pasteDirectionsArr} = this.data;\n                let img = h('img', 'paste-img');\n                img.el.src = evt.target.result;\n\n                setTimeout(() => {\n                    if (p) {\n                        return;\n                    }\n                    p = true;\n                    mountImg.call(this, img.el);\n                }, 0);\n            };\n\n            if (!f)\n                return;\n            reader.readAsDataURL(f);\n        }\n    }\n    setTimeout(() => {\n        if (!p)\n            cb();\n        else {\n            let {data} = this;\n            data.change(data.getData());\n        }\n    })\n}\n\n// function processImg(item) {\n//     let f = item.getAsFile();\n//     let reader = new FileReader();\n//     reader.onload = (evt) => {\n//         // let {x, y, overlayerEl, pasteDirectionsArr} = this;\n//         let img = h('img', 'paste-img');\n//         img.el.src = evt.target.result;\n//\n//         setTimeout(() => {\n//             if (p) {\n//                 return;\n//             }\n//             p = true;\n//             mountImg.call(this, img.el);\n//         }, 0);\n//     };\n//\n//     reader.readAsDataURL(f);\n// }\n\n// function moveArr(top, left) {\n//     let {pasteDirectionsArr} = this.data;\n//     for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//         let p = pasteDirectionsArr[i];\n//         console.log(p.img.el['style'].top, \"108\");\n//         p.img.css(\"top\", `${top }px`)\n//             .css(\"left\", `${left  }px`)\n//     }\n// }\n\nfunction getMaxCoord(ri, ci) {\n    let top = 0;\n    let left = 0;\n    let {pasteDirectionsArr} = this.data;\n    let number = 0;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        if (p.ri === ri && p.ci === ci) {\n            if (left < p.nextLeft) {\n                left = p.nextLeft;\n            }\n            if (top < p.nextTop) {\n                top = p.nextTop;\n            }\n            number++;\n        }\n    }\n\n    return {\n        top: top,\n        left: left,\n        number: number,\n    }\n}\n\n\n// 删掉了 入参   add = true\nexport function mountImg(imgDom, init = false, sri, sci, range) {\n    let image = new Image();\n    image.src = imgDom.src;\n    image.onload = () => {\n        let width = image.width;\n        let height = image.height;\n        let img = imgDom;\n        let {container, data} = this;\n        let {pasteDirectionsArr} = data;\n        // if (add) {\n        //     // data.history.addPic(Object.assign([], pasteDirectionsArr), \"delete\");\n        // }\n\n        let {ri, ci} = data.selector;\n        if (init) {\n            ri = sri;\n            ci = sci;\n        }\n        let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n        const rect = data.getMoveRect(new CellRange(ri, ci, ri, ci));\n        let left = rect.left + pictureOffsetLeft;\n        let top = rect.top + pictureOffsetTop;\n        let number = 0;\n        let choose = getChooseImg.call(this);\n        if (choose) {\n            let args = getMaxCoord.call(this, choose.ri, choose.ci);\n            left = args.left;\n            top = args.top;\n            ri = choose.ri;\n            ci = choose.ci;\n            number = args.number;\n        }\n\n        let div = h('div', `${cssPrefix}-object-container`)\n            .css(\"position\", \"absolute\")\n            .css(\"top\", `${top}px`)\n            .css(\"width\", `${width}px`)\n            .css(\"height\", `${height}px`)\n            .css(\"z-index\", `100000`)\n            .css(\"left\", `${left}px`)\n            .child(img);\n        container.child(div);\n        new Drag(dragOption, this).register(div.el);\n        setTimeout(() => {\n            let {data} = this;\n            let directionsArr = new Resize(resizeOption, this).register(div.el);\n            let index = pasteDirectionsArr.length;\n\n            pasteDirectionsArr.push({\n                \"src\": img.src,\n                \"state\": true,\n                \"arr\": directionsArr,\n                \"img\": div,\n                \"index\": index,\n                \"img2\": img,\n                \"ri\": ri,\n                \"ci\": ci,\n                \"offsetLeft\": 0,\n                \"offsetTop\": 0,\n                \"number\": number,\n                \"range\": init ? range : data.selector.range,\n                \"top\": top,\n                \"left\": left,\n                \"nextLeft\": left + 15,\n                \"nextTop\": top + 15,\n            });\n            if (!init) {\n                this.data.change(this.data.getData());\n            }\n            this.direction = true;\n            div.css(\"width\", `${img.offsetWidth}px`);\n            div.css(\"height\", `${img.offsetHeight}px`);\n            containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr, init);\n            div.on('mousedown', () => containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr));\n        }, 0);\n    };\n}\n\nfunction hideDirectionArr() {\n    let {pasteDirectionsArr} = this.data;\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let arr = pasteDirectionsArr[i].arr;\n            if (arr.length > 0) {\n                for (let j = 0; j < arr.length; j++) {\n                    arr[j].style.display = 'none';\n                }\n            }\n            pasteDirectionsArr[i].state = false;\n            pasteDirectionsArr[i].img.css(\"z-index\", \"10000\");\n            pasteDirectionsArr[i].img2.style['border'] = \"none\";\n        }\n    }\n}\n\nfunction deleteImg(d = false) {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true || d === true) {\n                direction_delete.push(pasteDirectionsArr[i]);\n            } else {\n                direction_new.push(pasteDirectionsArr[i]);\n            }\n        }\n    }\n\n    Object.keys(direction_delete).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n\n    let {data} = this;\n    data.pasteDirectionsArr = direction_new;\n    data.change(data.getData());\n}\n\n// function deleteAllImg() {\n//     let {pasteDirectionsArr} = this.data;\n//     let direction_new = [];\n//     let direction_delete = [];\n//     this.direction = false;\n//     if (pasteDirectionsArr.length > 0) {\n//         for (let i = 0; i < pasteDirectionsArr.length; i++) {\n//             direction_delete.push(pasteDirectionsArr[i]);\n//         }\n//     }\n//\n//     Object.keys(pasteDirectionsArr).forEach(i => {\n//         direction_delete[i].img.removeEl();\n//     });\n//\n//     this.pasteDirectionsArr = direction_new;\n// }\n\nfunction containerHandlerEvent(directionsArr, index, pasteDirectionsArr, init) {\n    hideDirectionArr.call(this);\n    this.direction = true;\n    Object.keys(directionsArr).forEach(i => {\n        directionsArr[i].style.display = 'block';\n    });\n\n    let {selector, editor} = this;\n    if (!init) {\n        selector.hide();\n        editor.clear();\n\n        pasteDirectionsArr[index].img.css(\"z-index\", \"99999999\");\n        pasteDirectionsArr[index].state = true;\n    } else {\n        hideDirectionArr.call(this);\n    }\n}\n\nfunction equals(x, y) {\n    let f1 = x instanceof Object;\n    let f2 = y instanceof Object;\n    if (!f1 || !f2) {\n        return x === y\n    }\n    if (Object.keys(x).length !== Object.keys(y).length) {\n        return false\n    }\n    let newX = Object.keys(x);\n    for (let p in newX) {\n        p = newX[p];\n        let a = x[p] instanceof Object;\n        let b = y[p] instanceof Object;\n        if (a && b) {\n            let equal = equals(x[p], y[p]);\n            if (!equal) {\n                return equal\n            }\n        } else if (x[p] !== y[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isHaveStyle(styles, style) {\n    for (let i = 0; i < styles.length; i++) {\n        if (equals(styles[i], style)) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n\nfunction GetInfoFromTable(tableObj) { // class ClipboardTableProxy; .tableDom 属性  .dealColSpan() [477~483], dealStyle(), dealReferrence()， 最终得到row2； sheet层面上：（1）增加行与列。（2）setCellRange变更值。（3）给出黏贴选项\n    let {data} = this;\n    let {ri, ci} = data.selector;\n    let styles = data.styles;\n    console.time(\"paste\");\n    let tableProxy = new TableProxy(data);\n\n    tableProxy.extend(tableObj, {ri, ci});\n    tableProxy.dealColSpan(tableObj);\n    tableProxy.dealStyle(tableObj, {ri, ci});\n    let {reference} = tableProxy.dealReference(tableObj, {ri, ci});\n    this.setCellRange(reference, tableProxy, true, tableProxy.parseTableCellRange(tableObj, {ri, ci}));\n\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n    let {advice, editor} = this;\n    editor.clear();\n    advice.show(left, top, 1, reference, tableProxy);\n    console.timeEnd(\"paste\");\n    return {\n        rows: data.rows._,\n        styles: styles\n    };\n}\n\n// function pasteType(type, ds, dei) {\n//     if (type === 1) {\n//\n//     } else if (type === 2) {\n//         xy2expr(ds[0] + dei, ds[1], 2);\n//     }\n// }\n\nexport {\n    mountPaste,\n    hideDirectionArr,\n    deleteImg,\n    // moveArr,\n    // deleteAllImg,\n    GetInfoFromTable,\n}\n\n","/* global window */\nimport {h} from './element';\nimport {bind, bindTouch, mouseMoveUp, remove} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix, offsetLeft, offsetTop} from '../config';\nimport {formulas} from '../core/formula';\nimport {getFontSizePxByPt} from \"../core/font\";\n// import {baseFormats, multiply} from \"../core/format\";\nimport Advice from \"../component/advice\";\nimport {clearSelectors, editingSelectors, lockCells, makeSelector} from \"../component/formula_editor\";\nimport {deleteImg, hideDirectionArr, mountPaste} from \"../event/paste\";\nimport {getChooseImg, mountCopy} from \"../event/copy\";\nimport Website from \"../component/website\";\nimport {cutStr, cuttingByPos, deepCopy} from \"../core/operator\";\nimport {moveCell} from \"../event/move\";\nimport CellRange from \"../core/cell_range\";\nimport {isHave, isOusideViewRange} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\nimport ErrorPopUp from \"./error_pop_up\";\nimport RectProxy from \"../core/rect_proxy\";\nimport {testValid} from \"../utils/test\";\nimport Timer from \"../model/Timer\";\nimport PreAction from \"../model/pre_action\";\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top * 1) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    // console.log(multiple, ', ri:', ri, ', ci:', ci);\n    const {\n        table, selector, toolbar,\n    } = this;\n\n    if (multiple) {\n        selector.setEnd(ri, ci, moving, true);\n    } else {\n        selector.set(ri, ci, indexesUpdated);\n    }\n\n    toolbar.reset();\n\n    // add\n    clearTimeout(this.render_timer);\n\n    this.render_timer = setTimeout(() => {\n        table.render();\n    }, 100);\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data, editor\n    } = this;\n    const {rows, cols} = data;\n    if (editor.isCors) {\n        selector.indexes = [editor.ri, editor.ci];\n    }\n    let [ri, ci] = selector.indexes;\n    const { eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n\n\n    // console.log(\"92\", ri, ci, editor.ri, editor.ci)\n    // if((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n    //     return;\n    // }\n\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        // if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selector.selectCell.setData(ri, ci);\n    selector.selectCell.resetSelectOffset();\n    selectorSet.call(this, multiple, ri, ci);\n    // editor.clear();\n\n    editorSetOffset.call(this);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    if (evt.buttons !== 0) return;\n    if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n    const {offsetX, offsetY} = evt;\n\n    const {\n        rowResizer, colResizer, tableEl, data, website\n    } = this;\n    const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n\n    // moveCell.call(this);\n\n    // url 展开\n    website.show(cRect.ri, cRect.ci);\n    const {rows, cols} = data;\n    if (offsetX > cols.indexWidth && offsetY > rows.height) {\n        rowResizer.hide();\n        colResizer.hide();\n        return;\n    }\n    const tRect = tableEl.box();\n    if (cRect.ri >= 0 && cRect.ci === -1) {\n        cRect.width = cols.indexWidth;\n        rowResizer.show(cRect, {\n            width: tRect.width,\n        });\n    } else {\n        rowResizer.hide();\n    }\n    if (cRect.ri === -1 && cRect.ci >= 0) {\n        cRect.height = rows.height;\n        colResizer.show(cRect, {\n            height: tRect.height,\n        });\n    } else {\n        colResizer.hide();\n    }\n}\n\nfunction overlayerMousescroll(evt) {\n    const {verticalScrollbar, data} = this;\n    const {autoLoad} = data.settings;\n    const {top} = verticalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n    let delta = evt.deltaY;\n    const {rows} = data;\n    if (evt.detail) delta = evt.detail * 40;\n    if (delta > 0 && autoLoad === true) {\n        // up\n        const ri = data.scroll.ri + 1;\n        if (ri < rows.len) {\n            verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n        }\n    } else if (autoLoad === true) {\n        // down\n        const ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    }\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('direction:', direction, ', distance:', distance, left);\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    verticalScrollbar.set(height, data.rows.totalHeight());\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset() {\n    // debugger\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    renderAutoAdapt.call(this);\n    autoRowResizer.call(this);\n\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    selector.selectCell.toolbarChangeSelectorCell();\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy() {\n    const {data, selector} = this;\n    data.copy();\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    data.cut();\n    selector.showClipboard();\n}\n\n// const a = () => {\n// }\n\nfunction paste(what, cb = (p) => {\n    if (p) {\n        clearClipboard.call(this);\n        sheetReset.call(this);\n    }\n}) {\n    const {data} = this;\n    let p = data.paste(what, msg => xtoast('Tip', msg));\n    cb(p);\n\n    return p;\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar, data} = this;\n    if (toolbar.paintformatActive()) {\n        // paste.call(this, 'format');\n        data.paintFormatChange((ri, ci) => {\n            selectorSet.call(this, true, ri, ci, true, true);\n        });\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n        toolbar.reset();\n    }\n}\n\nfunction getPoint(obj) { //获取某元素以浏览器左上角为原点的坐标\n    let t = obj.offsetTop; //获取该元素对应父容器的上边距\n    let l = obj.offsetLeft; //对应父容器的上边距\n    //判断是否有父容器，如果存在则累加其边距\n    while (obj = obj.offsetParent) {//等效 obj = obj.offsetParent;while (obj != undefined)\n        t += obj.offsetTop; //叠加父容器的上边距\n        l += obj.offsetLeft; //叠加父容器的左边距\n    }\n\n    return {\n        t: t,\n        l: l\n    }\n}\n\nfunction dropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, pos = 0, offset, horizontalScrollbar, cols) {\n    this.selector.setBoxinner(\"none\");\n    this.container.css('pointer-events', 'none');\n    let dstRect = data.getCellRectByXYWithNotTotalResult(e.layerX || e.clientX, e.layerY || e.clientY);\n    let {ri, ci} = dstRect;\n\n    if (isAutofillEl) {\n        let {rpos, ey, ex,} = dropGetPos.call(this, data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos);\n\n        let orien = selector.showAutofill(ri, ci, rpos);\n        if (isOusideViewRange(this.data.settings.view.height(), this.data.settings.view.width(), ey, ex, orien)) {\n            // if (Math.round(Math.random()) === 1) {\n            continueMove.call(this, orien, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n            // }\n        }\n\n    } else if (e.buttons === 1 && !e.shiftKey) {\n        ri = ri <= 0 ? 0 : ri;\n        ci = ci <= 0 ? 0 : ci;\n        let cell = data.viewRange();\n        let pos = cell.getMovePos(ri, ci);\n\n        selectorBeyondMove.call(this, pos, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n\n        console.log(\"ri: \", ri, \"ci: \", ci);\n        selectorSet.call(this, true, ri, ci, true, true);\n    }\n}\n\n\nfunction dropGetPos(data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos) {\n    let rect = data.getRect(selector.range);\n    let rectProxy = new RectProxy(rect);\n    let clientX = rect.width + rect.left;\n    let clientY = rect.height + rect.top + offsetTop;\n    let ex = e.clientX - offset.l - offsetLeft;\n    let ey = e.clientY;\n\n    if (rectProxy.isLocInside(ex, ey)) {\n        pos = -1;\n        selector.arange = null;\n    } else {\n        pos = rectProxy.getUpDownLeftRight(ex, ey, clientX, clientY)\n    }\n\n    return {\n        rpos: pos,\n        ex,\n        ey\n    };\n}\n\nfunction selectorBeyondMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    if (orien === 2) {   //往下\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 6) {    // 往上\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 3) {        //往右\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 5) {    // 往左\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 1) { // 往下往右\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 7) {         // 往下往左\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 8) {     // 往上往右\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 4) {       // 往上往左\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    }\n}\n\nfunction scrollTo(orien, verticalScrollbar, horizontalScrollbar, rows, data, cols) {\n    if (Math.round(Math.random()) !== 1) {\n        return;\n    }\n    // 1 下 2 上 3左 4 右\n    let ri = 0, ci = 0;\n    if (orien === 1) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 2) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n\n        verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n    } else if (orien === 4) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 3) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\nfunction continueMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    let ri = 0, ci = 0;\n    if (orien === 44) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 22) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    } else if (orien === 33 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 11 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data,  sortFilter, editor, advice\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    editor.setRiCi(ri, ci);\n\n    // sort or filter\n    const {autoFilter} = data;\n\n    // trait add\n    hideDirectionArr.call(this);\n    advice.el.hide();\n\n    if (autoFilter.includes2(ri, ci)) {\n        autoFilter.getSet(data.exceptRowSet, ri);\n    }\n\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n\n        // let {pageX, pageY} = evt;\n        let {verticalScrollbar, horizontalScrollbar} = this;\n        const {rows, cols} = data;\n        // const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri + 1;\n        // let ttop = top + rows.getHeight(ri) - 1;\n\n        let point = getPoint(this.el.el);\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            console.log(\"dropdown\");\n            clearStopTimer.call(this);\n\n            continueDropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols);\n\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols);\n        }, () => {\n            clearStopTimer.call(this);\n\n            if (isAutofillEl) {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    testValid.call(this);\n                    autofillNext.call(this);\n                }\n            }\n            this.selector.setBoxinner(\"auto\");\n\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n            this.container.css('pointer-events', 'auto');\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction continueDropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols) {\n    let stopTimer = setTimeout(() => {\n        let stopTimer2 = setInterval(() => {\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols,);\n        }, 50);\n        this.stopTimer2.push(stopTimer2);\n    }, 200);\n\n    this.stopTimer.push(stopTimer);\n}\n\nfunction clearStopTimer() {\n    this.stopTimer.clear();\n    this.stopTimer2.clear();\n}\n\nfunction autofillNext() {\n    const {\n        data, table, editor\n    } = this;\n    editor.display = true;\n    let enter = false;\n    // this.selector.arange.each((ri, ci) => {\n    //     // let cell = data.rows.getCell(ri, ci);\n    //     // if (cell && cell.formulas) {\n    //     //     let enter2 = this.editorProxy.change(ri, ci, cell.formulas, data.rows, data, true);\n    //     //     if (enter2 === true) {\n    //     //         enter = true;\n    //     //     }\n    //     // }\n    // });\n    if (enter) {\n        data.change(data.getData());\n    }\n    this.selector.arange = null;\n    loadFormula.call(this);\n    table.render();\n}\n\nfunction loadFormula(load = false) {\n    // this.table.proxy.diff = 305;\n    // this.table.proxy.oldData = \"\";\n    // sheetReset.call(this);\n    // clearTimeout(this.formulaTime);\n    // let {data, table} = this;\n    // this.formulaTime = setTimeout(() => {\n    //     let {date_formula} = data.settings;\n    //     if (date_formula && typeof date_formula.wland == \"function\") {\n    //         date_formula.wland(date_formula, data, table, load);\n    //     }\n    // }, 1500);\n}\n\nfunction firstRowToWidth(width) {\n    let cRect = {ri: -1, ci: 0, left: 60, top: 0, width: 100};\n    colResizerFinished.call(this, cRect, width);\n}\n\nfunction adviceSetOffset() {\n    const {data} = this;\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n\n    this.advice.el.el.style['top'] = `${top}px`;\n    this.advice.el.el.style['left'] = `${ left}px`;\n}\n\nfunction pictureSetOffset() {\n    const {data} = this;\n    let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n\n    this.data.pasteDirectionsArr.forEach(i => {\n        const sOffset = data.getMoveRect(i.range);\n\n        i.img.el.style['top'] = `${sOffset.top + pictureOffsetTop + i.number * 15 + i.offsetTop }px`;\n        i.img.el.style['left'] = `${sOffset.left + pictureOffsetLeft + i.number * 15 + i.offsetLeft}px`;\n    });\n}\n\n\nfunction editorSetOffset(show = true, cri = -1, cci = -1) {\n    const {\n        selector, data, editor\n    } = this;\n    let [ri, ci] = selector.indexes;\n    ri = cri === -1 ? ri : cri;\n    ci = cci === -1 ? ci : cci;\n\n    const sOffset = data.getMoveRect(new CellRange(ri, ci, selector.range.eri, selector.range.eci));\n    const tOffset = this.getTableOffset();\n\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n\n    editor.setOffset(sOffset, sPosition, show);\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction selectorsSetOffset() {\n    for (let i = 0; i < this.selectors.length; i++) {\n        let selector = this.selectors[i];\n        selector.selector.resetSelectorBRLAreaOffset(new CellRange(selector.ri, selector.ci, selector.ri, selector.ci));\n    }\n}\n\nfunction hasEditor(showEditor = true) {\n    // let {selector} = this;\n    if (showEditor === true) {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selectorMoveEl.el,\n                this.selector.el,\n            );\n    } else {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                // this.editor.el,\n                // this.selector.el,\n                this.selectorMoveEl.el\n            );\n    }\n}\n\nfunction editorSet() {\n    const {editor, data, selector} = this;\n    editorSetOffset.call(this);\n    editor.setCellEnd(data.getSelectedCell());\n    // editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), type);\n    if (this.data.settings.showEditor) {\n        selector.el.hide();\n    }\n    clearClipboard.call(this);\n\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrolly(distance, () => {\n        editor.display = false;\n        selector.resetBRLAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrollx(distance, () => {\n        editor.display = false;\n        selector.resetBRTAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction renderAutoAdapt() {\n    let {data, table} = this;\n    const viewRange = data.viewRange2();\n    let {autoAdapt} = data.settings.style;\n    let {ignoreRi} = data.settings;\n    let viewWidth = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            let txt = table.getCellTextContent(ri, ci);\n            const dbox = table.getDrawBox(ri, ci);\n\n            if (txt !== undefined) {\n                const style = table.getCellTextStyle(ri, ci);\n                const font = Object.assign({}, style.font);\n                font.size = getFontSizePxByPt(font.size);\n                // 得到当前文字最宽的width\n                let txtWidth = null;\n                if (style.format !== undefined) {\n                    // txtWidth = table.draw.selfAdaptionTxtWidth(formatm[style.format].render(txt), font, dbox);\n\n                } else {\n                    txtWidth = table.draw.selfAdaptionTxtWidth(txt, font, dbox);\n                }\n                if ((table.autoAdaptList[ci] === undefined || table.autoAdaptList[ci] < txtWidth) && ri > ignoreRi - 1) {\n                    table.autoAdaptList[ci] = txtWidth;\n                }\n            }\n        });\n        if (table.autoAdaptList.length < 0) {\n            return;\n        }\n        let {ignore} = data.settings;\n        for (let i = 0; i < table.autoAdaptList.length; i++) {\n            let _ignore = false;\n            for (let j = 0; j < ignore.length; j++) {\n                if (i === ignore[j]) _ignore = true;\n            }\n            if (_ignore === false) {\n                if (table.autoAdaptList[i] === undefined) {\n                    viewWidth += 50;\n                    data.cols.setWidth(i, 50);\n                } else {\n                    if (table.autoAdaptList[i] < 30) {\n                        table.autoAdaptList[i] = 30;\n                    }\n                    data.cols.setWidth(i, table.autoAdaptList[i]);\n                }\n            }\n            viewWidth += table.autoAdaptList[i];\n\n        }\n        if (viewWidth > 0)\n            data.settings.cellWidth = () => viewWidth;\n    }\n}\n\nfunction autoRowResizer() {\n    let {data, table} = this;\n    let viewRange = data.viewRange2();\n    let record_rc = 0, max = 0;\n    let r_h = data.settings.row.height;\n    let {autoAdapt} = data.settings.style;\n    let viewHeight = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            const txt = table.getCellTextContent(record_rc, ci);\n            const style = table.getCellTextStyle(ri, ci);\n            const font = Object.assign({}, style.font);\n            font.size = getFontSizePxByPt(font.size);\n            const dbox = table.getDrawBox(record_rc, ci);\n            // 1. 自适应调整一行的高度\n            // 2. 进入下一行 得到 本行的max\n            if (record_rc !== ri && txt !== undefined) {\n                let record_h = data.rows.getHeight(record_rc);\n                if (r_h * max !== record_h) {\n                    let c_h = font.size * max + dbox.padding * 2 + 2 * max;\n                    // console.log(\"451\", view.height(r_h * max));\n                    data.rows.setHeight(record_rc, c_h);\n                    viewHeight += c_h;\n                } else {\n                    viewHeight += record_h;\n                }\n                max = 0;\n            } else if (txt !== undefined && record_rc === ri) {\n                if (txt !== undefined) {\n                    const n = table.draw.selfAdaptionHeight(dbox, txt, font);\n                    if (n > max || max === 0) {\n                        max = n;\n                    }\n                }\n            }\n            record_rc = ri;\n        });\n        let record_h = data.rows.getHeight(record_rc);\n        const style = table.getCellTextStyle(record_h, 0);\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        const dbox = table.getDrawBox(record_rc, 0);\n        if (r_h * max !== record_h && viewHeight > 0) {\n            let c_h = font.size * max + dbox.padding * 2;\n            viewHeight += c_h;\n            data.rows.setHeight(record_rc, c_h);\n        } else if (viewHeight > 0) {\n            viewHeight += record_h;\n        }\n    }\n    console.log(503, viewHeight);\n    if (viewHeight > 0)\n        data.settings.view.height = () => viewHeight + 40;\n}\n\nfunction clickSelectorChangeRiCi(evt) {\n    const overlayer = evt.target.className === `${cssPrefix}-overlayer`;\n    if (!overlayer) {\n        return;\n    }\n\n    let {selector, data} = this;\n\n    const {offsetX, offsetY} = evt;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n\n    selector.selectCell.setData(cellRect.ri, cellRect.ci);\n    selector.selectCell.resetSelectOffset();\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setRowHeight(ri, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setColWidth(ci, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    // console.log('data:', data);\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction errorPop(enter, msg) {\n    const {errorPopUp} = this;\n\n    if (enter && !errorPopUp.open) {\n        errorPopUp.show(msg);\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else if (errorPopUp.open) {\n        errorPopUp.hide();\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    }\n    return {\n        \"state\": false,\n        \"msg\": msg\n    };\n}\n\nexport function selectorCellText(ri, ci, {text, style}, state) {\n    const {data, editor,} = this;\n    let args = data.selectorCellText(ri, ci, text + \"\", state);\n    if (args.state) {\n        args = errorPop.call(this, true, args.msg);\n        if (args.state) {\n            return true;\n        }\n    }\n\n    data.setCellText(ri, ci, {text, style});\n    editor.setRiCi(-1, -1);\n\n    return false;\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table, editor} = this;\n    // const [ri, ci] = selector.indexes;\n    let {ri, ci} = data.selector;\n    if ((editor.ri !== ri && editor.ri !== -1) || (editor.ci !== ci && editor.ci !== -1)) {\n        return;\n    }\n\n    data.setSelectedCellText(text, state);\n    if (state === 'finished') table.render();\n}\n\nfunction throwFormula() {\n    const {data} = this;\n    data.throwFormula();\n    // sheetReset.call(this);\n}\n\nexport function insertDeleteRowColumn(type) {\n    const {data} = this;\n    if (type === 'insert-row') {\n        data.insert('row');\n    } else if (type === 'delete-row') {\n        data.delete('row');\n    } else if (type === 'insert-column') {\n        data.insert('column');\n    } else if (type === 'delete-column') {\n        data.delete('column');\n    } else if (type === 'delete-cell') {\n        data.deleteCell();\n    } else if (type === 'delete-cell-format') {\n        data.deleteCell('format');\n    } else if (type === 'delete-cell-text') {\n        data.deleteCell('text');\n    }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'undoList') {\n        value.setContent(data.historyList(1));\n    } else if (type === 'redoList') {\n        value.setContent(data.historyList(2));\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        // print\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'throwFormula') {\n        throwFormula.call(this);\n    } else if (type === 'close') {\n        let {mri, mci} = data.getMax();\n\n        data.changeDataForCalc = new PreAction({\n            type: 999,\n            action: \"重新计算\", ri: -1, ci: -1, oldCell: {}, newCell: data.rows.eachRange(new CellRange(0, 0, mri, mci))\n        }, this.data);\n        sheetReset.call(this);\n        // loadFormula.call(this, true);\n    } else if (type === 'freeze') {\n        let {showFreeze} = data.settings;\n        if (value && showFreeze === true) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else if (type === 'add') {\n        data.showEquation = !data.showEquation;\n        sheetReset.call(this, true);\n    } else {\n        //format percent 473\n        data.setSelectedCellAttr(type, value);\n        if (type === 'border') {\n            borderResSet.call(this, 'none');\n        }\n        if (type === 'formula') {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction borderResSet(value = \"1px solid rgb(75, 137, 255\") {\n    this.selector.br.border(value);\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction afterSelector(editor) {\n    if (editor.getLock() || editor.state === 2) {\n        let {ri, ci} = editor;\n        let inputText = editor.editorText.getText();\n        let {selector} = this;\n        selector.indexes = [ri, ci];\n        return selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n    }\n    return false;\n}\n\nfunction pasteEvent(evt) {\n    clearClipboard.call(this);\n    mountPaste.call(this, evt, () => {\n        sheetReset.call(this);\n        let {data} = this;\n        data.change(data.getData());\n    });\n}\n\nfunction sheetInitEvents() {\n    const {\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n         contextMenu,\n        data,\n        toolbar,\n        modalValidation,\n        sortFilter,\n    } = this;\n\n    // pasteOverlay.on('mousedown', evt => {\n    //   console.log(\"669\");\n    //   pasteOverlay.hide();\n    // });\n\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            // renderAutoAdapt.call(this);\n            // autoRowResizer.call(this);\n            // the left mouse button: mousedown → mouseup → click\n            // the right mouse button: mousedown → contenxtmenu → mouseup\n            if (evt.buttons === 2) {\n                if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                    evt.stopPropagation();\n                } else {\n                    contextMenu.hide();\n                    overlayerMousedown.call(this, evt);\n                    setTimeout(() => {\n                        contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                        evt.stopPropagation();\n                    }, 100);\n                }\n                clickSelectorChangeRiCi.call(this, evt);\n            } else if (evt.detail === 2) {\n                clearTimeout(this.render_timer);\n                editor.setMouseDownIndex([]);\n\n                if (editor.getLock()) {\n                    return;\n                }\n                editorSet.call(this);\n            } else {\n                if (editor.getLock() || editor.isCors) {\n                    let _selector = null;\n                    let change = 0;\n                    mouseMoveUp(window, (e) => {\n                        this.container.css('pointer-events', 'none');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"none\");\n                        }\n\n                        let enter = true;\n                        let {merges} = data;\n                        // let {inputText} = editor;\n                        let inputText = editor.editorText.getText();\n                        let it = inputText;\n\n                        Object.keys(merges._).forEach(i => {\n                            let m = merges._[i];\n                            const cut = cutStr(it, true);\n                            for (let i = 0; i < cut.length; i++) {\n                                if (cut[i].indexOf(\":\") !== -1) {\n                                    let a1 = cut[i].split(\":\")[0];\n                                    let a2 = cut[i].split(\":\")[1];\n                                    let e1 = expr2xy(a1);\n                                    let e2 = expr2xy(a2);\n\n                                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                                        enter = false;\n                                    }\n                                }\n                            }\n                        });\n\n                        if (enter) {\n                            if (e.buttons === 1 && !e.shiftKey) {\n                                let {ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY);\n                                if (_selector && _selector.selector) {\n                                    _selector = makeSelector.call(this, ri, ci, this.selectors, true, _selector.selector, true);\n                                    lockCells.call(this, evt, _selector);\n                                    this.mergeSelector = true;\n                                } else {\n                                    let {pos} = editor;\n                                    let inputText = editor.editorText.getText();\n                                    for (let i = 0; i < this.selectors.length; i++) {\n                                        let selector = this.selectors[i];\n                                        let {erpx} = selector;\n\n                                        if (erpx === cuttingByPos(inputText, pos)) {\n                                            _selector = selector;\n                                            change = 1;\n                                            _selector.selector.set(ri, ci, true);\n                                            break;\n                                        }\n                                    }\n\n                                    _selector = _selector ? _selector : makeSelector.call(this, ri, ci, this.selectors, true, null, false);\n                                }\n                            }\n                        }\n                    }, () => {\n                        this.container.css('pointer-events', 'auto');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"auto\");\n                        }\n\n                        if (this.mergeSelector === false) {\n                            if (_selector && !change) {\n                                this.selectors.push(_selector);\n                            }\n                            lockCells.call(this, evt, _selector);\n                        } else if (_selector && !change && _selector.selector) {\n                            this.selectors.push(_selector);\n                        }\n                        if (_selector) {\n                            for (let i = 0; i < this.selectors.length; i++) {\n                                let selector = this.selectors[i];\n\n                                if (selector.className === _selector.className) {\n                                    selector.erpx = _selector.erpx;\n                                    break;\n                                }\n                            }\n                        }\n                        _selector = null;\n                        change = 0;\n                        this.mergeSelector = false;\n                    });\n                }\n\n                console.time(\"dbclick time1\");\n\n                if (!editor.getLock() && !editor.isCors) {\n                    console.time(\"dbclick time2\");\n\n                    let {ri, ci} = editor;\n                    let inputText = editor.editorText.getText();\n                    if (ri !== -1 && ci !== -1 && inputText[0] === \"=\") {\n                        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input');\n\n                        if (error) {\n                            return;\n                        }\n                    }\n                    console.timeEnd(\"dbclick time2\");\n\n                    let state = editor.clear();\n\n                    if (state) {\n\n                        // let cell = data.rows.getCell(ri, ci);\n                        // if (cell && cell.formulas) {\n                        //     this.editorProxy.change(ri, ci, cell.formulas, data.rows, data);\n                        // }\n                        loadFormula.call(this);\n\n                    }\n\n\n                    this.selector.longTimeBefore();\n                    overlayerMousedown.call(this, evt);\n                    clickSelectorChangeRiCi.call(this, evt);\n                    borderResSet.call(this);\n                    clearSelectors.call(this);\n                    editorSetOffset.call(this);\n                }\n                testValid.call(this);\n                console.timeEnd(\"dbclick time1\");\n\n            }\n        }).on('mousewheel.stop', (evt) => {\n        overlayerMousescroll.call(this, evt);\n    });\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        }\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        if (state === 'finish') { //  用户输入\n            data.editorChangeToHistory(editor.editorText.getOldCell(), editor.editorText.getRICI(), 1);\n            editor.editorText.setOldCell({}, {ri: -1, ci: -1});\n            return;\n        }\n\n        // 如果是 esc\n        if (itext === \"@~esc\") {\n            let {text, formulas} = editor.editorText.getOldCell();\n            editor.editorText.setOldCell({\n                text: '',\n                formulas: '',\n            });\n            let {ri, ci} = editor;\n            data.setSelectedCell(text, 'input', formulas, ri, ci);\n            editor.setText(\"\");\n            clearSelectors.call(this);\n            editor.clear(true);\n            // editor.setRiCi(-1, -1);\n            return;\n        }\n\n        if (state === \"format\") {\n            data.setSelectedCellAttr(state, \"rmb\");\n            // return;\n        }\n        // let {selector} = this;\n        // selector.el.hide();\n        //实时更新this.selectors\n        let {lock} = editor;\n        editor.setMouseDownIndex(data.rows, []);\n        editingSelectors.call(this, itext);\n\n        if (lock && itext !== '=') {\n            return;\n        }\n\n        // if (this.selectors.length > 0) {\n        //     return;\n        // }\n\n        if (state === \"format\") {\n            return;\n        }\n\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            data.addValidation(...args);\n        } else {\n            data.removeValidation();\n        }\n    };\n    // contextmenu\n    contextMenu.itemClick = (type) => {\n        // console.log('type:', type);\n        if (type === 'validation') {\n            modalValidation.setValue(data.getSelectedValidation());\n        } else if (type === 'copy') {\n            copy.call(this);\n        } else if (type === 'cut') {\n            cut.call(this);\n        } else if (type === 'paste') {\n            // paste.call(this, 'all');\n            // process.call(this, document.execCommand(\"sheetCopy\"));\n            // createEvent(1, false, \"paste\");\n            // console.log(  document.execCommand(\"paste\"));\n        } else if (type === 'paste-value') {\n            paste.call(this, 'text');\n        } else if (type === 'paste-format') {\n            paste.call(this, 'format');\n        } else {\n            insertDeleteRowColumn.call(this, type);\n        }\n    };\n\n\n    // let windows = this.el.el;\n    bind(window, 'resize', () => {\n        this.reload();\n    });\n\n    bind(window, 'click', (evt) => {\n        overlayerEl.contains(evt.target);\n        // this.focusing = overlayerEl.contains(evt.target);\n    });\n\n    bind(window, 'copy', (evt) => {\n        mountCopy.call(this, evt);\n        // data.history.add(data.getData());\n    });\n\n    bind(window, 'cut', (evt) => {\n        console.log(\"cut\", evt);\n        cut.call(this);\n        mountCopy.call(this, evt);\n        let {data} = this;\n        data.history.add(data.getData());\n    });\n\n    bind(window, 'paste', (evt) => {\n        pasteEvent.call(this, evt);\n    });\n\n    // for selector\n    bind(window, 'keydown', evt => {\n        // if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key, ctrlKey, shiftKey,   metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (getChooseImg.call(this)) {\n            console.log(keyCode);\n            switch (keyCode) {\n                case 8:         // delete\n                    data.history.addPic(data.getData().pictures, \"add\");\n                    deleteImg.call(this);\n                    break;\n                // case 90:         // delete\n                //     data.history.addPic(data.getData().pictures, \"add\");\n                //     deleteImg.call(this);\n                //     break;\n            }\n\n            if (ctrlKey || metaKey) {\n                if (90 === keyCode) {\n                    this.undo();\n                    evt.preventDefault();\n                }\n            }\n        } else if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            // let what = 'all';\n            // if (shiftKey) what = 'text';\n            // if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    //  加上这里是因为 需要展示虚线\n                    if (getChooseImg.call(this))\n                        return;\n                    copy.call(this);\n                    // table.render();\n                    // sheetReset.call(this);\n                    evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // paste.call(this, what, () => {\n                    //     console.log(\"837\")\n                    // });\n                    break;\n                case 37:\n                    // ctrl + left\n\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('font-bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('font-italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error = afterSelector.call(this, editor);\n                    if (error) {\n                        return;\n                    }\n\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 13: // enter\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error2 = afterSelector.call(this, editor);\n                    if (error2) {\n                        return;\n                    }\n                    editor.clear();\n                    renderAutoAdapt.call(this);\n                    autoRowResizer.call(this);\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    loadFormula.call(this);\n\n                    evt.preventDefault();\n                    editorSetOffset.call(this, true);\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    // evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                // dataSetCellText.call(this, evt.key, 'input');\n                // editorSet.call(this);\n                // editor.inputEventHandler();\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    });\n}\n\nexport {\n    sheetReset,\n    selectorSet,\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        const {view, showToolbar, showContextmenu, showEditor, rowWidth} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n\n        targetEl.children(this.toolbar.el, this.el);\n        this.pictureOffsetLeft = 10;\n        this.pictureOffsetTop = 10;\n\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n            data.cols.width,\n            data,\n            this,\n        );\n        this.stopTimer = new Timer();\n        this.stopTimer2 = new Timer();\n        this.website = new Website(data, this.editor);\n\n        // data validation\n        this.modalValidation = new ModalValidation();\n        this.errorPopUp = new ErrorPopUp();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);\n        // selector\n        this.selector = new Selector(data, this, true);\n        this.selectorMoveEl = new Selector(data, this, false);\n        // this.editorProxy = new EditorProxy();\n\n        this.advice = new Advice(data, this);\n        // this.pasteDirectionsArr = [];\n        // this.pasteOverlay = h('div', `${cssPrefix}-paste-overlay-container`).hide();\n\n        this.overlayerCEl = hasEditor.call(this, showEditor);\n        this.selectors = [];\n        this.container = h('div', '');\n        this.selectorsEl = h('div', `selector_clear`).attr(\"id\", \"selector_clear\");\n\n        // 把图片容器移到了 overlayerCEl 下面，原因是 如果在 overlayerEl下面 会遮挡表头\n        this.overlayerCEl.children(this.selectorsEl, this.container);\n\n        this.mergeSelector = false;\n\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        this.direction = false;   // 图片移动\n\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.rowResizer.el,\n            this.overlayerEl.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.errorPopUp.el,\n            this.sortFilter.el,\n            this.advice.el,\n            this.website.el,\n            this.website.tableEl,\n            // this.pasteOverlay.el,\n        );\n\n        // table\n        this.table = new Table(this.tableEl.el, data, this.editor);\n        sheetInitEvents.call(this);\n        sheetReset.call(this, false);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n\n        if (rowWidth && rowWidth.state) {\n            firstRowToWidth.call(this, rowWidth.width)\n        }\n    }\n\n    selectorMoveReset() {\n        editorSetOffset.call(this);\n        this.editor.setRiCi(this.data.selector.ri, this.data.selector.ci)\n        sheetReset.call(this);\n    }\n\n    getTable() {\n        let {table} = this;\n        return {\n            recalc: false,\n            table: table\n        }\n    }\n\n    clickCopyPaste() {\n        let {data} = this;\n        let args = data.clickCopyPaste();\n        if (args.enter) {\n            this.selector.arange = args.dstCellRange;\n            data.clickAutofill(args.srcCellRange, args.dstCellRange, \"all\", msg => xtoast('Tip', msg));\n            autofillNext.call(this);\n        }\n    }\n\n    setCellRange(reference, tableProxy, styleBool, cellRange) {\n        let {  data} = this;\n        data.paste(cellRange);\n        for (let i = 0; i < reference.length; i++) {\n            let {ri, ci} = reference[i];\n            let cell = deepCopy(tableProxy.rows.getCellOrNew(ri, ci));\n            if (styleBool === false) {\n                delete cell['style'];\n            }\n            selectorCellText.call(this, ri, ci, cell, 'style');\n            selectorSet.call(this, true, ri, ci, true, true);\n        }\n    }\n\n    selectorEditorReset(ri, ci) {\n        let {selector} = this;\n        editorSetOffset.call(this, true, ri, ci);\n        this.editor.setRiCi(ri, ci);\n        selector.hide();\n        sheetReset.call(this);\n    }\n\n    loadData(data) {\n        this.data.setData(data, this);\n        // 把所有后端计算的公式过滤出来\n        // this.editorProxy.associatedArr(this.data.rows);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo(this);\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    removeEvent() {\n        remove.call(this);\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n}\n\n","import { stringAt} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {isMinus} from \"../utils/number_util\";\nimport {Draw, DrawBox, npx, thinLineWidth,} from '../canvas/draw';\nimport {look} from \"../config\";\n// import {deepCopy, distinct} from \"../core/operator\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n// import Worker from 'worker-loader!../external/Worker2.js';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(rindex, cindex) {\n    const {data} = this;\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\n// function getAutoDrawBox(rindex, cindex, width) {\n//     const {data} = this;\n//     const {\n//         left, top, height\n//     } = data.cellRect(rindex, cindex);\n//     return new DrawBox(left, top, width, height, cellPaddingWidth);\n// }\n\n// function getCellTextStyle(rindex, cindex) {\n//     const {data} = this;\n//     const {sortedRowMap} = data;\n//     let nrindex = rindex;\n//     if (sortedRowMap.has(rindex)) {\n//         nrindex = sortedRowMap.get(rindex);\n//     }\n//\n//     return data.getCellStyleOrDefault(nrindex, cindex);\n// }\n\nexport function toUpperCase(text) {\n    text = text.toString().toUpperCase();\n\n    return text;\n}\n\nfunction getChangeDataToCalc() {\n    let {data} = this;\n    let changeData = data.changeDataForCalc;\n    if (!isHave(changeData)) {\n        return {\n            \"state\": false,\n            \"data\": null,\n        }\n    } else {\n        return {\n            \"state\": true,\n            \"data\": changeData\n        }\n    }\n}\n\nfunction parseCell() {\n    let {data} = this;\n\n    let changeDataArgs = getChangeDataToCalc.call(this);\n    try {\n        data.calc(data.rows, changeDataArgs.data);\n    } catch(e) {\n        console.error(\"公式模块报错：\" + e);\n    }\n\n    if (changeDataArgs.state) {\n        data.changeDataForCalc = null;\n    }\n}\n\n// export function parseCell2(viewRange, state = false, src = '') {\n//     let {data} = this;\n//     let {calc, rows} = data;\n//     let workbook = [];\n//     workbook.Sheets = {};\n//     workbook.Sheets[data.name] = {};\n//\n//     viewRange.each2((ri, ci) => {\n//         let cell = data.getCell(ri, ci);\n//         let expr = xy2expr(ci, ri);\n//         if (cell && cell.text) {\n//             cell.text = cell.text + \"\";\n//             if (cell.text.indexOf(\"MD.RTD\") !== -1) {\n//                 workbook.Sheets[data.name][expr] = {v: \"\", f: \"\"};\n//             } else {\n//                 if (cell.text && cell.text.lastIndexOf(\"=\") === 0) {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: '',\n//                         f: cell.text.replace(/ /g, '').replace(/\\\"/g, \"\\\"\").replace(/\\\"\\\"\\\"\\\"&/g, \"\\\"'\\\"&\")\n//                     };\n//                 } else {\n//                     workbook.Sheets[data.name][expr] = {\n//                         v: cell.text.replace(/ /g, '').toUpperCase().replace(/\\\"/g, \"\\\"\"),\n//                         f: ''\n//                     };\n//                 }\n//             }\n//         }\n//         else {\n//             workbook.Sheets[data.name][expr] = {v: 0, f: 0};\n//         }\n//     });\n//\n//\n//     if (state) {\n//         workbook.Sheets[data.name]['A1'] = {v: '', f: `${src}`};\n//     }\n//\n//     try {\n//         calc(workbook);\n//     } catch (e) {\n//         console.error(e);\n//     }\n//     return workbook;\n// }\n\nfunction specialStyle(text) {\n    text = text + \"\";\n    if (!text) {\n        return false;\n    }\n\n    return look.indexOf(text.split(\"!\")[0]) === 1;\n}\n\nfunction renderCell(rindex, cindex) {\n    const {draw, data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (!isHave(cell)) return;\n    // data.rows.setHeight(1, 50);\n\n    // console.log(rindex, nrindex, \"63\")\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox.call(this, rindex, cindex);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n\n    let cellText = \"\";\n\n    if (data.showEquation) {\n        if(isHave(cell.formulas)) {\n            cellText = cell.formulas;\n        }\n    } else if(isHave(cell.text)) {\n        cellText = cell.text;\n    }\n    draw.rect2(dbox, () => {\n        // render text\n        let args = data.renderFormat(style, cell, nrindex, cindex, false);\n        cellText = args.state ? args.cellText : cellText;\n        const font = Object.assign({}, style.font);\n\n        font.size = getFontSizePxByPt(font.size);\n        let {ignore, minus} = data.settings;\n        let color = style.color;\n        // console.log('style:', cellText);\n        if (minus === true && isMinus(cellText)) {\n            color = 'red'\n        }\n        let underline = style.underline;\n        let regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\n        cellText = cellText + \"\";\n        let text = cellText.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + cellText : cellText;\n        if (regex.test(text) || specialStyle(cell.text)) {\n            color = \"#4b89ff\";\n            underline = true;\n        }\n\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: color,\n            strike: style.strike,\n            underline: underline,\n            ignore: ignore,\n            cindex: cindex,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            draw.error(dbox);\n        }\n    });\n}\n\nfunction renderFlexible() {\n    const {draw, data} = this;\n    const {autoFilter} = data;\n    const {flex} = autoFilter;\n\n    for (let i = 0; i < flex.length; i++) {\n        let {ri, ci, state} = flex[i];\n        let s_t = 0;\n        for (let j = 0; j < i; j++) {\n            let {set_total, state} = flex[j];\n            if (state === true) {\n                s_t += set_total;\n            }\n        }\n\n        const dbox = getDrawBox.call(this, ri, ci);\n        draw.dropUp(dbox, state, s_t * 25);\n    }\n\n    // const dbox = getDrawBox.call(this, ri, ci);\n    // draw.dropUp(dbox);\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n\n        if (!autoFilter.active()) {\n            return;\n        }\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                const dbox = getDrawBox.call(this, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n    // renderFlexible.call(this, 1, 1)\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n    // 1 render cell\n    draw.save();\n\n    viewRange.each((ri, ci) => {\n        renderCell.call(this, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n    // 2 render cell border\n    // draw.save();\n    // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));\n    // draw.restore();\n\n    // / bboxes = [];\n    // 3 render mergeCell\n    const rset = new Set();\n    draw.save();\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell.call(this, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n\n    // 4 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    // 5 render flex\n    renderFlexible.call(this);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n                               sri, sci, eri, eci, w, h,\n                           }, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data, editor) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        // this.factory = new ApplicationFactory(data.methods, data.name, this);\n        this.editor = editor;\n        this.data = data;\n        this.timer = null;\n        // this.worker = new Worker();\n        this.autoAdaptList = [];\n    }\n\n\n    getCellTextContent(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const cell = data.getCell(nrindex, cindex);\n        if (cell === null) return;\n        // console.log(\"62\", cell.adapt);\n\n        return _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n    }\n\n    getDrawBox(rindex, cindex) {\n        const {data} = this;\n        const {\n            left, top, width, height,\n        } = data.cellRect(rindex, cindex);\n        return new DrawBox(left, top, width, height, cellPaddingWidth);\n    }\n\n    getCellTextStyle(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        return data.getCellStyleOrDefault(nrindex, cindex);\n    }\n\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        let viewRange = data.viewRange();\n\n        parseCell.call(this);\n        this.clear();\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        let fh = rows.height;\n\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n\n        renderFixedLeftTopCell.call(this, fw, fh);\n\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3x\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n        testValid.call(this);\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","import {tf} from '../locale/locale';\nimport {isHave, isNumber} from \"./helper\";\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v, fixed = 2) => {\n    if(!isHave(v) || !isNumber(v)) {\n        return v;\n    }\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = fixed === -1 ? v.toString() : Number(v).toFixed(fixed).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        let value = first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1');\n        return value === 'NaN' ? v : value;\n    }\n\n    return v === 'NaN' ? v : v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'text',\n    //     title: tf('format.text'),\n    //     type: 'string',\n    //     render: formatStringRender,\n    // },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: (v) => {\n            const a = multiply(v, 100);\n            const a_s = `${a}`;\n            return `${a_s}%`;\n        },\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '￥10.00',\n        render: v => `￥${formatNumberRender(v)}`,\n    },\n    // {\n    //     key: 'usd',\n    //     title: tf('format.usd'),\n    //     type: 'number',\n    //     label: '$10.00',\n    //     render: v => `$${formatNumberRender(v)}`,\n    // },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '2009-01-01',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'datetime',\n        label: '2009年01月01日',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'time',\n    //     title: tf('format.time'),\n    //     type: 'date',\n    //     label: '15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'datetime',\n    //     title: tf('format.datetime'),\n    //     type: 'date',\n    //     label: '26/09/2008 15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'duration',\n    //     title: tf('format.duration'),\n    //     type: 'date',\n    //     label: '24:01:00',\n    //     render: formatStringRender,\n    // },\n];\n\nfunction isInteger(obj) {\n    return Math.floor(obj) === obj;\n}\n\n\n// function add(a, b, digits) {\n//     return operation(a, b, digits, 'add');\n// }\n//\n// function subtract(a, b, digits) {\n//     return operation(a, b, digits, 'subtract');\n// }\n\nexport function multiply(a, b, digits) {\n    return operation(a, b, digits, 'multiply');\n}\n\nfunction divide(a, b, digits) {\n    return operation(a, b, digits, 'divide');\n}\n\n/*\n * 将一个浮点数转成整数，返回整数和倍数。如 3.14 >> 314，倍数是 100\n * @param floatNum {number} 小数\n * @return {object}\n *   {times:100, num: 314}\n */\nfunction toInteger(floatNum) {\n    const ret = {times: 1, num: 0};\n    const isNegative = floatNum < 0;\n    if (isInteger(floatNum)) {\n        ret.num = floatNum;\n        return ret;\n    }\n    const strfi = `${floatNum}`;\n    const dotPos = strfi.indexOf('.');\n    const len = strfi.substr(dotPos + 1).length;\n    const times = Math.pow(10, len);\n    let intNum = parseInt(Math.abs(floatNum) * times + 0.5, 10);\n    ret.times = times;\n    if (isNegative) {\n        intNum = -intNum;\n    }\n    ret.num = intNum;\n    return ret;\n}\n\nfunction operation(a, b, digits, op) {\n    const o1 = toInteger(a);\n    const o2 = toInteger(b);\n    const n1 = o1.num;\n    const n2 = o2.num;\n    const t1 = o1.times;\n    const t2 = o2.times;\n    const max = t1 > t2 ? t1 : t2;\n    let result = null;\n    switch (op) {\n        case 'add':\n            if (t1 === t2) { // 两个小数位数相同\n                result = n1 + n2;\n            } else if (t1 > t2) { // o1 小数位 大于 o2\n                result = n1 + n2 * (t1 / t2);\n            } else { // o1 小数位 小于 o2\n                result = n1 * (t2 / t1) + n2;\n            }\n            return result / max;\n        case 'subtract':\n            if (t1 === t2) {\n                result = n1 - n2;\n            } else if (t1 > t2) {\n                result = n1 - n2 * (t1 / t2);\n            } else {\n                result = n1 * (t2 / t1) - n2;\n            }\n            return result / max;\n        case 'multiply':\n            result = (n1 * n2) / (t1 * t2);\n            return result;\n        case 'divide':\n            result = (n1 / n2) * (t2 / t1);\n            return result;\n    }\n}\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport {\n    formatm,\n    baseFormats,\n    formatNumberRender\n};\n","import {Element} from './element';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nexport default class Button extends Element {\n    // type: primary\n    constructor(title, type = '') {\n        super('div', `${cssPrefix}-button ${type}`);\n        this.child(t(`button.${title}`));\n    }\n}\n","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","const RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\n\nmodule.exports = function str_2_val(buffer, formula, position_i) { // buffer 在这里是但一个字符串表达式\n    var v;\n    if (!isNaN(buffer)) {\n        v = new RawValue(+buffer);\n    }\n    else if (buffer === 'TRUE') {\n        v = new RawValue(1);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n    }\n    else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n        v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n    }\n    else {\n        v = buffer;\n        v.end_pst = position_i // 后面一个字符的位置\n    }\n    return v;\n};\n","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        var resolved_ref = self.parseRef();\n        var sheet = resolved_ref.sheet;\n        var cell_name = resolved_ref.cell_name;\n        var cell_full_name = resolved_ref.cell_full_name;\n        var ref_cell = sheet[cell_name];\n        if (!ref_cell) {\n            return null;\n        }\n        var formula_ref = formula.formula_ref[cell_full_name];\n        if (formula_ref) {\n            if (formula_ref.status === 'new') {\n                formula.exec_formula(formula_ref);\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error with new formula', cell_full_name);\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n            else if (formula_ref.status === 'working') {\n                throw new Error('Circular ref');\n            }\n            else if (formula_ref.status === 'done') {\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error after formula eval');\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n        }\n        else {\n            if (ref_cell.t === 'e') {\n                console.log('ref is an error with no formula', cell_name);\n                throw new Error(ref_cell.w);\n            }\n            return ref_cell.v;\n        }\n    };\n};\n","var categories = [\n  require('./lib/compatibility'),\n  require('./lib/database'),\n  require('./lib/engineering'),\n  require('./lib/logical'),\n  require('./lib/math-trig'),\n  require('./lib/text'),\n  require('./lib/date-time'),\n  require('./lib/financial'),\n  require('./lib/information'),\n  require('./lib/lookup-reference'),\n  require('./lib/statistical'),\n  require('./lib/miscellaneous'),\n  require('./lib/custom')\n];\n\nfor (var c in categories) {\n  var category = categories[c];\n  for (var f in category) {\n    exports[f] = exports[f] || category[f];\n  }\n}\n","var utils   = require('./utils');\nvar numeral = require('numeral');\n\nexports.UNIQUE = function () {\n  var result = [];\n  for (var i = 0; i < arguments.length; ++i) {\n    var hasElement = false;\n    var element    = arguments[i];\n\n    // Check if we've already seen this element.\n    for (var j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element;\n      if (hasElement) { break; }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\nexports.FLATTEN = utils.flatten;\n\nexports.ARGS2ARRAY = function () {\n  return Array.prototype.slice.call(arguments, 0);\n};\n\nexports.REFERENCE = function (context, reference) {\n  try {\n    var path = reference.split('.');\n    var result = context;\n    for (var i = 0; i < path.length; ++i) {\n      var step = path[i];\n      if (step[step.length - 1] === ']') {\n        var opening = step.indexOf('[');\n        var index = step.substring(opening + 1, step.length - 1);\n        result = result[step.substring(0, opening)][index];\n      } else {\n        result = result[step];\n      }\n    }\n    return result;\n  } catch (error) {}\n};\n\nexports.JOIN = function (array, separator) {\n  return array.join(separator);\n};\n\nexports.NUMBERS = function () {\n  var possibleNumbers = utils.flatten(arguments);\n  return possibleNumbers.filter(function (el) {\n    return typeof el === 'number';\n  });\n};\n\nexports.NUMERAL = function (number, format) {\n  return numeral(number).format(format);\n};","var error = require('./error');\nvar jStat = require('jStat').jStat;\nvar text = require('./text');\nvar utils = require('./utils');\nvar bessel = require('bessel');\n\nfunction isValidBinaryNumber(number) {\n  return (/^[01]{1,10}$/).test(number);\n}\n\nexports.BESSELI = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besseli(x, n);\n};\n\nexports.BESSELJ = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselj(x, n);\n};\n\nexports.BESSELK = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselk(x, n);\n};\n\nexports.BESSELY = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.bessely(x, n);\n};\n\nexports.BIN2DEC = function(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Convert binary number to decimal\n  var result = parseInt(number, 2);\n\n  // Handle negative numbers\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512;\n  } else {\n    return result;\n  }\n};\n\n\nexports.BIN2HEX = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n  }\n\n  // Convert binary number to hexadecimal\n  var result = parseInt(number, 2).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BIN2OCT = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n  }\n\n  // Convert binary number to octal\n  var result = parseInt(number, 2).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BITAND = function(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2;\n};\n\nexports.BITLSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return (shift >= 0) ? number << shift : number >> -shift;\n};\n\nexports.BITOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2;\n};\n\nexports.BITRSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return (shift >= 0) ? number >> shift : number << -shift;\n};\n\nexports.BITXOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2;\n};\n\nexports.COMPLEX = function(real, imaginary, suffix) {\n  real = utils.parseNumber(real);\n  imaginary = utils.parseNumber(imaginary);\n  //XW: 参数报错\n  if (utils.anyIsError(real, imaginary)) {\n    return error.value;\n  }\n  //XW：end\n\n  // Set suffix\n  suffix = (suffix === undefined) ? 'i' : suffix;\n  suffix = suffix.toLowerCase();\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value;\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0;\n  } else if (real === 0) {\n    return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\n  } else if (imaginary === 0) {\n    return real.toString();\n  } else {\n    var sign = (imaginary > 0) ? '+' : '';\n    return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\n  }\n};\n\nexports.CONVERT = function(number, from_unit, to_unit) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  var units = [\n    [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\n    [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\n    [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\n    [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\n    [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\n    [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\n    [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\n    [\"ångström\", \"Å\", [\"ang\"], \"length\", false, true, 1e-10],\n    [\"are\", \"ar\", null, \"area\", false, true, 100],\n    [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\n    [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\n    [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\n    [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\n    [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\n    [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\n    [\"byte\", \"byte\", null, \"information\", false, true, 8],\n    [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\n    [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\n    [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\n    [\"cubic ångström\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\n    [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\n    [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\n    [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\n    [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\n    [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\n    [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\n    [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\n    [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\n    [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\n    [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\n    [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\n    [\"degree\", \"°\", null, \"angle\", false, false, 0.0174532925199433],\n    [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\n    [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\n    [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\n    [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\n    [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\n    [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\n    [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\n    [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\n    [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\n    [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\n    [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\n    [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\n    [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\n    [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\n    [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\n    [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\n    [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\n    [\"henry\", \"H\", null, \"inductance\", true, false, 1],\n    [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\n    [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\n    [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\n    [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\n    [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\n    [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\n    [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\n    [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\n    [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\n    [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\n    [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\n    [\"joule\", \"J\", null, \"energy\", true, true, 1],\n    [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\n    [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\n    [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\n    [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\n    [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\n    [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\n    [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\n    [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\n    [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\n    [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\n    [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\n    [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\n    [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\n    [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\n    [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\n    [\"metre\", \"m\", null, \"length\", true, true, 1],\n    [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\n    [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\n    [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\n    [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\n    [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\n    [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\n    [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\n    [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\n    [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\n    [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1],\n    [\"newton\", \"N\", null, \"force\", true, true, 1],\n    [\"œrsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\n    [\"ohm\", \"Ω\", null, \"electric_resistance\", true, false, 1],\n    [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\n    [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\n    [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\n    [\"pferdestärke\", \"PS\", null, \"power\", false, true, 735.49875],\n    [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\n    [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\n    [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\n    [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\n    [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\n    [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\n    [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\n    [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\n    [\"radian\", \"rad\", null, \"angle\", true, false, 1],\n    [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\n    [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\n    [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\n    [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\n    [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\n    [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\n    [\"square ångström\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\n    [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\n    [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\n    [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\n    [\"square meter\", \"m?\", null, \"area\", true, true, 1],\n    [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\n    [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\n    [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\n    [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\n    [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\n    [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\n    [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\n    [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\n    [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\n    [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\n    [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\n    [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\n    [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\n    [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\n    [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\n    [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\n    [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\n    [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\n    [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\n    [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\n    [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\n    [\"volt\", \"V\", null, \"voltage\", true, false, 1],\n    [\"watt\", \"W\", null, \"power\", true, true, 1],\n    [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\n    [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\n    [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\n    [\"year\", \"yr\", null, \"time\", false, true, 31557600]\n  ];\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  var binary_prefixes = {\n    Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n    Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n    Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n    Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n    Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n    Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n    Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n    ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n  };\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  var unit_prefixes = {\n    Y: [\"yotta\", 1e+24, \"Y\"],\n    Z: [\"zetta\", 1e+21, \"Z\"],\n    E: [\"exa\", 1e+18, \"E\"],\n    P: [\"peta\", 1e+15, \"P\"],\n    T: [\"tera\", 1e+12, \"T\"],\n    G: [\"giga\", 1e+09, \"G\"],\n    M: [\"mega\", 1e+06, \"M\"],\n    k: [\"kilo\", 1e+03, \"k\"],\n    h: [\"hecto\", 1e+02, \"h\"],\n    e: [\"dekao\", 1e+01, \"e\"],\n    d: [\"deci\", 1e-01, \"d\"],\n    c: [\"centi\", 1e-02, \"c\"],\n    m: [\"milli\", 1e-03, \"m\"],\n    u: [\"micro\", 1e-06, \"u\"],\n    n: [\"nano\", 1e-09, \"n\"],\n    p: [\"pico\", 1e-12, \"p\"],\n    f: [\"femto\", 1e-15, \"f\"],\n    a: [\"atto\", 1e-18, \"a\"],\n    z: [\"zepto\", 1e-21, \"z\"],\n    y: [\"yocto\", 1e-24, \"y\"]\n  };\n\n  // Initialize units and multipliers\n  var from = null;\n  var to = null;\n  var base_from_unit = from_unit.toLowerCase();\n  var base_to_unit = to_unit.toLowerCase();\n  var from_multiplier = 1;\n  var to_multiplier = 1;\n  var alt;\n  // Lookup from and to units\n  for (var i = 0; i < units.length; i++) {\n    alt = (units[i][2] === null) ? [] : units[i][2];\n    if (units[i][1].toLowerCase() === base_from_unit || alt.indexOf(from_unit) >= 0) {\n      from = units[i];\n    }\n    if (units[i][1].toLowerCase() === base_to_unit || alt.indexOf(to_unit) >= 0) {\n      to = units[i];\n    }\n  }\n  // Lookup from prefix\n  if (from === null) {\n    var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n    var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2];\n      base_from_unit = from_unit.substring(2);\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1];\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n    }\n\n    // Lookup from unit\n    for (var j = 0; j < units.length; j++) {\n      alt = (units[j][2] === null) ? [] : units[j][2];\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j];\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n    var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2];\n      base_to_unit = to_unit.substring(2);\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1];\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n    }\n\n    // Lookup to unit\n    for (var k = 0; k < units.length; k++) {\n      alt = (units[k][2] === null) ? [] : units[k][2];\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k];\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na;\n  }\n\n  //Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    if(from_unit == 'F' && to_unit == 'C'){\n      return (number-32)/1.8\n    }\n    if(from_unit == 'C' && to_unit == 'F'){\n      return number * 1.8 + 32\n    }\n    return error.na;\n  }\n\n  // Return converted number\n  return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n};\n\nexports.DEC2BIN = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = parseInt(number, 10).toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2HEX = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = parseInt(number, 10).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2OCT = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = parseInt(number, 10).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DELTA = function(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = (number2 === undefined) ? 0 : number2;\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return delta\n  return (number1 === number2) ? 1 : 0;\n};\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexports.ERF = function(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = (upper_bound === undefined) ? 0 : upper_bound;\n\n  lower_bound = utils.parseNumber(lower_bound);\n  upper_bound = utils.parseNumber(upper_bound);\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value;\n  }\n\n  return jStat.erf(lower_bound);\n};\n\n// TODO\nexports.ERF.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERF(x)\n};\n\nexports.ERFC = function(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value;\n  }\n\n  return jStat.erfc(x);\n};\n\n// TODO\nexports.ERFC.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERFC(x)\n};\n\nexports.GESTEP = function(number, step) {\n  step = step || 0;\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(step, number)) {\n    return number;\n  }\n\n  // Return delta\n  return (number >= step) ? 1 : 0;\n};\n\nexports.HEX2BIN = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\n\n  // Convert hexadecimal number to decimal\n  var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.HEX2DEC = function(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return decimal number\n  return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\n};\n\nexports.HEX2OCT = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = decimal.toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\nexports.ROWS = function (matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\nfunction trans_num(inumber){\n  inumber = inumber.toString()\n  inumber = inumber.replace('I', 'i').replace('J', 'j')\n  return inumber\n}\nexports.IMABS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n};\n\nexports.IMAGINARY = function (inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1;\n  }\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(plus + 1, inumber.length - 1));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        -Number(inumber.substring(minus + 1, inumber.length - 1));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\n    } else {\n      return (isNaN(inumber)) ? error.num : 0;\n    }\n  }\n};\n\nexports.IMARGUMENT = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0;\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2;\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI;\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x);\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI;\n  } else {\n    return Math.atan(y / x) - Math.PI;\n  }\n};\n\nexports.IMCONJUGATE = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return conjugate of complex number\n  return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\n};\n\nexports.IMCOS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return cosine of complex number\n  return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMCOSH = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic cosine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n};\n\nexports.IMCOT = function (inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return cotangent of complex number\n  return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n};\n\nexports.IMDIV = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num;\n  }\n\n  // Return exponential of complex number\n  var den = c * c + d * d;\n  return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n};\n\nexports.IMEXP = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  var e = Math.exp(x);\n  return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n};\n\nexports.IMLN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n};\n\nexports.IMLOG10 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n};\n\nexports.IMLOG2 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n};\n\nexports.IMPOWER = function(inumber, number) {\n  inumber = trans_num(inumber)\n  number = utils.parseNumber(number);\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n  if (utils.anyIsError(number, x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var p = Math.pow(exports.IMABS(inumber), number);\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n};\n\nexports.IMPRODUCT = function() {\n  // Initialize result\n  var result = arguments[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(arguments[i]);\n    var d = exports.IMAGINARY(arguments[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n  }\n\n  // Return product of complex numbers\n  return result;\n};\n\nexports.IMREAL = function(inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0;\n  }\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, plus));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, minus));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\n    } else {\n      return (isNaN(inumber)) ? error.num : inumber;\n    }\n  }\n};\n\nexports.IMSEC = function(inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return secant of complex number\n  return exports.IMDIV('1', exports.IMCOS(inumber));\n};\n\nexports.IMSECH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return hyperbolic secant of complex number\n  return exports.IMDIV('1', exports.IMCOSH(inumber));\n};\n\nexports.IMSIN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return sine of complex number\n  return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMSINH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic sine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n};\n\nexports.IMSQRT = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var s = Math.sqrt(exports.IMABS(inumber));\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n};\n\nexports.IMCSC = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return cosecant of complex number\n  return exports.IMDIV('1', exports.IMSIN(inumber));\n};\n\nexports.IMCSCH = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return exports.IMDIV('1', exports.IMSINH(inumber));\n};\n\nexports.IMSUB = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber1 = trans_num(inumber1)\n  inumber2 = trans_num(inumber2)\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return _ of two complex numbers\n  return exports.COMPLEX(a - c, b - d, unit);\n};\n\nexports.IMSUM = function (inumber) {\n  inumber = trans_num(inumber)\n  var args = utils.flatten(arguments);\n\n  // Initialize result\n  var result = args[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(args[i]);\n    var d = exports.IMAGINARY(args[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a + c, b + d);\n  }\n\n  // Return sum of complex numbers\n  return result;\n};\n\nexports.IMTAN = function (inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return tangent of complex number\n  return exports.IMDIV(exports.IMSIN(inumber), exports.IMCOS(inumber));\n};\n\nexports.OCT2BIN = function (number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\n\n  // Convert octal number to decimal\n  var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\n\n  // Return error if number is lower than -512 or greater than 511\n  // if (decimal < -512 || decimal > 511) {\n  //     return error.num;\n  // }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n  if (result.length >=10){\n    return result.slice(result.length-10, result.length)\n  }\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.OCT2DEC = function(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Return decimal number\n  return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\n};\n\nexports.OCT2HEX = function(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = decimal.toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};","\"use strict\";\nmodule.exports = function find_all_need_calc_cell(wb, tileArr, exec_formula) {\n    var need_calc_cells = tileArr.findAllNeedCalcCell()\n    let formula_ref = {};\n    let cells = [];\n    for (let sheet_name in wb.Sheets) {\n        let sheet = wb.Sheets[sheet_name];\n        for(let i=0; i<need_calc_cells.length; i++){\n            let cell_name = need_calc_cells[i]\n            let formula = formula_ref[sheet_name + '!' + cell_name] = {\n                formula_ref: formula_ref,\n                wb: wb,\n                sheet: sheet,\n                sheet_name: sheet_name,\n                cell: sheet[cell_name],\n                name: cell_name,\n                status: 'new',\n                exec_formula: exec_formula\n            };\n            cells.push(formula);\n        }\n    }\n    return cells;\n};\n","var helper = require(\"../core/helper\")\n//XW: end\n//XW:大括号参数判断,有大括号参数用''包起来作为一个参数\nexports.trans_params = function (cell) {\n  var reg = new RegExp('\\{(.*?)\\}', 'g')\n  var arg = cell.f.match(reg)\n  if (arg != null){\n    for (var i=0; i<arg.length; i++){\n      var param = arg[i]\n      var rep = \"'\" + param + \"'\"\n      cell.f = cell.f.replace(param, rep)\n    }\n  }\n  return cell\n}\n//XW:end\n//XW: 将空单元格置为default_0\nexports.trans_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 0 && sheet[i].f === \"\"){\n      sheet[i].v = 'default_0'\n    }\n  });\n  return sheet\n}\n\nexports.recover_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 'default_0'){\n      if (!helper.isHave(sheet[i].f)) {\n        sheet[i].f = \"\"\n      }\n      sheet[i].v = 0\n    }\n  });\n  return sheet\n}\n//XW: end\n//XW: 去除公式开头结尾的空格\nexports.strim = function (str){\n  let str1 = str.replace(/\\s+$/,'');\n  let str2 = str1.replace(/^\\s+/,'')\n  return str2;\n}\n//XW： end\n\n//xW: 公式参数转换\nexports.trans_formula = function(f){\n  //特殊公式转换 FLOOR->FLOORMATH, vap-> vara等\n  var trans_dict = {\n    'FLOOR': 'FLOORMATH',\n    'VAR': 'VARA',\n    'WORKDAY.INTL': 'WORKDAYINTL'\n  }\n  for(var i in trans_dict){\n    var b = trans_dict[i]\n    if (f.indexOf(b) < 0 && f.indexOf(i)>=0 && f.indexOf(i + '.') <=0){\n      f = f.replace(i, b)\n    }\n  }\n  //_XLFN. 开头的函数去掉开头\n  f = f.replace('_XLFN.', '')\n  //将函数公式中除\"\"中的其他部分转成大写\n  var reg = new RegExp('\"(.*?)\"', 'g')\n  var arg = f.match(reg)\n  if (f.indexOf('=') === 0){\n    f = f.toUpperCase()\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i].toUpperCase()\n        if(f.indexOf(param) >= 0){\n          f = f.replace(param, arg[i])\n        }\n      }\n    }\n  }\n  return f\n}\n//xW:end\n","const recast = require(\"recast\");\n\nconst colon = \"$$$\";\nconst fqm = '';\nconst exclamationPoint = \"\";\nconst braceLeft = \"\";\nconst braceRight = \"\";\n\nexport default class Recast {\n    constructor(formula) {\n        this.formula = formula;\n        this.ast = \"\";\n    }\n    preProcess() {\n        this.formula = this.formula.replace(/=/g, '');\n        this.formula = this.formula.replace(/:/g, colon);\n        this.formula = this.formula.replace(/\"\"\"\"/g, fqm);\n        this.formula = this.formula.replace(/!/g, exclamationPoint);\n        this.formula = this.formula.replace(/{/g, braceLeft);\n        this.formula = this.formula.replace(/}/g, braceRight);\n        this.formula = this.formula.replace(/#/g, '');\n        this.formula = this.formula.replace(/\\./g, 'a');\n        this.formula = this.formula.replace(/[0-9][0-9]*/g, 'a');\n        this.formula = this.formula.replace(/\\“/g, '\"');\n        this.formula = this.formula.replace(/\\（/g, '(');\n        this.formula = this.formula.replace(/\\）/g, ')');\n        this.formula = this.formula.replace(/\\”/g, '\"');\n        this.formula = this.formula.replace(/\\%/g, '');\n        this.formula = this.formula.replace(/\\,/g, '');\n        this.formula = this.formula.replace(/\\，/g, '');\n        // this.formula = this.formula.replace(/\"([\\s\\S]{1,})\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"([\\s\\S]+)\"\"\"/g, '');\n        this.formula = this.formula.replace(/\"\"/, \"\")\n    }\n\n    parse() {\n        this.preProcess();\n        let {formula} = this;\n        this.ast = recast.parse(formula);\n    }\n\n    ignoreSpace() {\n\n    }\n}","import {isHave} from \"./helper\";\nimport {isFormula} from \"./row\";\nimport {datePattern2, str2Re} from \"../utils/reg_pattern\";\n\nexport default class CellProxy {\n    constructor(cell) {\n        this.cell = cell;\n    }\n\n    renderFormat(style, nrindex, cindex, data, filter) {\n        if(isHave(style) === false || isHave(style.format) === false) {\n            return {\n                \"cellText\": \"\",\n                \"state\": false,\n            };\n        }\n\n        let {cell} = this;\n        let cellText = \"\";\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            let formatInfo = data.tryParseToNum(cell, nrindex, cindex);\n            if(formatInfo.state) {\n                if(filter) {\n                    if((formatInfo.style === 'date' || formatInfo.style === 'datetime')) {\n                        cellText = formatInfo.text;\n                    } else {\n                        formatInfo.state = false;\n                    }\n                }  else {\n                    cellText = formatInfo.text;\n                }\n            } else {\n                if( isHave(cell.text) === false) {\n                    cell.text = \"\";\n                }\n                cellText = cell.text;\n            }\n            return {\n                \"cellText\": cellText,\n                \"state\": formatInfo.state,\n            };\n        }\n        return {\n            \"cellText\": cellText,\n            \"state\": false,\n        };\n    }\n\n    getCellDataType(sarr, {isDate, isNumber}) {\n        let ncell = this.cell;\n        // let enter = false;\n        let nA = true;\n\n\n        if (!isHave(ncell.formulas)) {\n            ncell.formulas = \"\";\n        }\n        if (!isHave(ncell.text)) {\n            ncell.text = \"\";\n        }\n\n        let value = ncell.formulas !== \"\" ? ncell.formulas + \"\" : ncell.text + \"\";\n        // value = value.replace(/,/g, \"\").replace(\"=\", \"\");\n        value = value.replace(/,/g, \"\");        // =123 不要把=扔掉\n        let ns = value * 1;\n\n        if ((ns || ns === 0) && typeof ns === 'number' && !isNaN(ns) && /^\\d+$/.test(value) === true) {\n            if(isNumber === true) {\n                isNumber = true;\n                nA = false;\n                isDate = false;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'number';\n        } else if (value && nA === true && isFormula(value)) {\n            nA = true;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'na';\n        } else if (value && value.search(str2Re(datePattern2), '') !== -1) {\n            if( isDate === true) { // jobs: todo: 正则表达式应该集中管理。而且这个正则表达式太复杂了，应该能简化。\n                nA = false;\n                isNumber = false;\n                isDate = true;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'date';\n        } else {//\n            nA = false;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'other';\n        }\n        ncell.tmp = value;\n        sarr.push(ncell);\n\n        return {\n            nA, isDate: isDate, isNumber: isNumber\n        }\n    }\n}\n","export default class Moved {\n    constructor() {\n        this.range = null;\n        this.state = 'move';\n    }\n\n    move(cellRange) {\n        this.range = cellRange;\n        this.state = 'move';\n\n        return this;\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {xy2expr} from \"../core/alphabet\";\nimport {deepCopy} from '../core/operator';\nimport SelectorCell from \"./selector_cell\";\nimport CellProp from \"../model/cell_prop\";\n\nexport const selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n\n                } else {\n                    this.moveEvent(1);\n                }\n\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(2);\n                }\n            }).on('click', (evt) => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                }\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    evt.stopPropagation();\n                }\n                this.moveEvent(3);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(4);\n                }\n            });\n\n\n        this.cornerEl.on('mousedown', evt => {\n            let {detail} = evt;\n            if (detail === 2) {\n                sheet.clickCopyPaste();\n                evt.stopPropagation();\n            }\n        });\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .children(this.cornerEl, this.boxinner).hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    border(value) {\n        this.areaEl.css('border', value);\n    }\n\n    longTimeBefore(time = 500) {\n        this.boxinner.hide();\n\n        setTimeout(() => {\n            this.boxinner.show();\n        }, time);\n    }\n\n    moveEvent(direction) {\n        console.log(60);\n        let {data, _selector, sheet,} = this;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = _selector.range;\n        let _cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let {selectorMoveEl} = sheet;\n        selectorMoveEl.set(-1, -1, true);\n        selectorMoveEl.hide();\n\n        mouseMoveUp(window, (e) => {\n            sheet.container.css('pointer-events', 'none');\n            _selector.setBoxinner(\"none\");\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                cellRange.move(ri, ci);\n                //     if(direction == 4) {\n                //         cellRange = new CellRange(eri, eci, eri, eci, w, h);\n                //     } else if(direction == 2) {\n                //         cellRange = new CellRange(sri, eci, eri, eci, w, h);\n                //     } else if(direction == 1) {\n                //         cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                // }\n\n                const rect = data.getMoveRect(cellRange);\n                selectorMoveEl.range = cellRange;\n                selectorMoveEl.setMove(rect);\n                selectorMoveEl.el.show();\n            }\n        }, () => {\n            // 如果移动的内容被单元格包含，则需要变化\n            let {rows} = data;\n            let arr = [], arr2 = [], arr3 = [];\n\n            _cellRange.each((i, j) => {\n                console.log(rows.getCell(i, j), i, j);\n                let cell = rows.getCell(i, j);\n                let movedCell = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}:${xy2expr(j, i)}`);\n                let movedCell2 = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}`);\n                arr.push(movedCell);\n                arr3.push(movedCell2);\n            });\n            cellRange.each((i, j) => {\n                let movedCell = new CellProp(i, j, deepCopy(rows.getCell(i, j) || {}), xy2expr(j, i));\n                arr2.push(movedCell);\n            });\n\n            data.cutPaste(_cellRange, cellRange, false);\n            sheet.container.css('pointer-events', 'auto');\n            _selector.setBoxinner(\"auto\");\n            selectorMoveEl.hide();\n\n            const rect = data.getMoveRect(cellRange);\n            selector.range = cellRange;\n            selector.ci = cellRange.sci;\n            selector.ri = cellRange.sri;\n\n            _selector.indexes = [selector.ri, selector.ci];\n            _selector.moveIndexes = [cellRange.sri, cellRange.sci];\n            _selector.range = cellRange;\n            _selector.setMove(rect);\n\n            sheet.selector.selectCell.setData(cellRange.sri, cellRange.sci);\n            // sheet.selectorMoveReset();\n\n            // 多个单元格\n            // if (_cellRange.eri != _cellRange.sri || _cellRange.eci != _cellRange.sci) {\n            //     let erpxArr = [];\n            //     let erpxArr2 = [];\n            //     let erpxArr3 = [];\n            //     for (let i = _cellRange.sci; i <= _cellRange.eci; i++) {\n            //         for (let j = _cellRange.sri; j <= _cellRange.eri; j++) {\n            //             erpxArr.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr.length; i++) {\n            //         for (let j = 0; j < erpxArr.length; j++) {\n            //             if (i <= j) {\n            //                 erpxArr2.push([i, j])\n            //             }\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr[a];\n            //         let a1 = erpxArr[b];\n            //         arr.push(`${a2}:${a1}`);\n            //         arr3.push(`${a2}:${a1}`);\n            //     }\n            //\n            //     for (let i = cellRange.sci; i <= cellRange.eci; i++) {\n            //         for (let j = cellRange.sri; j <= cellRange.eri; j++) {\n            //             erpxArr3.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr3[a];\n            //         let a1 = erpxArr3[b];\n            //\n            //         arr2.push(`${a2}:${a1}`);\n            //     }\n            //\n\n            // let {worker} = this;\n            // worker.terminate();\n            // worker = new Worker();\n            // worker.postMessage({ arr: arr, arr2: arr2, arr3: arr3, rows: rows });\n            //\n            // worker.onmessage = function (event) {\n            // };\n            //\n            // worker.addEventListener(\"message\", function (event) {\n            //     rows._ = event.data.rrows;\n            //     sheet.editor.display = true;\n            //     rows.moveChange(arr, arr2, arr3);\n            //     sheet.selectorMoveReset();\n            // });\n            console.time(\"move\");\n            rows.moveChange(arr, arr2, arr3);\n            console.timeEnd(\"move\");\n\n            sheet.selectorMoveReset();\n        });\n    }\n\n    setCss(b) {\n        this.areaEl.css('border', `2px dashed ${b}`);\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n\n        this.cornerEl.css(\"pointer-events\", pointer);\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n    constructor(data, sheet, sc = false) {\n        this.data = data;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.sheet = sheet;\n\n        // this.selectT = new SelectorElement(data, this, sheet);\n        // this.selectL = new SelectorElement(data, this, sheet);\n        // this.selectTl = new SelectorElement(data, this, sheet);\n\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        if (sc) {\n            this.selectCell = new SelectorCell(data, sc);\n            this.el.child(this.selectCell.el);\n        } else {\n            this.selectCell = new SelectorCell(data, sc);\n        }\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n\n    longTimeBefore() {\n        this.tl.longTimeBefore();\n        this.br.longTimeBefore();\n        this.t.longTimeBefore();\n        this.l.longTimeBefore();\n    }\n\n    setCss(b) {\n        this.br.setCss(b);\n        this.t.setCss(b);\n        this.l.setCss(b);\n        this.tl.setCss(b);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n\n        this.selectCell.resetSelectOffset();\n\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n\n\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        // this.resetSelectOffset(cellRange);\n\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    autoFilterRef() {\n        console.log(this.range);\n    }\n\n    setEnd(ri, ci, moving = true, enter = false) {\n        const {data } = this;\n        if (moving) {\n            // if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci, sci, sri} = this.data.selector.range;\n        // 原因是 从右下角往左上角选中，然后ctrl + c 会有bug  加下面一行的原因\n        this.set(sri, sci);\n\n        this.setEnd(eri, eci, true, true);\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    //\n    showAutofill(ri, ci, pos) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n\n        // pos == 1 往下，pos == 3 往右， pos == 2 往左， pos == 4 往上\n        let drisc = 0;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        // const srn = sri - ri;\n        // const scn = sci - ci;\n        // const ern = eri - ri;\n        // const ecn = eci - ci;\n        // console.log(srn, scn, ern, ecn, ri, ci);\n        if (pos === 2) {\n            drisc = 11;\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // console.log(this.arange);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (pos === 4) {\n            drisc = 22;\n\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (pos === 3) {\n            drisc = 33;\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (pos === 1) {\n            drisc = 44;\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return drisc;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n        return drisc;\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {bind, bindClickoutside, createEvent, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport CellRange from \"../core/cell_range\";\n\nfunction inputMovePrev(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex -= 1;\n    if (this.itemIndex < 0) {\n        this.itemIndex = filterItems.length - 1;\n        this.el.el.scrollTop = this.el.el.scrollHeight;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0 || filterItems.length < this.itemIndex) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex += 1;\n    if (this.itemIndex > filterItems.length - 1) {\n        this.itemIndex = 0;\n        this.el.el.scrollTop = 0;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n    console.log(filterItems.length);\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n    evt.preventDefault();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    evt.stopPropagation();\n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n        this.hide();\n             createEvent.call(this, 13, false);\n\n        return\n    }\n\n    filterItems[this.itemIndex].el.click();\n    this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n    const {keyCode} = evt;\n    if (evt.ctrlKey) {\n        evt.stopPropagation();\n    }\n    switch (keyCode) {\n        case 37: // left\n            evt.stopPropagation();\n            break;\n        case 38: // up\n            inputMovePrev.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 39: // right\n            evt.stopPropagation();\n            break;\n        case 40: // down\n            inputMoveNext.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 13: // enter\n            inputEnter.call(this, evt);\n            break;\n        case 9:\n            inputEnter.call(this, evt);\n            break;\n        default:\n            evt.stopPropagation();\n            break;\n    }\n}\n\nexport default class Suggest {\n    constructor(items, itemClick, data, editor, width = '200px') {\n        this.filterItems = [];\n        this.items = items;\n        this.data = data;\n        this.editor = editor;\n        this.el = h('div', `${cssPrefix}-suggest`)\n            .css('width', width)\n            .css('overflow-y', 'auto')\n            .css('max-height', '306px').hide();\n        this.el.attr('tabindex', 0);\n\n\n        this.itemClick = itemClick;\n        this.itemIndex = -1;\n        this.show = false;\n    }\n\n    setOffset(v) {\n        this.el.cssRemoveKeys('top', 'bottom')\n            .offset(v);\n    }\n\n    hide() {\n        const {el} = this;\n        this.filterItems = [];\n        this.itemIndex = -1;\n        el.hide();\n        this.show = false;\n        unbindClickoutside(this.el.parent());\n    }\n\n    setItems(items) {\n        this.items = items;\n        // this.search('');\n    }\n\n    search(word) {\n        let {items, data, editor} = this;\n        if (!/^\\s*$/.test(word)) {\n            items = items.filter(it => (it.key.toUpperCase() || it.toUpperCase()).startsWith(word.toUpperCase()));\n        }\n        items = items.map((it) => {\n            let {title} = it;\n            if (title) {\n                if (typeof title === 'function') {\n                    title = title();\n                }\n            } else {\n                title = it;\n            }\n            const item = h('div', `${cssPrefix}-item`)\n                .child(title)\n                .on('click.stop', () => {\n                    this.itemClick(it);\n                });\n            if (it.label) {\n                item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        this.filterItems = items;\n        if (items.length <= 0) {\n            this.hide();\n            this.show = false;\n            return;\n        }\n        const {el} = this;\n        // items[0].toggle();\n        let rect = data.getRect(new CellRange(editor.ri, editor.ci, editor.ri, editor.ci));\n        let left = rect.left + 55;\n        let top = rect.top + 50;\n\n        if( items.length >= 9 && rect.top - 306 >= 50) {\n            top -= 306;\n            top -= rect.height;\n        }\n        el.css('left', `${left}px`);\n        el.css('top', `${top}px`);\n\n        el.html('').children(...items).show();\n        this.show = true;\n        bindClickoutside(el.parent(), () => {\n            this.hide();\n            this.show = false;\n        });\n    }\n\n    bindInputEvents(input) {\n        input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n    ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n    ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n    ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n    ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n    ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst selectColors = [\"#EE0000\", \"#8A2BE2\", \"#FF3E96\", \"#8B4500\", \"#3A5FCD\", \"#FF7F24\"];\n\nexport function selectorColor(index) {\n    index = index % selectColors.length;\n    return {\n        color: selectColors[index],\n        index: index,\n    };\n}\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nfunction buildTd(bgcolor) {\n    let item = h('div', `${cssPrefix}-color-palette-cell`)\n        .on('click.stop', () => this.change(bgcolor))\n        .css('background-color', bgcolor);\n\n    this.items.push(\n        item\n    );\n    return h('td', '').child(item);\n}\n\nexport default class ColorPalette {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-color-palette`);\n        this.change = () => {\n        };\n        this.items = [];\n        const table = h('table', '').children(\n            h('tbody', '').children(\n                h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n                    ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n                ),\n                ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n                    ...it.map(color => buildTd.call(this, color)),\n                )),\n                h('tr', `${cssPrefix}-standard-colors`).children(\n                    ...standardColors.map(color => buildTd.call(this, color)),\n                ),\n            ),\n        );\n        this.el.child(table);\n    }\n}\n","/* global describe, it */\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, colorPalette.el);\n    this.colorPalette = colorPalette;  // 测试用例有用到\n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n      this.open = false;\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n      this.open = true;\n      bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n      this.open = false;\n      document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import {h} from \"../component/element\";\nimport {cutStr} from \"../core/operator\";\n\nfunction mountCopy(event) {\n    event.preventDefault();\n    let choose = getChooseImg.call(this);\n    if (choose) {\n        if (event.clipboardData) {\n            event.clipboardData.setData(\"text/html\", parseDom(choose.img2));\n            event.clipboardData.setData(\"text/plain\", \"\");\n        }\n        return;\n    }\n\n    let args = sheetCopy.call(this);\n    if (event.clipboardData) {\n        event.clipboardData.setData(\"text/html\", parseDom(args.html.el));\n        event.clipboardData.setData(\"text/plain\", args.plain);\n    }\n}\n\nfunction getChooseImg() {\n    let {pasteDirectionsArr} = this.data;\n\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true) {\n                this.container.css('pointer-events', 'auto');\n                return pasteDirectionsArr[i];\n            }\n        }\n    }\n    return null;\n}\n\nfunction sheetCopy() {\n    let args = {\n        plain: \"\",\n        html: h(\"table\", \"\"),\n    };\n\n    let {selector, rows, styles} = this.data;\n    let {sri, eri, sci, eci} = selector.range;\n    let tbody = h('tbody', '');\n    for (let i = sri; i <= eri; i += 1) {\n        let tr = h('tr', '');\n        for (let j = sci; j <= eci; j += 1) {\n            let td = h('td', '');\n            if (rows._[i] && rows._[i].cells && rows._[i].cells[j]) {\n                if (rows._[i].cells[j] && styles[rows._[i].cells[j].style]) {\n                    td.css('color', styles[rows._[i].cells[j].style].color);\n                    if (styles[rows._[i].cells[j].style]\n                        && styles[rows._[i].cells[j].style].font\n                        && styles[rows._[i].cells[j].style].font.bold) {\n                        let bold = styles[rows._[i].cells[j].style].font.bold ? '900' : '';\n                        td.css('font-weight', bold);\n                    }\n                    td.css('background', styles[rows._[i].cells[j].style].bgcolor);\n                }\n\n                if(!rows._[i].cells[j].text) {\n                    rows._[i].cells[j].text = \"\";\n                }\n                if(!rows._[i].cells[j].formulas) {\n                    rows._[i].cells[j].formulas = \"\";\n                }\n\n                let text = rows._[i].cells[j].formulas !== \"\" ? rows._[i].cells[j].formulas : rows._[i].cells[j].text;\n                if(rows._[i].cells[j].formulas && cutStr(rows._[i].cells[j].formulas, false, true).length > 0) {\n                    let hidden = h('reference', '');\n                    hidden.html(text);\n                    hidden.attr('ri', i);\n                    hidden.attr('ci', j);\n                    td.child(hidden.el);\n                } else\n                    td.html(text);\n                args.plain += text;\n                args.plain += \"\\t\";\n            } else {\n                args.plain += \"\\t\";\n            }\n            tr.child(td);\n        }\n\n        tbody.child(tr);\n        args.plain += \"\\n\";\n    }\n    args.html.child(tbody);\n\n    return args;\n}\n\nfunction parseDom(node) {\n    let tmpNode = document.createElement(\"div\");\n    tmpNode.appendChild(node.cloneNode(true));\n\n    return  tmpNode.innerHTML;\n}\n\nexport {\n    mountCopy,\n    getChooseImg,\n    sheetCopy\n}","function Drag(options, self) {\n\n    /**\n     *\n     * @param el 节点\n     */\n    this.register = function (el) {\n        el.addEventListener('mousedown', function (e) {\n            if (e.button !== 0) {\n                //屏蔽左键以外的按键\n                return;\n            }\n\n\n            //获取x坐标和y坐标\n            let x = e.clientX;\n            let y = e.clientY;\n\n            //获取左部和顶部的偏移量\n            let l = el.offsetLeft;\n            let t = el.offsetTop;\n\n            if (options && options.onBegin) {\n                options.onBegin.call(el, {\n                    left: x - l,\n                    top: y - t\n                });\n            }\n\n\n            //开关打开\n            let isDown = true;\n            //设置样式\n            el.style.cursor = 'move';\n\n            let nl = x, nt = y;\n\n\n            window.onmousemove = function (e) {\n                if (!isDown) {\n                    return;\n                }\n                //获取x和y\n                let nx = e.clientX;\n                let ny = e.clientY;\n\n\n                //计算移动后的左偏移量和顶部的偏移量\n                nl = nx - (x - l);\n                nt = ny - (y - t);\n\n                // console.log( nl, nt);\n                // let drag = false;\n                if (nl > 0) {\n                    // drag = false;\n                    el.style.left = nl + 'px';\n                } else {\n                    // drag = true;\n                    el.style.left = 0 + 'px';\n                }\n                if (nt > 0) {\n                    // drag = false;\n                    el.style.top = nt + 'px';\n                } else {\n                    // drag = true;\n                    el.style.top = 0 + 'px';\n                }\n                // el.style.left = nl + 'px';\n                // el.style.top = nt + 'px';\n\n\n                if (options && options.onDrag) {\n                    options.onDrag.call(el, {\n                        left: nl,\n                        top: nt,\n                        x: nx - x,\n                        y: ny - y,\n                        isDown: isDown\n                    });\n                }\n\n                return false;\n            };\n\n            window.onmouseup = function () {\n                //开关关闭\n                isDown = false;\n                el.style.cursor = 'default';\n\n                if (options && options.onEnd) {\n                    options.onEnd.call(el, {left: parseInt(el.style.left), top: parseInt(el.style.top)}, self);\n                }\n\n                return false;\n            };\n            // e.stopPropagation();\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            } else if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                // window.event.returnValue === false;\n            }\n        });\n    }\n}\n\nexport default Drag;","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\nimport zhCN from './locale/zh-cn';\nimport {bugout} from \"./log/log_proxy\";\nimport Drag from \"./external/drag\";\n\nclass Spreadsheet {\n    constructor(selectors, options = {}, methods = {}, alias = 'sheet1') {\n        let targetEl = selectors;\n          if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.locale('zh-cn', zhCN);\n        this.data = new DataProxy(alias, options, methods);\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n\n        this.sheet = new Sheet(rootEl, this.data);\n        this.data.sheet = this.sheet;\n    }\n\n    setDataSettings(value) {\n        this.data.settings.showEditor = value;\n    }\n\n    loadData(data) {\n        this.sheet.loadData(data);\n        return this;\n    }\n\n    getData() {\n        return this.data.getData();\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.data.change = cb;\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n\n    locale(lang, message) {\n        locale(lang, message);\n    }\n\n    // getEditorStatus() {\n    //     let {editor} = this.sheet;\n    //     let { ri, ci, pos} = editor;\n    //     let inputText = editor.editorText.getText();\n    //\n    //     return  {\n    //         \"status\": editor.isDisplay(),\n    //         \"inputText\": inputText,\n    //         \"ri\": ri,\n    //         \"ci\": ci,\n    //         \"pos\": pos,\n    //     };\n    // }\n\n    // setEditorText(text = '', pos = 1) {\n    //     let {editor} = this.sheet;\n    //     text = text !== '' ? text : '=';\n    //     editor.inputEventHandler(text, pos, true);\n    // }\n    //\n    // setTextEnd(cell, ri, ci) {\n    //     let {editor, data} = this.sheet;\n    //     editor.setCellEnd({\n    //         text: cell.text,\n    //         formulas: cell.formulas\n    //     });\n    //     data.setCellAll(ri, ci, cell.formulas + \"\", cell.formulas + \"\", '');\n    //\n    //     this.sheet.selectorEditorReset(ri, ci);\n    //\n    //     setTimeout(() => {\n    //         editor.setCursorPos(cell.formulas.length);\n    //     }, 100)\n    // }\n\n    getText(alias, inputText, pos) {\n        let {selectors, data, table} = this.sheet;\n        let text = \"\";\n        for(let i = 0; i < selectors.length; i++) {\n            let {erpx} = selectors[i];\n            text += erpx;\n        }\n\n        return data.getCellByExpr(text, table, alias, inputText, pos);\n    }\n\n    removeEvent() {\n        this.sheet.removeEvent();\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.jsSpreadsheet = require('js-spreadsheet');\n    window.drag = Drag;\n    window.x = window.x || {};\n    window.bugout = bugout;\n    window.x.spreadsheet = spreadsheet;\n    window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\n// export default Spreadsheet;\nexport {\n    spreadsheet,\n};\n","/* global document */\n\nimport {formulaCalc} from '../core/formula';\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper, {isHave, isNumber, useOne} from './helper';\nimport {isFormula, Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\nimport Moved from '../event/move';\nimport {h} from \"../component/element\";\nimport {mountImg} from \"../event/paste\";\nimport {parseCell2} from \"../component/table\";\nimport {isLegal} from \"./operator\";\nimport Recast from \"./recast\";\nimport {changeFormat, dateDiff, formatDate} from '../utils/date';\nimport {formatNumberRender} from \"./format\";\nimport MultiPreAction from \"../core/multi_pre_action\";\nimport CellProxy from \"./cell_proxy\";\nimport CellProp from \"../model/cell_prop\";\nimport PaintFormat from \"../model/paint_format\";\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        family: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    formula: {},\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showEditor: true,\n    autoLoad: true,\n    ignore: [],\n    cellWidth: 0,\n    ignoreRi: 0,\n    minus: false,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 10,\n    },\n    rowsInit: false,\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        flexible: false,\n        underline: false,\n        autoAdapt: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n    },\n};\n\nconst toolbarHeight = 41;\n\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    if (!dst) {\n        return false;\n    }\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange, cleard) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    if (cleard)\n        clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (isHave(cell.style)) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n\n    Object.assign(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction selectorCellText(ri, ci, text, event_type) {\n    if (ri === -1 || ci === -1) {\n        return {\n            \"state\": true,\n            \"msg\": \"单元格坐标有误\"\n        };\n    }\n    if (event_type !== 'style' && (!text || text[0] !== '=')) {\n        return {\n            \"state\": false,\n            \"msg\": \"正确\"\n        };\n    }\n\n    // state\n    let args = errorPop.call(this, text);\n    if (event_type !== 'style' && args.state === true) {\n        return {\n            \"msg\": args.msg,\n            \"state\": true,\n        };\n    }\n    return {\n        \"msg\": args.msg,\n        \"state\": false,\n    };\n}\n\nfunction errorPop(text) {\n    let enter = false;\n    let msg = \"\";\n    try {\n        let recast = new Recast(text);\n        recast.parse();\n    } catch (e) {\n        msg = '您输入的公式存在问题，请更正, 错误原因: ' + e.description;\n        enter = true;\n    }\n\n    if (enter === true) {\n        if (isLegal(text) === false) {\n            msg = '缺少左括号或右括号';\n            enter = true;\n        }\n    }\n\n    if (enter) {\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else {\n        return {\n            \"state\": false,\n            \"msg\": msg\n        };\n    }\n}\n\nfunction processPasteDirectionsArr(pasteDirectionsArr, type = 'to', sheet) {\n    if (type === 'to') {\n        let arr = [];\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            console.log(item);\n            let newItem = {\n                src: item.img2.src,\n                ri: item.ri,\n                ci: item.ci,\n                top: item.top,\n                left: item.left,\n                range: item.range,\n                offsetLeft: item.offsetLeft,\n                offsetTop: item.offsetTop,\n                nextLeft: item.nextLeft,\n                nextTop: item.nextTop,\n                img: item.img,\n                arr: item.arr,\n                img2: item.img2\n            };\n\n            arr.push(newItem);\n        }\n\n        return arr;\n    } else if (type === 'from') {\n        if (typeof sheet === 'string') {\n            return;\n        }\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            let img = h('img', '');\n            img.el.src = item.src;\n            mountImg.call(sheet, img.el, true, item.ri, item.ci, item.range);\n        }\n    }\n}\n\nfunction clickCopyPasteHelp(ri, lci) {\n    let {rows} = this;\n    let lri = ri + 1;\n    let enter = true;\n    while (enter) {\n        let lcell = rows.getCellOrNew(lri, lci);\n        if (!lcell || !lcell.text) {\n            enter = false;\n        } else {\n            lri = lri + 1;\n        }\n    }\n\n    return lri;\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSignleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            setStyleBorder.call(this, ri, ci, {});\n        }\n    }\n\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci <= eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\n// function getCellRowByAbsX(scrollOffsetx) {\n//     let x = scrollOffsetx;\n//     const {cols} = this;\n//     const fsw = this.freezeTotalWidth();\n//     let inits = cols.indexWidth;\n//     if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n//     const [ci, left, width] = helper.rangeReduceIf(\n//         0,\n//         cols.len,\n//         inits,\n//         cols.indexWidth,\n//         x,\n//         i => cols.getWidth(i),\n//     );\n//     if (left <= 0) {\n//         return {ci: 0, left: 0, width: cols.indexWidth};\n//     }\n//     return {ci: ci - 1, left, width};\n// }\n\n// function getCellRowByAbsY(scrollOffsety) {\n//     let y = scrollOffsety;\n//     let {rows} = this;\n//     let ri = 0;\n//     let top = rows.height;\n//     const frset = this.exceptRowSet;\n//     let {height} = rows;\n//\n//     for (; ri < rows.len; ri += 1) {\n//         if (top > y) break;\n//         if (!frset.has(ri)) {\n//             height = rows.getHeight(ri);\n//             top += height;\n//         }\n//     }\n//\n//     if (ri <= 0) {\n//         ri = 0;\n//     }\n//     if (height <= 0) {\n//         height = 0;\n//     }\n//\n//     return {ri: ri, top, height};\n// }\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction makeFormatCell({text, formula}, {symbol, position}, cb) {\n    if (!isHave(text) || !isNumber(text)) {\n        return null;\n    }\n\n    let cText = cb(formatNumberRender(text, -1));\n    formula = isFormula(formula) ? formula : cText;\n    if (!isNaN(cText)) {\n\n        return {\n            \"text\": position === 'begin' ? symbol + cText : cText + symbol,\n            \"value\": text,\n            \"formulas\": formula,\n        };\n    } else {\n        return null;\n    }\n}\n\n// what = 'input' || 'change'\nfunction tryParseToNum(cell, ri, ci) {\n    return getType.call(this, ri, ci, cell);\n}\n\nfunction getType(ri, ci, cell) {\n    let data = this;\n    let {rows} = this;\n    let cellStyle = data.getCellStyle(ri, ci);\n    let {isValid, diff} = dateDiff(cell.text);\n\n    let format = rows.getCellStyleConvert(cellStyle, isValid);\n    if (format === 'number') {\n        let text = cell.text, formula = cell.formulas;\n        let _cell = {};\n        if (isValid) {\n            _cell = {\n                \"text\": diff.toFixed(2),\n                \"formulas\": formula,\n            };\n        } else {\n            text = formatNumberRender(text, 2);\n            _cell = {\n                \"text\": text,\n                \"value\": cell.text,\n                \"formulas\": formula,\n            };\n        }\n\n        if (isHave(_cell.text) && isNumber(_cell.text)) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        } else {\n            return {\n                \"state\": false,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'date' || format === 'datetime') {\n        let text = cell.text;\n\n        if (!isValid) {\n            let args = formatDate(text);\n            let {state, date} = args;\n            // minute = args.minute;\n            isValid = state;\n            diff = cell.text;\n            text = date;\n        }\n\n        if (isValid) {\n            if (format === 'datetime') {\n                text = changeFormat(formatDate(dateDiff(text).diff).date);\n            }\n\n        }\n\n        return {\n            \"state\": isValid,\n            \"style\": format,\n            \"text\": !isHave(cellStyle) ? diff : text,\n        };\n    } else if (format === 'normal') {\n        if (isValid) {\n            let text = diff, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": rows.toString(formula),\n                \"text\": rows.toString(text),\n            };\n\n            return {\n                \"state\": true,\n                \"text\": _cell.text,\n                \"style\": format,\n                \"cell\": _cell,\n            }\n        } else {\n            let text = cell.text, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'rmb') {\n        let text = \"\", formula = \"\";\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = formatNumberRender(cell.text, 0);\n            formula = cell.formulas;\n        }\n\n        let _cell = makeFormatCell({text, formula}, {symbol: \"￥\", position: \"begin\"}, (s) => {\n            return s;\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    } else if (format === 'percent') {\n        let text = \"\", formula = \"\";\n\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = rows.useOne(cell.value, cell.text);\n            formula = cell.formulas;\n        }\n        let _cell = makeFormatCell({text, formula}, {symbol: \"%\", position: \"end\"}, (s) => {\n            return Number(s * 100).toFixed(2);\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    }\n\n    return {\n        \"state\": false,\n        \"style\": format,\n        \"text\": cell.text,\n        \"cell\": {},\n    };\n}\n\n\nexport default class DataProxy {\n    constructor(name, settings, methods) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.methods = methods;\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row, this);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = {};\n        this.showEquation = false;\n        this.calc = formulaCalc();\n        this.pasteDirectionsArr = [];\n        this.changeDataForCalc = null;\n\n        // save data end\n\n        // don't save object\n        this.multiPreAction = new MultiPreAction(this);\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        // this.history = new History(this);\n        this.clipboard = new Clipboard();\n        this.moved = new Moved();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    tryParseToNum(cell, ri, ci) {\n        return tryParseToNum.call(this, cell, ri, ci);\n    }\n\n    clickCopyPaste() {\n        let ri = this.selector.range.eri;\n        let ci = this.selector.range.eci;\n        let {rows} = this;\n        const cell = rows.getCellOrNew(ri, ci);\n        const cell2 = rows.getCellOrNew(ri + 1, ci);\n        if (!cell || !cell.text || (cell2 && cell2.text)) {\n            return {\n                enter: false\n            };\n        }\n\n        let left = clickCopyPasteHelp.call(this, ri, ci - 1);\n        let right = clickCopyPasteHelp.call(this, ri, ci + 1);\n        let eri = left < right ? right : left;\n\n        let enter = false;\n        for (let i = 1; i < eri && enter === false; i++) {\n            let cell3 = rows.getCellOrNew(ri + i, ci);\n\n            if (cell3 && cell3.text) {\n                eri = ri + i;\n                enter = true;\n            }\n        }\n\n\n        let dstCellRange = new CellRange(ri + 1, ci, eri - 1, ci);\n        let srcCellRange = new CellRange(ri, ci, ri, ci);\n\n        return {\n            enter: true,\n            dstCellRange: dstCellRange,\n            srcCellRange: srcCellRange\n        };\n    }\n\n\n    // getSelectedValidator() {\n    //     const {ri, ci} = this.selector;\n    //     const v = this.validations.get(ri, ci);\n    //     return v ? v.validator : null;\n    // }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.multiPreAction.getItems(1).length > 0;\n        // return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.multiPreAction.getItems(2).length > 0;\n    }\n\n    undo() {\n        this.multiPreAction.undo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.undo(this.getData(), (d) => {\n        //     this.setData(d);\n        // }, sheet);\n    }\n\n    historyList(item) {\n        return this.multiPreAction.getItems(item);\n    }\n\n    redo() {\n        this.multiPreAction.redo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.redo(this.getData(), (d) => {\n        //     this.setData(d);\n        // });\n    }\n\n    copy() {\n        document.execCommand('copy', true);\n        this.clipboard.copy(this.selector.range);\n    }\n\n    makeCellPropArr(range, dsri, dsci) {\n        let {rows} = this;\n        let darr = [];\n        let cells = rows.eachRange(range);\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n\n            if (isHave(cell) && isHave(cell.style) === false) {\n                let cstyle = this.defaultStyle();\n                cell.style = this.addStyle(cstyle);\n            }\n\n            let cellProp = new CellProp(ri + dsri, ci + dsci, cell, xy2expr(ri + dsri, ci + dsci));\n            darr.push(cellProp);\n        }\n\n        return darr;\n    }\n\n    setCellByCellProp(pArr, cb) {\n        let {rows} = this;\n        for (let i = 0; i < pArr.length; i++) {\n            let {ri, ci, cell} = pArr[i];\n            if (isHave(cell) && isHave(cell.style)) {\n                rows.setCell(ri, ci, cell, 'style');\n            }\n            cb(ri, ci);\n        }\n    }\n\n    paintFormatChange(cb) {\n        this.changeData(() => {\n            let {clipboard,   selector} = this;\n            let {range} = clipboard;\n            let sri = selector.ri;\n            let sci = selector.ci;\n\n            let dsri = sri - range.sri;\n            let dsci = sci - range.sci;\n            let darr = this.makeCellPropArr(range, dsri, dsci);\n\n            if (selector.range.eri - selector.range.sri === 0 && selector.range.eci - selector.range.sci === 0) {\n                this.setCellByCellProp(darr, cb);\n            } else {\n                let paintFormat = new PaintFormat(range, selector.range);\n                let paintType = paintFormat.getPaintType();\n                let pArr = paintFormat.makePaintArr(paintType, darr);\n\n                this.setCellByCellProp(pArr, cb);\n            }\n        }, {type: 12, cellRange: this.selector.range});\n    }\n\n    move() {\n        this.moved.move();\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    paste(cellRange) {\n        this.changeData(() => {\n\n        }, {type: 6, cellRange: cellRange});\n    }\n\n    // what: all | text | format\n    // paste(what = 'all', error = () => {\n    // }) {\n    //\n    //     // console.log('sIndexes:', sIndexes);\n    //     // const {clipboard, selector} = this;\n    //     // if (clipboard.isClear()) return false;\n    //     // if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n    //     //\n    //     // this.changeData(() => {\n    //     //     if (clipboard.isCopy()) {\n    //     //         copyPaste.call(this, clipboard.range, selector.range, what);\n    //     //     } else if (clipboard.isCut()) {\n    //     //         cutPaste.call(this, clipboard.range, selector.range);\n    //     //     }\n    //     // });\n    //     return true;\n    // }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        }, {type: 5, cellRange: cellRange});\n\n        return true;\n    }\n\n\n    clickAutofill(srcRange, cellRange, what, error = () => {\n    }) {\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        // row index\n        if (nri <= cri) [sri, eri] = [nri, cri];\n        else eri = nri;\n        // col index\n        if (nci <= cci) [sci, eci] = [nci, cci];\n        else eci = nci;\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                const cell = rows.getCellOrNew(selector.ri, selector.ci);\n                cell.text = `=${value}()`;\n                cell.formulas = `=${value}()`;\n            } else {\n                selector.range.each((ri, ci) => {\n                    let cell = rows.getCellOrNew(ri, ci);\n\n                    let cstyle = {};\n                    if (isHave(cell.style)) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        // cell.text = cell.text.replace(\"¥\", \"\");\n                        // cell.formulas = cell.formulas.replace(\"¥\", \"\");\n                        rows.setCellText(ri, ci, {\n                            text: cell.text,\n                            style: this.addStyle(cstyle)\n                        }, 'format');\n                        // this.rows.workbook.change(ri, ci, cell, deepCopy(cell), 'change');\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'flexible') {\n                        if (this.exceptRowSet.has(ri + 1) && this.exceptRowSet.has(ri + 2) && !this.exceptRowSet.has(ri + 3)) {\n                            this.exceptRowSet.delete(ri);\n                            this.exceptRowSet.delete(ri + 1);\n                            this.exceptRowSet.delete(ri + 2);\n                        } else {\n                            this.exceptRowSet.add(ri);\n                            this.exceptRowSet.add(ri + 1);\n                            this.exceptRowSet.add(ri + 2);\n                        }\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    }\n                });\n            }\n        }, {type: 11, cellRange: this.selector.range, property, value});\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        this.setCellText(nri, ci, {text}, state);\n        this.resetAutoFilter();\n    }\n\n    // state: input | finished\n    setSelectedCell(text, state = 'input', formulas, ri, ci) {\n        this.setCellAll(ri, ci, text, formulas, state);\n        this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    editorChangeToHistory(oldCell, {ri, ci}, type) {\n        if (ri === -1 || ci === -1) {\n            return {\"state\": false}\n        }\n        let newCell = this.rows.getCell(ri, ci);\n        // if (oldCell.text === newCell.text || oldCell.formulas === newCell.text) {\n        //     return {\n        //         \"state\": false,\n        //     };\n        // }\n        let {multiPreAction} = this;\n        let expr = xy2expr(ci, ri);\n        let step = multiPreAction.getStepType(type, {ri, ci, expr, text: newCell.text});\n\n        let oc = new CellProp(ri, ci, oldCell, expr);\n        let nc = new CellProp(ri, ci, newCell, expr);\n        multiPreAction.addStep(step, {oldCell: [oc], newCell: [nc]});\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        return {\n            \"state\": true\n        }\n    }\n\n    changeToHistory({ri, type, ci, cellRange, property, value, oldCell, oldMergesData}, oldStep) {\n        if (type === -1) {\n            return {\"state\": false,}\n        }\n\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n        multiPreAction.addStep(step, {oldCell, oldMergesData, newMergesData: this.merges.getData(), oldStep,});\n        return {\n            \"state\": true\n        }\n    }\n\n    getSelectedCellRiCi(ri, ci) {\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n\n    getMoveRect(range) {\n        return this.getRect(range);\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    getCellRectByXYWithNotTotalResult(x, y) {\n        const {\n            scroll, merges,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n\n        if (ci === -1) {\n            // // width = cols.totalWidth();\n            // let args = getCellRowByAbsX.call(this, scroll.x);\n            // console.log(args);\n            // // ci = args.ci;\n        }\n        if (ri === -1) {\n            // let args = getCellRowByAbsY.call(this, scroll.y);\n            // console.log(\"1179: \", args.ri);\n            // ri = args.ri;\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    isSignleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSignleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            const cell = rows.getCellOrNew(sri, sci);\n            cell.merge = [rn - 1, cn - 1];\n            this.merges.add(selector.range);\n            // delete merge cells\n            this.rows.deleteCells(selector.range);\n            // console.log('cell:', cell, this.d);\n            this.rows.setCell(sri, sci, cell);\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSignleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                let v = selector.range.toString();\n                let eri = selector.range.eri;\n                const {rows} = this;\n\n                for (let i = selector.range.sci; i <= selector.range.eci; i++) {\n                    let range = new CellRange(selector.range.sri, i, selector.range.sri, i);\n                    range = rows.autoFilterRef(v, range);\n                    if (eri < range.eri) {\n                        eri = range.eri;\n                    }\n                }\n                let range = new CellRange(selector.range.sri, selector.range.sci, eri, selector.range.eci);\n                autoFilter.ref = range.toString();\n            }\n        });\n    }\n\n    throwFormula() {\n        const {selector, rows} = this;\n\n        this.changeData(() => {\n            selector.range.each((i, j) => {\n                const cell = rows.getCellOrNew(i, j);\n                if (cell && cell.text && cell.formulas) {\n                    rows.setCellAll(i, j, cell.text, cell.text);\n                }\n            });\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        }, {type: 2});\n    }\n\n    // type: row | column\n    insert(type, n = 1, begin = -1) {\n        const {sri, sci} = this.selector.range;\n        const {rows, merges, cols} = this;\n        if (type === 'row') {\n            begin = begin !== -1 ? begin : sri;\n        } else if ('column') {\n            begin = begin !== -1 ? begin : sci;\n        }\n\n        this.changeData(() => {\n            let si = begin;\n            if (type === 'row') {\n                rows.insert(begin, n);\n            } else if (type === 'column') {\n                rows.insertColumn(begin, n);\n                si = begin;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        }, {type: 13, data: this.getData(), property: \"insert\"});\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= 1;\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {scroll, freeze, rows} = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        // console.log('ri:', ri, ' ,y:', y1);\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getMax() {\n        let mci = this.cols.len;\n        let mri = this.rows.len;\n\n        return {\n            mri,\n            mci\n        }\n    }\n\n\n    // isEmpty(cell) {\n    //     return this.rows.isEmpty(cell);\n    // }\n\n    renderFormat(style, cell, nrindex, cindex, filter) {\n        let cellProxy = new CellProxy(cell);\n        return cellProxy.renderFormat(style, nrindex, cindex, this, filter);\n    }\n\n    isFormula(text) {\n        return this.rows.isFormula(text);\n    }\n\n    toString(text) {\n        return this.rows.toString(text);\n    }\n\n    // isBackEndFunc(text) {\n    //     return this.rows.isBackEndFunc(text);\n    // }\n\n    // isReferOtherSheet(cell) {\n    //     return this.rows.isReferOtherSheet(cell);\n    // }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    // getCellStyleHandle(index, type, cell, ri, ci) {\n    //     let style = this.styles[index];\n    //\n    //     if (style && style.format === type) {\n    //         return true;\n    //     }\n    //     return false;\n    // }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    getCellByExpr(src, table, name, inputText, pos) {\n        // let p1 = inputText.substring(0, pos);\n        // let p2 = inputText.substring(pos, inputText.length);\n        // inputText = p1 + src + p2;\n        // let workbook = parseCell2.call(table, this.viewRange(), true, inputText);\n        // return {\n        //     \"text\": workbook['Sheets'][name].A1.w ? workbook['Sheets'][name].A1.w : workbook['Sheets'][name].A1.v,\n        //     \"formulas\": p1 + `${name}!` + src + p2\n        // };\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, {text, style}, state) {\n        // text = text.replace(/\\\"/g)\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, {text: ''});\n            history.add(this.getData());\n            rows.setCellText(ri, ci, {text});\n        } else {\n            if (state === 'end') {\n                rows.setCellAll(ri, ci, text);\n            } else if (state === 'formulas') {\n                rows.setCellAll(ri, ci, text, \"-\");\n            } else if (state === 'style') {\n                rows.setCellText(ri, ci, {text, style}, 'style');\n            } else {\n                rows.setCellText(ri, ci, {text});\n                // rows.\n            }\n            // 不应该没打开一个单元格就 change一次\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    // setCellWithFormulas(ri, ci, text, formulas, what = 'all') {\n    //     const {rows} = this;\n    //     rows.setCellAll(ri, ci, text, formulas, what);\n    // }\n\n\n    // state: input | finished\n    setCellAll(ri, ci, text, formulas, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellAll(ri, ci, '', '');\n            history.add(this.getData());\n            rows.setCellAll(ri, ci, text, formulas);\n        } else {\n            rows.setCellAll(ri, ci, text, formulas);\n            // this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text, formulas);\n    }\n\n    equationIsActive() {\n        return this.showEquation;\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        }, {type: 3, ri: ri});\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        }, {type: 4, ci: ci});\n    }\n\n    viewHeight() {\n        const {view, showToolbar} = this.settings;\n        let h = view.height();\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    viewRange2() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) offset += 1;\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                cb(i, y, rowHeight);\n                y += rowHeight;\n                if (y > this.viewHeight()) break;\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            cb(i, x, colWidth);\n            x += colWidth;\n            if (x > this.viewWidth()) break;\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    // addPicture(pic) {\n    //     const {pictures} = this;\n    //\n    // }\n\n    getChangeDataToCalc() {\n        let {multiPreAction} = this;\n        if (multiPreAction.undoItems.length <= 0) {\n            return null;\n        }\n        let lastStep = multiPreAction.undoItems[multiPreAction.undoItems.length - 1];\n        if (!isHave(lastStep)) {\n            return null;\n        }\n\n        return lastStep;\n    }\n\n    changeData(cb, {type = -1, ri = -1, ci = -1, cellRange = \"\", property = \"\", value = \"\"} = -1) {\n        if (this.settings.showEditor === false) {\n            return;\n        }\n\n        let oldCell = {};\n        let oldMergesData = this.merges.getData();\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n\n        if (cellRange !== \"\") {\n            let {multiPreAction} = this;\n            oldCell = multiPreAction.eachRange(cellRange);\n        }\n        cb();\n        this.changeToHistory({type, ri, ci, cellRange, property, value, oldCell, oldMergesData, newData: this.getData(), }, step);\n        this.changeDataForCalc = this.getChangeDataToCalc();\n\n        this.change(this.getData());\n    }\n\n    cutPaste(srcCellRange, dstCellRange, cleard = true) {\n        cutPaste.call(this, srcCellRange, dstCellRange, cleard);\n    }\n\n    setData(d, sheet = \"\", out = false) {\n        const {autoFilter} = this;\n        Object.keys(d).forEach((property) => {\n            // this.judgeAutoWidth(d.rows);\n            if (property === 'merges'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'flex') {\n                autoFilter.addFiexRows(d[property]);\n            } else if (property === 'rows') {\n                this[property].setData(d[property], sheet, out, this.settings.rowsInit);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'pictures') {\n                if (d[property]) {\n                    processPasteDirectionsArr.call(this, d[property], 'from', sheet);\n                }\n            } else if (property === 'autofilter') {\n                if (d[property] && d[property].ref) {\n                    autoFilter.ref = d[property].ref;\n                    autoFilter.filters = d[property].filters;\n                    autoFilter.sort = d[property].sort;\n                }\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    selectorCellText(ri, ci, text, event_type) {\n        return selectorCellText.call(this, ri, ci, text, event_type);\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter, pasteDirectionsArr,\n        } = this;\n        return {\n            editor: this.settings.showEditor,\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            pictures: processPasteDirectionsArr(pasteDirectionsArr, 'to'),\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n}\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        font: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        textColor: 'Text color',\n        fillColor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        add: 'display equation',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n        flexible: 'Flexible',\n        throwFormula: 'Throw formulas',\n        comeBack: 'come back',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        insertRow: 'Insert row',\n        insertColumn: 'Insert column',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        recover: 'recover',\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    date_formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        concat: 'Concat',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","\"use strict\";\n\nconst s = require('./es6');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_need_calc_cell = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\nconst CalcCell = require('./CalcCell.js');\nconst checker = require('./formula_check.js');\nconst helper = require(\"../core/helper\");\nconst CalcWorkBook = require('./CalcWorkBook')\nvar mymodule = function(rows, tileArr) {\n    var a = new s({\n        type: 999,\n        action: \"重新计算\", ri: -1, ci: -1, oldCell: {},\n    }, rows.data);\n    console.log(a);\n    if (helper.isHave(tileArr)){\n        var Calc_WorkBook = new CalcWorkBook(rows, tileArr)\n        var workbook = rows.workbook\n        workbook = Calc_WorkBook.get_workbook(workbook)\n        var formulas = find_all_need_calc_cell(workbook, tileArr, exec_formula)\n        for (var i = formulas.length - 1; i >= 0; i--) {\n            try {\n                var calc_cell = new CalcCell(formulas[i], rows)\n                var valid_res = calc_cell.check_valid()\n                if (valid_res !== true){\n                    formulas[i].cell.v = valid_res\n                }else{\n                    //对cell和sheet进行处理和转换({}参数加上'',未定义单元格置为default_0等)，计算完成后需将多余变动部分还原\n                    formulas[i].cell.f = calc_cell.trans_formula()\n                    checker.trans_sheet(formulas[i].sheet)\n                    exec_formula(formulas[i]);\n                    formulas[i].cell.f = calc_cell.recover_formula()\n                    checker.recover_sheet(formulas[i].sheet)\n                }\n                //如果是多值单元格或公式返回结果为array，进入多单元格处理\n                if (Calc_WorkBook.is_muti_cell(formulas[i]) || Array.isArray(formulas[i].cell.v)){\n                    Calc_WorkBook.deal_muti_cell(workbook, formulas[i])\n                }\n            } catch (e) {\n                console.log(e)\n            }\n        }\n        Calc_WorkBook.calcDoneToSetCells(workbook, rows)\n    }\n\n};\n\nmymodule.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nmymodule.set_fx = exec_formula.set_fx;\nmymodule.exec_fx = exec_formula.exec_fx;\nmymodule.col_str_2_int = col_str_2_int;\nmymodule.int_2_col_str = int_2_col_str;\nmymodule.import_functions = exec_formula.import_functions;\nmymodule.import_raw_functions = exec_formula.import_raw_functions;\nmymodule.xlsx_Fx = exec_formula.xlsx_Fx;\nmymodule.localizeFunctions = exec_formula.localizeFunctions;\n\nmymodule.XLSX_CALC = mymodule\n\nmodule.exports = mymodule;\n","import PreAction from '../model/pre_action';\n\nmodule.exports = PreAction;","\"use strict\";\n\nconst expression_builder = require('./expression_builder.js');\n\nlet xlsx_Fx = {};\nlet xlsx_raw_Fx = {};\n\nimport_functions(require('.//formulajs/index'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            if (opts.override || !xlsx_Fx[prefix + key]) {\n                xlsx_Fx[prefix + key] = obj;\n            }\n            // else {\n            //     console.log(prefix + key, 'already exists.');\n            //     console.log('  to override:');\n            //     console.log('    XLSX_CALC.import_functions(yourlib, {override: true})');\n            // }\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    return expression_builder(formula, {xlsx_Fx: xlsx_Fx, xlsx_raw_Fx: xlsx_raw_Fx});\n    // xlsx_raw_Fx = {AND, IF, IFERROR, OFFSET}\n    // xlsx_Fx = {FLOOR, AVERGAE ... }\n}\n\nfunction exec_formula(formula) { // formula.cell.f = \"Average(1,2,3,4,5)\n    let root_exp = build_expression(formula);\n    root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.localizeFunctions = function(dic) {\n    for (let newName in dic) {\n        let oldName = dic[newName];\n        if (xlsx_Fx[oldName]) {\n            xlsx_Fx[newName] = xlsx_Fx[oldName];\n        }\n        if (xlsx_raw_Fx[oldName]) {\n            xlsx_raw_Fx[newName] = xlsx_raw_Fx[oldName];\n        }\n    }\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nexec_formula.xlsx_Fx = xlsx_Fx;\nmodule.exports = exec_formula;\n","const Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nmodule.exports = function expression_builder(formula, opts) { // 核心的解析公式的方法\n    formula.status = 'working';\n\n    var xlsx_Fx = opts.xlsx_Fx || {};\n    var xlsx_raw_Fx = opts.xlsx_raw_Fx || {};\n\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1); // =adsf 会变为adsf\n    }\n    var exp_obj = root_exp = new Exp(formula);  // 封装公式实例\n    var buffer = '',\n        was_string = false;\n    var fn_stack = [{ // 这个是函数调用栈？\n        exp: exp_obj\n    }];\n\n    /**\n     * state pattern in functional way\n     */\n    function string(char) {\n        if (char === '\"') {\n            exp_obj.push(new RawValue(buffer));\n            was_string = true;\n            buffer = '';\n            state = start;\n        } else {\n            buffer += char;\n        }\n    }\n\n    function single_quote(char) {\n        if (char === \"'\") {\n            state = start;\n        }\n        buffer += char;\n    }\n\n    function ini_parentheses() {\n        var o, trim_buffer = buffer.trim(),\n            special = xlsx_Fx[trim_buffer];\n        var special_raw = xlsx_raw_Fx[trim_buffer];\n        if (special_raw) {\n            special = new UserRawFnExecutor(special_raw, formula);\n        }\n        else if (special) {\n            special = new UserFnExecutor(special, formula);\n        }\n        else if (trim_buffer) {\n            //Error: \"Worksheet 1\"!D145: Function INDEX not found\n            throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n        }\n        o = new Exp(formula);\n        fn_stack.push({\n            exp: o,\n            special: special\n        });\n        exp_obj = o;\n        buffer = '';\n    }\n\n    function end_parentheses() {\n        var v, stack = fn_stack.pop();\n        exp_obj = stack.exp;\n        exp_obj.push(buffer,position_i);\n        v = exp_obj;\n        buffer = '';\n        exp_obj = fn_stack[fn_stack.length - 1].exp;\n        if (stack.special) {\n            stack.special.push(v);\n            exp_obj.push(stack.special, position_i);\n        }\n        else {\n            exp_obj.push(v, position_i);\n        }\n    }\n\n    function add_operation(char) {\n        if (!was_string) {\n            exp_obj.push(buffer, position_i);\n        }\n        was_string = false;\n        exp_obj.push(char, position_i);\n        buffer = '';\n    }\n\n    function start(char) {\n        if (char === '\"') {\n            state = string;\n            buffer = \"\";\n        } else if (char === \"'\") {\n            state = single_quote;\n            buffer = \"'\";\n        } else if (char === '(') {\n            ini_parentheses();\n        } else if (char === ')') {\n            end_parentheses();\n        } else if (common_operations[char]) {\n            add_operation(char);\n        } else if (char === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer, position_i);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        } else {\n            buffer += char;\n        }\n    }\n\n    var state = start;\n    var position_i = 0;\n\n    for (; position_i < str_formula.length; position_i++) {\n        state(str_formula[position_i]); // 逐字符解析函数\n    }\n    root_exp.push(buffer, position_i); // root_exp 是一个Exp实例，这个实例会引用一个Exp数组\n    return root_exp;\n\n}\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst str_2_val = require('./str_2_val.js');\n//XW：统一报错\nvar error = require('./formulajs/lib/error');\n//XW：end\n\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\nvar exp_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;   // id 是一个递增序列，其中root_exp的id为1\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n\n    function update_cell_value() {\n        try {\n            if (Array.isArray(self.args)\n                    && self.args.length === 1\n                    && self.args[0] instanceof Range) {\n                throw error.value;\n            }\n            formula.cell.v = self.calc();\n\n            if (typeof(formula.cell.v) === 'string') {\n                formula.cell.t = 's';\n            }\n            else if (typeof(formula.cell.v) === 'number') {\n                formula.cell.t = 'n';\n            }\n        }\n        catch (e) {\n            var errorValues = {\n                '#NULL!': 0x00,\n                '#DIV/0!': 0x07,\n                '#VALUE!': 0x0F,\n                '#REF!': 0x17,\n                '#NAME?': 0x1D,\n                '#NUM!': 0x24,\n                '#N/A': 0x2A,\n                '#GETTING_DATA': 0x2B\n            };\n            if (errorValues[e.message] !== undefined) {\n                formula.cell.t = 'e';\n                formula.cell.w = e.message;\n                formula.cell.v = errorValues[e.message];\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            formula.status = 'done';\n        }\n    }\n    function isEmpty(value) {\n        return value === undefined || value === null || value === \"\";\n    }\n\n    function checkVariable(obj) {\n        if (typeof obj.calc !== 'function') {\n            return 0;\n        }\n        return 1;\n    }\n\n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    if (i === 0 && op === '+') {\n                        let as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = args[i + 1].calc();\n                        args.splice(i, 2, new RawValue(r));\n                    } else {\n                        let as = checkVariable(args[i - 1]);\n                        if (!as)\n                            break;\n                        as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = fn(args[i - 1].calc(), args[i + 1].calc());\n                        args.splice(i - 1, 3, new RawValue(r));\n                        i--;\n                    }\n                }\n                catch (e) {\n                    // console.log('[Exp.js] - ' + formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                checkVariable(args[i + 1]);\n                var b = args[i + 1].calc();\n                if (i > 0 && typeof args[i - 1] !== 'string') {\n                    args.splice(i, 1, '+');\n                    if (b instanceof Date) {\n                        b = Date.parse(b);\n                        checkVariable(args[i - 1]);\n                        var a = args[i - 1].calc();\n                        if (a instanceof Date) {\n                            a = Date.parse(a) / MS_PER_DAY;\n                            b = b / MS_PER_DAY;\n                            args.splice(i - 1, 1, new RawValue(a));\n                        }\n                    }\n                    args.splice(i + 1, 1, new RawValue(-b));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(-b));\n                }\n            }\n        }\n    }\n    self.calc = function() {\n        let args = self.args.concat();\n        //XW: 对函数参数做转换、判断\n        try{\n            for (var i=0;i<args.length;i++){\n                if (args[i].name == 'RefValue'){\n                    var sheet = args[i].formula.sheet\n                    //未定义单元格f置为default_0\n                    if (sheet[args[i].str_expression] === undefined){\n                        args[i].formula.sheet[args[i].str_expression] = {v: 'default_0'}\n                    }\n                    //=A0形式参数报错\n                    if (args[i].str_expression.slice(1, args[i].str_expression.length) == '0'){\n                        return error.name;\n                    }\n                }\n            }\n        }catch (e) {\n        }\n        try{\n            //形如2019年10月19日参数转为2019-10-19\n            if (args[0].name == 'RefValue' && args[1] == '-' && args[2].name == 'RefValue'){\n                var sheet = args[0].formula.sheet\n                var a = sheet[args[0].str_expression].v\n                var b = sheet[args[2].str_expression].v\n                var a = a.replace('年', '-').replace('月', '-').replace('日', '')\n                var b = b.replace('年', '-').replace('月', '-').replace('日', '')\n                return datedifference(a, b)\n            }\n        }catch (e) {\n        }\n        //XW：end\n        exec_minus(args);\n        exec('^', args, function(a, b) {\n            return Math.pow(+a, +b);\n        });\n        exec('/', args, function(a, b) {\n            if (b == 0) {\n                throw error.div0;\n            }\n            return (+a) / (+b);\n        });\n        exec('*', args, function(a, b) {\n            return (+a) * (+b);\n        });\n        exec('+', args, function(a, b) {\n            if (a instanceof Date && typeof b === 'number') {\n                b = b * MS_PER_DAY;\n            }\n            return (+a) + (+b);\n        });\n        exec('&', args, function(a, b) {\n            return '' + a + b;\n        });\n        exec('<', args, function(a, b) {\n            return a < b;\n        });\n        exec('>', args, function(a, b) {\n            return a > b;\n        });\n        exec('>=', args, function(a, b) {\n            return a >= b;\n        });\n        exec('<=', args, function(a, b) {\n            return a <= b;\n        });\n        exec('<>', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() !== b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return false;\n            }\n            return a != b;\n        });\n        exec('=', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return true;\n            }\n            if ((a == null && b === 0) || (a === 0 && b == null)) {\n                return true;\n            }\n            if (typeof a === 'string' && typeof b === 'string' && a.toLowerCase() === b.toLowerCase()) {\n                return true;\n            }\n            return a == b;\n        });\n        if (args.length == 1) {\n            if (typeof(args[0].calc) !== 'function') {\n                return args[0];\n            }\n            else {\n                return args[0].calc();\n            }\n        }\n    };\n\n    var last_arg;\n    self.push = function(buffer, position_i) {\n        if (buffer) {\n            var v = str_2_val(buffer, formula, position_i);\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};\n","\"use strict\";\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    self.calc = function() {\n        var errorValues = {\n            '#NULL!': 0x00,\n            '#DIV/0!': 0x07,\n            '#VALUE!': 0x0F,\n            '#REF!': 0x17,\n            '#NAME?': 0x1D,\n            '#NUM!': 0x24,\n            '#N/A': 0x2A,\n            '#GETTING_DATA': 0x2B\n        }, result;\n        try {\n            result = user_function.apply(self, self.args.map(f=>f.calc()));\n        } catch (e) {\n            if (user_function.name === 'is_blank'\n                && errorValues[e.message] !== undefined) {\n                // is_blank applied to an error cell doesn't propagate the error\n                result = 0;\n            }\n            else if (user_function.name === 'iserror'\n                && errorValues[e.message] !== undefined) {\n                // iserror applied to an error doesn't propagate the error and returns true\n                result = true;\n            }\n            else {\n                throw e;\n            }\n        }\n        return result;\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","var mathTrig = require('./math-trig');\nvar statistical = require('./statistical');\nvar engineering = require('./engineering');\nvar dateTime = require('./date-time');\n\nfunction set(fn, root) {\n  if (root) {\n    for (var i in root) {\n      fn[i] = root[i];\n    }\n  }\n  return fn;\n}\n\nexports.BETADIST = statistical.BETA.DIST;\nexports.BETAINV = statistical.BETA.INV;\nexports.BINOMDIST = statistical.BINOM.DIST;\nexports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);\nexports.CEILINGMATH = mathTrig.CEILING.MATH;\nexports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;\nexports.CHIDIST = statistical.CHISQ.DIST;\nexports.CHIDISTRT = statistical.CHISQ.DIST.RT;\nexports.CHIINV = statistical.CHISQ.INV;\nexports.CHIINVRT = statistical.CHISQ.INV.RT;\nexports.CHITEST = statistical.CHISQ.TEST;\nexports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);\nexports.COVAR = statistical.COVARIANCE.P;\nexports.COVARIANCEP = statistical.COVARIANCE.P;\nexports.COVARIANCES = statistical.COVARIANCE.S;\nexports.CRITBINOM = statistical.BINOM.INV;\nexports.EXPONDIST = statistical.EXPON.DIST;\nexports.ERFCPRECISE = engineering.ERFC.PRECISE;\nexports.ERFPRECISE = engineering.ERF.PRECISE;\nexports.FDIST = statistical.F.DIST;\nexports.FDISTRT = statistical.F.DIST.RT;\nexports.FINVRT = statistical.F.INV.RT;\nexports.FINV = statistical.F.INV;\n// XW：FLOOR函数修改\n// exports.FLOOR = set(mathTrig.FLOORMATH, mathTrig.FLOOR);//11.5-调用矛盾\nexports.FLOORMATH = mathTrig.FLOORMATH;\nexports.FLOORPRECISE = mathTrig.FLOORPRACE;\n//XW：end\nexports.FTEST = statistical.F.TEST;\nexports.GAMMADIST = statistical.GAMMA.DIST;\nexports.GAMMAINV = statistical.GAMMA.INV;\nexports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;\nexports.HYPGEOMDIST = statistical.HYPGEOM.DIST;\nexports.LOGINV = statistical.LOGNORM.INV;\nexports.LOGNORMINV = statistical.LOGNORM.INV;\nexports.LOGNORMDIST = statistical.LOGNORM.DIST;\nexports.MODE = set(statistical.MODE.SNGL, statistical.MODE);\nexports.MODEMULT = statistical.MODE.MULT;\nexports.MODESNGL = statistical.MODE.SNGL;\nexports.NEGBINOMDIST = statistical.NEGBINOM.DIST;\nexports.NETWORKDAYSINTL = dateTime.NETWORKDAYSINTL;\nexports.NORMDIST = statistical.NORM.DIST;\nexports.NORMINV = statistical.NORM.INV;\nexports.NORMSDIST = statistical.NORM.S.DIST;\nexports.NORMSINV = statistical.NORM.S.INV;\nexports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);\nexports.PERCENTILEEXC = statistical.PERCENTILE.EXC;\nexports.PERCENTILEINC = statistical.PERCENTILE.INC;\nexports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);\nexports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;\nexports.PERCENTRANKINC = statistical.PERCENTRANK.INC;\nexports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);\nexports.POISSONDIST = statistical.POISSON.DIST;\nexports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);\nexports.QUARTILEEXC = statistical.QUARTILE.EXC;\nexports.QUARTILEINC = statistical.QUARTILE.INC;\nexports.RANK = set(statistical.RANK.EQ, statistical.RANK);\nexports.RANKAVG = statistical.RANK.AVG;\nexports.RANKEQ = statistical.RANK.EQ;\nexports.SKEWP = statistical.SKEW.P;\nexports.STDEV = set(statistical.STDEV.S, statistical.STDEV);\nexports.STDEVP = statistical.STDEV.P;\nexports.STDEVS = statistical.STDEV.S;\nexports.TDIST = statistical.T.DIST;\nexports.TDISTRT = statistical.T.DIST.RT;\nexports.TINV = statistical.T.INV;\nexports.TTEST = statistical.T.TEST;\n// exports.VAR = set(statistical.VAR.S, statistical.VAR);\nexports.VARP = statistical.VAR.P;\nexports.VARS = statistical.VAR.S;\nexports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);\nexports.WEIBULLDIST = statistical.WEIBULL.DIST;\nexports.WORKDAYINTL = dateTime.WORKDAYINTL;\nexports.ZTEST = statistical.Z.TEST;\n//XW: _XLFN开头函数处理\nexports._XLFN = set(mathTrig.FLOOR.MATH, statistical.COVARIANCE.P, statistical.NORM.INV, statistical.VAR.P)\n// exports._XLFN.FLOOR = mathTrig.FLOOR\n// exports._XLFN.COVARIANCE = statistical.COVARIANCE\n// exports._XLFN.NORM = statistical.NORM\n// exports._XLFN.VAR = statistical.VAR\n//XW：end","var defaultOperator = '=';\nvar validSymbols = ['>', '>=', '<', '<=', '=', '<>'];\nvar TOKEN_TYPE_OPERATOR = 'operator';\nvar TOKEN_TYPE_LITERAL = 'literal';\nvar SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];\n\nexports.TOKEN_TYPE_OPERATOR = TOKEN_TYPE_OPERATOR;\nexports.TOKEN_TYPE_LITERAL = TOKEN_TYPE_LITERAL;\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @return {Object}\n */\nfunction createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type);\n  }\n\n  return {\n    value: value,\n    type: type,\n  };\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @return {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);\n  }\n\n  return value;\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @return {String[]}\n */\nfunction tokenizeExpression(expression) {\n  var expressionLength = expression.length;\n  var tokens = [];\n  var cursorIndex = 0;\n  var processedValue = '';\n  var processedSymbol = '';\n\n  while (cursorIndex < expressionLength) {\n    var char = expression.charAt(cursorIndex);\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char;\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue);\n          processedValue = '';\n        }\n        break;\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol);\n          processedSymbol = '';\n        }\n\n        processedValue = processedValue + char;\n        break;\n    }\n    cursorIndex++;\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue);\n  }\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol);\n  }\n\n  return tokens;\n};\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @return {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  var literalValue = '';\n  var analyzedTokens = [];\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));\n    } else {\n      literalValue += token;\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));\n  }\n\n  return analyzedTokens;\n};\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @return {Boolean}\n */\nfunction computeExpression(tokens) {\n  var values = [];\n  var operator;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value;\n        break;\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value);\n        break;\n    }\n  }\n\n  return evaluate(values, operator);\n};\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @return {Boolean}\n */\nfunction evaluate(values, operator) {\n  var result = false;\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1];\n      break;\n    case '>=':\n      result = values[0] >= values[1];\n      break;\n    case '<':\n      result = values[0] < values[1];\n      break;\n    case '<=':\n      result = values[0] <= values[1];\n      break;\n    case '=':\n      result = values[0] == values[1];\n      break;\n    case '<>':\n      result = values[0] != values[1];\n      break;\n  }\n\n  return result;\n}\n\nexports.parse = function(expression) {\n  return analyzeTokens(tokenizeExpression(expression));\n};\nexports.createToken = createToken;\nexports.compute = computeExpression;","var error = require('./error');\nvar stats = require('./statistical');\nvar maths = require('./math-trig');\nvar utils = require('./utils');\n\nfunction compact(array) {\n  if (!array) { return array; }\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    if (!array[i]) { continue; }\n    result.push(array[i]);\n  }\n  return result;\n}\n\nexports.FINDFIELD = function(database, title) {\n  var index = null;\n  for (var i = 0; i < database.length; i++) {\n    if (database[i][0] === title) {\n      index = i;\n      break;\n    }\n  }\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value;\n  }\n  return index;\n};\n\n//XW: 重写函数\nfunction find_result_idx(database, criteria){\n  var valid_arr = []\n  var filter_arr = []\n  for (var i=0; i < criteria[0].length; i++) {\n    filter_arr.push(criteria[0][i])\n  }\n  for (var i=1; i < criteria.length; i++){\n    var arr = criteria[i]\n    var valid_str = []\n    for (var j=0; j < filter_arr.length; j++){\n      if (arr[j] != null){\n        valid_str.push(database[0].indexOf(criteria[0][j]) + '-' + arr[j])\n      }\n    }\n    valid_arr.push(valid_str)\n  }\n  var result_idx = []\n  for (var i=1; i < database.length; i++){\n    var data = database[i]\n    for(var j=0;j<valid_arr.length;j++){\n      var is_valid = true\n      for(var k=0;k<valid_arr[j].length;k++){\n        var a = data[parseInt(valid_arr[j][k].split('-')[0])]\n        var b = valid_arr[j][k].split('-')[1]\n        if (b.indexOf('=') >= 0){\n          is_valid = (a == b.replace('=', ''))\n        }else if(!eval(a+b)){\n          is_valid = false\n        }\n      }\n      if(is_valid){\n        result_idx.push(i)\n      }\n    }\n  }\n  return result_idx\n}\nfunction get_values(resultIndexes, database, field){\n  if (typeof field == 'number'){\n    var field_idx = field - 1\n  }else{\n    var field_idx = database[0].indexOf(field)\n  }\n  var values= []\n  for (var i=0; i< resultIndexes.length; i++){\n    values.push(database[resultIndexes[i]][field_idx])\n  }\n  return values\n}\n// Database functions\nexports.DAVERAGE = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  if (typeof field == 'number'){\n    var resultIndexes = [];\n    for (var i=1;i<database.length;i++){\n      resultIndexes.push(i)\n    }\n  }else{\n    var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  var sum = 0\n  for (var i=0; i < targetValues.length; i++){\n    sum += targetValues[i]\n  }\n  return resultIndexes.length === 0 ? error.div0 : sum / targetValues.length;\n};\nexports.DCOUNT = function(database, field, criteria) {\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNT(targetValues);\n};\n\nexports.DCOUNTA = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNTA(targetValues);\n};\n\nexports.DGET = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  if (resultIndexes.length > 1){\n    return error.num\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  return targetValues[0];\n};\n\nexports.DMAX = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var max = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] > max){\n      max = targetValues[i]\n    }\n  }\n  return max\n};\n\nexports.DMIN = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var min = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] < min){\n      min = targetValues[i]\n    }\n  }\n  return min\n};\n\nexports.DPRODUCT = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var result = 1;\n  for (var i=0; i < targetValues.length; i++){\n    result *= targetValues[i]\n  }\n  return result;\n};\n\nexports.DSTDEV = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.S(targetValues);\n};\n\nexports.DSTDEVP = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.P(targetValues);\n};\n\nexports.DSUM = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return maths.SUM(targetValues);\n};\n\nexports.DVAR = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.S(targetValues);\n};\n\nexports.DVARP = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.P(targetValues);\n};\n//XW：end\n","var error = require('./error');\nvar utils = require('./utils');\nvar information = require('./information');\n\nexports.AND = function() {\n  var args = utils.flatten(arguments);\n  var result = true;\n  for (var i = 0; i < args.length; i++) {\n    if (!args[i]) {\n      result = false;\n    }\n  }\n  return result;\n};\n\nexports.CHOOSE = function() {\n  if (arguments.length < 2) {\n    return error.na;\n  }\n\n  var index = arguments[0];\n  if (index < 1 || index > 254) {\n    return error.value;\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value;\n  }\n\n  return arguments[index];\n};\n\nexports.FALSE = function() {\n  return false;\n};\n\nexports.IF = function(test, then_value, otherwise_value) {\n  return test ? then_value : otherwise_value;\n};\n\nexports.IFERROR = function(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError;\n  }\n  return value;\n};\n\nexports.IFNA = function(value, value_if_na) {\n  return value === error.na ? value_if_na : value;\n};\n\nexports.NOT = function(logical) {\n  return !logical;\n};\n\nexports.OR = function() {\n  var args = utils.flatten(arguments);\n  var result = false;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result = true;\n    }\n  }\n  return result;\n};\n\nexports.TRUE = function() {\n  return true;\n};\n\nexports.XOR = function() {\n  var args = utils.flatten(arguments);\n  var result = 0;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result++;\n    }\n  }\n  return (Math.floor(Math.abs(result)) & 1) ? true : false;\n};\n\nexports.SWITCH = function () {\n  var result;\n  if (arguments.length > 0) {\n    var targetValue = arguments[0];\n    var argc = arguments.length - 1;\n    var switchCount = Math.floor(argc / 2);\n    var switchSatisfied = false;\n    var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n    if (switchCount) {\n      for (var index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2];\n          switchSatisfied = true;\n          break;\n        }\n      }\n    }\n\n    if (!switchSatisfied && defaultClause) {\n      result = defaultClause;\n    }\n  }\n  if (result == undefined){\n    return error.na\n  }\n  return result;\n};\n","var error = require('./error');\nvar dateTime = require('./date-time');\nvar utils = require('./utils');\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime());\n}\n\nfunction ensureDate(d) {\n  return (d instanceof Date)?d:new Date(d);\n}\n\nexports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\n  if (typeof issue=='string'){\n    issue = utils.parseDate(issue)\n  }\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    first = utils.ExcelDateToJSDate(first);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value;\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n};\n\n// XW: ACCRINTM函数\nexports.ACCRINTM = function(issue, settlement, rate, par, basis) {\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  var result = par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n  if (isNaN(result)){\n    return error.value;\n  }else{\n    return result\n  }\n};\n//XW: end\n\n// TODO\n//XW: 待实现\nexports.AMORDEGRC = function (cost, date_purchased, first_period, salvage, period, rate, basis) {\n  if (!validDate(issue) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n};\n\n// TODO\nexports.AMORLINC = function() {\n throw new Error('AMORLINC is not implemented');\n};\n\n// TODO\nexports.COUPDAYBS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement >= maturity) {\n    return error.num;\n  }\n};\n\nexports.COUPDAYS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPDAYSNC = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.numerror.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNUM = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPPCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n//XW：end\n\nexports.CUMIPMT = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  // Requires exports.FV() and exports.PMT() from exports.js [http://stoic.com/exports/]\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative interest\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var interest = 0;\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value;\n      start++;\n    }\n  }\n\n  for (var i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n    } else {\n      interest += exports.FV(rate, i - 1, payment, value, 0);\n    }\n  }\n  interest *= rate;\n\n  // Return cumulative interest\n  return interest;\n};\n\nexports.CUMPRINC = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative principal\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var principal = 0;\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate;\n    } else {\n      principal = payment;\n    }\n    start++;\n  }\n  for (var i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n    } else {\n      principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n    }\n  }\n\n  // Return cumulative principal\n  return principal;\n};\n\nexports.DB = function(cost, salvage, life, period, month) {\n  // Initialize month\n  month = (month === undefined) ? 12 : month;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  month = utils.parseNumber(month);\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num;\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Rate is rounded to three decimals places\n  var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\n\n  // Compute initial depreciation\n  var initial = cost * rate * month / 12;\n\n  // Compute total depreciation\n  var total = initial;\n  var current = 0;\n  var ceiling = (period === life) ? life - 1 : period;\n  for (var i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate;\n    total += current;\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial;\n  } else if (period === life) {\n    // Last period\n    return (cost - total) * rate;\n  } else {\n    return current;\n  }\n};\n\nexports.DDB = function(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = (factor === undefined) ? 2 : factor;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  factor = utils.parseNumber(factor);\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Compute depreciation\n  var total = 0;\n  var current = 0;\n  for (var i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\n    total += current;\n  }\n\n  // Return depreciation\n  return current;\n};\n\n// TODO\nexports.DISC = function (settlement,maturity,pr,redemption,basis) {\n  if (pr<=0 || redemption<=0){\n    return error.num\n  }\n  if (basis<0 || basis >4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 360\n  var DSM = Math.abs(dateTime.DAYS(maturity, settlement, false))\n  return (redemption-pr)/pr * B /DSM\n};\n\nexports.DOLLARDE = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\n\n  // Round result\n  var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n  result = Math.round(result * power) / power;\n\n  // Return converted dollar price\n  return result;\n};\n\nexports.DOLLARFR = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\n\n  // Return converted dollar price\n  return result;\n};\n\n// TODO\n//XW：待实现\nexports.DURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n};\n//XW：end\n\nexports.EFFECT = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1;\n};\n\nexports.FV = function(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  value = value || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  value = utils.parseNumber(value);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value;\n  }\n\n  // Return future value\n  var result;\n  if (rate === 0) {\n    result = value + payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = value * term + payment * (1 + rate) * (term - 1) / rate;\n    } else {\n      result = value * term + payment * (term - 1) / rate;\n    }\n  }\n  return -result;\n};\n\nexports.FVSCHEDULE = function (principal, schedule) {\n  principal = utils.parseNumber(principal);\n  if (typeof schedule === 'string'){\n    schedule = utils.strToMatrix(schedule)\n  }\n  schedule = utils.parseNumberArray(utils.flatten(schedule));\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value;\n  }\n\n  var n = schedule.length;\n  var future = principal;\n\n  // Apply all interests in schedule\n  for (var i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i];\n  }\n\n  // Return future value\n  return future;\n};\n\n// XW：INTRATE实现\nexports.INTRATE = function (settlement, maturity, investment, redemption, basis) {\n  //https://support.office.com/zh-cn/article/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f\n  if (investment<=0 || redemption<=0){\n    return error.value\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 1//一年之中的天数，取决于年基准数。\n  var DIM = 2// 结算日与到期日之间的天数。\n  return (redemption-investment)/investment *(B/DIM)\n};\n//XW：end\n\nexports.IPMT = function(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Compute payment\n  var payment = exports.PMT(rate, periods, present, future, type);\n\n  // Compute interest\n  var interest;\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0;\n    } else {\n      interest = -present;\n    }\n  } else {\n    if (type === 1) {\n      interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n    } else {\n      interest = exports.FV(rate, period - 1, payment, present, 0);\n    }\n  }\n\n  // Return interest\n  return interest * rate;\n};\n\nexports.IRR = function(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  guess = guess || 0;\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = (dates[i] - dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  var dates = [];\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = (guess === undefined) ? 0.1 : guess;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.ISPMT = function(rate, period, periods, value) {\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value;\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1);\n};\n\n// XW：待实现\nexports.MDURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  if (coupon < 0 || yld < 0){\n    return error.num\n  }\n  if (basis < 0 || basis > 4){\n    return error.num\n  }\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n};\n//xW:end\n\nexports.MIRR = function(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values));\n  finance_rate = utils.parseNumber(finance_rate);\n  reinvest_rate = utils.parseNumber(reinvest_rate);\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value;\n  }\n\n  // Initialize number of values\n  var n = values.length;\n\n  // Lookup payments (negative values) and incomes (positive values)\n  var payments = [];\n  var incomes = [];\n  for (var i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i]);\n    } else {\n      incomes.push(values[i]);\n    }\n  }\n\n  // Return modified internal rate of return\n  var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n  var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n  return Math.pow(num / den, 1 / (n - 1)) - 1;\n};\n\nexports.NOMINAL = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n};\n\nexports.NPER = function(rate, payment, present, future, type) {\n  type = (type === undefined) ? 0 : type;\n  future = (future === undefined) ? 0 : future;\n\n  rate = utils.parseNumber(rate);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value;\n  }\n\n  // Return number of periods\n  var num = payment * (1 + rate * type) - future * rate;\n  var den = (present * rate + payment * (1 + rate * type));\n  return Math.log(num / den) / Math.log(1 + rate);\n};\n\nexports.NPV = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n\n  // Lookup rate\n  var rate = args[0];\n\n  // Initialize net present value\n  var value = 0;\n\n  // Loop on all values\n  for (var j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j);\n  }\n\n  // Return net present value\n  return value;\n};\n\n// XW:待实现\nexports.ODDFPRICE = function() {\n throw new Error('ODDFPRICE is not implemented');\n};\n\n// TODO\nexports.ODDFYIELD = function() {\n throw new Error('ODDFYIELD is not implemented');\n};\n\n// TODO\nexports.ODDLPRICE = function() {\n throw new Error('ODDLPRICE is not implemented');\n};\n\n// TODO\nexports.ODDLYIELD = function() {\n throw new Error('ODDLYIELD is not implemented');\n};\n//XW：end\nexports.PDURATION = function(rate, present, future) {\n  rate = utils.parseNumber(rate);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num;\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n};\n\nexports.PMT = function(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Return payment\n  var result;\n  if (rate === 0) {\n    result = (present + future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n    } else {\n      result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n    }\n  }\n  return -result;\n};\n\nexports.PPMT = function(rate, period, periods, present, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n};\n//XW：函数实现\nexports.PRICE = function (settlement, maturity, rate, yld, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEDISC = function (settlement, maturity, discount, redemption, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEMAT = function (settlement, maturity, issue, rate, yld, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  issue = utils.parseDate(issue);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var dsm = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  var dim = Math.abs(dateTime.DAYS(maturity, issue, false))\n  var B = 360\n  var A = Math.abs(dateTime.DAYS(issue, settlement, false))\n  var result = (100 + ((dim/B)*rate*100))/(1+(dsm/B)*yld)-(A/B)*rate*100\n  return result\n};\n//XW：end\nexports.PV = function(rate, periods, payment, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value;\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future;\n  } else {\n    return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n  }\n};\n\nexports.RATE = function(periods, payment, present, future, type, guess) {\n  // Credits: rabugento\n\n  guess = (guess === undefined) ? 0.01 : guess;\n  future = (future === undefined) ? 0 : future;\n  type = (type === undefined) ? 0 : type;\n\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value;\n  }\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-6;\n\n  // Set maximum number of iterations\n  var iterMax = 100;\n  var iter = 0;\n  var close = false;\n  var rate = guess;\n\n  while (iter < iterMax && !close) {\n    var t1 = Math.pow(rate + 1, periods);\n    var t2 = Math.pow(rate + 1, periods - 1);\n\n    var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n    var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\n    var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n\n    var newRate = rate - f1 / (f2 + f3);\n\n    if (Math.abs(newRate - rate) < epsMax) close = true;\n    iter++\n    rate = newRate;\n  }\n\n  if (!close) return Number.NaN + rate;\n  return rate;\n};\n//XW：函数实现\nexports.RECEIVED = function (settlement, maturity, investment, discount, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (investment <= 0 || discount <= 0){\n    return error.na\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return investment/(1-(discount*day/360))\n};\n//XW：end\n\nexports.RRI = function(periods, present, future) {\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value;\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num;\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1;\n};\n\nexports.SLN = function(cost, salvage, life) {\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life;\n};\n\nexports.SYD = function(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num;\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10);\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\n};\n\nexports.TBILLEQ = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));\n};\n\nexports.TBILLPRICE = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);\n};\n\nexports.TBILLYIELD = function(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  price = utils.parseNumber(price);\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value;\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));\n};\n\n// XW：待实现\nexports.VDB = function() {\n throw new Error('VDB is not implemented');\n};\n//XW：end\n\n\nexports.XIRR = function(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = dateTime.DAYS(dates[i], dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Check that values contains at least one positive value and one negative value\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.XNPV = function(rate, values, dates) {\n  rate = utils.parseNumber(rate);\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value;\n  }\n\n  var result = 0;\n  for (var i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);\n  }\n  return result;\n};\n\n// XW：待实现\nexports.YIELD = function (settlement, maturity, rate, pr, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if(rate <= 0){\n    return error.num;\n  }\n  // Return error if price is lower than or equal to zero\n  if (pr <= 0) {\n    return error.num;\n  }\n  if (redemption <= 0){\n    return error.num\n  }\n  // Return error if settlement is greater than maturity\n  if (settlement >= maturity  ) {\n    return error.num;\n  }\n  var A = Math.abs(dateTime.DAYS(settlement, maturity, false))\n\n};\n\n\n// TODO\nexports.YIELDDISC = function() {\n throw new Error('YIELDDISC is not implemented');\n};\n\n// TODO\nexports.YIELDMAT = function() {\n throw new Error('YIELDMAT is not implemented');\n};\n//XW：end","var error = require('./error');\nvar utils = require('./utils');\nfunction match_less_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] < lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] > indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\n\nfunction match_exactly_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    lookupValue = lookupValue.replace(/\\?/g, '.');\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1\n        && typeof matrix[idx][0] === 'string') {\n        if (matrix[idx][0].toLowerCase() === lookupValue.toLowerCase()) {\n          return idx + 1;\n        }\n      }\n    } else if (typeof matrix[idx] === 'string') {\n      if (matrix[idx].toLowerCase() === lookupValue.toLowerCase()) {\n        return idx + 1;\n      }\n    }\n\n  }\n  return error.na;\n}\n\nfunction match_exactly_non_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1) {\n        if (matrix[idx][0] === lookupValue) {\n          return idx + 1;\n        }\n      }\n    } else if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    }\n  }\n  //XW:统一错误变量\n  return error.na;\n  //XW：end\n}\n\nfunction match_greater_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] > lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] < indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\nexports.MATCH = function (lookupValue, matrix, matchType) {\n  if (Array.isArray(matrix)\n    && matrix.length === 1\n    && Array.isArray(matrix[0])) {\n    matrix = matrix[0];\n  }\n  if (!lookupValue && !matrix) {\n    return error.na;\n  }\n  if (arguments.length === 2) {\n    matchType = 1;\n  }\n  if (!(matrix instanceof Array)) {\n    return error.na;\n  }\n  if (matchType === 0) {\n    if (typeof lookupValue === 'string') {\n      return match_exactly_string(matrix, lookupValue);\n    } else {\n      return match_exactly_non_string(matrix, lookupValue);\n    }\n  } else if (matchType === 1) {\n    return match_less_than_or_equal(matrix, lookupValue);\n  } else if (matchType === -1) {\n    var a = matrix[0][0]\n    for (var i=1;i<matrix.length;i++){\n      if (matrix[i][0] > a){\n        return error.na;\n      }\n    }\n    return match_greater_than_or_equal(matrix, lookupValue);\n  } else {\n    return error.na;\n  }\n}\n//XW: vlookup函数实现\nexports.VLOOKUP = function (key, matrix, return_index, cumulative) {\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value;\n  }\n  if (cumulative == 'FALSE') {\n    cumulative = false\n  }else{\n    cumulative = true\n  }\n  for (var i = 0; i < matrix.length; i++) {\n    if (matrix[i][0] == key) {\n      return matrix[i][return_index - 1];\n    }\n  }\n  return error.na;\n};\n//XW：end\n\n\n//XW:hlookup函数实现\nexports.HLOOKUP = function (needle, table, index, exactmatch) {\n  if (exactmatch == 'TRUE'){\n    exactmatch = true\n  }\n  if (exactmatch == 'FALSE'){\n    exactmatch = false\n  }\n  if (typeof table == 'string' && table.indexOf('{') >=0){\n    table = utils.strToMatrix(table)\n  }\n  if (typeof needle === \"undefined\" || table[0].indexOf(needle) < 0) {\n    return error.na;\n  }\n\n  index = index || 0;\n  let row = table[0];\n\n  for (let i = 0; i < row.length; i++) {\n    if (exactmatch && row[i] === needle || row[i].toString().toLowerCase().indexOf(needle.toString().toLowerCase()) !== -1) {\n      return index < table.length + 1 ? table[index - 1][i] : table[0][i];\n    }\n  }\n\n  return error.na;\n}\n//XW：end\n","var error = require('./error');\n//XW: 自定义函数\nexports.PQUERY = function () {\n  if (arguments.length !== 5) {\n    return error.error;\n  }\n\n  if (arguments[0].length !== arguments[1].length) {\n    return error.error;\n  }\n\n  if (arguments[1].length !== arguments[3].length) {\n    return error.error;\n  }\n\n  // 计算出绝对值\n  let absArr = [];\n  let o1 = arguments[4];\n  for (let i = 0; i < arguments[3].length; i++) {\n    arguments[3][i] = parseFloat(arguments[3][i]);\n    if (!isNaN(arguments[3][i])) {\n      absArr.push({\n        number: i,\n        value: Math.abs(arguments[3][i] - o1)\n      });\n    }\n  }\n  absArr = absArr.sort((obj1, obj2) => {\n    var val1 = obj1.value;\n    var val2 = obj2.value;\n    if (val1 < val2) {\n      return -1;\n    } else if (val1 > val2) {\n      return 1;\n    } else {\n      return 0;\n    }\n  });\n\n\n  let items = [];\n  let count = 1;\n  for (let i = 0; i < absArr.length; i++) {\n    let {number, value} = absArr[i];\n    let a1 = arguments[0][number][0];\n    let a2 = arguments[1][number][0];\n    let a4 = arguments[3][number];\n\n    if (a2 === arguments[2]) {\n      items.push({\n        number: count,\n        name: a1,\n        city: a2,\n        area: a4,\n        value: value\n      });\n      count = count + 1;\n    }\n  }\n\n  return '*悬浮查看*!' + JSON.stringify(items);\n};\n\nexports.HYPERLINK = function () {\n  console.log(arguments);\n  if (!arguments || !arguments[0] || !arguments[1]) {\n    return error.na;\n  }\n  let url = arguments[0];\n  if (url.substr(0, 7).toLowerCase() == \"http://\" || url.substr(0, 8).toLowerCase() == \"https://\") {\n    url = url;\n  } else {\n    url = \"http://\" + url;\n  }\n\n  let cell = {\n    \"text\": arguments[1],\n    \"url\": url\n  }\n  return \"*HYPERLINK*!\" + JSON.stringify(cell) + \" \";\n}\n\nfunction City(name, type, url) {\n  this.name = name;\n  this.type = type;\n  this.url = url;\n}\n\nfunction lianJiaUrl(lianjia) {\n  lianjia.push(new City(\"合肥\", 0, \"https://hf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"安庆\", 0, \"https://aq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"滁州\", 0, \"https://cz.fang.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"马鞍山\", 0, \"https://mas.lianjia.com/ditu\"));\n  lianjia.push(new City(\"北京\", 0, \"https://bj.lianjia.com/ditu\"));\n  lianjia.push(new City(\"重庆\", 0, \"https://cq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"福州\", 0, \"https://fz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"泉州\", 0, \"https://quanzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"厦门\", 0, \"https://xm.lianjia.com/ditu\"));\n  lianjia.push(new City(\"漳州\", 0, \"https://zhangzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"东莞\", 0, \"https://dg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"佛山\", 0, \"https://fs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"广州\", 0, \"https://gz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"惠州\", 0, \"https://hui.lianjia.com/ditu\"));\n  lianjia.push(new City(\"江门\", 0, \"https://jiangmen.lianjia.com/ditu\"));\n  lianjia.push(new City(\"清远\", 0, \"https://qy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"深圳\", 0, \"https://sz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"珠海\", 0, \"https://zh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湛江\", 0, \"https://zhanjiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"中山\", 0, \"https://zs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"贵阳\", 0, \"https://gy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"北海\", 0, \"https://bh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"防城港\", 0, \"https://fcg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"桂林\", 0, \"https://gl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"柳州\", 0, \"https://liuzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南宁\", 0, \"https://nn.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"兰州\", 0, \"https://lz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"鄂州\", 0, \"https://ez.lianjia.com/ditu\"));\n  lianjia.push(new City(\"黄石\", 0, \"https://huangshi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"武汉\", 0, \"https://wh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"襄阳\", 0, \"https://xy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宜昌\", 0, \"https://yichang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长沙\", 0, \"https://cs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"常德\", 0, \"https://changde.lianjia.com/ditu\"));\n  lianjia.push(new City(\"岳阳\", 0, \"https://yy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"株洲\", 0, \"https://zhuzhou.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保定\", 0, \"https://bd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"廊坊\", 0, \"https://lf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"秦皇岛\", 0, \"https://qhd.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"石家庄\", 0, \"https://sjz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"唐山\", 0, \"https://ts.lianjia.com/ditu\"));\n  lianjia.push(new City(\"张家口\", 0, \"https://zjk.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保亭\", 0, \"https://bt.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"澄迈\", 0, \"https://cm.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"儋州\", 0, \"https://dz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"海口\", 0, \"https://hk.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临高\", 0, \"https://lg.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐东\", 0, \"https://ld.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"陵水\", 0, \"https://ls.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"琼海\", 0, \"https://qh.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"三亚\", 0, \"https://san.lianjia.com/ditu\"));\n  lianjia.push(new City(\"五指山\", 0, \"https://wzs.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"文昌\", 0, \"https://wc.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"万宁\", 0, \"https://wn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"开封\", 0, \"https://kf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"洛阳\", 0, \"https://luoyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"新乡\", 0, \"https://xinxiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"许昌\", 0, \"https://xc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"郑州\", 0, \"https://zz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"哈尔滨\", 0, \"https://kf.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"常州\", 0, \"https://changzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淮安\", 0, \"https://ha.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆山\", 0, \"https://ks.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南京\", 0, \"https://nj.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"南通\", 0, \"https://nt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"苏州\", 0, \"https://su.lianjia.com/ditu\"));\n  lianjia.push(new City(\"无锡\", 0, \"https://wx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"徐州\", 0, \"https://xz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"盐城\", 0, \"https://yc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"镇江\", 0, \"https://zj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长春\", 0, \"https://cc.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"吉林\", 0, \"https://jl.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"赣州\", 0, \"https://ganzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"九江\", 0, \"https://jiujiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"吉安\", 0, \"https://jian.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南昌\", 0, \"https://nc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"上饶\", 0, \"https://sr.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大连\", 0, \"https://dl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"丹东\", 0, \"https://dd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"沈阳\", 0, \"https://sy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"呼和浩特\", 0, \"https://hhht.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"上海\", 0, \"https://sh.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"成都\", 0, \"https://cd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"德阳\", 0, \"https://dy.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"达州\", 0, \"https://dazhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐山\", 0, \"https://leshan.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"凉山\", 0, \"https://liangshan.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绵阳\", 0, \"https://mianyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"眉山\", 0, \"https://ms.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南充\", 0, \"https://nanchong.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"济南\", 0, \"https://jn.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临沂\", 0, \"https://linyi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"青岛\", 0, \"https://qd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"潍坊\", 0, \"https://wf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"威海\", 0, \"https://weihai.lianjia.com/ditu\"));\n  lianjia.push(new City(\"烟台\", 0, \"https://yt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淄博\", 0, \"https://zb.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"宝鸡\", 0, \"https://baoji.lianjia.com/ditu\"));\n  lianjia.push(new City(\"汉中\", 0, \"https://hanzhong.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西安\", 0, \"https://xa.lianjia.com/ditu\"));\n  lianjia.push(new City(\"咸阳\", 0, \"https://xianyang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"晋中\", 0, \"https://jz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"太原\", 0, \"https://ty.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"天津\", 0, \"https://tj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大理\", 0, \"https://dali.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆明\", 0, \"https://km.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西双版纳\", 0, \"https://xsbn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"杭州\", 0, \"https://hz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湖州\", 0, \"https://huzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"嘉兴\", 0, \"https://jx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"金华\", 0, \"https://jh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宁波\", 0, \"https://nb.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绍兴\", 0, \"https://sx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"台州\", 0, \"https://taizhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"温州\", 0, \"https://wz.lianjia.comditu\"));\n}\n\nfunction woaiwojiaUrl(woaiwojia) {\n  woaiwojia.push(new City(\"北京\", 0, \"https://bj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"杭州\", 0, \"https://hz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"青岛\", 0, \"https://qd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"天津\", 0, \"https://tj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"太原\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"郑州\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"成都\", 0, \"https://cd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"长沙\", 0, \"https://cs.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南昌\", 0, \"https://nc.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南京\", 0, \"https://nj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南宁\", 0, \"https://nn.5i5j.com/map\"));\n  woaiwojia.push(new City(\"上海\", 0, \"https://sh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"苏州\", 0, \"https://sz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"武汉\", 0, \"https://wh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"无锡\", 0, \"https://wx.5i5j.com/map\"));\n}\n\nfunction fangtianxiaUrl(fangtianxia) {\n  fangtianxia.push(new City(\"全国\", 0, \"https://www1.fang.com\"));\n}\n\nfunction find(name, arr, str = true) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i].name === name || (typeof name === 'string' && str === false)) {\n      let {url} = arr[i];\n      return url;\n    }\n  }\n\n  return \"城市未找到\";\n}\n\nlet lianjia = [];\nlianJiaUrl(lianjia);\nlet woaiwojia = [];\nwoaiwojiaUrl(woaiwojia);\nlet fangtianxia = [];\nfangtianxiaUrl(fangtianxia);","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    try {\n        var value = cell_ref.calc();\n        if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n            return onerrorvalue.calc();\n        }\n        return value;\n    } catch(e) {\n        return onerrorvalue.calc();\n    }\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition.calc()) {\n        return _then.calc();\n    }\n    else {\n        return _else.calc();\n    }\n}\n\nfunction and() {\n    for (var i = 0; i < arguments.length; i++) {\n        if(!arguments[i].calc()) return false;\n    }\n    return true;\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror,\n    'IF': _if,\n    'AND': and\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst str_2_val = require('./str_2_val.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator { // 这个应该是对重对外暴露的类。\n\n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        this.formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = this.formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(this.formulas[i]);\n            this.expressions.push(exp);\n        }\n        this.calcNames();\n    }\n\n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n\n    getVars() {\n        let vars = {};\n        for (let k in this.variables) {\n            vars[k] = this.variables[k].calc();\n        }\n        return vars;\n    }\n\n    calcNames() {\n        if (!this.workbook || !this.workbook.Workbook || !this.workbook.Workbook.Names) {\n            return;\n        }\n        this.workbook.Workbook.Names.forEach(item => {\n            let val = this.getRef(item.Ref);\n            this.variables[item.Name] = val;\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, item.Name);\n            });\n        });\n    }\n\n    getRef(ref_name) {\n        if (!this.formulas.length) {\n            throw new Error(\"No formula found.\");\n        }\n        let first_formula = this.formulas[0];\n        let formula_ref = first_formula.formula_ref;\n        let formula = {\n            formula_ref: formula_ref,\n            wb: this.workbook,\n            exec_formula: this.exec_formula\n        };\n        return str_2_val(ref_name, formula);\n    }\n\n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n\n    execute() {\n        this.expressions.forEach(exp => {\n            exp.update_cell_value();\n        });\n    }\n}\n\nmodule.exports = Calculator;\n","const checker = require('./formula_check.js');\nconst error = require('./formulajs/lib/error');\nclass CalcCell { // 对cell中的参数做转换，判断,多单元格处理等的类\n  constructor(formulas_i, rows) {\n    this.cell = formulas_i.cell\n    this.rows = rows\n    this.f = formulas_i.cell.f\n    this.name = formulas_i.name\n    this.sheet = formulas_i.sheet\n  }\n\n  //检测是否合法\n  check_valid() {\n    var text = this.f\n    //==A1报错\n    if (text[1] === '='){\n      return error.name\n    }\n    var params = text.match('=[a-z|A-Z]{2,100}')\n    if (params != null && this.f.indexOf('(') <0 && this.f.indexOf(')')<0){\n      return error.name\n    }\n    // 处理\"\" 中\"\"的转义\n    if (this.f.indexOf('\"\"') >= 1 && this.f.indexOf('(') < 0 && this.f.indexOf(')') < 0) {\n      return this.f.slice(2, this.f.length - 1).replace('\"\"', '\"')\n    }\n    return true\n  }\n\n  //{}用''包起来\n  trans_params(fml) {\n    var reg = new RegExp('\\{(.*?)\\}', 'g')\n    var arg = fml.match(reg)\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i]\n        var rep = \"'\" + param + \"'\"\n        fml = fml.replace(param, rep)\n      }\n    }\n    return fml\n  }\n\n  //参数转换\n  trans_formula() {\n    var fml = this.f\n    //去除公式开头结尾的空格\n    fml = checker.strim(fml)\n    //公式参数转换\n    fml = checker.trans_formula(fml)\n    if (fml.indexOf('{') >= 0 && fml.indexOf('}') >= 0 && fml.indexOf(\"'{\") < 0) {// XW: 大括号参数判断\n      fml = this.trans_params(fml)\n    }\n    return fml\n  }\n\n  //将公式还原成原来的样子\n  recover_formula() {\n    return checker.strim(this.f)\n  }\n}\n\nmodule.exports = CalcCell;","var exp = require(\"../core/alphabet\");\nvar error = require('./formulajs/lib/error');\n\n\nfunction isEqual(v1, v2) {\n  v1 = v1 + \"\";\n  v2 = v2 + \"\";\n  v1 = v1.toUpperCase();\n  v2 = v2.toUpperCase();\n  if (v1 === v2) {\n    return true;\n  }\n  return false;\n}\n\nfunction isHave(param) {\n  if (typeof param === \"undefined\") {\n    return false;\n  }\n  if (param === null) {\n    return false;\n  }\n  return true;\n}\nclass CalcWorkBook { // 对workbook处理的类\n  constructor(rows, tileArr) {\n    this.rows = rows\n    this.tileArr = tileArr\n  }\n\n  // 变动数据传入workbook\n  get_workbook(workbook){\n    let {data} = this.rows;\n    let name = data['name']\n    var need_calc_cells = this.tileArr.findAllNeedCalcCell()\n    for (var i=0;i<need_calc_cells.length;i++){\n      var cell_name = need_calc_cells[i]\n      var zb = exp.expr2xy(cell_name)\n      var cell = this.rows.getCell(zb[1], zb[0])\n      if(isHave(cell)){\n        workbook.Sheets[name][cell_name] = {v: cell.text, f: cell.formulas, multivalueRefsCell: cell.multivalueRefsCell, source_v: cell.source_v}\n      }\n    }\n    return workbook\n  }\n\n  //workbook填入rows\n  calcDoneToSetCells(workbook, rows) {\n    let {data} = rows;\n    let name = data['name']\n    var sheet = workbook.Sheets[name]\n    Object.keys(sheet).forEach(i => {\n      let arg = exp.expr2xy(i);\n      if (isHave(sheet[i]) && isHave(sheet[i].v) && isHave(sheet[i].f)) {\n        var cell = rows.getCell(arg[1], arg[0])\n        if (!isHave(cell)){\n          cell = {}\n        }\n        cell.text = sheet[i].v\n        cell.formulas = sheet[i].f\n        cell.multivalueRefsCell = sheet[i].multivalueRefsCell\n        if (isHave(sheet[i].source_v)){\n          cell.source_v = sheet[i].source_v\n        }\n        rows.setCell(arg[1], arg[0], cell);\n      }\n    });\n    rows.workbook = workbook\n  }\n\n  // 判断是否是多值函数的单元格\n  is_muti_cell(formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    if (multivalueRefsCell !== null) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    }\n    return isHave(multivalueRefsCell) ? true : false\n  }\n\n  //一维数组\n  process_arr(){\n\n  }\n\n\n  //二维数组\n  process_matrix(formulas_i, multivalueRefsCell){\n    let enter = true\n    var cell_v = formulas_i.cell.v\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    let cell = \"\", expr = 0;\n    var wb = formulas_i.sheet\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        var v = cell_v[i][j]\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": v,\n            \"f\": formulas_i.cell.f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          var source = this.rows.getCell( cell_y + j,  cell_x + i);\n          if (!isHave(source) || !isHave(source.text) || (isHave(source.text) && (isEqual(source.text, v) || source.text === \"\"))) {\n            wb[c] = {\n              \"v\": cell_v[i][j],\n              \"f\": cell_v[i][j],\n              'multivalueRefsCell': multivalueRefsCell\n            }\n          } else {\n            wb[c] = {\n              \"v\": source.v,\n              \"f\": source.f,\n              'multivalueRefsCell': multivalueRefsCell\n            }\n            enter = false;\n            cell = source;\n            expr = c;\n          }\n        }\n      }\n    }\n    if(!enter) {\n      return this.clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr)\n    }else{\n      return wb\n    }\n  }\n\n\n  //清除二维数组标记\n  clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr){\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": error.ref,\n            \"f\": wb[c].f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else if (expr === c) {\n          wb[c] = {\n            \"v\": cell.text,\n            \"f\": cell.formulas,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n  //如果多值原始单元格发生变动，清除所有该多值函数生成的单元格中的标记\n  clean_all_flag(formulas_i, multivalueRefsCell){\n    var wb = formulas_i.sheet\n    var zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = zb[0]\n    var cell_y = zb[1]\n    var cell = this.rows.getCell(zb[1], zb[0])\n    var cell_v = cell.source_v\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": formulas_i.cell.v,\n            \"f\": formulas_i.cell.f,\n            \"source_v\": \"\"\n          }\n        } else if (this.rows.getCell(cell_y + j, cell_x + i).text !== cell_v[i][j]) {\n          wb[c] = {\n            \"v\": this.rows.getCell(cell_y + j, cell_x + i).text,\n            \"f\": this.rows.getCell(cell_y + j, cell_x + i).formulas,\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n\n  //处理多值函数单元格\n  deal_muti_cell(workbook, formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    let {data} = this.rows;\n    let name = data['name']\n    if (isHave(multivalueRefsCell) && isHave(multivalueRefsCell.multivalueRefsCell)) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    } else {\n      multivalueRefsCell = formulas_i.name;\n    }\n    var cell_v = formulas_i.cell.v\n    if (formulas_i.name !== multivalueRefsCell){\n      if (cell_v instanceof Array){\n        workbook.Sheets[name][formulas_i.name].v = error.ref\n        workbook.Sheets[name][formulas_i.name].source_v = cell_v\n      }else if(isHave(cell_v)){\n        workbook.Sheets[name][formulas_i.name].v = cell_v\n      }\n    }else {\n      if(!(cell_v instanceof Array)) {\n        workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n      }else{\n        var zb = exp.expr2xy(multivalueRefsCell)\n        if (isHave(this.rows.getCell(zb[1], zb[0]).source_v) && this.rows.getCell(zb[1], zb[0]).source_v !== cell_v){\n          workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n        }\n        var len = cell_v.length\n        if (len === 1){\n          workbook.Sheets[name] = this.process_arr(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }else{\n          workbook.Sheets[name] = this.process_matrix(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CalcWorkBook;","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  // isCopy() {\n  //   return this.state === 'copy';\n  // }\n  //\n  // isCut() {\n  //   return this.state === 'cut';\n  // }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    // vlength() {\n    //     const {operator, value} = this;\n    //     if (operator === 'in') {\n    //         return value.length;\n    //     }\n    //     return 0;\n    // }\n\n    getData() {\n\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n\n        this.flex = [];\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.fitlers = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    addFiexRows(args) {\n        this.flex = args;\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSet(exceptRowSet, rir) {\n        for (let ix = 0; ix < this.flex.length; ix++) {\n            let {ri,   set_total, state} = this.flex[ix];\n            for (let i = ri; i < set_total + ri; i++) {\n                console.log(state, \"114\", rir, ri, state);\n                if (state === false && rir === ri) {\n                    exceptRowSet.add(i + 1);\n                    this.flex[ix].state = true;\n                } else if (state === true && rir === ri) {\n                    exceptRowSet.delete(i + 1);\n                    this.flex[ix].state = false;\n                }\n            }\n        }\n\n        return exceptRowSet;\n    }\n\n    includes2(rir, cic) {\n        let b = false;\n\n        for (let i = 0; i < this.flex.length; i++) {\n            let {ri, ci} = this.flex[i];\n            if (rir === ri && cic === ci) {\n                b = true;\n            }\n        }\n\n        return b;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    m[key] = (m[key] || 0) + 1;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  each(cb) {\n      this._.forEach(it => cb(it));\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri >= index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    return this;\n  }\n\n  getData() {\n    return this._.map(merge => merge.toString());\n  }\n}\n\nexport {\n  Merges,\n};\n","import CellRange from \"./cell_range\";\n\nexport default class PasteProxy {\n    constructor() {\n        this.srcCellRange = \"\";\n        this.dstCellRange = \"\";\n        this.srcOneDRange = \"\";\n        this.dstOneDRange = \"\";\n    }\n\n    setSrcAndDstCellRange(srcCellRange, dstCellRange) {\n        this.srcCellRange = srcCellRange;\n        this.dstCellRange = dstCellRange;\n    }\n\n    use() {\n        let {srcCellRange, dstCellRange} = this;\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n\n        return {\n            sri, sci, eri, eci, dsri, dsci, deri, deci, rn, cn, drn, dcn\n        }\n    }\n\n    autoFilterDirection() {\n        let {sri, dsri, deri, eri} = this.use();\n\n        let isLeftRight = false; // 识别方向  上下false、左右true\n        if (sri === dsri && deri === eri) {\n            isLeftRight = true;\n        }\n\n        return isLeftRight;\n    }\n\n    upOrDown() {\n        let {deri, sri, deci, sci,} = this.use();\n        let isDown = true;       // 往上是false, 往下是true     // isDown\n        if (deri < sri || deci < sci) {\n            isDown = false;\n        }\n\n        return isDown;\n    }\n\n    leftOrRight() {\n        let {\n            srcOneDRange,\n            dstOneDRange\n        } = this.getRangeByWay();\n\n        let line = 1;       // 往左往右\n        if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci > srcOneDRange.eci) {\n            line = 2;       // 往右\n        } else if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci < srcOneDRange.eci) {\n            line = 3;       // 往左\n        }\n        return line;\n    }\n\n    getOneDRangeObj(way, offset) {\n        let {sri, sci, eri, eci, dsri, dsci, deri, deci} = this.use();\n\n        if (!way) {\n            this.srcOneDRange = new CellRange(sri, sci + offset, eri, sci + offset);\n            this.dstOneDRange = new CellRange(dsri, dsci + offset, deri, dsci + offset);\n        } else {\n            this.srcOneDRange = new CellRange(sri + offset, sci, sri + offset, eci);\n            this.dstOneDRange = new CellRange(dsri + offset, dsci, dsri + offset, deci);\n        }\n\n        return this.getRangeByWay();\n    }\n\n    getRangeByWay() {\n        return {\n            \"srcOneDRange\": this.srcOneDRange,\n            \"dstOneDRange\": this.dstOneDRange\n        }\n    }\n\n    // todo 什么意思\n    // isCopy(sarr, i) {\n    //     let {sri, sci, eri} = this.use();\n    //     let isCopy = false;\n    //     if (sarr.length > 1) {\n    //         isCopy = true;\n    //     }\n    //     if (sri === eri && sci + i === sci + i) {\n    //         isCopy = true;\n    //     }\n    //\n    //     return isCopy;\n    // }\n\n    calcDiff(sarr, isAdd) {\n        let diffValue = 1;\n\n        if (!isAdd) {\n            diffValue = 1;\n        }\n\n        if (isAdd && sarr.length > 1) {\n            let last2 = sarr[sarr.length - 2];\n            let last1 = sarr[sarr.length - 1];\n            diffValue = last1.text * 1 - last2.text * 1;\n        } else if (sarr.length > 1) {\n            let last2 = sarr[1];\n            let last1 = sarr[0];\n            diffValue = last1.text * 1 - last2.text * 1;\n        }\n\n        if(isNaN(diffValue)) {\n            diffValue = 1;\n        }\n\n        return diffValue;\n    }\n}","import {isHave} from \"../core/helper\";\n\n\n/**\n * Cell类，代表一个单元格的数据格式。\n */\nexport default class Cell {\n    /**\n     * @constructor\n     * @param text - 单元格的文本。\n     * @param formulas - 单元格的公式\n     * @param style - 单元格的样式, 如果为null,则表示是默认样式\n     * @param depend - 其他单元格依赖\n     * @param merge - 为null表示不是合并单元格，否则为一个合并单元格\n     * @param formatText - 单元格的格式，若为null，则表明没有格式\n     * @param multivalueRefsCell - 用来标记多值单元格\n     */\n    constructor() {\n        this.text = \"\";\n        this.depend = [];\n        this.formulas = \"\";\n\n        this.style = null;\n        this.merge = null;\n        this.formatText = null;\n        this.multivalueRefsCell = null;\n        this.source_v = null;\n    }\n\n    /**\n     * 设置单元格信息\n     */\n    setCell(cell) {\n        if (!isHave(cell)) {\n            return;\n        }\n\n        if (isHave(cell.text)) {\n            this.text = cell.text;\n        }\n\n        if (isHave(cell.formulas)) {\n            this.formulas = cell.formulas;\n        }\n\n        if(isHave(cell.formatText)) {\n            this.formatText = cell.formatText;\n        }\n\n        if (isHave(cell.depend)) {\n            this.depend = cell.depend;\n        }\n\n        if (isHave(cell.style)) {\n            this.style = cell.style;\n        }\n\n        if (isHave(cell.multivalueRefsCell)) {\n            this.multivalueRefsCell = cell.multivalueRefsCell;\n        }\n\n        if (isHave(cell.merge)) {\n            this.merge = cell.merge;\n        }\n\n        if (isHave(cell.source_v)) {\n            this.source_v = cell.source_v;\n        }\n    }\n\n    /**\n     * 设置单元格的格式\n     * @param args args.state 为true表示存在格式，为false不存在格式, text 具体格式信息\n     */\n    setFormatText(args) {\n        if(args.state) {\n            this.formatText = args.text;\n        }\n    }\n}","var exp = require(\"../core/alphabet\");\nconst helper = require(\"../core/helper\");\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};\n\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  // setStyle(ci, style) {\n  //   const col = this.getOrNew(ci);\n  //   col.style = style;\n  // }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport {\n  Cols,\n};\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport {\n  Validations,\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","/* global window */\nimport {h} from './element';\nimport {mouseMoveUp} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Resizer {\n    constructor(vertical = false, minDistance) {\n        this.moving = false;\n        this.vertical = vertical;\n        this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n            this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n                .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n            this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n        ).hide();\n        // cell rect\n        this.cRect = null;\n        this.finishedFn = null;\n        this.minDistance = minDistance;\n    }\n\n    // rect : {top, left, width, height}\n    // line : {width, height}\n    show(rect, line) {\n        const {\n            moving, vertical, hoverEl, lineEl, el,\n        } = this;\n        if (moving) return;\n        this.cRect = rect;\n        const {\n            left, top, width, height,\n        } = rect;\n        el.offset({\n            left: vertical ? left + width - 5 : left,\n            top: vertical ? top : top + height - 5,\n        }).show();\n        hoverEl.offset({\n            width: vertical ? 5 : width,\n            height: vertical ? height : 5,\n        });\n        lineEl.offset({\n            width: vertical ? 0 : line.width,\n            height: vertical ? line.height : 0,\n        });\n    }\n\n    hide() {\n        this.el.offset({\n            left: 0,\n            top: 0,\n        }).hide();\n    }\n\n    mousedownHandler(evt) {\n        let startEvt = evt;\n        const {\n            el, lineEl, cRect, vertical, minDistance,\n        } = this;\n        let distance = vertical ? cRect.width : cRect.height;\n        // console.log('distance:', distance);\n        lineEl.show();\n        mouseMoveUp(window, (e) => {\n            this.moving = true;\n            if (startEvt !== null && e.buttons === 1) {\n                // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n                if (vertical) {\n                    distance += e.movementX;\n                    if (distance > minDistance) {\n                        el.css('left', `${cRect.left + distance}px`);\n                    }\n                } else {\n                    distance += e.movementY;\n                    if (distance > minDistance) {\n                        el.css('top', `${cRect.top + distance}px`);\n                    }\n                }\n                startEvt = e;\n            }\n        }, () => {\n            startEvt = null;\n            lineEl.hide();\n            this.moving = false;\n            this.hide();\n            if (this.finishedFn) {\n                if (distance < minDistance) distance = minDistance;\n                this.finishedFn(cRect, distance);\n            }\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n// import {moveArr} from \"../event/paste\";\n\nexport default class Scrollbar {\n    constructor(vertical) {\n        this.vertical = vertical;\n        this.moveFn = null;\n        this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n            .child(this.contentEl = h('div', ''))\n            .on('mousemove.stop', () => {\n            })\n            .on('scroll.stop', (evt) => {\n                let {scrollTop, scrollLeft} = evt.target;\n                // scrollTop = scrollTop * 2;\n                // moveArr.call(this.sheet, scrollTop, scrollLeft);\n                if (this.moveFn) {\n                    this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n                }\n\n                // console.log('evt:::', evt);\n            });\n    }\n\n    move(v) {\n        // debugger\n        this.el.scroll(v);\n        return this;\n    }\n\n    scroll() {\n        return this.el.scroll();\n    }\n\n    set(distance, contentDistance) {\n        const d = distance - 1;\n        // console.log('distance:', distance, ', contentDistance:', contentDistance);\n        if (contentDistance > d) {\n            const cssKey = this.vertical ? 'height' : 'width';\n            this.el.css(cssKey, `${d - 15}px`).show();\n            this.contentEl\n                .css(this.vertical ? 'width' : 'height', '1px')\n                .css(cssKey, `${contentDistance}px`);\n        } else {\n            this.el.hide();\n        }\n        return this;\n    }\n}\n","import {CellRange} from \"../core/cell_range\";\nimport {cssPrefix} from \"../config\";\nimport {h} from \"./element\";\nimport {selectorHeightBorderWidth} from \"./selector\";\n\nexport default class SelectorCell {\n    constructor(data) {\n        this.el = h('div', `${cssPrefix}-selector-cell`);\n        this.data = data;\n        this._ = new CellRange(0, 0, 0, 0);\n    }\n\n    resetSelectOffset() {\n        let rect = this.data.getRect(this._);\n        this.setOffset(rect);\n    }\n\n    setData(ri, ci) {\n        ri = ri === -1 ? 0 : ri;\n        ci = ci === -1 ? 0 : ci;\n\n        let {data} = this;\n        let {merges} = data;\n\n        let enter = false;\n        merges.each(range => {\n            if (range.includeByRiCi(ri, ci)) {\n                this._ = range;\n                enter = true;\n            }\n        });\n\n        if (!enter) {\n            this._ = new CellRange(ri, ci, ri, ci);\n        }\n    }\n\n    toolbarChangeSelectorCell() {\n        let ri = this._.sri;\n        let ci = this._.sci;\n\n        this.setData(ri, ci);\n    }\n\n    setOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.el.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n}\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\nimport {\n    cutting,\n    cuttingByPos,\n    cuttingByPos2,\n    cuttingByPosEnd,\n    deepCopy,\n    isAbsoluteValue,\n    operation\n} from '../core/operator';\nimport SuggestContent from './suggest_content';\nimport {findBracket, suggestContent} from './formula_editor';\nimport {createEvent} from './event';\nimport EditorText from \"./editor_text\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n\nfunction resetTextareaSize() {\n    const {\n        textlineEl, textEl, areaOffset,\n    } = this;\n    if (!areaOffset) {\n        return;\n    }\n    const tlineWidth = textlineEl.offset().width + 9 + 15;\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\n    if (tlineWidth > areaOffset.width && areaOffset.width !== 0) {\n        let twidth = tlineWidth;\n        if (tlineWidth > maxWidth) {\n            twidth = maxWidth - 15;\n            let h1 = parseInt(tlineWidth / (maxWidth - 15), 10);\n            h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            h1 *= this.rowHeight;\n            if (h1 > areaOffset.height) {\n                textEl.css('height', `${h1}px`);\n            }\n        }\n        textEl.css('width', `${twidth}px`);\n    }\n}\n\nfunction textFormat(e) {\n    e.preventDefault();\n    let text = \"\";\n    let clp = (e.originalEvent || e).clipboardData;\n    if (clp === undefined || clp === null) {\n        text = window.clipboardData.getData('text') || '';\n        if (text !== '') {\n            if (window.getSelection) {\n                let newNode = document.createElement('span');\n                newNode.innerHTML = text;\n                window.getSelection().getRangeAt(0).insertNode(newNode)\n            } else {\n                document.selection.createRange().pasteHTML(text)\n            }\n        }\n    } else {\n        text = clp.getData('text/plain') || '';\n        if (text !== '') {\n            document.execCommand('insertText', false, text)\n        }\n    }\n}\n\nconst getCursortPosition = function () {\n    let selection = window.getSelection();\n    if (selection.rangeCount <= 0) {\n        return 0;\n    }\n    const range = window.getSelection().getRangeAt(0);\n    const preSelectionRange = range.cloneRange();\n    preSelectionRange.selectNodeContents(this.textEl.el);\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n    const start = preSelectionRange.toString().length;\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    const {exist, left, right} = findBracket(start - 1, cutting(inputText), inputText);\n    Object.keys(this.spanArr).forEach((i) => {\n        this.spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n    });\n    const spanLeft = this.spanArr[left];\n    const spanRight = this.spanArr[right];\n    this.suggestContent.hide();\n    if (exist && spanLeft && spanRight) {\n        spanLeft.css('background-color', 'rgb(229, 229, 229)');\n        spanRight.css('background-color', 'rgb(229, 229, 229)');\n    } else {\n        const {show} = this.suggest;\n        const content = suggestContent.call(this, start, cutting(inputText), inputText);\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        }\n    }\n\n    return start;\n};\n\nfunction set_focus(el) {\n    if (!this) {\n        return;\n    }\n    const savedSel = {\n        start: this.pos,\n        end: this.pos,\n    };\n    let charIndex = 0;\n    const\n        range = document.createRange();\n    range.setStart(el, 0);\n    range.collapse(true);\n    const nodeStack = [el];\n    let node;\n    let foundStart = false;\n    let\n        stop = false;\n\n    while (!stop && (node = nodeStack.pop())) {\n        if (node.nodeType === 3) {\n            const nextCharIndex = charIndex + node.length;\n            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\n                range.setStart(node, savedSel.start - charIndex);\n                foundStart = true;\n            }\n            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\n                range.setEnd(node, savedSel.end - charIndex);\n                stop = true;\n            }\n            charIndex = nextCharIndex;\n        } else {\n            let i = node.childNodes.length;\n            while (i--) {\n                nodeStack.push(node.childNodes[i]);\n            }\n        }\n    }\n\n    const sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\n// const setCursorPosition = (elem, index) => {\n//     const val = elem.value || elem.textContent;\n//     const len = val.length;\n//\n//     // 超过文本长度直接返回\n//     if (len < index) return;\n//     set_focus.call(this, elem);\n// };\n\nfunction mouseDownEventHandler() {\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    this.pos = getCursortPosition.call(this);\n    parse2.call(this, inputText, this.pos);\n}\n\nfunction setOldCell() {\n    let d = isDisplay.call(this);\n    if (d === false) {\n        let cell = this.data.getCell(this.ri, this.ci);\n        this.editorText.setOldCell(deepCopy(cell), {ri: this.ri, ci: this.ci});\n    }\n}\n\nfunction inputEventHandler(evt, txt = '', formulas = '', state = \"input\") {\n    setOldCell.call(this);\n\n    if (evt) {\n        const {\n            inputType,\n        } = evt;\n\n        if (inputType === 'insertFromPaste' && this.textEl.el.style['caret-color'] !== 'black') {\n            this.copy = true;\n            return;\n        }\n\n        if (inputType === 'historyUndo') {\n            return;\n        }\n    }\n\n\n    let {editorText} = this;\n    // let inputText = editorText.getText();\n\n    // if (inputText === '') {\n    //     const {data} = this;\n    //     const {history} = data;\n    //     history.add(data.getData());\n    // }\n\n    setTimeout(() => {\n        if (this.chinese === false) return;\n        let v = '';\n        if (this.data.settings.showEditor) {\n            this.sheet.selector.hide();\n        } else {\n            return;\n        }\n\n        if (txt === '' && evt && evt.target && evt.target.childNodes) {\n            let t1 = '';\n            for (let i = 0, len = evt.target.childNodes.length; i < len; i++) {\n                if (evt.target.childNodes[i].nodeType === 1) {\n                    v += evt.target.childNodes[i].innerText;\n                } else if (evt.target.childNodes[i].nodeType === 3) {\n                    t1 += evt.target.childNodes[i].nodeValue;\n                }\n            }\n            v = t1 !== '' ? t1 : v;\n        } else if (txt === '' && evt && isHave(evt.data)) {\n            v = evt.data !== '' ? evt.data : v;\n        } else {\n            v = txt;\n        }\n\n        if (this.copy) {\n            this.copy = false;\n            v = (evt && evt.data) ? evt.data : '';\n            this.textEl.html(v);\n            this.pos = v.length;\n            set_focus.call(this, this.textEl.el, -1);\n        }\n        this.changed = true;\n        const {\n            suggest, textlineEl, validator, textEl,\n        } = this;\n        editorText.setText(`${v}`);\n        // inputText = `${v}`;\n        editorText.changeText(1);\n        // inputText = inputText.replace(/，/g, ',');\n        this.pos = getCursortPosition.call(this);\n\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            v = v + \"\";\n            const start = v.lastIndexOf('=');\n            if (this.pos !== -1) {\n                parse2.call(this, v, this.pos);\n            } else parse.call(this, v);\n            let show = false;\n            let cutValue = cuttingByPos2(v, this.pos, true);\n            if (v.length >= this.pos) {\n                const isNumber = `${v[this.pos]}`;\n                if (isNumber.search(/^[0-9]+.?[0-9]*$/) !== -1) {\n                    show = true;\n                } else if (isNumber) {\n                    cutValue += cuttingByPosEnd(v, this.pos + 1);\n                }\n            }\n\n            if (start === 0 && v.length > 1 && cutValue !== '' && !show && cutValue.trim().length > 0) {\n                suggest.search(cutValue);\n            } else {\n                suggest.hide();\n            }\n        }\n\n\n        textlineEl.html(formulas || v);\n        editorText.setText(formulas || v);\n        this.suggest.itemIndex = -1;\n        resetTextareaSize.call(this);\n        if (v && v[0] !== '=') {\n            set_focus.call(this, textEl.el, -1);\n        }\n\n        if (formulas && formulas[0] === '=') {\n            v = formulas;\n        }\n        this.change(state, v);\n        // testValid.call(this);\n        setTimeout(() => {\n            this.show();\n        });\n    });\n\n}\n\nfunction keyDownEventHandler(evt) {\n    this.pos = getCursortPosition.call(this);\n    if (evt.code === 'ArrowRight') {\n        this.pos = this.pos + 1;\n    } else if (evt.code === 'ArrowLeft') {\n        this.pos = this.pos - 1;\n    }\n\n    const keyCode = evt.keyCode || evt.which;\n    // this.textEl.el.style['caret-color'] != 'black' 加这个主要防止用户在没有输入的情况下按下esc\n    if (keyCode === 27 && this.textEl.el.style['caret-color'] === 'black' && this.textEl.el.style.opacity === '1') {\n        this.change('input', '@~esc');\n    } else if (keyCode === 37 || keyCode === 38 || keyCode === 39 || keyCode === 40) {\n    }\n}\n\nfunction parse(v) {\n    const start = v.lastIndexOf('=');\n\n\n    if (start === 0 && v.length >= 1 && operation(v[v.length - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, this.pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction parse2(v, pos) {\n    v = v + \"\";\n    const start = v.lastIndexOf('=');\n    if (start === 0 && v.length >= 1 && operation(v[pos - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length === 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction setTextareaRange() {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        // el.focus();\n        set_focus.call(this, el);\n        // el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text) {\n    const {textEl, textlineEl, tmp} = this;\n    // firefox bug\n    textEl.el.blur();\n    tmp.html(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this);\n}\n\n\nfunction suggestItemClick(it) {\n    const {validator, editorText} = this;\n    let inputText = editorText.getText();\n    if (validator && validator.type === 'list') {\n        // this.inputText = it;\n        inputText = editorText.setText(it);\n    } else {\n        this.pos = getCursortPosition.call(this);\n        const begin = this.pos - cuttingByPos(inputText, this.pos).length;\n        const c = cuttingByPosEnd(inputText, this.pos + 1);\n        const arr = ['', ''];\n        const end = this.pos + c.length;\n        for (let i = 0; i < inputText.length; i++) {\n            if (i < begin) {\n                arr[0] += inputText[i];\n            }\n\n            if (i > end - 1) {\n                arr[1] += inputText[i];\n            }\n        }\n        inputText = editorText.setText(`${arr[0] + it.key}(`);\n        // this.inputText = `${arr[0] + it.key}(`;\n        this.pos = editorText.getText().length;\n        inputText = editorText.setText(inputText + `)${arr[1]}`);\n        // this.inputText += `)${arr[1]}`;\n    }\n    this.textEl.html(inputText);\n    this.textlineEl.html(inputText);\n    this.suggest.hide();\n    parse2.call(this, inputText, this.pos);\n    this.change('input', inputText);\n    set_focus.call(this, this.textEl.el, -1);\n    resetTextareaSize.call(this);\n}\n\nfunction resetSuggestContentItems() {\n    this.suggestContent.hide();\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nfunction isDisplay() {\n    // if (this.textEl.el.style['caret-color'] === 'black'\n    //     && this.textEl.el.style.opacity === '1') return true;\n    return this.textEl.el.style['caret-color'] === 'black'\n        && this.textEl.el.style.opacity === '1';\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight, rowWidth, data, sheet) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.sheet = sheet;\n        this.display = true;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        }, data, this);\n        this.suggestContent = new SuggestContent();\n        this.lock = false;\n        this.state = 1;\n        this.data = data;\n        this.datepicker = new Datepicker();\n        this.isCors = false;\n        this.datepicker.change((d) => {\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.ri = -1;\n        this.ci = -1;\n        this.spanArr = [];\n        this.mousedownIndex = [];\n        this.changed = false;\n        this.chinese = true;\n\n        this.editorText = new EditorText('');\n\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('div', `${cssPrefix}-editor-textEl`)\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('click', () => mouseDownEventHandler.call(this,))\n                    .on('keyup', evt => keyDownEventHandler.call(this, evt))\n                    .on('mousedown', (evt) => {\n                        if (evt.detail === 2) {\n                            if (isDisplay.call(this)) {\n                                return;\n                            }\n                            this.show();\n                            setTimeout(() => {\n                                const {ri, ci} = this;\n                                console.log(ri, ci);\n                                this.setCellEnd(data.getSelectedCellRiCi(ri, ci));\n                            });\n                        }\n                    })\n                    .on('compositionstart', () => {\n                        this.chinese = false;\n                    })\n                    .on('compositionend', ( ) => {\n                        this.chinese = true;\n                    })\n                    .on('paste', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 67, true, \"paste\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('copy', (evt) => {\n                        if (this.textEl.el.style['caret-color'] === 'black') {\n                            // createEvent.call(this, 86, true, \"sheetCopy\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('keydown', (evt) => {\n                        resetTextareaSize.call(this);\n                        this.textlineEl.html(evt.currentTarget.innerText);\n                        const key_num = evt.keyCode;\n                        // ctrl + v 67     ctrl + v  86\n                        if (key_num === 38 || key_num === 40) {\n                            evt.preventDefault();\n                        }\n                        if (key_num === 115) {       // F4\n                            let {inputText, pos} = this.editorText.f4ShortcutKey(getCursortPosition.call(this));\n                            inputEventHandler.call(this, null, inputText, inputText);\n                            setTimeout(() => {\n                                this.pos = pos;\n                                set_focus.call(this, this.textEl.el, -1);\n                            });\n                            return;\n                        }\n                        if (this.textEl.el.style['caret-color'] === 'black') return;\n                        const {\n                            ctrlKey, metaKey,\n                        } = evt;\n\n                        if (key_num === 8 || key_num === 46) {\n                            createEvent.call(this, 8, false);\n                        } else if (key_num === 40) {\n                            this.clear();\n                            createEvent.call(this, 40, false);\n                        } else if (key_num === 39) {\n                            this.clear();\n                            createEvent.call(this, 39, false);\n                        } else if (key_num === 37) {\n                            this.clear();\n                            createEvent.call(this, 37, false);\n                        } else if (key_num === 38) {\n                            this.clear();\n                            createEvent.call(this, 38, false);\n                        } else if (ctrlKey || metaKey) {\n                            if (key_num === 67) {\n                                createEvent.call(this, 67, true);\n                            } else if (key_num === 86) {\n                                createEvent.call(this, 86, true);\n                            } else if (key_num === 88) {\n                                createEvent.call(this, 88, true);\n                            } else if (key_num === 90) {\n                                createEvent.call(this, 90, true);\n                            } else if (key_num === 66) {\n                                createEvent.call(this, 66, true);\n                            }\n                        }\n                    }),\n                this.textlineEl = h('div', 'textline'),\n                this.suggestContent.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n\n        sheet.el.child(this.suggest.el);\n        this.el = h('div', `${cssPrefix}-editor`)\n            .children(this.areaEl);\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.textEl.on('paste', (evt) => {\n            if (isDisplay.call(this) === false)\n                return;\n            textFormat(evt);\n        });\n        this.tmp = h('span', 'span_tmp').hide();\n        this.textEl.attr('contenteditable', 'true');\n        this.textEl.css('width', `${rowWidth - 3}px`);\n        this.textEl.css('height', `${rowHeight - 2}px`);\n        this.textEl.child(this.tmp);\n        this.pos = 0;\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n\n        setTimeout(() => {\n            this.show(false);\n        });\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    setMouseDownIndex(index) {\n        this.mousedownIndex = index;\n    }\n\n    setRiCi(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n        // if (this.ri === -1 || this.ci === -1) {\n        //     return false;\n        // }\n        // const cell = this.data.rows.getCell(ri, ci);\n        //\n        // this.editorText.setOldCell(deepCopy(cell));\n    }\n\n    setLock(lock) {\n        this.lock = lock;\n    }\n\n    getLock() {\n        return this.lock;\n    }\n\n\n    show(off = true) {\n\n        if (off && this.data.settings.showEditor) {\n            this.textEl.css('caret-color', 'black');\n            this.textEl.css('cursor', 'text');\n            this.textEl.css('opacity', '1');\n            this.textEl.el.focus();\n            this.areaEl.css('pointer-events', 'auto');\n            this.areaEl.css('border', '2px solid #4b89ff');\n            this.areaEl.css('background', 'white');\n        } else {\n            this.textEl.css('caret-color', 'white');\n            this.textEl.css('cursor', 'default');\n            this.textEl.css('opacity', '0');\n            this.textEl.el.blur();\n            this.areaEl.css('pointer-events', 'none');\n            this.areaEl.css('background', 'rgba(75, 137, 255, 0)');\n            this.areaEl.css('border', 'none');\n        }\n    }\n\n    parse(pos = -1) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n        if (pos !== -1) {\n            this.pos = getCursortPosition.call(this);\n            parse2.call(this, inputText, this.pos);\n        } else {\n            parse.call(this, inputText);\n        }\n    }\n\n    clear(c = false) {\n\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        this.display = isDisplay.call(this);\n\n        if (inputText !== '' && isNaN(inputText) && inputText.replace(/\\s/g, \"\").lastIndexOf('¥') === 0) {\n            this.change('format', inputText);\n\n        } else if (this.changed) {\n\n            this.change('finish', inputText);\n\n        }\n\n        this.changed = false;\n        this.cell = null;\n        this.areaOffset = null;\n        editorText.setText('');\n        // this.inputText = '';\n        this.show(false);\n        this.copy = false;\n        set_focus.call(this, this.textEl.el, -1);\n        this.pos = 0;\n        this.tmp.hide();\n        this.textEl.html('');\n        this.textlineEl.html('');\n        resetSuggestContentItems.call(this);\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n\n        if (c) {\n            return false;\n        }\n\n        setTimeout(() => {\n            const {ri, ci} = this.data.selector;\n            this.setRiCi(ri, ci);\n        });\n\n        return this.display;\n    }\n\n    mount2span(spanArr, pos = -1, begin = -1, content = {suggestContent: false, cut: '', pos: -1}) {\n        if (this.spanArr === spanArr) {\n            return;\n        }\n\n        const {show} = this.suggest;\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        } else {\n            this.suggestContent.hide();\n        }\n        Object.keys(spanArr).forEach((i) => {\n            spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n        });\n        if (pos !== '-1' && begin !== -1 && spanArr[pos]) {\n            spanArr[pos].css('background-color', '#e5e5e5');\n            spanArr[begin].css('background-color', '#e5e5e5');\n        }\n\n        if (spanArr.length > 0) {\n            this.textEl.html('');\n            this.tmp = h('span', 'span_tmp').children(...spanArr)\n                .css('top', '0px').css('color', 'black').css('font-size', '14px').css('font-family', 'm-inconsolata,monospace,arial,sans,sans-serif');\n            this.textEl.el.insertBefore(this.tmp.el, this.textEl.el.childNodes[0]);\n            // this.textEl.el.removeChild(this.textEl.el.childNodes[this.textEl.el.childNodes.length - 1]);\n            set_focus.call(this, this.textEl.el, -1);\n        }\n\n        this.spanArr = spanArr;\n    }\n\n    handler(text) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        const cursorPos = this.pos;\n        if (cursorPos >= inputText) {\n            this.setMouseDownIndex([]);\n            return;\n        }\n        const textBegin = text.substring(0, cursorPos);\n        const textEnd = text.substring(cursorPos, text.length);\n        parse.call(this, textBegin);\n        if (textEnd !== '') {\n            this.setMouseDownIndex([textBegin, textEnd]);\n        } else {\n            this.setMouseDownIndex([]);\n        }\n    }\n\n    setOffset(offset, suggestPosition = 'top', show = true) {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 2 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            // suggest.setOffset(sOffset);\n            suggest.hide();\n            resetTextareaSize.call(this);\n            if (show) {\n                this.show(false);\n            }\n        }\n    }\n\n    setCellEnd(cell) {\n        let text = '';\n        let formulas = (cell && cell.formulas) || '';\n        if (isHave(cell) && isHave(cell.text)) {\n            text = cell.text;\n        }\n\n        if (isHave(cell) && isHave(cell.formulas)) {\n            text = cell.formulas;\n        }\n\n        let {data} = this;\n        let {rows} = data;\n        const style = data.getCellStyleOrDefault(this.ri, this.ci);\n        let args = data.renderFormat(style, cell, this.ri, this.ci, true);\n        if(args.state) {\n            text = args.cellText;\n            formulas = args.cellText;\n        }\n\n        this.textEl.child(text + \"\");\n        this.pos = text.length;\n        set_focus.call(this, this.textEl.el, -1);\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n\n        testValid.call(this);\n        inputEventHandler.call(this, null, text, formulas, \"end\");\n\n        setTimeout(() => {\n            this.pos = rows.toString(text).length;\n            set_focus.call(this, this.textEl.el, -1);\n        }, 20)\n    }\n\n    setCell(cell, validator, type = 1) {\n        this.cell = cell;\n        this.show();\n\n        let text = (cell && cell.formulas) || '';\n        text = text === '' ? (cell && cell.text) || '' : text;\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.textEl.show();\n        set_focus.call(this, this.textEl.el, -1);\n        setTimeout(() => {\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el);\n        }, 10);\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n\n        if (type === 2 && text !== '' && text[0] === '=') {\n            inputEventHandler.call(this, null, text);\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el, text.length);\n        } else if (type === 2 && text[0] !== '=') {\n            this.textEl.child(text);\n        }\n        setTimeout(() => {\n            this.textlineEl.html(text);\n            resetTextareaSize.call(this);\n        });\n    }\n\n    // inputEventHandler(text = '', pos = 1, hide = false) {\n    //     if (hide) {\n    //         this.areaEl.hide();\n    //         this.sheet.selector.hide();\n    //         this.isCors = true;\n    //     }\n    //     this.setCursorPos(pos);\n    //     inputEventHandler.call(this, null, text);\n    // }\n\n    // isDisplay() {\n    //     let {editorText} = this;\n    //\n    //     return isDisplay.call(this) && editorText.isFormula();\n    // }\n\n    isDisplay2() {\n        return isDisplay.call(this)\n    }\n\n    setCursorPos(pos) {\n        this.pos = pos;\n        set_focus.call(this, this.textEl.el);\n    }\n\n    setText(text) {\n        let {editorText} = this;\n        editorText.setText(text);\n        // this.inputText = text;\n        setText.call(this, text);\n        resetTextareaSize.call(this);\n        this.textEl.child(this.tmp);\n    }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport {calendarPattern, str2Re} from \"../utils/reg_pattern\";\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (str2Re(calendarPattern).test(date)) { // jobs: todo: 正则表达式抽取出来\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'fin-cell-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import {cssPrefix} from \"../config\";\nimport {h} from \"../component/element\";\nimport {helpFormula} from \"../core/operator\";\nimport {bind} from \"./event\";\n\nfunction variableElement(content, txt, pos, className, s = \"\", s2 = \"\") {\n    let item = h('div', className);\n    for (let i = 0; i < content[txt].length; i++) {\n        let ct = content[txt][i];\n        let {name, editor, index} = ct;\n\n        if (pos === i) {\n            item.child(h('span', s).child(name));\n        } else if (editor === true && pos >= index) {\n            item.child(h('span', s).child(name));\n        } else {\n            item.child(h('span', s2).child(name));\n        }\n    }\n\n    return item;\n}\n\nexport default class SuggestContent {\n    constructor(width = \"300px\") {\n        this.el = h('div', `${cssPrefix}-suggest-content`).css('width', width).css('z-index', \"10000\").css('position', \"absolute\").hide();\n        this.el.attr('tabindex', 0);\n        bind(this.el.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n    }\n\n    hide() {\n        const {el} = this;\n        el.hide();\n    }\n\n    content(cut = \"\", pos = -1) {\n        const {el} = this;\n\n        cut = cut.toUpperCase();\n        // cut 找到内容\n        let content = {};\n        Object.keys(helpFormula).forEach(i => {\n            if (i === cut) {\n                content = helpFormula[i];\n            }\n        });\n\n        if (!content || JSON.stringify(content) === '{}') {\n            return;\n        }\n\n        let items = [];\n        let title = variableElement.call(this, content, \"title\", pos, `${cssPrefix}-help-title`, `${cssPrefix}-help-span-title`, `${cssPrefix}-help-span2-title`);\n        let exampleName = h('div', `${cssPrefix}-help-section-title`).child(\"示例\");\n        let example = variableElement.call(this, content, \"example\", pos, `${cssPrefix}-help-section-content`, `${cssPrefix}-help-span3-title`);\n        items.push(...[title, exampleName, example]);\n        Object.keys(content.content).forEach(i => {\n            let c = content.content[i];\n            let item = h('div', `${cssPrefix}-help-section-title`).child(i);\n            let item2 = h('div', `${cssPrefix}-help-section-content`).child(c);\n            items.push(...[item, item2]);\n        });\n\n        el.html('').children(...items).show();\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {lockCells} from \"../component/formula_editor\";\nimport {cuttingByPos} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport SelectorMove from \"./selector_move\";\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nfunction  find(str, cha) {\n    return str.lastIndexOf(cha);\n}\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        // this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this._selector = selector;\n        this.sheet = sheet;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n\n\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.selectorMove = new SelectorMove(this.boxinner, data, sheet, selector);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .child(this.boxinner)\n            .hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    moveEvent(evt) {\n        let {data, _selector, sheet} = this;\n        let _move_selectors = null;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = selector.range;\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let p = -1;\n        mouseMoveUp(window, (e) => {\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'none');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"none\");\n            }\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                let { pos} = this.sheet.editor;\n                let inputText = this.sheet.editor.editorText.getText();\n                let _erpx = cuttingByPos(inputText, pos - 1, true);\n                if (inputText.length > pos - 1) {\n                    _erpx += cuttingByPosEnd(inputText, pos - 1);\n                }\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    let {className, erpx} = selector;\n\n                    if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n                        if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                        p = p !== -1 ? p : find(inputText, selector.erpx);\n                        this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                        if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    }\n                }\n                if (_move_selectors) {\n                    _move_selectors.selector.setCss(_move_selectors.color, false);\n                    lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                }\n            }\n        }, () => {\n            // 加这个的原因是  e.layerX, e.layerY， 如果不加的话 会点到单元格内的 xy坐标进行结算\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'auto');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"all\");\n            }\n            p = -1;\n            if (_move_selectors && _move_selectors.selector)\n                _move_selectors.selector.setCss(_move_selectors.color, true);\n            _move_selectors = null;\n        });\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n        this.selectorMove.l.css(\"pointer-events\", pointer);\n        this.selectorMove.r.css(\"pointer-events\", pointer);\n        this.selectorMove.t.css(\"pointer-events\", pointer);\n        this.selectorMove.b.css(\"pointer-events\", pointer);\n    }\n\n    setCss(b, key = true) {\n        if (!key) {\n            this.areaEl.css(\"border\", `2px solid ${b}`);\n        } else {\n            this.areaEl.css(\"border\", `2px dashed ${b}`);\n        }\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class SelectorCopy {\n    constructor(data, sheet, className) {\n        this.data = data;\n        this.className = className;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n    setCss(b, key = true) {\n        this.br.setCss(b, key);\n        this.t.setCss(b, key);\n        this.l.setCss(b, key);\n        this.tl.setCss(b, key);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    setEnd(ri, ci, moving = true) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    // reset() {\n    //     // console.log('::::', this.data);\n    //     const {eri, eci} = this.data.selector.range;\n    //     this.setEnd(eri, eci);\n    // }\n\n    showAutofill(ri, ci) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        if (scn > 0) {\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (srn > 0) {\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (ecn < 0) {\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (ern < 0) {\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\nimport {cuttingByPos, cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {lockCells} from \"./formula_editor\";\nimport {CellRange} from \"../core/cell_range\";\nimport {mouseMoveUp} from \"./event\";\n\nfunction find(str, cha) {\n\n    return str.lastIndexOf(cha);\n}\n\nexport default class SelectorMove {\n    constructor(boxinner, data, sheet, selector) {\n        this.l = h('div', `${cssPrefix}-selector-box-l-move-l`);\n        this.r = h('div', `${cssPrefix}-selector-box-l-move-r`);\n        this.t = h('div', `${cssPrefix}-selector-box-l-move-t`);\n        this.b = h('div', `${cssPrefix}-selector-box-l-move-b`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n\n        this.event(this.l, 1);\n        this.event(this.r, 2);\n        this.event(this.t, 3);\n        this.event(this.b, 4);\n        this.boxinner = boxinner;\n        this.boxinner.children(\n            this.l,\n            this.r,\n            this.t,\n            this.b,\n        );\n    }\n\n    event(target, dict) {\n        let timer = null;\n        target.on('mousedown.stop', evt => {\n            let {data, sheet, _selector} = this;\n            let p = -1;\n            let {selector} = data;\n            let _move_selectors = null;\n            let {sri, sci, eri, eci, w, h} = selector.range;\n            let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n            let _cellRange = null;\n            let {selectors} = sheet;\n            let msri = -1, msci = -1, meri = -1, meci = -1;\n\n            mouseMoveUp(window, (e) => {\n                clearTimeout(timer);\n                timer = setTimeout(() => {\n                    sheet.container.css('pointer-events', 'none');\n                    for (let i = 0; i < selectors.length; i++) {\n                        let selector = selectors[i];\n                        selector.selector.setBoxinner(\"none\");\n                    }\n\n                    let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n                    if (ri !== -1 && ci !== -1) {\n                        let {pos} = this.sheet.editor;\n                        let inputText = this.sheet.editor.editorText.getText();\n                        let _erpx = cuttingByPos(inputText, pos - 1, true);\n                        if (inputText.length > pos - 1) {\n                            _erpx += cuttingByPosEnd(inputText, pos - 1);\n                        }\n                        for (let i = 0; i < selectors.length; i++) {\n                            let selector = selectors[i];\n                            let {className, erpx} = selector;\n\n                            if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n                                if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    cellRange.move(ri, ci);\n                                    const rect = data.getMoveRect(cellRange);\n                                    _move_selectors.selector.range = cellRange;\n                                    _move_selectors.selector.setMove(rect);\n                                } else {\n                                    _move_selectors.selector.set(ri, ci, true);\n                                }\n                                break;\n                            } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                                p = p !== -1 ? p : find(inputText, selector.erpx);\n                                this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                                if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) !== -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    if (_cellRange === null) {\n                                        _cellRange = cellRange;\n                                    }\n                                    if (dict === 4) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        // console.log(cellRange, _cellRange);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                } else {\n                                    let e1 = expr2xy(selector.erpx);\n                                    let e2 = expr2xy(selector.erpx);\n                                    let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                    if (dict === 4) {\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                }\n                                break;\n                            }\n                        }\n\n                        if (_move_selectors\n                            && (msri !== cellRange.sri\n                                || msci !== cellRange.sci\n                                || meri !== cellRange.eri\n                                || meci !== cellRange.eci)) {\n                            _move_selectors.selector.setCss(_move_selectors.color, false);\n                            lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                        }\n                        msri = cellRange.sri;\n                        msci = cellRange.sci;\n                        meri = cellRange.eri;\n                        meci = cellRange.eci;\n                    }\n                }, 6);\n            }, () => {\n                clearTimeout(timer);\n                let {selectors} = this.sheet;\n                sheet.container.css('pointer-events', 'auto');\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    selector.selector.setBoxinner(\"all\");\n                }\n                p = -1;\n                if (_move_selectors && _move_selectors.selector)\n                    _move_selectors.selector.setCss(_move_selectors.color, true);\n                _move_selectors = null;\n            })\n        });\n    }\n}","import {cuttingByPos, cuttingByPosEnd2, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {toUpperCase} from \"./table\";\n\nexport default class EditorText {\n    constructor() {\n        this.inputText = \"\";\n        this.oldCell = \"\";\n        this.ri = -1;\n        this.ci = -1;\n    }\n\n    setText(text) {\n        this.inputText = text;\n        return this.getText();\n    }\n\n    getText() {\n        return this.inputText;\n    }\n\n    setOldCell(oldCell, {ri = -1, ci = -1} = -1) {\n        this.oldCell = oldCell;\n        this.ri = ri;\n        this.ci = ci;\n        return this.getOldCell();\n    }\n\n    // setRICI(ri, ci) {\n    //    this.ri = ri;\n    //     this.ci = ci;\n    // }\n\n    getOldCell() {\n        return this.oldCell;\n    }\n\n    getRICI() {\n        return {\n            \"ri\": this.ri,\n            \"ci\": this.ci,\n        };\n    }\n\n    changeText(type) {\n        if (type === 1) {\n            this.setText(this.getText().replace(/，/g, ','));\n        }\n    }\n\n    isFormula() {\n        let inputText = this.getText();\n\n        return inputText.lastIndexOf(\"=\") === 0;\n    }\n\n    f4ShortcutKey(pos) {\n        let inputText = this.setText(toUpperCase(this.inputText));\n        let value = cuttingByPos(inputText, pos, true);\n        let value2 = cuttingByPosEnd2(inputText, pos + 1);\n        console.log(value2);\n        let type = isAbsoluteValue(value, 5);\n        let d = \"\";\n        let n = value.split(\":\")[1];\n        if (n) {\n            type = isAbsoluteValue(n, 5);\n            type = type === 3 ? 6 : type;\n            type = type === 12 ? 9 : type;\n            type = type === 1 ? 7 : type;\n            type = type === 2 ? 8 : type;\n            console.log(type);\n        }\n\n        if (type !== false) {\n            switch (type) {\n                case 13:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    let text_b = inputText.substring(0, inputText.lastIndexOf(n));\n                    inputText = this.setText(text_b + d);\n                    break;\n                case 12:\n                    n = value;\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    console.log(value2absolute(value));\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    console.log(this.getText());\n                    break;\n                case 11:\n                case 10:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 9:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 8:\n                    n = value.split(\":\")[1];\n                    d = n.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 7:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 6:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 5:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 4:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 3:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 2:\n                    d = value.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 1:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n            }\n        }\n        let newPos = inputText.length;\n        inputText = this.setText(inputText + value2);\n        return {\n            \"pos\": newPos,\n            \"inputText\": inputText\n        };\n    }\n}\n","import {expr2xy, xy2expr} from './alphabet';\nimport {look, look2} from \"../config\";\n// import XLSX_CALC from \"calc\"\n// var formulajs = require('formulajs');\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgsLen = 1; // A1,A2,A3...\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        // console.log('c:', c);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1) {\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log(operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    if (!subExpr) {\n        subExpr = \"\";\n    }\n    if (subExpr[0] >= '0' && subExpr[0] <= '9') {\n        return Number(subExpr);\n    }\n    if (subExpr[0] === '\"') {\n        return subExpr.substring(1);\n    }\n    const [x, y] = expr2xy(subExpr);\n    return cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        if (srcStack[i] === '+') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) + Number(top));\n        } else if (srcStack[i] === '-') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) - Number(top));\n        } else if (srcStack[i] === '*') {\n            stack.push(Number(stack.pop()) * Number(stack.pop()));\n        } else if (srcStack[i] === '/') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) / Number(top));\n        } else if (Array.isArray(srcStack[i])) {\n            const [formula, len] = srcStack[i];\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(srcStack[i])) {\n                return 0;\n            }\n            cellList.push(srcStack[i]);\n            let s = evalSubExpr(srcStack[i], cellRender);\n            stack.push(evalSubExpr(srcStack[i], cellRender));\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nfunction evalFormula(text, rule) {\n    if (typeof text !== 'string') {\n        return false;\n    }\n    // if (text.toUpperCase().indexOf(rule.toUpperCase()) === -1) {\n    //     return false;\n    // }\n    return text.toUpperCase().indexOf(rule.toUpperCase()) !== -1;\n}\n\nconst cellRender = (data, sheetbook, y, x, src, formulaMap, getCellText, cellList = []) => {\n    if (typeof src === 'undefined') {\n        return \"\";\n    }\n\n    if (typeof src === 'string' && look.indexOf(src.split(\"!\")[0]) !== -1) {\n        let len = src.length;\n        if(src.split(\" \")[0]) {\n            len = src.split(\" \")[0].length;\n        }\n        let a = JSON.parse(src.substring(src.indexOf(\"!\") + 1, len));\n        let s = look.indexOf(src.split(\"!\")[0]);\n\n        if (s === 1) {\n            return a.text;\n        } else if (s === 0) {\n            if (a && a[0]) {\n                let {name, value} = a[0];\n\n                if (value === 0 && a[1] && a[1].value !== 0) {\n                    return name;\n                } else if (value === 0 && !a[1]) {\n                    return name;\n                }\n            }\n        }\n\n        return look2;\n    }\n\n    if (src[0] === '=' && src[1] !== '=') {\n        // console.log(\"156\", sheetbook.Sheets.Sheet1[xy2expr(x, y)], xy2expr(x, y))\n        if (evalFormula(src.substring(1), \"wland\") || evalFormula(src.substring(1), \"wfr\") || evalFormula(src.substring(1), \"rtd\")\n            || evalFormula(src.substring(1), \"city\")) {\n            // let {date_formula} = data.settings;=MD.RTD(\"sina\", \"162411\", \"now\")\n            // date_formula.wland(date_formula, data);\n            return src.toUpperCase();\n        } else if (src.substring(1) && sheetbook && sheetbook.Sheets && sheetbook.Sheets[data.name] && sheetbook.Sheets[data.name][xy2expr(x, y)]) {\n            // sheetbook.Sheets.Sheet1[xy2expr(x, y)].f = src.substring(1).toUpperCase();\n            // XLSX_CALC.import_functions(formulajs);\n            // XLSX_CALC(sheetbook);\n\n            if ((sheetbook.Sheets[data.name][xy2expr(x, y)].f && sheetbook.Sheets[data.name][xy2expr(x, y)].f.search(/\\((\\+|\\-|\\*|\\/)/) !== -1) || sheetbook.Sheets[data.name][xy2expr(x, y)].v === undefined || sheetbook.Sheets[data.name][xy2expr(x, y)].v === \"\") {\n                return \"#ERROR!\";\n            }\n            sheetbook.Sheets[data.name][xy2expr(x, y)].v = sheetbook.Sheets[data.name][xy2expr(x, y)].v + \"\";\n\n            // let value = sheetbook.Sheets.Sheet1[xy2expr(x, y)].v ? sheetbook.Sheets.Sheet1[xy2expr(x, y)].v : \"NaN\";\n            return sheetbook.Sheets[data.name][xy2expr(x, y)].w ? sheetbook.Sheets[data.name][xy2expr(x, y)].w : sheetbook.Sheets[data.name][xy2expr(x, y)].v.replace(/'/g, \"\\\"\");\n        }\n        // const stack = infixExprToSuffixExpr(src.substring(1));\n        // if (stack.length <= 0) return src;\n\n        return src;\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","export const isMinus = (text) => {\n    if(isNaN(text)) {\n        return false;\n    } else if(text === \"\") {\n        return false;\n    }\n\n    // if(parseInt(text) >= 0)\n    //     return false;\n\n    return parseInt(text) < 0;\n};","/* global window */\nimport {isHave} from \"../core/helper\";\n\nfunction dpr() {\n    return window.devicePixelRatio || 1;       // 修改之后\n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    let d = px * dpr() + \"\";\n    return parseInt(d, 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nfunction drawFlexFalse(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nfunction drawFlexTrue(ctx, sx, sy) {\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#707070\";\n    ctx.moveTo(sx + 6, sy);\n    ctx.lineTo(sx + 6, sy + 12);\n    ctx.moveTo(sx, sy + 6);\n    ctx.lineTo(sx + 12, sy + 6);\n    ctx.stroke();\n\n    ctx.strokeRect(sx, sy, 12, 12);\n    ctx.clip();\n    ctx.fill();\n    ctx.restore();\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n                   top, bottom, left, right,\n               }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2);\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2);\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, fontSize, hoffset) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y = y + height / 2 - hoffset;\n            // y = y1;\n            // const y2 = y + padding + fontSize / 2 + 1;\n            // if (y1 < y2) y = y2;\n            // else y = y1;\n        } else if (align === 'bottom') {\n            y += height - hoffset * 2 - padding;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr() * 1, dpr() * 1);\n        this.cxc = {\n            indent: 250,\n            vIndent: 200,\n            canvasContext: this.ctx\n        }\n\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        // this.ctx.font.size = 30;\n        // console.log(\"203:\", this.ctx.font);\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    selfAdaptionHeight(box, txt, font) {\n        if (font === undefined || txt === undefined)\n            return;\n        let n = 1;\n        const textLine = {len: 0, start: 0};\n        let innerWidth = box.width - box.padding * 2;\n        for (let i = 0; i < txt.length; i += 1) {\n            if (textLine.len + box.padding >= innerWidth) {\n                n = n + 1;\n                textLine.len = 0;\n                textLine.start = i;\n            }\n            textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n        }\n\n        return n;\n    }\n\n    selfAdaptionTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width + box.padding * 2;\n    }\n\n    selfAdaptionOneTxtWidth(txt, font) {\n        if (isHave(txt) === false || isHave(font) === false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        return ctx.measureText(txt).width;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(txt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        // const {\n        //     align, valign, font, color, strike, underline, ignore, cindex\n        // } = attr;\n        const {\n            align, valign, font, color, strike, underline, ignore\n        } = attr;\n\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n\n        let txtWidth = this.selfAdaptionTxtWidth(txt, font, box);\n        let hoffset = 0;\n        let innerWidth = box.innerWidth();\n        if (textWrap) {\n            innerWidth = box.width - box.padding * 2;\n            const n = this.selfAdaptionHeight(box, txt, font);\n            hoffset = ((n - 1) * font.size) / 2;\n            // for (let i = 0; i < ignore.length; i++) {\n            //     if (cindex != ignore[i]) {\n            //         // hoffset = 0;\n            //     } else if (cindex == ignore[i]) {\n            //     }\n            // }\n        }\n        let ty = box.texty(valign, font.size, hoffset);\n        if (textWrap && txtWidth > innerWidth) {\n            const textLine = {len: 0, start: 0};\n            for (let i = 0; i < txt.length; i += 1) {\n                if (textLine.len + box.padding >= innerWidth) {\n                    // debugger\n                    this.fillText(txt.substring(textLine.start, i), tx, ty);\n                    if (strike) {\n                        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    if (underline) {\n                        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    ty += font.size + 2;\n                    textLine.len = 0;\n                    textLine.start = i;\n                }\n                textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font);\n            }\n            if (textLine.len > 0) {\n                this.fillText(txt.substring(textLine.start), tx, ty);\n                if (strike) {\n                    drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                }\n                if (underline) {\n                    drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                }\n            }\n        } else {\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'striket', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n        }\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        ctx.beginPath();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropUp(box, state, diff) {\n        const {ctx} = this;\n        const {\n            x, y, height,\n        } = box;\n\n        const sx = x + 10;\n        const sy = y + height - 18 - diff;\n\n        // if (state) {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278539177.svg\";\n        // } else {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278579742.svg\";\n        // }\n        // img.onload = function () {\n        //   ctx.drawImage(img, npx(sx), npx(sy), 16, 16);\n        // }\n        if (state) {\n            drawFlexTrue.call(this, ctx, npx(sx), npx(sy))\n        } else {\n            drawFlexFalse.call(this, ctx, npx(sx), npx(sy))\n        }\n    }\n\n\n\n    lineTo(x, y) {\n        this.cxc.canvasContext.lineTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    moveTo(x, y) {\n        this.cxc.canvasContext.moveTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    };\n\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n\n    rect2(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, bgcolor,\n        } = box;\n        let {height} = box;\n        // if (textwrap == true) {\n        //     console.log(\"487\")\n        //     const n = this.selfAdaptionHeight(box, cellText);\n        //     height = height * n;\n        //     console.log(\"495\", height)\n        // }\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor === \"rgba(0, 0, 0, 0)\" ? '#fff' : bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  // { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  // { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  // { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', (evt) => {\n      this.itemClick(item.key, evt);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false) {\n    this.menus = buildMenu.call(this);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menus)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { height, width } = el.show().offset();\n    const view = this.viewFn();\n    let top = y;\n    let left = x;\n    if (view.height - y <= height) {\n      top -= height;\n    }\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.offset({ left, top });\n    bindClickoutside(el);\n  }\n}\n","/* global window */\nimport {h} from './element';\nimport {bind} from './event';\nimport tooltip from './tooltip';\nimport DropdownFont from './dropdown_font';\nimport DropdownFontSize from './dropdown_fontsize';\nimport DropdownFormat from './dropdown_format';\nimport DropdownFormula from './dropdown_formula';\nimport DropdownColor from './dropdown_color';\nimport DropdownAlign from './dropdown_align';\nimport DropdownBorder from './dropdown_border';\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\nimport DropdownAction from \"./dropdown_action\";\n\nfunction buildIcon(name) {\n    return new Icon(name);\n}\n\nexport function buildButton(tooltipdata) {\n    return h('div', `${cssPrefix}-toolbar-btn`)\n        .on('mouseenter', (evt) => {\n            tooltip(tooltipdata, evt.target);\n        })\n        .attr('data-tooltip', tooltipdata);\n}\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nexport function buildButtonWithIcon(tooltipdata, iconName, change = () => {\n}) {\n    return buildButton(tooltipdata)\n        .child(buildIcon(iconName))\n        .on('click', () => change());\n}\n\nfunction bindDropdownChange() {\n    this.ddFormat.change = it => this.change('format', it.key);\n    this.ddFont.change = it => this.change('font-name', it.key);\n    this.ddFormula.change = it => this.change('formula', it.key);\n    this.ddFontSize.change = it => this.change('font-size', it.pt);\n    this.ddTextColor.change = it => this.change('color', it);\n    this.ddFillColor.change = it => this.change('bgcolor', it);\n    this.ddAlign.change = it => this.change('align', it);\n    this.ddVAlign.change = it => this.change('valign', it);\n    this.ddBorder.change = it => this.change('border', it);\n    this.undoEl.change = it => this.change('undo', it);\n}\n\n\nfunction toggleChange(type) {\n    let elName = type;\n    const types = type.split('-');\n    if (types.length > 1) {\n        types.forEach((it, i) => {\n            if (i === 0) elName = it;\n            else elName += it[0].toUpperCase() + it.substring(1);\n        });\n    }\n    const el = this[`${elName}El`];\n    el.toggle();\n    this.change(type, el.hasClass('active'));\n}\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', false,  moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nfunction initBtns2() {\n    this.btns2 = this.btnChildren.map((it) => {\n        const rect = it.box();\n        const {marginLeft, marginRight} = it.computedStyle();\n        return [it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)];\n    });\n}\n\nfunction moreResize(widthFn = this.widthFn) {\n    const {\n        el, btns, moreEl, ddMore, btns2,\n    } = this;\n    const {moreBtns, contentEl} = ddMore;\n    el.css('width', `${ widthFn() - 60}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        const style = data.defaultStyle();\n        this.ddFormat = new DropdownFormat();\n        this.ddFont = new DropdownFont();\n        this.ddFormula = new DropdownFormula();\n        this.ddFontSize = new DropdownFontSize();\n        this.ddTextColor = new DropdownColor('text-color', style.color);\n        this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\n        this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\n        this.ddVAlign = new DropdownAlign(['top', 'middle', 'bottom'], style.valign);\n        this.ddBorder = new DropdownBorder();\n        this.ddMore = new DropdownMore();\n        this.undoEl = new DropdownAction('undo',  () => this.change('undo'), (v) => this.change('undoList', v));\n        this.redoEl = new DropdownAction('redo',  () => this.change('redo'), (v) => this.change('redoList', v));\n        this.btnChildren = [\n            // this.undoEl = buildButtonWithIcon(`${t('toolbar.undo')} (Ctrl+Z)`, 'undo', () => this.change('undo')),\n\n            // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\n            buildButton(`${t('toolbar.undo')}`).child(this.undoEl.el),\n            buildButton(`${t('toolbar.redo')}`).child(this.redoEl.el),\n            this.paintformatEl = buildButtonWithIcon(`${t('toolbar.paintformat')}`, 'paintformat', () => toggleChange.call(this, 'paintformat')),\n            // this.clearformatEl = buildButtonWithIcon(`${t('toolbar.clearformat')}`, 'clearformat', () => this.change('clearformat')),\n            buildDivider(),\n            buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\n            buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\n            buildDivider(),\n            this.fontBoldEl = buildButtonWithIcon(`${t('toolbar.fontBold')} (Ctrl+B)`, 'bold', () => toggleChange.call(this, 'font-bold')),\n            this.fontItalicEl = buildButtonWithIcon(`${t('toolbar.fontItalic')} (Ctrl+I)`, 'italic', () => toggleChange.call(this, 'font-italic')),\n            this.underlineEl = buildButtonWithIcon(`${t('toolbar.underline')} (Ctrl+U)`, 'underline', () => toggleChange.call(this, 'underline')),\n            // this.flexibleEl = buildButtonWithIcon(`${t('toolbar.flexibleEl')} `, 'flexible', () => toggleChange.call(this, 'flexible')),\n            this.strikeEl = buildButtonWithIcon(`${t('toolbar.strike')}`, 'strike', () => toggleChange.call(this, 'strike')),\n            buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\n            buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\n            this.mergeEl = buildButtonWithIcon(`${t('toolbar.merge')}`, 'merge', () => toggleChange.call(this, 'merge')),\n            buildDivider(),\n            buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\n            buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\n            this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.call(this, 'textwrap')),\n            buildDivider(),\n            // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\n            // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\n            this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\n            this.addEl = buildButtonWithIcon(`${t('toolbar.add')}`, 'add', () => toggleChange.call(this, 'add')),\n            this.closeEl = buildButtonWithIcon(`${t('toolbar.calc')}`, 'close', () => toggleChange.call(this, 'close')),\n            this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleChange.call(this, 'autofilter')),\n            this.throwFormulaEl = buildButtonWithIcon(`${t('toolbar.throwFormula')}`, 'chevron-right', () => toggleChange.call(this, 'throwFormula')),\n            // buildButton(`${t('toolbar.date_formula')}`).child(this.ddFormula.el),\n            // buildDivider(),\n            this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),\n        ];\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(...this.btnChildren);\n        this.el.child(this.btns);\n        if (isHide) this.el.hide();\n        bindDropdownChange.call(this);\n        this.reset();\n        setTimeout(() => {\n            initBtns2.call(this);\n            moreResize.call(this);\n        }, 0);\n        bind(window, 'resize', () => {\n            moreResize.call(this, data.settings.view.width);\n        });\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.hasClass('active');\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        toggleChange.call(this, type);\n    }\n\n    reset() {\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        const cell = data.getSelectedCell();\n        this.undoEl.disabled(!data.canUndo());\n        this.redoEl.disabled(!data.canRedo());\n        this.mergeEl.active(data.canUnmerge())\n            .disabled(!data.selector.multiple());\n        this.autofilterEl.active(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font} = style;\n        this.ddFont.setTitle(font.name);\n        this.ddFontSize.setTitle(font.size);\n        this.fontBoldEl.active(font.bold);\n        this.fontItalicEl.active(font.italic);\n        this.underlineEl.active(style.underline);\n        // this.flexibleEl.active(style.flexible);\n        this.strikeEl.active(style.strike);\n        this.ddTextColor.setTitle(style.color);\n        this.ddFillColor.setTitle(style.bgcolor);\n        this.ddAlign.setTitle(style.align);\n        this.ddVAlign.setTitle(style.valign);\n        this.textwrapEl.active(style.textwrap);\n        this.addEl.active(data.equationIsActive());\n        this.closeEl.active(false);\n        this.throwFormulaEl.active(false);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.active(data.freezeIsActive());\n        if (cell) {\n            if (cell.format) {\n                this.ddFormat.setTitle(cell.format);\n            }\n        }\n    }\n}\n","/* global document */\nimport {h} from './element';\nimport {bind} from './event';\nimport {cssPrefix} from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n      if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', {type: false}, ...nfonts );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', {type: false}, ...nfontSizes );\n  }\n}\n","import Dropdown from './dropdown';\nimport {h} from './element';\nimport {baseFormats} from '../core/format';\nimport {cssPrefix} from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n    constructor() {\n        let nformats = baseFormats.slice(0);\n        nformats.splice(1, 0, {key: 'divider'});\n        nformats.splice(5, 0, {key: 'divider'});\n        nformats = nformats.map((it) => {\n            const item = h('div', `${cssPrefix}-item`);\n            if (it.key === 'divider') {\n                item.addClass('divider');\n            } else {\n                item.child(it.title())\n                    .on('click', () => {\n                        this.setTitle(it.title());\n                        this.change(it);\n                    });\n                if (it.label) item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        super('Normal', '220px', true, 'bottom-left', {type: false}, ...nformats );\n    }\n\n    setTitle(key) {\n        for (let i = 0; i < baseFormats.length; i += 1) {\n            if (baseFormats[i].key === key) {\n                this.title.html(baseFormats[i].title);\n            }\n        }\n        this.hide();\n    }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', {type: false}, ...nformulas );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left',  {type: false}, ...naligns );\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, borderPalette.el );\n    this.borderPalette = borderPalette;\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  let item =  h('div', `${cssPrefix}-border-palette-cell`);\n  this.items.push(item);\n  return h('td', '').child(\n    item.child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    this.items = [];\n\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', {type: false}, ...lineTypeEls );\n  }\n}\n","import Dropdown from \"./dropdown\";\nimport Icon from \"./icon\";\nimport HistoryBorder from \"./history_border\";\n\nexport default class DropdownAction extends Dropdown {\n    constructor(iconName, change, arrowChange) {\n        const icon = new Icon(iconName)\n            .css('height', '18px');\n        const historyBorder = new HistoryBorder();\n        super(icon, 'auto', true, 'bottom-left', {type: true, change: change, arrowChange: arrowChange, historyBorder}, historyBorder.el);\n    }\n}","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\n\nexport default class HistoryBorder {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-history-border`);\n        this.history = h('div', `${cssPrefix}-history-content`).html('暂无内容');\n        this.el.child( this.history);\n    }\n\n    setContent(items) {\n        items = items.slice(items.length - 100 < 0 ? 0 : items.length, items.length);\n        this.el.html('');\n        let els = [];\n        for(let i = items.length - 1; i >= 0; i--) {\n            let d = h('div', '');\n            let {action} = items[i];\n            d.html(action);\n            els.push(d);\n        }\n\n        console.log(this, this.el);\n        this.el.children(...els);\n    }\n}","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  // showVf(it) {\n  //   const hint = it === 'date' ? '2018-11-12' : '10';\n  //   const { vf } = this;\n  //   vf.input.hint(hint);\n  //   vf.show();\n  // }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import {h} from './element';\nimport Button from './button';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nfunction buildMenu(clsName) {\n    return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n    return buildMenu('state').child(t(`sort.${it}`))\n        .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n    const {filterbEl, filterValues} = this;\n    filterbEl.html('');\n    const itemKeys = Object.keys(items);\n    itemKeys.forEach((it, index) => {\n        const cnt = items[it];\n        const active = filterValues.includes(it) ? 'checked' : '';\n        filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n            .on('click.stop', () => this.filterClick(index, it))\n            .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n    });\n}\n\nfunction resetFilterHeader() {\n    const {filterhEl, filterValues, values} = this;\n    filterhEl.html(`${filterValues.length} / ${values.length}`);\n    filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n    constructor() {\n        this.filterbEl = h('div', `${cssPrefix}-body`);\n        this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n        this.tindex = 1;\n        this.el = h('div', `${cssPrefix}-sort-filter`).children(\n            this.sortAscEl = buildSortItem.call(this, 'asc'),\n            this.sortDescEl = buildSortItem.call(this, 'desc'),\n            buildMenu('divider'),\n            h('div', `${cssPrefix}-filter`).children(\n                this.filterhEl,\n                this.filterbEl,\n            ),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', () => this.btnClick('cancel')),\n                new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n            ),\n        ).hide();\n        // this.setFilters(['test1', 'test2', 'text3']);\n        this.el.on('mousedown.stop', evt => {\n            this.tindex = 1;\n        });\n\n        this.ci = null;\n        this.sortDesc = null;\n        this.values = null;\n        this.filterValues = [];\n    }\n\n    btnClick(it) {\n        if (it === 'ok') {\n            const {ci, sort, filterValues} = this;\n            if (this.ok) {\n                this.ok(ci, sort, 'in', filterValues);\n            }\n        }\n        this.hide();\n    }\n\n    itemClick(it) {\n        // console.log('it:', it);\n        this.sort = it;\n        const {sortAscEl, sortDescEl} = this;\n        sortAscEl.checked(it === 'asc');\n        sortDescEl.checked(it === 'desc');\n    }\n\n    filterClick(index, it) {\n        const {filterbEl, filterValues, values} = this;\n        const children = filterbEl.children();\n        if (it === 'all') {\n            if (children.length === filterValues.length) {\n                this.filterValues = [];\n                children.forEach(i => h(i).checked(false));\n            } else {\n                this.filterValues = Array.from(values);\n                children.forEach(i => h(i).checked(true));\n            }\n        } else {\n            const checked = h(children[index]).toggle('checked');\n            // console.log(h(children[index]), \"92\")\n            if (checked) {\n                filterValues.push(it);\n            } else {\n                filterValues.splice(filterValues.findIndex(i => i === it), 1);\n            }\n        }\n\n        resetFilterHeader.call(this);\n    }\n\n    // v: autoFilter\n    // items: {value: cnt}\n    // sort { ci, order }\n    set(ci, items, filter, sort) {\n        this.ci = ci;\n        const {sortAscEl, sortDescEl} = this;\n        if (sort !== null) {\n            this.sort = sort.order;\n            sortAscEl.checked(sort.asc());\n            sortDescEl.checked(sort.desc());\n        } else {\n            this.sortDesc = null;\n            sortAscEl.checked(false);\n            sortDescEl.checked(false);\n        }\n        // this.setFilters(items, filter);\n        this.values = Object.keys(items);\n        this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n        buildFilterBody.call(this, items, filter);\n        resetFilterHeader.call(this);\n    }\n\n    setOffset(v) {\n        if(this.el.isShow()) {\n            this.hide();\n            return;\n        }\n\n        this.el.offset(v).show();\n        let tindex = 1;\n\n\n        console.log(this.el);\n        bindClickoutside(this.el, () => {\n\n            if (tindex === 0) {\n                this.hide();\n            }\n\n            tindex = 0;\n        });\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n        unbindClickoutside(this.el);\n    }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {sheetReset} from './sheet';\n\nexport default class Advice {\n    constructor(data, sheet) {\n        this.el = h('div', `${cssPrefix}-advice`)\n            .children(\n                this.save = h('div', `${cssPrefix}-advice-style`)\n                    .css('border-bottom', '1px solid'),\n                this.text = h('div', `${cssPrefix}-advice-style`),\n            )\n            .hide();\n        this.save.children(\n            this.saveCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('保留样式'),\n        );\n        this.text.children(\n            this.textCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('仅文本'),\n        );\n        this.data = data;\n        this.sheet = sheet;\n        this.left = 0;\n        this.top = 0;\n\n        this.save.on('mousedown.stop', () => {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n            this.sheet.setCellRange(this.reference, this.tableProxy, true);\n            sheetReset.call(this.sheet);\n        });\n\n        this.text.on('mousedown.stop', () => {\n            this.sheet.setCellRange(this.reference, this.tableProxy, false);\n            this.saveCheck.show('visibility', 'hidden');\n            this.textCheck.hide('visibility', 'initial');\n            sheetReset.call(this.sheet);\n        });\n    }\n\n    show(left, top, type = 1, reference, tableProxy ) {\n        this.el.css('left', `${left}px`);\n        this.el.css('top', `${top}px`);\n        if (type === 1) {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n        }\n        this.left = parseInt(left);\n        this.top = parseInt(top);\n        this.tableProxy = tableProxy;\n        this.reference = reference;\n        this.el.show();\n    }\n}\n","import {h} from \"../component/element\";\nimport {cssPrefix, look} from \"../config\";\nimport CellRange from \"../core/cell_range\";\nimport {  isSpecialWebsite} from \"../core/special_formula_process\";\n\nexport default class Website {\n    constructor(data, editor) {\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n\n        this.tableEl = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n        this.editor = editor;\n        this.tableEl.attr('tabindex', 0);\n        this.tableEl.css('overflow-y', 'auto');\n        this.tableEl.css('max-height', '400px');\n        // bind(this.tableEl.el, 'paste', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'copy', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'keydown', evt => {\n        //     evt.stopPropagation();\n        // });\n        // bind(this.tableEl.el, 'keyup', evt => {\n        //     evt.stopPropagation();\n        // });\n        this.timer = null;\n        this.timer2 = null;\n    }\n\n    show(ri, ci) {\n        if(this.editor.isDisplay2()) {\n            this.el.hide();\n            this.tableEl.hide();\n\n            return;\n        }\n\n        let {data} = this;\n        let text = data.getCellTextOrDefault(ri, ci) + \"\";\n        clearTimeout(this.timer);\n        clearTimeout(this.timer2);\n\n        if (look.indexOf(text.split(\"!\")[0]) === 0) {\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 50;\n            let arr = JSON.parse(text.substring(text.indexOf(\"!\") + 1, text.length));\n\n            this.tableEl.css('left', `${left}px`);\n            this.tableEl.css('top', `${top}px`);\n            this.tableEl.css('user-select', 'text');\n\n            this.tableEl.html('');\n            let table = h('table', '');\n            table.css('border-spacing', '0px');\n            let tr = h('tr', '');\n            tr.children(\n                h('td', '').css('border', '1px solid black').html('序号'),\n                h('td', '').css('border', '1px solid black').html('项目名称'),\n                h('td', '').css('border', '1px solid black').html('城市'),\n                h('td', '').css('border', '1px solid black').html('占地面积'),\n                h('td', '').css('border', '1px solid black').html('差额')\n            );\n            table.children(\n                tr\n            );\n\n            for (let j = 0; j < arr.length; j++) {\n                let {number, name, city, area, value} = arr[j];\n                let tr = h('tr', '');\n                let td = h('td', '');\n                td.html(number);\n                td.css('border', '1px solid black');\n\n                let td2 = h('td', '');\n                td2.html(name);\n                td2.css('border', '1px solid black');\n\n                let td3 = h('td', '');\n                td3.html(city);\n                td3.css('border', '1px solid black');\n\n                let td4 = h('td', '');\n                td4.html(area);\n                td4.css('border', '1px solid black');\n\n                let td5 = h('td', '');\n                td5.html(value);\n                td5.css('border', '1px solid black');\n                tr.children(\n                    td,\n                    td2,\n                    td3,\n                    td4,\n                    td5\n                );\n                table.children(\n                    tr\n                );\n            }\n\n            this.tableEl.children(\n                table\n            );\n\n            this.timer = setTimeout(() => {\n                this.tableEl.show();\n                this.el.hide();\n            }, 150);\n        } else {\n            let args = isSpecialWebsite(text);\n            if(args.state) {\n                text = args.text;\n            }\n            text = text.substr(0, 3).toLowerCase() === \"www\" ? \"http://\" + text : text;\n            // console.log(regex.test(text))\n            if (text.substr(0, 7).toLowerCase() !== 'http://' &&\n                text.substr(0, 8).toLowerCase() !== 'https://') {\n                this.el.hide();\n                this.tableEl.hide();\n                return;\n            }\n\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 5;\n            this.el.html('');\n            this.el.css('color', 'blue');\n            this.el.children(\n                h('div', 'aaa').css(\"border-bottom\", \"1px solid blue\")\n                    .on('click', evt => {\n                        let iWidth = 650; //弹出窗口的宽度;\n                        let iHeight = 500; //弹出窗口的高度;\n\n                        console.log(evt);\n                        let {screenX, screenY} = evt;\n                        window.open(text, \"\", `width=${iWidth},height=${iHeight},left=${screenX + rect.width},top=${screenY}`);\n                    })\n                    .html(text)\n            );\n            this.el.css('left', `${left}px`);\n            this.el.css('top', `${top}px`);\n\n            this.timer2 = setTimeout(() => {\n                this.el.show();\n                this.tableEl.hide();\n            }, 150);\n        }\n    }\n}","import {look} from \"../config\";\n\nlet v1 = \"HYPERLINK\";\n\n\nfunction isSpecialWebsite(text) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return {\n            \"state\": true,\n            \"text\": JSON.parse(text.split(\"!\")[1]).url,\n        };\n    }\n    return {\n        \"state\": false,\n        \"text\": \"\",\n    };\n}\n\nfunction indexOf(text, formula) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1 && formula.toUpperCase().indexOf(v1) === -1) {\n        return 2;\n    }\n    return 0;\n}\n\nfunction multipleCellsRender(cells, mc) {\n    let tailArr = [];\n    Object.keys(mc).forEach(i => {\n        cells[i] = mc[i];\n        tailArr.push(i);\n    });\n\n    return tailArr;\n}\n\nfunction specialWebsiteValue(text, formula) {\n    let index = indexOf(text, formula);\n\n    if (index === 2) {\n        let arr = text.split(\" \");\n        let s = \"\";\n        if (arr.length >= 1) {\n            text = arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                s += arr[i];\n            }\n        }\n        return {\n            \"state\": true,\n            \"type\": index,\n            \"text\": JSON.parse(text.split(\"!\")[1]).text + s,\n        };\n    }\n    return {\n        \"state\": false,\n        \"type\": index,\n        \"text\": \"\",\n    };\n}\n\nexport {\n    isSpecialWebsite,\n    specialWebsiteValue,\n    multipleCellsRender,\n}","import Modal from \"./modal\";\nimport {h} from \"./element\";\nimport Button from \"./button\";\nimport {t} from \"../locale/locale\";\nimport {cssPrefix} from \"../config\";\n\nexport default class ErrorPopUp extends Modal {\n    constructor() {\n        let tip = h('span', '').html(\"您输入的公式好像至少缺少一个左括号\");\n        super(t('contextmenu.errorPop'), [\n            h('div', `${cssPrefix}-form-fields`).children(\n                tip,\n            ),\n            h('div', `${cssPrefix}-form-fields`),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('ok', 'primary')\n                    .on('click', () => this.btnClick('ok')),\n            ),\n        ]);\n        this.tip = tip;\n    }\n\n    show(t) {\n        this.tip.html(t);\n        super.show();\n    }\n\n    btnClick(action) {\n        if (action === 'ok') {\n            this.hide();\n        }\n    }\n\n}","import {offsetTop} from \"../config\";\nimport {positionAngle} from \"../core/operator\";\n\nexport default class RectProxy {\n    constructor(rect) {\n        this.rect = rect;\n    }\n\n    isLocInside(x, y) {\n        let {rect} = this;\n\n        // if (x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height) {\n        //     return true;\n        // }\n        return x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height;\n    }\n\n    getUpDownLeftRight(ex, ey, clientX, clientY) {\n        let {rect} = this;\n\n        let pos = 0;\n        if (ex < rect.width + rect.left && ex > rect.left) {\n            if (ey > rect.top + rect.height + offsetTop) {\n                pos = 1;\n            } else if (ey - offsetTop < rect.top) {\n                pos = 4;\n            }\n\n        } else if (ey - ( rect.top - rect.height + offsetTop) > 0 && (rect.height + rect.top + offsetTop) > ey) {\n            if (ex > rect.width + rect.left) {\n                pos = 3;\n            } else if (ex < rect.left) {\n                pos = 2;\n            }\n        }\n\n        if (pos === 0) {\n            pos = positionAngle(clientX, ex, clientY, ey);\n        }\n        if (pos === 1 && ey < 0) {\n            pos = 4;\n        } else if (document.body.clientHeight < ey && pos === 4) {\n            pos = 1;\n        }\n        if (pos === 3 && ex < 0) {\n            pos = 2;\n        } else if (document.body.clientWidth < ex && pos === 2) {\n            pos = 3;\n        }\n\n        return pos;\n    }\n}","export default class Timer {\n    constructor() {\n        this.timer = [];\n    }\n\n    push(t) {\n        this.timer.push(t);\n    }\n\n    clear() {\n        for(let i = 0; i < this.timer.length; i++) {\n            let t = this.timer[i];\n            clearTimeout(t);\n            clearInterval(t);\n        }\n    }\n}","function Resize(options, self) {\n\n    this.register = function (el) {\n        let directionsArr = [];\n        let directions = ['nw', 'w', 'ws', 's', 'se', 'e', 'ne', 'n'];\n        //增加元素\n        directions.forEach(str => {\n            //direction ws\n\n            let div = document.createElement('div');\n            div.style.display = \"block\";\n            div.className = 'direction ' + str;\n            //注册事件\n\n            directionsArr.push(div);\n            el.appendChild(div);\n        });\n\n        for(let i = 0; i < 4; i++) {\n            let line = document.createElement('div');\n            line.style.display = \"block\";\n            line.className = `line${i+1}`;\n            el.appendChild(line);\n            directionsArr.push(line);\n        }\n\n\n        let border = document.createElement('div');\n        border.className = 'border';\n        el.appendChild(border);\n\n\n        //注册事件\n\n        directions.forEach(str => {\n            let obj = el.querySelector(\".\" + str);\n            obj.onmousedown = function (e) {\n\n                if (e.button !== 0) {\n                    return;\n                }\n\n                let ox = e.clientX;\n                let oy = e.clientY;\n\n                let data = {\n                    ox: ox,\n                    oy: oy,\n                    ow: el.offsetWidth,\n                    oh: el.offsetHeight,\n                    ol: el.offsetLeft,\n                    ot: el.offsetTop\n\n                };\n\n                if (options && options.onBegin) {\n                    options.onBegin.call(el,data)\n                }\n\n                let isResize = true;\n                window.onmousemove = function (event) {\n                    if (!isResize) {\n                        return;\n                    }\n                    let x = event.clientX;\n                    let y = event.clientY;\n\n                    //计算 width和height 差值\n\n                    let width = x - data.ox;\n                    let height = y - data.oy;\n\n\n                    data.width = width;\n                    data.height = height;\n\n                    let fun = mappers[str];\n                    if (fun) {\n                        fun.call(obj, data, event);\n                    }\n\n                    event.stopPropagation();\n                };\n                window.onmouseup = function (ee) {\n                    isResize = false;\n                    ee.stopPropagation();\n\n                    if (options && options.onEnd) {\n                        options.onEnd.call(el)\n                    }\n                };\n\n                //阻止事件冒泡\n                e.stopPropagation()\n            }\n\n        });\n\n\n        if (!options) {\n            options = {\n                onResize: function () {\n\n                }\n            }\n        } else if (!options.onResize) {\n            options.onResize = function () {\n\n            }\n        }\n\n        function setLeft(l) {\n            options.onResize({left: l}, self);\n            el.style.left = l + 'px';\n        }\n\n        function setTop(t) {\n            options.onResize({top: t}, self);\n            el.style.top = t + 'px';\n        }\n\n        function setWidth(w) {\n            if (w < 20) {\n                w = 20;\n            }\n            options.onResize({width: w}, self);\n            el.style.width = w + 'px';\n        }\n\n        function setHeight(h) {\n\n            if (h < 20) {\n                h = 20;\n            }\n            options.onResize({height: h}, self);\n            el.style.height = h + 'px';\n        }\n\n        let mappers = {\n            s: function (data) {\n                setHeight(data.oh + data.height);\n            },\n            e: function (data) {\n                setWidth(data.ow + data.width)\n            },\n            w: function (data) {\n                let value = data.width;\n\n\n                let l = data.ol + value;\n                let w = data.ow + Math.abs(value);\n\n                if (value > 0) {\n                    w = data.ow - value;\n                }\n\n                if (w > 20) {\n                    setLeft(l);\n                    setWidth(w);\n                }\n            },\n            n: function (data) {\n                let value = data.height;\n\n                let t = data.ot + value;\n                let h = data.oh + Math.abs(value);\n\n                if (value > 0) {\n                    h = data.oh - value;\n                }\n                if (h > 20) {\n                    setHeight(h);\n                    setTop(t);\n                }\n            },\n            se: function (data) {\n                mappers.s(data);\n                mappers.e(data);\n            },\n            nw: function (data) {\n                mappers.n(data);\n                mappers.w(data);\n            },\n            ws: function (data) {\n                mappers.w(data);\n                mappers.s(data);\n            },\n            ne: function (data) {\n                mappers.n(data);\n                mappers.e(data);\n            }\n        };\n\n        // el.querySelector()\n        return directionsArr;\n    }\n}\n\nexport default Resize;\n","import {isHaveStyle} from \"../event/paste\";\nimport {Rows} from \"../core/row\";\nimport {splitStr} from \"../core/operator\";\n// import {xy2expr} from \"../core/alphabet\";\nimport CellRange from '../core/cell_range';\nimport {isHave} from \"../core/helper\";\n// jobs: todo: 为什么TableProxy放在event文件夹里面，似乎应该放到core文件夹？\nexport default class TableProxy {\n    constructor(data ) {\n        this.data = data;\n         this.rows = new Rows({len: 0, height: 0}, data);\n    }\n\n    getComputedStyle(computedStyle) {\n        let bold = false;\n        if (computedStyle.fontWeight > 400) {\n            bold = true;\n        }\n\n        return {\n            color: computedStyle.color,\n            bgcolor: computedStyle.background.substring(0,\n                computedStyle.background.indexOf(\")\") + 1),\n            font: {\n                bold: bold,\n            },\n        };\n    }\n\n    extend(tableDom, {ri, ci}) {\n        let {data} = this;\n        if (tableDom.rows.length >= data.rows.len - ri) {\n            let diff = tableDom.rows.length - (data.rows.len - ri);\n            if(diff > 0) {\n                data.insert('row', diff);\n            }\n        }\n\n        if (isHave(tableDom.rows[0]) === false || isHave(tableDom.rows[0].cells) === false) {\n            return;\n        }\n\n        let colLen = tableDom.rows[0].cells.length;\n        if (colLen >= data.cols.len) {\n            let diff = colLen - (data.cols.len - ci);\n            if(diff > 0) {\n                data.insert('column', diff, data.cols.len);\n            }\n        }\n    }\n\n    each(obj, cb) {\n        for (let i = 0; i < obj.rows.length; i++) {\n            for (let j = 0; j < obj.rows[i].cells.length; j++) {\n                cb(i, j, obj.rows[i].cells[j]);\n            }\n        }\n    }\n\n    dealColSpan(tableDom) {\n        this.each(tableDom, (i, j, cell) => {\n            let len = cell.getAttribute(\"colspan\");\n            if (len && len > 1) {\n                for (let c = 0; c < len - 1; c++) {\n                    tableDom.rows[i].insertBefore(document.createElement(\"td\"), tableDom.rows[i].cells[j + 1]);\n                }\n            }\n        });\n    }\n\n    dealStyle(tableDom, {ri, ci}) {\n        let {data, rows} = this;\n        let styles = data.styles;\n\n        this.each(tableDom, (i, j, cell) => {\n            let computedStyle = document.defaultView.getComputedStyle(cell, null);\n            let args = this.getComputedStyle(computedStyle);\n            let index = isHaveStyle(styles, args);\n            if (index === -1) {\n                styles.push(args);\n            }\n            rows.setCell(ri + i, ci + j, {\"style\": index === -1 ? styles.length - 1 : index}, 'all');\n        });\n    }\n\n    parseTableCellRange(tableDom, {ri, ci}) {\n      let maxRi = ri, maxCi = ci;\n      this.each(tableDom, (i, j) => {\n        let rii = ri + i;\n        let cij = ci + j;\n            if(maxRi < rii) {\n              maxRi = rii;\n            }\n            if(maxCi < cij) {\n              maxCi = cij;\n            }\n        });\n        return new CellRange(ri, ci, maxRi, maxCi);\n    }\n\n    dealReference(tableDom, {ri, ci}) {\n        let {rows} = this;\n         let reference = [];\n\n        this.each(tableDom, (i, j, cell) => { // 处理reference函数提取一下，填充也用引用这个函数。 updateCEllReferenceByShift， 跟填充的逻辑共享\n            let node = cell.querySelector(\"reference\");\n            let innerText = cell.innerText || \"\";\n            if (node) {\n                let eri = node.getAttribute('ri');\n                let eci = node.getAttribute('ci');\n\n                let strList = splitStr(innerText);\n                let dci = i + ri - eri;\n                let dei = j + ci - eci;\n\n                let {bad, result} = rows.getCellTextByShift(strList, dei, dci);\n                rows.updateCellReferenceByShift(bad, result, ri + i, ci + j);\n            } else {\n                let _cell = rows.getCell(ri + i, ci + j) || {};\n                _cell.text = innerText;\n                _cell.formulas = innerText;\n\n                rows.setCell(ri + i, ci + j, _cell, 'all');\n            }\n            // proxy.setCell(data.name, xy2expr(ci + j, ri + i));\n\n            reference.push({\n                ri: ri + i,\n                ci: ci + j\n            });\n        });\n        return {\"reference\": reference};\n    }\n}\n","import dayjs from 'dayjs'\nimport {datePattern, str2Re} from \"../utils/reg_pattern\";\nimport {formatNumberRender} from \"../core/format\";\nimport {isHave, isNumber} from \"../core/helper\";\n\n\nexport function formatDate(diff) {\n    if(!isHave(diff) || !isNumber(diff)) {\n        return {\n            \"state\": false,\n            // \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n\n    let str = calcDecimals(diff, (i) => {\n        return i * 24 * 60;\n    });\n    str = formatNumberRender(str, 5);\n    let beginDate = dayjs('1900-01-01');\n    let beginDate2 = dayjs('1900-01-01');\n    let enter = false;\n\n    if (isHave(str) && str * 1 > 0) {\n        let second = calcDecimals(str, (i) => {\n            return i * 60;\n        });\n        enter = true;\n        second = formatNumberRender(second, 5);\n        beginDate2 = dayjs('1900-01-01  00:00:00').set('minute', str).set('second', second);\n    }\n\n    let date = \"\";\n    if (enter) {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n\n        let formula = beginDate2.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD  h:mm:ss');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": formula,\n            \"minute\": true\n        }\n    } else {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n        return {\n            \"state\": date !== 'Invalid Date',\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n}\n\nexport function changeFormat(date, format = 'YYYY年MM月DD日') {\n  return dayjs(date).format(format);\n}\n\nexport function calcDecimals(diff, cb = () => {\n}) {\n    let arr = diff.toString().split('.');\n    if (arr.length > 2) {\n        return diff;\n    }\n    let fix = arr[1] + \"\";\n    let newData = fix;\n    for (let i = 0; i < fix.length; i++) {\n        newData = newData * 0.1;\n    }\n\n    return cb(newData);\n}\n\n// export function cellDate() {\n//\n// }\n\n// 已写test\nexport function dateDiff(date) {\n    let valid = false;\n\n    for (let i = 0; valid === false && i < datePattern.length; i++) {\n        valid = str2Re(datePattern[i]).test(date);\n    }\n\n    if (valid === false) {\n        return {\n            \"isValid\": false,\n        };\n    } else {\n        date = date.replace(/[年|月]/g, \"-\");\n        date = date.replace(/[日]/g, \"\");\n\n        return {\n            \"diff\": dayjs(date).diff(dayjs('1900-01-01'), 'day') + 2,\n            \"isValid\": true,\n        }\n    }\n}\n","import {xy2expr} from \"./alphabet\";\nimport PreAction from \"../model/pre_action\";\nimport {testValid} from \"../utils/test\";\n\nfunction operationItem(preAction) {\n    this.undoItems.push(preAction);\n    this.redoItems = [];\n}\n\nexport default class MultiPreAction {\n    constructor(data) {\n        this.undoItems = [];\n        this.redoItems = [];\n        this.data = data;\n    }\n\n    addStep({type, action, ri, ci, expr, cellRange, cells, height, width, property, value, oldData}, {oldCell, newCell, oldMergesData, newMergesData, oldStep}) {\n        let preAction = \"\";\n\n        if(type === 1) {\n            preAction = new PreAction({\n                type,\n                action, ri, ci, expr, oldCell, newCell\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 2 || type === 5 || type === 11 || type === 12 || type === 6) {\n            preAction = new PreAction({\n                type, oldMergesData, property, value, newMergesData,\n                action, cellRange,  oldCell, newCell: cells\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 13) {\n            preAction = new PreAction({\n                type, oldData, newData: oldStep.oldData,\n                action,\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 3) {\n            preAction = new PreAction({\n                type,\n                action, height, ri, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 4) {\n            preAction = new PreAction({\n                type,\n                action, width, ci, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        }\n\n        testValid.call(this);\n    }\n\n    // 删掉了一个merges\n    getStepType(type, {ri, ci, expr, text, range, cellRange, property, value}) {\n        let str = \"\";\n        let {rows, cols} = this.data;\n\n        if(type === 1) {\n            str = `在${expr}中键入\"${text}\"`;\n            return {\n                action: str,\n                type,\n                ri, ci, expr\n            };\n        } else if(type === 2) {\n            let expr1 = xy2expr(range.sci, range.sri);\n            let expr2 = xy2expr(range.eci, range.eri);\n            expr = expr1 === expr2 ? expr1 : `${expr1}:${expr2}`;\n            str = `删除${expr}的单元格内容`;\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(range),\n            };\n        } else if(type === 3) {\n            let height = rows.getHeight(ri);\n            str = `行宽`;\n            return {\n                action: str,\n                type,\n                height: height,\n                ri: ri\n            };\n        } else if(type === 4) {\n            let width = cols.getWidth(ci);\n            str = `列宽`;\n            return {\n                action: str,\n                type,\n                width: width,\n                ci: ci\n            };\n        } else if(type === 5) {\n            str = '自动填充';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 12) {\n            str = '选择性粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 13) {\n            str = '插入单元格';\n\n            return {\n                action: str,\n                type, oldData: this.data.getData(),\n            };\n        }else if(type === 11) {\n            if (property === 'font-bold' || property === 'font-italic'\n                || property === 'font-name' || property === 'font-size' || property === 'color') {\n                str = \"字体\";\n            } else if (property === 'underline') {\n                str = \"下划线\";\n            } else if (property === 'bgcolor' || property === 'format') {\n                str = \"单元格格式\";\n            } else if (property === 'align') {\n                if (value === 'left') {\n                    str = \"左对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'right') {\n                    str = \"右对齐\";\n                }\n            } else if (property === 'valign') {\n                if (value === 'top') {\n                    str = \"顶端对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'bottom') {\n                    str = \"底端对齐\";\n                }\n            } else if (property === 'border') {\n                str = \"边框\";\n            } else if (property === 'strike') {\n                str = \"删除线\";\n            } else if (property === 'merge') {\n                str = '合并单元格';\n            }\n\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 6) {\n            str = '粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        }\n    }\n\n    undo() {\n        let preAction = this.does(this.getItems(1), 1);\n        this.redoItems.push(preAction);\n    }\n\n    redo() {\n        let preAction = this.does(this.getItems(2), 2);\n        this.undoItems.push(preAction);\n    }\n\n    eachRange(range) {\n        let {rows} = this.data;\n\n        return rows.eachRange(range);\n    }\n\n    does(actionItems, actionType) {\n        if (!this.data.settings.showEditor) {\n            return;\n        }\n\n        if (actionItems.length <= 0) {\n            return;\n        }\n        let {data} = this;\n        let {sheet} = data;\n\n        let preAction = actionItems.pop();\n        preAction.restore(data, sheet, actionType);\n\n        return preAction;\n    }\n\n    getItems(type) {\n        if (type === 1) {\n            return this.undoItems;\n        } else {\n            return this.redoItems;\n        }\n    }\n}\n","import CellProp from \"./cell_prop\";\nimport {isHave} from \"../core/helper\";\nimport {xy2expr} from \"../core/alphabet\";\n\nfunction getType(dType, sType) {\n    if (dType === 1 && sType === 1) {\n        return 1;           // 1行多列 * 1行多列\n    } else if (dType === 1 && sType === 2) {\n        return 2;\n    } else if (dType === 1 && sType === 3) {    // 多行多列 * 一行多列\n        return 3;\n    } else if (dType === 2 && sType === 1) {\n        return 4;\n    } else if (dType === 3 && sType === 1) {\n        return 5;\n    } else if (dType === 2 && sType === 2) {\n        return 6;\n    } else if (dType === 2 && sType === 3) {\n        return 7;\n    } else if (dType === 3 && sType === 2) {\n        return 8;\n    } else if (dType === 3 && sType === 3) {\n        return 9;\n    }\n}\n\nfunction changeDarrToDoubleArr(darr, selectorRange) {\n    let ri = selectorRange.sri;\n    let _darr = [];\n    let arr = [];\n    let index = 0;\n    selectorRange.each((i, j) => {\n        if (ri !== i) {\n            ri = i;\n            _darr.push(arr);\n            arr = [];\n        }\n        arr.push(darr[index]);\n        index += 1;\n    });\n    _darr.push(arr);\n\n    return _darr;\n}\n\nexport default class PaintFormat {\n    constructor(selectorRange, dstRange) {\n        this.selectorRange = selectorRange;\n        this.dstRange = dstRange;\n    }\n\n    getPaintType() {\n        let {dstRange, selectorRange} = this;\n\n        let dType = dstRange.getType();\n        let sType = selectorRange.getType();\n\n        let paintType = getType(dType, sType);\n\n        return paintType;\n    }\n\n    makePaintArr(type, darr) {\n        let {dstRange, selectorRange} = this;\n        let pArr = [];\n        // if (type === 1 || type === 6) {  // 1行多列 // 1列多行\n        //     let index = 0;\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         index += 1;\n        //         if (index === darr.length) {\n        //             index = 0;\n        //         }\n        //     });\n        // } else if (type === 3) {        // 3 多行多列 * 1行多列\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         let {cell} = _darr[0][index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //     });\n        // } else if(type === 7) {\n        //     let recordRi = dstRange.sri;\n        //     let rowIndex = 0;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === _darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = _darr[rowIndex][0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // }else if (type === 4 || type === 2) {   // 4: 1行多列 * 1列多行    6: 1列多行 * 1行多列\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //     });\n        // } else if (type === 5) {\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             index = 0;\n        //         }\n        //\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //         recordRi = i;\n        //     });\n        // } else if (type === 8) {\n        //     let rowIndex = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = darr[rowIndex];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // } else if (type === 9) {\n            let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n            let rowIndex = 0;\n\n            let _darr = changeDarrToDoubleArr(darr, selectorRange);\n\n            dstRange.each((i, j) => {\n                if (recordRi !== i) {\n                    rowIndex += 1;\n                    index = 0;\n                    if (rowIndex === _darr.length) {\n                        rowIndex = 0;\n                    }\n                }\n\n                let {cell} = _darr[rowIndex][index];\n\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j));\n                pArr.push(cellProp);\n\n                if (index === dci) {\n                    index = 0;\n                } else {\n                    index += 1;\n                }\n                recordRi = i;\n            });\n        // }\n\n        return pArr;\n    }\n}","export default {\n    toolbar: {\n        undo: '撤销',\n        redo: '恢复',\n        paintformat: '格式刷',\n        clearformat: '清除格式',\n        format: '数据格式',\n        font: '字体',\n        fontSize: '字号',\n        fontBold: '加粗',\n        fontItalic: '倾斜',\n        underline: '下划线',\n        strike: '删除线',\n        textColor: '字体颜色',\n        fillColor: '填充颜色',\n        border: '边框',\n        merge: '合并单元格',\n        align: '水平对齐',\n        valign: '垂直对齐',\n        textwrap: '自动换行',\n        freeze: '冻结',\n        autofilter: '自动筛选',\n        add: '显示公式',\n        calc: '开始计算',\n        formula: '函数',\n        more: '更多',\n        throwFormula: '清除公式',\n        comeBack: '返回',\n    },\n    revision: {\n        comeBack: '退出',\n    },\n    contextmenu: {\n        copy: '复制',\n        cut: '剪切',\n        paste: '粘贴',\n        pasteValue: '粘贴数据',\n        pasteFormat: '粘贴格式',\n        insertRow: '插入行',\n        insertColumn: '插入列',\n        deleteRow: '删除行',\n        deleteColumn: '删除列',\n        deleteCell: '删除',\n        deleteCellText: '删除数据',\n        validation: '数据验证',\n        errorPop: '出现问题',\n        recover: '恢复此版本',\n    },\n    format: {\n        normal: '常规',\n        text: '文本',\n        number: '数值',\n        percent: '百分比',\n        rmb: '人民币',\n        usd: '美元',\n        date: '短日期',\n        time: '时间',\n        datetime: '长日期',\n        duration: '持续时间',\n    },\n    date_formula: {\n        sum: '求和',\n        average: '求平均值',\n        max: '求最大值',\n        min: '求最小值',\n        concat: '字符拼接',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: '此值必填',\n        notMatch: '此值不匹配验证规则',\n        between: '此值应在 {} 和 {} 之间',\n        notBetween: '此值不应在 {} 和 {} 之间',\n        notIn: '此值不在列表中',\n        equal: '此值应该等于 {}',\n        notEqual: '此值不应该等于 {}',\n        lessThan: '此值应该小于 {}',\n        lessThanEqual: '此值应该小于等于 {}',\n        greaterThan: '此值应该大于 {}',\n        greaterThanEqual: '此值应该大于等于 {}',\n    },\n    error: {\n        pasteForMergedCell: '无法对合并的单元格执行此操作',\n    },\n    calendar: {\n        weeks: ['日', '一', '二', '三', '四', '五', '六'],\n        months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    },\n    button: {\n        cancel: '取消',\n        remove: '删除',\n        save: '保存',\n        ok: '确认',\n    },\n    sort: {\n        desc: '降序',\n        asc: '升序',\n    },\n    filter: {\n        empty: '空白',\n    },\n    dataValidation: {\n        mode: '模式',\n        range: '单元区间',\n        criteria: '条件',\n        modeType: {\n            cell: '单元格',\n            column: '列模式',\n            row: '行模式',\n        },\n        type: {\n            list: '列表',\n            number: '数字',\n            date: '日期',\n            phone: '手机号',\n            email: '电子邮件',\n        },\n        operator: {\n            be: '在区间',\n            nbe: '不在区间',\n            lt: '小于',\n            lte: '小于等于',\n            gt: '大于',\n            gte: '大于等于',\n            eq: '等于',\n            neq: '不等于',\n        },\n    },\n};\n\n","import {debugout} from \"./debugout\";\nlet bugout = \"\";\ntry {\n    bugout = new debugout();\n} catch (e) {\n    console.error(e);\n}\n\nexport {\n    bugout,\n}","/*\n\n    debugout.js\n    by @inorganik\n    \n*/\n\n\n// save all the console.logs\nexport function debugout() {\n    var self = this;\n\n    // OPTIONS\n    self.realTimeLoggingOn = true; // log in real time (forwards to console.log)\n    self.useTimestamps = false; // insert a timestamp in front of each log\n    self.useLocalStorage = true; // store the output using window.localStorage() and continuously add to the same log each session\n    self.recordLogs = true; // set to false after you're done debugging to avoid the log eating up memory\n    self.autoTrim = true; // to avoid the log eating up potentially endless memory\n    self.maxLines = 2500; // if autoTrim is true, this many most recent lines are saved\n    self.tailNumLines = 100; // how many lines tail() will retrieve\n    self.logFilename = 'debugout.txt'; // filename of log downloaded with downloadLog()\n\n    // vars\n    self.depth = 0;\n    self.parentSizes = [0];\n    self.currentResult = '';\n    self.startTime = new Date();\n    self.output = '';\n\n    this.version = function () {\n        return '0.5.0'\n    }\n\n    /*\n        USER METHODS\n    */\n    this.getLog = function () {\n        var retrievalTime = new Date();\n        // if recording is off, so dev knows why they don't have any logs\n        if (!self.recordLogs) {\n            self.log('[debugout.js] log recording is off.');\n        }\n        // if using local storage, get values\n        if (self.useLocalStorage) {\n            var saved = window.localStorage.getItem('debugout.js');\n            if (saved) {\n                saved = JSON.parse(saved);\n                self.startTime = new Date(saved.startTime);\n                self.output = saved.log;\n                retrievalTime = new Date(saved.lastLog);\n            }\n        }\n        return self.output\n            + '\\n---- Log retrieved: ' + retrievalTime + ' ----\\n'\n            + self.formatSessionDuration(self.startTime, retrievalTime);\n    }\n    // accepts optional number or uses the default for number of lines\n    this.tail = function (numLines) {\n        var numLines = numLines || self.tailLines;\n        return self.trimLog(self.getLog(), numLines);\n    }\n    // accepts a string to search for\n    this.search = function (string) {\n        var lines = self.output.split('\\n');\n        var rgx = new RegExp(string);\n        var matched = [];\n        // can't use a simple Array.prototype.filter() here\n        // because we need to add the line number\n        for (var i = 0; i < lines.length; i++) {\n            var addr = '[' + i + '] ';\n            if (lines[i].match(rgx)) {\n                matched.push(addr + lines[i]);\n            }\n        }\n        var result = matched.join('\\n');\n        if (result.length == 0) result = 'Nothing found for \"' + string + '\".';\n        return result\n    }\n    // accepts the starting line and how many lines after the starting line you want\n    this.getSlice = function (lineNumber, numLines) {\n        var lines = self.output.split('\\n');\n        var segment = lines.slice(lineNumber, lineNumber + numLines);\n        return segment.join('\\n');\n    }\n    // immediately downloads the log - for desktop browser use\n    this.downloadLog = function () {\n        var file = \"data:text/plain;charset=utf-8,\";\n        var logFile = self.getLog();\n        var encoded = encodeURIComponent(logFile);\n        file += encoded;\n        var a = document.createElement('a');\n        a.href = file;\n        a.target = '_blank';\n        a.download = self.logFilename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    }\n    // clears the log\n    this.clear = function () {\n        var clearTime = new Date();\n        self.output = '---- Log cleared: ' + clearTime + ' ----\\n';\n        if (self.useLocalStorage) {\n            // local storage\n            var saveObject = {\n                startTime: self.startTime,\n                log: self.output,\n                lastLog: clearTime\n            }\n            saveObject = JSON.stringify(saveObject);\n            window.localStorage.setItem('debugout.js', saveObject);\n        }\n        if (self.realTimeLoggingOn) console.log('[debugout.js] clear()');\n    }\n    // records a log\n    this.log = function (obj) {\n        // log in real time\n        if (self.realTimeLoggingOn) console.log(obj);\n        // record log\n        var type = self.determineType(obj);\n        if (type != null && self.recordLogs) {\n            var addition = obj;\n            // timestamp, formatted for brevity\n            if (self.useTimestamps) {\n                var logTime = new Date();\n                self.output += self.formatTimestamp(logTime);\n            }\n            self.output += addition + '\\n';\n            if (self.autoTrim) self.output = self.trimLog(self.output, self.maxLines);\n            // local storage\n            if (self.useLocalStorage) {\n                var last = new Date();\n                var saveObject = {\n                    startTime: self.startTime,\n                    log: self.output,\n                    lastLog: last\n                }\n                saveObject = JSON.stringify(saveObject);\n                window.localStorage.setItem('debugout.js', saveObject);\n            }\n        }\n        self.depth = 0;\n        self.parentSizes = [0];\n        self.currentResult = '';\n    }\n    /*\n        METHODS FOR CONSTRUCTING THE LOG\n    */\n\n    // like typeof but classifies objects of type 'object'\n    // kept separate from formatType() so you can use at your convenience!\n    this.determineType = function (object) {\n        if (object != null) {\n            var typeResult;\n            var type = typeof object;\n            if (type == 'object') {\n                var len = object.length;\n                if (len == null) {\n                    if (typeof object.getTime == 'function') {\n                        typeResult = 'Date';\n                    }\n                    else if (typeof object.test == 'function') {\n                        typeResult = 'RegExp';\n                    }\n                    else {\n                        typeResult = 'Object';\n                    }\n                } else {\n                    typeResult = 'Array';\n                }\n            } else {\n                typeResult = type;\n            }\n            return typeResult;\n        } else {\n            return null;\n        }\n    }\n    // format type accordingly, recursively if necessary\n    this.formatType = function (type, obj) {\n        switch (type) {\n            case 'Object' :\n                self.currentResult += '{\\n';\n                self.depth++;\n                self.parentSizes.push(self.objectSize(obj));\n                var i = 0;\n                for (var prop in obj) {\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    self.currentResult += prop + ': ';\n                    var subtype = self.determineType(obj[prop]);\n                    var subresult = self.formatType(subtype, obj[prop]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    }\n                    i++;\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += self.indentsForDepth(self.depth);\n                self.currentResult += '}';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'Array' :\n                self.currentResult += '[';\n                self.depth++;\n                self.parentSizes.push(obj.length);\n                for (var i = 0; i < obj.length; i++) {\n                    var subtype = self.determineType(obj[i]);\n                    if (subtype == 'Object' || subtype == 'Array') self.currentResult += '\\n' + self.indentsForDepth(self.depth);\n                    var subresult = self.formatType(subtype, obj[i]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype == 'Array') self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype != 'Object') self.currentResult += '\\n';\n                        else if (i == self.parentSizes[self.depth] - 1) self.currentResult += '\\n';\n                    }\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += ']';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'function' :\n                obj += '';\n                var lines = obj.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    if (lines[i].match(/\\}/)) self.depth--;\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    if (lines[i].match(/\\{/)) self.depth++;\n                    self.currentResult += lines[i] + '\\n';\n                }\n                return self.currentResult;\n                break;\n            case 'RegExp' :\n                return '/' + obj.source + '/';\n                break;\n            case 'Date' :\n            case 'string' :\n                if (self.depth > 0 || obj.length == 0) {\n                    return '\"' + obj + '\"';\n                } else {\n                    return obj;\n                }\n            case 'boolean' :\n                if (obj) return 'true';\n                else return 'false';\n            case 'number' :\n                return obj + '';\n                break;\n        }\n    }\n    this.indentsForDepth = function (depth) {\n        var str = '';\n        for (var i = 0; i < depth; i++) {\n            str += '\\t';\n        }\n        return str;\n    }\n    this.trimLog = function (log, maxLines) {\n        var lines = log.split('\\n');\n        if (lines.length > maxLines) {\n            lines = lines.slice(lines.length - maxLines);\n        }\n        return lines.join('\\n');\n    }\n    this.lines = function () {\n        return self.output.split('\\n').length;\n    }\n    // calculate testing time\n    this.formatSessionDuration = function (startTime, endTime) {\n        var msec = endTime - startTime;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        var hrs = ('0' + hh).slice(-2);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        var mins = ('0' + mm).slice(-2);\n        msec -= mm * 1000 * 60;\n        var ss = Math.floor(msec / 1000);\n        var secs = ('0' + ss).slice(-2);\n        msec -= ss * 1000;\n        return '---- Session duration: ' + hrs + ':' + mins + ':' + secs + ' ----'\n    }\n    this.formatTimestamp = function (timestamp) {\n        var year = timestamp.getFullYear();\n        var date = timestamp.getDate();\n        var month = ('0' + (timestamp.getMonth() + 1)).slice(-2);\n        var hrs = Number(timestamp.getHours());\n        var mins = ('0' + timestamp.getMinutes()).slice(-2);\n        var secs = ('0' + timestamp.getSeconds()).slice(-2);\n        return '[' + year + '-' + month + '-' + date + ' ' + hrs + ':' + mins + ':' + secs + ']: ';\n    }\n    this.objectSize = function (obj) {\n        var size = 0, key;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n    }\n\n    /*\n        START/RESUME LOG\n    */\n    if (self.useLocalStorage) {\n        var saved = window.localStorage.getItem('debugout.js');\n        if (saved) {\n            saved = JSON.parse(saved);\n            self.output = saved.log;\n            var start = new Date(saved.startTime);\n            var end = new Date(saved.lastLog);\n            self.output += '\\n---- Session end: ' + saved.lastLog + ' ----\\n';\n            self.output += self.formatSessionDuration(start, end);\n            self.output += '\\n\\n';\n        }\n    }\n    self.output += '---- Session started: ' + self.startTime + ' ----\\n\\n';\n}","var map = {\n\t\"./af\": 91,\n\t\"./af.js\": 91,\n\t\"./ar\": 92,\n\t\"./ar-dz\": 93,\n\t\"./ar-dz.js\": 93,\n\t\"./ar-kw\": 94,\n\t\"./ar-kw.js\": 94,\n\t\"./ar-ly\": 95,\n\t\"./ar-ly.js\": 95,\n\t\"./ar-ma\": 96,\n\t\"./ar-ma.js\": 96,\n\t\"./ar-sa\": 97,\n\t\"./ar-sa.js\": 97,\n\t\"./ar-tn\": 98,\n\t\"./ar-tn.js\": 98,\n\t\"./ar.js\": 92,\n\t\"./az\": 99,\n\t\"./az.js\": 99,\n\t\"./be\": 100,\n\t\"./be.js\": 100,\n\t\"./bg\": 101,\n\t\"./bg.js\": 101,\n\t\"./bm\": 102,\n\t\"./bm.js\": 102,\n\t\"./bn\": 103,\n\t\"./bn.js\": 103,\n\t\"./bo\": 104,\n\t\"./bo.js\": 104,\n\t\"./br\": 105,\n\t\"./br.js\": 105,\n\t\"./bs\": 106,\n\t\"./bs.js\": 106,\n\t\"./ca\": 107,\n\t\"./ca.js\": 107,\n\t\"./cs\": 108,\n\t\"./cs.js\": 108,\n\t\"./cv\": 109,\n\t\"./cv.js\": 109,\n\t\"./cy\": 110,\n\t\"./cy.js\": 110,\n\t\"./da\": 111,\n\t\"./da.js\": 111,\n\t\"./de\": 112,\n\t\"./de-at\": 113,\n\t\"./de-at.js\": 113,\n\t\"./de-ch\": 114,\n\t\"./de-ch.js\": 114,\n\t\"./de.js\": 112,\n\t\"./dv\": 115,\n\t\"./dv.js\": 115,\n\t\"./el\": 116,\n\t\"./el.js\": 116,\n\t\"./en-SG\": 117,\n\t\"./en-SG.js\": 117,\n\t\"./en-au\": 118,\n\t\"./en-au.js\": 118,\n\t\"./en-ca\": 119,\n\t\"./en-ca.js\": 119,\n\t\"./en-gb\": 120,\n\t\"./en-gb.js\": 120,\n\t\"./en-ie\": 121,\n\t\"./en-ie.js\": 121,\n\t\"./en-il\": 122,\n\t\"./en-il.js\": 122,\n\t\"./en-nz\": 123,\n\t\"./en-nz.js\": 123,\n\t\"./eo\": 124,\n\t\"./eo.js\": 124,\n\t\"./es\": 125,\n\t\"./es-do\": 126,\n\t\"./es-do.js\": 126,\n\t\"./es-us\": 127,\n\t\"./es-us.js\": 127,\n\t\"./es.js\": 125,\n\t\"./et\": 128,\n\t\"./et.js\": 128,\n\t\"./eu\": 129,\n\t\"./eu.js\": 129,\n\t\"./fa\": 130,\n\t\"./fa.js\": 130,\n\t\"./fi\": 131,\n\t\"./fi.js\": 131,\n\t\"./fo\": 132,\n\t\"./fo.js\": 132,\n\t\"./fr\": 133,\n\t\"./fr-ca\": 134,\n\t\"./fr-ca.js\": 134,\n\t\"./fr-ch\": 135,\n\t\"./fr-ch.js\": 135,\n\t\"./fr.js\": 133,\n\t\"./fy\": 136,\n\t\"./fy.js\": 136,\n\t\"./ga\": 137,\n\t\"./ga.js\": 137,\n\t\"./gd\": 138,\n\t\"./gd.js\": 138,\n\t\"./gl\": 139,\n\t\"./gl.js\": 139,\n\t\"./gom-latn\": 140,\n\t\"./gom-latn.js\": 140,\n\t\"./gu\": 141,\n\t\"./gu.js\": 141,\n\t\"./he\": 142,\n\t\"./he.js\": 142,\n\t\"./hi\": 143,\n\t\"./hi.js\": 143,\n\t\"./hr\": 144,\n\t\"./hr.js\": 144,\n\t\"./hu\": 145,\n\t\"./hu.js\": 145,\n\t\"./hy-am\": 146,\n\t\"./hy-am.js\": 146,\n\t\"./id\": 147,\n\t\"./id.js\": 147,\n\t\"./is\": 148,\n\t\"./is.js\": 148,\n\t\"./it\": 149,\n\t\"./it-ch\": 150,\n\t\"./it-ch.js\": 150,\n\t\"./it.js\": 149,\n\t\"./ja\": 151,\n\t\"./ja.js\": 151,\n\t\"./jv\": 152,\n\t\"./jv.js\": 152,\n\t\"./ka\": 153,\n\t\"./ka.js\": 153,\n\t\"./kk\": 154,\n\t\"./kk.js\": 154,\n\t\"./km\": 155,\n\t\"./km.js\": 155,\n\t\"./kn\": 156,\n\t\"./kn.js\": 156,\n\t\"./ko\": 157,\n\t\"./ko.js\": 157,\n\t\"./ku\": 158,\n\t\"./ku.js\": 158,\n\t\"./ky\": 159,\n\t\"./ky.js\": 159,\n\t\"./lb\": 160,\n\t\"./lb.js\": 160,\n\t\"./lo\": 161,\n\t\"./lo.js\": 161,\n\t\"./lt\": 162,\n\t\"./lt.js\": 162,\n\t\"./lv\": 163,\n\t\"./lv.js\": 163,\n\t\"./me\": 164,\n\t\"./me.js\": 164,\n\t\"./mi\": 165,\n\t\"./mi.js\": 165,\n\t\"./mk\": 166,\n\t\"./mk.js\": 166,\n\t\"./ml\": 167,\n\t\"./ml.js\": 167,\n\t\"./mn\": 168,\n\t\"./mn.js\": 168,\n\t\"./mr\": 169,\n\t\"./mr.js\": 169,\n\t\"./ms\": 170,\n\t\"./ms-my\": 171,\n\t\"./ms-my.js\": 171,\n\t\"./ms.js\": 170,\n\t\"./mt\": 172,\n\t\"./mt.js\": 172,\n\t\"./my\": 173,\n\t\"./my.js\": 173,\n\t\"./nb\": 174,\n\t\"./nb.js\": 174,\n\t\"./ne\": 175,\n\t\"./ne.js\": 175,\n\t\"./nl\": 176,\n\t\"./nl-be\": 177,\n\t\"./nl-be.js\": 177,\n\t\"./nl.js\": 176,\n\t\"./nn\": 178,\n\t\"./nn.js\": 178,\n\t\"./pa-in\": 179,\n\t\"./pa-in.js\": 179,\n\t\"./pl\": 180,\n\t\"./pl.js\": 180,\n\t\"./pt\": 181,\n\t\"./pt-br\": 182,\n\t\"./pt-br.js\": 182,\n\t\"./pt.js\": 181,\n\t\"./ro\": 183,\n\t\"./ro.js\": 183,\n\t\"./ru\": 184,\n\t\"./ru.js\": 184,\n\t\"./sd\": 185,\n\t\"./sd.js\": 185,\n\t\"./se\": 186,\n\t\"./se.js\": 186,\n\t\"./si\": 187,\n\t\"./si.js\": 187,\n\t\"./sk\": 188,\n\t\"./sk.js\": 188,\n\t\"./sl\": 189,\n\t\"./sl.js\": 189,\n\t\"./sq\": 190,\n\t\"./sq.js\": 190,\n\t\"./sr\": 191,\n\t\"./sr-cyrl\": 192,\n\t\"./sr-cyrl.js\": 192,\n\t\"./sr.js\": 191,\n\t\"./ss\": 193,\n\t\"./ss.js\": 193,\n\t\"./sv\": 194,\n\t\"./sv.js\": 194,\n\t\"./sw\": 195,\n\t\"./sw.js\": 195,\n\t\"./ta\": 196,\n\t\"./ta.js\": 196,\n\t\"./te\": 197,\n\t\"./te.js\": 197,\n\t\"./tet\": 198,\n\t\"./tet.js\": 198,\n\t\"./tg\": 199,\n\t\"./tg.js\": 199,\n\t\"./th\": 200,\n\t\"./th.js\": 200,\n\t\"./tl-ph\": 201,\n\t\"./tl-ph.js\": 201,\n\t\"./tlh\": 202,\n\t\"./tlh.js\": 202,\n\t\"./tr\": 203,\n\t\"./tr.js\": 203,\n\t\"./tzl\": 204,\n\t\"./tzl.js\": 204,\n\t\"./tzm\": 205,\n\t\"./tzm-latn\": 206,\n\t\"./tzm-latn.js\": 206,\n\t\"./tzm.js\": 205,\n\t\"./ug-cn\": 207,\n\t\"./ug-cn.js\": 207,\n\t\"./uk\": 208,\n\t\"./uk.js\": 208,\n\t\"./ur\": 209,\n\t\"./ur.js\": 209,\n\t\"./uz\": 210,\n\t\"./uz-latn\": 211,\n\t\"./uz-latn.js\": 211,\n\t\"./uz.js\": 210,\n\t\"./vi\": 212,\n\t\"./vi.js\": 212,\n\t\"./x-pseudo\": 213,\n\t\"./x-pseudo.js\": 213,\n\t\"./yo\": 214,\n\t\"./yo.js\": 214,\n\t\"./zh-cn\": 215,\n\t\"./zh-cn.js\": 215,\n\t\"./zh-hk\": 216,\n\t\"./zh-hk.js\": 216,\n\t\"./zh-tw\": 217,\n\t\"./zh-tw.js\": 217\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 334;"],"sourceRoot":""}