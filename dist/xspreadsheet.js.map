{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/calc/formulajs/lib/utils.js","webpack:///./src/calc/RawValue.js","webpack:///./src/calc/formulajs/lib/math-trig.js","webpack:///./src/calc/formulajs/lib/statistical.js","webpack:///./src/calc/exec_formula.js","webpack:///./src/calc/expression_builder.js","webpack:///./src/calc/Exp.js","webpack:///./src/calc/UserFnExecutor.js","webpack:///./src/calc/UserRawFnExecutor.js","webpack:///./src/calc/formulajs/lib/compatibility.js","webpack:///./src/calc/formulajs/lib/expression.js","webpack:///./src/calc/index.js","webpack:///./src/calc/formulajs/lib/database.js","webpack:///./src/calc/formulajs/lib/logical.js","webpack:///./src/calc/formulajs/lib/financial.js","webpack:///./src/calc/formulajs/lib/lookup-reference.js","webpack:///./src/calc/formulajs/lib/custom.js","webpack:///./src/calc/formulas-raw.js","webpack:///./src/calc/Calculator.js","webpack:///./src/calc/CalcCell.js","webpack:///./src/calc/CalcWorkBook.js","webpack:///./src/calc/utils.js","webpack:///./src/calc/int_2_col_str.js","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/calc/col_str_2_int.js","webpack:///./src/component/element.js","webpack:///./src/locale/locale.js","webpack:///./src/locale/en.js","webpack:///./src/core/formula.js","webpack:///./src/core/selector.js","webpack:///./src/core/scroll.js","webpack:///./src/core/clipboard.js","webpack:///./src/core/auto_filter.js","webpack:///./src/core/merge.js","webpack:///./src/core/paste_proxy.js","webpack:///./src/core/cell_proxy.js","webpack:///./src/model/cell_prop.js","webpack:///./src/model/cell.js","webpack:///./src/core/row.js","webpack:///./src/core/col.js","webpack:///./src/core/validator.js","webpack:///./src/core/validation.js","webpack:///./src/event/move.js","webpack:///./src/component/event.js","webpack:///./src/component/resizer.js","webpack:///./src/component/scrollbar.js","webpack:///./src/component/selector_cell.js","webpack:///./src/component/selector.js","webpack:///./src/component/suggest.js","webpack:///./src/component/icon.js","webpack:///./src/component/calendar.js","webpack:///./src/component/datepicker.js","webpack:///./src/component/suggest_content.js","webpack:///./src/component/selector_move.js","webpack:///./src/component/selector_copy.js","webpack:///./src/component/color_palette.js","webpack:///./src/component/formula_editor.js","webpack:///./src/core/font.js","webpack:///./src/core/cell.js","webpack:///./src/utils/number_util.js","webpack:///./src/canvas/draw.js","webpack:///./src/utils/test.js","webpack:///./src/component/table.js","webpack:///./src/component/editor_text.js","webpack:///./src/component/editor.js","webpack:///./src/component/contextmenu.js","webpack:///./src/component/dropdown.js","webpack:///./src/component/dropdown_font.js","webpack:///./src/component/dropdown_fontsize.js","webpack:///./src/core/format.js","webpack:///./src/component/dropdown_format.js","webpack:///./src/component/dropdown_formula.js","webpack:///./src/component/dropdown_color.js","webpack:///./src/component/dropdown_align.js","webpack:///./src/component/dropdown_linetype.js","webpack:///./src/component/border_palette.js","webpack:///./src/component/dropdown_border.js","webpack:///./src/component/history_border.js","webpack:///./src/component/dropdown_action.js","webpack:///./src/component/toolbar.js","webpack:///./src/component/tooltip.js","webpack:///./src/component/modal.js","webpack:///./src/component/form_input.js","webpack:///./src/component/form_select.js","webpack:///./src/component/form_field.js","webpack:///./src/component/button.js","webpack:///./src/component/modal_validation.js","webpack:///./src/component/sort_filter.js","webpack:///./src/component/message.js","webpack:///./src/component/advice.js","webpack:///./src/event/copy.js","webpack:///./src/component/website.js","webpack:///./src/component/special_formula_process.js","webpack:///./src/component/error_pop_up.js","webpack:///./src/component/rect_proxy.js","webpack:///./src/model/Timer.js","webpack:///./src/model/pre_action.js","webpack:///./src/component/sheet.js","webpack:///./src/external/drag.js","webpack:///./src/external/resize.js","webpack:///./src/event/table_proxy.js","webpack:///./src/event/paste.js","webpack:///./src/utils/date.js","webpack:///./src/core/multi_pre_action.js","webpack:///./src/model/paint_format.js","webpack:///./src/core/data_proxy.js","webpack:///./src/locale/zh-cn.js","webpack:///./src/log/log_proxy.js","webpack:///./src/log/debugout.js","webpack:///./src/index.js","webpack:///./src/calc/Range.js","webpack:///./src/calc/formulajs/lib/text.js","webpack:///./src/calc/formulajs/lib/information.js","webpack:///./src/calc/formulajs/lib/date-time.js","webpack:///./src/calc/getSanitizedSheetName.js","webpack:///./src/calc/str_2_val.js","webpack:///./src/calc/RefValue.js","webpack:///./src/calc/formulajs/index.js","webpack:///./src/calc/formulajs/lib/miscellaneous.js","webpack:///./src/calc/formulajs/lib/engineering.js","webpack:///./src/calc/find_all_cells_with_formulas.js","webpack:///./src/calc/formula_check.js","webpack:///./src/calc/formulajs/lib/error.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","error","require","flattenShallow","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","isFlat","parse","Error","arr","flatten","argsToArray","arguments","args","numbers","possibleNumbers","filter","el","flattenNum","div0","undefined","cleanFloat","number","Math","round","parseBool","bool","up","toUpperCase","Date","isNaN","parseNumber","string","parseFloat","parseNumberArray","len","parsed","parseMatrix","matrix","pnarr","d1900","parse_arg","arg","parseInt","replace","parseDate","date","num","getTime","Copy","obj","copy","setTime","clone","attr","strToMatrix","str","split","toString","indexOf","ExcelDateToJSDate","utils","issue","isNumber","val","test","parseDateArray","this","anyIsError","arrayValuesToNumbers","rest","idx","initial","setValue","v","calc","numeric","statistical","information","ABS","abs","ACOS","acos","ACOSH","log","sqrt","ACOT","atan","ACOTH","AGGREGATE","function_num","options","ref1","ref2","AVERAGE","COUNT","COUNTA","MAX","MIN","PRODUCT","STDEV","S","P","SUM","VAR","MEDIAN","MODE","SNGL","LARGE","SMALL","PERCENTILE","INC","QUARTILE","EXC","ARABIC","text","M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","ASIN","asin","ASINH","ATAN","ATAN2","number_x","number_y","atan2","ATANH","BASE","radix","min_length","max","join","CEILING","significance","precision","floor","ROUND","ceil","MATH","PRECISE","COMBIN","number_chosen","FACT","COMBINA","COS","cos","COSH","exp","COT","tan","COTH","e2","CSC","sin","CSCH","DECIMAL","DEGREES","PI","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","places","pow","FLOORMATH","FLOORPRACE","GCD","range","r0","x","ri","y","INT","ISO","LCM","pop","LN","LOG","base","LOG10","MDETERM","det","e","MINVERSE","inv","MMULT","matrix1","matrix2","console","dot","MOD","dividend","divisor","modulus","MROUND","multiple","MULTINOMIAL","sum","MUNIT","dimension","identity","ODD","temp","POWER","power","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","top","ROMAN","digits","String","roman","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","function_code","ADD","num1","num2","na","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","argsKeys","keys","elt","SUMIF","criteria","eval","SUMIFS","s_arr","compareValue","lastIndexOf","resultArr","enter","k","SUMPRODUCT","product","_i","_ij","arrays","SUMSQ","ISNUMBER","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","mathTrig","jStat","misc","evalExpression","AVEDEV","subtract","mean","count","AVERAGEA","AVERAGEIF","average_range","average_count","isWildcard","tokenizedCriteria","filter_criteria","tokens","createToken","TOKEN_TYPE_LITERAL","compute","AVERAGEIFS","criteriaLength","isMeetCondition","computedResult","average","BETA","DIST","alpha","beta","cumulative","A","B","cdf","pdf","INV","probability","BINOM","successes","trials","binomial","CHISQ","chisquare","RT","TEST","observed","expected","tmp","row","col","dof","xsqr","Pi","ChiSq","COLUMN","col_list","cell_name","formula","COLUMNS","cols","CONFIDENCE","NORM","sd","normalci","T","tci","IFS","cond","CORREL","array1","array2","corrcoeff","COUNTBLANK","COUNTIN","element","blanks","COUNTIF","matches","COUNTIFS","results","COUNTUNIQUE","UNIQUE","COVARIANCE","mean1","mean2","covariance","DEVSQ","EXPON","lambda","exponential","F","d1","d2","centralF","sumOfSquares","values","x1","x2","FISHER","FISHERINV","e2y","FORECAST","data_y","data_x","xmean","ymean","den","FREQUENCY","bins","GAMMA","gammafn","gamma","GAMMALN","gammaln","GAUSS","z","normal","GEOMEAN","geomean","GROWTH","known_y","known_x","new_x","use_const","avg_x","avg_y","avg_xy","avg_xx","new_y","HARMEAN","HYPGEOM","N","INTERCEPT","KURT","sigma","stdev","sort","LINEST","LOGEST","LOGNORM","lognormal","MAXA","arr2","median","min","MINA","MULT","currentItem","maxItems","NEGBINOM","negbin","PEARSON","den1","den2","fl","PERCENTRANK","uniques","match","PERMUT","PERMUTATIONA","PHI","POISSON","poisson","PROB","lower","upper","sorted","quart","RANK","AVG","order","ROW","index","ROWS","rows","RSQ","SKEW","m2","m3","SLOPE","STANDARDIZE","STDEVA","VARA","STDEVPA","VARPA","STEYX","lft","TRANSPOSE","transpose","df","studentt","mean_x","mean_y","s_x","s_y","TREND","new_data_x","linest","TRIMMEAN","percent","trim","WEIBULL","Z","expression_builder","xlsx_Fx","xlsx_raw_Fx","import_raw_functions","functions","opts","import_functions","formulajs","prefix","override","my_assign","dest","source","JSON","stringify","build_expression","exec_formula","update_cell_value","set_fx","fn","exec_fx","localizeFunctions","dic","newName","oldName","Exp","RawValue","UserFnExecutor","UserRawFnExecutor","common_operations","status","root_exp","str_formula","cell","f","substr","exp_obj","buffer","was_string","fn_stack","char","state","start","single_quote","stack","trim_buffer","special","special_raw","sheet_name","ini_parentheses","position_i","Range","str_2_val","MS_PER_DAY","exp_id","last_arg","self","isEmpty","checkVariable","exec","op","as","id","errorValues","message","w","sheet","str_expression","datedifference","exec_minus","toLowerCase","user_function","map","engineering","dateTime","set","root","BETADIST","BETAINV","BINOMDIST","ISOCEILING","CEILINGMATH","CEILINGPRECISE","CHIDIST","CHIDISTRT","CHIINV","CHIINVRT","CHITEST","COVAR","COVARIANCEP","COVARIANCES","CRITBINOM","EXPONDIST","ERFCPRECISE","ERFC","ERFPRECISE","ERF","FDIST","FDISTRT","FINVRT","FINV","FLOORPRECISE","FTEST","GAMMADIST","GAMMAINV","GAMMALNPRECISE","HYPGEOMDIST","LOGINV","LOGNORMINV","LOGNORMDIST","MODEMULT","MODESNGL","NEGBINOMDIST","NETWORKDAYSINTL","NORMDIST","NORMINV","NORMSDIST","NORMSINV","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","POISSONDIST","QUARTILEEXC","QUARTILEINC","RANKAVG","RANKEQ","SKEWP","STDEVP","STDEVS","TDIST","TDISTRT","TINV","TTEST","VARP","VARS","WEIBULLDIST","WORKDAYINTL","ZTEST","_XLFN","defaultOperator","validSymbols","TOKEN_TYPE_OPERATOR","SUPPORTED_TOKENS","type","analyzeTokens","literalValue","analyzedTokens","token","unshift","expression","expressionLength","cursorIndex","processedValue","processedSymbol","charAt","tokenizeExpression","operator","evaluate","int_2_col_str","col_str_2_int","find_all_need_calc_cell","Calculator","CalcCell","checker","helper","CalcWorkBook","mymodule","tileArr","isHave","Calc_WorkBook","workbook","get_workbook","formulas","calc_cell","valid_res","check_valid","trans_formula","trans_sheet","recover_formula","recover_sheet","is_muti_cell","deal_muti_cell","calcDoneToSetCells","calculator","XLSX_CALC","stats","maths","compact","find_result_idx","database","valid_arr","filter_arr","valid_str","result_idx","is_valid","get_values","resultIndexes","field","field_idx","FINDFIELD","title","DAVERAGE","targetValues","DCOUNT","DCOUNTA","DGET","DMAX","DMIN","DPRODUCT","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","AND","CHOOSE","FALSE","IF","then_value","otherwise_value","IFERROR","valueIfError","ISERROR","IFNA","value_if_na","NOT","logical","OR","TRUE","XOR","SWITCH","targetValue","argc","switchCount","switchSatisfied","defaultClause","validDate","ACCRINT","first","settlement","rate","par","frequency","basis","YEARFRAC","ACCRINTM","AMORDEGRC","cost","date_purchased","first_period","salvage","period","AMORLINC","COUPDAYBS","maturity","COUPDAYS","COUPDAYSNC","COUPNCD","numerror","COUPNUM","COUPPCD","CUMIPMT","periods","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","life","month","toFixed","total","current","ceiling","DDB","factor","DISC","pr","redemption","DAYS","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","coupon","yld","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","investment","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","negative","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","day","discount","PRICEDISC","PRICEMAT","dsm","PV","RATE","iter","close","t1","t2","Number","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","DAYS360","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","match_less_than_or_equal","lookupValue","indexValue","match_exactly_string","match_exactly_non_string","match_greater_than_or_equal","MATCH","matchType","VLOOKUP","return_index","HLOOKUP","needle","table","exactmatch","City","url","PQUERY","absArr","o1","obj1","obj2","val1","val2","items","a1","a2","a4","city","area","HYPERLINK","lianjia","lianJiaUrl","woaiwojia","woaiwojiaUrl","fangtianxia","fangtianxiaUrl","RefValue","cell_ref","columns","height","width","ref_value","parsed_ref","parseRef","col_str","end_range","onerrorvalue","Infinity","condition","_then","_else","find_all_cells_with_formulas","expressions","variables","calcNames","var_name","variable","forEach","setVarOfExpression","vars","Workbook","Names","item","getRef","Ref","Name","ref_name","formula_ref","wb","formulas_i","fml","reg","RegExp","param","rep","strim","trans_params","need_calc_cells","findAllNeedCalcCell","zb","expr2xy","getCell","Sheets","multivalueRefsCell","source_v","setCell","v1","v2","cell_v","cell_zb","cell_x","cell_y","expr","xy2expr","clean_matrix","ref","clean_all_flag","process_arr","process_matrix","Rows2Workbook","cells","_","ci","modulo","columnName","guard","fromCharCode","webpackContext","req","webpackContextResolve","code","resolve","colstr","charCodeAt","Element","tag","className","document","createElement","eventNames","handler","fen","oen","eventName","navigator","userAgent","addEventListener","evt","button","stopPropagation","css","offsetTop","left","offsetLeft","offsetHeight","offsetWidth","scrollLeft","scrollTop","getBoundingClientRect","parentNode","eles","childNodes","ele","child","createTextNode","appendChild","contains","classList","add","remove","cls","toggleClass","toggle","flag","addClass","removeClass","active","setAttribute","getAttribute","removeAttribute","content","innerHTML","style","removeProperty","removeChild","getComputedStyle","h","$lang","$messages","en","toolbar","undo","redo","paintformat","clearformat","format","font","fontSize","fontBold","fontItalic","underline","strike","textColor","fillColor","border","merge","align","valign","textwrap","freeze","autofilter","more","flexible","throwFormula","comeBack","contextmenu","cut","paste","pasteValue","pasteFormat","insertRow","insertColumn","deleteRow","deleteColumn","deleteCell","deleteCellText","validation","recover","rmb","usd","time","datetime","duration","date_formula","wland","wfr","rtd","required","notMatch","between","notBetween","notIn","equal","notEqual","lessThan","lessThanEqual","greaterThan","greaterThanEqual","pasteForMergedCell","calendar","weeks","months","cancel","save","ok","desc","asc","empty","dataValidation","modeType","column","list","phone","email","be","nbe","lt","lte","gt","gte","eq","neq","translate","messages","spreadsheet","tf","locale","lang","baseFormulas","render","ary","deepCopy","formulaCalc","formulam","Selector","CellRange","size","Scroll","Clipboard","cellRange","Filter","includes","Sort","AutoFilter","filters","flex","fitlers","it","getData","getFilter","hrange","exceptRowSet","rir","ix","set_total","cic","rset","Set","fset","sri","eri","ctext","cnt","valueOf","Merges","cb","cr","within","intersects","union","deleteWithin","cbWithin","sci","eci","rn","cn","it1","merges","PasteProxy","srcCellRange","dstCellRange","srcOneDRange","dstOneDRange","dsri","dsci","deri","deci","drn","dcn","use","isLeftRight","isDown","getRangeByWay","line","way","offset","sarr","isCopy","isAdd","diffValue","last2","CellProxy","nrindex","cindex","cellText","formatInfo","tryParseToNum","isDate","ncell","nA","isFormula","search","str2Re","datePattern2","CellProp","depend","Cell","formatText","calcUtils","otherAutoFilter","darr","direction","what","other","dri","getCellByTopCell","iText","calcFormulaCellByTopCell","calcCellByTopCell","numberAutoFilter","calcNumberCellByTopCell","dateAutoFilter","diff","calcDateCellByTopCell","Rows","pasteProxy","getOrNew","exceptSet","rangeSum","has","getHeight","sumHeight","isSheetVale","_cell","to_calc_num","getDependCell","setFormatText","cutStr","mergeCellExpr","mergeArr","distinct","refCell","isAbsoluteValue","e1","each","getCellOrNew","arr3","s1","changeFormula","ca","setCellAll","value2absolute","es","s3","s2","re","cellStyle","isValid","isInsert","ds","dei","dci","isRows","cellProp","bad","newStr","getCellTextIsAdd","ds1","ds2","sp","und","getCellDataType","last1","formatMoney","copyRender","strList","splitStr","getRangeByTopCell","getCellTextByShift","updateCellReferenceByShift","word","dayjs","getCellByCell","cloneDeep","innerText","setSrcAndDstCellRange","autoFilterDirection","upOrDown","getOneDRangeObj","getAllDataType","getLocationArray","leftOrRight","calcDiff","nri","nci","srcCell","eachCells","ndata","rndata","entries","isReferOtherSheet","recast","Recast","out","rowsInit","init","change","timeEnd","assign","Cols","indexWidth","minWidth","getWidth","sumWidth","rules","returnMessage","Validator","arrayEquals","parseValue","Validation","refs","validator","nrefs","difference","Validations","errors","Map","validate","getByValidator","addRef","equals","Moved","removeEvent","target","unbind","removeEventListener","unbindClickoutside","xclickoutside","body","createEvent","keyCode","metaKey","buttons","event","initEvent","eventType","dispatchEvent","bindClickoutside","detail","hide","mouseMoveUp","movefunc","upfunc","xEvtUp","calTouchDirection","spanx","spany","Resizer","vertical","minDistance","moving","cssPrefix","children","hoverEl","on","mousedownHandler","lineEl","cRect","finishedFn","rect","show","startEvt","distance","movementX","movementY","Scrollbar","moveFn","contentEl","scroll","contentDistance","cssKey","SelectorCell","getRect","setOffset","includeByRiCi","setData","selectorHeightBorderWidth","startZIndex","SelectorElement","selector","cornerEl","_selector","moveEvent","clickCopyPaste","boxinner","areaEl","clipboardEl","autofillEl","setTimeout","_cellRange","selectorMoveEl","container","setBoxinner","getCellRectByXY","layerX","layerY","move","getMoveRect","setMove","movedCell","movedCell2","cutPaste","indexes","moveIndexes","selectCell","moveChange","selectorMoveReset","pointer","calBRAreaOffset","ftwidth","freezeTotalWidth","ftheight","freezeTotalHeight","left0","top0","calTAreaOffset","calLAreaOffset","setBRAreaOffset","br","setAreaOffset","setTLAreaOffset","tl","setTAreaOffset","setLAreaOffset","setLClipboardOffset","setClipboardOffset","setBRClipboardOffset","setTLClipboardOffset","setTClipboardOffset","setAllAreaOffset","setAllClipboardOffset","sc","areaOffset","arange","lastri","lastci","longTimeBefore","setCss","resetSelectOffset","freezeHeight","freezeWidth","getSelectedRect","coffset","getClipboardRect","resetOffset","isMergeCell","indexesUpdated","calSelectedRangeByStart","cri","cci","setIndexes","resetAreaOffset","calSelectedRangeByEnd","setEnd","pos","drisc","showAutofill","hideAutofill","showClipboard","hideClipboard","inputMovePrev","preventDefault","filterItems","itemIndex","scrollHeight","inputMoveNext","inputEnter","click","inputKeydownHandler","ctrlKey","Suggest","itemClick","editor","cssRemoveKeys","parent","startsWith","label","html","input","Icon","iconNameEl","addMonth","step","setMonth","getMonth","weekday","setDate","getDay","Calendar","cvalue","headerLeftEl","bodyEl","buildAll","prev","next","week","selectChange","buildHeaderLeft","buildBody","getFullYear","trs","year","cdate","startDate","datess","disabled","getDate","monthDays","tds","Datepicker","calendarPattern","variableElement","txt","ct","SuggestContent","helpFormula","exampleName","example","item2","SelectorMove","cha","dict","timer","_move_selectors","selectors","msri","msci","meri","meci","clearTimeout","inputText","editorText","getText","_erpx","cuttingByPos","cuttingByPosEnd","erpx","find","setCursorPos","move2","color","lockCells","selectorMove","SelectorCopy","srn","ern","ecn","themeColorPlaceHolders","themeColors","selectColors","selectorColor","standardColors","buildTd","bgcolor","ColorPalette","isAb","offsetX","offsetY","cellRect","mousedownIndex","es1","es2","isCors","substring","setText","operation","setLock","makeSelector","judgeText","cutFirst","setMouseDownIndex","filterSelectors","selectors_delete","selectors_new","removeEl","suggestContent","cutting","div2span","cutting2","i2","mergeSelector","index2","selectorsEl","clearSelectors","editingSelectors","selectors_valid","enterCode","notTrueValue","prx","lax","prx_index","lax_index","findBracketLeft","begin","stop","findBracketRight","right","cutcolor","spanArr","spanEl","mount2span","baseFonts","fontSizes","pt","px","getFontSizePxByPt","evalFormula","rule","sheetbook","src","formulaMap","getCellText","look","look2","isMinus","dpr","devicePixelRatio","thinLineWidth","npx","npxLine","DrawBox","padding","borderTop","borderRight","borderBottom","borderLeft","hoffset","drawFontLine","tx","ty","blheight","blwidth","floffset","Draw","ctx","getContext","resize","scale","cxc","indent","vIndent","canvasContext","clearRect","beginPath","restore","fillRect","fillText","box","textLine","innerWidth","selfAdaptionOneTxtWidth","italic","bold","measureText","textWrap","ignore","textx","textAlign","textBaseline","fillStyle","strokeStyle","txtWidth","selfAdaptionTxtWidth","selfAdaptionHeight","texty","lineWidth","setLineDash","moveTo","y1","lineTo","stroke","topxys","rightxys","bottomxys","leftxys","sx","sy","drawFlexTrue","drawFlexFalse","strokeRect","clip","fill","y2","bezierCurveTo","closePath","dtextcb","testValid","valid","assert","cellPaddingWidth","tableFixedHeaderCleanStyle","tableGridStyle","getDrawBox","rindex","getChangeDataToCalc","changeData","changeDataForCalc","parseCell","changeDataArgs","parseCell2","viewRange","each2","renderCell","draw","sortedRowMap","getCellStyleOrDefault","dbox","setBorders","strokeBorders","showEquation","rect2","renderFormat","settings","minus","specialStyle","validations","getError","renderFlexible","autoFilter","s_t","dropup","renderAutofilter","afRange","dropdown","renderContent","fw","fh","ret","filteredTranslateFunc","eachMergesInView","renderSelectedHeaderCell","renderFixedHeaders","nty","ntx","rowEach","rowHeight","ii","colEach","colWidth","stringAt","renderFixedLeftTopCell","renderContentGrid","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","viewWidth","theight","viewHeight","Table","autoAdaptList","getCellTextOrDefault","clear","fri","fci","vr","freezeViewRange","EditorText","oldCell","getOldCell","cuttingByPosEnd2","text_b","resetTextareaSize","textlineEl","textEl","tlineWidth","maxWidth","viewFn","h1","getCursortPosition","containerEl","getSelection","rangeCount","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","startContainer","startOffset","exist","findBracket","spanLeft","spanRight","suggest","set_focus","savedSel","charIndex","createRange","setStart","collapse","node","nodeStack","foundStart","nodeType","nextCharIndex","sel","removeAllRanges","addRange","mouseDownEventHandler","parse2","setOldCell","isDisplay","inputEventHandler","inputType","chinese","showEditor","nodeValue","changed","changeText","cutValue","cuttingByPos2","valid2","keyDownEventHandler","which","opacity","setTextareaRange","position","blur","suggestItemClick","resetSuggestContentItems","resetSuggestItems","setItems","Editor","rowWidth","display","lock","datepicker","dateFormat","setCellEnd","getSelectedCellRiCi","currentTarget","key_num","f4ShortcutKey","bindInputEvents","clp","originalEvent","clipboardData","newNode","insertNode","selection","pasteHTML","execCommand","textFormat","off","focus","setRiCi","insertBefore","cursorPos","textBegin","textEnd","suggestPosition","elOffset","sOffset","menuItems","buildMenuItem","buildMenu","ContextMenu","isHide","menus","view","Dropdown","showArrow","placement","arrowChange","historyBorder","headerEl","DropdownFont","nfonts","setTitle","DropdownFontSize","nfontSizes","formatStringRender","formatNumberRender","fixed","baseFormats","multiply","a_s","toInteger","floatNum","times","isNegative","strfi","dotPos","intNum","o2","n1","n2","formatm","DropdownFormat","nformats","DropdownFormula","nformulas","DropdownColor","iconName","icon","colorPalette","DropdownAlign","aligns","naligns","setName","lineTypes","DropdownLineType","beforei","lineTypeEls","iti","buildTable","BorderPalette","ddColor","ddType","DropdownBorder","borderPalette","HistoryBorder","history","els","action","DropdownAction","buildButton","tooltipdata","elBox","tooltip","buildDivider","buildButtonWithIcon","bindDropdownChange","ddFormat","ddFont","ddFormula","ddFontSize","ddTextColor","ddFillColor","ddAlign","ddVAlign","ddBorder","undoEl","toggleChange","elName","types","hasClass","DropdownMore","moreBtns","initBtns2","btns2","btnChildren","computedStyle","marginLeft","marginRight","moreResize","widthFn","btns","moreEl","ddMore","sumWidth2","list1","list2","Toolbar","defaultStyle","redoEl","paintformatEl","clearformatEl","fontBoldEl","fontItalicEl","underlineEl","strikeEl","mergeEl","textwrapEl","freezeEl","addEl","closeEl","autofilterEl","throwFormulaEl","reset","getSelectedCellStyle","getSelectedCell","canUndo","canRedo","canUnmerge","canAutofilter","equationIsActive","freezeIsActive","Modal","open","dimmer","documentElement","clientHeight","clientWidth","xkeydownEsc","FormInput","hint","vchange","FormSelect","getTitle","itemEl","patterns","FormField","labelWidth","tip","pattern","Button","fieldLabelWidth","ModalValidation","mf","rf","cf","criteriaSelected","of","criteriaOperatorSelected","minvf","maxvf","svf","vf","btnClick","attrs","isShow","clsName","buildSortItem","buildFilterBody","filterbEl","filterValues","itemKeys","filterClick","resetFilterHeader","filterhEl","checked","SortFilter","tindex","sortAscEl","sortDescEl","sortDesc","from","findIndex","xtoast","Advice","saveCheck","textCheck","old_rows","new_rows","setCellRange","reference","tableProxy","sheetReset","mountCopy","choose","getChooseImg","parseDom","img2","sheetCopy","plain","pasteDirectionsArr","styles","tbody","tr","td","hidden","tmpNode","cloneNode","Website","tableEl","timer2","isDisplay2","td2","td3","td4","td5","isSpecialWebsite","screenX","screenY","ErrorPopUp","RectProxy","ex","ey","clientX","clientY","positionAngle","Timer","clearInterval","getCellDepend","PreAction","oldData","newData","oldStep","newCell","newMergesData","oldMergesData","changeArr","isRedo","setCellText","_data","_cells","setHeight","setWidth","scrollbarMove","verticalScrollbar","horizontalScrollbar","tableOffset","getTableOffset","fsw","fsh","selectorSet","render_timer","editorSetOffset","overlayerMousemove","rowResizer","colResizer","website","tRect","overlayerMousescroll","autoLoad","delta","deltaY","overlayerTouch","verticalScrollbarSet","totalHeight","horizontalScrollbarSet","totalWidth","sheetFreeze","fwidth","fheight","setFreezeLengths","overlayerEl","overlayerCEl","tOffset","vRect","renderAutoAdapt","autoRowResizer","toolbarChangeSelectorCell","clearClipboard","msg","toolbarChangePaintformatPaste","paintformatActive","paintFormatChange","paintformatToggle","dropDown","isAutofillEl","dstRect","getCellRectByXYWithNotTotalResult","dropGetPos","rpos","orien","isOusideViewRange","continueMove","shiftKey","getMovePos","selectorBeyondMove","rectProxy","isLocInside","getUpDownLeftRight","scrollTo","overlayerMousedown","sortFilter","advice","corner","hideDirectionArr","includes2","getSet","getSort","point","offsetParent","getPoint","clearStopTimer","continueDropDown","autofill","autofillNext","stopTimer","stopTimer2","setInterval","loadFormula","firstRowToWidth","colResizerFinished","adviceSetOffset","pictureSetOffset","pictureOffsetLeft","pictureOffsetTop","img","sPosition","selectorsSetOffset","resetSelectorBRLAreaOffset","hasEditor","editorSet","verticalScrollbarMove","scrolly","resetBRLAreaOffset","horizontalScrollbarMove","scrollx","resetBRTAreaOffset","viewRange2","autoAdapt","ignoreRi","getCellTextContent","getCellTextStyle","_ignore","cellWidth","record_rc","r_h","record_h","c_h","clickSelectorChangeRiCi","rowResizerFinished","setRowHeight","setColWidth","errorPop","errorPopUp","selectorCellText","dataSetCellText","setSelectedCellText","insertDeleteRowColumn","insert","toolbarChange","setContent","historyList","getMax","mri","mci","eachRange","showFreeze","setSelectedCellAttr","borderResSet","sortFilterChange","setAutoFilter","afterSelector","getLock","proxy","pasteEvent","mountPaste","sheetInitEvents","startx","starty","contextMenu","modalValidation","pasteOverlay","xyInSelectedRect","setPosition","touches","pageX","pageY","changedTouches","itext","editorChangeToHistory","getRICI","setSelectedCell","addValidation","removeValidation","getSelectedValidation","reload","focusing","altKey","addPic","pictures","deleteImg","trigger","Sheet","targetEl","showToolbar","showContextmenu","recalc","clickAutofill","styleBool","setFreeze","Drag","register","onBegin","cursor","nl","nt","onmousemove","nx","ny","onDrag","onmouseup","onEnd","returnValue","Resize","directionsArr","directions","div","onResize","querySelector","onmousedown","ox","oy","ow","oh","ol","ot","isResize","fun","mappers","ee","setLeft","setTop","se","nw","ws","ne","TableProxy","fontWeight","background","tableDom","colLen","defaultView","isHaveStyle","maxRi","maxCi","rii","cij","resizeOption","dragOption","lastCi","lastRi","spanDomPackage","spanDom","textArr","process","styleDom","GetInfoFromTable","cbd","kind","getAsString","textDom","imgDom","getElementsByTagName","mountImg","getAsFile","reader","FileReader","onload","readAsDataURL","getMaxCoord","nextLeft","nextTop","image","Image","containerHandlerEvent","direction_new","direction_delete","newX","tableObj","extend","dealColSpan","dealStyle","dealReference","parseTableCellRange","formatDate","calcDecimals","beginDate","beginDate2","second","fix","dateDiff","datePattern","operationItem","preAction","undoItems","redoItems","MultiPreAction","expr1","expr2","does","getItems","actionItems","actionType","PaintFormat","selectorRange","dstRange","dType","sType","getType","pArr","recordRi","rowIndex","_darr","changeDarrToDoubleArr","defaultSettings","canPaste","dst","scn","copyPaste","deleteCells","cleard","clipboard","setStyleBorder","bss","cstyle","addStyle","event_type","description","isLegal","processPasteDirectionsArr","newItem","clickCopyPasteHelp","lci","lri","lcell","setStyleBorders","isSignleSelected","mergeIndexes","mrl","mcl","getCellMerge","getCellRowByY","scrollOffsety","inits","frset","getCellColByX","scrollOffsetx","rangeReduceIf","makeFormatCell","symbol","cText","getCellStyle","getCellStyleConvert","minute","changeFormat","useOne","DataProxy","methods","hyperlinks","comments","multiPreAction","moved","unsortedRowMap","cell2","cell3","makeCellPropArr","setCellByCellProp","paintFormat","paintType","getPaintType","makePaintArr","srcRange","getFirstIncludes","unmerge","nfont","resetAutoFilter","getStepType","oc","nc","addStep","isClear","autoFilterRef","addFilter","setSort","filteredRows","fary","oldAry","si","rsize","csize","isBackEndFunc","p1","p2","A1","filterIntersects","frary","nstyle","lastStep","changeToHistory","addFiexRows","revision","bugout","realTimeLoggingOn","useTimestamps","useLocalStorage","recordLogs","autoTrim","maxLines","tailNumLines","logFilename","depth","parentSizes","currentResult","startTime","output","version","getLog","retrievalTime","saved","localStorage","getItem","lastLog","formatSessionDuration","tail","numLines","tailLines","trimLog","lines","rgx","matched","addr","getSlice","lineNumber","downloadLog","file","logFile","encodeURIComponent","href","download","clearTime","saveObject","setItem","determineType","addition","logTime","formatTimestamp","last","typeResult","formatType","objectSize","prop","indentsForDepth","subtype","subresult","endTime","msec","hh","hrs","mm","mins","ss","timestamp","getHours","getMinutes","getSeconds","Spreadsheet","alias","zhCN","rootEl","loadData","selectorEditorReset","getCellByExpr","jsSpreadsheet","drag","getSanitizedSheetName","possition_i","range_expression","start_pst","end_pst","aux","range_start_pst","max_row","min_row","str_max_row","min_col","max_col","cell_full_name","numeral","num2e","allzero","decimalsToFractional","decimals","formatDecimals","recursion","isInteger","ASC","BAHTTEXT","CHAR","CLEAN","CODE","CONCATENATE","trueFound","falseFound","DBCS","DOLLAR","EXACT","text1","text2","FIND","find_text","within_text","FIXED","no_commas","HTML2TEXT","INDEX","row_num","column_num","LEFT","LEN","LOWER","MID","NUMBERVALUE","decimal_separator","group_separator","PRONETIC","PROPER","REGEXEXTRACT","regular_expression","REGEXMATCH","full","REGEXREPLACE","replacement","REPLACE","new_text","REPT","RIGHT","SEARCH","foundAt","SPLIT","separator","SUBSTITUTE","old_text","occurrence","TEXT","Formulas","AllFormulas","fmt","TRIM","UNICHAR","UNICODE","UPPER","VALUE","unformat","CELL","ERROR","TYPE","error_val","nil","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISODD","ISREF","ISTEXT","NA","SHEET","SHEETS","WEEK_STARTS","WEEK_TYPES","WEEKEND_TYPES","isLeapYear","daysBetween","start_date","end_date","serial","DATE","DATEVALUE","date_text","DAY","serial_number","method","ed","sm","em","smd","emd","EDATE","EOMONTH","HOUR","INTERVAL","hour","sec","ISOWEEKNUM","setHours","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","weekend","NETWORKDAYS$INTL","days","getTimezoneOffset","getUTCDay","dec","holiday","INTL","NOW","SECOND","TIME","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","week_start","jan","inc","WORKDAY","YEAR","ylength","date1","date2","year1","mar1year1","year2","mar1year2","feb29Between","years","quotedMatch","resolved_ref","ref_cell","categories","category","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","path","opening","JOIN","NUMBERS","NUMERAL","bessel","isValidBinaryNumber","trans_num","inumber","BESSELI","besseli","BESSELJ","besselj","BESSELK","besselk","BESSELY","bessely","BIN2DEC","stringified","BIN2HEX","BIN2OCT","BITAND","number1","number2","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Ti","Gi","Mi","ki","unit_prefixes","Y","E","G","u","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","lower_bound","upper_bound","erf","erfc","GESTEP","HEX2BIN","decimal","HEX2DEC","HEX2OCT","IMABS","IMREAL","IMAGINARY","plus","unit","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","trans_dict"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([206,2,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var error = require('./error');\n\nfunction flattenShallow(array) {\n  if (!array || !array.reduce) { return array; }\n  return array.reduce(function(a, b) {\n    var aIsArray = Array.isArray(a);\n    var bIsArray = Array.isArray(b);\n    if (aIsArray && bIsArray ) {\n      return a.concat(b);\n    }\n    if (aIsArray) {\n      a.push(b);\n      return a;\n    }\n    if (bIsArray) {\n      return [a].concat(b);\n    }\n    return [a, b];\n  });\n}\n\nfunction isFlat(array) {\n  if (!array) { return false; }\n  for (var i = 0; i < array.length; ++i) {\n    if (Array.isArray(array[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexports.flatten = function() {\n  var result = exports.argsToArray.apply(null, arguments);\n  while (!isFlat(result)) {\n    result = flattenShallow(result);\n  }\n  return result;\n};\n\nexports.argsToArray = function(args) {\n  return Array.prototype.slice.call(args, 0);\n};\n\nexports.numbers = function() {\n\n  return possibleNumbers.filter(function(el) {\n    return typeof el === 'number';\n  });\n};\n//XW: 将参数解析成数字数组，若有不符合要求的报错，default0忽略\nfunction parse(a){\n  if (a instanceof Error){\n    return a\n  }\n  if (a instanceof Array){\n    var arr = []\n    for (var i=0;i<a.length;i++){\n      if (typeof a[i][0] === 'string' && a[i][0] !== 'default_0'){\n        return error.name\n      }\n      if (typeof a[i][0] === 'number'){\n        arr.push(a[i][0])\n      }\n      if (a[i][0] instanceof Object){\n        return error.name\n      }\n    }\n    return arr\n  }\n  if (typeof a === 'string'){\n    if (a === 'default_0'){\n      return 'pass'\n    }else{\n      return error.name\n    }\n  }\n  if (typeof a === 'number'){\n    return a\n  }\n}\nexports.flattenNum = function(args) {\n  try{\n    if (args.length === 1 && args[0][0] === 'default_0'){\n      return error.div0\n    }\n    var arr = []\n    for( var i=0;i<args.length;i++){\n      var p = parse(args[i])\n      if (p === undefined){\n        return error.name\n      }\n      if (p instanceof Error){\n        return p\n      }else if(p !== 'pass'){\n        if (p instanceof Array){\n          for (var n=0; n < p.length;n++){\n            arr.push(p[n])\n          }\n        }else{\n          arr.push(p)\n        }\n      }\n    }\n    return arr\n  }catch{\n    return error.name\n  }\n};\n//XW:end\n\nexports.cleanFloat = function(number) {\n  var power = 1e14;\n  return Math.round(number * power) / power;\n};\n\nexports.parseBool = function(bool) {\n  if (bool === undefined){\n    return true\n  }\n  if (typeof bool === 'boolean') {\n    return bool;\n  }\n\n  if (bool instanceof Error) {\n    return bool;\n  }\n\n  if (typeof bool === 'number') {\n    return bool !== 0;\n  }\n\n  if (typeof bool === 'string') {\n    var up = bool.toUpperCase();\n    if (up === 'TRUE') {\n      return true;\n    }\n\n    if (up === 'FALSE') {\n      return false;\n    }\n  }\n\n  if (bool instanceof Date && !isNaN(bool)) {\n    return true;\n  }\n\n  return error.value;\n};\n\nexports.parseNumber = function(string) {\n  if (string === undefined || string === '') {\n    return error.value;\n  }\n  if (!isNaN(string)) {\n    return parseFloat(string);\n  }\n  return error.value;\n};\n\nexports.parseNumberArray = function(arr) {\n  var len;\n  if (!arr || (len = arr.length) === 0) {\n    return error.value;\n  }\n  var parsed;\n  while (len--) {\n    parsed = exports.parseNumber(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.parseMatrix = function(matrix) {\n  var n;\n  if (!matrix || (n = matrix.length) === 0) {\n    return error.value;\n  }\n  var pnarr;\n  for (var i = 0; i < matrix.length; i++) {\n    pnarr = exports.parseNumberArray(matrix[i]);\n    matrix[i] = pnarr;\n    if (pnarr instanceof Error) {\n      return pnarr;\n    }\n  }\n  return matrix;\n};\n\nvar d1900 = new Date(1900, 0, 1);\nexports.parseDate = function(date) {\n  if (!isNaN(date)) {\n    if (date instanceof Date) {\n      return new Date(date);\n    }\n    var d = parseInt(date, 10);\n    if (d < 0) {\n      return error.num;\n    }\n    if (d <= 60) {\n      return new Date(d1900.getTime() + (d - 1) * 86400000);\n    }\n    return new Date(d1900.getTime() + (d - 2) * 86400000);\n  }\n  if (typeof date === 'string') {\n    date = new Date(date);\n    if (!isNaN(date)) {\n      return date;\n    }\n  }\n  return error.value;\n};\nexports.Copy =  function (obj) {\n  // Handle the 3 simple types, and null or undefined\n  if (null == obj || \"object\" != typeof obj) return obj;\n  // Handle Date\n  if (obj instanceof Date) {\n    var copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n  // Handle Array\n  if (obj instanceof Array) {\n    var copy = [];\n    for (var i = 0; i < obj.length; ++i) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n  // Handle Object\n  if (obj instanceof Object) {\n    var copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n};\n//XW:{}中参数解析,将{1,2,3；4,5,6}这样的参数解析为数组结构\nfunction parse_arg(arg) {\n  if(!isNaN(parseInt(arg))){\n    return parseInt(arg)\n  }\n  return arg.replace('\"', '').replace('\"', '')\n}\nexports.strToMatrix = function (str) {\n  var arg = str.slice(2,str.length-2).split(',')\n  var matrix = [];\n  var arr = []\n  for (var i=0; i < arg.length; i++){\n    var num = arg[i].toString()\n    if (num.indexOf(';') > 0) {\n      arr.push(parse_arg(num.split(';')[0]))\n      matrix.push(arr)\n      arr = [parse_arg(num.split(';')[1])]\n    }else{\n      arr.push(parse_arg(num))\n    }\n  }\n  matrix.push(arr)\n  return matrix\n}\n//XW: end\n//XW：excel日期转js日期\nexports.ExcelDateToJSDate = function (date) {\n  if (typeof date == 'string'){\n    date = utils.parseDate(issue)\n  }\n  return (date instanceof Date) ? date : new Date(Math.round((date - 25569)*86400*1000));\n}\n//XW：end\n//XW：判定是否是数字\nexports.isNumber = function (val) {\n  var regPos = /^\\d+(\\.\\d+)?$/; //非负浮点数\n  var regNeg = /^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/; //负浮点数\n  if(regPos.test(val) || regNeg.test(val)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n//XW：end\nexports.parseDateArray = function(arr) {\n  var len = arr.length;\n  var parsed;\n  while (len--) {\n    parsed = this.parseDate(arr[len]);\n    if (parsed === error.value) {\n      return parsed;\n    }\n    arr[len] = parsed;\n  }\n  return arr;\n};\n\nexports.anyIsError = function() {\n  var n = arguments.length;\n  while (n--) {\n    if (arguments[n] instanceof Error) {\n      return true;\n    }\n  }\n  return false;\n};\n\nexports.arrayValuesToNumbers = function(arr) {\n  var n = arr.length;\n  var el;\n  while (n--) {\n    el = arr[n];\n    if (typeof el === 'number') {\n      continue;\n    }\n    if (el === true) {\n      arr[n] = 1;\n      continue;\n    }\n    if (el === false) {\n      arr[n] = 0;\n      continue;\n    }\n    if (typeof el === 'string') {\n      var number = this.parseNumber(el);\n      if (number instanceof Error) {\n        arr[n] = 0;\n      } else {\n        arr[n] = number;\n      }\n    }\n  }\n  return arr;\n};\n\nexports.rest = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(idx);\n};\n\nexports.initial = function(array, idx) {\n  idx = idx || 1;\n  if (!array || typeof array.slice !== 'function') {\n    return array;\n  }\n  return array.slice(0, array.length - idx);\n};\n","\"use strict\";\n\nmodule.exports = function RawValue(value) {\n    this.setValue = function(v) {\n        value = v;\n    };\n    this.calc = function() {\n        return value;\n    };\n};\n","var numeric = require('numeric');\nvar utils = require('./utils');\nvar error = require('./error');\nvar statistical = require('./statistical');\nvar information = require('./information');\n\nexports.ABS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.abs(utils.parseNumber(number));\n};\n\nexports.ACOS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.acos(number);\n};\n\nexports.ACOSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number - 1));\n};\n\nexports.ACOT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(1 / number);\n};\n\nexports.ACOTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 0.5 * Math.log((number + 1) / (number - 1));\n};\n\n//TODO: use options\nexports.AGGREGATE = function(function_num, options, ref1, ref2) {\n  function_num = utils.parseNumber(function_num);\n  options = utils.parseNumber(options);\n  //XW: 函数报错\n  if (typeof ref1 == 'string') {\n    return error.value\n  }//XW:end\n  if (utils.anyIsError(function_num, options)) {\n    return error.value;\n  }\n  switch (function_num) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n    case 12:\n      return statistical.MEDIAN(ref1, ref2);\n    case 13:\n      return statistical.MODE.SNGL(ref1);\n    case 14:\n      return statistical.LARGE(ref1, ref2);\n    case 15:\n      if (ref2 == undefined){\n        return error.value\n      }\n      return statistical.SMALL(ref1, ref2);\n    case 16:\n      return statistical.PERCENTILE.INC(ref1, ref2);\n    case 17:\n      return statistical.QUARTILE.INC(ref1, ref2);\n    case 18:\n      return statistical.PERCENTILE.EXC(ref1, ref2);\n    case 19:\n      return statistical.QUARTILE.EXC(ref1, ref2);\n  }\n};\n\nexports.ARABIC = function(text) {\n  // Credits: Rafa? Kukawski\n  text = text.toUpperCase()\n  if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\n    return error.value;\n  }\n  var r = 0;\n  text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function (i) {\n    r += {\n      M: 1000,\n      CM: 900,\n      D: 500,\n      CD: 400,\n      C: 100,\n      XC: 90,\n      L: 50,\n      XL: 40,\n      X: 10,\n      IX: 9,\n      V: 5,\n      IV: 4,\n      I: 1\n    }[i];\n  });\n  return r;\n};\n\nexports.ASIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.asin(number);\n};\n\nexports.ASINH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number + Math.sqrt(number * number + 1));\n};\n\nexports.ATAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.atan(number);\n};\n\nexports.ATAN2 = function(number_x, number_y) {\n  number_x = utils.parseNumber(number_x);\n  number_y = utils.parseNumber(number_y);\n  if (utils.anyIsError(number_x, number_y)) {\n    return error.value;\n  }\n  return Math.atan2(number_x, number_y);\n};\n\nexports.ATANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log((1 + number) / (1 - number)) / 2;\n};\n\nexports.BASE = function(number, radix, min_length) {\n  min_length = min_length || 0;\n\n  number = utils.parseNumber(number);\n  radix = utils.parseNumber(radix);\n  min_length = utils.parseNumber(min_length);\n  if (utils.anyIsError(number, radix, min_length)) {\n    return error.value;\n  }\n  min_length = (min_length === undefined) ? 0 : min_length;\n  var result = number.toString(radix);\n  return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\n};\n\nexports.CEILING = function(number, significance, mode) {\n  significance = (significance === undefined) ? 1 : Math.abs(significance);\n  mode = mode || 0;\n\n  number = utils.parseNumber(number);\n  significance = utils.parseNumber(significance);\n  mode = utils.parseNumber(mode);\n  if (utils.anyIsError(number, significance, mode)) {\n    return error.value;\n  }\n  if (significance === 0) {\n    return 0;\n  }\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return exports.ROUND(Math.ceil(number / significance) * significance, precision);\n  } else {\n    if (mode === 0) {\n      return -exports.ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n    } else {\n      return -exports.ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n    }\n  }\n};\n\nexports.CEILING.MATH = exports.CEILING;\n\nexports.CEILING.PRECISE = exports.CEILING;\n\nexports.COMBIN = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\n};\n\nexports.COMBINA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\n};\n\nexports.COS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.cos(number);\n};\n\nexports.COSH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return (Math.exp(number) + Math.exp(-number)) / 2;\n};\n\nexports.COT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.tan(number);\n};\n\nexports.COTH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 + 1) / (e2 - 1);\n};\n\nexports.CSC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.sin(number);\n};\n\nexports.CSCH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) - Math.exp(-number));\n};\n\nexports.DECIMAL = function(number, radix) {\n  if (arguments.length < 1) {\n    return error.value;\n  }\n\n\n  return parseInt(number, radix);\n};\n\nexports.DEGREES = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * 180 / Math.PI;\n};\n\nexports.EVEN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return exports.CEILING(number, -2, -1);\n};\n\nexports.EXP = Math.exp;\n\nvar MEMOIZED_FACT = [];\nexports.FACT = function (number) {\n  number = utils.parseNumber(number);\n  if (number < 0){\n    return error.num\n  }\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n === 0 || n === 1) {\n    return 1;\n  } else if (MEMOIZED_FACT[n] > 0) {\n    return MEMOIZED_FACT[n];\n  } else {\n    MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\n    return MEMOIZED_FACT[n];\n  }\n};\n\nexports.FACTDOUBLE = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var n = Math.floor(number);\n  if (n <= 0) {\n    return 1;\n  } else {\n    return n * exports.FACTDOUBLE(n - 2);\n  }\n};\n\n//TODO: Verify\n// XW: 自己写的函数\nexports.FLOOR = {};\nvar ROUND = function (value, places) {\n  var n = value;\n  var d = places;\n  return Math.round(n * Math.pow(10, d)) / Math.pow(10, d);\n};\nexports.FLOORMATH = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number>0&&significance<0){\n    return error.num\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\nexports.FLOORPRACE = function(number, significance, mode) {\n  if (typeof number !='number'){ //\n    return error.value; // ERROR_VALUE = '#VALUE!'\n  }\n  if (number<0&&significance<0){\n    number = -number\n    significance = -significance\n    var precision = -Math.floor(Math.log(significance) / Math.log(10));\n    return -ROUND(Math.floor(number / significance) * significance, precision);\n  }\n  significance = (significance === undefined) ? 1 : significance;\n  mode = (mode === undefined) ? 0 : mode;\n  if (significance === 0) {\n    return 0;\n  }\n\n  significance = significance ? Math.abs(significance) : 1;\n  var precision = -Math.floor(Math.log(significance) / Math.log(10));\n  if (number >= 0) {\n    return ROUND(Math.floor(number / significance) * significance, precision);\n  } else if (mode === 0 || mode === undefined) {\n    return -ROUND(Math.ceil(Math.abs(number) / significance) * significance, precision);\n  }\n  return -ROUND(Math.floor(Math.abs(number) / significance) * significance, precision);\n}\n\n// Deprecated\nexports.FLOOR.MATH = exports.FLOORMATH;\nexports.FLOOR.PRECISE = exports.FLOORPRACE;\n//XW: end\n// adapted http://rosettacode.org/wiki/Greatest_common_divisor#JavaScript\nexports.GCD = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var r0 = range[0];\n  var x = r0 < 0 ? -r0 : r0;\n  for (var i = 1; i < n; i++) {\n    var ri = range[i];\n    var y = ri < 0 ? -ri : ri;\n    while (x && y) {\n      if (x > y) {\n        x %= y;\n      } else {\n        y %= x;\n      }\n    }\n    x += y;\n  }\n  return x;\n};\n\n\nexports.INT = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.floor(number);\n};\n\n//TODO: verify\nexports.ISO = {\n  CEILING: exports.CEILING\n};\n\nexports.LCM = function() {\n  // Credits: Jonas Raoni Soares Silva\n  var o = utils.parseNumberArray(utils.flatten(arguments));\n  if (o instanceof Error) {\n    return o;\n  }\n  for (var i, j, n, d, r = 1;\n    (n = o.pop()) !== undefined;) {\n    while (n > 1) {\n      if (n % 2) {\n        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\n          //empty\n        }\n        d = (i <= j) ? i : n;\n      } else {\n        d = 2;\n      }\n      for (n /= d, r *= d, i = o.length; i;\n        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\n        //empty\n      }\n    }\n  }\n  return r;\n};\n\nexports.LN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number);\n};\n\nexports.LOG = function (number, base) {\n  number = utils.parseNumber(number);\n  base = utils.parseNumber(base);\n  if (utils.anyIsError(base)) {\n    base = 10\n  }\n  base = (base === undefined) ? 10 : base;\n  return Math.log(number) / Math.log(base);\n};\n\nexports.LOG10 = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.log(number) / Math.log(10);\n};\n\nexports.MDETERM = function(matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix);\n  }\n  try{\n    return numeric.det(matrix);\n  }catch (e) {\n    return error.value\n  }\n};\n\nexports.MINVERSE = function(matrix) {\n  matrix = utils.parseMatrix(matrix);\n  if (matrix instanceof Error) {\n    return matrix;\n  }\n  return numeric.inv(matrix);\n};\n\nexports.MMULT = function(matrix1, matrix2) {\n  matrix1 = utils.parseMatrix(matrix1);\n  matrix2 = utils.parseMatrix(matrix2);\n  if (utils.anyIsError(matrix1, matrix2)) {\n    return error.value;\n  }\n  console.log(numeric.dot(matrix1, matrix2))\n  return numeric.dot(matrix1, matrix2);\n};\n\nexports.MOD = function(dividend, divisor) {\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n  if (divisor === 0) {\n    return error.div0;\n  }\n  var modulus = Math.abs(dividend % divisor);\n  return (divisor > 0) ? modulus : -modulus;\n};\n\n  exports.MROUND = function(number, multiple) {\n  number = utils.parseNumber(number);\n  multiple = utils.parseNumber(multiple);\n  if (utils.anyIsError(number, multiple)) {\n    return error.value;\n  }\n  if (number * multiple < 0) {\n    return error.num;\n  }\n\n  return Math.round(number / multiple) * multiple;\n};\n\nexports.MULTINOMIAL = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var sum = 0;\n  var divisor = 1;\n  for (var i = 0; i < args.length; i++) {\n    sum += args[i];\n    divisor *= exports.FACT(args[i]);\n  }\n  return exports.FACT(sum) / divisor;\n};\n\nexports.MUNIT = function(dimension) {\n  dimension = utils.parseNumber(dimension);\n  if (dimension instanceof Error) {\n    return dimension;\n  }\n  return numeric.identity(dimension);\n};\n\nexports.ODD = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var temp = Math.ceil(Math.abs(number));\n  temp = (temp & 1) ? temp : temp + 1;\n  return (number > 0) ? temp : -temp;\n};\n\nexports.PI = function() {\n  return Math.PI;\n};\n\nexports.POWER = function(number, power) {\n  number = utils.parseNumber(number);\n  power = utils.parseNumber(power);\n  if (utils.anyIsError(number, power)) {\n    return error.value;\n  }\n  var result = Math.pow(number, power);\n  if (isNaN(result)) {\n    return error.num;\n  }\n\n  return result;\n};\n\nexports.PRODUCT = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  var result = 1;\n  for (var i = 0; i < args.length; i++) {\n    result *= args[i];\n  }\n  return result;\n};\n\nexports.QUOTIENT = function(numerator, denominator) {\n  numerator = utils.parseNumber(numerator);\n  denominator = utils.parseNumber(denominator);\n  if (utils.anyIsError(numerator, denominator)) {\n    return error.value;\n  }\n  return parseInt(numerator / denominator, 10);\n};\n\nexports.RADIANS = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return number * Math.PI / 180;\n};\n\nexports.RAND = function() {\n  if (arguments.length > 0 && arguments[0] !== undefined){\n    return error.value\n  }\n  return Math.random();\n};\n\nexports.RANDBETWEEN = function(bottom, top) {\n  bottom = utils.parseNumber(bottom);\n  top = utils.parseNumber(top);\n  if (utils.anyIsError(bottom, top)) {\n    return error.value;\n  }\n  // Creative Commons Attribution 3.0 License\n  // Copyright (c) 2012 eqcode\n  return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\n};\n\n// TODO\nexports.ROMAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // The MIT License\n  // Copyright (c) 2008 Steven Levithan\n  var digits = String(number).split('');\n  var key = ['', 'C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM', '', 'X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC', '', 'I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX'];\n  var roman = '';\n  var i = 3;\n  while (i--) {\n    roman = (key[+digits.pop() + (i * 10)] || '') + roman;\n  }\n  return new Array(+digits.join('') + 1).join('M') + roman;\n};\n\nexports.ROUND = function (number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  if (number < 0){\n    number = 0-number\n    return 0-Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n  }\n  return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\n};\n\nexports.ROUNDDOWN = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.ROUNDUP = function(number, digits) {\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};\n\nexports.SEC = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 1 / Math.cos(number);\n};\n\nexports.SECH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return 2 / (Math.exp(number) + Math.exp(-number));\n};\n\nexports.SERIESSUM = function(x, n, m, coefficients) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  m = utils.parseNumber(m);\n  coefficients = utils.parseNumberArray(coefficients);\n  if (utils.anyIsError(x, n, m, coefficients)) {\n    return error.value;\n  }\n  var result = coefficients[0] * Math.pow(x, n);\n  for (var i = 1; i < coefficients.length; i++) {\n    result += coefficients[i] * Math.pow(x, n + i * m);\n  }\n  return result;\n};\n\nexports.SIGN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  if (number < 0) {\n    return -1;\n  } else if (number === 0) {\n    return 0;\n  } else {\n    return 1;\n  }\n};\n\nexports.SIN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.sin(number);\n};\n\n  exports.SINH = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return (Math.exp(number) - Math.exp(-number)) / 2;\n  };\n\n  exports.SQRT = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    if (number < 0) {\n      return error.num;\n    }\n    return Math.sqrt(number);\n  };\n\n  exports.SQRTPI = function(number) {\n    number = utils.parseNumber(number);\n    if (number instanceof Error) {\n      return number;\n    }\n    return Math.sqrt(number * Math.PI);\n  };\n\nexports.SUBTOTAL = function(function_code, ref1) {\n  function_code = utils.parseNumber(function_code);\n  if (function_code instanceof Error) {\n    return function_code;\n  }\n  switch (function_code) {\n    case 1:\n      return statistical.AVERAGE(ref1);\n    case 2:\n      return statistical.COUNT(ref1);\n    case 3:\n      return statistical.COUNTA(ref1);\n    case 4:\n      return statistical.MAX(ref1);\n    case 5:\n      return statistical.MIN(ref1);\n    case 6:\n      return exports.PRODUCT(ref1);\n    case 7:\n      return statistical.STDEV.S(ref1);\n    case 8:\n      return statistical.STDEV.P(ref1);\n    case 9:\n      return exports.SUM(ref1);\n    case 10:\n      return statistical.VAR.S(ref1);\n    case 11:\n      return statistical.VAR.P(ref1);\n      // no hidden values for us\n    case 101:\n      return statistical.AVERAGE(ref1);\n    case 102:\n      return statistical.COUNT(ref1);\n    case 103:\n      return statistical.COUNTA(ref1);\n    case 104:\n      return statistical.MAX(ref1);\n    case 105:\n      return statistical.MIN(ref1);\n    case 106:\n      return exports.PRODUCT(ref1);\n    case 107:\n      return statistical.STDEV.S(ref1);\n    case 108:\n      return statistical.STDEV.P(ref1);\n    case 109:\n      return exports.SUM(ref1);\n    case 110:\n      return statistical.VAR.S(ref1);\n    case 111:\n      return statistical.VAR.P(ref1);\n\n  }\n};\n\nexports.ADD = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.name;\n  }\n\n  return num1 + num2;\n};\n\nexports.MINUS = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.value;\n  }\n\n  return num1 - num2;\n};\n\nexports.DIVIDE = function (dividend, divisor) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  dividend = utils.parseNumber(dividend);\n  divisor = utils.parseNumber(divisor);\n  if (utils.anyIsError(dividend, divisor)) {\n    return error.value;\n  }\n\n  if (divisor === 0) {\n    return error.div0;\n  }\n\n  return dividend / divisor;\n};\n\nexports.MULTIPLY = function (factor1, factor2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  factor1 = utils.parseNumber(factor1);\n  factor2 = utils.parseNumber(factor2);\n  if (utils.anyIsError(factor1, factor2)) {\n    return error.value;\n  }\n\n  return factor1 * factor2;\n};\n\nexports.GTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 >= num2;\n};\n\nexports.LT = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 < num2;\n};\n\n\nexports.LTE = function (num1, num2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  num1 = utils.parseNumber(num1);\n  num2 = utils.parseNumber(num2);\n  if (utils.anyIsError(num1, num2)) {\n    return error.error;\n  }\n\n  return num1 <= num2;\n};\n\nexports.EQ = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 === value2;\n};\n\nexports.NE = function (value1, value2) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  return value1 !== value2;\n};\n\nexports.POW = function (base, exponent) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  base = utils.parseNumber(base);\n  exponent = utils.parseNumber(exponent);\n  if (utils.anyIsError(base, exponent)) {\n    return error.error;\n  }\n\n  return exports.POWER(base, exponent);\n};\n\nexports.SUM = function() {\n  var result = 0;\n  var argsKeys = Object.keys(arguments);\n  for (var i = 0; i < argsKeys.length; ++i) {\n    var elt = arguments[argsKeys[i]];\n    if (typeof elt === 'number') {\n      result += elt;\n    } else if (typeof elt === 'string') {\n      var parsed = parseFloat(elt);\n      !isNaN(parsed) && (result += parsed);\n    } else if (Array.isArray(elt)) {\n      result += exports.SUM.apply(null, elt);\n    }\n  }\n  return result;\n};\n\nexports.SUMIF = function(range, criteria) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (range instanceof Error) {\n    return range;\n  }\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\n  }\n  return result;\n};\n//XW： SUMIFS函数\nexports.SUMIFS = function() {\n  var args = utils.argsToArray(arguments);\n  var range = utils.flatten(args.shift());\n  if (range instanceof Error) {\n    return range;\n  }\n  if (args.length % 2 !== 0) {\n    return error.value;\n  }\n  for (let i = 0; i < args.length; i += 2) {\n    if (args[i].length !== range.length || !args[i + 1]) {\n      return error.value;\n    }\n  }\n  let arr = [];\n  var result = 0;\n  for (let i = 0; i < args.length; i += 2) {\n    let s_arr = [];\n    for (let j = 0; j < args[i].length; j++) {\n      let compareValue = args[i + 1] + \"\";\n      if (compareValue.lastIndexOf(\">=\") == 0) {\n        compareValue = compareValue.replace(/>=/, \"\");\n        if (isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 <= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }else if (compareValue.lastIndexOf(\"<=\") == 0) {\n        compareValue = compareValue.replace(/<=/, \"\");\n        if(isNaN(compareValue)) {\n          str = true;\n        }\n        if (compareValue * 1 >= args[i][j][0]) {\n          s_arr.push(j);\n        }\n      }\n      compareValue = compareValue.replace(\"=\", \"\");\n      if (compareValue.lastIndexOf(\"<>\") == 0) {\n        compareValue = compareValue.replace(/<>/, \"\");\n        if (compareValue !== args[i][j][0]) {\n          s_arr.push(j);\n        }\n      } else {\n        let str = false;\n        if (compareValue.lastIndexOf(\"<\") == 0) {\n          compareValue = compareValue.replace(/</, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 > args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else if (compareValue.lastIndexOf(\">\") == 0) {\n          compareValue = compareValue.replace(/>/, \"\");\n          if(isNaN(compareValue)) {\n            str = true;\n          }\n          if (compareValue * 1 < args[i][j][0]) {\n            s_arr.push(j);\n          }\n        } else {\n          if (compareValue.indexOf('*') > 0){\n            var v = compareValue\n            v = v.replace('*', '')\n            if (typeof args[i][j][0] == 'string' && args[i][j][0].indexOf(v) >= 0){\n              s_arr.push(j);\n            }\n          }\n          if(isNaN(compareValue)) {\n            if(compareValue === args[i][j][0]) {\n              s_arr.push(j);\n            }\n          } else {\n            if(compareValue * 1 === args[i][j][0]) {\n              s_arr.push(j);\n            }\n\n          }\n        }\n        if(str) {\n          return error.value;\n        }\n      }\n\n    }\n    arr.push(s_arr);\n  }\n\n  let resultArr = [];\n  for (let i = 0; i < arr.length; i++) {\n    for (let j = 0; j < arr[i].length; j++) {\n      let value = arr[i][j];\n      let enter = 1;\n      for (let k = 0; enter !== 3 && k < arr.length; k++) {\n        if (k !== i && arr[k].indexOf(value) != -1) {\n          enter = 2;\n        } else if (k !== i) {\n          enter = 3;\n        }\n      }\n      if (enter == 1 && arr.length > 1) {\n        enter = 3;\n      } else if (enter == 1 && arr.length === 1) {\n        enter = 2;\n      }\n      if (enter == 2 && resultArr.indexOf(value) == -1) {\n        resultArr.push(value);\n      }\n    }\n  }\n\n  if (arr.length <= 0) {\n    return error.value;\n  }\n\n  for (let i = 0; i < resultArr.length; i++) {\n    let a = range[resultArr[i]];\n    if (a && !isNaN(a)) {\n      result += a;\n    } else {\n      return 0;\n    }\n  }\n\n  return result;\n};\n//XW：end\n\nexports.SUMPRODUCT = function() {\n  if (!arguments || arguments.length === 0) {\n    return error.value;\n  }\n  var arrays = arguments.length + 1;\n  var result = 0;\n  var product;\n  var k;\n  var _i;\n  var _ij;\n  for (var i = 0; i < arguments[0].length; i++) {\n    if (!(arguments[0][i] instanceof Array)) {\n      product = 1;\n      for (k = 1; k < arrays; k++) {\n        _i = utils.parseNumber(arguments[k - 1][i]);\n        if (_i instanceof Error) {\n          return _i;\n        }\n        product *= _i;\n      }\n      result += product;\n    } else {\n      for (var j = 0; j < arguments[0][i].length; j++) {\n        product = 1;\n        for (k = 1; k < arrays; k++) {\n          _ij = utils.parseNumber(arguments[k - 1][i][j]);\n          if (_ij instanceof Error) {\n            return _ij;\n          }\n          product *= _ij;\n        }\n        result += product;\n      }\n    }\n  }\n  return result;\n};\n\nexports.SUMSQ = function() {\n  var numbers = utils.parseNumberArray(utils.flatten(arguments));\n  if (numbers instanceof Error) {\n    return numbers;\n  }\n  var result = 0;\n  var length = numbers.length;\n  for (var i = 0; i < length; i++) {\n    result += (information.ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\n  }\n  return result;\n};\n\nexports.SUMX2MY2 = function (array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMX2PY2 = function (array_x, array_y) {\n  //XW: 参数转数组\n  if (typeof array_x == \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y == \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  //XW：end\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  for (var i = 0; i < array_x.length; i++) {\n    result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\n  }\n  return result;\n};\n\nexports.SUMXMY2 = function(array_x, array_y) {\n  if (typeof array_x === \"string\") {\n    array_x = utils.strToMatrix(array_x);\n  }\n  if (typeof array_y === \"string\") {\n    array_y = utils.strToMatrix(array_y);\n  }\n  array_x = utils.parseNumberArray(utils.flatten(array_x));\n  array_y = utils.parseNumberArray(utils.flatten(array_y));\n  if (utils.anyIsError(array_x, array_y)) {\n    return error.value;\n  }\n  var result = 0;\n  array_x = utils.flatten(array_x);\n  array_y = utils.flatten(array_y);\n  for (var i = 0; i < array_x.length; i++) {\n    result += Math.pow(array_x[i] - array_y[i], 2);\n  }\n  return result;\n};\n\nexports.TAN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return Math.tan(number);\n};\n\nexports.TANH = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  var e2 = Math.exp(2 * number);\n  return (e2 - 1) / (e2 + 1);\n};\n\nexports.TRUNC = function(number, digits) {\n  digits = (digits === undefined) ? 0 : digits;\n  number = utils.parseNumber(number);\n  digits = utils.parseNumber(digits);\n  if (utils.anyIsError(number, digits)) {\n    return error.value;\n  }\n  var sign = (number > 0) ? 1 : -1;\n  return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\n};","var mathTrig = require('./math-trig');\nvar text = require('./text');\nvar jStat = require('jStat').jStat;\nvar utils = require('./utils');\nvar error = require('./error');\nvar misc = require('./miscellaneous');\nvar evalExpression = require('./expression')\nvar SQRT2PI = 2.5066282746310002;\n\nexports.AVEDEV = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0]) / range.length;\n};\n\nexports.AVERAGE = function() {\n  var range = utils.flattenNum(arguments);\n  if (range instanceof Error) {\n    return range;\n  }\n  if (range.length === 0){\n    return error.div0\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    sum += range[i];\n    count += 1;\n  }\n  return sum / count;\n};\n\nexports.AVERAGEA = function() {\n  var range = utils.flattenNum(arguments);\n  if (range.length == 1 && isNaN(range[0])){\n    return error.value\n  }\n  var n = range.length;\n  var sum = 0;\n  var count = 0;\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sum += el;\n    }\n    if (el === true) {\n      sum++;\n    }\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sum / count;\n};\n\nexports.AVERAGEIF = function (range, criteria, average_range) {\n  if (arguments.length <= 1) {\n    return error.na;\n  }\n  average_range = average_range || range;\n  range = utils.flatten(range);\n  average_range = utils.parseNumberArray(utils.flatten(average_range));\n\n  if (average_range instanceof Error) {\n    return average_range;\n  }\n  var average_count = 0;\n  var result = 0;\n  var isWildcard = criteria === void 0 || criteria === '*';\n  var tokenizedCriteria = isWildcard ? null : evalExpression.parse(criteria + '');\n  var filter_criteria = criteria.replace('=', '').replace('*', '').replace('<>', '')\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n\n    if (isWildcard) {\n      result += average_range[i];\n      average_count++;\n    } else {\n      var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n      if (criteria.indexOf('<>') >= 0){\n        if (value.indexOf(filter_criteria) < 0) {\n          result += average_range[i];\n          average_count++;\n        }\n      }else if (evalExpression.compute(tokens) || value.toString().indexOf(filter_criteria) >= 0) {\n        result += average_range[i];\n        average_count++;\n      }\n    }\n  }\n  if (average_count == 0){\n    return error.div0\n  }\n  return result / average_count;\n};\n\nexports.AVERAGEIFS = function () {\n  // Does not work with multi dimensional ranges yet!\n  //http://office.microsoft.com/en-001/excel-help/averageifs-function-HA010047493.aspx\n  var args = utils.argsToArray(arguments);\n  var criteriaLength = (args.length - 1) / 2;\n  var range = utils.flatten(args[0]);\n  var count = 0;\n  var result = 0;\n\n  for (var i = 0; i < range.length; i++) {\n    var isMeetCondition = false;\n\n    for (var j = 0; j < criteriaLength; j++) {\n      var value = args[2 * j + 1][i];\n      var criteria = args[2 * j + 2];\n      var isWildcard = criteria === void 0 || criteria === '*';\n      var computedResult = false;\n\n      if (isWildcard) {\n        computedResult = true;\n      } else {\n        var tokenizedCriteria = evalExpression.parse(criteria + '');\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n        computedResult = evalExpression.compute(tokens);\n      }\n\n      // Criterias are calculated as AND so any `false` breakes the loop as unmeet condition\n      if (!computedResult) {\n        isMeetCondition = false;\n        break;\n      }\n\n      isMeetCondition = true;\n    }\n\n    if (isMeetCondition) {\n      result += range[i];\n      count++;\n    }\n  }\n\n  var average = result / count;\n\n  if (isNaN(average)) {\n    return error.div0;\n  } else {\n    return average;\n  }\n};\n\nexports.BETA = {};\n\nexports.BETA.DIST = function (x, alpha, beta, cumulative, A, B) {\n  if (arguments.length < 4) {\n    return error.value;\n  }\n\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(x, alpha, beta, A, B)) {\n    return error.value;\n  }\n  cumulative = utils.parseBool(cumulative)\n  x = (x - A) / (B - A);\n  return cumulative ? jStat.beta.cdf(x, alpha, beta) : jStat.beta.pdf(x, alpha, beta)/2;\n};\n\nexports.BETA.INV = function(probability, alpha, beta, A, B) {\n  A = (A === undefined) ? 0 : A;\n  B = (B === undefined) ? 1 : B;\n\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  A = utils.parseNumber(A);\n  B = utils.parseNumber(B);\n  if (utils.anyIsError(probability, alpha, beta, A, B)) {\n    return error.value;\n  }\n\n  return jStat.beta.inv(probability, alpha, beta) * (B - A) + A;\n};\n\nexports.BINOM = {};\n\nexports.BINOM.DIST = function (successes, trials, probability, cumulative) {\n  successes = utils.parseNumber(successes);\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  cumulative = utils.parseBool(cumulative)\n  cumulative = utils.parseNumber(cumulative);\n  if (utils.anyIsError(successes, trials, probability, cumulative)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.binomial.cdf(successes, trials, probability) : jStat.binomial.pdf(successes, trials, probability);\n};\n\nexports.BINOM.INV = function(trials, probability, alpha) {\n  trials = utils.parseNumber(trials);\n  probability = utils.parseNumber(probability);\n  alpha = utils.parseNumber(alpha);\n  if (utils.anyIsError(trials, probability, alpha)) {\n    return error.value;\n  }\n\n  var x = 0;\n  while (x <= trials) {\n    if (jStat.binomial.cdf(x, trials, probability) >= alpha) {\n      return x;\n    }\n    x++;\n  }\n};\n\nexports.CHISQ = {};\n\nexports.CHISQ.DIST = function(x, k, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (x < 0){\n    return error.num\n  }\n  x = utils.parseNumber(x);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(x, k)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.chisquare.cdf(x, k) : jStat.chisquare.pdf(x, k);\n};\n\nexports.CHISQ.DIST.RT = function(x, k) {\n  if (!x | !k) {\n    return error.na;\n  }\n\n  if (x < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return 1 -  jStat.chisquare.cdf(x, k);\n};\n\nexports.CHISQ.INV = function(probability, k) {\n  probability = utils.parseNumber(probability);\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(probability, k)) {\n    return error.value;\n  }\n  return jStat.chisquare.inv(probability, k);\n};\n\nexports.CHISQ.INV.RT = function(p, k) {\n  if (!p | !k) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || k < 1 || k > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof k !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.chisquare.inv(1.0 - p, k);\n};\n\nexports.CHISQ.TEST = function(observed, expected) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if ((!(observed instanceof Array)) || (!(expected instanceof Array))) {\n    return error.value;\n  }\n\n  if (observed.length !== expected.length) {\n    return error.value;\n  }\n\n  if (observed[0] && expected[0] &&\n      observed[0].length !== expected[0].length) {\n    return error.value;\n  }\n\n  var row = observed.length;\n  var tmp, i, j;\n\n  // Convert single-dimension array into two-dimension array\n  for (i = 0; i < row; i ++) {\n    if (!(observed[i] instanceof Array)) {\n      tmp = observed[i];\n      observed[i] = [];\n      observed[i].push(tmp);\n    }\n    if (!(expected[i] instanceof Array)) {\n      tmp = expected[i];\n      expected[i] = [];\n      expected[i].push(tmp);\n    }\n  }\n\n  var col = observed[0].length;\n  var dof = (col === 1) ? row-1 : (row-1)*(col-1);\n  var xsqr = 0;\n  var Pi =Math.PI;\n\n  for (i = 0; i < row; i ++) {\n    for (j = 0; j < col; j ++) {\n      xsqr += Math.pow((observed[i][j] - expected[i][j]), 2) / expected[i][j];\n    }\n  }\n\n  // Get independency by X square and its degree of freedom\n  function ChiSq(xsqr, dof) {\n    var p = Math.exp(-0.5 * xsqr);\n    if((dof%2) === 1) {\n      p = p * Math.sqrt(2 * xsqr/Pi);\n    }\n    var k = dof;\n    while(k >= 2) {\n      p = p * xsqr/k;\n      k = k - 2;\n    }\n    var t = p;\n    var a = dof;\n    while (t > 0.0000000001*p) {\n      a = a + 2;\n      t = t * xsqr/a;\n      p = p + t;\n    }\n    return 1-p;\n  }\n\n  return Math.round(ChiSq(xsqr, dof) * 1000000) / 1000000;\n};\n\nexports.COLUMN = function() {\n  col_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n  cell_name = this.args[0].formula.name\n  cell_name = cell_name.replace(/\\d+/g,'')\n  return col_list.indexOf(cell_name)+1\n};\n\nexports.COLUMNS = function(matrix) {\n  if (typeof matrix === 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.cols(matrix);\n};\n\nexports.CONFIDENCE = {};\n\nexports.CONFIDENCE.NORM = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.normalci(1, alpha, sd, n)[1] - 1;\n};\n\nexports.CONFIDENCE.T = function(alpha, sd, n) {\n  alpha = utils.parseNumber(alpha);\n  sd = utils.parseNumber(sd);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(alpha, sd, n)) {\n    return error.value;\n  }\n  return jStat.tci(1, alpha, sd, n)[1] - 1;\n};\nexports.IFS = function() {\n  for (var i = 0; i + 1 < arguments.length; i += 2) {\n    var cond = arguments[i];\n    var val = arguments[i + 1];\n    if (cond) {\n      return val;\n    }\n  }\n  return error.na;\n}\nexports.CORREL = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.corrcoeff(array1, array2);\n};\n\nexports.COUNT = function() {\n  return utils.numbers(utils.flatten(arguments)).length;\n};\n\nexports.COUNTA = function() {\n  var range = utils.flatten(arguments);\n  return range.length - exports.COUNTBLANK(range);\n};\n\nexports.COUNTIN = function (range, value) {\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    if (range[i] === value) {\n      result++;\n    }\n  }\n  return result;\n};\n\n\nexports.COUNTBLANK = function() {\n  var range = utils.flatten(arguments);\n  var blanks = 0;\n  var element;\n  for (var i = 0; i < range.length; i++) {\n    element = range[i];\n    if (element === null || element === '') {\n      blanks++;\n    }\n  }\n  return blanks;\n};\n\nexports.COUNTIF = function (range, criteria) {\n  range = utils.flatten(range);\n  if (criteria === undefined) {\n    return error.value;\n  }\n  var isWildcard = criteria === void 0 || criteria === '*';\n\n  if (isWildcard) {\n    return range.length;\n  }\n\n  var matches = 0;\n  var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n  for (var i = 0; i < range.length; i++) {\n    var value = range[i];\n    var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n\n    if (evalExpression.compute(tokens)) {\n      matches++;\n    }\n  }\n\n  return matches;\n};\n\nexports.COUNTIFS = function () {\n  var args = utils.argsToArray(arguments);\n  var results = new Array(utils.flatten(args[0]).length);\n\n  for (var i = 0; i < results.length; i++) {\n    results[i] = true;\n  }\n  for (i = 0; i < args.length; i += 2) {\n    var range = utils.flatten(args[i]);\n    var criteria = args[i + 1];\n    var isWildcard = criteria === void 0 || criteria === '*';\n\n    if (!isWildcard) {\n      var tokenizedCriteria = evalExpression.parse(criteria + '');\n\n      for (var j = 0; j < range.length; j++) {\n        var value = range[j];\n        var tokens = [evalExpression.createToken(value, evalExpression.TOKEN_TYPE_LITERAL)].concat(tokenizedCriteria);\n        results[j] = results[j] && evalExpression.compute(tokens);\n      }\n    }\n  }\n  var result = 0;\n  for (i = 0; i < results.length; i++) {\n    if (results[i]) {\n      result++;\n    }\n  }\n  return result;\n};\n\nexports.COUNTUNIQUE = function () {\n  return misc.UNIQUE.apply(null, utils.flatten(arguments)).length;\n};\n\nexports.COVARIANCE = {};\n\nexports.COVARIANCE.P = function(array1, array2) {\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  var mean1 = jStat.mean(array1);\n  var mean2 = jStat.mean(array2);\n  var result = 0;\n  var n = array1.length;\n  for (var i = 0; i < n; i++) {\n    result += (array1[i] - mean1) * (array2[i] - mean2);\n  }\n  return result / n;\n};\n\nexports.COVARIANCE.S = function(array1, array2) {\n  if (typeof array1 == \"string\") {\n    array1 = utils.strToMatrix(array1);\n  }\n  if (typeof array2 == \"string\") {\n    array2 = utils.strToMatrix(array2);\n  }\n  array1 = utils.parseNumberArray(utils.flatten(array1));\n  array2 = utils.parseNumberArray(utils.flatten(array2));\n  if (utils.anyIsError(array1, array2)) {\n    return error.value;\n  }\n  return jStat.covariance(array1, array2);\n};\n\nexports.DEVSQ = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var result = 0;\n  for (var i = 0; i < range.length; i++) {\n    result += Math.pow((range[i] - mean), 2);\n  }\n  return result;\n};\n\nexports.EXPON = {};\n\nexports.EXPON.DIST = function(x, lambda, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  lambda = utils.parseNumber(lambda);\n  if (utils.anyIsError(x, lambda)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.exponential.cdf(x, lambda) : jStat.exponential.pdf(x, lambda);\n};\n\nexports.F = {};\n\nexports.F.DIST = function (x, d1, d2, cumulative) {\n  x = utils.parseNumber(x);\n  d1 = utils.parseNumber(d1);\n  d2 = utils.parseNumber(d2);\n  if (utils.anyIsError(x, d1, d2)) {\n    return error.value;\n  }\n  if (cumulative == undefined){\n    cumulative = true\n  }\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value\n  }\n  if (cumulative == 'FALSE'){\n    cumulative = false\n  }\n  return (cumulative) ? jStat.centralF.cdf(x, d1, d2) : jStat.centralF.pdf(x, d1, d2);\n};\n\nexports.F.DIST.RT = function (x, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (x < 0 || d1 < 1 || d2 < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.centralF.cdf(x, d1, d2);\n};\n\nexports.F.INV = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.INV.RT = function (p, d1, d2) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (p < 0 || p > 1 || d1 < 1 || d1 > Math.pow(10, 10) || d2 < 1 || d2 > Math.pow(10, 10)) {\n    return error.num;\n  }\n\n  if ((typeof p !== 'number') || (typeof d1 !== 'number') || (typeof d2 !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.centralF.inv(1.0 - p, d1, d2);\n};\n\nexports.F.TEST = function (array1, array2) {\n  if (!array1 || !array2) {\n    return error.na;\n  }\n\n  if (!(array1 instanceof Array) || !(array2 instanceof Array)) {\n    return error.na;\n  }\n\n  if (array1.length < 2 || array2.length < 2) {\n    return error.div0;\n  }\n\n  var sumOfSquares = function (values, x1) {\n    var sum = 0;\n    for (var i = 0; i < values.length; i++) {\n      sum += Math.pow((values[i] - x1), 2);\n    }\n    return sum;\n  };\n\n  var x1 = mathTrig.SUM(array1) / array1.length;\n  var x2 = mathTrig.SUM(array2) / array2.length;\n  var sum1 = sumOfSquares(array1, x1) / (array1.length - 1);\n  var sum2 = sumOfSquares(array2, x2) / (array2.length - 1);\n\n  return sum1 / sum2;\n};\n\nexports.FISHER = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return x;\n  }\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n\nexports.FISHERINV = function(y) {\n  y = utils.parseNumber(y);\n  if (y instanceof Error) {\n    return y;\n  }\n  var e2y = Math.exp(2 * y);\n  return (e2y - 1) / (e2y + 1);\n};\n\nexports.FORECAST = function(x, data_y, data_x) {\n  x = utils.parseNumber(x);\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(x, data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var b = num / den;\n  var a = ymean - b * xmean;\n  return a + b * x;\n};\n\nexports.FREQUENCY = function(data, bins) {\n  data = utils.parseNumberArray(utils.flatten(data));\n  bins = utils.parseNumberArray(utils.flatten(bins));\n  if (utils.anyIsError(data, bins)) {\n    return error.value;\n  }\n  var n = data.length;\n  var b = bins.length;\n  var r = [];\n  for (var i = 0; i <= b; i++) {\n    r[i] = 0;\n    for (var j = 0; j < n; j++) {\n      if (i === 0) {\n        if (data[j] <= bins[0]) {\n          r[0] += 1;\n        }\n      } else if (i < b) {\n        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\n          r[i] += 1;\n        }\n      } else if (i === b) {\n        if (data[j] > bins[b - 1]) {\n          r[b] += 1;\n        }\n      }\n    }\n  }\n  return r;\n};\n\n\nexports.GAMMA = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  if (number === 0) {\n    return error.num;\n  }\n\n  if (parseInt(number, 10) === number && number < 0) {\n    return error.num;\n  }\n\n  return jStat.gammafn(number);\n};\n\nexports.GAMMA.DIST = function(value, alpha, beta, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  if (arguments.length !== 4) {\n    return error.na;\n  }\n\n  if (value < 0 || alpha <= 0 || beta <= 0) {\n    return error.value;\n  }\n\n  if ((typeof value !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return cumulative ? jStat.gamma.cdf(value, alpha, beta, true) : jStat.gamma.pdf(value, alpha, beta, false);\n};\n\nexports.GAMMA.INV = function(probability, alpha, beta) {\n  if (arguments.length !== 3) {\n    return error.na;\n  }\n\n  if (probability < 0 || probability > 1 || alpha <= 0 || beta <= 0) {\n    return error.num;\n  }\n\n  if ((typeof probability !== 'number') || (typeof alpha !== 'number') || (typeof beta !== 'number')) {\n    return error.value;\n  }\n\n  return jStat.gamma.inv(probability, alpha, beta);\n};\n\nexports.GAMMALN = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return jStat.gammaln(number);\n};\n\nexports.GAMMALN.PRECISE = function(x) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (x <= 0) {\n    return error.num;\n  }\n\n  if (typeof x !== 'number') {\n    return error.value;\n  }\n\n  return jStat.gammaln(x);\n};\n\nexports.GAUSS = function(z) {\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return z;\n  }\n  return jStat.normal.cdf(z, 0, 1) - 0.5;\n};\n\nexports.GEOMEAN = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n  return jStat.geomean(args);\n};\n\nexports.GROWTH = function(known_y, known_x, new_x, use_const) {\n  // Credits: Ilmari Karonen (http://stackoverflow.com/questions/14161990/how-to-implement-growth-function-in-javascript)\n\n  known_y = utils.parseNumberArray(known_y);\n  if (known_y instanceof Error) {\n    return known_y;\n  }\n\n  // Default values for optional parameters:\n  var i;\n  if (known_x === undefined) {\n    known_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      known_x.push(i);\n    }\n  }\n  if (new_x === undefined) {\n    new_x = [];\n    for (i = 1; i <= known_y.length; i++) {\n      new_x.push(i);\n    }\n  }\n\n  known_x = utils.parseNumberArray(known_x);\n  new_x = utils.parseNumberArray(new_x);\n  if (utils.anyIsError(known_x, new_x)) {\n    return error.value;\n  }\n\n\n  if (use_const === undefined) {\n    use_const = true;\n  }\n\n  // Calculate sums over the data:\n  var n = known_y.length;\n  var avg_x = 0;\n  var avg_y = 0;\n  var avg_xy = 0;\n  var avg_xx = 0;\n  for (i = 0; i < n; i++) {\n    var x = known_x[i];\n    var y = Math.log(known_y[i]);\n    avg_x += x;\n    avg_y += y;\n    avg_xy += x * y;\n    avg_xx += x * x;\n  }\n  avg_x /= n;\n  avg_y /= n;\n  avg_xy /= n;\n  avg_xx /= n;\n\n  // Compute linear regression coefficients:\n  var beta;\n  var alpha;\n  if (use_const) {\n    beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);\n    alpha = avg_y - beta * avg_x;\n  } else {\n    beta = avg_xy / avg_xx;\n    alpha = 0;\n  }\n\n  // Compute and return result array:\n  var new_y = [];\n  for (i = 0; i < new_x.length; i++) {\n    new_y.push(Math.exp(alpha + beta * new_x[i]));\n  }\n  return new_y;\n};\n\nexports.HARMEAN = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    den += 1 / range[i];\n  }\n  return n / den;\n};\n\nexports.HYPGEOM = {};\n\nexports.HYPGEOM.DIST = function(x, n, M, N, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  M = utils.parseNumber(M);\n  N = utils.parseNumber(N);\n  if (utils.anyIsError(x, n, M, N)) {\n    return error.value;\n  }\n\n  function pdf(x, n, M, N) {\n    return mathTrig.COMBIN(M, x) * mathTrig.COMBIN(N - M, n - x) / mathTrig.COMBIN(N, n);\n  }\n\n  function cdf(x, n, M, N) {\n    var result = 0;\n    for (var i = 0; i <= x; i++) {\n      result += pdf(i, n, M, N);\n    }\n    return result;\n  }\n\n  return (cumulative) ? cdf(x, n, M, N) : pdf(x, n, M, N);\n};\n\nexports.INTERCEPT = function(known_y, known_x) {\n  known_y = utils.parseNumberArray(known_y);\n  known_x = utils.parseNumberArray(known_x);\n  if (utils.anyIsError(known_y, known_x)) {\n    return error.value;\n  }\n  if (known_y.length !== known_x.length) {\n    return error.na;\n  }\n  return exports.FORECAST(0, known_y, known_x);\n};\n\nexports.KURT = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 4);\n  }\n  sigma = sigma / Math.pow(jStat.stdev(range, true), 4);\n  return ((n * (n + 1)) / ((n - 1) * (n - 2) * (n - 3))) * sigma - 3 * (n - 1) * (n - 1) / ((n - 2) * (n - 3));\n};\n\nexports.LARGE = function(range, k) {\n  range = utils.flatten(range)\n  var arr = []\n  for ( var i=0;i<range.length;i++){\n    if (parseFloat(range[i])){\n      arr.push((parseFloat(range[i])))\n    }\n  }\n  range = arr;\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function (a, b) {\n    return b - a;\n  })[k - 1];\n};\n\nexports.LINEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var ymean = jStat.mean(data_y);\n  var xmean = jStat.mean(data_x);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  var m = num / den;\n  var b = ymean - m * xmean;\n  return [m, b];\n};\n\n// According to Microsoft:\n// http://office.microsoft.com/en-us/starter-help/logest-function-HP010342665.aspx\n// LOGEST returns are based on the following linear model:\n// ln y = x1 ln m1 + ... + xn ln mn + ln b\nexports.LOGEST = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  for (var i = 0; i < data_y.length; i ++) {\n    data_y[i] = Math.log(data_y[i]);\n  }\n\n  var result = exports.LINEST(data_y, data_x);\n  result[0] = Math.round(Math.exp(result[0])*1000000)/1000000;\n  result[1] = Math.round(Math.exp(result[1])*1000000)/1000000;\n  return result;\n};\n\nexports.LOGNORM = {};\n\nexports.LOGNORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.lognormal.cdf(x, mean, sd) : jStat.lognormal.pdf(x, mean, sd);\n};\n\nexports.LOGNORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.lognormal.inv(probability, mean, sd);\n};\n\nexports.MAX = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MAXA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.max.apply(Math, range);\n};\n\nexports.MEDIAN = function() {\n  var arr = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  var arr2 = []\n  for (var i=0;i<arr.length;i++){\n    if (typeof arr[i] === 'number'){\n      arr2.push(arr[i])\n    }\n  }\n  var range = utils.arrayValuesToNumbers(utils.flatten(arr2));\n  return jStat.median(range);\n};\n\nexports.MIN = function() {\n  var range = utils.flatten(arguments);\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MINA = function() {\n  var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\n  return (range.length === 0) ? 0 : Math.min.apply(Math, range);\n};\n\nexports.MODE = {};\n\nexports.MODE.MULT = function() {\n  // Credits: Roönaän\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var n = range.length;\n  var count = {};\n  var maxItems = [];\n  var max = 0;\n  var currentItem;\n\n  for (var i = 0; i < n; i++) {\n    currentItem = range[i];\n    count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\n    if (count[currentItem] > max) {\n      max = count[currentItem];\n      maxItems = [];\n    }\n    if (count[currentItem] === max) {\n      maxItems[maxItems.length] = currentItem;\n    }\n  }\n  return maxItems;\n};\n\nexports.MODE.SNGL = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  return exports.MODE.MULT(range).sort(function(a, b) {\n    return a - b;\n  })[0];\n};\n\nexports.NEGBINOM = {};\n\nexports.NEGBINOM.DIST = function(k, r, p, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  k = utils.parseNumber(k);\n  r = utils.parseNumber(r);\n  p = utils.parseNumber(p);\n  if (utils.anyIsError(k, r, p)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.negbin.cdf(k, r, p) : jStat.negbin.pdf(k, r, p);\n};\n\nexports.NORM = {};\n\nexports.NORM.DIST = function(x, mean, sd, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  if (sd <= 0) {\n    return error.num;\n  }\n\n  // Return normal distribution computed by jStat [http://jstat.org]\n  return (cumulative) ? jStat.normal.cdf(x, mean, sd) : jStat.normal.pdf(x, mean, sd);\n};\n\nexports.NORM.INV = function(probability, mean, sd) {\n  probability = utils.parseNumber(probability);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(probability, mean, sd)) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, mean, sd);\n};\n\nexports.NORM.S = {};\n\nexports.NORM.S.DIST = function(z, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  z = utils.parseNumber(z);\n  if (z instanceof Error) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.normal.cdf(z, 0, 1) : jStat.normal.pdf(z, 0, 1);\n};\n\nexports.NORM.S.INV = function(probability) {\n  probability = utils.parseNumber(probability);\n  if (probability instanceof Error) {\n    return error.value;\n  }\n  return jStat.normal.inv(probability, 0, 1);\n};\n\nexports.PEARSON = function(data_x, data_y) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den1 = 0;\n  var den2 = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den1 += Math.pow(data_x[i] - xmean, 2);\n    den2 += Math.pow(data_y[i] - ymean, 2);\n  }\n  return num / Math.sqrt(den1 * den2);\n};\n\nexports.PERCENTILE = {};\n\nexports.PERCENTILE.EXC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    {\n      return a - b;\n    }\n  });\n  var n = array.length;\n  if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\n    return error.num;\n  }\n  var l = k * (n + 1) - 1;\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTILE.INC = function(array, k) {\n  array = utils.parseNumberArray(utils.flatten(array));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(array, k)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var n = array.length;\n  var l = k * (n - 1);\n  var fl = Math.floor(l);\n  return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\n};\n\nexports.PERCENTRANK = {};\n\nexports.PERCENTRANK.EXC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = (array.indexOf(uniques[i]) + 1) / (n + 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERCENTRANK.INC = function(array, x, significance) {\n  significance = (significance === undefined) ? 3 : significance;\n  array = utils.parseNumberArray(utils.flatten(array));\n  x = utils.parseNumber(x);\n  significance = utils.parseNumber(significance);\n  if (utils.anyIsError(array, x, significance)) {\n    return error.value;\n  }\n  array = array.sort(function(a, b) {\n    return a - b;\n  });\n  var uniques = misc.UNIQUE.apply(null, array);\n  var n = array.length;\n  var m = uniques.length;\n  var power = Math.pow(10, significance);\n  var result = 0;\n  var match = false;\n  var i = 0;\n  while (!match && i < m) {\n    if (x === uniques[i]) {\n      result = array.indexOf(uniques[i]) / (n - 1);\n      match = true;\n    } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\n      result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\n      match = true;\n    }\n    i++;\n  }\n  return Math.floor(result * power) / power;\n};\n\nexports.PERMUT = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return mathTrig.FACT(number) / mathTrig.FACT(number - number_chosen);\n};\n\nexports.PERMUTATIONA = function(number, number_chosen) {\n  number = utils.parseNumber(number);\n  number_chosen = utils.parseNumber(number_chosen);\n  if (utils.anyIsError(number, number_chosen)) {\n    return error.value;\n  }\n  return Math.pow(number, number_chosen);\n};\n\nexports.PHI = function(x) {\n  x = utils.parseNumber(x);\n  if (x instanceof Error) {\n    return error.value;\n  }\n  return Math.exp(-0.5 * x * x) / SQRT2PI;\n};\n\nexports.POISSON = {};\n\nexports.POISSON.DIST = function(x, mean, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  if (utils.anyIsError(x, mean)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.poisson.cdf(x, mean) : jStat.poisson.pdf(x, mean);\n};\n\nexports.PROB = function(range, probability, lower, upper) {\n  if (lower === undefined) {\n    return 0;\n  }\n  upper = (upper === undefined) ? lower : upper;\n\n  range = utils.parseNumberArray(utils.flatten(range));\n  probability = utils.parseNumberArray(utils.flatten(probability));\n  lower = utils.parseNumber(lower);\n  upper = utils.parseNumber(upper);\n  if (utils.anyIsError(range, probability, lower, upper)) {\n    return error.value;\n  }\n\n  if (lower === upper) {\n    return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\n  }\n\n  var sorted = range.sort(function(a, b) {\n    return a - b;\n  });\n  var n = sorted.length;\n  var result = 0;\n  for (var i = 0; i < n; i++) {\n    if (sorted[i] >= lower && sorted[i] <= upper) {\n      result += probability[range.indexOf(sorted[i])];\n    }\n  }\n  return result;\n};\n\nexports.QUARTILE = {};\n\nexports.QUARTILE.EXC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.EXC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.EXC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.EXC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.QUARTILE.INC = function(range, quart) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  quart = utils.parseNumber(quart);\n  if (utils.anyIsError(range, quart)) {\n    return error.value;\n  }\n  switch (quart) {\n    case 1:\n      return exports.PERCENTILE.INC(range, 0.25);\n    case 2:\n      return exports.PERCENTILE.INC(range, 0.5);\n    case 3:\n      return exports.PERCENTILE.INC(range, 0.75);\n    default:\n      return error.num;\n  }\n};\n\nexports.RANK = {};\n\nexports.RANK.AVG = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  range = utils.flatten(range);\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n\n  var length = range.length;\n  var count = 0;\n  for (var i = 0; i < length; i++) {\n    if (range[i] === number) {\n      count++;\n    }\n  }\n\n  return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\n};\n\nexports.RANK.EQ = function(number, range, order) {\n  number = utils.parseNumber(number);\n  range = utils.parseNumberArray(utils.flatten(range));\n  if (utils.anyIsError(number, range)) {\n    return error.value;\n  }\n  order = order || false;\n  var sort = (order) ? function(a, b) {\n    return a - b;\n  } : function(a, b) {\n    return b - a;\n  };\n  range = range.sort(sort);\n  return range.indexOf(number) + 1;\n};\n\nexports.ROW = function(matrix, index) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (index < 0) {\n    return error.num;\n  }\n\n  if (!(matrix instanceof Array) || (typeof index !== 'number')) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return undefined;\n  }\n\n  return jStat.row(matrix, index);\n};\n\nexports.ROWS = function(matrix) {\n  if (arguments.length !== 1) {\n    return error.na;\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\n\nexports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n  return Math.pow(exports.PEARSON(data_x, data_y), 2);\n};\n\nexports.SKEW = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var sigma = 0;\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 3);\n  }\n  return n * sigma / ((n - 1) * (n - 2) * Math.pow(jStat.stdev(range, true), 3));\n};\n\nexports.SKEW.P = function() {\n  var range = utils.parseNumberArray(utils.flatten(arguments));\n  if (range instanceof Error) {\n    return range;\n  }\n  var mean = jStat.mean(range);\n  var n = range.length;\n  var m2 = 0;\n  var m3 = 0;\n  for (var i = 0; i < n; i++) {\n    m3 += Math.pow(range[i] - mean, 3);\n    m2 += Math.pow(range[i] - mean, 2);\n  }\n  m3 = m3 / n;\n  m2 = m2 / n;\n  return m3 / Math.pow(m2, 3 / 2);\n};\n\nexports.SLOPE = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return num / den;\n};\n\nexports.SMALL = function(range, k) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  k = utils.parseNumber(k);\n  if (utils.anyIsError(range, k)) {\n    return range;\n  }\n  return range.sort(function(a, b) {\n    return a - b;\n  })[k - 1];\n};\n\nexports.STANDARDIZE = function(x, mean, sd) {\n  x = utils.parseNumber(x);\n  mean = utils.parseNumber(mean);\n  sd = utils.parseNumber(sd);\n  if (utils.anyIsError(x, mean, sd)) {\n    return error.value;\n  }\n  return (x - mean) / sd;\n};\n\nexports.STDEV = {};\n\nexports.STDEV.P = function() {\n  var v = exports.VAR.P.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEV.S = function() {\n  var v = exports.VAR.S.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVA = function() {\n  var v = exports.VARA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\nexports.STDEVPA = function() {\n  var v = exports.VARPA.apply(this, arguments);\n  return Math.sqrt(v);\n};\n\n\nexports.STEYX = function(data_y, data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  if (utils.anyIsError(data_y, data_x)) {\n    return error.value;\n  }\n  var xmean = jStat.mean(data_x);\n  var ymean = jStat.mean(data_y);\n  var n = data_x.length;\n  var lft = 0;\n  var num = 0;\n  var den = 0;\n  for (var i = 0; i < n; i++) {\n    lft += Math.pow(data_y[i] - ymean, 2);\n    num += (data_x[i] - xmean) * (data_y[i] - ymean);\n    den += Math.pow(data_x[i] - xmean, 2);\n  }\n  return Math.sqrt((lft - num * num / den) / (n - 2));\n};\n\nexports.TRANSPOSE = function(matrix) {\n  if (!matrix) {\n    return error.na;\n  }\n  return jStat.transpose(matrix);\n};\n\nexports.T = text.T;\n\nexports.T.DIST = function (x, df, cumulative) {\n  cumulative = utils.parseBool(cumulative)\n  x = utils.parseNumber(x);\n  df = utils.parseNumber(df);\n  if (utils.anyIsError(x, df)) {\n    return error.value;\n  }\n  return (cumulative) ? jStat.studentt.cdf(x, df) : jStat.studentt.pdf(x, df);\n};\n\nexports.T.DIST['2T'] = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return (1 - jStat.studentt.cdf(x , df)) * 2;\n};\n\nexports.T.DIST.RT = function(x, df) {\n  if (arguments.length !== 2) {\n    return error.na;\n  }\n\n  if (x < 0 || df < 1) {\n    return error.num;\n  }\n\n  if ((typeof x !== 'number') || (typeof df !== 'number')) {\n    return error.value;\n  }\n\n  return 1 - jStat.studentt.cdf(x , df);\n};\n\nexports.T.INV = function (probability, df) {\n  // probability = utils.parseNumber(probability);\n  // df = utils.parseNumber(df);\n  // if (utils.anyIsError(probability, df)) {\n  //   return error.value;\n  // }\n  // var res = jStat.studentt.inv(probability, df);\n  // return res\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\nexports.T.INV['2T'] = function(probability, df) {\n  probability = utils.parseNumber(probability);\n  df = utils.parseNumber(df);\n  if (probability <= 0 || probability > 1 || df < 1) {\n    return error.num;\n  }\n  if (utils.anyIsError(probability, df)) {\n    return error.value;\n  }\n  return Math.abs(jStat.studentt.inv(probability/2, df));\n};\n\n// The algorithm can be found here:\n// http://www.chem.uoa.gr/applets/AppletTtest/Appl_Ttest2.html\nexports.T.TEST = function(data_x, data_y) {\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  if (utils.anyIsError(data_x, data_y)) {\n    return error.value;\n  }\n\n  var mean_x = jStat.mean(data_x);\n  var mean_y = jStat.mean(data_y);\n  var s_x = 0;\n  var s_y = 0;\n  var i;\n\n  for (i = 0; i < data_x.length; i++) {\n    s_x += Math.pow(data_x[i] - mean_x, 2);\n  }\n  for (i = 0; i < data_y.length; i++) {\n    s_y += Math.pow(data_y[i] - mean_y, 2);\n  }\n\n  s_x = s_x / (data_x.length-1);\n  s_y = s_y / (data_y.length-1);\n\n  var t = Math.abs(mean_x - mean_y) / Math.sqrt(s_x/data_x.length + s_y/data_y.length);\n\n  return exports.T.DIST['2T'](t, data_x.length+data_y.length-2);\n};\n\nexports.TREND = function (data_y, data_x, new_data_x) {\n  data_y = utils.parseNumberArray(utils.flatten(data_y));\n  data_x = utils.parseNumberArray(utils.flatten(data_x));\n  var linest = exports.LINEST(data_y, data_x);\n  var m = linest[0];\n  var b = linest[1];\n  return m * new_data_x + b\n};\n\nexports.TRIMMEAN = function (range, percent) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  percent = utils.parseNumber(percent);\n  if (utils.anyIsError(range, percent)) {\n    return error.value;\n  }\n  var trim = mathTrig.FLOORMATH(range.length * percent, 2) / 2;\n  return jStat.mean(utils.initial(utils.rest(range.sort(function (a, b) {\n    return a - b;\n  }), trim), trim));\n};\n\nexports.VAR = {};\n\nexports.VAR.P = function () {\n  var range = utils.numbers(utils.flatten(arguments));\n  if (range.length==0){\n    return error.value\n  }\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  if (isNaN(sigma / n)){\n    return error.value\n  }else{\n    return sigma / n;\n  }\n};\n\nexports.VAR.S = function() {\n  var range = utils.numbers(utils.flatten(arguments));\n  var n = range.length;\n  var sigma = 0;\n  var mean = exports.AVERAGE(range);\n  for (var i = 0; i < n; i++) {\n    sigma += Math.pow(range[i] - mean, 2);\n  }\n  return sigma / (n - 1);\n};\n\nexports.VARA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / (count - 1);\n};\n\nexports.VARPA = function() {\n  var range = utils.flatten(arguments);\n  var n = range.length;\n  var sigma = 0;\n  var count = 0;\n  var mean = exports.AVERAGEA(range);\n  for (var i = 0; i < n; i++) {\n    var el = range[i];\n    if (typeof el === 'number') {\n      sigma += Math.pow(el - mean, 2);\n    } else if (el === true) {\n      sigma += Math.pow(1 - mean, 2);\n    } else {\n      sigma += Math.pow(0 - mean, 2);\n    }\n\n    if (el !== null) {\n      count++;\n    }\n  }\n  return sigma / count;\n};\n\nexports.WEIBULL = {};\n\nexports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\n  //XW:参数判断\n  cumulative = utils.parseBool(cumulative)\n  //XW：end\n  x = utils.parseNumber(x);\n  alpha = utils.parseNumber(alpha);\n  beta = utils.parseNumber(beta);\n  if (utils.anyIsError(x, alpha, beta)) {\n    return error.value;\n  }\n  return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\n};\n\nexports.Z = {};\n\nexports.Z.TEST = function (range, x, sd) {\n  range = utils.parseNumberArray(utils.flatten(range));\n  x = utils.parseNumber(x);\n  if (utils.anyIsError(range, x)) {\n    return error.value;\n  }\n\n  sd = sd || exports.STDEV.S(range);\n  var n = range.length;\n  return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\n};\n","\"use strict\";\n\nconst expression_builder = require('./expression_builder.js');\n\nlet xlsx_Fx = {};\nlet xlsx_raw_Fx = {};\n\nimport_functions(require('.//formulajs/index'));\nimport_raw_functions(require('./formulas-raw.js'));\n\nfunction import_raw_functions(functions, opts) {\n    for (var key in functions) {\n        xlsx_raw_Fx[key] = functions[key];\n    }\n}\n\nfunction import_functions(formulajs, opts) {\n    opts = opts || {};\n    var prefix = opts.prefix || '';\n    for (var key in formulajs) {\n        var obj = formulajs[key];\n        if (typeof(obj) === 'function') {\n            if (opts.override || !xlsx_Fx[prefix + key]) {\n                xlsx_Fx[prefix + key] = obj;\n            }\n            // else {\n            //     console.log(prefix + key, 'already exists.');\n            //     console.log('  to override:');\n            //     console.log('    XLSX_CALC.import_functions(yourlib, {override: true})');\n            // }\n        }\n        else if (typeof(obj) === 'object') {\n            import_functions(obj, my_assign(opts, { prefix: key + '.' }));\n        }\n    }\n}\n\nfunction my_assign(dest, source) {\n    var obj = JSON.parse(JSON.stringify(dest));\n    for (var k in source) {\n        obj[k] = source[k];\n    }\n    return obj;\n}\n\nfunction build_expression(formula) {\n    return expression_builder(formula, {xlsx_Fx: xlsx_Fx, xlsx_raw_Fx: xlsx_raw_Fx});\n    // xlsx_raw_Fx = {AND, IF, IFERROR, OFFSET}\n    // xlsx_Fx = {FLOOR, AVERGAE ... }\n}\n\nfunction exec_formula(formula) { // formula.cell.f = \"Average(1,2,3,4,5)\n    let root_exp = build_expression(formula);\n    root_exp.update_cell_value();\n}\n\nexec_formula.set_fx = function set_fx(name, fn) {\n    xlsx_Fx[name] = fn;\n};\n\nexec_formula.exec_fx = function exec_fx(name, args) {\n    return xlsx_Fx[name].apply(this, args);\n};\n\nexec_formula.localizeFunctions = function(dic) {\n    for (let newName in dic) {\n        let oldName = dic[newName];\n        if (xlsx_Fx[oldName]) {\n            xlsx_Fx[newName] = xlsx_Fx[oldName];\n        }\n        if (xlsx_raw_Fx[oldName]) {\n            xlsx_raw_Fx[newName] = xlsx_raw_Fx[oldName];\n        }\n    }\n};\n\nexec_formula.import_functions = import_functions;\nexec_formula.import_raw_functions = import_raw_functions;\nexec_formula.build_expression = build_expression;\nexec_formula.xlsx_Fx = xlsx_Fx;\nmodule.exports = exec_formula;\n","const Exp = require('./Exp.js');\nconst RawValue = require('./RawValue.js');\nconst UserFnExecutor = require('./UserFnExecutor.js');\nconst UserRawFnExecutor = require('./UserRawFnExecutor.js');\nconst common_operations = {\n    '*': 'multiply',\n    '+': 'plus',\n    '-': 'minus',\n    '/': 'divide',\n    '^': 'power',\n    '&': 'concat',\n    '<': 'lt',\n    '>': 'gt',\n    '=': 'eq'\n};\n\nmodule.exports = function expression_builder(formula, opts) { // 核心的解析公式的方法\n    formula.status = 'working';\n\n    var xlsx_Fx = opts.xlsx_Fx || {};\n    var xlsx_raw_Fx = opts.xlsx_raw_Fx || {};\n\n    var root_exp;\n    var str_formula = formula.cell.f;\n    if (str_formula[0] == '=') {\n        str_formula = str_formula.substr(1); // =adsf 会变为adsf\n    }\n    var exp_obj = root_exp = new Exp(formula);  // 封装公式实例\n    var buffer = '',\n        was_string = false;\n    var fn_stack = [{ // 这个是函数调用栈？\n        exp: exp_obj\n    }];\n\n    /**\n     * state pattern in functional way\n     */\n    function string(char) {\n        if (char === '\"') {\n            exp_obj.push(new RawValue(buffer));\n            was_string = true;\n            buffer = '';\n            state = start;\n        } else {\n            buffer += char;\n        }\n    }\n\n    function single_quote(char) {\n        if (char === \"'\") {\n            state = start;\n        }\n        buffer += char;\n    }\n\n    function ini_parentheses() {\n        var o, trim_buffer = buffer.trim(),\n            special = xlsx_Fx[trim_buffer];\n        var special_raw = xlsx_raw_Fx[trim_buffer];\n        if (special_raw) {\n            special = new UserRawFnExecutor(special_raw, formula);\n        }\n        else if (special) {\n            special = new UserFnExecutor(special, formula);\n        }\n        else if (trim_buffer) {\n            //Error: \"Worksheet 1\"!D145: Function INDEX not found\n            throw new Error('\"' + formula.sheet_name + '\"!' + formula.name + ': Function ' + buffer + ' not found');\n        }\n        o = new Exp(formula);\n        fn_stack.push({\n            exp: o,\n            special: special\n        });\n        exp_obj = o;\n        buffer = '';\n    }\n\n    function end_parentheses() {\n        var v, stack = fn_stack.pop();\n        exp_obj = stack.exp;\n        exp_obj.push(buffer,position_i);\n        v = exp_obj;\n        buffer = '';\n        exp_obj = fn_stack[fn_stack.length - 1].exp;\n        if (stack.special) {\n            stack.special.push(v);\n            exp_obj.push(stack.special, position_i);\n        }\n        else {\n            exp_obj.push(v, position_i);\n        }\n    }\n\n    function add_operation(char) {\n        if (!was_string) {\n            exp_obj.push(buffer, position_i);\n        }\n        was_string = false;\n        exp_obj.push(char, position_i);\n        buffer = '';\n    }\n\n    function start(char) {\n        if (char === '\"') {\n            state = string;\n            buffer = \"\";\n        } else if (char === \"'\") {\n            state = single_quote;\n            buffer = \"'\";\n        } else if (char === '(') {\n            ini_parentheses();\n        } else if (char === ')') {\n            end_parentheses();\n        } else if (common_operations[char]) {\n            add_operation(char);\n        } else if (char === ',' && fn_stack[fn_stack.length - 1].special) {\n            was_string = false;\n            fn_stack[fn_stack.length - 1].exp.push(buffer, position_i);\n            fn_stack[fn_stack.length - 1].special.push(fn_stack[fn_stack.length - 1].exp);\n            fn_stack[fn_stack.length - 1].exp = exp_obj = new Exp(formula);\n            buffer = '';\n        } else {\n            buffer += char;\n        }\n    }\n\n    var state = start;\n    var position_i = 0;\n\n    for (; position_i < str_formula.length; position_i++) {\n        state(str_formula[position_i]); // 逐字符解析函数\n    }\n    root_exp.push(buffer, position_i); // root_exp 是一个Exp实例，这个实例会引用一个Exp数组\n    return root_exp;\n\n}\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst str_2_val = require('./str_2_val.js');\n//XW：统一报错\nvar error = require('./formulajs/lib/error');\n//XW：end\n\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\nvar exp_id = 0;\n\nmodule.exports = function Exp(formula) {\n    var self = this;\n    self.id = ++exp_id;   // id 是一个递增序列，其中root_exp的id为1\n    self.args = [];\n    self.name = 'Expression';\n    self.update_cell_value = update_cell_value;\n    self.formula = formula;\n\n    function update_cell_value() {\n        try {\n            if (Array.isArray(self.args)\n                    && self.args.length === 1\n                    && self.args[0] instanceof Range) {\n                throw error.value;\n            }\n            formula.cell.v = self.calc();\n\n            if (typeof(formula.cell.v) === 'string') {\n                formula.cell.t = 's';\n            }\n            else if (typeof(formula.cell.v) === 'number') {\n                formula.cell.t = 'n';\n            }\n        }\n        catch (e) {\n            var errorValues = {\n                '#NULL!': 0x00,\n                '#DIV/0!': 0x07,\n                '#VALUE!': 0x0F,\n                '#REF!': 0x17,\n                '#NAME?': 0x1D,\n                '#NUM!': 0x24,\n                '#N/A': 0x2A,\n                '#GETTING_DATA': 0x2B\n            };\n            if (errorValues[e.message] !== undefined) {\n                formula.cell.t = 'e';\n                formula.cell.w = e.message;\n                formula.cell.v = errorValues[e.message];\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            formula.status = 'done';\n        }\n    }\n    function isEmpty(value) {\n        return value === undefined || value === null || value === \"\";\n    }\n\n    function checkVariable(obj) {\n        if (typeof obj.calc !== 'function') {\n            return 0;\n        }\n        return 1;\n    }\n\n    function exec(op, args, fn) {\n        for (var i = 0; i < args.length; i++) {\n            if (args[i] === op) {\n                try {\n                    if (i === 0 && op === '+') {\n                        let as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = args[i + 1].calc();\n                        args.splice(i, 2, new RawValue(r));\n                    } else {\n                        let as = checkVariable(args[i - 1]);\n                        if (!as)\n                            break;\n                        as = checkVariable(args[i + 1]);\n                        if (!as)\n                            break;\n                        let r = fn(args[i - 1].calc(), args[i + 1].calc());\n                        args.splice(i - 1, 3, new RawValue(r));\n                        i--;\n                    }\n                }\n                catch (e) {\n                    // console.log('[Exp.js] - ' + formula.name + ': evaluating ' + formula.cell.f + '\\n' + e.message);\n                    throw e;\n                }\n            }\n        }\n    }\n\n    function exec_minus(args) {\n        for (var i = args.length; i--;) {\n            if (args[i] === '-') {\n                checkVariable(args[i + 1]);\n                var b = args[i + 1].calc();\n                if (i > 0 && typeof args[i - 1] !== 'string') {\n                    args.splice(i, 1, '+');\n                    if (b instanceof Date) {\n                        b = Date.parse(b);\n                        checkVariable(args[i - 1]);\n                        var a = args[i - 1].calc();\n                        if (a instanceof Date) {\n                            a = Date.parse(a) / MS_PER_DAY;\n                            b = b / MS_PER_DAY;\n                            args.splice(i - 1, 1, new RawValue(a));\n                        }\n                    }\n                    args.splice(i + 1, 1, new RawValue(-b));\n                }\n                else {\n                    args.splice(i, 2, new RawValue(-b));\n                }\n            }\n        }\n    }\n    self.calc = function() {\n        let args = self.args.concat();\n        //XW: 对函数参数做转换、判断\n        try{\n            for (var i=0;i<args.length;i++){\n                if (args[i].name == 'RefValue'){\n                    var sheet = args[i].formula.sheet\n                    //未定义单元格f置为default_0\n                    if (sheet[args[i].str_expression] === undefined){\n                        args[i].formula.sheet[args[i].str_expression] = {v: 'default_0'}\n                    }\n                    //=A0形式参数报错\n                    if (args[i].str_expression.slice(1, args[i].str_expression.length) == '0'){\n                        return error.name;\n                    }\n                }\n            }\n        }catch (e) {\n        }\n        try{\n            //形如2019年10月19日参数转为2019-10-19\n            if (args[0].name == 'RefValue' && args[1] == '-' && args[2].name == 'RefValue'){\n                var sheet = args[0].formula.sheet\n                var a = sheet[args[0].str_expression].v\n                var b = sheet[args[2].str_expression].v\n                var a = a.replace('年', '-').replace('月', '-').replace('日', '')\n                var b = b.replace('年', '-').replace('月', '-').replace('日', '')\n                return datedifference(a, b)\n            }\n        }catch (e) {\n        }\n        //XW：end\n        exec_minus(args);\n        exec('^', args, function(a, b) {\n            return Math.pow(+a, +b);\n        });\n        exec('/', args, function(a, b) {\n            if (b == 0) {\n                throw error.div0;\n            }\n            return (+a) / (+b);\n        });\n        exec('*', args, function(a, b) {\n            return (+a) * (+b);\n        });\n        exec('+', args, function(a, b) {\n            if (a instanceof Date && typeof b === 'number') {\n                b = b * MS_PER_DAY;\n            }\n            return (+a) + (+b);\n        });\n        exec('&', args, function(a, b) {\n            return '' + a + b;\n        });\n        exec('<', args, function(a, b) {\n            return a < b;\n        });\n        exec('>', args, function(a, b) {\n            return a > b;\n        });\n        exec('>=', args, function(a, b) {\n            return a >= b;\n        });\n        exec('<=', args, function(a, b) {\n            return a <= b;\n        });\n        exec('<>', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() !== b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return false;\n            }\n            return a != b;\n        });\n        exec('=', args, function(a, b) {\n            if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            if (isEmpty(a) && isEmpty(b)) {\n                return true;\n            }\n            if ((a == null && b === 0) || (a === 0 && b == null)) {\n                return true;\n            }\n            if (typeof a === 'string' && typeof b === 'string' && a.toLowerCase() === b.toLowerCase()) {\n                return true;\n            }\n            return a == b;\n        });\n        if (args.length == 1) {\n            if (typeof(args[0].calc) !== 'function') {\n                return args[0];\n            }\n            else {\n                return args[0].calc();\n            }\n        }\n    };\n\n    var last_arg;\n    self.push = function(buffer, position_i) {\n        if (buffer) {\n            var v = str_2_val(buffer, formula, position_i);\n            if (((v === '=') && (last_arg == '>' || last_arg == '<')) || (last_arg == '<' && v === '>')) {\n                self.args[self.args.length - 1] += v;\n            }\n            else {\n                self.args.push(v);\n            }\n            last_arg = v;\n            //console.log(self.id, '-->', v);\n        }\n    };\n};\n","\"use strict\";\n\nmodule.exports = function UserFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserFn';\n    self.args = [];\n    self.calc = function() {\n        var errorValues = {\n            '#NULL!': 0x00,\n            '#DIV/0!': 0x07,\n            '#VALUE!': 0x0F,\n            '#REF!': 0x17,\n            '#NAME?': 0x1D,\n            '#NUM!': 0x24,\n            '#N/A': 0x2A,\n            '#GETTING_DATA': 0x2B\n        }, result;\n        try {\n            result = user_function.apply(self, self.args.map(f=>f.calc()));\n        } catch (e) {\n            if (user_function.name === 'is_blank'\n                && errorValues[e.message] !== undefined) {\n                // is_blank applied to an error cell doesn't propagate the error\n                result = 0;\n            }\n            else if (user_function.name === 'iserror'\n                && errorValues[e.message] !== undefined) {\n                // iserror applied to an error doesn't propagate the error and returns true\n                result = true;\n            }\n            else {\n                throw e;\n            }\n        }\n        return result;\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};","\"use strict\";\n\nmodule.exports = function UserRawFnExecutor(user_function) {\n    var self = this;\n    self.name = 'UserRawFn';\n    self.args = [];\n    self.calc = function() {\n        return user_function.apply(self, self.args);\n    };\n    self.push = function(buffer) {\n        self.args.push(buffer);\n    };\n};\n","var mathTrig = require('./math-trig');\nvar statistical = require('./statistical');\nvar engineering = require('./engineering');\nvar dateTime = require('./date-time');\n\nfunction set(fn, root) {\n  if (root) {\n    for (var i in root) {\n      fn[i] = root[i];\n    }\n  }\n  return fn;\n}\n\nexports.BETADIST = statistical.BETA.DIST;\nexports.BETAINV = statistical.BETA.INV;\nexports.BINOMDIST = statistical.BINOM.DIST;\nexports.CEILING = exports.ISOCEILING = set(mathTrig.CEILING.MATH, mathTrig.CEILING);\nexports.CEILINGMATH = mathTrig.CEILING.MATH;\nexports.CEILINGPRECISE = mathTrig.CEILING.PRECISE;\nexports.CHIDIST = statistical.CHISQ.DIST;\nexports.CHIDISTRT = statistical.CHISQ.DIST.RT;\nexports.CHIINV = statistical.CHISQ.INV;\nexports.CHIINVRT = statistical.CHISQ.INV.RT;\nexports.CHITEST = statistical.CHISQ.TEST;\nexports.CONFIDENCE = set(statistical.CONFIDENCE.NORM, statistical.CONFIDENCE);\nexports.COVAR = statistical.COVARIANCE.P;\nexports.COVARIANCEP = statistical.COVARIANCE.P;\nexports.COVARIANCES = statistical.COVARIANCE.S;\nexports.CRITBINOM = statistical.BINOM.INV;\nexports.EXPONDIST = statistical.EXPON.DIST;\nexports.ERFCPRECISE = engineering.ERFC.PRECISE;\nexports.ERFPRECISE = engineering.ERF.PRECISE;\nexports.FDIST = statistical.F.DIST;\nexports.FDISTRT = statistical.F.DIST.RT;\nexports.FINVRT = statistical.F.INV.RT;\nexports.FINV = statistical.F.INV;\n// XW：FLOOR函数修改\n// exports.FLOOR = set(mathTrig.FLOORMATH, mathTrig.FLOOR);//11.5-调用矛盾\nexports.FLOORMATH = mathTrig.FLOORMATH;\nexports.FLOORPRECISE = mathTrig.FLOORPRACE;\n//XW：end\nexports.FTEST = statistical.F.TEST;\nexports.GAMMADIST = statistical.GAMMA.DIST;\nexports.GAMMAINV = statistical.GAMMA.INV;\nexports.GAMMALNPRECISE = statistical.GAMMALN.PRECISE;\nexports.HYPGEOMDIST = statistical.HYPGEOM.DIST;\nexports.LOGINV = statistical.LOGNORM.INV;\nexports.LOGNORMINV = statistical.LOGNORM.INV;\nexports.LOGNORMDIST = statistical.LOGNORM.DIST;\nexports.MODE = set(statistical.MODE.SNGL, statistical.MODE);\nexports.MODEMULT = statistical.MODE.MULT;\nexports.MODESNGL = statistical.MODE.SNGL;\nexports.NEGBINOMDIST = statistical.NEGBINOM.DIST;\nexports.NETWORKDAYSINTL = dateTime.NETWORKDAYSINTL;\nexports.NORMDIST = statistical.NORM.DIST;\nexports.NORMINV = statistical.NORM.INV;\nexports.NORMSDIST = statistical.NORM.S.DIST;\nexports.NORMSINV = statistical.NORM.S.INV;\nexports.PERCENTILE = set(statistical.PERCENTILE.EXC, statistical.PERCENTILE);\nexports.PERCENTILEEXC = statistical.PERCENTILE.EXC;\nexports.PERCENTILEINC = statistical.PERCENTILE.INC;\nexports.PERCENTRANK = set(statistical.PERCENTRANK.INC, statistical.PERCENTRANK);\nexports.PERCENTRANKEXC = statistical.PERCENTRANK.EXC;\nexports.PERCENTRANKINC = statistical.PERCENTRANK.INC;\nexports.POISSON = set(statistical.POISSON.DIST, statistical.POISSON);\nexports.POISSONDIST = statistical.POISSON.DIST;\nexports.QUARTILE = set(statistical.QUARTILE.INC, statistical.QUARTILE);\nexports.QUARTILEEXC = statistical.QUARTILE.EXC;\nexports.QUARTILEINC = statistical.QUARTILE.INC;\nexports.RANK = set(statistical.RANK.EQ, statistical.RANK);\nexports.RANKAVG = statistical.RANK.AVG;\nexports.RANKEQ = statistical.RANK.EQ;\nexports.SKEWP = statistical.SKEW.P;\nexports.STDEV = set(statistical.STDEV.S, statistical.STDEV);\nexports.STDEVP = statistical.STDEV.P;\nexports.STDEVS = statistical.STDEV.S;\nexports.TDIST = statistical.T.DIST;\nexports.TDISTRT = statistical.T.DIST.RT;\nexports.TINV = statistical.T.INV;\nexports.TTEST = statistical.T.TEST;\n// exports.VAR = set(statistical.VAR.S, statistical.VAR);\nexports.VARP = statistical.VAR.P;\nexports.VARS = statistical.VAR.S;\nexports.WEIBULL = set(statistical.WEIBULL.DIST, statistical.WEIBULL);\nexports.WEIBULLDIST = statistical.WEIBULL.DIST;\nexports.WORKDAYINTL = dateTime.WORKDAYINTL;\nexports.ZTEST = statistical.Z.TEST;\n//XW: _XLFN开头函数处理\nexports._XLFN = set(mathTrig.FLOOR.MATH, statistical.COVARIANCE.P, statistical.NORM.INV, statistical.VAR.P)\n// exports._XLFN.FLOOR = mathTrig.FLOOR\n// exports._XLFN.COVARIANCE = statistical.COVARIANCE\n// exports._XLFN.NORM = statistical.NORM\n// exports._XLFN.VAR = statistical.VAR\n//XW：end","var defaultOperator = '=';\nvar validSymbols = ['>', '>=', '<', '<=', '=', '<>'];\nvar TOKEN_TYPE_OPERATOR = 'operator';\nvar TOKEN_TYPE_LITERAL = 'literal';\nvar SUPPORTED_TOKENS = [TOKEN_TYPE_OPERATOR, TOKEN_TYPE_LITERAL];\n\nexports.TOKEN_TYPE_OPERATOR = TOKEN_TYPE_OPERATOR;\nexports.TOKEN_TYPE_LITERAL = TOKEN_TYPE_LITERAL;\n\n/**\n * Create token which describe passed symbol/value.\n *\n * @param {String} value Value/Symbol to describe.\n * @param {String} type Type of the token 'operator' or 'literal'.\n * @return {Object}\n */\nfunction createToken(value, type) {\n  if (SUPPORTED_TOKENS.indexOf(type) === -1) {\n    throw new Error('Unsupported token type: ' + type);\n  }\n\n  return {\n    value: value,\n    type: type,\n  };\n}\n\n/**\n * Tries to cast numeric values to their type passed as a string.\n *\n * @param {*} value\n * @return {*}\n */\nfunction castValueToCorrectType(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  if (/^\\d+(\\.\\d+)?$/.test(value)) {\n    value = value.indexOf('.') === -1 ? parseInt(value, 10) : parseFloat(value);\n  }\n\n  return value;\n}\n\n/**\n * Generate stream of tokens from passed expression.\n *\n * @param {String} expression\n * @return {String[]}\n */\nfunction tokenizeExpression(expression) {\n  var expressionLength = expression.length;\n  var tokens = [];\n  var cursorIndex = 0;\n  var processedValue = '';\n  var processedSymbol = '';\n\n  while (cursorIndex < expressionLength) {\n    var char = expression.charAt(cursorIndex);\n\n    switch (char) {\n      case '>':\n      case '<':\n      case '=':\n        processedSymbol = processedSymbol + char;\n\n        if (processedValue.length > 0) {\n          tokens.push(processedValue);\n          processedValue = '';\n        }\n        break;\n      default:\n        if (processedSymbol.length > 0) {\n          tokens.push(processedSymbol);\n          processedSymbol = '';\n        }\n\n        processedValue = processedValue + char;\n        break;\n    }\n    cursorIndex++;\n  }\n\n  if (processedValue.length > 0) {\n    tokens.push(processedValue);\n  }\n  if (processedSymbol.length > 0) {\n    tokens.push(processedSymbol);\n  }\n\n  return tokens;\n};\n\n/**\n * Analyze and convert tokens to an object which describes their meaning.\n *\n * @param {String[]} tokens\n * @return {Object[]}\n */\nfunction analyzeTokens(tokens) {\n  var literalValue = '';\n  var analyzedTokens = [];\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (i === 0 && validSymbols.indexOf(token) >= 0) {\n      analyzedTokens.push(createToken(token, TOKEN_TYPE_OPERATOR));\n    } else {\n      literalValue += token;\n    }\n  }\n\n  if (literalValue.length > 0) {\n    analyzedTokens.push(createToken(castValueToCorrectType(literalValue), TOKEN_TYPE_LITERAL));\n  }\n\n  if (analyzedTokens.length > 0 && analyzedTokens[0].type !== TOKEN_TYPE_OPERATOR) {\n    analyzedTokens.unshift(createToken(defaultOperator, TOKEN_TYPE_OPERATOR));\n  }\n\n  return analyzedTokens;\n};\n\n/**\n * Compute/Evaluate an expression passed as an array of tokens.\n *\n * @param {Object[]} tokens\n * @return {Boolean}\n */\nfunction computeExpression(tokens) {\n  var values = [];\n  var operator;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    switch (token.type) {\n      case TOKEN_TYPE_OPERATOR:\n        operator = token.value;\n        break;\n      case TOKEN_TYPE_LITERAL:\n        values.push(token.value);\n        break;\n    }\n  }\n\n  return evaluate(values, operator);\n};\n\n/**\n * Evaluate values based on passed math operator.\n *\n * @param {*} values\n * @param {String} operator\n * @return {Boolean}\n */\nfunction evaluate(values, operator) {\n  var result = false;\n\n  switch (operator) {\n    case '>':\n      result = values[0] > values[1];\n      break;\n    case '>=':\n      result = values[0] >= values[1];\n      break;\n    case '<':\n      result = values[0] < values[1];\n      break;\n    case '<=':\n      result = values[0] <= values[1];\n      break;\n    case '=':\n      result = values[0] == values[1];\n      break;\n    case '<>':\n      result = values[0] != values[1];\n      break;\n  }\n\n  return result;\n}\n\nexports.parse = function(expression) {\n  return analyzeTokens(tokenizeExpression(expression));\n};\nexports.createToken = createToken;\nexports.compute = computeExpression;","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst exec_formula = require('./exec_formula.js');\nconst find_all_need_calc_cell = require('./find_all_cells_with_formulas.js');\nconst Calculator = require('./Calculator.js');\nconst CalcCell = require('./CalcCell.js');\nconst checker = require('./formula_check.js');\nconst helper = require(\"../core/helper\")\nconst CalcWorkBook = require('./CalcWorkBook')\nvar mymodule = function(rows, tileArr) {\n    if (helper.isHave(tileArr)){\n        var Calc_WorkBook = new CalcWorkBook(rows, tileArr)\n        var workbook = rows.workbook\n        workbook = Calc_WorkBook.get_workbook(workbook)\n        var formulas = find_all_need_calc_cell(workbook, tileArr, exec_formula)\n        for (var i = formulas.length - 1; i >= 0; i--) {\n            try {\n                var calc_cell = new CalcCell(formulas[i], rows)\n                var valid_res = calc_cell.check_valid()\n                if (valid_res !== true){\n                    formulas[i].cell.v = valid_res\n                }else{\n                    //对cell和sheet进行处理和转换({}参数加上'',未定义单元格置为default_0等)，计算完成后需将多余变动部分还原\n                    formulas[i].cell.f = calc_cell.trans_formula()\n                    checker.trans_sheet(formulas[i].sheet)\n                    exec_formula(formulas[i]);\n                    formulas[i].cell.f = calc_cell.recover_formula()\n                    checker.recover_sheet(formulas[i].sheet)\n                }\n                //如果是多值单元格或公式返回结果为array，进入多单元格处理\n                if (Calc_WorkBook.is_muti_cell(formulas[i]) || Array.isArray(formulas[i].cell.v)){\n                    Calc_WorkBook.deal_muti_cell(workbook, formulas[i])\n                }\n            } catch (e) {\n                console.log(e)\n            }\n        }\n        Calc_WorkBook.calcDoneToSetCells(workbook, rows)\n    }\n\n};\n\nmymodule.calculator = function calculator(workbook) {\n    return new Calculator(workbook, exec_formula);\n};\n\nmymodule.set_fx = exec_formula.set_fx;\nmymodule.exec_fx = exec_formula.exec_fx;\nmymodule.col_str_2_int = col_str_2_int;\nmymodule.int_2_col_str = int_2_col_str;\nmymodule.import_functions = exec_formula.import_functions;\nmymodule.import_raw_functions = exec_formula.import_raw_functions;\nmymodule.xlsx_Fx = exec_formula.xlsx_Fx;\nmymodule.localizeFunctions = exec_formula.localizeFunctions;\n\nmymodule.XLSX_CALC = mymodule\n\nmodule.exports = mymodule;\n","var error = require('./error');\nvar stats = require('./statistical');\nvar maths = require('./math-trig');\nvar utils = require('./utils');\n\nfunction compact(array) {\n  if (!array) { return array; }\n  var result = [];\n  for (var i = 0; i < array.length; ++i) {\n    if (!array[i]) { continue; }\n    result.push(array[i]);\n  }\n  return result;\n}\n\nexports.FINDFIELD = function(database, title) {\n  var index = null;\n  for (var i = 0; i < database.length; i++) {\n    if (database[i][0] === title) {\n      index = i;\n      break;\n    }\n  }\n\n  // Return error if the input field title is incorrect\n  if (index == null) {\n    return error.value;\n  }\n  return index;\n};\n\n//XW: 重写函数\nfunction find_result_idx(database, criteria){\n  var valid_arr = []\n  var filter_arr = []\n  for (var i=0; i < criteria[0].length; i++) {\n    filter_arr.push(criteria[0][i])\n  }\n  for (var i=1; i < criteria.length; i++){\n    var arr = criteria[i]\n    var valid_str = []\n    for (var j=0; j < filter_arr.length; j++){\n      if (arr[j] != null){\n        valid_str.push(database[0].indexOf(criteria[0][j]) + '-' + arr[j])\n      }\n    }\n    valid_arr.push(valid_str)\n  }\n  var result_idx = []\n  for (var i=1; i < database.length; i++){\n    var data = database[i]\n    for(var j=0;j<valid_arr.length;j++){\n      var is_valid = true\n      for(var k=0;k<valid_arr[j].length;k++){\n        var a = data[parseInt(valid_arr[j][k].split('-')[0])]\n        var b = valid_arr[j][k].split('-')[1]\n        if (b.indexOf('=') >= 0){\n          is_valid = (a == b.replace('=', ''))\n        }else if(!eval(a+b)){\n          is_valid = false\n        }\n      }\n      if(is_valid){\n        result_idx.push(i)\n      }\n    }\n  }\n  return result_idx\n}\nfunction get_values(resultIndexes, database, field){\n  if (typeof field == 'number'){\n    var field_idx = field - 1\n  }else{\n    var field_idx = database[0].indexOf(field)\n  }\n  var values= []\n  for (var i=0; i< resultIndexes.length; i++){\n    values.push(database[resultIndexes[i]][field_idx])\n  }\n  return values\n}\n// Database functions\nexports.DAVERAGE = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  if (typeof field == 'number'){\n    var resultIndexes = [];\n    for (var i=1;i<database.length;i++){\n      resultIndexes.push(i)\n    }\n  }else{\n    var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  var sum = 0\n  for (var i=0; i < targetValues.length; i++){\n    sum += targetValues[i]\n  }\n  return resultIndexes.length === 0 ? error.div0 : sum / targetValues.length;\n};\nexports.DCOUNT = function(database, field, criteria) {\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNT(targetValues);\n};\n\nexports.DCOUNTA = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.COUNTA(targetValues);\n};\n\nexports.DGET = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  if (resultIndexes.length > 1){\n    return error.num\n  }\n  var targetValues = get_values(resultIndexes, database, field);\n  return targetValues[0];\n};\n\nexports.DMAX = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var max = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] > max){\n      max = targetValues[i]\n    }\n  }\n  return max\n};\n\nexports.DMIN = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var min = targetValues[0]\n  for (var i=0;i<targetValues.length;i++){\n    if (targetValues[i] < min){\n      min = targetValues[i]\n    }\n  }\n  return min\n};\n\nexports.DPRODUCT = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  var result = 1;\n  for (var i=0; i < targetValues.length; i++){\n    result *= targetValues[i]\n  }\n  return result;\n};\n\nexports.DSTDEV = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.S(targetValues);\n};\n\nexports.DSTDEVP = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  targetValues = compact(targetValues);\n  return stats.STDEV.P(targetValues);\n};\n\nexports.DSUM = function(database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return maths.SUM(targetValues);\n};\n\nexports.DVAR = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.S(targetValues);\n};\n\nexports.DVARP = function (database, field, criteria) {\n  // Return error if field is not a number and not a string\n  if (isNaN(field) && (typeof field !== \"string\")) {\n    return error.value;\n  }\n  var resultIndexes = find_result_idx(database,criteria)//findResultIndex(database, criteria);\n  var targetValues = get_values(resultIndexes, database, field);\n  return stats.VAR.P(targetValues);\n};\n//XW：end\n","var error = require('./error');\nvar utils = require('./utils');\nvar information = require('./information');\n\nexports.AND = function() {\n  var args = utils.flatten(arguments);\n  var result = true;\n  for (var i = 0; i < args.length; i++) {\n    if (!args[i]) {\n      result = false;\n    }\n  }\n  return result;\n};\n\nexports.CHOOSE = function() {\n  if (arguments.length < 2) {\n    return error.na;\n  }\n\n  var index = arguments[0];\n  if (index < 1 || index > 254) {\n    return error.value;\n  }\n\n  if (arguments.length < index + 1) {\n    return error.value;\n  }\n\n  return arguments[index];\n};\n\nexports.FALSE = function() {\n  return false;\n};\n\nexports.IF = function(test, then_value, otherwise_value) {\n  return test ? then_value : otherwise_value;\n};\n\nexports.IFERROR = function(value, valueIfError) {\n  if (information.ISERROR(value)) {\n    return valueIfError;\n  }\n  return value;\n};\n\nexports.IFNA = function(value, value_if_na) {\n  return value === error.na ? value_if_na : value;\n};\n\nexports.NOT = function(logical) {\n  return !logical;\n};\n\nexports.OR = function() {\n  var args = utils.flatten(arguments);\n  var result = false;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result = true;\n    }\n  }\n  return result;\n};\n\nexports.TRUE = function() {\n  return true;\n};\n\nexports.XOR = function() {\n  var args = utils.flatten(arguments);\n  var result = 0;\n  for (var i = 0; i < args.length; i++) {\n    if (args[i]) {\n      result++;\n    }\n  }\n  return (Math.floor(Math.abs(result)) & 1) ? true : false;\n};\n\nexports.SWITCH = function () {\n  var result;\n  if (arguments.length > 0) {\n    var targetValue = arguments[0];\n    var argc = arguments.length - 1;\n    var switchCount = Math.floor(argc / 2);\n    var switchSatisfied = false;\n    var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\n\n    if (switchCount) {\n      for (var index = 0; index < switchCount; index++) {\n        if (targetValue === arguments[index * 2 + 1]) {\n          result = arguments[index * 2 + 2];\n          switchSatisfied = true;\n          break;\n        }\n      }\n    }\n\n    if (!switchSatisfied && defaultClause) {\n      result = defaultClause;\n    }\n  }\n  if (result == undefined){\n    return error.na\n  }\n  return result;\n};\n","var error = require('./error');\nvar dateTime = require('./date-time');\nvar utils = require('./utils');\n\nfunction validDate(d) {\n  return d && d.getTime && !isNaN(d.getTime());\n}\n\nfunction ensureDate(d) {\n  return (d instanceof Date)?d:new Date(d);\n}\n\nexports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\n  if (typeof issue=='string'){\n    issue = utils.parseDate(issue)\n  }\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    first = utils.ExcelDateToJSDate(first);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\n    return error.value;\n  }\n\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n  // Return error if frequency is neither 1, 2, or 4\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n  // Return error if basis is neither 0, 1, 2, 3, or 4\n  if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  return par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n};\n\n// XW: ACCRINTM函数\nexports.ACCRINTM = function(issue, settlement, rate, par, basis) {\n  //XW: 参数错误报错\n  try{\n    issue = utils.ExcelDateToJSDate(issue);\n    settlement = utils.ExcelDateToJSDate(settlement);\n  }catch (e) {\n    return error.value;\n  }\n  //XW：end\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n\n\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n\n  // Set default values\n  par = par || 0;\n  basis = basis || 0;\n  // Compute accrued interest\n  var result = par * rate * dateTime.YEARFRAC(issue, settlement, basis);\n  if (isNaN(result)){\n    return error.value;\n  }else{\n    return result\n  }\n};\n//XW: end\n\n// TODO\n//XW: 待实现\nexports.AMORDEGRC = function (cost, date_purchased, first_period, salvage, period, rate, basis) {\n  if (!validDate(issue) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (rate <= 0 || par <= 0) {\n    return error.num;\n  }\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement <= issue) {\n    return error.num;\n  }\n};\n\n// TODO\nexports.AMORLINC = function() {\n throw new Error('AMORLINC is not implemented');\n};\n\n// TODO\nexports.COUPDAYBS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n  // Return error if settlement is before or equal to issue\n  if (settlement >= maturity) {\n    return error.num;\n  }\n};\n\nexports.COUPDAYS = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPDAYSNC = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.numerror.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPNUM = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n\n// TODO\nexports.COUPPCD = function (settlement, maturity, frequency, basis) {\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  // Return error if either rate or par are lower than or equal to zero\n  if (basis < 0 || basis > 4) {\n    return error.num;\n  }\n  if (frequency !=1&&frequency!=2&&frequency!=4){\n    return error.num;\n  }\n};\n//XW：end\n\nexports.CUMIPMT = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n  // Requires exports.FV() and exports.PMT() from exports.js [http://stoic.com/exports/]\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative interest\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var interest = 0;\n\n  if (start === 1) {\n    if (type === 0) {\n      interest = -value;\n      start++;\n    }\n  }\n\n  for (var i = start; i <= end; i++) {\n    if (type === 1) {\n      interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\n    } else {\n      interest += exports.FV(rate, i - 1, payment, value, 0);\n    }\n  }\n  interest *= rate;\n\n  // Return cumulative interest\n  return interest;\n};\n\nexports.CUMPRINC = function(rate, periods, value, start, end, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n  // Credits: Hannes Stiebitzhofer for the translations of function and variable names\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, periods, value)) {\n    return error.value;\n  }\n\n  // Return error if either rate, periods, or value are lower than or equal to zero\n  if (rate <= 0 || periods <= 0 || value <= 0) {\n    return error.num;\n  }\n\n  // Return error if start < 1, end < 1, or start > end\n  if (start < 1 || end < 1 || start > end) {\n    return error.num;\n  }\n\n  // Return error if type is neither 0 nor 1\n  if (type !== 0 && type !== 1) {\n    return error.num;\n  }\n\n  // Compute cumulative principal\n  var payment = exports.PMT(rate, periods, value, 0, type);\n  var principal = 0;\n  if (start === 1) {\n    if (type === 0) {\n      principal = payment + value * rate;\n    } else {\n      principal = payment;\n    }\n    start++;\n  }\n  for (var i = start; i <= end; i++) {\n    if (type > 0) {\n      principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\n    } else {\n      principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\n    }\n  }\n\n  // Return cumulative principal\n  return principal;\n};\n\nexports.DB = function(cost, salvage, life, period, month) {\n  // Initialize month\n  month = (month === undefined) ? 12 : month;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  month = utils.parseNumber(month);\n  if (utils.anyIsError(cost, salvage, life, period, month)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\n    return error.num;\n  }\n\n  // Return error if month is not an integer between 1 and 12\n  if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Rate is rounded to three decimals places\n  var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\n\n  // Compute initial depreciation\n  var initial = cost * rate * month / 12;\n\n  // Compute total depreciation\n  var total = initial;\n  var current = 0;\n  var ceiling = (period === life) ? life - 1 : period;\n  for (var i = 2; i <= ceiling; i++) {\n    current = (cost - total) * rate;\n    total += current;\n  }\n\n  // Depreciation for the first and last periods are special cases\n  if (period === 1) {\n    // First period\n    return initial;\n  } else if (period === life) {\n    // Last period\n    return (cost - total) * rate;\n  } else {\n    return current;\n  }\n};\n\nexports.DDB = function(cost, salvage, life, period, factor) {\n  // Initialize factor\n  factor = (factor === undefined) ? 2 : factor;\n\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  factor = utils.parseNumber(factor);\n  if (utils.anyIsError(cost, salvage, life, period, factor)) {\n    return error.value;\n  }\n\n  // Return error if any of the parameters is negative or if factor is null\n  if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\n    return error.num;\n  }\n\n  // Return error if period is greater than life\n  if (period > life) {\n    return error.num;\n  }\n\n  // Return 0 (zero) if salvage is greater than or equal to cost\n  if (salvage >= cost) {\n    return 0;\n  }\n\n  // Compute depreciation\n  var total = 0;\n  var current = 0;\n  for (var i = 1; i <= period; i++) {\n    current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\n    total += current;\n  }\n\n  // Return depreciation\n  return current;\n};\n\n// TODO\nexports.DISC = function (settlement,maturity,pr,redemption,basis) {\n  if (pr<=0 || redemption<=0){\n    return error.num\n  }\n  if (basis<0 || basis >4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 360\n  var DSM = Math.abs(dateTime.DAYS(maturity, settlement, false))\n  return (redemption-pr)/pr * B /DSM\n};\n\nexports.DOLLARDE = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\n\n  // Round result\n  var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\n  result = Math.round(result * power) / power;\n\n  // Return converted dollar price\n  return result;\n};\n\nexports.DOLLARFR = function(dollar, fraction) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  dollar = utils.parseNumber(dollar);\n  fraction = utils.parseNumber(fraction);\n  if (utils.anyIsError(dollar, fraction)) {\n    return error.value;\n  }\n\n  // Return error if fraction is negative\n  if (fraction < 0) {\n    return error.num;\n  }\n\n  // Return error if fraction is greater than or equal to 0 and less than 1\n  if (fraction >= 0 && fraction < 1) {\n    return error.div0;\n  }\n\n  // Truncate fraction if it is not an integer\n  fraction = parseInt(fraction, 10);\n\n  // Compute integer part\n  var result = parseInt(dollar, 10);\n\n  // Add decimal part\n  result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\n\n  // Return converted dollar price\n  return result;\n};\n\n// TODO\n//XW：待实现\nexports.DURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (!validDate(maturity) || !validDate(settlement)) {\n    return error.value;\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n};\n//XW：end\n\nexports.EFFECT = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return effective annual interest rate\n  return Math.pow(1 + rate / periods, periods) - 1;\n};\n\nexports.FV = function(rate, periods, payment, value, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  value = value || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  value = utils.parseNumber(value);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, value, type)) {\n    return error.value;\n  }\n\n  // Return future value\n  var result;\n  if (rate === 0) {\n    result = value + payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = value * term + payment * (1 + rate) * (term - 1) / rate;\n    } else {\n      result = value * term + payment * (term - 1) / rate;\n    }\n  }\n  return -result;\n};\n\nexports.FVSCHEDULE = function (principal, schedule) {\n  principal = utils.parseNumber(principal);\n  if (typeof schedule === 'string'){\n    schedule = utils.strToMatrix(schedule)\n  }\n  schedule = utils.parseNumberArray(utils.flatten(schedule));\n  if (utils.anyIsError(principal, schedule)) {\n    return error.value;\n  }\n\n  var n = schedule.length;\n  var future = principal;\n\n  // Apply all interests in schedule\n  for (var i = 0; i < n; i++) {\n    // Apply scheduled interest\n    future *= 1 + schedule[i];\n  }\n\n  // Return future value\n  return future;\n};\n\n// XW：INTRATE实现\nexports.INTRATE = function (settlement, maturity, investment, redemption, basis) {\n  //https://support.office.com/zh-cn/article/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f\n  if (investment<=0 || redemption<=0){\n    return error.value\n  }\n  if (basis<0 || basis > 4){\n    return error.num\n  }\n  if (settlement >= maturity){\n    return error.num\n  }\n  var B = 1//一年之中的天数，取决于年基准数。\n  var DIM = 2// 结算日与到期日之间的天数。\n  return (redemption-investment)/investment *(B/DIM)\n};\n//XW：end\n\nexports.IPMT = function(rate, period, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, period, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Compute payment\n  var payment = exports.PMT(rate, periods, present, future, type);\n\n  // Compute interest\n  var interest;\n  if (period === 1) {\n    if (type === 1) {\n      interest = 0;\n    } else {\n      interest = -present;\n    }\n  } else {\n    if (type === 1) {\n      interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\n    } else {\n      interest = exports.FV(rate, period - 1, payment, present, 0);\n    }\n  }\n\n  // Return interest\n  return interest * rate;\n};\n\nexports.IRR = function(values, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  guess = guess || 0;\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = (dates[i] - dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Initialize dates and check that values contains at least one positive value and one negative value\n  var dates = [];\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = (guess === undefined) ? 0.1 : guess;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.ISPMT = function(rate, period, periods, value) {\n  rate = utils.parseNumber(rate);\n  period = utils.parseNumber(period);\n  periods = utils.parseNumber(periods);\n  value = utils.parseNumber(value);\n  if (utils.anyIsError(rate, period, periods, value)) {\n    return error.value;\n  }\n\n  // Return interest\n  return value * rate * (period / periods - 1);\n};\n\n// XW：待实现\nexports.MDURATION = function (settlement, maturity, coupon, yld, frequency, basis) {\n  if (coupon < 0 || yld < 0){\n    return error.num\n  }\n  if (basis < 0 || basis > 4){\n    return error.num\n  }\n  if ([1, 2, 4].indexOf(frequency) === -1) {\n    return error.num;\n  }\n\n};\n//xW:end\n\nexports.MIRR = function(values, finance_rate, reinvest_rate) {\n  values = utils.parseNumberArray(utils.flatten(values));\n  finance_rate = utils.parseNumber(finance_rate);\n  reinvest_rate = utils.parseNumber(reinvest_rate);\n  if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\n    return error.value;\n  }\n\n  // Initialize number of values\n  var n = values.length;\n\n  // Lookup payments (negative values) and incomes (positive values)\n  var payments = [];\n  var incomes = [];\n  for (var i = 0; i < n; i++) {\n    if (values[i] < 0) {\n      payments.push(values[i]);\n    } else {\n      incomes.push(values[i]);\n    }\n  }\n\n  // Return modified internal rate of return\n  var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\n  var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\n  return Math.pow(num / den, 1 / (n - 1)) - 1;\n};\n\nexports.NOMINAL = function(rate, periods) {\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  if (utils.anyIsError(rate, periods)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0 or periods < 1\n  if (rate <= 0 || periods < 1) {\n    return error.num;\n  }\n\n  // Truncate periods if it is not an integer\n  periods = parseInt(periods, 10);\n\n  // Return nominal annual interest rate\n  return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n};\n\nexports.NPER = function(rate, payment, present, future, type) {\n  type = (type === undefined) ? 0 : type;\n  future = (future === undefined) ? 0 : future;\n\n  rate = utils.parseNumber(rate);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, payment, present, future, type)) {\n    return error.value;\n  }\n\n  // Return number of periods\n  var num = payment * (1 + rate * type) - future * rate;\n  var den = (present * rate + payment * (1 + rate * type));\n  return Math.log(num / den) / Math.log(1 + rate);\n};\n\nexports.NPV = function() {\n  var args = utils.parseNumberArray(utils.flatten(arguments));\n  if (args instanceof Error) {\n    return args;\n  }\n\n  // Lookup rate\n  var rate = args[0];\n\n  // Initialize net present value\n  var value = 0;\n\n  // Loop on all values\n  for (var j = 1; j < args.length; j++) {\n    value += args[j] / Math.pow(1 + rate, j);\n  }\n\n  // Return net present value\n  return value;\n};\n\n// XW:待实现\nexports.ODDFPRICE = function() {\n throw new Error('ODDFPRICE is not implemented');\n};\n\n// TODO\nexports.ODDFYIELD = function() {\n throw new Error('ODDFYIELD is not implemented');\n};\n\n// TODO\nexports.ODDLPRICE = function() {\n throw new Error('ODDLPRICE is not implemented');\n};\n\n// TODO\nexports.ODDLYIELD = function() {\n throw new Error('ODDLYIELD is not implemented');\n};\n//XW：end\nexports.PDURATION = function(rate, present, future) {\n  rate = utils.parseNumber(rate);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(rate, present, future)) {\n    return error.value;\n  }\n\n  // Return error if rate <=0\n  if (rate <= 0) {\n    return error.num;\n  }\n\n  // Return number of periods\n  return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\n};\n\nexports.PMT = function(rate, periods, present, future, type) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  // Return payment\n  var result;\n  if (rate === 0) {\n    result = (present + future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    if (type === 1) {\n      result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\n    } else {\n      result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\n    }\n  }\n  return -result;\n};\n\nexports.PPMT = function(rate, period, periods, present, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, present, future, type)) {\n    return error.value;\n  }\n\n  return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\n};\n//XW：函数实现\nexports.PRICE = function (settlement, maturity, rate, yld, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEDISC = function (settlement, maturity, discount, redemption, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return redemption - discount*redemption*day/360\n};\n\n// TODO\nexports.PRICEMAT = function (settlement, maturity, issue, rate, yld, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  issue = utils.parseDate(issue);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var dsm = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  var dim = Math.abs(dateTime.DAYS(maturity, issue, false))\n  var B = 360\n  var A = Math.abs(dateTime.DAYS(issue, settlement, false))\n  var result = (100 + ((dim/B)*rate*100))/(1+(dsm/B)*yld)-(A/B)*rate*100\n  return result\n};\n//XW：end\nexports.PV = function(rate, periods, payment, future, type) {\n  future = future || 0;\n  type = type || 0;\n\n  rate = utils.parseNumber(rate);\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  if (utils.anyIsError(rate, periods, payment, future, type)) {\n    return error.value;\n  }\n\n  // Return present value\n  if (rate === 0) {\n    return -payment * periods - future;\n  } else {\n    return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\n  }\n};\n\nexports.RATE = function(periods, payment, present, future, type, guess) {\n  // Credits: rabugento\n\n  guess = (guess === undefined) ? 0.01 : guess;\n  future = (future === undefined) ? 0 : future;\n  type = (type === undefined) ? 0 : type;\n\n  periods = utils.parseNumber(periods);\n  payment = utils.parseNumber(payment);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  type = utils.parseNumber(type);\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(periods, payment, present, future, type, guess)) {\n    return error.value;\n  }\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-6;\n\n  // Set maximum number of iterations\n  var iterMax = 100;\n  var iter = 0;\n  var close = false;\n  var rate = guess;\n\n  while (iter < iterMax && !close) {\n    var t1 = Math.pow(rate + 1, periods);\n    var t2 = Math.pow(rate + 1, periods - 1);\n\n    var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\n    var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\n    var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\n\n    var newRate = rate - f1 / (f2 + f3);\n\n    if (Math.abs(newRate - rate) < epsMax) close = true;\n    iter++\n    rate = newRate;\n  }\n\n  if (!close) return Number.NaN + rate;\n  return rate;\n};\n//XW：函数实现\nexports.RECEIVED = function (settlement, maturity, investment, discount, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if (investment <= 0 || discount <= 0){\n    return error.na\n  }\n  if (basis<0 || basis>4){\n    return error.na\n  }\n  if(settlement >= maturity){\n    return error.na\n  }\n  var day = Math.abs(dateTime.DAYS(settlement, maturity, false))\n  return investment/(1-(discount*day/360))\n};\n//XW：end\n\nexports.RRI = function(periods, present, future) {\n  periods = utils.parseNumber(periods);\n  present = utils.parseNumber(present);\n  future = utils.parseNumber(future);\n  if (utils.anyIsError(periods, present, future)) {\n    return error.value;\n  }\n\n  // Return error if periods or present is equal to 0 (zero)\n  if (periods === 0 || present === 0) {\n    return error.num;\n  }\n\n  // Return equivalent interest rate\n  return Math.pow(future / present, 1 / periods) - 1;\n};\n\nexports.SLN = function(cost, salvage, life) {\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  if (utils.anyIsError(cost, salvage, life)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return straight-line depreciation\n  return (cost - salvage) / life;\n};\n\nexports.SYD = function(cost, salvage, life, period) {\n  // Return error if any of the parameters is not a number\n  cost = utils.parseNumber(cost);\n  salvage = utils.parseNumber(salvage);\n  life = utils.parseNumber(life);\n  period = utils.parseNumber(period);\n  if (utils.anyIsError(cost, salvage, life, period)) {\n    return error.value;\n  }\n\n  // Return error if life equal to 0 (zero)\n  if (life === 0) {\n    return error.num;\n  }\n\n  // Return error if period is lower than 1 or greater than life\n  if (period < 1 || period > life) {\n    return error.num;\n  }\n\n  // Truncate period if it is not an integer\n  period = parseInt(period, 10);\n\n  // Return straight-line depreciation\n  return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\n};\n\nexports.TBILLEQ = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (365 * discount) / (360 - discount * dateTime.DAYS360(settlement, maturity, false));\n};\n\nexports.TBILLPRICE = function(settlement, maturity, discount) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  discount = utils.parseNumber(discount);\n  if (utils.anyIsError(settlement, maturity, discount)) {\n    return error.value;\n  }\n\n  // Return error if discount is lower than or equal to zero\n  if (discount <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return 100 * (1 - discount * dateTime.DAYS360(settlement, maturity, false) / 360);\n};\n\nexports.TBILLYIELD = function(settlement, maturity, price) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  price = utils.parseNumber(price);\n  if (utils.anyIsError(settlement, maturity, price)) {\n    return error.value;\n  }\n\n  // Return error if price is lower than or equal to zero\n  if (price <= 0) {\n    return error.num;\n  }\n\n  // Return error if settlement is greater than maturity\n  if (settlement > maturity) {\n    return error.num;\n  }\n\n  // Return error if maturity is more than one year after settlement\n  if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\n    return error.num;\n  }\n\n  // Return bond-equivalent yield\n  return (100 - price) * 360 / (price * dateTime.DAYS360(settlement, maturity, false));\n};\n\n// XW：待实现\nexports.VDB = function() {\n throw new Error('VDB is not implemented');\n};\n//XW：end\n\n\nexports.XIRR = function(values, dates, guess) {\n  // Credits: algorithm inspired by Apache OpenOffice\n\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  guess = utils.parseNumber(guess);\n  if (utils.anyIsError(values, dates, guess)) {\n    return error.value;\n  }\n\n  // Calculates the resulting amount\n  var irrResult = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = values[0];\n    for (var i = 1; i < values.length; i++) {\n      result += values[i] / Math.pow(r, dateTime.DAYS(dates[i], dates[0]) / 365);\n    }\n    return result;\n  };\n\n  // Calculates the first derivation\n  var irrResultDeriv = function(values, dates, rate) {\n    var r = rate + 1;\n    var result = 0;\n    for (var i = 1; i < values.length; i++) {\n      var frac = dateTime.DAYS(dates[i], dates[0]) / 365;\n      result -= frac * values[i] / Math.pow(r, frac + 1);\n    }\n    return result;\n  };\n\n  // Check that values contains at least one positive value and one negative value\n  var positive = false;\n  var negative = false;\n  for (var i = 0; i < values.length; i++) {\n    if (values[i] > 0) {\n      positive = true;\n    }\n    if (values[i] < 0) {\n      negative = true;\n    }\n  }\n\n  // Return error if values does not contain at least one positive value and one negative value\n  if (!positive || !negative) {\n    return error.num;\n  }\n\n  // Initialize guess and resultRate\n  guess = guess || 0.1;\n  var resultRate = guess;\n\n  // Set maximum epsilon for end of iteration\n  var epsMax = 1e-10;\n\n  // Implement Newton's method\n  var newRate, epsRate, resultValue;\n  var contLoop = true;\n  do {\n    resultValue = irrResult(values, dates, resultRate);\n    newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\n    epsRate = Math.abs(newRate - resultRate);\n    resultRate = newRate;\n    contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\n  } while (contLoop);\n\n  // Return internal rate of return\n  return resultRate;\n};\n\nexports.XNPV = function(rate, values, dates) {\n  rate = utils.parseNumber(rate);\n  values = utils.parseNumberArray(utils.flatten(values));\n  dates = utils.parseDateArray(utils.flatten(dates));\n  if (utils.anyIsError(rate, values, dates)) {\n    return error.value;\n  }\n\n  var result = 0;\n  for (var i = 0; i < values.length; i++) {\n    result += values[i] / Math.pow(1 + rate, dateTime.DAYS(dates[i], dates[0]) / 365);\n  }\n  return result;\n};\n\n// XW：待实现\nexports.YIELD = function (settlement, maturity, rate, pr, redemption, frequency, basis) {\n  settlement = utils.parseDate(settlement);\n  maturity = utils.parseDate(maturity);\n  if (utils.anyIsError(settlement, maturity)) {\n    return error.value;\n  }\n  if(rate <= 0){\n    return error.num;\n  }\n  // Return error if price is lower than or equal to zero\n  if (pr <= 0) {\n    return error.num;\n  }\n  if (redemption <= 0){\n    return error.num\n  }\n  // Return error if settlement is greater than maturity\n  if (settlement >= maturity  ) {\n    return error.num;\n  }\n  var A = Math.abs(dateTime.DAYS(settlement, maturity, false))\n\n};\n\n\n// TODO\nexports.YIELDDISC = function() {\n throw new Error('YIELDDISC is not implemented');\n};\n\n// TODO\nexports.YIELDMAT = function() {\n throw new Error('YIELDMAT is not implemented');\n};\n//XW：end","var error = require('./error');\nvar utils = require('./utils');\nfunction match_less_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] < lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] > indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\n\nfunction match_exactly_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    lookupValue = lookupValue.replace(/\\?/g, '.');\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1\n        && typeof matrix[idx][0] === 'string') {\n        if (matrix[idx][0].toLowerCase() === lookupValue.toLowerCase()) {\n          return idx + 1;\n        }\n      }\n    } else if (typeof matrix[idx] === 'string') {\n      if (matrix[idx].toLowerCase() === lookupValue.toLowerCase()) {\n        return idx + 1;\n      }\n    }\n\n  }\n  return error.na;\n}\n\nfunction match_exactly_non_string(matrix, lookupValue) {\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (Array.isArray(matrix[idx])) {\n      if (matrix[idx].length === 1) {\n        if (matrix[idx][0] === lookupValue) {\n          return idx + 1;\n        }\n      }\n    } else if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    }\n  }\n  //XW:统一错误变量\n  return error.na;\n  //XW：end\n}\n\nfunction match_greater_than_or_equal(matrix, lookupValue) {\n  var index;\n  var indexValue;\n  for (var idx = 0; idx < matrix.length; idx++) {\n    if (matrix[idx] === lookupValue) {\n      return idx + 1;\n    } else if (matrix[idx] > lookupValue) {\n      if (!indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      } else if (matrix[idx] < indexValue) {\n        index = idx + 1;\n        indexValue = matrix[idx];\n      }\n    }\n  }\n  if (!index) {\n    return error.na;\n  }\n  return index;\n}\nexports.MATCH = function (lookupValue, matrix, matchType) {\n  if (Array.isArray(matrix)\n    && matrix.length === 1\n    && Array.isArray(matrix[0])) {\n    matrix = matrix[0];\n  }\n  if (!lookupValue && !matrix) {\n    return error.na;\n  }\n  if (arguments.length === 2) {\n    matchType = 1;\n  }\n  if (!(matrix instanceof Array)) {\n    return error.na;\n  }\n  if (matchType === 0) {\n    if (typeof lookupValue === 'string') {\n      return match_exactly_string(matrix, lookupValue);\n    } else {\n      return match_exactly_non_string(matrix, lookupValue);\n    }\n  } else if (matchType === 1) {\n    return match_less_than_or_equal(matrix, lookupValue);\n  } else if (matchType === -1) {\n    var a = matrix[0][0]\n    for (var i=1;i<matrix.length;i++){\n      if (matrix[i][0] > a){\n        return error.na;\n      }\n    }\n    return match_greater_than_or_equal(matrix, lookupValue);\n  } else {\n    return error.na;\n  }\n}\n//XW: vlookup函数实现\nexports.VLOOKUP = function (key, matrix, return_index, cumulative) {\n  if(typeof cumulative == 'string' && !(cumulative == 'FALSE' || cumulative == 'TRUE')){\n    return error.value;\n  }\n  if (cumulative == 'FALSE') {\n    cumulative = false\n  }else{\n    cumulative = true\n  }\n  for (var i = 0; i < matrix.length; i++) {\n    if (matrix[i][0] == key) {\n      return matrix[i][return_index - 1];\n    }\n  }\n  return error.na;\n};\n//XW：end\n\n\n//XW:hlookup函数实现\nexports.HLOOKUP = function (needle, table, index, exactmatch) {\n  if (exactmatch == 'TRUE'){\n    exactmatch = true\n  }\n  if (exactmatch == 'FALSE'){\n    exactmatch = false\n  }\n  if (typeof table == 'string' && table.indexOf('{') >=0){\n    table = utils.strToMatrix(table)\n  }\n  if (typeof needle === \"undefined\" || table[0].indexOf(needle) < 0) {\n    return error.na;\n  }\n\n  index = index || 0;\n  let row = table[0];\n\n  for (let i = 0; i < row.length; i++) {\n    if (exactmatch && row[i] === needle || row[i].toString().toLowerCase().indexOf(needle.toString().toLowerCase()) !== -1) {\n      return index < table.length + 1 ? table[index - 1][i] : table[0][i];\n    }\n  }\n\n  return error.na;\n}\n//XW：end\n","var error = require('./error');\n//XW: 自定义函数\nexports.PQUERY = function () {\n  if (arguments.length !== 5) {\n    return error.error;\n  }\n\n  if (arguments[0].length !== arguments[1].length) {\n    return error.error;\n  }\n\n  if (arguments[1].length !== arguments[3].length) {\n    return error.error;\n  }\n\n  // 计算出绝对值\n  let absArr = [];\n  let o1 = arguments[4];\n  for (let i = 0; i < arguments[3].length; i++) {\n    arguments[3][i] = parseFloat(arguments[3][i]);\n    if (!isNaN(arguments[3][i])) {\n      absArr.push({\n        number: i,\n        value: Math.abs(arguments[3][i] - o1)\n      });\n    }\n  }\n  absArr = absArr.sort((obj1, obj2) => {\n    var val1 = obj1.value;\n    var val2 = obj2.value;\n    if (val1 < val2) {\n      return -1;\n    } else if (val1 > val2) {\n      return 1;\n    } else {\n      return 0;\n    }\n  });\n\n\n  let items = [];\n  let count = 1;\n  for (let i = 0; i < absArr.length; i++) {\n    let {number, value} = absArr[i];\n    let a1 = arguments[0][number][0];\n    let a2 = arguments[1][number][0];\n    let a4 = arguments[3][number];\n\n    if (a2 === arguments[2]) {\n      items.push({\n        number: count,\n        name: a1,\n        city: a2,\n        area: a4,\n        value: value\n      });\n      count = count + 1;\n    }\n  }\n\n  return '*悬浮查看*!' + JSON.stringify(items);\n};\n\nexports.HYPERLINK = function () {\n  console.log(arguments);\n  if (!arguments || !arguments[0] || !arguments[1]) {\n    return error.na;\n  }\n  let url = arguments[0];\n  if (url.substr(0, 7).toLowerCase() == \"http://\" || url.substr(0, 8).toLowerCase() == \"https://\") {\n    url = url;\n  } else {\n    url = \"http://\" + url;\n  }\n\n  let cell = {\n    \"text\": arguments[1],\n    \"url\": url\n  }\n  return \"*HYPERLINK*!\" + JSON.stringify(cell) + \" \";\n}\n\nfunction City(name, type, url) {\n  this.name = name;\n  this.type = type;\n  this.url = url;\n}\n\nfunction lianJiaUrl(lianjia) {\n  lianjia.push(new City(\"合肥\", 0, \"https://hf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"安庆\", 0, \"https://aq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"滁州\", 0, \"https://cz.fang.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"马鞍山\", 0, \"https://mas.lianjia.com/ditu\"));\n  lianjia.push(new City(\"北京\", 0, \"https://bj.lianjia.com/ditu\"));\n  lianjia.push(new City(\"重庆\", 0, \"https://cq.lianjia.com/ditu\"));\n  lianjia.push(new City(\"福州\", 0, \"https://fz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"泉州\", 0, \"https://quanzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"厦门\", 0, \"https://xm.lianjia.com/ditu\"));\n  lianjia.push(new City(\"漳州\", 0, \"https://zhangzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"东莞\", 0, \"https://dg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"佛山\", 0, \"https://fs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"广州\", 0, \"https://gz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"惠州\", 0, \"https://hui.lianjia.com/ditu\"));\n  lianjia.push(new City(\"江门\", 0, \"https://jiangmen.lianjia.com/ditu\"));\n  lianjia.push(new City(\"清远\", 0, \"https://qy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"深圳\", 0, \"https://sz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"珠海\", 0, \"https://zh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湛江\", 0, \"https://zhanjiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"中山\", 0, \"https://zs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"贵阳\", 0, \"https://gy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"北海\", 0, \"https://bh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"防城港\", 0, \"https://fcg.lianjia.com/ditu\"));\n  lianjia.push(new City(\"桂林\", 0, \"https://gl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"柳州\", 0, \"https://liuzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南宁\", 0, \"https://nn.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"兰州\", 0, \"https://lz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"鄂州\", 0, \"https://ez.lianjia.com/ditu\"));\n  lianjia.push(new City(\"黄石\", 0, \"https://huangshi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"武汉\", 0, \"https://wh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"襄阳\", 0, \"https://xy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宜昌\", 0, \"https://yichang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长沙\", 0, \"https://cs.lianjia.com/ditu\"));\n  lianjia.push(new City(\"常德\", 0, \"https://changde.lianjia.com/ditu\"));\n  lianjia.push(new City(\"岳阳\", 0, \"https://yy.lianjia.com/ditu\"));\n  lianjia.push(new City(\"株洲\", 0, \"https://zhuzhou.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保定\", 0, \"https://bd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"廊坊\", 0, \"https://lf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"秦皇岛\", 0, \"https://qhd.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"石家庄\", 0, \"https://sjz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"唐山\", 0, \"https://ts.lianjia.com/ditu\"));\n  lianjia.push(new City(\"张家口\", 0, \"https://zjk.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"保亭\", 0, \"https://bt.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"澄迈\", 0, \"https://cm.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"儋州\", 0, \"https://dz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"海口\", 0, \"https://hk.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临高\", 0, \"https://lg.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐东\", 0, \"https://ld.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"陵水\", 0, \"https://ls.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"琼海\", 0, \"https://qh.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"三亚\", 0, \"https://san.lianjia.com/ditu\"));\n  lianjia.push(new City(\"五指山\", 0, \"https://wzs.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"文昌\", 0, \"https://wc.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"万宁\", 0, \"https://wn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"开封\", 0, \"https://kf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"洛阳\", 0, \"https://luoyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"新乡\", 0, \"https://xinxiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"许昌\", 0, \"https://xc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"郑州\", 0, \"https://zz.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"哈尔滨\", 0, \"https://kf.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"常州\", 0, \"https://changzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淮安\", 0, \"https://ha.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆山\", 0, \"https://ks.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南京\", 0, \"https://nj.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"南通\", 0, \"https://nt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"苏州\", 0, \"https://su.lianjia.com/ditu\"));\n  lianjia.push(new City(\"无锡\", 0, \"https://wx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"徐州\", 0, \"https://xz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"盐城\", 0, \"https://yc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"镇江\", 0, \"https://zj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"长春\", 0, \"https://cc.lianjia.com/ditu/\"));\n  lianjia.push(new City(\"吉林\", 0, \"https://jl.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"赣州\", 0, \"https://ganzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"九江\", 0, \"https://jiujiang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"吉安\", 0, \"https://jian.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南昌\", 0, \"https://nc.lianjia.com/ditu\"));\n  lianjia.push(new City(\"上饶\", 0, \"https://sr.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大连\", 0, \"https://dl.lianjia.com/ditu\"));\n  lianjia.push(new City(\"丹东\", 0, \"https://dd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"沈阳\", 0, \"https://sy.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"呼和浩特\", 0, \"https://hhht.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"银川\", 0, \"https://yinchuan.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"上海\", 0, \"https://sh.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"成都\", 0, \"https://cd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"德阳\", 0, \"https://dy.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"达州\", 0, \"https://dazhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"乐山\", 0, \"https://leshan.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"凉山\", 0, \"https://liangshan.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绵阳\", 0, \"https://mianyang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"眉山\", 0, \"https://ms.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"南充\", 0, \"https://nanchong.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"济南\", 0, \"https://jn.lianjia.com/ditu\"));\n  lianjia.push(new City(\"临沂\", 0, \"https://linyi.lianjia.com/ditu\"));\n  lianjia.push(new City(\"青岛\", 0, \"https://qd.lianjia.com/ditu\"));\n  lianjia.push(new City(\"潍坊\", 0, \"https://wf.lianjia.com/ditu\"));\n  lianjia.push(new City(\"威海\", 0, \"https://weihai.lianjia.com/ditu\"));\n  lianjia.push(new City(\"烟台\", 0, \"https://yt.lianjia.com/ditu\"));\n  lianjia.push(new City(\"淄博\", 0, \"https://zb.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"宝鸡\", 0, \"https://baoji.lianjia.com/ditu\"));\n  lianjia.push(new City(\"汉中\", 0, \"https://hanzhong.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西安\", 0, \"https://xa.lianjia.com/ditu\"));\n  lianjia.push(new City(\"咸阳\", 0, \"https://xianyang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"晋中\", 0, \"https://jz.fang.lianjia.com/ditu\"));\n  lianjia.push(new City(\"太原\", 0, \"https://ty.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"天津\", 0, \"https://tj.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"大理\", 0, \"https://dali.lianjia.com/ditu\"));\n  lianjia.push(new City(\"昆明\", 0, \"https://km.lianjia.com/ditu\"));\n  lianjia.push(new City(\"西双版纳\", 0, \"https://xsbn.fang.lianjia.com/ditu\"));\n\n  lianjia.push(new City(\"杭州\", 0, \"https://hz.lianjia.com/ditu\"));\n  lianjia.push(new City(\"湖州\", 0, \"https://huzhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"嘉兴\", 0, \"https://jx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"金华\", 0, \"https://jh.lianjia.com/ditu\"));\n  lianjia.push(new City(\"宁波\", 0, \"https://nb.lianjia.com/ditu\"));\n  lianjia.push(new City(\"绍兴\", 0, \"https://sx.lianjia.com/ditu\"));\n  lianjia.push(new City(\"台州\", 0, \"https://taizhou.lianjia.com/ditu\"));\n  lianjia.push(new City(\"温州\", 0, \"https://wz.lianjia.comditu\"));\n}\n\nfunction woaiwojiaUrl(woaiwojia) {\n  woaiwojia.push(new City(\"北京\", 0, \"https://bj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"杭州\", 0, \"https://hz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"青岛\", 0, \"https://qd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"天津\", 0, \"https://tj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"太原\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"郑州\", 0, \"https://zz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"成都\", 0, \"https://cd.5i5j.com/map\"));\n  woaiwojia.push(new City(\"长沙\", 0, \"https://cs.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南昌\", 0, \"https://nc.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南京\", 0, \"https://nj.5i5j.com/map\"));\n  woaiwojia.push(new City(\"南宁\", 0, \"https://nn.5i5j.com/map\"));\n  woaiwojia.push(new City(\"上海\", 0, \"https://sh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"苏州\", 0, \"https://sz.5i5j.com/map\"));\n  woaiwojia.push(new City(\"武汉\", 0, \"https://wh.5i5j.com/map\"));\n  woaiwojia.push(new City(\"无锡\", 0, \"https://wx.5i5j.com/map\"));\n}\n\nfunction fangtianxiaUrl(fangtianxia) {\n  fangtianxia.push(new City(\"全国\", 0, \"https://www1.fang.com\"));\n}\n\nfunction find(name, arr, str = true) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i].name === name || (typeof name === 'string' && str === false)) {\n      let {url} = arr[i];\n      return url;\n    }\n  }\n\n  return \"城市未找到\";\n}\n\nlet lianjia = [];\nlianJiaUrl(lianjia);\nlet woaiwojia = [];\nwoaiwojiaUrl(woaiwojia);\nlet fangtianxia = [];\nfangtianxiaUrl(fangtianxia);","\"use strict\";\n\nconst int_2_col_str = require('./int_2_col_str.js');\nconst col_str_2_int = require('./col_str_2_int.js');\nconst RawValue = require('./RawValue.js');\nconst Range = require('./Range.js');\nconst RefValue = require('./RefValue.js');\n\nfunction raw_offset(cell_ref, rows, columns, height, width) {\n    height = (height || new RawValue(1)).calc();\n    width = (width || new RawValue(1)).calc();\n    if (cell_ref.args.length === 1 && cell_ref.args[0].name === 'RefValue') {\n        var ref_value = cell_ref.args[0];\n        var parsed_ref = ref_value.parseRef();\n        var col = col_str_2_int(parsed_ref.cell_name) + columns.calc();\n        var col_str = int_2_col_str(col);\n        var row = +parsed_ref.cell_name.replace(/^[A-Z]+/g, '') + rows.calc();\n        var cell_name = col_str + row;\n        if (height === 1 && width === 1) {\n            return new RefValue(cell_name, ref_value.formula).calc();\n        }\n        else {\n            var end_range_col = int_2_col_str(col + width - 1);\n            var end_range_row = row + height - 1;\n            var end_range = end_range_col + end_range_row;\n            var str_expression = parsed_ref.sheet_name + '!' + cell_name + ':' + end_range;\n            return new Range(str_expression, ref_value.formula).calc();\n        }\n    }\n}\n\nfunction iferror(cell_ref, onerrorvalue) {\n    try {\n        var value = cell_ref.calc();\n        if (typeof value === 'number' && (isNaN(value) || value === Infinity || value === -Infinity)) {\n            return onerrorvalue.calc();\n        }\n        return value;\n    } catch(e) {\n        return onerrorvalue.calc();\n    }\n}\n\nfunction _if(condition, _then, _else) {\n    if (condition.calc()) {\n        return _then.calc();\n    }\n    else {\n        return _else.calc();\n    }\n}\n\nfunction and() {\n    for (var i = 0; i < arguments.length; i++) {\n        if(!arguments[i].calc()) return false;\n    }\n    return true;\n}\n\nmodule.exports = {\n    'OFFSET': raw_offset,\n    'IFERROR': iferror,\n    'IF': _if,\n    'AND': and\n};\n","\"use strict\";\n\nconst RawValue = require('./RawValue.js');\nconst str_2_val = require('./str_2_val.js');\nconst find_all_cells_with_formulas = require('./find_all_cells_with_formulas.js');\n\nclass Calculator { // 这个应该是对重对外暴露的类。\n\n    constructor(workbook, exec_formula) {\n        this.workbook = workbook;\n        this.expressions = [];\n        this.exec_formula = exec_formula;\n        this.variables = {};\n        this.formulas = find_all_cells_with_formulas(workbook, exec_formula);\n        for (let i = this.formulas.length - 1; i >= 0; i--) {\n            let exp = exec_formula.build_expression(this.formulas[i]);\n            this.expressions.push(exp);\n        }\n        this.calcNames();\n    }\n\n    setVar(var_name, value) {\n        let variable = this.variables[var_name];\n        if (variable) {\n            variable.setValue(value);\n        } else {\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, var_name, value);\n            });\n        }\n    }\n\n    getVars() {\n        let vars = {};\n        for (let k in this.variables) {\n            vars[k] = this.variables[k].calc();\n        }\n        return vars;\n    }\n\n    calcNames() {\n        if (!this.workbook || !this.workbook.Workbook || !this.workbook.Workbook.Names) {\n            return;\n        }\n        this.workbook.Workbook.Names.forEach(item => {\n            let val = this.getRef(item.Ref);\n            this.variables[item.Name] = val;\n            this.expressions.forEach(exp => {\n                this.setVarOfExpression(exp, item.Name);\n            });\n        });\n    }\n\n    getRef(ref_name) {\n        if (!this.formulas.length) {\n            throw new Error(\"No formula found.\");\n        }\n        let first_formula = this.formulas[0];\n        let formula_ref = first_formula.formula_ref;\n        let formula = {\n            formula_ref: formula_ref,\n            wb: this.workbook,\n            exec_formula: this.exec_formula\n        };\n        return str_2_val(ref_name, formula);\n    }\n\n    setVarOfExpression(exp, var_name, value) {\n        for (let i = 0; i < exp.args.length; i++) {\n            let arg = exp.args[i];\n            if (arg === var_name) {\n                exp.args[i] = this.variables[var_name] || (this.variables[var_name] = new RawValue(value));\n            } else if (typeof arg === 'object' && (arg.name === 'Expression' || arg.name === 'UserFn')) {\n                this.setVarOfExpression(arg, var_name, value);\n            }\n        }\n    }\n\n    execute() {\n        this.expressions.forEach(exp => {\n            exp.update_cell_value();\n        });\n    }\n}\n\nmodule.exports = Calculator;\n","const checker = require('./formula_check.js');\nconst error = require('./formulajs/lib/error');\nclass CalcCell { // 对cell中的参数做转换，判断,多单元格处理等的类\n  constructor(formulas_i, rows) {\n    this.cell = formulas_i.cell\n    this.rows = rows\n    this.f = formulas_i.cell.f\n    this.name = formulas_i.name\n    this.sheet = formulas_i.sheet\n  }\n\n  //检测是否合法\n  check_valid() {\n    var text = this.f\n    //==A1报错\n    if (text[1] === '='){\n      return error.name\n    }\n    var params = text.match('=[a-z|A-Z]{2,100}')\n    if (params != null && this.f.indexOf('(') <0 && this.f.indexOf(')')<0){\n      return error.name\n    }\n    // 处理\"\" 中\"\"的转义\n    if (this.f.indexOf('\"\"') >= 1 && this.f.indexOf('(') < 0 && this.f.indexOf(')') < 0) {\n      return this.f.slice(2, this.f.length - 1).replace('\"\"', '\"')\n    }\n    return true\n  }\n\n  //{}用''包起来\n  trans_params(fml) {\n    var reg = new RegExp('\\{(.*?)\\}', 'g')\n    var arg = fml.match(reg)\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i]\n        var rep = \"'\" + param + \"'\"\n        fml = fml.replace(param, rep)\n      }\n    }\n    return fml\n  }\n\n  //参数转换\n  trans_formula() {\n    var fml = this.f\n    //去除公式开头结尾的空格\n    fml = checker.strim(fml)\n    //公式参数转换\n    fml = checker.trans_formula(fml)\n    if (fml.indexOf('{') >= 0 && fml.indexOf('}') >= 0 && fml.indexOf(\"'{\") < 0) {// XW: 大括号参数判断\n      fml = this.trans_params(fml)\n    }\n    return fml\n  }\n\n  //将公式还原成原来的样子\n  recover_formula() {\n    return checker.strim(this.f)\n  }\n}\n\nmodule.exports = CalcCell;","var exp = require(\"../core/alphabet\");\nvar error = require('./formulajs/lib/error');\n\n\nfunction isEqual(v1, v2) {\n  v1 = v1 + \"\";\n  v2 = v2 + \"\";\n  v1 = v1.toUpperCase();\n  v2 = v2.toUpperCase();\n  if (v1 === v2) {\n    return true;\n  }\n  return false;\n}\n\nfunction isHave(param) {\n  if (typeof param === \"undefined\") {\n    return false;\n  }\n  if (param === null) {\n    return false;\n  }\n  return true;\n}\nclass CalcWorkBook { // 对workbook处理的类\n  constructor(rows, tileArr) {\n    this.rows = rows\n    this.tileArr = tileArr\n  }\n\n  // 变动数据传入workbook\n  get_workbook(workbook){\n    let {data} = this.rows;\n    let name = data['name']\n    var need_calc_cells = this.tileArr.findAllNeedCalcCell()\n    for (var i=0;i<need_calc_cells.length;i++){\n      var cell_name = need_calc_cells[i]\n      var zb = exp.expr2xy(cell_name)\n      var cell = this.rows.getCell(zb[1], zb[0])\n      if(isHave(cell)){\n        workbook.Sheets[name][cell_name] = {v: cell.text, f: cell.formulas, multivalueRefsCell: cell.multivalueRefsCell, source_v: cell.source_v}\n      }\n    }\n    return workbook\n  }\n\n  //workbook填入rows\n  calcDoneToSetCells(workbook, rows) {\n    let {data} = rows;\n    let name = data['name']\n    var sheet = workbook.Sheets[name]\n    Object.keys(sheet).forEach(i => {\n      let arg = exp.expr2xy(i);\n      if (isHave(sheet[i]) && isHave(sheet[i].v) && isHave(sheet[i].f)) {\n        var cell = rows.getCell(arg[1], arg[0])\n        if (!isHave(cell)){\n          cell = {}\n        }\n        cell.text = sheet[i].v\n        cell.formulas = sheet[i].f\n        cell.multivalueRefsCell = sheet[i].multivalueRefsCell\n        if (isHave(sheet[i].source_v)){\n          cell.source_v = sheet[i].source_v\n        }\n        rows.setCell(arg[1], arg[0], cell);\n      }\n    });\n    rows.workbook = workbook\n  }\n\n  // 判断是否是多值函数的单元格\n  is_muti_cell(formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    if (multivalueRefsCell !== null) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    }\n    return isHave(multivalueRefsCell) ? true : false\n  }\n\n  //一维数组\n  process_arr(){\n\n  }\n\n\n  //二维数组\n  process_matrix(formulas_i, multivalueRefsCell){\n    let enter = true\n    var cell_v = formulas_i.cell.v\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    let cell = \"\", expr = 0;\n    var wb = formulas_i.sheet\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        var v = cell_v[i][j]\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": v,\n            \"f\": formulas_i.cell.f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          var source = this.rows.getCell( cell_y + j,  cell_x + i);\n          if (!isHave(source) || !isHave(source.text) || (isHave(source.text) && (isEqual(source.text, v) || source.text === \"\"))) {\n            wb[c] = {\n              \"v\": cell_v[i][j],\n              \"f\": cell_v[i][j],\n              'multivalueRefsCell': multivalueRefsCell\n            }\n          } else {\n            wb[c] = {\n              \"v\": source.v,\n              \"f\": source.f,\n              'multivalueRefsCell': multivalueRefsCell\n            }\n            enter = false;\n            cell = source;\n            expr = c;\n          }\n        }\n      }\n    }\n    if(!enter) {\n      return this.clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr)\n    }else{\n      return wb\n    }\n  }\n\n\n  //清除二维数组标记\n  clean_matrix(wb, cell_v, cell, multivalueRefsCell, expr){\n    var cell_zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = cell_zb[0]\n    var cell_y = cell_zb[1]\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": error.ref,\n            \"f\": wb[c].f,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else if (expr === c) {\n          wb[c] = {\n            \"v\": cell.text,\n            \"f\": cell.formulas,\n            'multivalueRefsCell': multivalueRefsCell\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n  //如果多值原始单元格发生变动，清除所有该多值函数生成的单元格中的标记\n  clean_all_flag(formulas_i, multivalueRefsCell){\n    var wb = formulas_i.sheet\n    var zb = exp.expr2xy(multivalueRefsCell)\n    var cell_x = zb[0]\n    var cell_y = zb[1]\n    var cell = this.rows.getCell(zb[1], zb[0])\n    var cell_v = cell.source_v\n    let len = cell_v.length\n    for (var i = 0; i < len; i++) {\n      for (var j = 0; j < cell_v[i].length ; j++) {\n        var c = exp.xy2expr(cell_x + i, cell_y + j)\n        if (i === 0 && j === 0) {\n          wb[c] = {\n            \"v\": formulas_i.cell.v,\n            \"f\": formulas_i.cell.f,\n            \"source_v\": \"\"\n          }\n        } else if (this.rows.getCell(cell_y + j, cell_x + i).text !== cell_v[i][j]) {\n          wb[c] = {\n            \"v\": this.rows.getCell(cell_y + j, cell_x + i).text,\n            \"f\": this.rows.getCell(cell_y + j, cell_x + i).formulas,\n          }\n        } else {\n          wb[c] = {\n            \"v\": \"\",\n            \"f\": \"\"\n          }\n        }\n      }\n    }\n    return wb\n  }\n\n\n\n  //处理多值函数单元格\n  deal_muti_cell(workbook, formulas_i) {\n    var multivalueRefsCell = formulas_i.cell\n    let {data} = this.rows;\n    let name = data['name']\n    if (isHave(multivalueRefsCell) && isHave(multivalueRefsCell.multivalueRefsCell)) {\n      multivalueRefsCell = multivalueRefsCell.multivalueRefsCell\n    } else {\n      multivalueRefsCell = formulas_i.name;\n    }\n    var cell_v = formulas_i.cell.v\n    if (formulas_i.name !== multivalueRefsCell){\n      if (cell_v instanceof Array){\n        workbook.Sheets[name][formulas_i.name].v = error.ref\n        workbook.Sheets[name][formulas_i.name].source_v = cell_v\n      }else if(isHave(cell_v)){\n        workbook.Sheets[name][formulas_i.name].v = cell_v\n      }\n    }else {\n      if(!(cell_v instanceof Array)) {\n        workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n      }else{\n        var zb = exp.expr2xy(multivalueRefsCell)\n        if (isHave(this.rows.getCell(zb[1], zb[0]).source_v) && this.rows.getCell(zb[1], zb[0]).source_v !== cell_v){\n          workbook.Sheets[name] = this.clean_all_flag(formulas_i, multivalueRefsCell)\n        }\n        var len = cell_v.length\n        if (len === 1){\n          workbook.Sheets[name] = this.process_arr(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }else{\n          workbook.Sheets[name] = this.process_matrix(formulas_i, multivalueRefsCell)\n          workbook.Sheets[name][formulas_i.name].source_v = cell_v\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = CalcWorkBook;","var exp = require(\"../core/alphabet\");\nconst helper = require(\"../core/helper\");\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};\n\n\nexports.Rows2Workbook = function (rows) {\n  var cells = rows._\n  var workbook = {\n    Sheets:{}\n  };\n  let {data} = rows;\n  let name = data['name']\n  workbook.Sheets[name] = {}\n  Object.keys(cells).forEach(ri => {\n    Object.keys(cells[ri].cells).forEach(ci => {\n      var cell = rows.getCell(ri, ci)\n      var cell_name = exp.xy2expr(ci, ri)\n      if(helper.isHave(cell)) {\n        workbook.Sheets[name][cell_name] = {\n          v: cell.text,\n          f: cell.formulas,\n          multivalueRefsCell: cell.multivalueRefsCell,\n          source_v: cell.source_v\n        }\n      }\n    });\n  });\n  return workbook\n};","\"use strict\";\n\nmodule.exports = function int_2_col_str(n) {\n    var dividend = n + 1;\n    var columnName = '';\n    var modulo;\n    var guard = 10;\n    while (dividend > 0 && guard--) {\n        modulo = (dividend - 1) % 26;\n        columnName = String.fromCharCode(modulo + 65) + columnName;\n        dividend = (dividend - modulo - 1) / 26;\n    }\n    return columnName;\n};","var map = {\n\t\"./af\": 40,\n\t\"./af.js\": 40,\n\t\"./ar\": 41,\n\t\"./ar-dz\": 42,\n\t\"./ar-dz.js\": 42,\n\t\"./ar-kw\": 43,\n\t\"./ar-kw.js\": 43,\n\t\"./ar-ly\": 44,\n\t\"./ar-ly.js\": 44,\n\t\"./ar-ma\": 45,\n\t\"./ar-ma.js\": 45,\n\t\"./ar-sa\": 46,\n\t\"./ar-sa.js\": 46,\n\t\"./ar-tn\": 47,\n\t\"./ar-tn.js\": 47,\n\t\"./ar.js\": 41,\n\t\"./az\": 48,\n\t\"./az.js\": 48,\n\t\"./be\": 49,\n\t\"./be.js\": 49,\n\t\"./bg\": 50,\n\t\"./bg.js\": 50,\n\t\"./bm\": 51,\n\t\"./bm.js\": 51,\n\t\"./bn\": 52,\n\t\"./bn.js\": 52,\n\t\"./bo\": 53,\n\t\"./bo.js\": 53,\n\t\"./br\": 54,\n\t\"./br.js\": 54,\n\t\"./bs\": 55,\n\t\"./bs.js\": 55,\n\t\"./ca\": 56,\n\t\"./ca.js\": 56,\n\t\"./cs\": 57,\n\t\"./cs.js\": 57,\n\t\"./cv\": 58,\n\t\"./cv.js\": 58,\n\t\"./cy\": 59,\n\t\"./cy.js\": 59,\n\t\"./da\": 60,\n\t\"./da.js\": 60,\n\t\"./de\": 61,\n\t\"./de-at\": 62,\n\t\"./de-at.js\": 62,\n\t\"./de-ch\": 63,\n\t\"./de-ch.js\": 63,\n\t\"./de.js\": 61,\n\t\"./dv\": 64,\n\t\"./dv.js\": 64,\n\t\"./el\": 65,\n\t\"./el.js\": 65,\n\t\"./en-SG\": 66,\n\t\"./en-SG.js\": 66,\n\t\"./en-au\": 67,\n\t\"./en-au.js\": 67,\n\t\"./en-ca\": 68,\n\t\"./en-ca.js\": 68,\n\t\"./en-gb\": 69,\n\t\"./en-gb.js\": 69,\n\t\"./en-ie\": 70,\n\t\"./en-ie.js\": 70,\n\t\"./en-il\": 71,\n\t\"./en-il.js\": 71,\n\t\"./en-nz\": 72,\n\t\"./en-nz.js\": 72,\n\t\"./eo\": 73,\n\t\"./eo.js\": 73,\n\t\"./es\": 74,\n\t\"./es-do\": 75,\n\t\"./es-do.js\": 75,\n\t\"./es-us\": 76,\n\t\"./es-us.js\": 76,\n\t\"./es.js\": 74,\n\t\"./et\": 77,\n\t\"./et.js\": 77,\n\t\"./eu\": 78,\n\t\"./eu.js\": 78,\n\t\"./fa\": 79,\n\t\"./fa.js\": 79,\n\t\"./fi\": 80,\n\t\"./fi.js\": 80,\n\t\"./fo\": 81,\n\t\"./fo.js\": 81,\n\t\"./fr\": 82,\n\t\"./fr-ca\": 83,\n\t\"./fr-ca.js\": 83,\n\t\"./fr-ch\": 84,\n\t\"./fr-ch.js\": 84,\n\t\"./fr.js\": 82,\n\t\"./fy\": 85,\n\t\"./fy.js\": 85,\n\t\"./ga\": 86,\n\t\"./ga.js\": 86,\n\t\"./gd\": 87,\n\t\"./gd.js\": 87,\n\t\"./gl\": 88,\n\t\"./gl.js\": 88,\n\t\"./gom-latn\": 89,\n\t\"./gom-latn.js\": 89,\n\t\"./gu\": 90,\n\t\"./gu.js\": 90,\n\t\"./he\": 91,\n\t\"./he.js\": 91,\n\t\"./hi\": 92,\n\t\"./hi.js\": 92,\n\t\"./hr\": 93,\n\t\"./hr.js\": 93,\n\t\"./hu\": 94,\n\t\"./hu.js\": 94,\n\t\"./hy-am\": 95,\n\t\"./hy-am.js\": 95,\n\t\"./id\": 96,\n\t\"./id.js\": 96,\n\t\"./is\": 97,\n\t\"./is.js\": 97,\n\t\"./it\": 98,\n\t\"./it-ch\": 99,\n\t\"./it-ch.js\": 99,\n\t\"./it.js\": 98,\n\t\"./ja\": 100,\n\t\"./ja.js\": 100,\n\t\"./jv\": 101,\n\t\"./jv.js\": 101,\n\t\"./ka\": 102,\n\t\"./ka.js\": 102,\n\t\"./kk\": 103,\n\t\"./kk.js\": 103,\n\t\"./km\": 104,\n\t\"./km.js\": 104,\n\t\"./kn\": 105,\n\t\"./kn.js\": 105,\n\t\"./ko\": 106,\n\t\"./ko.js\": 106,\n\t\"./ku\": 107,\n\t\"./ku.js\": 107,\n\t\"./ky\": 108,\n\t\"./ky.js\": 108,\n\t\"./lb\": 109,\n\t\"./lb.js\": 109,\n\t\"./lo\": 110,\n\t\"./lo.js\": 110,\n\t\"./lt\": 111,\n\t\"./lt.js\": 111,\n\t\"./lv\": 112,\n\t\"./lv.js\": 112,\n\t\"./me\": 113,\n\t\"./me.js\": 113,\n\t\"./mi\": 114,\n\t\"./mi.js\": 114,\n\t\"./mk\": 115,\n\t\"./mk.js\": 115,\n\t\"./ml\": 116,\n\t\"./ml.js\": 116,\n\t\"./mn\": 117,\n\t\"./mn.js\": 117,\n\t\"./mr\": 118,\n\t\"./mr.js\": 118,\n\t\"./ms\": 119,\n\t\"./ms-my\": 120,\n\t\"./ms-my.js\": 120,\n\t\"./ms.js\": 119,\n\t\"./mt\": 121,\n\t\"./mt.js\": 121,\n\t\"./my\": 122,\n\t\"./my.js\": 122,\n\t\"./nb\": 123,\n\t\"./nb.js\": 123,\n\t\"./ne\": 124,\n\t\"./ne.js\": 124,\n\t\"./nl\": 125,\n\t\"./nl-be\": 126,\n\t\"./nl-be.js\": 126,\n\t\"./nl.js\": 125,\n\t\"./nn\": 127,\n\t\"./nn.js\": 127,\n\t\"./pa-in\": 128,\n\t\"./pa-in.js\": 128,\n\t\"./pl\": 129,\n\t\"./pl.js\": 129,\n\t\"./pt\": 130,\n\t\"./pt-br\": 131,\n\t\"./pt-br.js\": 131,\n\t\"./pt.js\": 130,\n\t\"./ro\": 132,\n\t\"./ro.js\": 132,\n\t\"./ru\": 133,\n\t\"./ru.js\": 133,\n\t\"./sd\": 134,\n\t\"./sd.js\": 134,\n\t\"./se\": 135,\n\t\"./se.js\": 135,\n\t\"./si\": 136,\n\t\"./si.js\": 136,\n\t\"./sk\": 137,\n\t\"./sk.js\": 137,\n\t\"./sl\": 138,\n\t\"./sl.js\": 138,\n\t\"./sq\": 139,\n\t\"./sq.js\": 139,\n\t\"./sr\": 140,\n\t\"./sr-cyrl\": 141,\n\t\"./sr-cyrl.js\": 141,\n\t\"./sr.js\": 140,\n\t\"./ss\": 142,\n\t\"./ss.js\": 142,\n\t\"./sv\": 143,\n\t\"./sv.js\": 143,\n\t\"./sw\": 144,\n\t\"./sw.js\": 144,\n\t\"./ta\": 145,\n\t\"./ta.js\": 145,\n\t\"./te\": 146,\n\t\"./te.js\": 146,\n\t\"./tet\": 147,\n\t\"./tet.js\": 147,\n\t\"./tg\": 148,\n\t\"./tg.js\": 148,\n\t\"./th\": 149,\n\t\"./th.js\": 149,\n\t\"./tl-ph\": 150,\n\t\"./tl-ph.js\": 150,\n\t\"./tlh\": 151,\n\t\"./tlh.js\": 151,\n\t\"./tr\": 152,\n\t\"./tr.js\": 152,\n\t\"./tzl\": 153,\n\t\"./tzl.js\": 153,\n\t\"./tzm\": 154,\n\t\"./tzm-latn\": 155,\n\t\"./tzm-latn.js\": 155,\n\t\"./tzm.js\": 154,\n\t\"./ug-cn\": 156,\n\t\"./ug-cn.js\": 156,\n\t\"./uk\": 157,\n\t\"./uk.js\": 157,\n\t\"./ur\": 158,\n\t\"./ur.js\": 158,\n\t\"./uz\": 159,\n\t\"./uz-latn\": 160,\n\t\"./uz-latn.js\": 160,\n\t\"./uz.js\": 159,\n\t\"./vi\": 161,\n\t\"./vi.js\": 161,\n\t\"./x-pseudo\": 162,\n\t\"./x-pseudo.js\": 162,\n\t\"./yo\": 163,\n\t\"./yo.js\": 163,\n\t\"./zh-cn\": 164,\n\t\"./zh-cn.js\": 164,\n\t\"./zh-hk\": 165,\n\t\"./zh-hk.js\": 165,\n\t\"./zh-tw\": 166,\n\t\"./zh-tw.js\": 166\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 194;","\"use strict\";\n\nmodule.exports = function col_str_2_int(col_str) {\n    var r = 0;\n    var colstr = col_str.replace(/[0-9]+$/, '');\n    for (var i = colstr.length; i--;) {\n        r += Math.pow(26, colstr.length - i - 1) * (colstr.charCodeAt(i) - 64);\n    }\n    return r - 1;\n};","/* global document */\n\n/* global window */\nclass Element {\n    constructor(tag, className = '') {\n        if (typeof tag === 'string') {\n            this.el = document.createElement(tag);\n            this.el.className = className;\n        } else {\n            this.el = tag;\n        }\n        this.data = {};\n    }\n\n    data(key, value) {\n        if (value !== undefined) {\n            this.data[key] = value;\n            return this;\n        }\n        return this.data[key];\n    }\n\n    on(eventNames, handler) {\n        const [fen, ...oen] = eventNames.split('.');\n        let eventName = fen;\n        if (eventName === 'mousewheel' && /Firefox/i.test(window.navigator.userAgent)) {\n            eventName = 'DOMMouseScroll';\n        }\n        this.el.addEventListener(eventName, (evt) => {\n            handler(evt);\n            for (let i = 0; i < oen.length; i += 1) {\n                const k = oen[i];\n                if (k === 'left' && evt.button !== 0) {\n                    return;\n                }\n                if (k === 'right' && evt.button !== 2) {\n                    return;\n                }\n                if (k === 'stop') {\n                    evt.stopPropagation();\n                }\n            }\n        });\n        return this;\n    }\n\n    offset(value) {\n        if (value !== undefined) {\n            Object.keys(value).forEach((k) => {\n                this.css(k, `${value[k]}px`);\n            });\n            return this;\n        }\n        const {\n            offsetTop, offsetLeft, offsetHeight, offsetWidth,\n        } = this.el;\n        return {\n            top: offsetTop,\n            left: offsetLeft,\n            height: offsetHeight,\n            width: offsetWidth,\n        };\n    }\n\n    scroll(v) {\n        const {el} = this;\n        if (v !== undefined) {\n            if (v.left !== undefined) {\n                el.scrollLeft = v.left;\n            }\n            if (v.top !== undefined) {\n                el.scrollTop = v.top;\n            }\n        }\n\n        return {left: el.scrollLeft, top: el.scrollTop};\n    }\n\n    box() {\n        return this.el.getBoundingClientRect();\n    }\n\n    parent() {\n        return new Element(this.el.parentNode);\n    }\n\n    children(...eles) {\n        if (arguments.length === 0) {\n            return this.el.childNodes;\n        }\n        eles.forEach(ele => this.child(ele));\n        return this;\n    }\n\n    /*\n    first() {\n      return this.el.firstChild;\n    }\n\n    last() {\n      return this.el.lastChild;\n    }\n\n    remove(ele) {\n      return this.el.removeChild(ele);\n    }\n\n    prepend(ele) {\n      const { el } = this;\n      if (el.children.length > 0) {\n        el.insertBefore(ele, el.firstChild);\n      } else {\n        el.appendChild(ele);\n      }\n      return this;\n    }\n\n    prev() {\n      return this.el.previousSibling;\n    }\n\n    next() {\n      return this.el.nextSibling;\n    }\n    */\n\n    child(arg) {\n        let ele = arg;\n        if (typeof arg === 'string') {\n            ele = document.createTextNode(arg);\n        } else if (arg instanceof Element) {\n            ele = arg.el;\n        }\n        this.el.appendChild(ele);\n\n        return this;\n    }\n\n    contains(ele) {\n        return this.el.contains(ele);\n    }\n\n    className(v) {\n        if (v !== undefined) {\n            this.el.className = v;\n            return this;\n        }\n        return this.el.className;\n    }\n\n    addClass(name) {\n        this.el.classList.add(name);\n        return this;\n    }\n\n    hasClass(name) {\n        return this.el.classList.contains(name);\n    }\n\n    removeClass(name) {\n        this.el.classList.remove(name);\n        return this;\n    }\n\n    toggle(cls = 'active') {\n        return this.toggleClass(cls);\n    }\n\n    toggleClass(name) {\n        return this.el.classList.toggle(name);\n    }\n\n    active(flag = true, cls = 'active') {\n        if (flag) this.addClass(cls);\n        else this.removeClass(cls);\n        return this;\n    }\n\n    checked(flag = true) {\n        this.active(flag, 'checked');\n        return this;\n    }\n\n    disabled(flag = true) {\n        if (flag) this.addClass('disabled');\n        else this.removeClass('disabled');\n        return this;\n    }\n\n    // key, value\n    // key\n    // {k, v}...\n    attr(key, value) {\n        if (value !== undefined) {\n            this.el.setAttribute(key, value);\n        } else {\n            if (typeof key === 'string') {\n                return this.el.getAttribute(key);\n            }\n            Object.keys(key).forEach((k) => {\n                this.el.setAttribute(k, key[k]);\n            });\n        }\n        return this;\n    }\n\n    removeAttr(key) {\n        this.el.removeAttribute(key);\n        return this;\n    }\n\n    html(content) {\n        if (content !== undefined) {\n            this.el.innerHTML = content;\n            return this;\n        }\n        return this.el.innerHTML;\n    }\n\n    val(v) {\n        if (v !== undefined) {\n            this.el.value = v;\n            return this;\n        }\n        return this.el.value;\n    }\n\n    cssRemoveKeys(...keys) {\n        keys.forEach(k => this.el.style.removeProperty(k));\n        return this;\n    }\n\n    // css( propertyName )\n    // css( propertyName, value )\n    // css( properties )\n    css(name, value) {\n        if (value === undefined && typeof name !== 'string') {\n            Object.keys(name).forEach((k) => {\n                this.el.style[k] = name[k];\n            });\n            return this;\n        }\n        if (value !== undefined) {\n            this.el.style[name] = value;\n            return this;\n        }\n        return this.el.style[name];\n    }\n\n    removeEl() {\n        if (!this.el || !this.el.parentNode) {\n            return;\n        }\n        this.el.parentNode.removeChild(this.el);\n    }\n\n    computedStyle() {\n        return window.getComputedStyle(this.el, null);\n    }\n\n    isShow() {\n        if(this.el.style['display'] === 'block') {\n            return true;\n        }\n        return false;\n    }\n\n    show(key = 'display', text = 'block') {\n        this.css(key, text);\n        return this;\n    }\n\n    hide(key = 'display', value = 'none') {\n        this.css(key, value);\n        return this;\n    }\n}\n\nconst h = (tag, className = '') => new Element(tag, className);\n\nexport {\n    Element,\n    h,\n};\n","/* global window */\nimport en from './en';\n\nlet $lang = 'en';\nconst $messages = {\n    en,\n};\n\nfunction translate(key, messages) {\n    if (messages && messages[$lang]) {\n        let message = messages[$lang];\n        const keys = key.split('.');\n        for (let i = 0; i < keys.length; i += 1) {\n            const property = keys[i];\n            const value = message[property];\n            if (i === keys.length - 1) return value;\n            if (!value) return undefined;\n            message = value;\n        }\n    }\n    return undefined;\n}\n\nfunction t(key) {\n    let v = translate(key, $messages);\n    if (!v && window && window.x && window.x.spreadsheet && window.x.spreadsheet.$messages) {\n        v = translate(key, window.x.spreadsheet.$messages);\n    }\n    return v || '';\n}\n\nfunction tf(key) {\n    return () => t(key);\n}\n\nfunction locale(lang, message) {\n    $lang = lang;\n    if (message) {\n        $messages[lang] = message;\n    }\n}\n\nexport default {\n    t,\n};\n\nexport {\n    locale,\n    t,\n    tf,\n};\n","export default {\n    toolbar: {\n        undo: 'Undo',\n        redo: 'Redo',\n        paintformat: 'Paint format',\n        clearformat: 'Clear format',\n        format: 'Format',\n        font: 'Font',\n        fontSize: 'Font size',\n        fontBold: 'Font bold',\n        fontItalic: 'Font italic',\n        underline: 'Underline',\n        strike: 'Strike',\n        textColor: 'Text color',\n        fillColor: 'Fill color',\n        border: 'Borders',\n        merge: 'Merge cells',\n        align: 'Horizontal align',\n        valign: 'Vertical align',\n        textwrap: 'Text wrapping',\n        freeze: 'Freeze cell',\n        add: 'display equation',\n        autofilter: 'Filter',\n        formula: 'Functions',\n        more: 'More',\n        flexible: 'Flexible',\n        throwFormula: 'Throw formulas',\n        comeBack: 'come back',\n    },\n    contextmenu: {\n        copy: 'Copy',\n        cut: 'Cut',\n        paste: 'Paste',\n        pasteValue: 'Paste values only',\n        pasteFormat: 'Paste format only',\n        insertRow: 'Insert row',\n        insertColumn: 'Insert column',\n        deleteRow: 'Delete row',\n        deleteColumn: 'Delete column',\n        deleteCell: 'Delete cell',\n        deleteCellText: 'Delete cell text',\n        validation: 'Data validations',\n        recover: 'recover',\n    },\n    format: {\n        normal: 'Normal',\n        text: 'Plain Text',\n        number: 'Number',\n        percent: 'Percent',\n        rmb: 'RMB',\n        usd: 'USD',\n        date: 'Date',\n        time: 'Time',\n        datetime: 'Date time',\n        duration: 'Duration',\n    },\n    date_formula: {\n        sum: 'Sum',\n        average: 'Average',\n        max: 'Max',\n        min: 'Min',\n        concat: 'Concat',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: 'it must be required',\n        notMatch: 'it not match its validation rule',\n        between: 'it is between {} and {}',\n        notBetween: 'it is not between {} and {}',\n        notIn: 'it is not in list',\n        equal: 'it equal to {}',\n        notEqual: 'it not equal to {}',\n        lessThan: 'it less than {}',\n        lessThanEqual: 'it less than or equal to {}',\n        greaterThan: 'it greater than {}',\n        greaterThanEqual: 'it greater than or equal to {}',\n    },\n    error: {\n        pasteForMergedCell: 'Unable to do this for merged cells',\n    },\n    calendar: {\n        weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n        months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    },\n    button: {\n        cancel: 'Cancel',\n        remove: 'Remove',\n        save: 'Save',\n        ok: 'OK',\n    },\n    sort: {\n        desc: 'Sort Z -> A',\n        asc: 'Sort A -> Z',\n    },\n    filter: {\n        empty: 'empty',\n    },\n    dataValidation: {\n        mode: 'Mode',\n        range: 'Cell Range',\n        criteria: 'Criteria',\n        modeType: {\n            cell: 'Cell',\n            column: 'Colun',\n            row: 'Row',\n        },\n        type: {\n            list: 'List',\n            number: 'Number',\n            date: 'Date',\n            phone: 'Phone',\n            email: 'Email',\n        },\n        operator: {\n            be: 'between',\n            nbe: 'not betwwen',\n            lt: 'less than',\n            lte: 'less than or equal to',\n            gt: 'greater than',\n            gte: 'greater than or equal to',\n            eq: 'equal to',\n            neq: 'not equal to',\n        },\n    },\n};\n","/**\n formulas:\n key\n title\n render\n */\nimport {tf} from '../locale/locale';\nimport XLSX_CALC from \"../calc\"\nvar formulajs = require('../calc/formulajs/index'); // jobs: todo: 这里为何又多出3个函数？似乎应该统一放到formulajs中解决。\nconst baseFormulas = [\n    {\n        key: 'MD.WLAND',\n        title: tf('formula.wland'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.WFR',\n        title: tf('formula.wfr'),\n        render: ary => ary.join(''),\n    },\n    {\n        key: 'MD.RTD',\n        title: tf('formula.rtd'),\n        render: ary => ary.join(''),\n    },\n];\n\nlet formulas = deepCopy(baseFormulas);\n\nconst formulaCalc = () => {\n    XLSX_CALC.import_functions(formulajs);\n    let xlsx_Fx = XLSX_CALC.xlsx_Fx;\n    formulas = deepCopy(baseFormulas);\n    Object.keys(xlsx_Fx).forEach(i => {\n        let args = {\n            key: i,\n            title: i,\n            render: xlsx_Fx[i]\n        };\n        formulas.push(args);\n    });\n\n\n    return XLSX_CALC;\n};\n\nfunction deepCopy(obj) {\n    var result = Array.isArray(obj) ? [] : {};\n    for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            if (typeof obj[key] === 'object' && obj[key] !== null) {\n                result[key] = deepCopy(obj[key]);\n            } else {\n                result[key] = obj[key];\n            }\n        }\n    }\n    return result;\n}\n\n// const formulas = (formulaAry = []) => {\n//   const formulaMap = {};\n//   baseFormulas.concat(formulaAry).forEach((f) => {\n//     formulaMap[f.key] = f;\n//   });\n//   return formulaMap;\n// };\nconst formulam = {};\nbaseFormulas.forEach((f) => {\n    formulam[f.key] = f;\n});\n\nexport default {};\n\nexport {\n    formulam,\n    formulas,\n    baseFormulas,\n    formulaCalc,\n};\n","import { CellRange } from './cell_range';\n\nexport default class Selector {\n  constructor() {\n    this.range = new CellRange(0, 0, 0, 0);\n    this.ri = 0;\n    this.ci = 0;\n  }\n\n  multiple() {\n    return this.range.multiple();\n  }\n\n  setIndexes(ri, ci) {\n    this.ri = ri;\n    this.ci = ci;\n  }\n\n  size() {\n    return this.range.size();\n  }\n}\n","export default class Scroll {\n  constructor() {\n    this.x = 0; // left\n    this.y = 0; // top\n    this.ri = 0; // cell row-index\n    this.ci = 0; // cell col-index\n  }\n}\n","export default class Clipboard {\n  constructor() {\n    this.range = null; // CellRange\n    this.state = 'clear';\n  }\n\n  copy(cellRange) {\n    this.range = cellRange;\n    this.state = 'copy';\n    return this;\n  }\n\n  cut(cellRange) {\n    this.range = cellRange;\n    this.state = 'cut';\n    return this;\n  }\n\n  isCopy() {\n    return this.state === 'copy';\n  }\n\n  isCut() {\n    return this.state === 'cut';\n  }\n\n  isClear() {\n    return this.state === 'clear';\n  }\n\n  clear() {\n    this.range = null;\n    this.state = 'clear';\n  }\n}\n","import {CellRange} from './cell_range';\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\n// value:\n//   in => []\n//   be => [min, max]\nclass Filter {\n    constructor(ci, operator, value) {\n        this.ci = ci;\n        this.operator = operator;\n        this.value = value;\n    }\n\n    set(operator, value) {\n        this.operator = operator;\n        this.value = value;\n    }\n\n    includes(v) {\n        const {operator, value} = this;\n        if (operator === 'all') {\n            return true;\n        }\n        if (operator === 'in') {\n            return value.includes(v);\n        }\n        return false;\n    }\n\n    vlength() {\n        const {operator, value} = this;\n        if (operator === 'in') {\n            return value.length;\n        }\n        return 0;\n    }\n\n    getData() {\n\n        const {ci, operator, value} = this;\n        return {ci, operator, value};\n    }\n}\n\nclass Sort {\n    constructor(ci, order) {\n        this.ci = ci;\n        this.order = order;\n    }\n\n    asc() {\n        return this.order === 'asc';\n    }\n\n    desc() {\n        return this.order === 'desc';\n    }\n}\n\nexport default class AutoFilter {\n    constructor() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n\n        this.flex = [];\n    }\n\n    setData({ref, filters, sort}) {\n        if (ref != null) {\n            this.ref = ref;\n            this.fitlers = filters.map(it => new Filter(it.ci, it.operator, it.value));\n            if (sort) {\n                this.sort = new Sort(sort.ci, sort.order);\n            }\n        }\n    }\n\n    getData() {\n        if (this.active()) {\n            const {ref, filters, sort} = this;\n            return {ref, filters: filters.map(it => it.getData()), sort};\n        }\n        return {};\n    }\n\n    addFilter(ci, operator, value) {\n        const filter = this.getFilter(ci);\n        if (filter == null) {\n            this.filters.push(new Filter(ci, operator, value));\n        } else {\n            filter.set(operator, value);\n        }\n    }\n\n    addFiexRows(args) {\n        this.flex = args;\n    }\n\n    setSort(ci, order) {\n        this.sort = order ? new Sort(ci, order) : null;\n    }\n\n    includes(ri, ci) {\n        if (this.active()) {\n            return this.hrange().includes(ri, ci);\n        }\n        return false;\n    }\n\n    getSet(exceptRowSet, rir) {\n        for (let ix = 0; ix < this.flex.length; ix++) {\n            let {ri, ci, set_total, state} = this.flex[ix]\n            for (let i = ri; i < set_total + ri; i++) {\n                console.log(state, \"114\", rir, ri, state)\n                if (state === false && rir == ri) {\n                    exceptRowSet.add(i + 1);\n                    this.flex[ix].state = true;\n                } else if (state === true && rir == ri) {\n                    exceptRowSet.delete(i + 1);\n                    this.flex[ix].state = false;\n                }\n            }\n        }\n\n        return exceptRowSet;\n    }\n\n    includes2(rir, cic) {\n        let b = false\n\n        for (let i = 0; i < this.flex.length; i++) {\n            let {ri, ci} = this.flex[i];\n            if (rir == ri && cic == ci) {\n                b = true;\n            }\n        }\n\n        return b;\n    }\n\n    getSort(ci) {\n        const {sort} = this;\n        if (sort && sort.ci === ci) {\n            return sort;\n        }\n        return null;\n    }\n\n    getFilter(ci) {\n        const {filters} = this;\n        for (let i = 0; i < filters.length; i += 1) {\n            if (filters[i].ci === ci) {\n                return filters[i];\n            }\n        }\n        return null;\n    }\n\n    filteredRows(getCell) {\n        // const ary = [];\n        // let lastri = 0;\n        const rset = new Set();\n        const fset = new Set();\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            const {filters} = this;\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                for (let i = 0; i < filters.length; i += 1) {\n                    const filter = filters[i];\n                    const cell = getCell(ri, filter.ci);\n                    const ctext = cell ? cell.text : '';\n                    if (!filter.includes(ctext)) {\n                        rset.add(ri);\n                        break;\n                    } else {\n                        fset.add(ri);\n                    }\n                }\n            }\n        }\n\n        return {rset, fset};\n    }\n\n    items(ci, getCell) {\n        const m = {};\n        if (this.active()) {\n            const {sri, eri} = this.range();\n            for (let ri = sri + 1; ri <= eri; ri += 1) {\n                const cell = getCell(ri, ci);\n                if (cell !== null && !/^\\s*$/.test(cell.text)) {\n                    const key = cell.text;\n                    const cnt = (m[key] || 0) + 1;\n                    m[key] = cnt;\n                } else {\n                    m[''] = (m[''] || 0) + 1;\n                }\n            }\n        }\n        return m;\n    }\n\n    range() {\n        return CellRange.valueOf(this.ref);\n    }\n\n    hrange() {\n        const r = this.range();\n        console.log(this.range(), \"171\")\n        r.eri = r.sri;\n        return r;\n    }\n\n    clear() {\n        this.ref = null;\n        this.filters = [];\n        this.sort = null;\n    }\n\n    active() {\n        return this.ref !== null;\n    }\n}\n","import { CellRange } from './cell_range';\n\nclass Merges {\n  constructor(d = []) {\n    this._ = d;\n  }\n\n  forEach(cb) {\n    this._.forEach(cb);\n  }\n\n  each(cb) {\n      this._.forEach(it => cb(it));\n  }\n\n  deleteWithin(cr) {\n    this._ = this._.filter(it => !it.within(cr));\n  }\n\n  getFirstIncludes(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.includes(ri, ci)) {\n        return it;\n      }\n    }\n    return null;\n  }\n\n  filterIntersects(cellRange) {\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\n  }\n\n  intersects(cellRange) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const it = this._[i];\n      if (it.intersects(cellRange)) {\n        // console.log('intersects');\n        return true;\n      }\n    }\n    return false;\n  }\n\n  union(cellRange) {\n    let cr = cellRange;\n    this._.forEach((it) => {\n      if (it.intersects(cr)) {\n        cr = it.union(cr);\n      }\n    });\n    return cr;\n  }\n\n  add(cr) {\n    this.deleteWithin(cr);\n    this._.push(cr);\n  }\n\n  // type: row | column\n  shift(type, index, n, cbWithin) {\n    this._.forEach((cellRange) => {\n      const {\n        sri, sci, eri, eci,\n      } = cellRange;\n      const range = cellRange;\n      if (type === 'row') {\n        if (sri >= index) {\n          range.sri += n;\n          range.eri += n;\n        } else if (sri < index && index <= eri) {\n          range.eri += n;\n          cbWithin(sri, sci, n, 0);\n        }\n      } else if (type === 'column') {\n        if (sci >= index) {\n          range.sci += n;\n          range.eci += n;\n        } else if (sci < index && index <= eci) {\n          range.eci += n;\n          cbWithin(sri, sci, 0, n);\n        }\n      }\n    });\n  }\n\n  move(cellRange, rn, cn) {\n    this._.forEach((it1) => {\n      const it = it1;\n      if (it.within(cellRange)) {\n        it.eri += rn;\n        it.sri += rn;\n        it.sci += cn;\n        it.eci += cn;\n      }\n    });\n  }\n\n  setData(merges) {\n    this._ = merges.map(merge => CellRange.valueOf(merge));\n    return this;\n  }\n\n  getData() {\n    return this._.map(merge => merge.toString());\n  }\n}\n\nexport default {};\nexport {\n  Merges,\n};\n","import CellRange from \"./cell_range\";\n\nexport default class PasteProxy {\n    constructor(srcCellRange, dstCellRange, rows) {\n        this.srcCellRange = \"\";\n        this.dstCellRange = \"\";\n        this.srcOneDRange = \"\";\n        this.dstOneDRange = \"\";\n    }\n\n    setSrcAndDstCellRange(srcCellRange, dstCellRange) {\n        this.srcCellRange = srcCellRange;\n        this.dstCellRange = dstCellRange;\n    }\n\n    use() {\n        let {srcCellRange, dstCellRange} = this;\n        const {\n            sri, sci, eri, eci,\n        } = srcCellRange;\n\n        const dsri = dstCellRange.sri;\n        const dsci = dstCellRange.sci;\n        const deri = dstCellRange.eri;\n        const deci = dstCellRange.eci;\n        const [rn, cn] = srcCellRange.size();\n        const [drn, dcn] = dstCellRange.size();\n\n        return {\n            sri, sci, eri, eci, dsri, dsci, deri, deci, rn, cn, drn, dcn\n        }\n    }\n\n    autoFilterDirection() {\n        let {sri, dsri, deri, eri} = this.use();\n\n        let isLeftRight = false; // 识别方向  上下false、左右true\n        if (sri == dsri && deri == eri) {\n            isLeftRight = true;\n        }\n\n        return isLeftRight;\n    }\n\n    upOrDown() {\n        let {deri, sri, deci, sci,} = this.use();\n        let isDown = true;       // 往上是false, 往下是true     // isDown\n        if (deri < sri || deci < sci) {\n            isDown = false;\n        }\n\n        return isDown;\n    }\n\n    leftOrRight() {\n        let {\n            srcOneDRange,\n            dstOneDRange\n        } = this.getRangeByWay();\n\n        let line = 1;       // 往左往右\n        if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci > srcOneDRange.eci) {\n            line = 2;       // 往右\n        } else if (srcOneDRange.sri === srcOneDRange.eri && dstOneDRange.eci < srcOneDRange.eci) {\n            line = 3;       // 往左\n        }\n        return line;\n    }\n\n    getOneDRangeObj(way, offset) {\n        let {sri, sci, eri, eci, dsri, dsci, deri, deci} = this.use();\n\n        if (!way) {\n            this.srcOneDRange = new CellRange(sri, sci + offset, eri, sci + offset);\n            this.dstOneDRange = new CellRange(dsri, dsci + offset, deri, dsci + offset);\n        } else {\n            this.srcOneDRange = new CellRange(sri + offset, sci, sri + offset, eci);\n            this.dstOneDRange = new CellRange(dsri + offset, dsci, dsri + offset, deci);\n        }\n\n        return this.getRangeByWay();\n    }\n\n    getRangeByWay() {\n        return {\n            \"srcOneDRange\": this.srcOneDRange,\n            \"dstOneDRange\": this.dstOneDRange\n        }\n    }\n\n    // todo 什么意思\n    isCopy(sarr, i) {\n        let {sri, sci, eri} = this.use();\n        let isCopy = false;\n        if (sarr.length > 1) {\n            isCopy = true;\n        }\n        if (sri == eri && sci + i == sci + i) {\n            isCopy = true;\n        }\n\n        return isCopy;\n    }\n\n    calcDiff(sarr, isAdd) {\n        let diffValue = 1;\n\n        if (!isAdd) {\n            diffValue = 1;\n        }\n\n        if (isAdd && sarr.length > 1) {\n            let last2 = sarr[sarr.length - 2];\n            let last1 = sarr[sarr.length - 1];\n            diffValue = last1.text * 1 - last2.text * 1;\n        } else if (sarr.length > 1) {\n            let last2 = sarr[1];\n            let last1 = sarr[0];\n            diffValue = last1.text * 1 - last2.text * 1;\n        }\n\n        if(isNaN(diffValue)) {\n            diffValue = 1;\n        }\n\n        return diffValue;\n    }\n}","import {isHave} from \"./helper\";\nimport {isFormula} from \"./row\";\nimport {datePattern2, str2Re} from \"../utils/reg_pattern\";\n\nexport default class CellProxy {\n    constructor(cell) {\n        this.cell = cell;\n    }\n\n    renderFormat(style, nrindex, cindex, data, filter) {\n        if(isHave(style) === false || isHave(style.format) === false) {\n            return {\n                \"cellText\": \"\",\n                \"state\": false,\n            };\n        }\n\n        let {cell} = this;\n        let cellText = \"\";\n        if (style.format) {\n            // console.log(data.formatm, '>>', cell.format);\n            let formatInfo = data.tryParseToNum(cell, nrindex, cindex);\n            if(formatInfo.state) {\n                if(filter) {\n                    if((formatInfo.style === 'date' || formatInfo.style === 'datetime')) {\n                        cellText = formatInfo.text;\n                    } else {\n                        formatInfo.state = false;\n                    }\n                }  else {\n                    cellText = formatInfo.text;\n                }\n            } else {\n                if( isHave(cell.text) === false) {\n                    cell.text = \"\";\n                }\n                cellText = cell.text;\n            }\n            return {\n                \"cellText\": cellText,\n                \"state\": formatInfo.state,\n            };\n        }\n        return {\n            \"cellText\": cellText,\n            \"state\": false,\n        };\n    }\n\n    getCellDataType(sarr, {isDate, isNumber}) {\n        let ncell = this.cell;\n        // let enter = false;\n        let nA = true;\n\n\n        if (!isHave(ncell.formulas)) {\n            ncell.formulas = \"\";\n        }\n        if (!isHave(ncell.text)) {\n            ncell.text = \"\";\n        }\n\n        let value = ncell.formulas !== \"\" ? ncell.formulas + \"\" : ncell.text + \"\";\n        // value = value.replace(/,/g, \"\").replace(\"=\", \"\");\n        value = value.replace(/,/g, \"\");        // =123 不要把=扔掉\n        let ns = value * 1;\n\n        if ((ns || ns == 0) && typeof ns === 'number' && !isNaN(ns) && /^\\d+$/.test(value) === true) {\n            if(isNumber == true) {\n                isNumber = true;\n                nA = false;\n                isDate = false;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'number';\n        } else if (value && nA == true && isFormula(value)) {\n            nA = true;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'na';\n        } else if (value && value.search(str2Re(datePattern2), '') != -1) {\n            if( isDate == true) { // jobs: todo: 正则表达式应该集中管理。而且这个正则表达式太复杂了，应该能简化。\n                nA = false;\n                isNumber = false;\n                isDate = true;\n            } else {\n                nA = false;\n                isNumber = false;\n                isDate = false;\n            }\n            ncell.type = 'date';\n        } else {//\n            nA = false;\n            isNumber = false;\n            isDate = false;\n            ncell.type = 'other';\n        }\n        ncell.tmp = value;\n        sarr.push(ncell);\n\n        return {\n            nA, isDate: isDate, isNumber: isNumber\n        }\n    }\n}\n","import {isHave} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\n\nexport default class CellProp {\n    constructor(ri, ci, cell, expr, empty) {\n        this.ri = ri;\n        this.ci = ci;\n        this.cell = cell;\n        this.expr = expr;\n        this.empty = empty;\n    }\n\n    isInclude() {\n\n    }\n\n\n    each(cb) {\n        let {cell} = this;\n        if(isHave(cell.depend) === false) {\n            return;\n        }\n        for(let i = 0; i < cell.depend.length; i++) {\n            let expr = cell.depend[i];\n            let [ci, ri] = expr2xy(expr);\n            cb(ri, ci);\n        }\n    }\n}","import {isHave} from \"../core/helper\";\n\n\n/**\n * Cell类，代表一个单元格的数据格式。\n */\nexport default class Cell {\n    /**\n     * @constructor\n     * @param text - 单元格的文本。\n     * @param formulas - 单元格的公式\n     * @param style - 单元格的样式, 如果为null,则表示是默认样式\n     * @param depend - 其他单元格依赖\n     * @param merge - 为null表示不是合并单元格，否则为一个合并单元格\n     * @param formatText - 单元格的格式，若为null，则表明没有格式\n     * @param multivalueRefsCell - 用来标记多值单元格\n     */\n    constructor() {\n        this.text = \"\";\n        this.depend = [];\n        this.formulas = \"\";\n\n        this.style = null;\n        this.merge = null;\n        this.formatText = null;\n        this.multivalueRefsCell = null;\n        this.source_v = null;\n    }\n\n    /**\n     * 设置单元格信息\n     */\n    setCell(cell) {\n        if (!isHave(cell)) {\n            return;\n        }\n\n        if (isHave(cell.text)) {\n            this.text = cell.text;\n        }\n\n        if (isHave(cell.formulas)) {\n            this.formulas = cell.formulas;\n        }\n\n        if(isHave(cell.formatText)) {\n            this.formatText = cell.formatText;\n        }\n\n        if (isHave(cell.depend)) {\n            this.depend = cell.depend;\n        }\n\n        if (isHave(cell.style)) {\n            this.style = cell.style;\n        }\n\n        if (isHave(cell.multivalueRefsCell)) {\n            this.multivalueRefsCell = cell.multivalueRefsCell;\n        }\n\n        if (isHave(cell.merge)) {\n            this.merge = cell.merge;\n        }\n\n        if (isHave(cell.source_v)) {\n            this.source_v = cell.source_v;\n        }\n    }\n\n    /**\n     * 设置单元格的格式\n     * @param args args.state 为true表示存在格式，为false不存在格式, text 具体格式信息\n     */\n    setFormatText(args) {\n        if(args.state) {\n            this.formatText = args.text;\n        }\n    }\n}","import helper, {isHave} from './helper';\nimport {xy2expr} from './alphabet';\nimport {changeFormula, cutStr, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport dayjs from 'dayjs'\nimport {deepCopy, distinct, isSheetVale, splitStr} from \"./operator\";\nimport Recast from \"../utils/reg_pattern.js\";\nimport PasteProxy from \"./paste_proxy\";\nimport CellProxy from \"./cell_proxy\";\nimport CellRange from \"./cell_range\";\nimport CellProp from \"../model/cell_prop\";\nimport Cell from \"../model/cell\";\nvar calcUtils = require('../calc/utils');\n\nexport function isFormula(text) {\n    if (text && text[0] === \"=\") {\n        return true;\n    }\n\n    return false;\n}\n\nfunction isEmpty(text, formulas, formatText) {\n    if(isHave(text) && text !== \"\") {\n        return false;\n    }\n\n    if(isHave(formulas) && formulas !== \"\") {\n        return false;\n    }\n\n    if(isHave(formatText)) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction otherAutoFilter(d, darr, direction, isAdd, what, cb, other, dri) {\n    // other 为 '=asd'或者'asd'也为false\n    let ncell = this.getCellByTopCell(d, direction, isAdd, 'other', dri, 0);\n\n    let {text, formulas} = ncell;\n    let iText = formulas != \"\" ? formulas : text;\n\n    // if (other) {\n    //     this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    // } else\n    if (this.isFormula(iText)) {\n        this.calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb);\n    } else {\n        // 为 '=asd'或者'asd' 进这里\n        this.calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text);\n    }\n}\n\nfunction numberAutoFilter(d, darr, direction, isAdd, diffValue, what, cb, isNumber) {\n    let ncell = \"\";\n\n    if (isAdd) {\n        diffValue = Math.abs(diffValue);\n    } else {\n        diffValue = diffValue * -1;\n    }\n\n    if (!isNumber) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        }\n        diffValue = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isAdd);\n    }\n\n    this.calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb);\n}\n\nfunction dateAutoFilter(d, line, isDown, darr, what, cb, isDate) {\n    let direction = line;\n    let ncell = \"\";\n    let diff = isDown ? 1 : -1;\n    if (!isDate) {\n        ncell = {\n            \"text\": d.v,\n            \"formulas\": d.v,\n        };\n        diff = 0;\n    } else {\n        ncell = this.getCellByTopCell(d, direction, isDown, 'date');\n    }\n    this.calcDateCellByTopCell(ncell, darr, d, isDown, what, cb, diff);\n}\n\nclass Rows {\n    constructor({len, height}, data = \"\") {\n        this._ = {};\n        this.len = len;\n        // default row height\n        this.height = height;\n        this.data = data;\n        this.pasteProxy = new PasteProxy();\n        this.workbook = null;\n    }\n\n    getHeight(ri) {\n        const row = this.get(ri);\n        if (row && row.height) {\n            return row.height;\n        }\n        return this.height;\n    }\n\n    setHeight(ri, v) {\n        const row = this.getOrNew(ri);\n        row.height = v;\n    }\n\n    setStyle(ri, style) {\n        const row = this.getOrNew(ri);\n        row.style = style;\n    }\n\n    sumHeight(min, max, exceptSet) {\n        return helper.rangeSum(min, max, (i) => {\n            if (exceptSet && exceptSet.has(i)) return 0;\n            return this.getHeight(i);\n        });\n    }\n\n    totalHeight() {\n        return this.sumHeight(0, this.len);\n    }\n\n    get(ri) {\n        return this._[ri];\n    }\n\n    getOrNew(ri) {\n        this._[ri] = this._[ri] || {cells: {}};\n        return this._[ri];\n    }\n\n    getCell(ri, ci) {\n        const row = this.get(ri);\n        if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined\n            && (isHave(row.cells[ci].text) || isHave(row.cells[ci].formulas) || isHave(row.cells[ci].style || typeof row.cells[ci] === 'object'))) {\n            return row.cells[ci];\n        }\n        return null;\n    }\n\n    getCellMerge(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.merge) return cell.merge;\n        return [0, 0];\n    }\n\n    getCellOrNew(ri, ci) {\n        const row = this.getOrNew(ri);\n        row.cells[ci] = row.cells[ci] || {};\n        return row.cells[ci];\n    }\n\n    toString(text) {\n        if (isHave(text) === false) {\n            text = \"\";\n        }\n        return text + \"\";\n    }\n\n    isBackEndFunc(text) {\n        if (text.indexOf(\"MD.RTD\") != -1) {\n            return true;\n        }\n\n        return false;\n    }\n\n    isReferOtherSheet(cell, state = false) {\n        if (cell.formulas && cell.formulas[0] == \"=\" && (state || isSheetVale(cell.formulas))) {\n            return true;\n        }\n        return false;\n    }\n\n    isEmpty(cell) {\n        if (cell && (cell.text || cell.formulas || cell.depend)) {\n            return false;\n        }\n        return true;\n    }\n\n    isFormula(text) {\n        return isFormula(text);\n    }\n\n    setValue(type, value, cell) {\n        cell[type] = value;\n    }\n\n    // what: all | text | format\n    setCell(ri, ci, cell, what = 'all') {\n        let {data} = this;\n        const row = this.getOrNew(ri);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        if (what === 'all') {\n            row.cells[ci] = _cell;\n        } else if(what === 'formulas') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].formulas = _cell.formulas;\n        } else if (what === 'text') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].text = _cell.text;\n        } else if (what === 'format') {\n            row.cells[ci] = row.cells[ci] || {};\n            row.cells[ci].style = _cell.style;\n            if (cell.merge) row.cells[ci].merge = _cell.merge;\n        } else if (what === 'date' || what === 'datetime') {\n            // row.cells[ci] = {};\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n            row.cells[ci].to_calc_num = _cell.to_calc_num;\n        } else if (what === 'normal' || what === 'number') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n            if (!this.isFormula(cell.formulas)) {\n                row.cells[ci].formulas = _cell.text;\n            } else {\n                row.cells[ci].formulas = _cell.formulas;\n            }\n            // row.cells[ci].value = cell.value;\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'rmb' || what === 'percent') {        // rmb 单独拿出来是因为 text是￥123, 而formalus不能是 ￥123,应该是123\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {}\n            }\n\n            row.cells[ci].text = _cell.text;\n            row.cells[ci].formulas = _cell.formulas;\n            row.cells[ci].style = _cell.style;\n        } else if (what === 'all_with_no_workbook') {\n            row.cells[ci] = _cell;\n\n            return;\n        } else if (what === 'style') {\n            if (!isHave(row.cells[ci])) {\n                row.cells[ci] = {};\n            }\n\n            row.cells[ci].style = _cell.style;\n            return;\n        }\n        // cell\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n        _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n    }\n\n    getDependCell(expr, cell) {\n        let {formulas} = cell;\n        if (isHave(formulas) === false) {\n            return;\n        }\n        if (isFormula(formulas)) {\n            let arr = cutStr(formulas, true, true);\n\n            for (let i = 0; i < arr.length; i++) {\n                let args = this.mergeCellExpr(arr[i]);\n                if (args.state) {\n                    arr.push(...args.mergeArr);\n                }\n            }\n            arr = distinct(arr);\n\n            if (isHave(cell.depend) === false) {\n                cell.depend = [];\n            }\n            for (let i = 0; i < arr.length; i++) {\n                let ref = arr[i];\n                let [ci, ri] = expr2xy(ref);\n                let refCell = this.getCell(ri, ci);\n                if (isHave(refCell) === false) {\n                    refCell = {};\n                }\n\n                if (isHave(refCell.depend) === false) {\n                    refCell.depend = [];\n                }\n                refCell.depend.push(expr);\n                refCell.depend = distinct(refCell.depend);\n                this.setCell(ri, ci, refCell, 'all_with_no_workbook');\n            }\n        }\n    }\n\n    mergeCellExpr(d) {\n        if (!isAbsoluteValue(d, 6)) {\n            return {\n                \"state\": false,\n            }\n        }\n        d = d.replace(/\\$/g, '');\n        d = d.split(\":\");\n        let e1 = expr2xy(d[0]);\n        let e2 = expr2xy(d[1]);\n\n        if (e1[0] > e2[0]) {\n            let t = e2[0];\n            e2[0] = e1[0];\n            e1[0] = t;\n        }\n        if (e1[1] > e2[1]) {\n            let t = e2[1];\n            e2[1] = e1[1];\n            e1[1] = t;\n        }\n        let cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0]);\n        let arr = [];\n        cellRange.each((i, j) => {\n            arr.push(xy2expr(j, i));\n        });\n\n        return {\n            \"state\": true,\n            \"mergeArr\": arr,\n        };\n    }\n\n    useOne(param, other, value = true) {\n        if (isHave(param) === false) {\n            return other;\n        }\n\n        if (value && this.isFormula(param)) {\n            return other;\n        }\n        return param;\n    }\n\n    // what === cell 把原本的cell 的merge 清空， 原因是不清空 merge还会存在\n    setCellText(ri, ci, {text, style, formulas, merge = \"\"},  what = 'all') {\n        if(what === 'all_with_no_workbook') {\n            this.setCell(ri, ci, {}, 'all_with_no_workbook');\n            return;\n        }\n\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.setCell(cell);\n        // _cell.setFormatText(data.tryParseToNum(_cell, ri, ci));\n        if (what === 'style') {\n            _cell.style = style;\n            _cell.formulas = text;   //    cell.formulas = cell.formulas;\n        }   else if (what === 'format') {\n            _cell.formulas = cell.formulas;\n            _cell.style = style;\n        } else if (what === 'cell') {\n            _cell.style = style;\n            _cell.formulas = formulas;\n            _cell['merge'] = undefined;\n            if (merge !== \"\") {\n                _cell.merge = merge;\n            }\n        } else {\n            _cell.formulas = text;\n        }\n        _cell.text = text;\n        this.setCell(ri, ci, _cell);\n\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    setCellAll(ri, ci, text, formulas = \"\", what = '') {\n        const cell = this.getCellOrNew(ri, ci);\n        let _cell = new Cell();\n        _cell.formulas = formulas == \"\" ? cell.formulas : formulas;\n        _cell.text = text;\n\n        this.setCell(ri, ci, _cell, 'formulas');\n        this.setCell(ri, ci, _cell, 'text');\n        this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n    }\n\n    moveChange(arr, arr2, arr3) {\n        if (arr.length != arr2.length && arr3.length != arr2.length) {\n            return;\n        }\n\n        for (let i = 0; i < arr.length; i++) {\n\n            let s1 = arr[i].expr;\n            arr[i].each((ri, ci) => {\n                let cell = this.getCell(ri, ci);\n                if (isHave(cell) === false) {\n                    cell = {};\n                }\n                if (!isHave(cell.formulas)) {\n                    cell.formulas = \"\";\n                }\n\n                let formulas = changeFormula(cutStr(cell.formulas));\n\n                if (formulas.indexOf(s1) != -1) {\n                    let ca = arr3[i].expr.replace(/\\$/g, \"\\\\$\");\n\n                    this.setCellAll(ri, ci, cell.text.replace(new RegExp(ca, 'g'), arr2[i].expr), cell.formulas.replace(ca, arr2[i].expr));\n                } else {\n                    let s = value2absolute(s1);\n                    let es = value2absolute(arr2[i].expr);\n                    if (formulas.indexOf(s.s3) != -1) {\n                        s = value2absolute(arr3[i].expr);\n\n                        s.s3 = s.s3.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s3, 'g'), es.s3), cell.formulas.replace(new RegExp(s.s3, 'g'), es.s3));\n                    } else if (formulas.indexOf(s.s2) != -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s2 = s.s2.replace(/\\$/g, \"\\\\$\");\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s2, 'g'), es.s2), cell.formulas.replace(new RegExp(s.s2, 'g'), es.s2));\n                    } else if (formulas.indexOf(s.s1) != -1) {\n                        s = value2absolute(arr3[i].expr);\n                        s.s1 = s.s1.replace(/\\$/g, \"\\\\$\");\n\n                        this.setCellAll(ri, ci, cell.text.replace(new RegExp(s.s1, 'g'), es.s1), cell.formulas.replace(new RegExp(s.s1, 'g'), es.s1));\n                    }\n                }\n            });\n        }\n    }\n\n    formatMoney(s, type) {\n        if (/[^0-9\\.]/.test(s))\n            return \"0\";\n        if (s == null || s == \"\")\n            return \"0\";\n        s = s.toString().replace(/^(\\d*)$/, \"$1.\");\n        s = (s + \"00\").replace(/(\\d*\\.\\d\\d)\\d*/, \"$1\");\n        s = s.replace(\".\", \",\");\n        let re = /(\\d)(\\d{3},)/;\n        while (re.test(s))\n            s = s.replace(re, \"$1,$2\");\n        s = s.replace(/,(\\d\\d)$/, \".$1\");\n        if (type == 0) {\n            let a = s.split(\".\");\n            if (a[1] == \"00\") {\n                s = a[0];\n            }\n        }\n        return s;\n    }\n\n    // isValid => true 为日期  false 为 数字\n    getCellStyleConvert(cellStyle, isValid) {\n        if (cellStyle && cellStyle.format && cellStyle.format === 'number') {\n            return \"number\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'rmb') {\n            return 'rmb';\n        } else if ((cellStyle && cellStyle.format && cellStyle.format === 'normal')) {\n            return \"normal\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'percent') {\n            return \"percent\";\n        } else if (cellStyle && cellStyle.format && cellStyle.format === 'datetime') {\n            return \"datetime\";\n        } else if (\n            (isValid && !isHave(cellStyle))\n            || (isValid && cellStyle && cellStyle.format !== 'normal')\n            || cellStyle && cellStyle.format && cellStyle.format === 'date') {\n            return \"date\";\n        }\n\n        return \"\";\n    }\n\n    getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, abs = 0, isRows) {\n        let enter = false;\n        let s = \"\";\n        if (isInsert) {\n            if (sri <= ds[1] && isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[1] && !isAdd && isRows) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            } else if (sri <= ds[0] && isAdd && isRows === false) {\n                s = xy2expr(ds[0] + dei, ds[1] + dci, abs);\n                enter = true;\n            }\n        }\n\n        return {\n            \"enter\": enter,\n            \"data\": s,\n        }\n    }\n\n    eachRange(range) {\n        let cells = [];\n        range.each((i, j) => {\n            let cell = this.getCell(i, j);\n            if (isHave(cell)) {\n                let empty = isEmpty(cell);\n                cell = deepCopy(cell);\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), empty);\n                cells.push(cellProp);\n            } else  {\n                cell = {};\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j), true);\n                cells.push(cellProp);\n            }\n        });\n\n        return cells;\n    }\n\n    getCellTextByShift(arr, dei, dci, isInsert = false, isAdd = false, sri = 0, isRows = false) {\n        let bad = false;\n        let enter = false;\n        let newStr = \"\";\n\n        for (let i = 0; i < arr.length; i++) {\n            // if(isInsert && isHave(arr[i])) {\n            //     arr[i] = arr[i].replace(/\\$/, '');\n            // }\n            if (typeof arr[i] === 'string') {\n                arr[i] = arr[i].toUpperCase();\n            }\n            if (arr[i].search(/^[A-Z]+\\d+$/) != -1) {\n                let ds = expr2xy(arr[i]);\n                if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    arr[i] = args.data;\n                } else if (isInsert === false) {\n                    arr[i] = xy2expr(ds[0] + dei, ds[1] + dci);\n                }\n                enter = true;\n            } else if (arr[i].search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                let a1 = arr[i].split(\":\")[0];\n                let a2 = arr[i].split(\":\")[1];\n                let ds1 = expr2xy(a1);\n                let ds2 = expr2xy(a2);\n\n                if (ds1[0] + dei < 0 || ds1[1] + dci < 0) {\n                    bad = true;\n                }\n                if (ds2[0] + dei < 0 || ds2[1] + dci < 0) {\n                    bad = true;\n                }\n\n                let s = \"\";\n\n                let args = this.getCellTextIsAdd(isInsert, sri, ds1, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s = args.data + \":\";\n                } else if (isInsert == false) {\n                    s = xy2expr(ds1[0] + dei, ds1[1] + dci) + \":\";\n                } else {\n                    s = a1 + \":\";\n                }\n\n                args = this.getCellTextIsAdd(isInsert, sri, ds2, isAdd, dei, dci, 0, isRows);\n                if (args.enter) {\n                    s += args.data;\n                } else if (isInsert == false) {\n                    s += xy2expr(ds2[0] + dei, ds2[1] + dci);\n                } else {\n                    s += a2;\n                }\n\n                enter = true;\n                arr[i] = s;\n            } else {\n                let value = isAbsoluteValue(arr[i], 5);\n\n                if (value === 2) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0] + dei, ds[1], 2);\n                    }\n                    enter = true;\n                } else if (value === 1) {\n                    let ds = expr2xy(arr[i].replace(/\\$/g, ''));\n                    if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                        bad = true;\n                    }\n\n                    let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                    if (args.enter) {\n                        arr[i] = args.data;\n                    } else if (isInsert === false) {\n                        arr[i] = xy2expr(ds[0], ds[1] + dci, 1);\n                    }\n\n                    enter = true;\n                } else if (value === 4) {\n                    let sp = arr[i].split(\":\");\n                    console.log(arr[i], sp);\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 5) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 7) {\n                    let sp = arr[i].split(':');\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                        if (args.enter) {\n                            sp[item] = args.data;\n                        } else if (isInsert === false) {\n                            sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 6) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0], ds[1] + dci, 1);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 8) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 9) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 0) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 10) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 2, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 2);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                } else if (value === 11) {\n                    let sp = arr[i].split(\":\");\n                    for (let item = 0; item < sp.length; item++) {\n                        let ds = expr2xy(sp[item].replace(/\\$/g, ''));\n                        if (ds[0] + dei < 0 || ds[1] + dci < 0) {\n                            bad = true;\n                        }\n\n                        if (item === 1) {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 0, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1] + dci, 0);\n                            }\n                        } else {\n                            let args = this.getCellTextIsAdd(isInsert, sri, ds, isAdd, dei, dci, 1, isRows);\n                            if (args.enter) {\n                                sp[item] = args.data;\n                            } else if (isInsert === false) {\n                                sp[item] = xy2expr(ds[0] + dei, ds[1], 1);\n                            }\n                        }\n                    }\n                    arr[i] = sp.join(':');\n                    enter = true;\n                }\n            }\n            newStr += arr[i];\n        }\n\n        return {\n            \"bad\": bad,\n            \"enter\": enter,\n            \"result\": newStr\n        };\n    }\n\n    autoFilterRef(ref, range) {\n        let [ci, ri] = expr2xy(ref);\n        let cell = this.getCell(ri, ci);\n        while (cell !== null) {\n            ri += 1;\n            cell = this.getCell(ri, ci);\n        }\n        range.eri = ri;\n\n        return range;\n    }\n\n    // getAllDataType(cellRange)\n    getAllDataType(cellRange) {\n        const {pasteProxy} = this;\n        let isNumber = true, isDate = true, sarr = [];\n\n        cellRange.each((i, j) => {\n            let und = false, cell = this.getCell(i, j);\n            if (cell) {\n                cell = deepCopy(cell);\n                let args = new CellProxy(cell).getCellDataType(sarr, {isDate, isNumber});\n                // pasteProxy.getCellDataType(cell, sarr, {isDate, isNumber}); // let args = CellProxy(cell).getCellDataType()\n                isDate = args.isDate;\n                isNumber = args.isNumber;\n            } else {\n                und = true;\n                isNumber = false;\n                isDate = false;\n            }\n\n            if (und) {\n                sarr.push({\n                    text: 0,\n                    formulas: 0,\n                    tmp: \"\",\n                    type: \"other\",\n                });\n            }\n        });\n\n        return {\n            isDate: isDate, isNumber: isNumber, sarr\n        }\n    }\n\n    calcNumberCellByTopCell(ncell, diffValue, darr, d, what, cb) {\n        let {text, formulas} = ncell;\n        text = this.toString(text);\n        formulas = this.toString(formulas);\n        let cell = {};\n        if (this.isFormula(formulas)) {\n            let last1 = text.replace(\"=\", \"\") * 1;\n\n            let value = last1 + diffValue;\n            cell = {\n                \"text\": \"=\" + value + \"\",\n                \"formulas\": \"=\" + value + \"\",\n            };\n        } else if (text !== '') {\n            let last1 = text * 1;\n            if (text.indexOf(\",\") != -1) {\n                last1 = last1.replace(/,/g, '');\n                let value = parseFloat(last1) + diffValue;\n                last1 = this.formatMoney(value, 0);\n            } else {\n                last1 = last1 + diffValue;\n            }\n\n            cell = {\n                \"text\": last1 + \"\",\n                \"formulas\": last1 + \"\",\n            };\n        }\n\n        this.copyRender(darr, d.ri, d.ci, cell, what, cb);\n    }\n\n    calcFormulaCellByTopCell(iText, darr, d, direction, isAdd, cb) {\n        let strList = splitStr(iText);\n        let args = this.getRangeByTopCell({ri: d.ri, ci: d.ci}, direction, isAdd);\n        let dci = d.ri - args.ri;\n        let dri = d.ci - args.ci;\n        let {bad, result} = this.getCellTextByShift(strList, dri, dci);\n        this.updateCellReferenceByShift(bad, result, d.ri, d.ci, cb);\n    }\n\n    calcCellByTopCell(cb, what, ncell, darr, isAdd, iText, d, text) {\n\n        if (!isHave(iText)) {\n            iText = \"\";\n        }\n        if (!isNaN(iText)) {\n            ncell.text = iText;\n            ncell.formulas = ncell.text;\n        } else {\n            let arr = this.toString(iText).split(/\\d+/g);\n            if (arr) {\n                let count = 0;\n                if (isAdd) {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 + 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                } else {\n                    ncell.text = iText.replace(/\\d+/g, (word) => {\n                        count = count + 1;\n                        if (arr.length - 1 === count) {\n                            return word * 1 - 1;\n                        } else {\n                            return word;\n                        }\n                    });\n                }\n                ncell.formulas = ncell.text;\n            }\n        }\n        this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n    }\n\n    calcDateCellByTopCell(ncell, darr, d, isAdd, what, cb, diff) {\n        if (ncell.text != '') {\n            let last1 = ncell.text;\n\n            let value = \"\";\n            if (isAdd) {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            } else {\n                value = dayjs(last1).add(diff, 'day').format('YYYY-MM-DD');\n            }\n            ncell.text = this.toString(value);\n            ncell.formulas = this.toString(value);\n            this.copyRender(darr, d.ri, d.ci, ncell, what, cb);\n        }\n    }\n\n    getRangeByTopCell({ri, ci}, direction, isAdd) {\n        if (isAdd) {\n            ri = !direction ? ri - 1 : ri;\n            ci = !direction ? ci : ci - 1;\n        } else {\n            ri = !direction ? ri + 1 : ri;\n            ci = !direction ? ci : ci + 1;\n        }\n\n        return {ri, ci};\n    }\n\n    // logProxy.log({\"msg\":\"12312\"})  console.log --> logProxy.log\n    getCellByTopCell(d, direction, isAdd, what = 'all', dri = 0, dci = 0) {\n        if (what === 'date') {\n            if (direction === 1) {\n                let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, false, isAdd);\n                return this.getCellByCell(ri, ci);\n            } else if (direction === 2) {\n                return this.getCellByCell(d.ri, d.ci - 1);\n            } else if (direction === 3) {\n                return this.getCellByCell(d.ri, d.ci + 1);\n            }\n        } else {\n            let {ri, ci} = this.getRangeByTopCell({ri: isAdd ? d.ri - dri : d.ri + dri, ci: d.ci}, direction, isAdd);\n            return this.getCellByCell(ri, ci);\n        }\n    }\n\n    getCellByCell(ri, ci) {\n        let ncell = this.getCell(ri, ci);\n        if (!ncell) {\n            ncell = {\n                text: '',\n                formulas: '',\n            }\n        }\n\n        return helper.cloneDeep(ncell);\n    }\n\n    updateCellReferenceByShift(bad, result, ri, ci, cb = () => {\n    }) {\n        let _cell = {};\n        if (bad) {\n            _cell.text = \"#REF!\";\n            _cell.formulas = \"#REF!\";\n        } else {\n            _cell.text = result != \"\" ? result : innerText;\n            _cell.formulas = result != \"\" ? result : innerText;\n        }\n        // rows.setCellText(ri, ci, {text, style}, proxy, this.name, 'style');\n        this.setCell(ri, ci, _cell, 'all');\n        cb(ri, ci, _cell);\n    }\n\n    // what: all | format | text\n    // 填充\n    copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {\n    }) {\n        const {pasteProxy} = this;\n        pasteProxy.setSrcAndDstCellRange(srcCellRange, dstCellRange);\n        let {rn, cn} = pasteProxy.use();\n        let isLeftRight = pasteProxy.autoFilterDirection();\n\n        let len = isLeftRight ? rn : cn;\n        for (let i = 0; i < len; i++) {\n            let isDown = pasteProxy.upOrDown();\n            let {srcOneDRange, dstOneDRange} = pasteProxy.getOneDRangeObj(isLeftRight, i);\n            let {isNumber, isDate, sarr} = this.getAllDataType(srcOneDRange);\n            // let isCopy = pasteProxy.isCopy(sarr, i);\n\n            let darr = dstOneDRange.getLocationArray(sarr); //let dstOneDLocationAarray = dstOneDRange.getLocationArray()\n            let line = pasteProxy.leftOrRight(); // 向左或者向右\n            let other = false;\n\n            for (let i = 0; i < darr.length; i++) {\n                let d = darr[i];\n                if (isNumber || d.type === 'number' || isDate || d.type === 'date') {\n                    other = true;\n                }\n            }\n\n            if (isDown) {\n                for (let i = 0; i < darr.length; i++) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            } else {\n                for (let i = darr.length - 1; i >= 0; i--) {\n                    let d = darr[i];\n                    if (isNumber || d.type === 'number') {\n                        let diffValue = pasteProxy.calcDiff(sarr, isDown);\n                        numberAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, diffValue, what, cb, isNumber);\n                    } else if (isDate || d.type === 'date') {\n                        dateAutoFilter.call(this, darr[i], line, isDown, darr, what, cb, isDate);\n                    } else {\n                        otherAutoFilter.call(this, darr[i], darr, isLeftRight, isDown, what, cb, other, sarr.length - 1);\n                    }\n                }\n            }\n        }\n    }\n\n\n    copyRender(darr, nri, nci, ncell, what, cb) {\n        let as = false;\n        for (let k = 0; as == false && k < darr.length; k++) {\n            if (darr[k].ri == nri && darr[k].ci == nci) {\n                as = true;\n            }\n        }\n        if (as) {\n            this.setCell(nri, nci, ncell, what);\n            cb(nri, nci, ncell);\n        }\n    }\n\n    cutPaste(srcCellRange, dstCellRange) {\n        let srcCell = [];\n        // const ncellmm = {};\n        this.each((ri) => {\n            this.eachCells(ri, (ci) => {\n                let nri = parseInt(ri, 10);\n                let nci = parseInt(ci, 10);\n                if (srcCellRange.includes(ri, ci)) {\n                    nri = dstCellRange.sri + (nri - srcCellRange.sri);\n                    nci = dstCellRange.sci + (nci - srcCellRange.sci);\n                }\n\n                if (ri * 1 !== nri || ci * 1 !== nci) {\n                    // ncellmm[nri] = ncellmm[nri] || {cells: {}};\n                    if (this._[ri].cells[ci].text != '' && this._[ri].cells[ci].formulas != '') {\n                        srcCell.push({\n                            nri: nri,\n                            nci: nci,\n                            ri: ri,\n                            ci: ci,\n                            cell: deepCopy(this._[ri].cells[ci]),\n                        })\n                        // this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    }\n\n                    // if (this._[ri].cells[ci].style) {\n                    //     this.setCell(nri, nci, this._[ri].cells[ci], 'all');\n                    // }\n                }\n            });\n        });\n        for (let i = 0; i < srcCell.length; i++) {\n            let {ri, ci, cell} = srcCell[i];\n            this.setCell(ri, ci, {}, 'all');\n        }\n\n        for (let i = 0; i < srcCell.length; i++) {\n            let {nri, nci, cell} = srcCell[i];\n            this.setCell(nri, nci, cell, 'all');\n        }\n\n        // this._ = ncellmm;\n    }\n\n    insert(sri, n = 1) {\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            let nri = parseInt(ri, 10);\n            if (nri >= sri) {\n                nri += n;\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n, true, true, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n\n            ndata[nri] = row;\n        });\n\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len += n;\n    }\n\n    delete(sri, eri) {\n        const n = eri - sri + 1;\n        const ndata = {};\n        let cells = [];\n        this.each((ri, row) => {\n            const nri = parseInt(ri, 10);\n            if (nri < sri) {\n                ndata[nri] = row;\n            } else if (ri > eri) {\n                ndata[nri - n] = row;\n\n                this.eachCells(ri, (ci, cell) => {\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), 0, n * -1, true, false, sri, true);\n                        if (enter && !bad) {\n                            cells.push({ri: nri - n, ci: ci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                });\n            }\n        });\n        this._ = ndata;\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n        this.len -= n;\n    }\n\n    insertColumn(sci, n = 1) {\n        let cells = [];\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                let nci = parseInt(ci, 10);\n                if (nci >= sci) {\n                    nci += n;\n\n                    if (isHave(cell) && isHave(cell.formulas) && this.isFormula(cell.formulas)) {\n                        let {bad, result, enter} = this.getCellTextByShift(splitStr(cell.formulas), n, 0, true, true, sci, false);\n                        if (enter && !bad) {\n                            cells.push({ri: ri, ci: nci, cell: {text: result, formulas: result}});\n                        }\n                    }\n                }\n                rndata[nci] = cell;\n            });\n            row.cells = rndata;\n        });\n\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n            this.setCell(ri, ci, cell, 'all');\n        }\n    }\n\n    deleteColumn(sci, eci) {\n        const n = eci - sci + 1;\n        this.each((ri, row) => {\n            const rndata = {};\n            this.eachCells(ri, (ci, cell) => {\n                const nci = parseInt(ci, 10);\n                if (nci < sci) {\n                    rndata[nci] = cell;\n                } else if (nci > eci) {\n                    rndata[nci - n] = cell;\n                }\n            });\n            row.cells = rndata;\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCells(cellRange, what = 'all') {\n        cellRange.each((i, j) => {\n            this.deleteCell(i, j, what);\n        });\n    }\n\n    // what: all | text | format | merge\n    deleteCell(ri, ci, what = 'all') {\n        const row = this.get(ri);\n        if (row !== null) {\n            const cell = this.getCell(ri, ci);\n            if (cell !== null) {\n                if (what === 'all') {\n                    delete row.cells[ci];\n                } else if (what === 'text') {\n                    if (isHave(cell.text)) delete cell.text;\n                    if (isHave(cell.value)) delete cell.value;\n                    if (isHave(cell.formulas)) delete cell.formulas;\n                    // if (isHave(cell.depend)) delete cell.depend;\n                } else if (what === 'format') {\n                    if (cell.style !== undefined) delete cell.style;\n                    if (cell.merge) delete cell.merge;\n                } else if (what === 'merge') {\n                    if (cell.merge) delete cell.merge;\n                }\n            }\n        }\n    }\n\n    each(cb) {\n        Object.entries(this._).forEach(([ri, row]) => {\n            cb(ri, row);\n        });\n    }\n\n    eachCells(ri, cb) {\n        if (this._[ri] && this._[ri].cells) {\n            Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\n                cb(ci, cell);\n            });\n        }\n    }\n\n    recast(cell) {\n        try {\n            if (this.isReferOtherSheet(cell, true)) {\n                let recast = new Recast(cell.formulas);\n                recast.parse();\n                cell['recast'] = recast;\n            } else {\n                cell['recast'] = null;\n            }\n        } catch (e) {\n            cell['recast'] = null;\n        }\n    }\n\n    init() {\n        this.each((ri, row) => {\n            this.eachCells(ri, (ci, cell) => {\n                this.getDependCell(xy2expr(ci, ri), this.getCell(ri, ci));\n            });\n        });\n    }\n\n    setData(d, sheet = \"\", out = false, rowsInit = false) {\n        try {\n            if (d.len) {\n                this.len = d.len;\n                delete d.len;\n            }\n            this._ = d;\n\n\n            if (out) {\n\n            } else if (sheet !== '') {\n                console.time(\"setData\")\n                if (rowsInit) {\n                    this.init();\n                    this.workbook = calcUtils.Rows2Workbook(this);\n                    sheet.toolbar.change('close', '');\n                }\n                console.timeEnd(\"setData\")\n\n            }\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    getData() {\n        const {len} = this;\n        return Object.assign({len}, this._);\n    }\n}\n\nexport default {};\nexport {\n    Rows,\n};\n","import helper from './helper';\n\nclass Cols {\n  constructor({\n    len, width, indexWidth, minWidth,\n  }) {\n    this._ = {};\n    this.len = len;\n    this.width = width;\n    this.indexWidth = indexWidth;\n    this.minWidth = minWidth;\n  }\n\n  setData(d) {\n    if (d.len) {\n      this.len = d.len;\n      delete d.len;\n    }\n    this._ = d;\n  }\n\n  getData() {\n    const { len } = this;\n    return Object.assign({ len }, this._);\n  }\n\n  getWidth(i) {\n    const col = this._[i];\n    if (col && col.width) {\n      return col.width;\n    }\n    return this.width;\n  }\n\n  getOrNew(ci) {\n    this._[ci] = this._[ci] || {};\n    return this._[ci];\n  }\n\n  setWidth(ci, width) {\n    const col = this.getOrNew(ci);\n    col.width = width;\n  }\n\n  setStyle(ci, style) {\n    const col = this.getOrNew(ci);\n    col.style = style;\n  }\n\n  sumWidth(min, max) {\n    return helper.rangeSum(min, max, i => this.getWidth(i));\n  }\n\n  totalWidth() {\n    return this.sumWidth(0, this.len);\n  }\n}\n\nexport default {};\nexport {\n  Cols,\n};\n","import { t } from '../locale/locale';\nimport helper from './helper';\n\nconst rules = {\n  phone: /^[1-9]\\d{10}$/,\n  email: /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/,\n};\n\nfunction returnMessage(flag, key, ...arg) {\n  let message = '';\n  if (!flag) {\n    message = t(`validation.${key}`, ...arg);\n  }\n  return [flag, message];\n}\n\nexport default class Validator {\n  // operator: b|nb|eq|neq|lt|lte|gt|gte\n  // type: date|number|list|phone|email\n  constructor(type, required, value, operator) {\n    this.required = required;\n    this.value = value;\n    this.type = type;\n    this.operator = operator;\n    this.message = '';\n  }\n\n  parseValue(v) {\n    const { type } = this;\n    if (type === 'date') {\n      return new Date(v);\n    }\n    if (type === 'number') {\n      return Number(v);\n    }\n    return v;\n  }\n\n  equals(other) {\n    let flag = this.type === other.type\n      && this.required === other.required\n      && this.operator === other.operator;\n    if (flag) {\n      if (Array.isArray(this.value)) {\n        flag = helper.arrayEquals(this.value, other.value);\n      } else {\n        flag = this.value === other.value;\n      }\n    }\n    return flag;\n  }\n\n  values() {\n    return this.value.split(',');\n  }\n\n  validate(v) {\n    const {\n      required, operator, value, type,\n    } = this;\n    if (required && /^\\s*$/.test(v)) {\n      return returnMessage(false, 'required');\n    }\n    if (/^\\s*$/.test(v)) return [true];\n    if (rules[type] && !rules[type].test(v)) {\n      return returnMessage(false, 'notMatch');\n    }\n    if (type === 'list') {\n      return returnMessage(this.values().includes(v), 'notIn');\n    }\n    if (operator) {\n      const v1 = this.parseValue(v);\n      if (operator === 'be') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 >= this.parseValue(min) && v1 <= this.parseValue(max),\n          'between',\n          min,\n          max,\n        );\n      }\n      if (operator === 'nbe') {\n        const [min, max] = value;\n        return returnMessage(\n          v1 < this.parseValue(min) || v1 > this.parseValue(max),\n          'notBetween',\n          min,\n          max,\n        );\n      }\n      if (operator === 'eq') {\n        return returnMessage(\n          v1 === this.parseValue(value),\n          'equal',\n          value,\n        );\n      }\n      if (operator === 'neq') {\n        return returnMessage(\n          v1 !== this.parseValue(value),\n          'notEqual',\n          value,\n        );\n      }\n      if (operator === 'lt') {\n        return returnMessage(\n          v1 < this.parseValue(value),\n          'lessThan',\n          value,\n        );\n      }\n      if (operator === 'lte') {\n        return returnMessage(\n          v1 <= this.parseValue(value),\n          'lessThanEqual',\n          value,\n        );\n      }\n      if (operator === 'gt') {\n        return returnMessage(\n          v1 > this.parseValue(value),\n          'greaterThan',\n          value,\n        );\n      }\n      if (operator === 'gte') {\n        return returnMessage(\n          v1 >= this.parseValue(value),\n          'greaterThanEqual',\n          value,\n        );\n      }\n    }\n    return [true];\n  }\n}\n","import Validator from './validator';\nimport { CellRange } from './cell_range';\n\nclass Validation {\n  constructor(mode, refs, validator) {\n    this.refs = refs;\n    this.mode = mode; // cell\n    this.validator = validator;\n  }\n\n  includes(ri, ci) {\n    const { refs } = this;\n    for (let i = 0; i < refs.length; i += 1) {\n      const cr = CellRange.valueOf(refs[i]);\n      if (cr.includes(ri, ci)) return true;\n    }\n    return false;\n  }\n\n  addRef(ref) {\n    this.remove(CellRange.valueOf(ref));\n    this.refs.push(ref);\n  }\n\n  remove(cellRange) {\n    const nrefs = [];\n    this.refs.forEach((it) => {\n      const cr = CellRange.valueOf(it);\n      if (cr.intersects(cellRange)) {\n        const crs = cr.difference(cellRange);\n        crs.forEach(it1 => nrefs.push(it1.toString()));\n      } else {\n        nrefs.push(it);\n      }\n    });\n    this.refs = nrefs;\n  }\n\n  getData() {\n    const { refs, mode, validator } = this;\n    const {\n      type, required, operator, value,\n    } = validator;\n    return {\n      refs, mode, type, required, operator, value,\n    };\n  }\n\n  static valueOf({\n    refs, mode, type, required, operator, value,\n  }) {\n    return new Validation(mode, refs, new Validator(type, required, value, operator));\n  }\n}\nclass Validations {\n  constructor() {\n    this._ = [];\n    // ri_ci: errMessage\n    this.errors = new Map();\n  }\n\n  getError(ri, ci) {\n    return this.errors.get(`${ri}_${ci}`);\n  }\n\n  validate(ri, ci, text) {\n    const v = this.get(ri, ci);\n    const key = `${ri}_${ci}`;\n    const { errors } = this;\n    if (v !== null) {\n      const [flag, message] = v.validator.validate(text);\n      if (!flag) {\n        errors.set(key, message);\n      } else {\n        errors.delete(key);\n      }\n    } else {\n      errors.delete(key);\n    }\n    return true;\n  }\n\n  // type: date|number|phone|email|list\n  // validator: { required, value, operator }\n  add(mode, ref, {\n    type, required, value, operator,\n  }) {\n    const validator = new Validator(\n      type, required, value, operator,\n    );\n    const v = this.getByValidator(validator);\n    if (v !== null) {\n      v.addRef(ref);\n    } else {\n      this._.push(new Validation(mode, [ref], validator));\n    }\n  }\n\n  getByValidator(validator) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.validator.equals(validator)) {\n        return v;\n      }\n    }\n    return null;\n  }\n\n  get(ri, ci) {\n    for (let i = 0; i < this._.length; i += 1) {\n      const v = this._[i];\n      if (v.includes(ri, ci)) return v;\n    }\n    return null;\n  }\n\n  remove(cellRange) {\n    this.each((it) => {\n      it.remove(cellRange);\n    });\n  }\n\n  each(cb) {\n    this._.forEach(it => cb(it));\n  }\n\n  getData() {\n    return this._.filter(it => it.refs.length > 0).map(it => it.getData());\n  }\n\n  setData(d) {\n    this._ = d.map(it => Validation.valueOf(it));\n  }\n}\n\nexport default {};\nexport {\n  Validations,\n};\n","export default class Moved {\n    constructor() {\n        this.range = null;\n        this.state = 'move';\n    }\n\n    move(cellRange) {\n        this.range = cellRange;\n        this.state = 'move';\n\n        return this;\n    }\n}","/* global window */\n\n// import {setColor} from \"../plug-in/revision\";\n\nlet removeEvent = [];\n\nexport function bind(target, name, fn) {\n    target.addEventListener(name, fn);\n    removeEvent.push({\n        name: name,\n        fn: fn,\n        target: target\n    })\n}\n\nexport function remove() {\n    for (let i = 0; i < removeEvent.length; i++) {\n        let re = removeEvent[i];\n        unbind(re.target, re.name, re.fn);\n    }\n}\n\nexport function unbind(target, name, fn) {\n    target.removeEventListener(name, fn);\n}\n\nexport function unbindClickoutside(el) {\n    if (el.xclickoutside) {\n        unbind(window.document.body, 'click', el.xclickoutside);\n        delete el.xclickoutside;\n    }\n}\n\nexport function createEvent(keyCode, metaKey, name = \"keydown\", buttons = -1) {\n    let event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventType = 'message';\n    event.buttons = buttons;\n    event.keyCode = keyCode;\n    event.metaKey = metaKey;\n    document.dispatchEvent(event);\n}\n\n// the left mouse button: mousedown → mouseup → click\n// the right mouse button: mousedown → contenxtmenu → mouseup\n// the right mouse button in firefox(>65.0): mousedown → contenxtmenu → mouseup → click on window\nexport function bindClickoutside(el, cb) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.detail === 2 || el.contains(evt.target)) return;\n        if (cb) cb(el);\n        else {\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'click', el.xclickoutside);\n}\n\nexport function bindClickoutside2(el, revision) {\n    el.xclickoutside = (evt) => {\n        // ignore double click\n        // console.log('evt:', evt);\n        if (evt.buttons === 2 || el.contains(evt.target)) return;\n        else {\n            // setColor.call(revision);\n            el.hide();\n            unbindClickoutside(el);\n        }\n    };\n    bind(window.document.body, 'mousedown', el.xclickoutside);\n}\n\nexport function mouseMoveUp(target, movefunc, upfunc) {\n    bind(target, 'mousemove', movefunc);\n    const t = target;\n    t.xEvtUp = (evt) => {\n        unbind(target, 'mousemove', movefunc);\n        unbind(target, 'mouseup', target.xEvtUp);\n        upfunc(evt);\n    };\n    bind(target, 'mouseup', target.xEvtUp);\n}\n\n\nfunction calTouchDirection(spanx, spany, evt, cb) {\n    let direction = '';\n    // console.log('spanx:', spanx, ', spany:', spany);\n    if (Math.abs(spanx) > Math.abs(spany)) {\n        // horizontal\n        direction = spanx > 0 ? 'right' : 'left';\n        cb(direction, spanx, evt);\n    } else {\n        // vertical\n        direction = spany > 0 ? 'down' : 'up';\n        cb(direction, spany, evt);\n    }\n}\n\n// cb = (direction, distance) => {}\nexport function bindTouch(target, {move, end}) {\n    let startx = 0;\n    let starty = 0;\n    bind(target, 'touchstart', (evt) => {\n        const {pageX, pageY} = evt.touches[0];\n        startx = pageX;\n        starty = pageY;\n    });\n    bind(target, 'touchmove', (evt) => {\n        if (!move) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        if (Math.abs(spanx) > 10 || Math.abs(spany) > 10) {\n            // console.log('spanx:', spanx, ', spany:', spany);\n            calTouchDirection(spanx, spany, evt, move);\n            startx = pageX;\n            starty = pageY;\n        }\n        evt.preventDefault();\n    });\n    bind(target, 'touchend', (evt) => {\n        if (!end) return;\n        const {pageX, pageY} = evt.changedTouches[0];\n        const spanx = pageX - startx;\n        const spany = pageY - starty;\n        calTouchDirection(spanx, spany, evt, end);\n    });\n}\n","/* global window */\nimport {h} from './element';\nimport {mouseMoveUp} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Resizer {\n    constructor(vertical = false, minDistance) {\n        this.moving = false;\n        this.vertical = vertical;\n        this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(\n            this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)\n                .on('mousedown.stop', evt => this.mousedownHandler(evt)),\n            this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),\n        ).hide();\n        // cell rect\n        this.cRect = null;\n        this.finishedFn = null;\n        this.minDistance = minDistance;\n    }\n\n    // rect : {top, left, width, height}\n    // line : {width, height}\n    show(rect, line) {\n        const {\n            moving, vertical, hoverEl, lineEl, el,\n        } = this;\n        if (moving) return;\n        this.cRect = rect;\n        const {\n            left, top, width, height,\n        } = rect;\n        el.offset({\n            left: vertical ? left + width - 5 : left,\n            top: vertical ? top : top + height - 5,\n        }).show();\n        hoverEl.offset({\n            width: vertical ? 5 : width,\n            height: vertical ? height : 5,\n        });\n        lineEl.offset({\n            width: vertical ? 0 : line.width,\n            height: vertical ? line.height : 0,\n        });\n    }\n\n    hide() {\n        this.el.offset({\n            left: 0,\n            top: 0,\n        }).hide();\n    }\n\n    mousedownHandler(evt) {\n        let startEvt = evt;\n        const {\n            el, lineEl, cRect, vertical, minDistance,\n        } = this;\n        let distance = vertical ? cRect.width : cRect.height;\n        // console.log('distance:', distance);\n        lineEl.show();\n        mouseMoveUp(window, (e) => {\n            this.moving = true;\n            if (startEvt !== null && e.buttons === 1) {\n                // console.log('top:', top, ', left:', top, ', cRect:', cRect);\n                if (vertical) {\n                    distance += e.movementX;\n                    if (distance > minDistance) {\n                        el.css('left', `${cRect.left + distance}px`);\n                    }\n                } else {\n                    distance += e.movementY;\n                    if (distance > minDistance) {\n                        el.css('top', `${cRect.top + distance}px`);\n                    }\n                }\n                startEvt = e;\n            }\n        }, () => {\n            startEvt = null;\n            lineEl.hide();\n            this.moving = false;\n            this.hide();\n            if (this.finishedFn) {\n                if (distance < minDistance) distance = minDistance;\n                this.finishedFn(cRect, distance);\n            }\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {moveArr} from \"../event/paste\";\n\nexport default class Scrollbar {\n    constructor(vertical) {\n        this.vertical = vertical;\n        this.moveFn = null;\n        this.el = h('div', `${cssPrefix}-scrollbar ${vertical ? 'vertical' : 'horizontal'}`)\n            .child(this.contentEl = h('div', ''))\n            .on('mousemove.stop', () => {\n            })\n            .on('scroll.stop', (evt) => {\n                let {scrollTop, scrollLeft} = evt.target;\n                // scrollTop = scrollTop * 2;\n                // moveArr.call(this.sheet, scrollTop, scrollLeft);\n                if (this.moveFn) {\n                    this.moveFn(this.vertical ? scrollTop : scrollLeft, evt);\n                }\n\n                // console.log('evt:::', evt);\n            });\n    }\n\n    move(v) {\n        // debugger\n        this.el.scroll(v);\n        return this;\n    }\n\n    scroll() {\n        return this.el.scroll();\n    }\n\n    set(distance, contentDistance) {\n        const d = distance - 1;\n        // console.log('distance:', distance, ', contentDistance:', contentDistance);\n        if (contentDistance > d) {\n            const cssKey = this.vertical ? 'height' : 'width';\n            this.el.css(cssKey, `${d - 15}px`).show();\n            this.contentEl\n                .css(this.vertical ? 'width' : 'height', '1px')\n                .css(cssKey, `${contentDistance}px`);\n        } else {\n            this.el.hide();\n        }\n        return this;\n    }\n}\n","import {CellRange} from \"../core/cell_range\";\nimport {cssPrefix} from \"../config\";\nimport {h} from \"./element\";\nimport {selectorHeightBorderWidth} from \"./selector\";\n\nexport default class SelectorCell {\n    constructor(data) {\n        this.el = h('div', `${cssPrefix}-selector-cell`);\n        this.data = data;\n        // this.direction = 1;     // 1 左上 2 右上 3左下 4右下\n        this._ = new CellRange(0, 0, 0, 0);\n    }\n\n    resetSelectOffset() {\n        let rect = this.data.getRect(this._);\n        this.setOffset(rect);\n    }\n\n    setData(ri, ci) {\n        ri = ri === -1 ? 0 : ri;\n        ci = ci === -1 ? 0 : ci;\n\n        let {data} = this;\n        let {merges} = data;\n\n        console.log(this._);\n        let enter = false;\n        merges.each(range => {\n            if (range.includeByRiCi(ri, ci)) {\n                this._ = range;\n                enter = true;\n            }\n        });\n\n        if (!enter) {\n            this._ = new CellRange(ri, ci, ri, ci);\n        }\n    }\n\n    toolbarChangeSelectorCell() {\n        let ri = this._.sri;\n        let ci = this._.sci;\n\n        this.setData(ri, ci);\n    }\n\n    setOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.el.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {xy2expr} from \"../core/alphabet\";\nimport {deepCopy} from '../core/operator';\nimport SelectorCell from \"./selector_cell\";\nimport CellProp from \"../model/cell_prop\";\n\nexport const selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n\n                } else {\n                    this.moveEvent(1);\n                }\n\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(2);\n                }\n            }).on('click', (evt) => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                }\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    evt.stopPropagation();\n                }\n                this.moveEvent(3);\n            })\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                if (evt.detail === 2) {\n                    evt.stopPropagation();\n                } else {\n                    this.moveEvent(4);\n                }\n            })\n\n\n        this.cornerEl.on('mousedown', evt => {\n            let {detail} = evt;\n            if (detail === 2) {\n                sheet.clickCopyPaste();\n                evt.stopPropagation();\n            }\n        });\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .children(this.cornerEl, this.boxinner).hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    border(value) {\n        this.areaEl.css('border', value);\n    }\n\n    longTimeBefore(time = 500) {\n        this.boxinner.hide();\n\n        setTimeout(() => {\n            this.boxinner.show();\n        }, time);\n    }\n\n    moveEvent(direction) {\n        console.log(60);\n        let {data, _selector, sheet,} = this;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = _selector.range;\n        let _cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let {selectorMoveEl} = sheet;\n        selectorMoveEl.set(-1, -1, true);\n        selectorMoveEl.hide();\n\n        mouseMoveUp(window, (e) => {\n            sheet.container.css('pointer-events', 'none');\n            _selector.setBoxinner(\"none\");\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri !== -1 && ci !== -1) {\n                cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                cellRange.move(ri, ci);\n                //     if(direction == 4) {\n                //         cellRange = new CellRange(eri, eci, eri, eci, w, h);\n                //     } else if(direction == 2) {\n                //         cellRange = new CellRange(sri, eci, eri, eci, w, h);\n                //     } else if(direction == 1) {\n                //         cellRange = new CellRange(sri, sci, eri, eci, w, h);\n                // }\n\n                const rect = data.getMoveRect(cellRange);\n                selectorMoveEl.range = cellRange;\n                selectorMoveEl.setMove(rect);\n                selectorMoveEl.el.show();\n            }\n        }, (e) => {\n            // 如果移动的内容被单元格包含，则需要变化\n            let {rows} = data;\n            let arr = [], arr2 = [], arr3 = [];\n\n            _cellRange.each((i, j) => {\n                console.log(rows.getCell(i, j), i, j);\n                let cell = rows.getCell(i, j);\n                let movedCell = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}:${xy2expr(j, i)}`);\n                let movedCell2 = new CellProp(i, j, deepCopy(cell || {}), `${xy2expr(j, i)}`);\n                arr.push(movedCell);\n                arr3.push(movedCell2);\n            });\n            cellRange.each((i, j) => {\n                let movedCell = new CellProp(i, j, deepCopy(rows.getCell(i, j) || {}), xy2expr(j, i));\n                arr2.push(movedCell);\n            });\n\n            data.cutPaste(_cellRange, cellRange, false);\n            sheet.container.css('pointer-events', 'auto');\n            _selector.setBoxinner(\"auto\");\n            selectorMoveEl.hide();\n\n            const rect = data.getMoveRect(cellRange);\n            selector.range = cellRange;\n            selector.ci = cellRange.sci;\n            selector.ri = cellRange.sri;\n\n            _selector.indexes = [selector.ri, selector.ci];\n            _selector.moveIndexes = [cellRange.sri, cellRange.sci];\n            _selector.range = cellRange;\n            _selector.setMove(rect);\n\n            sheet.selector.selectCell.setData(cellRange.sri, cellRange.sci);\n            // sheet.selectorMoveReset();\n\n            // 多个单元格\n            // if (_cellRange.eri != _cellRange.sri || _cellRange.eci != _cellRange.sci) {\n            //     let erpxArr = [];\n            //     let erpxArr2 = [];\n            //     let erpxArr3 = [];\n            //     for (let i = _cellRange.sci; i <= _cellRange.eci; i++) {\n            //         for (let j = _cellRange.sri; j <= _cellRange.eri; j++) {\n            //             erpxArr.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr.length; i++) {\n            //         for (let j = 0; j < erpxArr.length; j++) {\n            //             if (i <= j) {\n            //                 erpxArr2.push([i, j])\n            //             }\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr[a];\n            //         let a1 = erpxArr[b];\n            //         arr.push(`${a2}:${a1}`);\n            //         arr3.push(`${a2}:${a1}`);\n            //     }\n            //\n            //     for (let i = cellRange.sci; i <= cellRange.eci; i++) {\n            //         for (let j = cellRange.sri; j <= cellRange.eri; j++) {\n            //             erpxArr3.push(xy2expr(i, j));\n            //         }\n            //     }\n            //\n            //     for (let i = 0; i < erpxArr2.length; i++) {\n            //         let [a, b] = erpxArr2[i];\n            //\n            //         let a2 = erpxArr3[a];\n            //         let a1 = erpxArr3[b];\n            //\n            //         arr2.push(`${a2}:${a1}`);\n            //     }\n            //\n\n            // let {worker} = this;\n            // worker.terminate();\n            // worker = new Worker();\n            // worker.postMessage({ arr: arr, arr2: arr2, arr3: arr3, rows: rows });\n            //\n            // worker.onmessage = function (event) {\n            // };\n            //\n            // worker.addEventListener(\"message\", function (event) {\n            //     rows._ = event.data.rrows;\n            //     sheet.editor.display = true;\n            //     rows.moveChange(arr, arr2, arr3);\n            //     sheet.selectorMoveReset();\n            // });\n            console.time(\"move\")\n            rows.moveChange(arr, arr2, arr3);\n            console.timeEnd(\"move\")\n\n            sheet.selectorMoveReset();\n        });\n    }\n\n    setCss(b) {\n        this.areaEl.css('border', `2px dashed ${b}`);\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n\n        this.cornerEl.css(\"pointer-events\", pointer);\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class Selector {\n    constructor(data, sheet, sc = false) {\n        this.data = data;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.sheet = sheet;\n\n        // this.selectT = new SelectorElement(data, this, sheet);\n        // this.selectL = new SelectorElement(data, this, sheet);\n        // this.selectTl = new SelectorElement(data, this, sheet);\n\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        if (sc) {\n            this.selectCell = new SelectorCell(data, sc);\n            this.el.child(this.selectCell.el);\n        } else {\n            this.selectCell = new SelectorCell(data, sc);\n        }\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n\n    longTimeBefore() {\n        this.tl.longTimeBefore();\n        this.br.longTimeBefore();\n        this.t.longTimeBefore();\n        this.l.longTimeBefore();\n    }\n\n    setCss(b) {\n        this.br.setCss(b);\n        this.t.setCss(b);\n        this.l.setCss(b);\n        this.tl.setCss(b);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n\n        this.selectCell.resetSelectOffset();\n\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n\n\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n\n        this.resetOffset();\n    }\n\n    isMergeCell(ri, ci) {\n        let {data, state} = this.data.isMergeCell(ri, ci);\n        if (state) {\n            this.selectCell.eri = data.eri;\n            this.selectCell.eci = data.eci;\n        } else {\n            this.selectCell.eri = ri;\n            this.selectCell.eci = ci;\n        }\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        // this.resetSelectOffset(cellRange);\n\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    autoFilterRef() {\n        console.log(this.range);\n    }\n\n    setEnd(ri, ci, moving = true, enter = false) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            // if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci, sci, sri} = this.data.selector.range;\n        // 原因是 从右下角往左上角选中，然后ctrl + c 会有bug  加下面一行的原因\n        this.set(sri, sci);\n\n        this.setEnd(eri, eci, true, true);\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    //\n    showAutofill(ri, ci, pos) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n\n        // pos == 1 往下，pos == 3 往右， pos == 2 往左， pos == 4 往上\n        let drisc = 0;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        // console.log(srn, scn, ern, ecn, ri, ci);\n        if (pos == 2) {\n            drisc = 11;\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // console.log(this.arange);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (pos == 4) {\n            drisc = 22;\n\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (pos == 3) {\n            drisc = 33;\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (pos == 1) {\n            drisc = 44;\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return drisc;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n        return drisc;\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    showClipboard2(coffset) {\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {bind, bindClickoutside, createEvent, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport CellRange from \"../core/cell_range\";\n\nfunction inputMovePrev(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex -= 1;\n    if (this.itemIndex < 0) {\n        this.itemIndex = filterItems.length - 1;\n        this.el.el.scrollTop = this.el.el.scrollHeight;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputMoveNext(evt) {\n    evt.stopPropagation();\n    const {filterItems} = this;\n    if (filterItems.length <= 0 || filterItems.length < this.itemIndex) return;\n    if (this.itemIndex >= 0) filterItems[this.itemIndex].toggle();\n    this.itemIndex += 1;\n    if (this.itemIndex > filterItems.length - 1) {\n        this.itemIndex = 0;\n        this.el.el.scrollTop = 0;\n    }\n    this.el.el.scrollTop = (this.itemIndex - 9) * 33;\n    console.log(filterItems.length);\n    filterItems[this.itemIndex].toggle();\n}\n\nfunction inputEnter(evt) {\n    evt.preventDefault();\n    const {filterItems} = this;\n    if (filterItems.length <= 0) return;\n    evt.stopPropagation();\n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n        this.hide();\n             createEvent.call(this, 13, false);\n\n        return\n    };\n\n    filterItems[this.itemIndex].el.click();\n    this.hide();\n}\n\nfunction inputKeydownHandler(evt) {\n    const {keyCode} = evt;\n    if (evt.ctrlKey) {\n        evt.stopPropagation();\n    }\n    switch (keyCode) {\n        case 37: // left\n            evt.stopPropagation();\n            break;\n        case 38: // up\n            inputMovePrev.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 39: // right\n            evt.stopPropagation();\n            break;\n        case 40: // down\n            inputMoveNext.call(this, evt);\n            evt.stopPropagation();\n            break;\n        case 13: // enter\n            inputEnter.call(this, evt);\n            break;\n        case 9:\n            inputEnter.call(this, evt);\n            break;\n        default:\n            evt.stopPropagation();\n            break;\n    }\n}\n\nexport default class Suggest {\n    constructor(items, itemClick, data, editor, width = '200px') {\n        this.filterItems = [];\n        this.items = items;\n        this.data = data;\n        this.editor = editor;\n        this.el = h('div', `${cssPrefix}-suggest`)\n            .css('width', width)\n            .css('overflow-y', 'auto')\n            .css('max-height', '306px').hide();\n        this.el.attr('tabindex', 0);\n\n\n        this.itemClick = itemClick;\n        this.itemIndex = -1;\n        this.show = false;\n    }\n\n    setOffset(v) {\n        this.el.cssRemoveKeys('top', 'bottom')\n            .offset(v);\n    }\n\n    hide() {\n        const {el} = this;\n        this.filterItems = [];\n        this.itemIndex = -1;\n        el.hide();\n        this.show = false;\n        unbindClickoutside(this.el.parent());\n    }\n\n    setItems(items) {\n        this.items = items;\n        // this.search('');\n    }\n\n    search(word) {\n        let {items, data, editor} = this;\n        if (!/^\\s*$/.test(word)) {\n            items = items.filter(it => (it.key.toUpperCase() || it.toUpperCase()).startsWith(word.toUpperCase()));\n        }\n        items = items.map((it) => {\n            let {title} = it;\n            if (title) {\n                if (typeof title === 'function') {\n                    title = title();\n                }\n            } else {\n                title = it;\n            }\n            const item = h('div', `${cssPrefix}-item`)\n                .child(title)\n                .on('click.stop', () => {\n                    this.itemClick(it);\n                });\n            if (it.label) {\n                item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        this.filterItems = items;\n        if (items.length <= 0) {\n            this.hide();\n            this.show = false;\n            return;\n        }\n        const {el} = this;\n        // items[0].toggle();\n        let rect = data.getRect(new CellRange(editor.ri, editor.ci, editor.ri, editor.ci));\n        let left = rect.left + 55;\n        let top = rect.top + 50;\n\n        if( items.length >= 9 && rect.top - 306 >= 50) {\n            top -= 306;\n            top -= rect.height;\n        }\n        el.css('left', `${left}px`);\n        el.css('top', `${top}px`);\n\n        el.html('').children(...items).show();\n        this.show = true;\n        bindClickoutside(el.parent(), () => {\n            this.hide();\n            this.show = false;\n        });\n    }\n\n    bindInputEvents(input) {\n        input.on('keydown', evt => inputKeydownHandler.call(this, evt));\n    }\n}\n","import { Element, h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class Icon extends Element {\n  constructor(name) {\n    super('div', `${cssPrefix}-icon`);\n    this.iconNameEl = h('div', `${cssPrefix}-icon-img ${name}`);\n    this.child(this.iconNameEl);\n  }\n\n  setName(name) {\n    this.iconNameEl.className(`${cssPrefix}-icon-img ${name}`);\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport { t } from '../locale/locale';\n\nfunction addMonth(date, step) {\n  date.setMonth(date.getMonth() + step);\n}\n\nfunction weekday(date, index) {\n  const d = new Date(date);\n  d.setDate(index - date.getDay() + 1);\n  return d;\n}\n\nfunction monthDays(year, month, cdate) {\n  // the first day of month\n  const startDate = new Date(year, month, 1, 23, 59, 59);\n  const datess = [[], [], [], [], [], []];\n  for (let i = 0; i < 6; i += 1) {\n    for (let j = 0; j < 7; j += 1) {\n      const index = i * 7 + j;\n      const d = weekday(startDate, index);\n      const disabled = d.getMonth() !== month;\n      // console.log('d:', d, ', cdate:', cdate);\n      const active = d.getMonth() === cdate.getMonth() && d.getDate() === cdate.getDate();\n      datess[i][j] = { d, disabled, active };\n    }\n  }\n  return datess;\n}\n\nexport default class Calendar {\n  constructor(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n\n    this.headerLeftEl = h('div', 'calendar-header-left');\n    this.bodyEl = h('tbody', '');\n    this.buildAll();\n    this.el = h('div', 'fin-cell-calendar')\n      .children(\n        h('div', 'calendar-header').children(\n          this.headerLeftEl,\n          h('div', 'calendar-header-right').children(\n            h('a', 'calendar-prev')\n              .on('click.stop', () => this.prev())\n              .child(new Icon('chevron-left')),\n            h('a', 'calendar-next')\n              .on('click.stop', () => this.next())\n              .child(new Icon('chevron-right')),\n          ),\n        ),\n        h('table', 'calendar-body').children(\n          h('thead', '').child(\n            h('tr', '').children(\n              ...t('calendar.weeks').map(week => h('th', 'cell').child(week)),\n            ),\n          ),\n          this.bodyEl,\n        ),\n      );\n    this.selectChange = () => {};\n  }\n\n  setValue(value) {\n    this.value = value;\n    this.cvalue = new Date(value);\n    this.buildAll();\n  }\n\n  prev() {\n    const { value } = this;\n    addMonth(value, -1);\n    this.buildAll();\n  }\n\n  next() {\n    const { value } = this;\n    addMonth(value, 1);\n    this.buildAll();\n  }\n\n  buildAll() {\n    this.buildHeaderLeft();\n    this.buildBody();\n  }\n\n  buildHeaderLeft() {\n    const { value } = this;\n    this.headerLeftEl.html(`${t('calendar.months')[value.getMonth()]} ${value.getFullYear()}`);\n  }\n\n  buildBody() {\n    const { value, cvalue, bodyEl } = this;\n    const mDays = monthDays(value.getFullYear(), value.getMonth(), cvalue);\n    const trs = mDays.map((it) => {\n      const tds = it.map((it1) => {\n        let cls = 'cell';\n        if (it1.disabled) cls += ' disabled';\n        if (it1.active) cls += ' active';\n        return h('td', '').child(\n          h('div', cls)\n            .on('click.stop', () => {\n              this.selectChange(it1.d);\n            })\n            .child(it1.d.getDate().toString()),\n        );\n      });\n      return h('tr', '').children(...tds);\n    });\n    bodyEl.html('').children(...trs);\n  }\n}\n","import Calendar from './calendar';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\nimport {calendarPattern, str2Re} from \"../utils/reg_pattern\";\n\nexport default class Datepicker {\n  constructor() {\n    this.calendar = new Calendar(new Date());\n    this.el = h('div', `${cssPrefix}-datepicker`).child(\n      this.calendar.el,\n    ).hide();\n  }\n\n  setValue(date) {\n    // console.log(':::::::', date, typeof date, date instanceof string);\n    const { calendar } = this;\n    if (typeof date === 'string') {\n      // console.log(/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(date));\n      if (str2Re(calendarPattern).test(date)) { // jobs: todo: 正则表达式抽取出来\n        calendar.setValue(new Date(date.replace(new RegExp('-', 'g'), '/')));\n      }\n    } else if (date instanceof Date) {\n      calendar.setValue(date);\n    }\n    return this;\n  }\n\n  change(cb) {\n    this.calendar.selectChange = (d) => {\n      cb(d);\n      this.hide();\n    };\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n  }\n}\n","import {cssPrefix} from \"../config\";\nimport {h} from \"../component/element\";\nimport {helpFormula} from \"../core/operator\";\nimport {bind} from \"./event\";\n\nfunction variableElement(content, txt, pos, className, s = \"\", s2 = \"\") {\n    let item = h('div', className);\n    for (let i = 0; i < content[txt].length; i++) {\n        let ct = content[txt][i];\n        let {name, editor, index} = ct;\n\n        if (pos === i) {\n            item.child(h('span', s).child(name));\n        } else if (editor == true && pos >= index) {\n            item.child(h('span', s).child(name));\n        } else {\n            item.child(h('span', s2).child(name));\n        }\n    }\n\n    return item;\n}\n\nexport default class SuggestContent {\n    constructor(width = \"300px\") {\n        this.el = h('div', `${cssPrefix}-suggest-content`).css('width', width).css('z-index', \"10000\").css('position', \"absolute\").hide();\n        this.el.attr('tabindex', 0);\n        bind(this.el.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.el.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n    }\n\n    hide() {\n        const {el} = this;\n        el.hide();\n    }\n\n    content(cut = \"\", pos = -1) {\n        const {el} = this;\n\n        cut = cut.toUpperCase();\n        // cut 找到内容\n        let content = {};\n        Object.keys(helpFormula).forEach(i => {\n            if (i == cut) {\n                content = helpFormula[i];\n            }\n        });\n\n        if (!content || JSON.stringify(content) === '{}') {\n            return;\n        }\n\n        let items = [];\n        let title = variableElement.call(this, content, \"title\", pos, `${cssPrefix}-help-title`, `${cssPrefix}-help-span-title`, `${cssPrefix}-help-span2-title`);\n        let exampleName = h('div', `${cssPrefix}-help-section-title`).child(\"示例\");\n        let example = variableElement.call(this, content, \"example\", pos, `${cssPrefix}-help-section-content`, `${cssPrefix}-help-span3-title`);\n        items.push(...[title, exampleName, example]);\n        Object.keys(content.content).forEach(i => {\n            let c = content.content[i];\n            let item = h('div', `${cssPrefix}-help-section-title`).child(i);\n            let item2 = h('div', `${cssPrefix}-help-section-content`).child(c);\n            items.push(...[item, item2]);\n        });\n\n        el.html('').children(...items).show();\n    }\n}","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\nimport {cuttingByPos, cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {lockCells} from \"./formula_editor\";\nimport {CellRange} from \"../core/cell_range\";\nimport {mouseMoveUp} from \"./event\";\n\nexport default class SelectorMove {\n    constructor(boxinner, data, sheet, selector) {\n        this.l = h('div', `${cssPrefix}-selector-box-l-move-l`);\n        this.r = h('div', `${cssPrefix}-selector-box-l-move-r`);\n        this.t = h('div', `${cssPrefix}-selector-box-l-move-t`);\n        this.b = h('div', `${cssPrefix}-selector-box-l-move-b`);\n        this.data = data;\n        this.sheet = sheet;\n        this._selector = selector;\n\n        this.event(this.l, 1);\n        this.event(this.r, 2);\n        this.event(this.t, 3);\n        this.event(this.b, 4);\n        this.boxinner = boxinner;\n        this.boxinner.children(\n            this.l,\n            this.r,\n            this.t,\n            this.b,\n        );\n    }\n\n    find(str, cha, num) {\n        let x = str.lastIndexOf(cha);\n        // for (let i = 0; i < num; i++) {\n        //     x = str.indexOf(cha, x + 1);\n        // }\n        return x;\n    }\n\n    event(target, dict) {\n        let timer = null;\n        target.on('mousedown.stop', evt => {\n            let {data, sheet, _selector} = this;\n            let p = -1;\n            let {selector} = data;\n            let _move_selectors = null;\n            let {sri, sci, eri, eci, w, h} = selector.range;\n            let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n            let _cellRange = null;\n            let {selectors} = sheet;\n            let msri = -1, msci = -1, meri = -1, meci = -1;\n\n            mouseMoveUp(window, (e) => {\n                clearTimeout(timer);\n                timer = setTimeout(() => {\n                    sheet.container.css('pointer-events', 'none');\n                    for (let i = 0; i < selectors.length; i++) {\n                        let selector = selectors[i];\n                        selector.selector.setBoxinner(\"none\");\n                    }\n\n                    let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n                    if (ri != -1 && ci != -1) {\n                        let {  pos} = this.sheet.editor;\n                        let inputText = this.sheet.editor.editorText.getText();\n                        let _erpx = cuttingByPos(inputText, pos - 1, true);\n                        if (inputText.length > pos - 1) {\n                            let c = cuttingByPosEnd(inputText, pos - 1);\n                            _erpx += c;\n                        }\n                        for (let i = 0; i < selectors.length; i++) {\n                            let selector = selectors[i];\n                            let {className, erpx} = selector;\n\n                            if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n                                if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    cellRange.move(ri, ci);\n                                    const rect = data.getMoveRect(cellRange);\n                                    _move_selectors.selector.range = cellRange;\n                                    _move_selectors.selector.setMove(rect);\n                                } else {\n                                    _move_selectors.selector.set(ri, ci, true);\n                                }\n                                break;\n                            } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                                p = p != -1 ? p : this.find(inputText, selector.erpx, selector.index);\n                                this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                                _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                                if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                                    let arr = erpx.split(\":\");\n                                    let e1 = expr2xy(arr[0]);\n                                    let e2 = expr2xy(arr[1]);\n                                    cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                                    if (_cellRange === null) {\n                                        _cellRange = cellRange;\n                                    }\n                                    if (dict === 4) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        // console.log(cellRange, _cellRange);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                } else {\n                                    let e1 = expr2xy(selector.erpx);\n                                    let e2 = expr2xy(selector.erpx);\n                                    let args = data.getCellRectByXY(e.layerX, e.layerY);\n                                    if (dict === 4) {\n                                        cellRange.move2(e1[1], e1[0], args.ri, args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 1) {\n                                        cellRange.move2(e1[1], args.ci, args.ri, e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 3) {\n                                        cellRange.move2(args.ri, args.ci, e2[1], e2[0]);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    } else if (dict === 2) {\n                                        cellRange.move2(args.ri, e1[0], e2[1], args.ci);\n                                        const rect = data.getMoveRect(cellRange);\n                                        _move_selectors.selector.range = cellRange;\n                                        _move_selectors.selector.setMove(rect);\n                                    }\n                                }\n                                break;\n                            }\n                        }\n\n                        if (_move_selectors\n                            && (msri !== cellRange.sri\n                                || msci !== cellRange.sci\n                                || meri !== cellRange.eri\n                                || meci !== cellRange.eci)) {\n                            _move_selectors.selector.setCss(_move_selectors.color, false);\n                            lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                        }\n                        msri = cellRange.sri;\n                        msci = cellRange.sci;\n                        meri = cellRange.eri;\n                        meci = cellRange.eci;\n                    }\n                }, 6);\n            }, (e) => {\n                clearTimeout(timer);\n                let {selectors} = this.sheet;\n                sheet.container.css('pointer-events', 'auto');\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    selector.selector.setBoxinner(\"all\");\n                }\n                p = -1;\n                if (_move_selectors && _move_selectors.selector)\n                    _move_selectors.selector.setCss(_move_selectors.color, true)\n                _move_selectors = null;\n            })\n        });\n    }\n}","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {CellRange} from '../core/cell_range';\nimport {mouseMoveUp} from \"../component/event\";\nimport {lockCells} from \"../component/formula_editor\";\nimport {cuttingByPos} from \"../core/operator\";\nimport {expr2xy} from \"../core/alphabet\";\nimport {cuttingByPosEnd, isAbsoluteValue} from \"../core/operator\";\nimport SelectorMove from \"./selector_move\";\n\nconst selectorHeightBorderWidth = 2 * 2 - 1;\nlet startZIndex = 10;\n\nclass SelectorElement {\n    constructor(data, selector, sheet) {\n        // this.cornerEl = h('div', `${cssPrefix}-selector-corner`);\n        // this.box = h('div', `${cssPrefix}-selector-box`);\n        this.data = data;\n        this._selector = selector;\n        this.sheet = sheet;\n        this.l = h('div', `${cssPrefix}-selector-box-l`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.r = h('div', `${cssPrefix}-selector-box-r`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.t = h('div', `${cssPrefix}-selector-box-t`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n        this.b = h('div', `${cssPrefix}-selector-box-b`)\n            .on('mousedown.stop', evt => {\n                this.moveEvent(evt);\n            });\n\n\n        this.boxinner = h('div', `${cssPrefix}-selector-boxinner`)\n            .children(this.b, this.t, this.r, this.l);\n        this.selectorMove = new SelectorMove(this.boxinner, data, sheet, selector);\n        this.areaEl = h('div', `${cssPrefix}-selector-area`)\n            .child(this.boxinner)\n            .hide();            // this.boxinner\n        this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();\n        this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();\n        this.el = h('div', `${cssPrefix}-selector`)\n            .css('z-index', `${startZIndex}`)\n            .children(this.areaEl, this.clipboardEl, this.autofillEl)\n            .hide();\n        startZIndex += 1;\n    }\n\n    find(str, cha, num) {\n        let x = str.lastIndexOf(cha);\n        return x;\n    }\n\n    moveEvent(evt) {\n        let {data, _selector, sheet} = this;\n        let _move_selectors = null;\n        let {selector} = data;\n        let {sri, sci, eri, eci, w, h} = selector.range;\n        let cellRange = new CellRange(sri, sci, eri, eci, w, h);\n        let p = -1;\n        mouseMoveUp(window, (e) => {\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'none');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"none\");\n            }\n\n            let {ri, ci} = data.getCellRectByXY(e.layerX, e.layerY);\n            if (ri != -1 && ci != -1) {\n                let { pos} = this.sheet.editor;\n                let inputText = this.sheet.editor.editorText.getText();\n                let _erpx = cuttingByPos(inputText, pos - 1, true);\n                if (inputText.length > pos - 1) {\n                    let c = cuttingByPosEnd(inputText, pos - 1);\n                    _erpx += c;\n                }\n                for (let i = 0; i < selectors.length; i++) {\n                    let selector = selectors[i];\n                    let {className, erpx} = selector;\n\n                    if (erpx === _erpx && className === _selector.className + \" clear_selector\") {\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n                        if (erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    } else if (erpx !== _erpx && className === _selector.className + \" clear_selector\") {\n                        p = p != -1 ? p :this.find(inputText, selector.erpx, selector.index);\n                        this.sheet.editor.setCursorPos(p + selector.erpx.length);\n                        _move_selectors = _move_selectors ? _move_selectors : selector;\n\n                        if (selector.erpx.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n                            let arr = erpx.split(\":\");\n                            let e1 = expr2xy(arr[0]);\n                            let e2 = expr2xy(arr[1]);\n                            cellRange = new CellRange(e1[1], e1[0], e2[1], e2[0], w, h);\n                            cellRange.move(ri, ci);\n                            const rect = data.getMoveRect(cellRange);\n                            _move_selectors.selector.range = cellRange;\n                            _move_selectors.selector.setMove(rect);\n                        } else {\n                            _move_selectors.selector.set(ri, ci, true);\n                        }\n                        break;\n                    }\n                }\n                if (_move_selectors) {\n                    _move_selectors.selector.setCss(_move_selectors.color, false)\n                    lockCells.call(this.sheet, evt, _move_selectors, isAbsoluteValue(_move_selectors.erpx), p);\n                }\n            }\n        }, (e) => {\n            // 加这个的原因是  e.layerX, e.layerY， 如果不加的话 会点到单元格内的 xy坐标进行结算\n            let {selectors} = this.sheet;\n            sheet.container.css('pointer-events', 'auto');\n            for (let i = 0; i < selectors.length; i++) {\n                let selector = selectors[i];\n                selector.selector.setBoxinner(\"all\");\n            }\n            p = -1;\n            if (_move_selectors && _move_selectors.selector)\n                _move_selectors.selector.setCss(_move_selectors.color, true)\n            _move_selectors = null;\n        });\n    }\n\n    setBoxinner(pointer) {\n        this.l.css(\"pointer-events\", pointer);\n        this.r.css(\"pointer-events\", pointer);\n        this.t.css(\"pointer-events\", pointer);\n        this.b.css(\"pointer-events\", pointer);\n        this.selectorMove.l.css(\"pointer-events\", pointer);\n        this.selectorMove.r.css(\"pointer-events\", pointer);\n        this.selectorMove.t.css(\"pointer-events\", pointer);\n        this.selectorMove.b.css(\"pointer-events\", pointer);\n    }\n\n    setCss(b, key = true) {\n        if (!key) {\n            this.areaEl.css(\"border\", `2px solid ${b}`);\n        } else {\n            this.areaEl.css(\"border\", `2px dashed ${b}`);\n        }\n        this.el.css(\"z-index\", \"-1\");\n    }\n\n    setOffset(v) {\n        this.el.offset(v).show();\n        return this;\n    }\n\n    hide() {\n        this.el.hide();\n        return this;\n    }\n\n    setAreaOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.areaEl.offset({\n            width: width - selectorHeightBorderWidth + 0.8,\n            height: height - selectorHeightBorderWidth + 0.8,\n            left: left - 0.8,\n            top: top - 0.8,\n        }).show();\n    }\n\n    setClipboardOffset(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.clipboardEl.offset({\n            left,\n            top,\n            width: width - 5,\n            height: height - 5,\n        });\n    }\n\n    showAutofill(v) {\n        const {\n            left, top, width, height,\n        } = v;\n        this.autofillEl.offset({\n            width: width - selectorHeightBorderWidth,\n            height: height - selectorHeightBorderWidth,\n            left,\n            top,\n        }).show();\n    }\n\n    hideAutofill() {\n        this.autofillEl.hide();\n    }\n\n    showClipboard() {\n        this.clipboardEl.show();\n    }\n\n    hideClipboard() {\n        this.clipboardEl.hide();\n    }\n}\n\nfunction calBRAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, top, width, height, scroll, l, t,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    const ftheight = data.freezeTotalHeight();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    let top0 = top - ftheight;\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: left0,\n        top: top0,\n        width,\n        height,\n    };\n}\n\nfunction calTAreaOffset(offset) {\n    const {data} = this;\n    const {\n        left, width, height, l, t, scroll,\n    } = offset;\n    const ftwidth = data.freezeTotalWidth();\n    let left0 = left - ftwidth;\n    if (ftwidth > l) left0 -= scroll.x;\n    return {\n        left: left0, top: t, width, height,\n    };\n}\n\nfunction calLAreaOffset(offset) {\n    const {data} = this;\n    const {\n        top, width, height, l, t, scroll,\n    } = offset;\n    const ftheight = data.freezeTotalHeight();\n    let top0 = top - ftheight;\n    // console.log('ftheight:', ftheight, ', t:', t);\n    if (ftheight > t) top0 -= scroll.y;\n    return {\n        left: l, top: top0, width, height,\n    };\n}\n\nfunction setBRAreaOffset(offset) {\n    const {br} = this;\n    br.setAreaOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLAreaOffset(offset) {\n    const {tl} = this;\n    tl.setAreaOffset(offset);\n}\n\nfunction setTAreaOffset(offset) {\n    const {t} = this;\n    t.setAreaOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setLAreaOffset(offset) {\n    const {l} = this;\n    l.setAreaOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setLClipboardOffset(offset) {\n    const {l} = this;\n    l.setClipboardOffset(calLAreaOffset.call(this, offset));\n}\n\nfunction setBRClipboardOffset(offset) {\n    const {br} = this;\n    br.setClipboardOffset(calBRAreaOffset.call(this, offset));\n}\n\nfunction setTLClipboardOffset(offset) {\n    const {tl} = this;\n    tl.setClipboardOffset(offset);\n}\n\nfunction setTClipboardOffset(offset) {\n    const {t} = this;\n    t.setClipboardOffset(calTAreaOffset.call(this, offset));\n}\n\nfunction setAllAreaOffset(offset) {\n    setBRAreaOffset.call(this, offset);\n    setTLAreaOffset.call(this, offset);\n    setTAreaOffset.call(this, offset);\n    setLAreaOffset.call(this, offset);\n}\n\nfunction setAllClipboardOffset(offset) {\n    setBRClipboardOffset.call(this, offset);\n    setTLClipboardOffset.call(this, offset);\n    setTClipboardOffset.call(this, offset);\n    setLClipboardOffset.call(this, offset);\n}\n\nexport default class SelectorCopy {\n    constructor(data, sheet, className) {\n        this.data = data;\n        this.className = className;\n        this.br = new SelectorElement(data, this, sheet);\n        this.t = new SelectorElement(data, this, sheet);\n        this.l = new SelectorElement(data, this, sheet);\n        this.tl = new SelectorElement(data, this, sheet);\n        this.br.el.show();\n        this.offset = null;\n        this.areaOffset = null;\n        this.indexes = null;\n        this.range = null;\n        this.arange = null;\n        this.el = h('div', `${cssPrefix}-selectors`)\n            .children(\n                this.tl.el,\n                this.t.el,\n                this.l.el,\n                this.br.el,\n            ).hide();\n\n        // for performance\n        this.lastri = -1;\n        this.lastci = -1;\n\n        startZIndex += 1;\n    }\n\n    setCss(b, key = true) {\n        this.br.setCss(b, key);\n        this.t.setCss(b, key);\n        this.l.setCss(b, key);\n        this.tl.setCss(b, key);\n    }\n\n    hide() {\n        this.el.hide();\n    }\n\n    resetOffset() {\n        const {\n            data, tl, t, l, br,\n        } = this;\n        const freezeHeight = data.freezeTotalHeight();\n        const freezeWidth = data.freezeTotalWidth();\n        if (freezeHeight > 0 || freezeWidth > 0) {\n            tl.setOffset({width: freezeWidth, height: freezeHeight});\n            t.setOffset({left: freezeWidth, height: freezeHeight});\n            l.setOffset({top: freezeHeight, width: freezeWidth});\n            br.setOffset({left: freezeWidth, top: freezeHeight});\n        } else {\n            tl.hide();\n            t.hide();\n            l.hide();\n            br.setOffset({left: 0, top: 0});\n        }\n    }\n\n    resetAreaOffset() {\n        // console.log('offset:', offset);\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setAllAreaOffset.call(this, offset);\n        setAllClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRTAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setTAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setTClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetSelectorBRLAreaOffset(range) {\n        const offset = this.data.getMoveRect(range);\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    resetBRLAreaOffset() {\n        const offset = this.data.getSelectedRect();\n        const coffset = this.data.getClipboardRect();\n        setBRAreaOffset.call(this, offset);\n        setLAreaOffset.call(this, offset);\n        setBRClipboardOffset.call(this, coffset);\n        setLClipboardOffset.call(this, coffset);\n        this.resetOffset();\n    }\n\n    set(ri, ci, indexesUpdated = true) {\n        const {data} = this;\n        const cellRange = data.calSelectedRangeByStart(ri, ci);\n        const {sri, sci} = cellRange;\n        if (indexesUpdated) {\n            let [cri, cci] = [ri, ci];\n            if (ri < 0) cri = 0;\n            if (ci < 0) cci = 0;\n            data.selector.setIndexes(cri, cci);\n            this.indexes = [cri, cci];\n        }\n\n        this.moveIndexes = [sri, sci];\n        // this.sIndexes = sIndexes;\n        // this.eIndexes = eIndexes;\n        this.range = cellRange;\n        this.resetAreaOffset();\n        this.el.show();\n    }\n\n    setMove(rect) {\n        setAllAreaOffset.call(this, rect);\n    }\n\n    setEnd(ri, ci, moving = true) {\n        const {data, lastri, lastci} = this;\n        if (moving) {\n            if (ri === lastri && ci === lastci) return;\n            this.lastri = ri;\n            this.lastci = ci;\n        }\n        this.range = data.calSelectedRangeByEnd(ri, ci);\n\n        setAllAreaOffset.call(this, this.data.getSelectedRect());\n\n    }\n\n    setBoxinner(pointer) {\n        this.br.setBoxinner(pointer);\n        this.t.setBoxinner(pointer);\n        this.l.setBoxinner(pointer);\n        this.tl.setBoxinner(pointer);\n    }\n\n    reset() {\n        // console.log('::::', this.data);\n        const {eri, eci} = this.data.selector.range;\n        this.setEnd(eri, eci);\n    }\n\n    showAutofill(ri, ci) {\n        if (ri === -1 && ci === -1) return;\n        // console.log('ri:', ri, ', ci:', ci);\n        // const [sri, sci] = this.sIndexes;\n        // const [eri, eci] = this.eIndexes;\n        const {\n            sri, sci, eri, eci,\n        } = this.range;\n        const [nri, nci] = [ri, ci];\n        // const rn = eri - sri;\n        // const cn = eci - sci;\n        const srn = sri - ri;\n        const scn = sci - ci;\n        const ern = eri - ri;\n        const ecn = eci - ci;\n        if (scn > 0) {\n            // left\n            // console.log('left');\n            this.arange = new CellRange(sri, nci, eri, sci - 1);\n            // this.saIndexes = [sri, nci];\n            // this.eaIndexes = [eri, sci - 1];\n            // data.calRangeIndexes2(\n        } else if (srn > 0) {\n            // top\n            // console.log('top');\n            // nri = sri;\n            this.arange = new CellRange(nri, sci, sri - 1, eci);\n            // this.saIndexes = [nri, sci];\n            // this.eaIndexes = [sri - 1, eci];\n        } else if (ecn < 0) {\n            // right\n            // console.log('right');\n            // nci = eci;\n            this.arange = new CellRange(sri, eci + 1, eri, nci);\n            // this.saIndexes = [sri, eci + 1];\n            // this.eaIndexes = [eri, nci];\n        } else if (ern < 0) {\n            // bottom\n            // console.log('bottom');\n            // nri = eri;\n            this.arange = new CellRange(eri + 1, sci, nri, eci);\n            // this.saIndexes = [eri + 1, sci];\n            // this.eaIndexes = [nri, eci];\n        } else {\n            // console.log('else:');\n            this.arange = null;\n            // this.saIndexes = null;\n            // this.eaIndexes = null;\n            return;\n        }\n        if (this.arange !== null) {\n            // console.log(this.saIndexes, ':', this.eaIndexes);\n            const offset = this.data.getRect(this.arange);\n            offset.width += 2;\n            offset.height += 2;\n            const {\n                br, l, t, tl,\n            } = this;\n            br.showAutofill(calBRAreaOffset.call(this, offset));\n            l.showAutofill(calLAreaOffset.call(this, offset));\n            t.showAutofill(calTAreaOffset.call(this, offset));\n            tl.showAutofill(offset);\n        }\n    }\n\n    hideAutofill() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideAutofill();\n        });\n    }\n\n    showClipboard() {\n        const coffset = this.data.getClipboardRect();\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    showClipboard2(coffset) {\n        setAllClipboardOffset.call(this, coffset);\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].showClipboard();\n        });\n    }\n\n    hideClipboard() {\n        ['br', 'l', 't', 'tl'].forEach((property) => {\n            this[property].hideClipboard();\n        });\n    }\n}\n","import {h} from './element';\nimport {cssPrefix} from '../config';\n\nconst themeColorPlaceHolders = ['#ffffff', '#000100', '#e7e5e6', '#445569', '#5b9cd6', '#ed7d31', '#a5a5a5', '#ffc001', '#4371c6', '#71ae47'];\n\nconst themeColors = [\n    ['#f2f2f2', '#7f7f7f', '#d0cecf', '#d5dce4', '#deeaf6', '#fce5d5', '#ededed', '#fff2cd', '#d9e2f3', '#e3efd9'],\n    ['#d8d8d8', '#595959', '#afabac', '#adb8ca', '#bdd7ee', '#f7ccac', '#dbdbdb', '#ffe59a', '#b3c6e7', '#c5e0b3'],\n    ['#bfbfbf', '#3f3f3f', '#756f6f', '#8596b0', '#9cc2e6', '#f4b184', '#c9c9c9', '#fed964', '#8eaada', '#a7d08c'],\n    ['#a5a5a5', '#262626', '#3a3839', '#333f4f', '#2e75b5', '#c45a10', '#7b7b7b', '#bf8e01', '#2f5596', '#538136'],\n    ['#7f7f7f', '#0c0c0c', '#171516', '#222a35', '#1f4e7a', '#843c0a', '#525252', '#7e6000', '#203864', '#365624'],\n];\n\nconst selectColors = [\"#EE0000\", \"#8A2BE2\", \"#FF3E96\", \"#8B4500\", \"#3A5FCD\", \"#FF7F24\"];\n\nexport function selectorColor(index) {\n    index = index % selectColors.length;\n    return {\n        color: selectColors[index],\n        index: index,\n    };\n}\n\nconst standardColors = ['#c00000', '#fe0000', '#fdc101', '#ffff01', '#93d051', '#00b04e', '#01b0f1', '#0170c1', '#012060', '#7030a0'];\n\nfunction buildTd(bgcolor) {\n    let item = h('div', `${cssPrefix}-color-palette-cell`)\n        .on('click.stop', () => this.change(bgcolor))\n        .css('background-color', bgcolor);\n\n    this.items.push(\n        item\n    );\n    return h('td', '').child(item);\n}\n\nexport default class ColorPalette {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-color-palette`);\n        this.change = () => {\n        };\n        this.items = [];\n        const table = h('table', '').children(\n            h('tbody', '').children(\n                h('tr', `${cssPrefix}-theme-color-placeholders`).children(\n                    ...themeColorPlaceHolders.map(color => buildTd.call(this, color)),\n                ),\n                ...themeColors.map(it => h('tr', `${cssPrefix}-theme-colors`).children(\n                    ...it.map(color => buildTd.call(this, color)),\n                )),\n                h('tr', `${cssPrefix}-standard-colors`).children(\n                    ...standardColors.map(color => buildTd.call(this, color)),\n                ),\n            ),\n        );\n        this.el.child(table);\n    }\n}\n","import SelectorCopy from '../component/selector_copy';\nimport {\n    cutFirst,\n    cutStr,\n    cutting,\n    cutting2,\n    cuttingByPos,\n    isAbsoluteValue,\n    operation,\n    value2absolute,\n} from '../core/operator';\nimport {expr2xy, xy2expr} from '../core/alphabet';\nimport {selectorColor} from './color_palette';\nimport {h} from './element';\n\nfunction lockCells(evt, _selector, isAb = false, p = -1) {\n    const {data, editor} = this;\n    const {offsetX, offsetY} = evt;\n\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {ri, ci} = cellRect;\n\n    let { pos} = editor;\n    let inputText = editor.editorText.getText();\n    let input = '';\n\n    editor.handler(inputText);\n    const {mousedownIndex} = editor;\n    if (isAbsoluteValue(cuttingByPos(inputText, pos), 2) || _selector) {\n        if (_selector) {\n            const {\n                sri, sci, eri, eci,\n            } = _selector.selector.range;\n\n            const s1 = xy2expr(sci, sri);\n            const s2 = xy2expr(eci, eri);\n            let text = s1 == s2 ? s1 : `${s1}:${s2}`;\n\n            if (isAb == 2) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s1 == es2.s1 ? es1.s1 : `${es1.s1}:${es2.s1}`;\n            } else if (isAb == 1) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s2 == es2.s2 ? es1.s2 : `${es1.s2}:${es2.s2}`;\n            } else if (isAb == 3) {\n                const es1 = value2absolute(s1);\n                const es2 = value2absolute(s2);\n                text = es1.s3 == es2.s3 ? es1.s3 : `${es1.s3}:${es2.s3}`;\n            }\n            _selector.erpx = text;\n            let {isCors} = editor;\n            if (isCors) {\n                pos = 1;\n            }\n\n            let sp = p != -1 ? p : pos - cuttingByPos(inputText, pos).length;\n            input = inputText.substring(0, sp) + text + inputText.substring(pos, inputText.length);\n            editor.setText(input);\n            editor.setCursorPos(inputText.substring(0, sp).length + text.length);\n        } else {\n            // 此情况是例如: =A1  -> 这时再点A2  则变成: =A2\n            let enter = 0;\n            for (let i = 0; i < this.selectors.length && enter == 0; i++) {\n                const selector = this.selectors[i];\n                const {erpx} = selector;\n                if (erpx === cuttingByPos(inputText, pos)) {\n                    const {ri, ci} = cellRect;\n                    this.selectors[i].ri = ri;\n                    this.selectors[i].ci = ci;\n                    this.selectors[i].erpx = xy2expr(ci, ri);\n                    this.selectors[i].selector.set(ri, ci);\n                    input = `${inputText.substring(0, pos - erpx.length)}${xy2expr(ci, ri)}${inputText.substring(pos, inputText.length)}`;\n                    editor.setText(input);\n                    editor.setCursorPos(inputText.substring(0, pos - erpx.length).length + xy2expr(ci, ri).length);\n                    enter = 1;\n                }\n            }\n        }\n    } else if (mousedownIndex.length > 0) {\n        if (operation(mousedownIndex[1][0]) && isAbsoluteValue(cuttingByPos(mousedownIndex[1], mousedownIndex[1].length), 2)) {\n            editor.setLock(false);\n            return;\n        }\n\n        const args = makeSelector.call(this, ri, ci);\n        this.selectors.push(args);\n        input = `${mousedownIndex[0]}${xy2expr(ci, ri)}${mousedownIndex[1]}`;\n        const judgeText = input.substring(mousedownIndex[0].length + xy2expr(ci, ri).length, input.length);\n        // 不是的话，需要删除这个\n        let number = cutFirst(judgeText.substring(1));\n        if (operation(judgeText[0]) && !isAbsoluteValue(number, 2)) {\n            editor.setText(input);\n            editor.setMouseDownIndex([]);\n            return;\n        }\n        // 不是的话，需要删除这个\n        number = cutFirst(mousedownIndex[1]);\n\n        console.log(xy2expr(ci, ri));\n        const cut = cutStr(`${mousedownIndex[0]}${xy2expr(ci, ri)}+4${mousedownIndex[1]}`);\n        const {selectors_delete, selectors_new} = filterSelectors.call(this, cut);\n        Object.keys(selectors_delete).forEach((i) => {\n            const selector = selectors_delete[i];\n            selector.removeEl();\n        });\n\n        this.selectors = selectors_new;\n\n        input = input.replace(number, '');\n        editor.setText(input);\n        const content = suggestContent.call(this, pos - 1, cutting(inputText), inputText);\n        editor.setCursorPos(mousedownIndex[0].length + xy2expr(ci, ri).length);\n    } else {\n        const {pos} = editor;\n\n        const args = _selector || makeSelector.call(this, ri, ci);\n        if (pos != -1) {\n            let str = '';\n            let enter = false;\n            let step = pos;\n            let first = '';\n            for (let i = pos; i < inputText.length; i++) first += inputText[i];\n            let len = cutFirst(first).length;\n            for (let i = 0; i < inputText.length; i++) {\n                if (pos == i) {\n                    enter = true;\n                    str += xy2expr(ci, ri);\n                }\n\n                if (step == i && len > 0) {\n                    step += 1;\n                    len -= 1;\n                } else {\n                    str += inputText[i];\n                }\n            }\n\n            if (_selector) {\n                const {\n                    sri, sci, eri, eci,\n                } = data.selector.range;\n                const s1 = xy2expr(sci, sri);\n                const s2 = xy2expr(eci, eri);\n\n                input = s1 === s2 ? s1 : `${s1}:${s2}`;\n                str = !enter ? str += input : str;\n            } else {\n                console.log('121push');\n                this.selectors.push(args);\n                str = !enter ? str += xy2expr(ci, ri) : str;\n            }\n            editor.setText(str);\n            editor.setCursorPos(str.length);\n            editor.parse();\n        } else {\n            this.selectors.push(args);\n            input = `${inputText}${xy2expr(ci, ri)}`;\n            editor.setText(input);\n        }\n    }\n    editor.parse(editor.pos);\n    if (this.selectors.length > 0 || _selector) {\n        // const {inputText} = editor;\n        let inputText = editor.editorText.getText();\n        // 处理 合并单元格\n        let it = inputText, enter = false;\n        let {merges} = this.data;\n        Object.keys(merges._).forEach(i => {\n            let m = merges._[i];\n            const cut = cutStr(it, true);\n            for (let i = 0; i < cut.length; i++) {\n                if (cut[i].indexOf(\":\") != -1) {\n                    let a1 = cut[i].split(\":\")[0];\n                    let a2 = cut[i].split(\":\")[1];\n                    let e1 = expr2xy(a1);\n                    let e2 = expr2xy(a2);\n\n                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                        it = it.replace(new RegExp(cut[i], 'g'), a1);\n                        enter = true;\n                    }\n                }\n            }\n        });\n\n\n        // clearSelectors.call(this);\n        // console.log(it);\n        div2span.call(this, cutting(it), cutting2(it, this.selectors));\n        if (enter) {\n            setTimeout(() => {\n                editor.setCursorPos(it.length);\n            }, 10);\n        }\n    }\n    // step 3.  在enter或者点击的时候写入到cell中\n    // dataSetCellText.call(this, input, 'input');\n}\n\nfunction filterSelectors(cut) {\n    const selectors_new = [];\n    const selectors_delete = [];\n    Object.keys(this.selectors).forEach((i) => {\n        const selector = this.selectors[i];\n        const {erpx} = selector;\n        let enter = 0;\n        for (let i2 = 0; i2 < cut.length && enter === 0; i2++) {\n            if (cut[i2].replace(/\\$/g, '') === erpx) {\n                enter = 1;\n                selectors_new.push(selector);\n            }\n        }\n\n        if (enter == 0) {\n            selectors_delete.push(selector.selector.el);\n        }\n    });\n    return {\n        selectors_delete,\n        selectors_new,\n    };\n}\n\nfunction makeSelector(ri, ci, selectors = this.selectors, multiple = false, _selector, mergeSelector) {\n    const {data} = this;\n    let selector = null;\n    // const {inputText} = this.editor;\n    let inputText = this.editor.editorText.getText();\n    const {color, index} = selectorColor(selectors.length);\n    if (_selector) {\n        selector = _selector;\n    } else {\n        const className = `selector${parseInt(Math.random() * 999999)}`;\n        selector = new SelectorCopy(data, this, className);\n        selector.el.attr('class', `${className} clear_selector`);\n        selector.setCss(color);\n    }\n\n    if (multiple) {\n        if (mergeSelector) {\n            selector.setEnd(ri, ci);\n        } else {\n            selector.set(ri, ci, true);\n        }\n    } else {\n        selector.set(ri, ci, false);\n    }\n\n    selector.el.css('z-index', '100');\n    const len = inputText.split(xy2expr(ci, ri)).length - 2;\n\n    let it = xy2expr(ci, ri);\n    let {merges} = data;\n    Object.keys(merges._).forEach(i => {\n        let m = merges._[i];\n        const cut = cutStr(it, true);\n        for (let i = 0; i < cut.length; i++) {\n            if (cut[i].indexOf(\":\") != -1) {\n                let a1 = cut[i].split(\":\")[0];\n                let a2 = cut[i].split(\":\")[1];\n                let e1 = expr2xy(a1);\n                let e2 = expr2xy(a2);\n\n                if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                    it = it.replace(new RegExp(cut[i], 'g'), a1);\n                }\n            }\n        }\n    });\n\n    const args = {\n        ri,\n        ci,\n        index: len,\n        color,\n        index2: index,\n        className: selector.el.el.className,\n        erpx: it,\n        selector,\n    };\n    if (!mergeSelector) {\n        selector.el.show();\n        this.selectorsEl.child(selector.el);\n    }\n\n    if (multiple) {\n        return args;\n    }\n\n    this.selectorsEl.child(selector.el);\n    return args;\n}\n\nfunction clearSelectors() {\n    this.selectorsEl.html('');\n    this.selectors = [];\n    const {editor, selector} = this;\n    editor.setLock(false);\n\n    // // 这行是在 @~esc的时候加的 原因是要把ri ci赋值为-1\n    // editor.setRiCi(-1, -1);\n    editor.state = 1;\n    selector.el.show();\n}\n\n// 输入 input\nfunction editingSelectors(text = '') {\n    if (typeof text === 'number') {\n        return;\n    }\n    const selectors_new = [];\n    const cut = cutStr(text, true);\n    // case 1  过滤 selectors\n    const {selectors_delete} = filterSelectors.call(this, cut);\n\n    Object.keys(selectors_delete).forEach((i) => {\n        const selector = selectors_delete[i];\n        selector.removeEl();\n    });\n\n\n    const selectors_valid = selectors_new;\n    // case 2  验证 selectors\n    Object.keys(cut).forEach((i) => {\n        let enterCode = 1;\n        Object.keys(this.selectors).forEach((i) => {\n            const {selector} = this.selectors[i];\n            selector.el.removeEl();\n        });\n\n        // 绝对值\n        let arr = '';\n        let sc = cut[i].replace(/\\$/g, \"\");\n        if (isAbsoluteValue(cut[i])) {\n            const notTrueValue = cut[i].replace(/\\$/g, '');\n            arr = expr2xy(notTrueValue);\n        } else if (sc.search(/^[A-Za-z]+\\d+:[A-Za-z]+\\d+$/) != -1) {\n            enterCode = 2;\n        } else {\n            arr = expr2xy(cut[i]);\n        }\n\n        if (enterCode == 1) {\n            const ri = arr[1];\n            const\n                ci = arr[0];\n            const args = makeSelector.call(this, ri, ci, selectors_valid);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        } else if (enterCode == 2) {\n            const prx = cut[i].replace(/\\$/g, '').split(':')[0];\n            const lax = cut[i].replace(/\\$/g, '').split(':')[1];\n\n            const prx_index = expr2xy(prx);\n            const lax_index = expr2xy(lax);\n            let args = makeSelector.call(this, prx_index[1], prx_index[0], selectors_valid, true, null, false);\n            args = makeSelector.call(this, lax_index[1], lax_index[0], selectors_valid, true, args.selector, true);\n            args.erpx = cut[i];\n            selectors_valid.push(args);\n        }\n    });\n    this.selectors = selectors_valid;\n\n    if (this.selectors.length > 0 || text[0] == '=') {\n        div2span.call(this, cutting(text), cutting2(text, this.selectors));\n    }\n}\n\n// 找 ( 的index\nfunction findBracketLeft(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i - 1; j > 0 && stop == false; j--) {\n        if (cut[j] == '(') {\n            stop = true;\n        }\n        if (cut[j] == ')') {\n            has++;\n        }\n    }\n\n    for (let j = i; j > 0 && begin == -1; j--) {\n        if (cut[j] == '(') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n// => { left: 0, right: 0,  exist: false }\nfunction findBracket(pos, cut, text) {\n    let args = {left: 0, right: 0, exist: false};\n    if (text[pos] !== ')') {\n        return args;\n    }\n    const right = pos;\n    const left = findBracketLeft.call(this, cut, right);\n\n    if (left != -1 && right != -1) {\n        args = {left, right, exist: true};\n    }\n    return args;\n}\n\n\n// 找 ) 的 index\nfunction findBracketRight(cut, i) {\n    let begin = -1;\n    let has = 0;\n    let stop = false;\n\n    for (let j = i + 1; j < cut.length && stop == false; j++) {\n        if (cut[j] == ')') {\n            stop = true;\n        }\n        if (cut[j] == '(') {\n            has++;\n        }\n    }\n\n    for (let j = i; j < cut.length && begin == -1; j++) {\n        if (cut[j] == ')') {\n            if (has === 0) {\n                begin = j;\n            }\n            has--;\n        }\n    }\n\n    return begin;\n}\n\n\nfunction suggestContent(pos, cut, inputText) {\n    // 如果在括号内\n    // step 1. 找到距离pos最近的左、右括号的index\n    // step 2. 若1成立，找到该函数名\n    // step 3. 找光标前有几个逗号\n    const content = {suggestContent: false, cut: '', pos: 1};\n    const begin = pos - 1;\n    const left = findBracketLeft.call(this, cut, begin);\n    const right = findBracketRight.call(this, cut, left);\n\n    if (left <= begin && left != -1 && (right >= begin || right == -1)) {\n        content.suggestContent = true;\n        content.cut = cuttingByPos(inputText, left);\n    }\n\n    for (let i = left; i < begin + 1; i++) {\n        if (inputText[i] == ',') {\n            content.pos += 2;\n        }\n    }\n\n    return content;\n}\n\nfunction div2span(cut, cutcolor) {\n    const {editor} = this;\n\n    const spanArr = [];\n    let begin = -1;\n    let end = -1;\n\n    Object.keys(cut).forEach((i) => {\n        const spanEl = h('span', `formula_span${i}`);\n        Object.keys(cutcolor).forEach((i2) => {\n            if (cutcolor[i] && cutcolor[i].code !== -1 && cutcolor[i].data == cut[i]) {\n                const {color} = selectorColor(cutcolor[i].code);\n                spanEl.css('color', color);\n            }\n        });\n        spanEl.css('display', 'inline-block');\n        spanEl.css('cursor', 'text');\n\n        if (cut[i] == ' ') {\n            spanEl.html('&emsp;');\n        } else {\n            spanEl.html(cut[i]);\n        }\n\n        spanArr.push(spanEl);\n    });\n\n    // 高亮\n    const {pos} = editor;\n    let inputText = editor.editorText.getText();\n    let content = {suggestContent: false, cut: ''};\n    if (inputText[pos - 1] == ')') {\n        begin = pos - 1;\n        end = findBracketLeft.call(this, cut, begin);\n    } else {\n        content = suggestContent.call(this, pos + 1, cut, inputText);\n    }\n\n\n    if (inputText != '' && spanArr.length <= 0) {\n        const spanEl = h('span', 'formula_span');\n        spanArr.push(spanEl);\n    }\n    // 挂载\n    editor.mount2span(spanArr, begin, end, content);\n}\n\n\nexport {\n    lockCells,\n    clearSelectors,\n    editingSelectors,\n    findBracket,\n    suggestContent,\n    makeSelector,\n};\n","const baseFonts = [\n  { key: 'Arial', title: 'Arial' },\n  { key: 'Helvetica', title: 'Helvetica' },\n  { key: 'Source Sans Pro', title: 'Source Sans Pro' },\n  { key: 'Comic Sans MS', title: 'Comic Sans MS' },\n  { key: 'Courier New', title: 'Courier New' },\n  { key: 'Verdana', title: 'Verdana' },\n  { key: 'Lato', title: 'Lato' },\n];\n\nconst fontSizes = [\n  { pt: 7.5, px: 10 },\n  { pt: 8, px: 11 },\n  { pt: 9, px: 12 },\n  { pt: 10, px: 13 },\n  { pt: 10.5, px: 14 },\n  { pt: 11, px: 15 },\n  { pt: 12, px: 16 },\n  { pt: 14, px: 18.7 },\n  { pt: 15, px: 20 },\n  { pt: 16, px: 21.3 },\n  { pt: 18, px: 24 },\n  { pt: 22, px: 29.3 },\n  { pt: 24, px: 32 },\n  { pt: 26, px: 34.7 },\n  { pt: 36, px: 48 },\n  { pt: 42, px: 56 },\n  // { pt: 54, px: 71.7 },\n  // { pt: 63, px: 83.7 },\n  // { pt: 72, px: 95.6 },\n];\n\nfunction getFontSizePxByPt(pt) {\n  for (let i = 0; i < fontSizes.length; i += 1) {\n    const fontSize = fontSizes[i];\n    if (fontSize.pt === pt) {\n      return fontSize.px;\n    }\n  }\n  return pt;\n}\n\nconst fonts = (ary = []) => {\n  const map = {};\n  baseFonts.concat(ary).forEach((f) => {\n    map[f.key] = f;\n  });\n  return map;\n};\n\nexport default {};\nexport {\n  fontSizes,\n  fonts,\n  baseFonts,\n  getFontSizePxByPt,\n};\n","import {expr2xy, xy2expr} from './alphabet';\nimport {look, look2} from \"../config\";\n// import XLSX_CALC from \"calc\"\n// var formulajs = require('formulajs');\n// Converting infix expression to a suffix expression\n// src: AVERAGE(SUM(A1,A2), B1) + 50 + B20\n// return: [A1, A2], SUM[, B1],AVERAGE,50,+,B20,+\nconst infixExprToSuffixExpr = (src) => {\n    const operatorStack = [];\n    const stack = [];\n    let subStrs = []; // SUM, A1, B2, 50 ...\n    let fnArgType = 0; // 1 => , 2 => :\n    let fnArgsLen = 1; // A1,A2,A3...\n    for (let i = 0; i < src.length; i += 1) {\n        const c = src.charAt(i);\n        // console.log('c:', c);\n        if (c !== ' ') {\n            if (c >= 'a' && c <= 'z') {\n                subStrs.push(c.toUpperCase());\n            } else if ((c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z') || c === '.') {\n                subStrs.push(c);\n            } else if (c === '\"') {\n                i += 1;\n                while (src.charAt(i) !== '\"') {\n                    subStrs.push(src.charAt(i));\n                    i += 1;\n                }\n                stack.push(`\"${subStrs.join('')}`);\n                subStrs = [];\n            } else {\n                // console.log('subStrs:', subStrs.join(''), stack);\n                if (c !== '(' && subStrs.length > 0) {\n                    stack.push(subStrs.join(''));\n                }\n                if (c === ')') {\n                    let c1 = operatorStack.pop();\n                    if (fnArgType === 2) {\n                        // fn argument range => A1:B5\n                        try {\n                            const [ex, ey] = expr2xy(stack.pop());\n                            const [sx, sy] = expr2xy(stack.pop());\n                            // console.log('::', sx, sy, ex, ey);\n                            let rangelen = 0;\n                            for (let x = sx; x <= ex; x += 1) {\n                                for (let y = sy; y <= ey; y += 1) {\n                                    stack.push(xy2expr(x, y));\n                                    rangelen += 1;\n                                }\n                            }\n                            stack.push([c1, rangelen]);\n                        } catch (e) {\n                            // console.log(e);\n                        }\n                    } else if (fnArgType === 1) {\n                        // fn argument => A1,A2,B5\n                        stack.push([c1, fnArgsLen]);\n                        fnArgsLen = 1;\n                    } else {\n                        // console.log('c1:', c1, fnArgType, stack, operatorStack);\n                        while (c1 !== '(') {\n                            stack.push(c1);\n                            if (operatorStack.length <= 0) break;\n                            c1 = operatorStack.pop();\n                        }\n                    }\n                    fnArgType = 0;\n                } else if (c === ':') {\n                    fnArgType = 2;\n                } else if (c === ',') {\n                    fnArgType = 1;\n                    fnArgsLen += 1;\n                } else if (c === '(' && subStrs.length > 0) {\n                    // function\n                    operatorStack.push(subStrs.join(''));\n                } else {\n                    // priority: */ > +-\n                    // console.log(operatorStack, c, stack);\n                    if (operatorStack.length > 0 && (c === '+' || c === '-')) {\n                        let top = operatorStack[operatorStack.length - 1];\n                        if (top !== '(') stack.push(operatorStack.pop());\n                        if (top === '*' || top === '/') {\n                            while (operatorStack.length > 0) {\n                                top = operatorStack[operatorStack.length - 1];\n                                if (top !== '(') stack.push(operatorStack.pop());\n                                else break;\n                            }\n                        }\n                    }\n                    operatorStack.push(c);\n                }\n                subStrs = [];\n            }\n        }\n    }\n    if (subStrs.length > 0) {\n        stack.push(subStrs.join(''));\n    }\n    while (operatorStack.length > 0) {\n        stack.push(operatorStack.pop());\n    }\n    return stack;\n};\n\nconst evalSubExpr = (subExpr, cellRender) => {\n    if (!subExpr) {\n        subExpr = \"\";\n    }\n    if (subExpr[0] >= '0' && subExpr[0] <= '9') {\n        return Number(subExpr);\n    }\n    if (subExpr[0] === '\"') {\n        return subExpr.substring(1);\n    }\n    const [x, y] = expr2xy(subExpr);\n    return cellRender(x, y);\n};\n\n// evaluate the suffix expression\n// srcStack: <= infixExprToSufixExpr\n// formulaMap: {'SUM': {}, ...}\n// cellRender: (x, y) => {}\nconst evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {\n    const stack = [];\n    // console.log(':::::formulaMap:', formulaMap);\n    for (let i = 0; i < srcStack.length; i += 1) {\n        // console.log(':::>>>', srcStack[i]);\n        if (srcStack[i] === '+') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) + Number(top));\n        } else if (srcStack[i] === '-') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) - Number(top));\n        } else if (srcStack[i] === '*') {\n            stack.push(Number(stack.pop()) * Number(stack.pop()));\n        } else if (srcStack[i] === '/') {\n            const top = stack.pop();\n            stack.push(Number(stack.pop()) / Number(top));\n        } else if (Array.isArray(srcStack[i])) {\n            const [formula, len] = srcStack[i];\n            const params = [];\n            for (let j = 0; j < len; j += 1) {\n                params.push(stack.pop());\n            }\n            stack.push(formulaMap[formula].render(params.reverse()));\n        } else {\n            if (cellList.includes(srcStack[i])) {\n                return 0;\n            }\n            cellList.push(srcStack[i]);\n            let s = evalSubExpr(srcStack[i], cellRender)\n            stack.push(evalSubExpr(srcStack[i], cellRender));\n        }\n        // console.log('stack:', stack);\n    }\n    return stack[0];\n};\n\nfunction evalFormula(text, rule) {\n    if (typeof text !== 'string') {\n        return false;\n    }\n    if (text.toUpperCase().indexOf(rule.toUpperCase()) == -1) {\n        return false;\n    }\n    return true;\n}\n\nconst cellRender = (data, sheetbook, y, x, src, formulaMap, getCellText, cellList = []) => {\n    if (typeof src === 'undefined') {\n        return \"\";\n    }\n\n    if (typeof src === 'string' && look.indexOf(src.split(\"!\")[0]) != -1) {\n        let len = src.length;\n        if(src.split(\" \")[0]) {\n            len = src.split(\" \")[0].length;\n        }\n        let a = JSON.parse(src.substring(src.indexOf(\"!\") + 1, len));\n        let s = look.indexOf(src.split(\"!\")[0]);\n\n        if (s === 1) {\n            return a.text;\n        } else if (s === 0) {\n            if (a && a[0]) {\n                let {name, value} = a[0];\n\n                if (value === 0 && a[1] && a[1].value !== 0) {\n                    return name;\n                } else if (value === 0 && !a[1]) {\n                    return name;\n                }\n            }\n        }\n\n        return look2;\n    }\n\n    if (src[0] === '=' && src[1] !== '=') {\n        // console.log(\"156\", sheetbook.Sheets.Sheet1[xy2expr(x, y)], xy2expr(x, y))\n        if (evalFormula(src.substring(1), \"wland\") || evalFormula(src.substring(1), \"wfr\") || evalFormula(src.substring(1), \"rtd\")\n            || evalFormula(src.substring(1), \"city\")) {\n            // let {date_formula} = data.settings;=MD.RTD(\"sina\", \"162411\", \"now\")\n            // date_formula.wland(date_formula, data);\n            return src.toUpperCase();\n        } else if (src.substring(1) && sheetbook && sheetbook.Sheets && sheetbook.Sheets[data.name] && sheetbook.Sheets[data.name][xy2expr(x, y)]) {\n            // sheetbook.Sheets.Sheet1[xy2expr(x, y)].f = src.substring(1).toUpperCase();\n            // XLSX_CALC.import_functions(formulajs);\n            // XLSX_CALC(sheetbook);\n\n            if ((sheetbook.Sheets[data.name][xy2expr(x, y)].f && sheetbook.Sheets[data.name][xy2expr(x, y)].f.search(/\\((\\+|\\-|\\*|\\/)/) != -1) || sheetbook.Sheets[data.name][xy2expr(x, y)].v == undefined || sheetbook.Sheets[data.name][xy2expr(x, y)].v === \"\") {\n                return \"#ERROR!\";\n            }\n            sheetbook.Sheets[data.name][xy2expr(x, y)].v = sheetbook.Sheets[data.name][xy2expr(x, y)].v + \"\";\n\n            // let value = sheetbook.Sheets.Sheet1[xy2expr(x, y)].v ? sheetbook.Sheets.Sheet1[xy2expr(x, y)].v : \"NaN\";\n            return sheetbook.Sheets[data.name][xy2expr(x, y)].w ? sheetbook.Sheets[data.name][xy2expr(x, y)].w : sheetbook.Sheets[data.name][xy2expr(x, y)].v.replace(/'/g, \"\\\"\");\n        }\n        // const stack = infixExprToSuffixExpr(src.substring(1));\n        // if (stack.length <= 0) return src;\n\n        return src;\n    }\n    return src;\n};\n\nexport default {\n    render: cellRender,\n};\nexport {\n    infixExprToSuffixExpr,\n};\n","export const isMinus = (text) => {\n    if(isNaN(text)) {\n        return false;\n    } else if(text == \"\") {\n        return false;\n    }\n\n    if(parseInt(text) >= 0)\n        return false;\n\n    return true;\n};","/* global window */\nimport {isHave} from \"../core/helper\";\n\nfunction dpr() {\n    return window.devicePixelRatio || 1;       // 修改之后\n}\n\nfunction thinLineWidth() {\n    return dpr() - 0.5;\n}\n\nfunction npx(px) {\n    return parseInt(px * dpr(), 10);\n}\n\nfunction npxLine(px) {\n    const n = npx(px);\n    return n > 0 ? n - 0.5 : 0.5;\n}\n\nclass DrawBox {\n    constructor(x, y, w, h, padding = 0) {\n        this.x = x;\n        this.y = y;\n        this.width = w;\n        this.height = h;\n        this.padding = padding;\n        this.bgcolor = '#ffffff';\n        // border: [width, style, color]\n        this.borderTop = null;\n        this.borderRight = null;\n        this.borderBottom = null;\n        this.borderLeft = null;\n    }\n\n    setBorders({\n                   top, bottom, left, right,\n               }) {\n        if (top) this.borderTop = top;\n        if (right) this.borderRight = right;\n        if (bottom) this.borderBottom = bottom;\n        if (left) this.borderLeft = left;\n    }\n\n    innerWidth() {\n        return this.width - (this.padding * 2);\n    }\n\n    innerHeight() {\n        return this.height - (this.padding * 2);\n    }\n\n    textx(align) {\n        const {width, padding} = this;\n        let {x} = this;\n        if (align === 'left') {\n            x += padding;\n        } else if (align === 'center') {\n            x += width / 2;\n        } else if (align === 'right') {\n            x += width - padding;\n        }\n        return x;\n    }\n\n    texty(align, fontSize, hoffset) {\n        const {height, padding} = this;\n        let {y} = this;\n        if (align === 'top') {\n            y += padding;\n        } else if (align === 'middle') {\n            y = y + height / 2 - hoffset;\n            // y = y1;\n            // const y2 = y + padding + fontSize / 2 + 1;\n            // if (y1 < y2) y = y2;\n            // else y = y1;\n        } else if (align === 'bottom') {\n            y += height - hoffset * 2 - padding;\n        }\n        return y;\n    }\n\n    topxys() {\n        const {x, y, width} = this;\n        return [[x, y], [x + width, y]];\n    }\n\n    rightxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x + width, y], [x + width, y + height]];\n    }\n\n    bottomxys() {\n        const {\n            x, y, width, height,\n        } = this;\n        return [[x, y + height], [x + width, y + height]];\n    }\n\n    leftxys() {\n        const {\n            x, y, height,\n        } = this;\n        return [[x, y], [x, y + height]];\n    }\n}\n\nfunction drawFontLine(type, tx, ty, align, valign, blheight, blwidth) {\n    const floffset = {x: 0, y: 0};\n    if (type === 'underline') {\n        if (valign === 'bottom') {\n            floffset.y = 0;\n        } else if (valign === 'top') {\n            floffset.y = -(blheight + 2);\n        } else {\n            floffset.y = -blheight / 2;\n        }\n    } else if (type === 'strike') {\n        if (valign === 'bottom') {\n            floffset.y = blheight / 2;\n        } else if (valign === 'top') {\n            floffset.y = -((blheight / 2) + 2);\n        }\n    }\n\n    if (align === 'center') {\n        floffset.x = blwidth / 2;\n    } else if (align === 'right') {\n        floffset.x = blwidth;\n    }\n    this.line(\n        [tx - floffset.x, ty - floffset.y],\n        [tx - floffset.x + blwidth, ty - floffset.y],\n    );\n}\n\nclass Draw {\n    constructor(el, width, height) {\n        this.el = el;\n        this.ctx = el.getContext('2d');\n        this.resize(width, height);\n        this.ctx.scale(dpr(), dpr());\n        this.cxc = {\n            indent: 250,\n            vIndent: 200,\n            canvasContext: this.ctx\n        }\n\n    }\n\n    resize(width, height) {\n        // console.log('dpr:', dpr);\n        this.el.style.width = `${width}px`;\n        this.el.style.height = `${height}px`;\n        this.el.width = npx(width);\n        this.el.height = npx(height);\n    }\n\n    clear() {\n        const {width, height} = this.el;\n        this.ctx.clearRect(0, 0, width, height);\n        return this;\n    }\n\n    attr(options) {\n        Object.assign(this.ctx, options);\n        return this;\n    }\n\n    save() {\n        this.ctx.save();\n        this.ctx.beginPath();\n        return this;\n    }\n\n    restore() {\n        this.ctx.restore();\n        return this;\n    }\n\n    beginPath() {\n        this.ctx.beginPath();\n        return this;\n    }\n\n    translate(x, y) {\n        this.ctx.translate(npx(x), npx(y));\n        return this;\n    }\n\n    clearRect(x, y, w, h) {\n        this.ctx.clearRect(x, y, w, h);\n        return this;\n    }\n\n    fillRect(x, y, w, h) {\n        this.ctx.fillRect(npx(x) - 0.5, npx(y) - 0.5, npx(w), npx(h));\n        return this;\n    }\n\n    fillText(text, x, y) {\n        // this.ctx.font.size = 30;\n        // console.log(\"203:\", this.ctx.font);\n        this.ctx.fillText(text, npx(x), npx(y));\n        return this;\n    }\n\n    selfAdaptionHeight(box, txt, font) {\n        if (font == undefined || txt == undefined)\n            return;\n        let n = 1;\n        const textLine = {len: 0, start: 0};\n        let innerWidth = box.width - box.padding * 2;\n        for (let i = 0; i < txt.length; i += 1) {\n            if (textLine.len + box.padding >= innerWidth) {\n                n = n + 1;\n                textLine.len = 0;\n                textLine.start = i;\n            }\n            textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font, box);\n        }\n\n        return n;\n    }\n\n    selfAdaptionTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) == false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        const txtWidth = ctx.measureText(txt).width + box.padding * 2;\n        return txtWidth;\n    }\n\n    selfAdaptionOneTxtWidth(txt, font, box) {\n        if (isHave(txt) === false || isHave(font) == false || txt.length <= 0)\n            return 0;\n        const {ctx} = this;\n        ctx.font = `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`;\n\n        const txtWidth = ctx.measureText(txt).width;\n        return txtWidth;\n    }\n\n    /*\n      txt: render text\n      box: DrawBox\n      attr: {\n        align: left | center | right\n        valign: top | middle | bottom\n        color: '#333333',\n        strike: false,\n        font: {\n          name: 'Arial',\n          size: 14,\n          bold: false,\n          italic: false,\n        }\n      }\n      textWrap: text wrapping\n    */\n    text(txt, box, attr = {}, textWrap = true) {\n        const {ctx} = this;\n        const {\n            align, valign, font, color, strike, underline, ignore, cindex\n        } = attr;\n\n        const tx = box.textx(align);\n        ctx.save();\n        ctx.beginPath();\n\n        this.attr({\n            textAlign: align,\n            textBaseline: valign,\n            font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,\n            fillStyle: color,\n            strokeStyle: color,\n        });\n\n        let txtWidth = this.selfAdaptionTxtWidth(txt, font, box);\n        let hoffset = 0;\n        let innerWidth = box.innerWidth();\n        if (textWrap) {\n            innerWidth = box.width - box.padding * 2;\n            const n = this.selfAdaptionHeight(box, txt, font);\n            hoffset = ((n - 1) * font.size) / 2;\n            // for (let i = 0; i < ignore.length; i++) {\n            //     if (cindex != ignore[i]) {\n            //         // hoffset = 0;\n            //     } else if (cindex == ignore[i]) {\n            //     }\n            // }\n        }\n        let ty = box.texty(valign, font.size, hoffset);\n        if (textWrap && txtWidth > innerWidth) {\n            const textLine = {len: 0, start: 0};\n            for (let i = 0; i < txt.length; i += 1) {\n                if (textLine.len + box.padding >= innerWidth) {\n                    // debugger\n                    this.fillText(txt.substring(textLine.start, i), tx, ty);\n                    if (strike) {\n                        drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    if (underline) {\n                        drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                    }\n                    ty += font.size + 2;\n                    textLine.len = 0;\n                    textLine.start = i;\n                }\n                textLine.len += this.selfAdaptionOneTxtWidth(txt[i], font, box);\n            }\n            if (textLine.len > 0) {\n                this.fillText(txt.substring(textLine.start), tx, ty);\n                if (strike) {\n                    drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);\n                }\n                if (underline) {\n                    drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);\n                }\n            }\n        } else {\n            this.fillText(txt, tx, ty);\n            if (strike) {\n                drawFontLine.call(this, 'striket', tx, ty, align, valign, font.size, txtWidth);\n            }\n            if (underline) {\n                drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);\n            }\n        }\n        ctx.restore();\n        return this;\n    }\n\n    border(style, color) {\n        const {ctx} = this;\n        ctx.lineWidth = thinLineWidth;\n        ctx.strokeStyle = color;\n        // console.log('style:', style);\n        if (style === 'medium') {\n            ctx.lineWidth = npx(2) - 0.5;\n        } else if (style === 'thick') {\n            ctx.lineWidth = npx(3);\n        } else if (style === 'dashed') {\n            ctx.setLineDash([npx(3), npx(2)]);\n        } else if (style === 'dotted') {\n            ctx.setLineDash([npx(1), npx(1)]);\n        } else if (style === 'double') {\n            ctx.setLineDash([npx(2), 0]);\n        }\n        return this;\n    }\n\n    line(...xys) {\n        const {ctx} = this;\n        if (xys.length > 1) {\n            const [x, y] = xys[0];\n            ctx.moveTo(npxLine(x), npxLine(y));\n            for (let i = 1; i < xys.length; i += 1) {\n                const [x1, y1] = xys[i];\n                ctx.lineTo(npxLine(x1), npxLine(y1));\n            }\n            ctx.stroke();\n        }\n        return this;\n    }\n\n    strokeBorders(box) {\n        const {ctx} = this;\n        ctx.save();\n        ctx.beginPath();\n        // border\n        const {\n            borderTop, borderRight, borderBottom, borderLeft,\n        } = box;\n        if (borderTop) {\n            this.border(...borderTop);\n            // console.log('box.topxys:', box.topxys());\n            this.line(...box.topxys());\n        }\n        if (borderRight) {\n            this.border(...borderRight);\n            this.line(...box.rightxys());\n        }\n        if (borderBottom) {\n            this.border(...borderBottom);\n            this.line(...box.bottomxys());\n        }\n        if (borderLeft) {\n            this.border(...borderLeft);\n            this.line(...box.leftxys());\n        }\n        ctx.restore();\n    }\n\n    dropup(box, state, diff) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + 10;\n        const sy = y + height - 18 - diff;\n\n        // if (state) {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278539177.svg\";\n        // } else {\n        //   img.src = \"http://starimage.oss-cn-beijing.aliyuncs.com/2019418/1557278579742.svg\";\n        // }\n        // img.onload = function () {\n        //   ctx.drawImage(img, npx(sx), npx(sy), 16, 16);\n        // }\n        if (state) {\n            this.drawFlexTrue(ctx, npx(sx), npx(sy))\n        } else {\n            this.drawFlexFalse(ctx, npx(sx), npx(sy))\n        }\n    }\n\n\n    drawFlexFalse(ctx, sx, sy) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = \"#707070\";\n        ctx.moveTo(sx, sy + 6);\n        ctx.lineTo(sx + 12, sy + 6);\n        ctx.stroke();\n\n        ctx.strokeRect(sx, sy, 12, 12);\n        ctx.clip();\n        ctx.fill();\n        ctx.restore();\n    }\n\n    drawFlexTrue(ctx, sx, sy) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = \"#707070\";\n        ctx.moveTo(sx + 6, sy);\n        ctx.lineTo(sx + 6, sy + 12);\n        ctx.moveTo(sx, sy + 6);\n        ctx.lineTo(sx + 12, sy + 6);\n        ctx.stroke();\n\n        ctx.strokeRect(sx, sy, 12, 12);\n        ctx.clip();\n        ctx.fill();\n        ctx.restore();\n    }\n\n    translatex(x, y) {\n        this.cxc.canvasContext.translate(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    lineTo(x, y) {\n        this.cxc.canvasContext.lineTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    }\n\n    moveTo(x, y) {\n        this.cxc.canvasContext.moveTo(x + this.cxc.indent, y + this.cxc.vIndent);\n    };\n\n    bezierCurveTo(x, y, x1, y1, x2, y2) {\n        this.cxc.canvasContext.bezierCurveTo(\n            x + this.cxc.indent, y + this.cxc.vIndent,\n            x1 + this.cxc.indent, y1 + this.cxc.vIndent,\n            x2 + this.cxc.indent, y2 + this.cxc.vIndent);\n    }\n\n    dropdown(box) {\n        const {ctx} = this;\n        const {\n            x, y, width, height,\n        } = box;\n\n        const sx = x + width - 15;\n        const sy = y + height - 15;\n        console.log(\"350\", sy, sx)\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx), npx(sy));\n        ctx.lineTo(npx(sx + 8), npx(sy));\n        ctx.lineTo(npx(sx + 4), npx(sy + 6));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(0, 0, 0, .45)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    error(box) {\n        const {ctx} = this;\n        const {x, y, width} = box;\n        const sx = x + width - 1;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(npx(sx - 8), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y - 1));\n        ctx.lineTo(npx(sx), npx(y + 8));\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 0, 0, .65)';\n        ctx.fill();\n        ctx.restore();\n    }\n\n    rect(box, dtextcb) {\n        const {ctx} = this;\n        const {\n            x, y, width, height, bgcolor,\n        } = box;\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n\n    rect2(box, dtextcb, textwrap, cellText) {\n        const {ctx} = this;\n        const {\n            x, y, width, bgcolor,\n        } = box;\n        let {height} = box;\n        // if (textwrap == true) {\n        //     console.log(\"487\")\n        //     const n = this.selfAdaptionHeight(box, cellText);\n        //     height = height * n;\n        //     console.log(\"495\", height)\n        // }\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = bgcolor === \"rgba(0, 0, 0, 0)\" ? '#fff' : bgcolor || '#fff';\n        ctx.rect(npxLine(x + 1), npxLine(y + 1), npx(width - 2), npx(height - 2));\n        ctx.clip();\n        ctx.fill();\n        dtextcb();\n        ctx.restore();\n    }\n}\n\nexport default {};\nexport {\n    Draw,\n    DrawBox,\n    thinLineWidth,\n    npx,\n};\n","import {isHave} from \"../core/helper\";\n\nexport function testValid(valid = this.valid) {\n    if(isHave(valid)) {\n       valid.assert();\n    }\n}","import {expr2xy, stringAt, xy2expr} from '../core/alphabet';\nimport {getFontSizePxByPt} from '../core/font';\nimport _cell from '../core/cell';\nimport {formulam} from '../core/formula';\nimport {isMinus} from \"../utils/number_util\";\nimport {Draw, DrawBox, npx, thinLineWidth,} from '../canvas/draw';\nimport {look} from \"../config\";\nimport {deepCopy, distinct} from \"../core/operator\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n// import Worker from 'worker-loader!../external/Worker2.js';\n// gobal var\nconst cellPaddingWidth = 5;\nconst tableFixedHeaderCleanStyle = {fillStyle: '#f4f5f8'};\nconst tableGridStyle = {\n    fillStyle: '#fff',\n    lineWidth: thinLineWidth,\n    strokeStyle: '#e6e6e6',\n};\n\nfunction tableFixedHeaderStyle() {\n    return {\n        textAlign: 'center',\n        textBaseline: 'middle',\n        font: `500 ${npx(12)}px Source Sans Pro`,\n        fillStyle: '#585757',\n        lineWidth: thinLineWidth(),\n        strokeStyle: '#e6e6e6',\n    };\n}\n\nfunction getDrawBox(rindex, cindex) {\n    const {data} = this;\n    const {\n        left, top, width, height,\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\nfunction getAutoDrawBox(rindex, cindex, width) {\n    const {data} = this;\n    const {\n        left, top, height\n    } = data.cellRect(rindex, cindex);\n    return new DrawBox(left, top, width, height, cellPaddingWidth);\n}\n\nfunction getCellTextStyle(rindex, cindex) {\n    const {data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n\n    return style;\n}\n\nexport function toUpperCase(text) {\n    text = text.toString().toUpperCase();\n\n    return text;\n}\n\nfunction getChangeDataToCalc() {\n    let {data} = this;\n    let changeData = data.changeDataForCalc;\n    if (!isHave(changeData)) {\n        return {\n            \"state\": false,\n            \"data\": null,\n        }\n    } else {\n        return {\n            \"state\": true,\n            \"data\": changeData\n        }\n    }\n}\n\nfunction parseCell() {\n    let {data} = this;\n\n    let changeDataArgs = getChangeDataToCalc.call(this);\n    data.calc(data.rows, changeDataArgs.data);\n\n    if (changeDataArgs.state) {\n        data.changeDataForCalc = null;\n    }\n}\n\nexport function parseCell2(viewRange, state = false, src = '') {\n    let {data} = this;\n    let {calc, rows} = data;\n    let workbook = [];\n    workbook.Sheets = {};\n    workbook.Sheets[data.name] = {};\n\n    viewRange.each2((ri, ci) => {\n        let cell = data.getCell(ri, ci);\n        let expr = xy2expr(ci, ri);\n        if (cell && cell.text) {\n            cell.text = cell.text + \"\";\n            if (cell.text.indexOf(\"MD.RTD\") != -1) {\n                workbook.Sheets[data.name][expr] = {v: \"\", f: \"\"};\n            } else {\n                if (cell.text && cell.text.lastIndexOf(\"=\") === 0) {\n                    workbook.Sheets[data.name][expr] = {\n                        v: '',\n                        f: cell.text.replace(/ /g, '').replace(/\\\"/g, \"\\\"\").replace(/\\\"\\\"\\\"\\\"&/g, \"\\\"'\\\"&\")\n                    };\n                } else {\n                    workbook.Sheets[data.name][expr] = {\n                        v: cell.text.replace(/ /g, '').toUpperCase().replace(/\\\"/g, \"\\\"\"),\n                        f: ''\n                    };\n                }\n            }\n        }\n        else {\n            workbook.Sheets[data.name][expr] = {v: 0, f: 0};\n        }\n    });\n\n\n    if (state) {\n        workbook.Sheets[data.name]['A1'] = {v: '', f: `${src}`};\n    }\n\n    try {\n        calc(workbook);\n    } catch (e) {\n        console.error(e);\n    }\n    return workbook;\n}\n\nfunction specialStyle(text) {\n    text = text + \"\";\n    if (!text) {\n        return false;\n    }\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return true;\n    }\n    return false;\n}\n\nfunction renderCell(rindex, cindex) {\n    const {draw, data} = this;\n    const {sortedRowMap} = data;\n    let nrindex = rindex;\n    if (sortedRowMap.has(rindex)) {\n        nrindex = sortedRowMap.get(rindex);\n    }\n\n    const cell = data.getCell(nrindex, cindex);\n    if (!isHave(cell)) return;\n    // data.rows.setHeight(1, 50);\n\n    // console.log(rindex, nrindex, \"63\")\n    const style = data.getCellStyleOrDefault(nrindex, cindex);\n    const dbox = getDrawBox.call(this, rindex, cindex);\n    dbox.bgcolor = style.bgcolor;\n    if (style.border !== undefined) {\n        dbox.setBorders(style.border);\n        // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\n        draw.strokeBorders(dbox);\n    }\n\n    let cellText = \"\";\n\n    if (data.showEquation) {\n        if(isHave(cell.formulas)) {\n            cellText = cell.formulas;\n        }\n    } else if(isHave(cell.text)) {\n        cellText = cell.text;\n    }\n    draw.rect2(dbox, () => {\n        // render text\n        let args = data.renderFormat(style, cell, nrindex, cindex, false);\n        cellText = args.state ? args.cellText : cellText;\n        const font = Object.assign({}, style.font);\n\n        font.size = getFontSizePxByPt(font.size);\n        let {ignore, minus} = data.settings;\n        let color = style.color;\n        // console.log('style:', cellText);\n        if (minus == true && isMinus(cellText)) {\n            color = 'red'\n        }\n        let underline = style.underline;\n        let regex = /^http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?%&=]*)?$/;\n        cellText = cellText + \"\";\n        let text = cellText.substr(0, 3).toLowerCase() == \"www\" ? \"http://\" + cellText : cellText;\n        if (regex.test(text) || specialStyle(cell.text)) {\n            color = \"#4b89ff\";\n            underline = true;\n        }\n\n        draw.text(cellText, dbox, {\n            align: style.align,\n            valign: style.valign,\n            font,\n            color: color,\n            strike: style.strike,\n            underline: underline,\n            ignore: ignore,\n            cindex: cindex,\n        }, style.textwrap);\n        // error\n        const error = data.validations.getError(rindex, cindex);\n        if (error) {\n            draw.error(dbox);\n        }\n    }, style.textwrap, cellText);\n}\n\nfunction renderFlexible() {\n    const {draw, data} = this;\n    const {autoFilter} = data;\n    const {flex} = autoFilter;\n\n    for (let i = 0; i < flex.length; i++) {\n        let {ri, ci, state} = flex[i];\n        let s_t = 0;\n        for (let j = 0; j < i; j++) {\n            let {set_total, state} = flex[j];\n            if (state == true) {\n                s_t += set_total;\n            }\n        }\n\n        const dbox = getDrawBox.call(this, ri, ci);\n        draw.dropup(dbox, state, s_t * 25);\n    }\n\n    // const dbox = getDrawBox.call(this, ri, ci);\n    // draw.dropup(dbox);\n}\n\nfunction renderAutofilter(viewRange) {\n    const {data, draw} = this;\n    if (viewRange) {\n        const {autoFilter} = data;\n\n        if (!autoFilter.active()) {\n            return;\n        }\n        const afRange = autoFilter.hrange();\n        if (viewRange.intersects(afRange)) {\n            afRange.each((ri, ci) => {\n                console.log(ri, ci, 108)\n                const dbox = getDrawBox.call(this, ri, ci);\n                draw.dropdown(dbox);\n            });\n        }\n    }\n    // renderFlexible.call(this, 1, 1)\n}\n\nfunction renderContent(viewRange, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    draw.save();\n    draw.translate(fw, fh)\n        .translate(tx, ty);\n\n    const {exceptRowSet} = data;\n\n    const filteredTranslateFunc = (ri) => {\n        const ret = exceptRowSet.has(ri);\n        if (ret) {\n            const height = data.rows.getHeight(ri);\n            draw.translate(0, -height);\n        }\n        return !ret;\n    };\n    // 1 render cell\n    draw.save();\n\n    viewRange.each((ri, ci) => {\n        renderCell.call(this, ri, ci);\n    }, ri => filteredTranslateFunc(ri));\n    draw.restore();\n    // 2 render cell border\n    // draw.save();\n    // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));\n    // draw.restore();\n\n    // / bboxes = [];\n    // 3 render mergeCell\n    const rset = new Set();\n    draw.save();\n    data.eachMergesInView(viewRange, ({sri, sci, eri}) => {\n        if (!exceptRowSet.has(sri)) {\n            renderCell.call(this, sri, sci);\n        } else if (!rset.has(sri)) {\n            rset.add(sri);\n            const height = data.rows.sumHeight(sri, eri + 1);\n            draw.translate(0, -height);\n        }\n    });\n    draw.restore();\n\n\n    // 4 render autofilter\n    renderAutofilter.call(this, viewRange);\n\n    // 5 render flex\n    renderFlexible.call(this);\n\n    draw.restore();\n}\n\nfunction renderSelectedHeaderCell(x, y, w, h) {\n    const {draw} = this;\n    draw.save();\n    draw.attr({fillStyle: 'rgba(75, 137, 255, 0.08)'})\n        .fillRect(x, y, w, h);\n    draw.restore();\n}\n\n// viewRange\n// type: all | left | top\n// w: the fixed width of header\n// h: the fixed height of header\n// tx: moving distance on x-axis\n// ty: moving distance on y-axis\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\n    const {draw, data} = this;\n    const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\n    const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\n    const nty = ty + h;\n    const ntx = tx + w;\n\n    draw.save();\n    // draw rect background\n    draw.attr(tableFixedHeaderCleanStyle);\n    if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\n    if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\n\n    const {\n        sri, sci, eri, eci,\n    } = data.selector.range;\n    // console.log(data.selectIndexes);\n    // draw text\n    // text font, align...\n    draw.attr(tableFixedHeaderStyle());\n    // y-header-text\n    if (type === 'all' || type === 'left') {\n        data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\n            const y = nty + y1;\n            const ii = i;\n            draw.line([0, y], [w, y]);\n            if (sri <= ii && ii < eri + 1) {\n                renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\n            }\n            draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\n        });\n        draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\n        draw.line([w, nty], [w, sumHeight + nty]);\n    }\n    // x-header-text\n    if (type === 'all' || type === 'top') {\n        data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\n            const x = ntx + x1;\n            const ii = i;\n            draw.line([x, 0], [x, h]);\n            if (sci <= ii && ii < eci + 1) {\n                renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\n            }\n            draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\n        });\n        draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\n        draw.line([0, h], [sumWidth + ntx, h]);\n    }\n    draw.restore();\n}\n\nfunction renderFixedLeftTopCell(fw, fh) {\n    const {draw} = this;\n    draw.save();\n    // left-top-cell\n    draw.attr({fillStyle: '#f4f5f8'})\n        .fillRect(0, 0, fw, fh);\n    draw.restore();\n}\n\nfunction renderContentGrid({\n                               sri, sci, eri, eci, w, h,\n                           }, fw, fh, tx, ty) {\n    const {draw, data} = this;\n    const {settings} = data;\n\n    draw.save();\n    draw.attr(tableGridStyle)\n        .translate(fw + tx, fh + ty);\n    // const sumWidth = cols.sumWidth(sci, eci + 1);\n    // const sumHeight = rows.sumHeight(sri, eri + 1);\n    // console.log('sumWidth:', sumWidth);\n    draw.clearRect(0, 0, w, h);\n    if (!settings.showGrid) {\n        draw.restore();\n        return;\n    }\n    // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\n    data.rowEach(sri, eri, (i, y, ch) => {\n        // console.log('y:', y);\n        if (i !== sri) draw.line([0, y], [w, y]);\n        if (i === eri) draw.line([0, y + ch], [w, y + ch]);\n    });\n    data.colEach(sci, eci, (i, x, cw) => {\n        if (i !== sci) draw.line([x, 0], [x, h]);\n        if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\n    });\n    draw.restore();\n}\n\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\n    const {draw, data} = this;\n    const twidth = data.viewWidth() - fw;\n    const theight = data.viewHeight() - fh;\n    draw.save()\n        .translate(fw, fh)\n        .attr({strokeStyle: 'rgba(75, 137, 255, .6)'});\n    draw.line([0, fth], [twidth, fth]);\n    draw.line([ftw, 0], [ftw, theight]);\n    draw.restore();\n}\n\n/** end */\nclass Table {\n    constructor(el, data, editor) {\n        this.el = el;\n        this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\n        // this.factory = new ApplicationFactory(data.methods, data.name, this);\n        this.editor = editor;\n        this.data = data;\n        this.timer = null;\n        // this.worker = new Worker();\n        this.autoAdaptList = [];\n    }\n\n\n    getCellTextContent(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const cell = data.getCell(nrindex, cindex);\n        if (cell === null) return;\n        // console.log(\"62\", cell.adapt);\n\n        let cellText = _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\n        return cellText;\n    }\n\n    getDrawBox(rindex, cindex) {\n        const {data} = this;\n        const {\n            left, top, width, height,\n        } = data.cellRect(rindex, cindex);\n        return new DrawBox(left, top, width, height, cellPaddingWidth);\n    }\n\n    getCellTextStyle(rindex, cindex) {\n        const {data} = this;\n        const {sortedRowMap} = data;\n        let nrindex = rindex;\n        if (sortedRowMap.has(rindex)) {\n            nrindex = sortedRowMap.get(rindex);\n        }\n\n        const style = data.getCellStyleOrDefault(nrindex, cindex);\n\n        return style;\n    }\n\n\n    render() {\n        // resize canvas\n        const {data} = this;\n        const {rows, cols} = data;\n        let viewRange = data.viewRange();\n\n        parseCell.call(this);\n        this.clear();\n\n        this.draw.resize(data.viewWidth(), data.viewHeight());\n\n        const tx = data.freezeTotalWidth();\n        const ty = data.freezeTotalHeight();\n        const {x, y} = data.scroll;\n\n        // fixed width of header\n        const fw = cols.indexWidth;\n        // fixed height of header\n        let fh = rows.height;\n\n        renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\n\n        renderContent.call(this, viewRange, fw, fh, -x, -y);\n\n        renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\n\n        renderFixedLeftTopCell.call(this, fw, fh);\n\n        const [fri, fci] = data.freeze;\n        if (fri > 0 || fci > 0) {\n            // 2\n            if (fri > 0) {\n                const vr = viewRange.clone();\n                vr.sri = 0;\n                vr.eri = fri - 1;\n                vr.h = ty;\n                renderContentGrid.call(this, vr, fw, fh, tx, 0);\n                renderContent.call(this, vr, fw, fh, -x, 0);\n                renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\n            }\n            // 3x\n            if (fci > 0) {\n                const vr = viewRange.clone();\n                vr.sci = 0;\n                vr.eci = fci - 1;\n                vr.w = tx;\n                renderContentGrid.call(this, vr, fw, fh, 0, ty);\n                renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\n                renderContent.call(this, vr, fw, fh, 0, -y);\n            }\n            // 4\n            const freezeViewRange = data.freezeViewRange();\n            renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\n            renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\n            renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\n            // 5\n            renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\n        }\n        testValid.call(this);\n    }\n\n    clear() {\n        this.draw.clear();\n    }\n}\n\nexport default Table;\n","import {cuttingByPos, cuttingByPosEnd2, isAbsoluteValue, value2absolute} from \"../core/operator\";\nimport {toUpperCase} from \"./table\";\n\nexport default class EditorText {\n    constructor() {\n        this.inputText = \"\";\n        this.oldCell = \"\";\n        this.ri = -1;\n        this.ci = -1;\n    }\n\n    setText(text) {\n        this.inputText = text;\n        return this.getText();\n    }\n\n    getText() {\n        return this.inputText;\n    }\n\n    setOldCell(oldCell, {ri = -1, ci = -1} = -1) {\n        this.oldCell = oldCell;\n        this.ri = ri;\n        this.ci = ci;\n        return this.getOldCell();\n    }\n\n    setRICI(ri, ci) {\n       this.ri = ri;\n        this.ci = ci;\n    }\n\n    getOldCell() {\n        return this.oldCell;\n    }\n\n    getRICI() {\n        return {\n            \"ri\": this.ri,\n            \"ci\": this.ci,\n        };\n    }\n\n    changeText(type) {\n        if (type === 1) {\n            this.setText(this.getText().replace(/，/g, ','));\n        }\n    }\n\n    isFormula() {\n        let inputText = this.getText();\n        if (inputText.lastIndexOf(\"=\") == 0) {\n            return true;\n        }\n        return false;\n    }\n\n    f4ShortcutKey(pos) {\n        let inputText = this.setText(toUpperCase(this.inputText));\n        let value = cuttingByPos(inputText, pos, true);\n        let value2 = cuttingByPosEnd2(inputText, pos + 1);\n        console.log(value2);\n        let type = isAbsoluteValue(value, 5);\n        let d = \"\";\n        let n = \"\";\n        n = value.split(\":\")[1];\n        if (n) {\n            type = isAbsoluteValue(n, 5);\n            type = type === 3 ? 6 : type;\n            type = type === 12 ? 9 : type;\n            type = type === 1 ? 7 : type;\n            type = type === 2 ? 8 : type;\n            console.log(type);\n        }\n\n        if (type != false) {\n            switch (type) {\n                case 13:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    let text_b = inputText.substring(0, inputText.lastIndexOf(n));\n                    inputText = this.setText(text_b + d);\n                    break;\n                case 12:\n                    n = value;\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    console.log(value2absolute(value));\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    console.log(this.getText());\n                    break;\n                case 11:\n                case 10:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s3;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 9:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 8:\n                    n = value.split(\":\")[1];\n                    d = n.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 7:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 6:\n                    n = value.split(\":\")[1];\n                    d = value2absolute(n.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(n)) + d);\n                    break;\n                case 5:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 4:\n                    d = value2absolute(value.split(\":\")[1].replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 3:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s2;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 2:\n                    d = value.replace(/\\$/g, \"\");\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n                case 1:\n                    d = value2absolute(value.replace(/\\$/g, \"\")).s1;\n                    inputText = this.setText(inputText.substring(0, inputText.lastIndexOf(value)) + d);\n                    break;\n            }\n        }\n        let newPos = inputText.length;\n        inputText = this.setText(inputText + value2);\n        return {\n            \"pos\": newPos,\n            \"inputText\": inputText\n        };\n    }\n}\n","//* global window */\nimport {h} from './element';\nimport Suggest from './suggest';\nimport Datepicker from './datepicker';\nimport {cssPrefix} from '../config';\nimport {\n    cutting,\n    cuttingByPos,\n    cuttingByPos2,\n    cuttingByPosEnd,\n    deepCopy,\n    isAbsoluteValue,\n    operation\n} from '../core/operator';\nimport SuggestContent from './suggest_content';\nimport {findBracket, suggestContent} from './formula_editor';\nimport {createEvent} from './event';\nimport EditorText from \"./editor_text\";\nimport {testValid} from \"../utils/test\";\nimport {isHave} from \"../core/helper\";\n\nfunction resetTextareaSize() {\n    const {\n        textlineEl, textEl, areaOffset,\n    } = this;\n    if (!areaOffset) {\n        return;\n    }\n    const tlineWidth = textlineEl.offset().width + 9 + 15;\n    const maxWidth = this.viewFn().width - areaOffset.left - 9;\n    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);\n    if (tlineWidth > areaOffset.width && areaOffset.width != 0) {\n        let twidth = tlineWidth;\n        if (tlineWidth > maxWidth) {\n            twidth = maxWidth - 15;\n            let h1 = parseInt(tlineWidth / (maxWidth - 15), 10);\n            h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;\n            h1 *= this.rowHeight;\n            if (h1 > areaOffset.height) {\n                textEl.css('height', `${h1}px`);\n            }\n        }\n        textEl.css('width', `${twidth}px`);\n    }\n}\n\nfunction textFormat (e) {\n    e.preventDefault();\n    var text\n    var clp = (e.originalEvent || e).clipboardData\n    if (clp === undefined || clp === null) {\n        text = window.clipboardData.getData('text') || ''\n        if (text !== '') {\n            if (window.getSelection) {\n                var newNode = document.createElement('span')\n                newNode.innerHTML = text\n                window.getSelection().getRangeAt(0).insertNode(newNode)\n            } else {\n                document.selection.createRange().pasteHTML(text)\n            }\n        }\n    } else {\n        text = clp.getData('text/plain') || ''\n        if (text !== '') {\n            document.execCommand('insertText', false, text)\n        }\n    }\n}\n\nconst getCursortPosition = function (containerEl) {\n    let selection = window.getSelection();\n    if (selection.rangeCount <= 0) {\n        return 0;\n    }\n    const range = window.getSelection().getRangeAt(0);\n    const preSelectionRange = range.cloneRange();\n    preSelectionRange.selectNodeContents(this.textEl.el);\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n    const start = preSelectionRange.toString().length;\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    const {exist, left, right} = findBracket(start - 1, cutting(inputText), inputText);\n    Object.keys(this.spanArr).forEach((i) => {\n        this.spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n    });\n    const spanLeft = this.spanArr[left];\n    const spanRight = this.spanArr[right];\n    this.suggestContent.hide();\n    if (exist && spanLeft && spanRight) {\n        spanLeft.css('background-color', 'rgb(229, 229, 229)');\n        spanRight.css('background-color', 'rgb(229, 229, 229)');\n    } else {\n        const {show} = this.suggest;\n        const content = suggestContent.call(this, start, cutting(inputText), inputText);\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        }\n    }\n\n    return start;\n};\n\nfunction set_focus(el) {\n    if (!this) {\n        return;\n    }\n    const savedSel = {\n        start: this.pos,\n        end: this.pos,\n    };\n    let charIndex = 0;\n    const\n        range = document.createRange();\n    range.setStart(el, 0);\n    range.collapse(true);\n    const nodeStack = [el];\n    let node;\n    let foundStart = false;\n    let\n        stop = false;\n\n    while (!stop && (node = nodeStack.pop())) {\n        if (node.nodeType == 3) {\n            const nextCharIndex = charIndex + node.length;\n            if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\n                range.setStart(node, savedSel.start - charIndex);\n                foundStart = true;\n            }\n            if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\n                range.setEnd(node, savedSel.end - charIndex);\n                stop = true;\n            }\n            charIndex = nextCharIndex;\n        } else {\n            let i = node.childNodes.length;\n            while (i--) {\n                nodeStack.push(node.childNodes[i]);\n            }\n        }\n    }\n\n    const sel = window.getSelection();\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\nconst setCursorPosition = (elem, index) => {\n    const val = elem.value || elem.textContent;\n    const len = val.length;\n\n    // 超过文本长度直接返回\n    if (len < index) return;\n    set_focus.call(this, elem);\n};\n\nfunction mouseDownEventHandler(evt) {\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    this.pos = getCursortPosition.call(this, evt);\n    parse2.call(this, inputText, this.pos);\n}\n\nfunction setOldCell() {\n    let d = isDisplay.call(this);\n    if (d === false) {\n        let cell = this.data.getCell(this.ri, this.ci);\n        this.editorText.setOldCell(deepCopy(cell), {ri: this.ri, ci: this.ci});\n    }\n}\n\nfunction inputEventHandler(evt, txt = '', formulas = '', state = \"input\") {\n    setOldCell.call(this);\n\n    if (evt) {\n        const {\n            inputType,\n        } = evt;\n\n        if (inputType === 'insertFromPaste' && this.textEl.el.style['caret-color'] != 'black') {\n            this.copy = true;\n            return;\n        }\n\n        if (inputType === 'historyUndo') {\n            return;\n        }\n    }\n\n\n    let {editorText} = this;\n    let inputText = editorText.getText();\n\n    // if (inputText === '') {\n    //     const {data} = this;\n    //     const {history} = data;\n    //     history.add(data.getData());\n    // }\n\n    setTimeout(() => {\n        if (this.chinese == false) return;\n        let v = '';\n        if (this.data.settings.showEditor) {\n            this.sheet.selector.hide();\n        } else {\n            return;\n        }\n\n        if (txt == '' && evt && evt.target && evt.target.childNodes) {\n            let t1 = '';\n            for (let i = 0, len = evt.target.childNodes.length; i < len; i++) {\n                if (evt.target.childNodes[i].nodeType === 1) {\n                    v += evt.target.childNodes[i].innerText;\n                } else if (evt.target.childNodes[i].nodeType === 3) {\n                    t1 += evt.target.childNodes[i].nodeValue;\n                }\n            }\n            v = t1 !== '' ? t1 : v;\n        } else if(txt == '' && evt && isHave(evt.data)) {\n            v = evt.data !== '' ? evt.data : v;\n        } else{\n            v = txt;\n        }\n\n        if (this.copy) {\n            this.copy = false;\n            v = (evt && evt.data) ? evt.data : '';\n            this.textEl.html(v);\n            this.pos = v.length;\n            set_focus.call(this, this.textEl.el, -1);\n        }\n        this.changed = true;\n        const {\n            suggest, textlineEl, validator, textEl, save,\n        } = this;\n        editorText.setText(`${v}`);\n        // inputText = `${v}`;\n        editorText.changeText(1);\n        // inputText = inputText.replace(/，/g, ',');\n        this.pos = getCursortPosition.call(this, evt);\n\n        if (validator) {\n            if (validator.type === 'list') {\n                suggest.search(v);\n            } else {\n                suggest.hide();\n            }\n        } else {\n            v = v + \"\";\n            const start = v.lastIndexOf('=');\n            if (this.pos != -1) {\n                parse2.call(this, v, this.pos);\n            } else parse.call(this, v);\n            let show = false;\n            let cutValue = cuttingByPos2(v, this.pos, true);\n            if (v.length >= this.pos) {\n                const isNumber = `${v[this.pos]}`;\n                if (isNumber.search(/^[0-9]+.?[0-9]*$/) != -1) {\n                    show = true;\n                } else if (isNumber) {\n                    const c = cuttingByPosEnd(v, this.pos + 1);\n                    cutValue += c;\n                }\n            }\n\n            if (start === 0 && v.length > 1 && cutValue != '' && !show && cutValue.trim().length > 0) {\n                suggest.search(cutValue);\n            } else {\n                suggest.hide();\n            }\n        }\n\n\n        textlineEl.html(formulas || v);\n        editorText.setText(formulas || v);\n        this.suggest.itemIndex = -1;\n        resetTextareaSize.call(this);\n        if (v && v[0] !== '=') {\n            set_focus.call(this, textEl.el, -1);\n        }\n\n        if (formulas && formulas[0] === '=') {\n            v = formulas;\n        }\n        this.change(state, v);\n        testValid.call(this, this.valid2);\n        setTimeout(() => {\n            this.show();\n        });\n    });\n\n}\n\nfunction keyDownEventHandler(evt) {\n    this.pos = getCursortPosition.call(this, evt);\n    if (evt.code === 'ArrowRight') {\n        this.pos = this.pos + 1;\n    } else if (evt.code === 'ArrowLeft') {\n        this.pos = this.pos - 1;\n    }\n\n    const keyCode = evt.keyCode || evt.which;\n    // this.textEl.el.style['caret-color'] != 'black' 加这个主要防止用户在没有输入的情况下按下esc\n    if (keyCode == 27 && this.textEl.el.style['caret-color'] == 'black' && this.textEl.el.style.opacity == '1') {\n        this.change('input', '@~esc');\n    } else if (keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {\n    }\n}\n\nfunction parse(v) {\n    const start = v.lastIndexOf('=');\n\n\n    if (start === 0 && v.length >= 1 && operation(v[v.length - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length == 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, this.pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction parse2(v, pos) {\n    v = v + \"\";\n    const start = v.lastIndexOf('=');\n    if (start === 0 && v.length >= 1 && operation(v[pos - 1])) {\n        this.setLock(true);\n    } else {\n        this.setLock(false);\n        this.state = 2;\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    } else if (start === 0 && v.length == 1) {\n        this.setLock(true);\n    }\n\n    if (isAbsoluteValue(cuttingByPos(v, pos), 2)) {\n        this.setLock(true);\n    }\n\n    if (start !== 0) {\n        this.setLock(false);\n    }\n}\n\nfunction setTextareaRange(position) {\n    const {el} = this.textEl;\n    setTimeout(() => {\n        // el.focus();\n        set_focus.call(this, el);\n        // el.setSelectionRange(position, position);\n    }, 0);\n}\n\nfunction setText(text, position) {\n    const {textEl, textlineEl, tmp} = this;\n    // firefox bug\n    textEl.el.blur();\n    tmp.html(text);\n    textlineEl.html(text);\n    setTextareaRange.call(this, position);\n}\n\n\nfunction suggestItemClick(it) {\n    const {validator, editorText} = this;\n    let inputText = editorText.getText();\n    let position = 0;\n    if (validator && validator.type === 'list') {\n        // this.inputText = it;\n        inputText = editorText.setText(it);\n        position = inputText.length;\n    } else {\n        this.pos = getCursortPosition.call(this);\n        const begin = this.pos - cuttingByPos(inputText, this.pos).length;\n        const c = cuttingByPosEnd(inputText, this.pos + 1);\n        const arr = ['', ''];\n        const end = this.pos + c.length;\n        for (let i = 0; i < inputText.length; i++) {\n            if (i < begin) {\n                arr[0] += inputText[i];\n            }\n\n            if (i > end - 1) {\n                arr[1] += inputText[i];\n            }\n        }\n        inputText = editorText.setText(`${arr[0] + it.key}(`);\n        // this.inputText = `${arr[0] + it.key}(`;\n        this.pos = editorText.getText().length;\n        inputText = editorText.setText(inputText + `)${arr[1]}`);\n        // this.inputText += `)${arr[1]}`;\n    }\n    this.textEl.html(inputText);\n    this.textlineEl.html(inputText);\n    this.suggest.hide();\n    parse2.call(this, inputText, this.pos);\n    this.change('input', inputText);\n    set_focus.call(this, this.textEl.el, -1);\n    resetTextareaSize.call(this);\n}\n\nfunction resetSuggestContentItems() {\n    this.suggestContent.hide();\n}\n\nfunction resetSuggestItems() {\n    this.suggest.setItems(this.formulas);\n}\n\nfunction dateFormat(d) {\n    let month = d.getMonth() + 1;\n    let date = d.getDate();\n    if (month < 10) month = `0${month}`;\n    if (date < 10) date = `0${date}`;\n    return `${d.getFullYear()}-${month}-${date}`;\n}\n\nfunction isDisplay() {\n    if (this.textEl.el.style['caret-color'] == 'black'\n        && this.textEl.el.style.opacity == '1') return true;\n    return false;\n}\n\nexport default class Editor {\n    constructor(formulas, viewFn, rowHeight, rowWidth, data, sheet) {\n        this.viewFn = viewFn;\n        this.rowHeight = rowHeight;\n        this.formulas = formulas;\n        this.sheet = sheet;\n        this.display = true;\n        this.suggest = new Suggest(formulas, (it) => {\n            suggestItemClick.call(this, it);\n        }, data, this);\n        this.suggestContent = new SuggestContent();\n        this.lock = false;\n        this.state = 1;\n        this.data = data;\n        this.datepicker = new Datepicker();\n        this.isCors = false;\n        this.datepicker.change((d) => {\n            this.setText(dateFormat(d));\n            this.clear();\n        });\n        this.ri = -1;\n        this.ci = -1;\n        this.spanArr = [];\n        this.mousedownIndex = [];\n        this.changed = false;\n        this.chinese = true;\n\n        this.editorText = new EditorText('');\n\n        this.areaEl = h('div', `${cssPrefix}-editor-area`)\n            .children(\n                this.textEl = h('div', `${cssPrefix}-editor-textEl`)\n                    .on('input', evt => inputEventHandler.call(this, evt))\n                    .on('click', evt => mouseDownEventHandler.call(this, evt))\n                    .on('keyup', evt => keyDownEventHandler.call(this, evt))\n                    .on('mousedown', (evt) => {\n                        if (evt.detail == 2) {\n                            if (isDisplay.call(this)) {\n                                return;\n                            }\n                            this.show();\n                            setTimeout(() => {\n                                const {ri, ci} = this;\n                                console.log(ri, ci);\n                                this.setCellEnd(data.getSelectedCellRiCi(ri, ci));\n                            });\n                        }\n                    })\n                    .on('compositionstart', (evt) => {\n                        this.chinese = false;\n                    })\n                    .on('compositionend', (evt) => {\n                        this.chinese = true;\n                    })\n                    .on('paste', (evt) => {\n                        if (this.textEl.el.style['caret-color'] == 'black') {\n                            // createEvent.call(this, 67, true, \"paste\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('copy', (evt) => {\n                        if (this.textEl.el.style['caret-color'] == 'black') {\n                            // createEvent.call(this, 86, true, \"sheetCopy\");\n                            evt.stopPropagation();\n                        }\n                    })\n                    .on('keydown', (evt) => {\n                        resetTextareaSize.call(this);\n                        this.textlineEl.html(evt.currentTarget.innerText);\n                        const key_num = evt.keyCode;\n                        // ctrl + v 67     ctrl + v  86\n                        if (key_num === 38 || key_num === 40) {\n                            evt.preventDefault();\n                        }\n                        if (key_num === 115) {       // F4\n                            let {inputText, pos} = this.editorText.f4ShortcutKey(getCursortPosition.call(this));\n                            inputEventHandler.call(this, null, inputText, inputText);\n                            setTimeout(() => {\n                                this.pos = pos;\n                                set_focus.call(this, this.textEl.el, -1);\n                            });\n                            return;\n                        }\n                        if (this.textEl.el.style['caret-color'] == 'black') return;\n                        const {\n                            ctrlKey, metaKey,\n                        } = evt;\n\n                        if (key_num === 8 || key_num === 46) {\n                            createEvent.call(this, 8, false);\n                        } else if (key_num === 40) {\n                            this.clear();\n                            createEvent.call(this, 40, false);\n                        } else if (key_num === 39) {\n                            this.clear();\n                            createEvent.call(this, 39, false);\n                        } else if (key_num === 37) {\n                            this.clear();\n                            createEvent.call(this, 37, false);\n                        } else if (key_num === 38) {\n                            this.clear();\n                            createEvent.call(this, 38, false);\n                        } else if (ctrlKey || metaKey) {\n                            if (key_num === 67) {\n                                createEvent.call(this, 67, true);\n                            } else if (key_num === 86) {\n                                createEvent.call(this, 86, true);\n                            } else if (key_num === 88) {\n                                createEvent.call(this, 88, true);\n                            } else if (key_num === 90) {\n                                createEvent.call(this, 90, true);\n                            } else if (key_num === 66) {\n                                createEvent.call(this, 66, true);\n                            }\n                        }\n                    }),\n                this.textlineEl = h('div', 'textline'),\n                this.suggestContent.el,\n                this.datepicker.el,\n            )\n            .on('mousemove.stop', () => {\n            })\n            .on('mousedown.stop', () => {\n            });\n\n        sheet.el.child(this.suggest.el);\n        this.el = h('div', `${cssPrefix}-editor`)\n            .children(this.areaEl);\n        this.suggest.bindInputEvents(this.textEl);\n\n        this.textEl.on('paste', (evt) => {\n            if (isDisplay.call(this) === false)\n                return;\n            textFormat(evt);\n        });\n        this.tmp = h('span', 'span_tmp').hide();\n        this.textEl.attr('contenteditable', 'true');\n        this.textEl.css('width', `${rowWidth - 3}px`);\n        this.textEl.css('height', `${rowHeight - 2}px`);\n        this.textEl.child(this.tmp);\n        this.pos = 0;\n        this.areaOffset = null;\n        this.freeze = {w: 0, h: 0};\n        this.cell = null;\n\n        setTimeout(() => {\n            this.show(false);\n        });\n        this.change = () => {\n        };\n    }\n\n    setFreezeLengths(width, height) {\n        this.freeze.w = width;\n        this.freeze.h = height;\n    }\n\n    setMouseDownIndex(index) {\n        this.mousedownIndex = index;\n    }\n\n    setRiCi(ri, ci) {\n        this.ri = ri;\n        this.ci = ci;\n        if (this.ri === -1 || this.ci === -1) {\n            return;\n        }\n        // const cell = this.data.rows.getCell(ri, ci);\n        //\n        // this.editorText.setOldCell(deepCopy(cell));\n    }\n\n    setLock(lock) {\n        this.lock = lock;\n    }\n\n    getLock() {\n        return this.lock;\n    }\n\n\n    show(off = true) {\n\n        if (off && this.data.settings.showEditor) {\n            this.textEl.css('caret-color', 'black');\n            this.textEl.css('cursor', 'text');\n            this.textEl.css('opacity', '1');\n            this.textEl.el.focus();\n            this.areaEl.css('pointer-events', 'auto');\n            this.areaEl.css('border', '2px solid #4b89ff');\n            this.areaEl.css('background', 'white');\n        } else {\n            this.textEl.css('caret-color', 'white');\n            this.textEl.css('cursor', 'default');\n            this.textEl.css('opacity', '0');\n            this.textEl.el.blur();\n            this.areaEl.css('pointer-events', 'none');\n            this.areaEl.css('background', 'rgba(75, 137, 255, 0)');\n            this.areaEl.css('border', 'none');\n        }\n    }\n\n    parse(pos = -1) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n        if (pos != -1) {\n            this.pos = getCursortPosition.call(this);\n            parse2.call(this, inputText, this.pos);\n        } else {\n            parse.call(this, inputText);\n        }\n    }\n\n    clear(c = false) {\n\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        this.display = isDisplay.call(this);\n\n        if (inputText !== '' && isNaN(inputText) && inputText.replace(/\\s/g, \"\").lastIndexOf('¥') === 0) {\n            this.change('format', inputText);\n\n        } else if (this.changed) {\n\n            this.change('finish', inputText);\n\n        }\n\n        this.changed = false;\n        this.cell = null;\n        this.areaOffset = null;\n        inputText = editorText.setText('');\n        // this.inputText = '';\n        this.show(false);\n        this.copy = false;\n        set_focus.call(this, this.textEl.el, -1);\n        this.pos = 0;\n        this.tmp.hide();\n        this.textEl.html('');\n        this.textlineEl.html('');\n        resetSuggestContentItems.call(this);\n        resetSuggestItems.call(this);\n        this.datepicker.hide();\n\n        if (c) {\n            return false;\n        }\n\n        setTimeout(() => {\n            const {ri, ci} = this.data.selector;\n            this.setRiCi(ri, ci);\n        });\n\n        return this.display;\n    }\n\n    mount2span(spanArr, pos = -1, begin = -1, content = {suggestContent: false, cut: '', pos: -1}) {\n        if (this.spanArr === spanArr) {\n            return;\n        }\n\n        const {show} = this.suggest;\n        if (content.suggestContent && !show) {\n            this.suggestContent.content(content.cut, content.pos);\n        } else {\n            this.suggestContent.hide();\n        }\n        Object.keys(spanArr).forEach((i) => {\n            spanArr[i].css('background-color', 'rgba(255,255,255,0.1)');\n        });\n        if (pos !== '-1' && begin != -1 && spanArr[pos]) {\n            spanArr[pos].css('background-color', '#e5e5e5');\n            spanArr[begin].css('background-color', '#e5e5e5');\n        }\n\n        if (spanArr.length > 0) {\n            this.textEl.html('');\n            this.tmp = h('span', 'span_tmp').children(...spanArr)\n                .css('top', '0px').css('color', 'black').css('font-size', '14px').css('font-family', 'm-inconsolata,monospace,arial,sans,sans-serif');\n            this.textEl.el.insertBefore(this.tmp.el, this.textEl.el.childNodes[0]);\n            // this.textEl.el.removeChild(this.textEl.el.childNodes[this.textEl.el.childNodes.length - 1]);\n            set_focus.call(this, this.textEl.el, -1);\n        }\n\n        this.spanArr = spanArr;\n    }\n\n    handler(text) {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        const cursorPos = this.pos;\n        if (cursorPos >= inputText) {\n            this.setMouseDownIndex([]);\n            return;\n        }\n        const textBegin = text.substring(0, cursorPos);\n        const textEnd = text.substring(cursorPos, text.length);\n        parse.call(this, textBegin);\n        if (textEnd !== '') {\n            this.setMouseDownIndex([textBegin, textEnd]);\n        } else {\n            this.setMouseDownIndex([]);\n        }\n    }\n\n    setOffset(offset, suggestPosition = 'top', show = true) {\n        const {\n            textEl, areaEl, suggest, freeze, el,\n        } = this;\n        if (offset) {\n            this.areaOffset = offset;\n            const {\n                left, top, width, height, l, t,\n            } = offset;\n            // console.log('left:', left, ',top:', top, ', freeze:', freeze);\n            const elOffset = {left: 0, top: 0};\n            // top left\n            if (freeze.w > l && freeze.h > t) {\n                //\n            } else if (freeze.w < l && freeze.h < t) {\n                elOffset.left = freeze.w;\n                elOffset.top = freeze.h;\n            } else if (freeze.w > l) {\n                elOffset.top = freeze.h;\n            } else if (freeze.h > t) {\n                elOffset.left = freeze.w;\n            }\n\n            el.offset(elOffset);\n            areaEl.offset({left: left - elOffset.left - 0.8, top: top - elOffset.top - 0.8});\n            textEl.offset({width: width - 2 + 0.8, height: height - 3 + 0.8});\n            const sOffset = {left: 0};\n            sOffset[suggestPosition] = height;\n            // suggest.setOffset(sOffset);\n            suggest.hide();\n            resetTextareaSize.call(this);\n            if (show) {\n                this.show(false);\n            }\n        }\n    }\n\n    setCellEnd(cell) {\n        let text = '';\n        if(isHave(cell) && isHave(cell.text)) {\n            text = cell.text;\n        }\n\n        if(isHave(cell) && isHave(cell.formulas)) {\n            text = cell.formulas;\n        }\n\n        let {data} = this;\n        const style = data.getCellStyleOrDefault( this.ri, this.ci);\n        let args = data.renderFormat(style, cell, this.ri, this.ci, true);\n        text = args.state ? args.cellText : text;\n\n        this.textEl.child(text + \"\");\n        this.pos = text.length;\n        set_focus.call(this, this.textEl.el, -1);\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n\n        testValid.call(this);\n        inputEventHandler.call(this, null,  text, (cell && cell.formulas) || '', \"end\");\n\n        setTimeout(() => {\n            this.pos = data.rows.toString(text).length;\n            set_focus.call(this, this.textEl.el, -1);\n        }, 20)\n    }\n\n    setCell(cell, validator, type = 1) {\n        this.cell = cell;\n        this.show();\n\n        let text = (cell && cell.formulas) || '';\n        text = text == '' ? (cell && cell.text) || '' : text;\n\n        this.editorText.setOldCell({\n            text: (cell && cell.text) || '',\n            formulas: (cell && cell.formulas) || '',\n        }, {ri: this.ri, ci: this.ci});\n        const {el, datepicker, suggest} = this;\n        el.show();\n        this.textEl.show();\n        set_focus.call(this, this.textEl.el, -1);\n        setTimeout(() => {\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el);\n        }, 10);\n        this.validator = validator;\n        if (validator) {\n            const {type} = validator;\n            if (type === 'date') {\n                datepicker.show();\n                if (!/^\\s*$/.test(text)) {\n                    datepicker.setValue(text);\n                }\n            }\n            if (type === 'list') {\n                suggest.setItems(validator.values());\n                suggest.search('');\n            }\n        }\n\n        if (type == 2 && text != '' && text[0] == '=') {\n            inputEventHandler.call(this, null, text);\n            this.pos = text.length;\n            set_focus.call(this, this.textEl.el, text.length);\n        } else if (type == 2 && text[0] != '=') {\n            this.textEl.child(text);\n        }\n        setTimeout(() => {\n            this.textlineEl.html(text);\n            resetTextareaSize.call(this);\n        });\n    }\n\n    inputEventHandler(text = '', pos = 1, hide = false) {\n        if (hide) {\n            this.areaEl.hide();\n            this.sheet.selector.hide();\n            this.isCors = true;\n        }\n        this.setCursorPos(pos);\n        inputEventHandler.call(this, null, text);\n    }\n\n    isDisplay() {\n        let {editorText} = this;\n        let inputText = editorText.getText();\n\n        if (isDisplay.call(this) && editorText.isFormula())\n            return true;\n        else\n            return false\n    }\n\n    isDisplay2() {\n        if (isDisplay.call(this))\n            return true;\n        else\n            return false\n    }\n\n    setCursorPos(pos) {\n        this.pos = pos;\n        set_focus.call(this, this.textEl.el);\n    }\n\n    setText(text) {\n        let {editorText} = this;\n        editorText.setText(text);\n        // this.inputText = text;\n        setText.call(this, text, text.length);\n        resetTextareaSize.call(this);\n        this.textEl.child(this.tmp);\n    }\n}\n","import { h } from './element';\nimport { bindClickoutside, unbindClickoutside } from './event';\nimport { cssPrefix } from '../config';\nimport { tf } from '../locale/locale';\n\nconst menuItems = [\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\n  // { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\n  // { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\n  // { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\n  { key: 'divider' },\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\n  { key: 'divider' },\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\n  { key: 'divider' },\n  { key: 'validation', title: tf('contextmenu.validation') },\n];\n\nfunction buildMenuItem(item) {\n  if (item.key === 'divider') {\n    return h('div', `${cssPrefix}-item divider`);\n  }\n  return h('div', `${cssPrefix}-item`)\n    .on('click', (evt) => {\n      this.itemClick(item.key, evt);\n      this.hide();\n    })\n    .children(\n      item.title(),\n      h('div', 'label').child(item.label || ''),\n    );\n}\n\nfunction buildMenu() {\n  return menuItems.map(it => buildMenuItem.call(this, it));\n}\n\nexport default class ContextMenu {\n  constructor(viewFn, isHide = false) {\n    this.menus = buildMenu.call(this);\n    this.el = h('div', `${cssPrefix}-contextmenu`)\n      .children(...this.menus)\n      .hide();\n    this.viewFn = viewFn;\n    this.itemClick = () => {};\n    this.isHide = isHide;\n  }\n\n  hide() {\n    const { el } = this;\n    el.hide();\n    unbindClickoutside(el);\n  }\n\n  setPosition(x, y) {\n    if (this.isHide) return;\n    const { el } = this;\n    const { height, width } = el.show().offset();\n    const view = this.viewFn();\n    let top = y;\n    let left = x;\n    if (view.height - y <= height) {\n      top -= height;\n    }\n    if (view.width - x <= width) {\n      left -= width;\n    }\n    el.offset({ left, top });\n    bindClickoutside(el);\n  }\n}\n","import {Element, h} from './element';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\n\nexport default class Dropdown extends Element {\n    constructor(title, width, showArrow, placement, {type, change, arrowChange, historyBorder}, ...children) {\n        super('div', `${cssPrefix}-dropdown ${placement}`);\n\n        this.title = title;\n        this.change = () => {\n        };\n        if (typeof title === 'string') {\n            this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);\n        } else if (showArrow) {\n            this.title.addClass('arrow-left');\n        }\n        this.contentEl = h('div', `${cssPrefix}-dropdown-content`)\n            .children(...children)\n            .css('width', width)\n            .hide();\n\n        if (type) {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`).on('click', change);\n            this.headerEl.children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right_d`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`).on('click.stop', (evt) => {\n                        arrowChange(historyBorder);\n                        if (this.contentEl.css('display') !== 'block') {\n                            this.show();\n                        } else {\n                            this.hide();\n                        }\n                    }),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        } else {\n            this.headerEl = h('div', `${cssPrefix}-dropdown-header`);\n            this.headerEl.on('click', () => {\n                if (this.contentEl.css('display') !== 'block') {\n                    this.show();\n                } else {\n                    this.hide();\n                }\n            }).children(\n                this.title,\n                showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(\n                    h('div', `${cssPrefix}-icon-img arrow-down`),\n                ) : '',\n            );\n            this.children(this.headerEl, this.contentEl);\n        }\n    }\n\n    setTitle(title) {\n        this.title.html(title);\n        this.hide();\n    }\n\n    show() {\n        const {contentEl} = this;\n        contentEl.show();\n        this.parent().active();\n        bindClickoutside(this.parent(), () => {\n            this.hide();\n        });\n    }\n\n    hide() {\n        this.parent().active(false);\n        this.contentEl.hide();\n        unbindClickoutside(this.parent());\n    }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { baseFonts } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFont extends Dropdown {\n  constructor() {\n    const nfonts = baseFonts.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(it.title);\n        this.change(it);\n      })\n      .child(it.title));\n    super(baseFonts[0].title, '160px', true, 'bottom-left', {type: false}, ...nfonts );\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport { fontSizes } from '../core/font';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFontSize extends Dropdown {\n  constructor() {\n    const nfontSizes = fontSizes.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.setTitle(`${it.pt}`);\n        this.change(it);\n      })\n      .child(`${it.pt}`));\n    super('10', '60px', true, 'bottom-left', {type: false}, ...nfontSizes );\n  }\n}\n","import {tf} from '../locale/locale';\nimport {isHave, isNumber} from \"./helper\";\n\nconst formatStringRender = v => v;\n\nconst formatNumberRender = (v, fixed = 2) => {\n    if(!isHave(v) || !isNumber(v)) {\n        return v;\n    }\n    if (/^(-?\\d*.?\\d*)$/.test(v)) {\n        const v1 = fixed === -1 ? v.toString() : Number(v).toFixed(fixed).toString();\n        const [first, ...parts] = v1.split('\\\\.');\n        let value = first.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1');\n        return value === 'NaN' ? v : value;\n    }\n\n    return v === 'NaN' ? v : v;\n};\n\nconst baseFormats = [\n    {\n        key: 'normal',\n        title: tf('format.normal'),\n        type: 'string',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'text',\n    //     title: tf('format.text'),\n    //     type: 'string',\n    //     render: formatStringRender,\n    // },\n    {\n        key: 'number',\n        title: tf('format.number'),\n        type: 'number',\n        label: '1,000.12',\n        render: formatNumberRender,\n    },\n    {\n        key: 'percent',\n        title: tf('format.percent'),\n        type: 'number',\n        label: '10.12%',\n        render: (v) => {\n            const a = multiply(v, 100);\n            const a_s = `${a}`;\n            return `${a_s}%`;\n        },\n    },\n    {\n        key: 'rmb',\n        title: tf('format.rmb'),\n        type: 'number',\n        label: '￥10.00',\n        render: v => `￥${formatNumberRender(v)}`,\n    },\n    // {\n    //     key: 'usd',\n    //     title: tf('format.usd'),\n    //     type: 'number',\n    //     label: '$10.00',\n    //     render: v => `$${formatNumberRender(v)}`,\n    // },\n    {\n        key: 'date',\n        title: tf('format.date'),\n        type: 'date',\n        label: '2009-01-01',\n        render: formatStringRender,\n    },\n    {\n        key: 'datetime',\n        title: tf('format.datetime'),\n        type: 'datetime',\n        label: '2009年01月01日',\n        render: formatStringRender,\n    },\n    // {\n    //     key: 'time',\n    //     title: tf('format.time'),\n    //     type: 'date',\n    //     label: '15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'datetime',\n    //     title: tf('format.datetime'),\n    //     type: 'date',\n    //     label: '26/09/2008 15:59:00',\n    //     render: formatStringRender,\n    // },\n    // {\n    //     key: 'duration',\n    //     title: tf('format.duration'),\n    //     type: 'date',\n    //     label: '24:01:00',\n    //     render: formatStringRender,\n    // },\n];\n\nfunction isInteger(obj) {\n    return Math.floor(obj) === obj;\n}\n\n\nfunction add(a, b, digits) {\n    return operation(a, b, digits, 'add');\n}\n\nfunction subtract(a, b, digits) {\n    return operation(a, b, digits, 'subtract');\n}\n\nexport function multiply(a, b, digits) {\n    return operation(a, b, digits, 'multiply');\n}\n\nfunction divide(a, b, digits) {\n    return operation(a, b, digits, 'divide');\n}\n\n/*\n * 将一个浮点数转成整数，返回整数和倍数。如 3.14 >> 314，倍数是 100\n * @param floatNum {number} 小数\n * @return {object}\n *   {times:100, num: 314}\n */\nfunction toInteger(floatNum) {\n    const ret = {times: 1, num: 0};\n    const isNegative = floatNum < 0;\n    if (isInteger(floatNum)) {\n        ret.num = floatNum;\n        return ret;\n    }\n    const strfi = `${floatNum}`;\n    const dotPos = strfi.indexOf('.');\n    const len = strfi.substr(dotPos + 1).length;\n    const times = Math.pow(10, len);\n    let intNum = parseInt(Math.abs(floatNum) * times + 0.5, 10);\n    ret.times = times;\n    if (isNegative) {\n        intNum = -intNum;\n    }\n    ret.num = intNum;\n    return ret;\n}\n\nfunction operation(a, b, digits, op) {\n    const o1 = toInteger(a);\n    const o2 = toInteger(b);\n    const n1 = o1.num;\n    const n2 = o2.num;\n    const t1 = o1.times;\n    const t2 = o2.times;\n    const max = t1 > t2 ? t1 : t2;\n    let result = null;\n    switch (op) {\n        case 'add':\n            if (t1 === t2) { // 两个小数位数相同\n                result = n1 + n2;\n            } else if (t1 > t2) { // o1 小数位 大于 o2\n                result = n1 + n2 * (t1 / t2);\n            } else { // o1 小数位 小于 o2\n                result = n1 * (t2 / t1) + n2;\n            }\n            return result / max;\n        case 'subtract':\n            if (t1 === t2) {\n                result = n1 - n2;\n            } else if (t1 > t2) {\n                result = n1 - n2 * (t1 / t2);\n            } else {\n                result = n1 * (t2 / t1) - n2;\n            }\n            return result / max;\n        case 'multiply':\n            result = (n1 * n2) / (t1 * t2);\n            return result;\n        case 'divide':\n            result = (n1 / n2) * (t2 / t1);\n            return result;\n    }\n}\n\n// const formats = (ary = []) => {\n//   const map = {};\n//   baseFormats.concat(ary).forEach((f) => {\n//     map[f.key] = f;\n//   });\n//   return map;\n// };\nconst formatm = {};\nbaseFormats.forEach((f) => {\n    formatm[f.key] = f;\n});\n\nexport default {};\nexport {\n    formatm,\n    baseFormats,\n    formatNumberRender\n};\n","import Dropdown from './dropdown';\nimport {h} from './element';\nimport {baseFormats} from '../core/format';\nimport {cssPrefix} from '../config';\n\nexport default class DropdownFormat extends Dropdown {\n    constructor() {\n        let nformats = baseFormats.slice(0);\n        nformats.splice(1, 0, {key: 'divider'});\n        nformats.splice(5, 0, {key: 'divider'});\n        nformats = nformats.map((it) => {\n            const item = h('div', `${cssPrefix}-item`);\n            if (it.key === 'divider') {\n                item.addClass('divider');\n            } else {\n                item.child(it.title())\n                    .on('click', () => {\n                        this.setTitle(it.title());\n                        this.change(it);\n                    });\n                if (it.label) item.child(h('div', 'label').html(it.label));\n            }\n            return item;\n        });\n        super('Normal', '220px', true, 'bottom-left', {type: false}, ...nformats );\n    }\n\n    setTitle(key) {\n        for (let i = 0; i < baseFormats.length; i += 1) {\n            if (baseFormats[i].key === key) {\n                this.title.html(baseFormats[i].title);\n            }\n        }\n        this.hide();\n    }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport { h } from './element';\nimport { baseFormulas } from '../core/formula';\nimport { cssPrefix } from '../config';\n\nexport default class DropdownFormula extends Dropdown {\n  constructor() {\n    const nformulas = baseFormulas.map(it => h('div', `${cssPrefix}-item`)\n      .on('click', () => {\n        this.hide();\n        this.change(it);\n      })\n      .child(it.key));\n    super(new Icon('formula'), '180px', true, 'bottom-left', {type: false}, ...nformulas );\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport ColorPalette from './color_palette';\n\nexport default class DropdownColor extends Dropdown {\n  constructor(iconName, color) {\n    const icon = new Icon(iconName)\n      .css('height', '16px')\n      .css('border-bottom', `3px solid ${color}`);\n    const colorPalette = new ColorPalette();\n    colorPalette.change = (v) => {\n      this.setTitle(v);\n      this.change(v);\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, colorPalette.el);\n    this.colorPalette = colorPalette;\n  }\n\n  setTitle(color) {\n    this.title.css('border-color', color);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nfunction buildItemWithIcon(iconName) {\n  return h('div', `${cssPrefix}-item`).child(new Icon(iconName));\n}\n\nexport default class DropdownAlign extends Dropdown {\n  constructor(aligns, align) {\n    const icon = new Icon(`align-${align}`);\n    const naligns = aligns.map(it => buildItemWithIcon(`align-${it}`)\n      .on('click', () => {\n        this.setTitle(it);\n        this.change(it);\n      }));\n    super(icon, 'auto', true, 'bottom-left',  {type: false}, ...naligns );\n  }\n\n  setTitle(align) {\n    this.title.setName(`align-${align}`);\n    this.hide();\n  }\n}\n","import Dropdown from './dropdown';\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nconst lineTypes = [\n  ['thin', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['medium', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['thick', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n  ['dashed', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],\n  ['dotted', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>'],\n  // ['double', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line><line x1=\"0\" y1=\"2.5\" x2=\"50\" y2=\"2.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],\n];\n\nexport default class DropdownLineType extends Dropdown {\n  constructor(type) {\n    const icon = new Icon('line-type');\n    let beforei = 0;\n    const lineTypeEls = lineTypes.map((it, iti) => h('div', `${cssPrefix}-item state ${type === it[0] ? 'checked' : ''}`)\n      .on('click', () => {\n        lineTypeEls[beforei].toggle('checked');\n        lineTypeEls[iti].toggle('checked');\n        beforei = iti;\n        this.hide();\n        this.change(it);\n      })\n      .child(\n        h('div', `${cssPrefix}-line-type`).html(it[1]),\n      ));\n\n    super(icon, 'auto', false, 'bottom-left', {type: false}, ...lineTypeEls );\n  }\n}\n","import { h } from './element';\nimport Icon from './icon';\nimport DropdownColor from './dropdown_color';\nimport DropdownLineType from './dropdown_linetype';\nimport { cssPrefix } from '../config';\n\nfunction buildTable(...trs) {\n  return h('table', '').child(\n    h('tbody', '').children(...trs),\n  );\n}\n\nfunction buildTd(iconName) {\n  let item =  h('div', `${cssPrefix}-border-palette-cell`);\n  this.items.push(item);\n  return h('td', '').child(\n    item.child(\n      new Icon(`border-${iconName}`),\n    ).on('click', () => {\n      this.mode = iconName;\n      const { mode, style, color } = this;\n      this.change({ mode, style, color });\n    }),\n  );\n}\n\nexport default class BorderPalette {\n  constructor() {\n    this.color = '#000';\n    this.style = 'thin';\n    this.mode = 'all';\n    this.change = () => {};\n    this.ddColor = new DropdownColor('line-color', this.color);\n    this.ddColor.change = (color) => {\n      this.color = color;\n    };\n    this.ddType = new DropdownLineType(this.style);\n    this.ddType.change = ([s]) => {\n      this.style = s;\n    };\n    this.el = h('div', `${cssPrefix}-border-palette`);\n    this.items = [];\n\n    const table = buildTable(\n      h('tr', '').children(\n        h('td', `${cssPrefix}-border-palette-left`).child(\n          buildTable(\n            h('tr', '').children(\n              ...['all', 'inside', 'horizontal', 'vertical', 'outside'].map(it => buildTd.call(this, it)),\n            ),\n            h('tr', '').children(\n              ...['left', 'top', 'right', 'bottom', 'none'].map(it => buildTd.call(this, it)),\n            ),\n          ),\n        ),\n        h('td', `${cssPrefix}-border-palette-right`).children(\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddColor.el),\n          h('div', `${cssPrefix}-toolbar-btn`).child(this.ddType.el),\n        ),\n      ),\n    );\n    this.el.child(table);\n  }\n}\n","import Dropdown from './dropdown';\nimport Icon from './icon';\nimport BorderPalette from './border_palette';\n\nexport default class DropdownBorder extends Dropdown {\n  constructor() {\n    const icon = new Icon('border-all');\n    const borderPalette = new BorderPalette();\n    borderPalette.change = (v) => {\n      this.change(v);\n      this.hide();\n    };\n    super(icon, 'auto', false, 'bottom-left', {type: false}, borderPalette.el );\n    this.borderPalette = borderPalette;\n  }\n}\n","import {h} from \"./element\";\nimport {cssPrefix} from \"../config\";\n\nexport default class HistoryBorder {\n    constructor() {\n        this.el = h('div', `${cssPrefix}-history-border`);\n        this.history = h('div', `${cssPrefix}-history-content`).html('暂无内容');\n        this.el.child( this.history);\n    }\n\n    setContent(items) {\n        items = items.slice(items.length - 100 < 0 ? 0 : items.length, items.length);\n        this.el.html('');\n        let els = [];\n        for(let i = items.length - 1; i >= 0; i--) {\n            let d = h('div', '');\n            let {action} = items[i];\n            d.html(action);\n            els.push(d);\n        }\n\n        console.log(this, this.el);\n        this.el.children(...els);\n    }\n}","import Dropdown from \"./dropdown\";\nimport Icon from \"./icon\";\nimport HistoryBorder from \"./history_border\";\n\nexport default class DropdownAction extends Dropdown {\n    constructor(iconName, change, arrowChange) {\n        const icon = new Icon(iconName)\n            .css('height', '18px');\n        const historyBorder = new HistoryBorder();\n        super(icon, 'auto', true, 'bottom-left', {type: true, change: change, arrowChange: arrowChange, historyBorder}, historyBorder.el);\n    }\n}","/* global window */\nimport {h} from './element';\nimport {bind} from './event';\nimport tooltip from './tooltip';\nimport DropdownFont from './dropdown_font';\nimport DropdownFontSize from './dropdown_fontsize';\nimport DropdownFormat from './dropdown_format';\nimport DropdownFormula from './dropdown_formula';\nimport DropdownColor from './dropdown_color';\nimport DropdownAlign from './dropdown_align';\nimport DropdownBorder from './dropdown_border';\nimport Dropdown from './dropdown';\nimport Icon from './icon';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\nimport DropdownAction from \"./dropdown_action\";\n\nfunction buildIcon(name) {\n    return new Icon(name);\n}\n\nexport function buildButton(tooltipdata) {\n    return h('div', `${cssPrefix}-toolbar-btn`)\n        .on('mouseenter', (evt) => {\n            tooltip(tooltipdata, evt.target);\n        })\n        .attr('data-tooltip', tooltipdata);\n}\n\nfunction buildDivider() {\n    return h('div', `${cssPrefix}-toolbar-divider`);\n}\n\nexport function buildButtonWithIcon(tooltipdata, iconName, change = () => {\n}) {\n    return buildButton(tooltipdata)\n        .child(buildIcon(iconName))\n        .on('click', () => change());\n}\n\nfunction bindDropdownChange() {\n    this.ddFormat.change = it => this.change('format', it.key);\n    this.ddFont.change = it => this.change('font-name', it.key);\n    this.ddFormula.change = it => this.change('formula', it.key);\n    this.ddFontSize.change = it => this.change('font-size', it.pt);\n    this.ddTextColor.change = it => this.change('color', it);\n    this.ddFillColor.change = it => this.change('bgcolor', it);\n    this.ddAlign.change = it => this.change('align', it);\n    this.ddVAlign.change = it => this.change('valign', it);\n    this.ddBorder.change = it => this.change('border', it);\n    this.undoEl.change = it => this.change('undo', it);\n}\n\n\nfunction toggleChange(type) {\n    let elName = type;\n    const types = type.split('-');\n    if (types.length > 1) {\n        types.forEach((it, i) => {\n            if (i === 0) elName = it;\n            else elName += it[0].toUpperCase() + it.substring(1);\n        });\n    }\n    const el = this[`${elName}El`];\n    el.toggle();\n    this.change(type, el.hasClass('active'));\n}\n\nclass DropdownMore extends Dropdown {\n    constructor() {\n        const icon = new Icon('ellipsis');\n        const moreBtns = h('div', `${cssPrefix}-toolbar-more`);\n        super(icon, 'auto', false, 'bottom-right', false,  moreBtns);\n        this.moreBtns = moreBtns;\n        this.contentEl.css('max-width', '420px');\n    }\n}\n\nfunction initBtns2() {\n    this.btns2 = this.btnChildren.map((it) => {\n        const rect = it.box();\n        const {marginLeft, marginRight} = it.computedStyle();\n        return [it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)];\n    });\n}\n\nfunction moreResize(widthFn = this.widthFn) {\n    const {\n        el, btns, moreEl, ddMore, btns2,\n    } = this;\n    const {moreBtns, contentEl} = ddMore;\n    el.css('width', `${ widthFn() - 60}px`);\n    const elBox = el.box();\n\n    let sumWidth = 160;\n    let sumWidth2 = 12;\n    const list1 = [];\n    const list2 = [];\n    btns2.forEach(([it, w], index) => {\n        sumWidth += w;\n        if (index === btns2.length - 1 || sumWidth < elBox.width) {\n            list1.push(it);\n        } else {\n            sumWidth2 += w;\n            list2.push(it);\n        }\n    });\n    btns.html('').children(...list1);\n    moreBtns.html('').children(...list2);\n    contentEl.css('width', `${sumWidth2}px`);\n    if (list2.length > 0) {\n        moreEl.show();\n    } else {\n        moreEl.hide();\n    }\n}\n\nexport default class Toolbar {\n    constructor(data, widthFn, isHide = false) {\n        this.data = data;\n        this.change = () => {\n        };\n        this.widthFn = widthFn;\n        const style = data.defaultStyle();\n        this.ddFormat = new DropdownFormat();\n        this.ddFont = new DropdownFont();\n        this.ddFormula = new DropdownFormula();\n        this.ddFontSize = new DropdownFontSize();\n        this.ddTextColor = new DropdownColor('text-color', style.color);\n        this.ddFillColor = new DropdownColor('fill-color', style.bgcolor);\n        this.ddAlign = new DropdownAlign(['left', 'center', 'right'], style.align);\n        this.ddVAlign = new DropdownAlign(['top', 'middle', 'bottom'], style.valign);\n        this.ddBorder = new DropdownBorder();\n        this.ddMore = new DropdownMore();\n        this.undoEl = new DropdownAction('undo',  () => this.change('undo'), (v) => this.change('undoList', v));\n        this.redoEl = new DropdownAction('redo',  () => this.change('redo'), (v) => this.change('redoList', v));\n        this.btnChildren = [\n            // this.undoEl = buildButtonWithIcon(`${t('toolbar.undo')} (Ctrl+Z)`, 'undo', () => this.change('undo')),\n\n            // this.printEl = buildButtonWithIcon('Print (Ctrl+P)', 'print', () => this.change('print')),\n            buildButton(`${t('toolbar.undo')}`).child(this.undoEl.el),\n            buildButton(`${t('toolbar.redo')}`).child(this.redoEl.el),\n            this.paintformatEl = buildButtonWithIcon(`${t('toolbar.paintformat')}`, 'paintformat', () => toggleChange.call(this, 'paintformat')),\n            this.clearformatEl = buildButtonWithIcon(`${t('toolbar.clearformat')}`, 'clearformat', () => this.change('clearformat')),\n            buildDivider(),\n            buildButton(`${t('toolbar.format')}`).child(this.ddFormat.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.font')}`).child(this.ddFont.el),\n            buildButton(`${t('toolbar.fontSize')}`).child(this.ddFontSize.el),\n            buildDivider(),\n            this.fontBoldEl = buildButtonWithIcon(`${t('toolbar.fontBold')} (Ctrl+B)`, 'bold', () => toggleChange.call(this, 'font-bold')),\n            this.fontItalicEl = buildButtonWithIcon(`${t('toolbar.fontItalic')} (Ctrl+I)`, 'italic', () => toggleChange.call(this, 'font-italic')),\n            this.underlineEl = buildButtonWithIcon(`${t('toolbar.underline')} (Ctrl+U)`, 'underline', () => toggleChange.call(this, 'underline')),\n            // this.flexibleEl = buildButtonWithIcon(`${t('toolbar.flexibleEl')} `, 'flexible', () => toggleChange.call(this, 'flexible')),\n            this.strikeEl = buildButtonWithIcon(`${t('toolbar.strike')}`, 'strike', () => toggleChange.call(this, 'strike')),\n            buildButton(`${t('toolbar.textColor')}`).child(this.ddTextColor.el),\n            buildDivider(),\n            buildButton(`${t('toolbar.fillColor')}`).child(this.ddFillColor.el),\n            buildButton(`${t('toolbar.border')}`).child(this.ddBorder.el),\n            this.mergeEl = buildButtonWithIcon(`${t('toolbar.merge')}`, 'merge', () => toggleChange.call(this, 'merge')),\n            buildDivider(),\n            buildButton(`${t('toolbar.align')}`).child(this.ddAlign.el),\n            buildButton(`${t('toolbar.valign')}`).child(this.ddVAlign.el),\n            this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.call(this, 'textwrap')),\n            buildDivider(),\n            // this.linkEl = buildButtonWithIcon('Insert link', 'link'),\n            // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),\n            this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(this, 'freeze')),\n            this.addEl = buildButtonWithIcon(`${t('toolbar.add')}`, 'add', () => toggleChange.call(this, 'add')),\n            this.closeEl = buildButtonWithIcon(`${t('toolbar.calc')}`, 'close', () => toggleChange.call(this, 'close')),\n            this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleChange.call(this, 'autofilter')),\n            this.throwFormulaEl = buildButtonWithIcon(`${t('toolbar.throwFormula')}`, 'chevron-right', () => toggleChange.call(this, 'throwFormula')),\n            // buildButton(`${t('toolbar.date_formula')}`).child(this.ddFormula.el),\n            // buildDivider(),\n            this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),\n        ];\n        this.el = h('div', `${cssPrefix}-toolbar`);\n        this.btns = h('div', `${cssPrefix}-toolbar-btns`).children(...this.btnChildren);\n        this.el.child(this.btns);\n        if (isHide) this.el.hide();\n        bindDropdownChange.call(this);\n        this.reset();\n        setTimeout(() => {\n            initBtns2.call(this);\n            moreResize.call(this);\n        }, 0);\n        bind(window, 'resize', () => {\n            moreResize.call(this, data.settings.view.width);\n        });\n    }\n\n    paintformatActive() {\n        return this.paintformatEl.hasClass('active');\n    }\n\n    paintformatToggle() {\n        this.paintformatEl.toggle();\n    }\n\n    trigger(type) {\n        toggleChange.call(this, type);\n    }\n\n    reset() {\n        const {data} = this;\n        const style = data.getSelectedCellStyle();\n        const cell = data.getSelectedCell();\n        this.undoEl.disabled(!data.canUndo());\n        this.redoEl.disabled(!data.canRedo());\n        this.mergeEl.active(data.canUnmerge())\n            .disabled(!data.selector.multiple());\n        this.autofilterEl.active(!data.canAutofilter());\n        // this.mergeEl.disabled();\n        // console.log('selectedCell:', style, cell);\n        const {font} = style;\n        this.ddFont.setTitle(font.name);\n        this.ddFontSize.setTitle(font.size);\n        this.fontBoldEl.active(font.bold);\n        this.fontItalicEl.active(font.italic);\n        this.underlineEl.active(style.underline);\n        // this.flexibleEl.active(style.flexible);\n        this.strikeEl.active(style.strike);\n        this.ddTextColor.setTitle(style.color);\n        this.ddFillColor.setTitle(style.bgcolor);\n        this.ddAlign.setTitle(style.align);\n        this.ddVAlign.setTitle(style.valign);\n        this.textwrapEl.active(style.textwrap);\n        this.addEl.active(data.equationIsActive());\n        this.closeEl.active(false);\n        this.throwFormulaEl.active(false);\n        // console.log('freeze is Active:', data.freezeIsActive());\n        this.freezeEl.active(data.freezeIsActive());\n        if (cell) {\n            if (cell.format) {\n                this.ddFormat.setTitle(cell.format);\n            }\n        }\n    }\n}\n","/* global document */\nimport {h} from './element';\nimport {bind} from './event';\nimport {cssPrefix} from '../config';\n\nexport default function tooltip(html, target) {\n  if (target.classList.contains('active')) {\n    return;\n  }\n  const {\n    left, top, width, height,\n  } = target.getBoundingClientRect();\n  const el = h('div', `${cssPrefix}-tooltip`).html(html).show();\n  document.body.appendChild(el.el);\n  const elBox = el.box();\n  // console.log('elBox:', elBox);\n  el.css('left', `${left + (width / 2) - (elBox.width / 2)}px`)\n    .css('top', `${top + height + 2}px`);\n  bind(target, 'mouseleave', () => {\n    if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n\n  bind(target, 'click', () => {\n      if (document.body.contains(el.el)) {\n      document.body.removeChild(el.el);\n    }\n  });\n}\n","/* global document */\n/* global window */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\nimport { bind, unbind } from './event';\n\nexport default class Modal {\n  constructor(title, content, width = '600px') {\n    this.title = title;\n    this.el = h('div', `${cssPrefix}-modal`).css('width', width).children(\n      h('div', `${cssPrefix}-modal-header`).children(\n        new Icon('close').on('click.stop', () => this.hide()),\n        this.title,\n      ),\n      h('div', `${cssPrefix}-modal-content`).children(...content),\n    ).hide();\n      this.open = false;\n  }\n\n  show() {\n    // dimmer\n    this.dimmer = h('div', `${cssPrefix}-dimmer active`);\n    document.body.appendChild(this.dimmer.el);\n    const { width, height } = this.el.show().box();\n    const { clientHeight, clientWidth } = document.documentElement;\n    this.el.offset({\n      left: (clientWidth - width) / 2,\n      top: (clientHeight - height) / 3,\n    });\n    window.xkeydownEsc = (evt) => {\n      if (evt.keyCode === 27) {\n        this.hide();\n      }\n    };\n      this.open = true;\n      bind(window, 'keydown', window.xkeydownEsc);\n  }\n\n  hide() {\n    this.el.hide();\n      this.open = false;\n      document.body.removeChild(this.dimmer.el);\n    unbind(window, 'keydown', window.xkeydownEsc);\n    delete window.xkeydownEsc;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\n\nexport default class FormInput {\n  constructor(width, hint) {\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-input`);\n    this.input = h('input', '').css('width', width)\n      .on('input', evt => this.vchange(evt))\n      .attr('placeholder', hint);\n    this.el.child(this.input);\n  }\n\n  hint(v) {\n    this.input.attr('placeholder', v);\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n}\n","import { h } from './element';\nimport Suggest from './suggest';\nimport { cssPrefix } from '../config';\n\nexport default class FormSelect {\n  constructor(key, items, width, getTitle = it => it, change = () => {}) {\n    this.key = key;\n    this.getTitle = getTitle;\n    this.vchange = () => {};\n    this.el = h('div', `${cssPrefix}-form-select`);\n    this.suggest = new Suggest(items.map(it => ({ key: it, title: this.getTitle(it) })), (it) => {\n      this.itemClick(it.key);\n      change(it.key);\n      this.vchange(it.key);\n    }, width, this.el);\n    this.el.children(\n      this.itemEl = h('div', 'input-text').html(this.getTitle(key)),\n      this.suggest.el,\n    ).on('click', () => this.show());\n  }\n\n  show() {\n    this.suggest.search('');\n  }\n\n  itemClick(it) {\n    this.key = it;\n    this.itemEl.html(this.getTitle(it));\n  }\n\n  val(v) {\n    if (v !== undefined) {\n      this.key = v;\n      this.itemEl.html(this.getTitle(v));\n      return this;\n    }\n    return this.key;\n  }\n}\n","import { h } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nconst patterns = {\n  number: /(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,\n  date: /^\\d{4}-\\d{1,2}-\\d{1,2}$/,\n};\n\n// rule: { required: false, type, pattern: // }\nexport default class FormField {\n  constructor(input, rule, label, labelWidth) {\n    this.label = '';\n    this.rule = rule;\n    if (label) {\n      this.label = h('label', 'label').css('width', `${labelWidth}px`).html(label);\n    }\n    this.tip = h('div', 'tip').child('tip').hide();\n    this.input = input;\n    this.input.vchange = () => this.validate();\n    this.el = h('div', `${cssPrefix}-form-field`)\n      .children(this.label, input.el, this.tip);\n  }\n\n  isShow() {\n    return this.el.css('display') !== 'none';\n  }\n\n  show() {\n    this.el.show();\n  }\n\n  hide() {\n    this.el.hide();\n    return this;\n  }\n\n  val(v) {\n    return this.input.val(v);\n  }\n\n  hint(hint) {\n    this.input.hint(hint);\n  }\n\n  validate() {\n    const {\n      input, rule, tip, el,\n    } = this;\n    const v = input.val();\n    if (rule.required) {\n      if (/^\\s*$/.test(v)) {\n        tip.html(t('validation.required'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    if (rule.type || rule.pattern) {\n      const pattern = rule.pattern || patterns[rule.type];\n      if (!pattern.test(v)) {\n        tip.html(t('validation.notMatch'));\n        el.addClass('error');\n        return false;\n      }\n    }\n    el.removeClass('error');\n    return true;\n  }\n}\n","import { Element } from './element';\nimport { cssPrefix } from '../config';\nimport { t } from '../locale/locale';\n\nexport default class Button extends Element {\n  // type: primary\n  constructor(title, type = '') {\n    super('div', `${cssPrefix}-button ${type}`);\n    this.child(t(`button.${title}`));\n  }\n}\n","import Modal from './modal';\nimport FormInput from './form_input';\nimport FormSelect from './form_select';\nimport FormField from './form_field';\nimport Button from './button';\nimport { t } from '../locale/locale';\nimport { h } from './element';\nimport { cssPrefix } from '../config';\n\nconst fieldLabelWidth = 100;\n\nexport default class ModalValidation extends Modal {\n  constructor() {\n    const mf = new FormField(\n      new FormSelect('cell',\n        ['cell'], // cell|row|column\n        '100%',\n        it => t(`dataValidation.modeType.${it}`)),\n      { required: true },\n      `${t('dataValidation.range')}:`,\n      fieldLabelWidth,\n    );\n    const rf = new FormField(\n      new FormInput('120px', 'E3 or E3:F12'),\n      { required: true, pattern: /^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/ },\n    );\n    const cf = new FormField(\n      new FormSelect('list',\n        ['list', 'number', 'date', 'phone', 'email'],\n        '100%',\n        it => t(`dataValidation.type.${it}`),\n        it => this.criteriaSelected(it)),\n      { required: true },\n      `${t('dataValidation.criteria')}:`,\n      fieldLabelWidth,\n    );\n\n    // operator\n    const of = new FormField(\n      new FormSelect('be',\n        ['be', 'nbe', 'eq', 'neq', 'lt', 'lte', 'gt', 'gte'],\n        '160px',\n        it => t(`dataValidation.operator.${it}`),\n        it => this.criteriaOperatorSelected(it)),\n      { required: true },\n    ).hide();\n    // min, max\n    const minvf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true },\n    ).hide();\n    const maxvf = new FormField(\n      new FormInput('70px', '100'),\n      { required: true, type: 'number' },\n    ).hide();\n    // value\n    const svf = new FormField(\n      new FormInput('120px', 'a,b,c'),\n      { required: true },\n    );\n    const vf = new FormField(\n      new FormInput('70px', '10'),\n      { required: true, type: 'number' },\n    ).hide();\n\n    super(t('contextmenu.validation'), [\n      h('div', `${cssPrefix}-form-fields`).children(\n        mf.el,\n        rf.el,\n      ),\n      h('div', `${cssPrefix}-form-fields`).children(\n        cf.el,\n        of.el,\n        minvf.el,\n        maxvf.el,\n        vf.el,\n        svf.el,\n      ),\n      h('div', `${cssPrefix}-buttons`).children(\n        new Button('cancel').on('click', () => this.btnClick('cancel')),\n        new Button('remove').on('click', () => this.btnClick('remove')),\n        new Button('save', 'primary').on('click', () => this.btnClick('save')),\n      ),\n    ]);\n    this.mf = mf;\n    this.rf = rf;\n    this.cf = cf;\n    this.of = of;\n    this.minvf = minvf;\n    this.maxvf = maxvf;\n    this.vf = vf;\n    this.svf = svf;\n    this.change = () => {};\n  }\n\n  showVf(it) {\n    const hint = it === 'date' ? '2018-11-12' : '10';\n    const { vf } = this;\n    vf.input.hint(hint);\n    vf.show();\n  }\n\n  criteriaSelected(it) {\n    const {\n      of, minvf, maxvf, vf, svf,\n    } = this;\n    if (it === 'date' || it === 'number') {\n      of.show();\n      minvf.rule.type = it;\n      maxvf.rule.type = it;\n      if (it === 'date') {\n        minvf.hint('2018-11-12');\n        maxvf.hint('2019-11-12');\n      } else {\n        minvf.hint('10');\n        maxvf.hint('100');\n      }\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n      svf.hide();\n    } else {\n      if (it === 'list') {\n        svf.show();\n      } else {\n        svf.hide();\n      }\n      vf.hide();\n      of.hide();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  criteriaOperatorSelected(it) {\n    if (!it) return;\n    const {\n      minvf, maxvf, vf,\n    } = this;\n    if (it === 'be' || it === 'nbe') {\n      minvf.show();\n      maxvf.show();\n      vf.hide();\n    } else {\n      const type = this.cf.val();\n      vf.rule.type = type;\n      if (type === 'date') {\n        vf.hint('2018-11-12');\n      } else {\n        vf.hint('10');\n      }\n      vf.show();\n      minvf.hide();\n      maxvf.hide();\n    }\n  }\n\n  btnClick(action) {\n    if (action === 'cancel') {\n      this.hide();\n    } else if (action === 'remove') {\n      this.change('remove');\n      this.hide();\n    } else if (action === 'save') {\n      // validate\n      const attrs = ['mf', 'rf', 'cf', 'of', 'svf', 'vf', 'minvf', 'maxvf'];\n      for (let i = 0; i < attrs.length; i += 1) {\n        const field = this[attrs[i]];\n        // console.log('field:', field);\n        if (field.isShow()) {\n          // console.log('it:', it);\n          if (!field.validate()) return;\n        }\n      }\n\n      const mode = this.mf.val();\n      const ref = this.rf.val();\n      const type = this.cf.val();\n      const operator = this.of.val();\n      let value = this.svf.val();\n      if (type === 'number' || type === 'date') {\n        if (operator === 'be' || operator === 'nbe') {\n          value = [this.minvf.val(), this.maxvf.val()];\n        } else {\n          value = this.vf.val();\n        }\n      }\n      // console.log(mode, ref, type, operator, value);\n      this.change('save',\n        mode,\n        ref,\n        {\n          type, operator, required: false, value,\n        });\n      this.hide();\n    }\n  }\n\n  // validation: { mode, ref, validator }\n  setValue(v) {\n    if (v) {\n      const {\n        mf, rf, cf, of, svf, vf, minvf, maxvf,\n      } = this;\n      const {\n        mode, ref, validator,\n      } = v;\n      const {\n        type, operator, value,\n      } = validator || { type: 'list' };\n      mf.val(mode || 'cell');\n      rf.val(ref);\n      cf.val(type);\n      of.val(operator);\n      if (Array.isArray(value)) {\n        minvf.val(value[0]);\n        maxvf.val(value[1]);\n      } else {\n        svf.val(value || '');\n        vf.val(value || '');\n      }\n      this.criteriaSelected(type);\n      this.criteriaOperatorSelected(operator);\n    }\n    this.show();\n  }\n}\n","import {h} from './element';\nimport Button from './button';\nimport {bindClickoutside, unbindClickoutside} from './event';\nimport {cssPrefix} from '../config';\nimport {t} from '../locale/locale';\n\nfunction buildMenu(clsName) {\n    return h('div', `${cssPrefix}-item ${clsName}`);\n}\n\nfunction buildSortItem(it) {\n    return buildMenu('state').child(t(`sort.${it}`))\n        .on('click.stop', () => this.itemClick(it));\n}\n\nfunction buildFilterBody(items) {\n    const {filterbEl, filterValues} = this;\n    filterbEl.html('');\n    const itemKeys = Object.keys(items);\n    console.log(\"20\")\n    itemKeys.forEach((it, index) => {\n        const cnt = items[it];\n        const active = filterValues.includes(it) ? 'checked' : '';\n        filterbEl.child(h('div', `${cssPrefix}-item state ${active}`)\n            .on('click.stop', () => this.filterClick(index, it))\n            .children(it === '' ? t('filter.empty') : it, h('div', 'label').html(`(${cnt})`)));\n    });\n}\n\nfunction resetFilterHeader() {\n    const {filterhEl, filterValues, values} = this;\n    filterhEl.html(`${filterValues.length} / ${values.length}`);\n    filterhEl.checked(filterValues.length === values.length);\n}\n\nexport default class SortFilter {\n    constructor() {\n        this.filterbEl = h('div', `${cssPrefix}-body`);\n        this.filterhEl = h('div', `${cssPrefix}-header state`).on('click.stop', () => this.filterClick(0, 'all'));\n        this.tindex = 1;\n        this.el = h('div', `${cssPrefix}-sort-filter`).children(\n            this.sortAscEl = buildSortItem.call(this, 'asc'),\n            this.sortDescEl = buildSortItem.call(this, 'desc'),\n            buildMenu('divider'),\n            h('div', `${cssPrefix}-filter`).children(\n                this.filterhEl,\n                this.filterbEl,\n            ),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('cancel').on('click', () => this.btnClick('cancel')),\n                new Button('ok', 'primary').on('click', () => this.btnClick('ok')),\n            ),\n        ).hide();\n        // this.setFilters(['test1', 'test2', 'text3']);\n        this.el.on('mousedown.stop', evt => {\n            this.tindex = 1;\n        });\n\n        this.ci = null;\n        this.sortDesc = null;\n        this.values = null;\n        this.filterValues = [];\n    }\n\n    btnClick(it) {\n        if (it === 'ok') {\n            const {ci, sort, filterValues} = this;\n            if (this.ok) {\n                this.ok(ci, sort, 'in', filterValues);\n            }\n        }\n        this.hide();\n    }\n\n    itemClick(it) {\n        // console.log('it:', it);\n        this.sort = it;\n        const {sortAscEl, sortDescEl} = this;\n        sortAscEl.checked(it === 'asc');\n        sortDescEl.checked(it === 'desc');\n    }\n\n    filterClick(index, it) {\n        const {filterbEl, filterValues, values} = this;\n        const children = filterbEl.children();\n        if (it === 'all') {\n            if (children.length === filterValues.length) {\n                this.filterValues = [];\n                children.forEach(i => h(i).checked(false));\n            } else {\n                this.filterValues = Array.from(values);\n                children.forEach(i => h(i).checked(true));\n            }\n        } else {\n            const checked = h(children[index]).toggle('checked');\n            // console.log(h(children[index]), \"92\")\n            if (checked) {\n                filterValues.push(it);\n            } else {\n                filterValues.splice(filterValues.findIndex(i => i === it), 1);\n            }\n        }\n\n        resetFilterHeader.call(this);\n    }\n\n    // v: autoFilter\n    // items: {value: cnt}\n    // sort { ci, order }\n    set(ci, items, filter, sort) {\n        this.ci = ci;\n        const {sortAscEl, sortDescEl} = this;\n        if (sort !== null) {\n            this.sort = sort.order;\n            sortAscEl.checked(sort.asc());\n            sortDescEl.checked(sort.desc());\n        } else {\n            this.sortDesc = null;\n            sortAscEl.checked(false);\n            sortDescEl.checked(false);\n        }\n        // this.setFilters(items, filter);\n        this.values = Object.keys(items);\n        this.filterValues = filter ? Array.from(filter.value) : Object.keys(items);\n        buildFilterBody.call(this, items, filter);\n        resetFilterHeader.call(this);\n    }\n\n    setOffset(v) {\n        if(this.el.isShow()) {\n            this.hide();\n            return;\n        }\n\n        this.el.offset(v).show();\n        let tindex = 1;\n\n\n        console.log(this.el);\n        bindClickoutside(this.el, () => {\n\n            if (tindex === 0) {\n                this.hide();\n            }\n\n            tindex = 0;\n        });\n    }\n\n    show() {\n        this.el.show();\n    }\n\n    hide() {\n        this.el.hide();\n        unbindClickoutside(this.el);\n    }\n}\n","/* global document */\nimport { h } from './element';\nimport Icon from './icon';\nimport { cssPrefix } from '../config';\n\nexport function xtoast(title, content) {\n  const el = h('div', `${cssPrefix}-toast`);\n  const dimmer = h('div', `${cssPrefix}-dimmer active`);\n  const remove = () => {\n    document.body.removeChild(el.el);\n    document.body.removeChild(dimmer.el);\n  };\n\n  el.children(\n    h('div', `${cssPrefix}-toast-header`).children(\n      new Icon('close').on('click.stop', () => remove()),\n      title,\n    ),\n    h('div', `${cssPrefix}-toast-content`).html(content),\n  );\n  document.body.appendChild(el.el);\n  document.body.appendChild(dimmer.el);\n  // set offset\n  const { width, height } = el.box();\n  const { clientHeight, clientWidth } = document.documentElement;\n  el.offset({\n    left: (clientWidth - width) / 2,\n    top: (clientHeight - height) / 3,\n  });\n}\n\nexport default {};\n","import {h} from './element';\nimport {cssPrefix} from '../config';\nimport {sheetReset} from './sheet';\n\nexport default class Advice {\n    constructor(data, sheet) {\n        this.el = h('div', `${cssPrefix}-advice`)\n            .children(\n                this.save = h('div', `${cssPrefix}-advice-style`)\n                    .css('border-bottom', '1px solid'),\n                this.text = h('div', `${cssPrefix}-advice-style`),\n            )\n            .hide();\n        this.save.children(\n            this.saveCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('保留样式'),\n        );\n        this.text.children(\n            this.textCheck = h('span', 'check').hide('visibility', 'hidden'),\n            h('span', '').html('仅文本'),\n        );\n        this.data = data;\n        this.sheet = sheet;\n        this.old_rows = '';\n        this.new_rows = '';\n        this.left = 0;\n        this.top = 0;\n\n        this.save.on('mousedown.stop', (evt) => {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n            this.sheet.setCellRange(this.reference, this.tableProxy, true);\n            sheetReset.call(this.sheet);\n        });\n\n        this.text.on('mousedown.stop', (evt) => {\n            this.sheet.setCellRange(this.reference, this.tableProxy, false);\n            this.saveCheck.show('visibility', 'hidden');\n            this.textCheck.hide('visibility', 'initial');\n            sheetReset.call(this.sheet);\n        });\n    }\n\n    show(left, top, type = 1, reference, tableProxy ) {\n        this.el.css('left', `${left}px`);\n        this.el.css('top', `${top}px`);\n        if (type == 1) {\n            this.saveCheck.show('visibility', 'initial');\n            this.textCheck.hide('visibility', 'hidden');\n        }\n        this.left = parseInt(left);\n        this.top = parseInt(top);\n        this.tableProxy = tableProxy;\n        this.reference = reference;\n        this.el.show();\n    }\n}\n","import {h} from \"../component/element\";\nimport {cutStr} from \"../core/operator\";\n\nfunction mountCopy(event) {\n    event.preventDefault();\n    let choose = getChooseImg.call(this);\n    if (choose) {\n        if (event.clipboardData) {\n            event.clipboardData.setData(\"text/html\", parseDom(choose.img2));\n            event.clipboardData.setData(\"text/plain\", \"\");\n        }\n        return;\n    }\n\n    let args = sheetCopy.call(this);\n    if (event.clipboardData) {\n        event.clipboardData.setData(\"text/html\", parseDom(args.html.el));\n        event.clipboardData.setData(\"text/plain\", args.plain);\n    }\n}\n\nfunction getChooseImg() {\n    let {pasteDirectionsArr} = this.data;\n\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true) {\n                this.container.css('pointer-events', 'auto');\n                return pasteDirectionsArr[i];\n            }\n        }\n    }\n    return null;\n}\n\nfunction sheetCopy() {\n    let args = {\n        plain: \"\",\n        html: h(\"table\", \"\"),\n    };\n\n    let {selector, rows, styles} = this.data;\n    let {sri, eri, sci, eci} = selector.range;\n    let tbody = h('tbody', '');\n    for (let i = sri; i <= eri; i += 1) {\n        let tr = h('tr', '');\n        for (let j = sci; j <= eci; j += 1) {\n            let td = h('td', '');\n            if (rows._[i] && rows._[i].cells && rows._[i].cells[j]) {\n                if (rows._[i].cells[j] && styles[rows._[i].cells[j].style]) {\n                    td.css('color', styles[rows._[i].cells[j].style].color);\n                    if (styles[rows._[i].cells[j].style]\n                        && styles[rows._[i].cells[j].style].font\n                        && styles[rows._[i].cells[j].style].font.bold) {\n                        let bold = styles[rows._[i].cells[j].style].font.bold ? '900' : '';\n                        td.css('font-weight', bold);\n                    }\n                    td.css('background', styles[rows._[i].cells[j].style].bgcolor);\n                }\n\n                if(!rows._[i].cells[j].text) {\n                    rows._[i].cells[j].text = \"\";\n                }\n                if(!rows._[i].cells[j].formulas) {\n                    rows._[i].cells[j].formulas = \"\";\n                }\n\n                let text = rows._[i].cells[j].formulas != \"\" ? rows._[i].cells[j].formulas : rows._[i].cells[j].text;\n                if(rows._[i].cells[j].formulas && cutStr(rows._[i].cells[j].formulas, false, true).length > 0) {\n                    let hidden = h('reference', '');\n                    hidden.html(text);\n                    hidden.attr('ri', i);\n                    hidden.attr('ci', j);\n                    td.child(hidden.el);\n                } else\n                    td.html(text);\n                args.plain += text;\n                args.plain += \"\\t\";\n            } else {\n                args.plain += \"\\t\";\n            }\n            tr.child(td);\n        }\n\n        tbody.child(tr);\n        args.plain += \"\\n\";\n    }\n    args.html.child(tbody);\n\n    return args;\n}\n\nfunction parseDom(node) {\n    let tmpNode = document.createElement(\"div\");\n    tmpNode.appendChild(node.cloneNode(true));\n    let str = tmpNode.innerHTML;\n\n    return str;\n};\n\nexport {\n    mountCopy,\n    getChooseImg,\n    sheetCopy\n}","import {h} from \"../component/element\";\nimport {cssPrefix, look} from \"../config\";\nimport CellRange from \"../core/cell_range\";\nimport {bind} from \"./event\";\nimport {  isSpecialWebsite} from \"./special_formula_process\";\n\nexport default class Website {\n    constructor(data, editor) {\n        this.data = data;\n        this.el = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n\n        this.tableEl = h('div', `${cssPrefix}-hyperlink-tooltip`)\n            .hide();\n        this.editor = editor;\n        this.tableEl.attr('tabindex', 0);\n        this.tableEl.css('overflow-y', 'auto');\n        this.tableEl.css('max-height', '400px');\n        bind(this.tableEl.el, 'paste', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'copy', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keydown', evt => {\n            evt.stopPropagation();\n        });\n        bind(this.tableEl.el, 'keyup', evt => {\n            evt.stopPropagation();\n        });\n        this.timer = null;\n        this.timer2 = null;\n    }\n\n    show(ri, ci) {\n        if(this.editor.isDisplay2()) {\n            this.el.hide();\n            this.tableEl.hide();\n\n            return;\n        }\n\n        let {data} = this;\n        let text = data.getCellTextOrDefault(ri, ci) + \"\";\n        clearTimeout(this.timer);\n        clearTimeout(this.timer2);\n\n        if (look.indexOf(text.split(\"!\")[0]) == 0) {\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 50;\n            let arr = JSON.parse(text.substring(text.indexOf(\"!\") + 1, text.length));\n\n            this.tableEl.css('left', `${left}px`);\n            this.tableEl.css('top', `${top}px`);\n            this.tableEl.css('user-select', 'text');\n\n            this.tableEl.html('');\n            let table = h('table', '');\n            table.css('border-spacing', '0px');\n            let tr = h('tr', '');\n            tr.children(\n                h('td', '').css('border', '1px solid black').html('序号'),\n                h('td', '').css('border', '1px solid black').html('项目名称'),\n                h('td', '').css('border', '1px solid black').html('城市'),\n                h('td', '').css('border', '1px solid black').html('占地面积'),\n                h('td', '').css('border', '1px solid black').html('差额')\n            );\n            table.children(\n                tr\n            );\n\n            for (let j = 0; j < arr.length; j++) {\n                let {number, name, city, area, value} = arr[j];\n                let tr = h('tr', '');\n                let td = h('td', '');\n                td.html(number);\n                td.css('border', '1px solid black');\n\n                let td2 = h('td', '');\n                td2.html(name);\n                td2.css('border', '1px solid black');\n\n                let td3 = h('td', '');\n                td3.html(city);\n                td3.css('border', '1px solid black');\n\n                let td4 = h('td', '');\n                td4.html(area);\n                td4.css('border', '1px solid black');\n\n                let td5 = h('td', '');\n                td5.html(value);\n                td5.css('border', '1px solid black');\n                tr.children(\n                    td,\n                    td2,\n                    td3,\n                    td4,\n                    td5\n                );\n                table.children(\n                    tr\n                );\n            }\n\n            this.tableEl.children(\n                table\n            );\n\n            this.timer = setTimeout(() => {\n                this.tableEl.show();\n                this.el.hide();\n            }, 150);\n        } else {\n            let args = isSpecialWebsite(text);\n            if(args.state) {\n                text = args.text;\n            }\n            text = text.substr(0, 3).toLowerCase() == \"www\" ? \"http://\" + text : text;\n            // console.log(regex.test(text))\n            if (text.substr(0, 7).toLowerCase() !== 'http://' &&\n                text.substr(0, 8).toLowerCase() !== 'https://') {\n                this.el.hide();\n                this.tableEl.hide();\n                return;\n            }\n\n            let rect = data.getRect(new CellRange(ri, ci, ri, ci));\n            let left = rect.left + 55;\n            let top = rect.top + 5;\n            this.el.html('');\n            this.el.css('color', 'blue');\n            this.el.children(\n                h('div', 'aaa').css(\"border-bottom\", \"1px solid blue\")\n                    .on('click', evt => {\n                        let iWidth = 650; //弹出窗口的宽度;\n                        let iHeight = 500; //弹出窗口的高度;\n\n                        console.log(evt);\n                        let {screenX, screenY} = evt;\n                        window.open(text, \"\", `width=${iWidth},height=${iHeight},left=${screenX + rect.width},top=${screenY}`);\n                    })\n                    .html(text)\n            );\n            this.el.css('left', `${left}px`);\n            this.el.css('top', `${top}px`);\n\n            this.timer2 = setTimeout(() => {\n                this.el.show();\n                this.tableEl.hide();\n            }, 150);\n        }\n    }\n}","import {look} from \"../config\";\n\nlet v1 = \"HYPERLINK\";\nlet v2 = \"MULTIPLECELLS\";\n\n\nfunction isSpecialWebsite(text) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1) {\n        return {\n            \"state\": true,\n            \"text\": JSON.parse(text.split(\"!\")[1]).url,\n        };\n    }\n    return {\n        \"state\": false,\n        \"text\": \"\",\n    };\n}\n\nfunction indexOf(text, formula) {\n    if (look.indexOf(text.split(\"!\")[0]) === 1 && formula.toUpperCase().indexOf(v1) === -1) {\n        return 2;\n    } else if (look.indexOf(text.split(\"!\")[0]) === 2 && formula.toUpperCase().indexOf(v2) === -1) {\n        return 1;\n    }\n    return 0;\n}\n\nfunction multipleCellsRender(cells, mc) {\n    let tailArr = [];\n    Object.keys(mc).forEach(i => {\n        cells[i] = mc[i];\n        tailArr.push(i);\n    });\n\n    return tailArr;\n}\n\nfunction specialWebsiteValue(text, formula) {\n    let index = indexOf(text, formula);\n\n    // if (index === 1) {\n    //     return {\n    //         \"state\": true,\n    //         \"type\": index,\n    //         \"text\": JSON.parse(text.split(\"!\")[1])\n    //     };\n    // } else\n    if (index === 2) {\n        let arr = text.split(\" \");\n        let s = \"\";\n        if (arr.length >= 1) {\n            text = arr[0];\n            for (let i = 1; i < arr.length; i++) {\n                s += arr[i];\n            }\n        }\n        return {\n            \"state\": true,\n            \"type\": index,\n            \"text\": JSON.parse(text.split(\"!\")[1]).text + s,\n        };\n    }\n    return {\n        \"state\": false,\n        \"type\": index,\n        \"text\": \"\",\n    };\n}\n\nexport {\n    isSpecialWebsite,\n    specialWebsiteValue,\n    multipleCellsRender,\n}","import Modal from \"./modal\";\nimport {h} from \"./element\";\nimport Button from \"./button\";\nimport {t} from \"../locale/locale\";\nimport {cssPrefix} from \"../config\";\n\nexport default class ErrorPopUp extends Modal {\n    constructor() {\n        let tip = h('span', '').html(\"您输入的公式好像至少缺少一个左括号\");\n        super(t('contextmenu.errorPop'), [\n            h('div', `${cssPrefix}-form-fields`).children(\n                tip,\n            ),\n            h('div', `${cssPrefix}-form-fields`),\n            h('div', `${cssPrefix}-buttons`).children(\n                new Button('ok', 'primary')\n                    .on('click', () => this.btnClick('ok')),\n            ),\n        ]);\n        this.tip = tip;\n    }\n\n    show(t) {\n        this.tip.html(t);\n        super.show();\n    }\n\n    btnClick(action) {\n        if (action === 'ok') {\n            this.hide();\n        }\n    }\n\n}","import {offsetTop} from \"../config\";\nimport {positionAngle} from \"../core/operator\";\n\nexport default class RectProxy {\n    constructor(rect) {\n        this.rect = rect;\n    }\n\n    isLocInside(x, y) {\n        let {rect} = this;\n\n        if (x < rect.width + rect.left && x > rect.left && y - offsetTop > rect.top && y - offsetTop < rect.top + rect.height) {\n            return true;\n        }\n        return false;\n    }\n\n    getUpDownLeftRight(ex, ey, clientX, clientY) {\n        let {rect} = this;\n\n        let pos = 0;\n        if (ex < rect.width + rect.left && ex > rect.left) {\n            if (ey > rect.top + rect.height + offsetTop) {\n                pos = 1;\n            } else if (ey - offsetTop < rect.top) {\n                pos = 4;\n            }\n\n        } else if (ey - ( rect.top - rect.height + offsetTop) > 0 && (rect.height + rect.top + offsetTop) > ey) {\n            if (ex > rect.width + rect.left) {\n                pos = 3;\n            } else if (ex < rect.left) {\n                pos = 2;\n            }\n        }\n\n        console.log(pos);\n        if (pos === 0) {\n            pos = positionAngle(clientX, ex, clientY, ey);\n        }\n        if (pos === 1 && ey < 0) {\n            pos = 4;\n        } else if (document.body.clientHeight < ey && pos === 4) {\n            pos = 1;\n        }\n        if (pos === 3 && ex < 0) {\n            pos = 2;\n        } else if (document.body.clientWidth < ex && pos === 2) {\n            pos = 3;\n        }\n\n        return pos;\n    }\n}","export default class Timer {\n    constructor() {\n        this.timer = [];\n    }\n\n    push(t) {\n        this.timer.push(t);\n    }\n\n    clear() {\n        for(let i = 0; i < this.timer.length; i++) {\n            let t = this.timer[i];\n            clearTimeout(t);\n            clearInterval(t);\n        }\n    }\n}","import {deepCopy, distinct} from \"../core/operator\";\nimport {isHave} from '../core/helper';\nimport {expr2xy, xy2expr} from \"../core/alphabet\";\n\nfunction getCellDepend(cells) {\n    let arr = [];\n    for (let i = 0; i < cells.length; i++) {\n        if(isHave(cells[i]) && isHave(cells[i].expr)) {\n            arr.push(cells[i].expr);\n        }\n\n        if (isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.depend)) {\n            arr.push(...cells[i].cell.depend);\n        }\n\n        if(isHave(cells[i]) && isHave(cells[i].cell) && isHave(cells[i].cell.multivalueRefsCell)) {\n            arr.push(cells[i].cell.multivalueRefsCell);\n        }\n    }\n\n    return arr;\n}\n\nexport default class PreAction {\n    constructor({type = -1, action = \"\",  ri = -1, ci = -1, oldData = \"\", newData = \"\", expr = \"\", oldStep = \"\", cellRange = \"\", cells = {}, height = -1, width = -1, oldCell = {}, newCell = {}, newMergesData = \"\", oldMergesData = \"\", property = \"\", value = \"\"}, data) {\n        this.type = type;\n        this.action = action;\n        this.ri = ri;\n        this.ci = ci;\n        this.expr = expr;\n        this.cellRange = cellRange;\n        this.cells = cells;\n        this.height = height;\n        this.width = width;\n        this.oldCell = oldCell;\n        this.newCell = newCell;\n        this.oldMergesData = oldMergesData;\n        this.newMergesData = newMergesData;\n        this.property = property;\n        this.value = value;\n        this.oldStep = oldStep;\n\n        this.oldData = oldData;\n        this.newData = newData;\n        this.data = data;\n    }\n\n    findAllNeedCalcCell() {\n        let changeArr = [];\n        let {oldCell, newCell, ri, ci} = this;\n        changeArr.push(...getCellDepend(oldCell));\n        changeArr.push(...getCellDepend(newCell));\n        if (ri !== -1 && ci !== -1) {\n            changeArr.push(xy2expr(ci, ri));\n        }\n\n        changeArr = distinct(changeArr);\n        return changeArr;\n    }\n\n    restore(data, sheet, isRedo) {\n        let {type} = this;\n\n        if (type === 1) { // shuru\n            let {oldCell, newCell} = this;\n            let _cell = \"\";\n            // redo 1  undo 2\n            if (isRedo === 1) {\n                _cell = deepCopy(oldCell);\n            } else {\n                _cell = deepCopy(newCell);\n            }\n            for (let i = 0; i < _cell.length; i++) {\n                let {cell, ri, ci} = _cell[i];\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n\n        } else if(type === 13) {\n            let {oldData, newData} = this;\n            let _data = \"\";\n            if (isRedo === 1) {\n                _data = deepCopy(newData);\n            } else {\n                _data = deepCopy(oldData);\n            }\n\n            data.setData(_data);\n        } else if (type === 2 || type === 5 || type === 6 || type === 11 || type === 12) {\n            let {newCell, oldCell, oldMergesData, newMergesData, cellRange, property, value} = this;\n            let _cells = \"\";\n            if (isRedo === 1) {\n                _cells = deepCopy(oldCell);\n            } else {\n                _cells = deepCopy(newCell);\n            }\n\n            if (property === 'merge') {\n                if (isRedo === 1) {\n                    this.data.merges.setData(oldMergesData);\n                } else {\n                    this.data.merges.setData(newMergesData);\n                }\n            }\n\n            for (let i = 0; i < _cells.length; i++) {\n                let {cell, ri, ci} = _cells[i];\n\n                data.rows.setCellText(ri, ci, cell, 'cell');\n            }\n        } else if (type === 3) {\n            let {ri, height, oldStep} = this;\n            if (isRedo === 1) {\n                data.rows.setHeight(ri, oldStep.height);\n            } else {\n                data.rows.setHeight(ri, height);\n            }\n        } else if (type === 4) {\n            let {ci, width, oldStep} = this;\n            if (isRedo === 1) {\n                data.cols.setWidth(ci, oldStep.width);\n            } else {\n                data.cols.setWidth(ci, width);\n            }\n\n        }\n    }\n}\n","/* global window */\nimport {h} from './element';\nimport {bind, bindTouch, mouseMoveUp, remove} from './event';\nimport Resizer from './resizer';\nimport Scrollbar from './scrollbar';\nimport Selector from './selector';\nimport Editor from './editor';\nimport ContextMenu from './contextmenu';\nimport Table from './table';\nimport Toolbar from './toolbar';\nimport ModalValidation from './modal_validation';\nimport SortFilter from './sort_filter';\nimport {xtoast} from './message';\nimport {cssPrefix, offsetLeft, offsetTop} from '../config';\nimport {formulas} from '../core/formula';\nimport {getFontSizePxByPt} from \"../core/font\";\n// import {baseFormats, multiply} from \"../core/format\";\nimport Advice from \"../component/advice\";\nimport {clearSelectors, editingSelectors, lockCells, makeSelector} from \"../component/formula_editor\";\nimport {deleteImg, hideDirectionArr, mountPaste} from \"../event/paste\";\nimport {getChooseImg, mountCopy} from \"../event/copy\";\nimport Website from \"../component/website\";\nimport {cutStr, cuttingByPos, deepCopy} from \"../core/operator\";\nimport {moveCell} from \"../event/move\";\nimport CellRange from \"../core/cell_range\";\nimport {isHave, isOusideViewRange} from \"../core/helper\";\nimport {expr2xy} from \"../core/alphabet\";\nimport ErrorPopUp from \"./error_pop_up\";\nimport RectProxy from \"./rect_proxy\";\nimport {testValid} from \"../utils/test\";\nimport Timer from \"../model/Timer\";\nimport PreAction from \"../model/pre_action\";\n\nfunction scrollbarMove() {\n    const {\n        data, verticalScrollbar, horizontalScrollbar,\n    } = this;\n    const {\n        l, t, left, top, width, height,\n    } = data.getSelectedRect();\n    const tableOffset = this.getTableOffset();\n    // console.log(',l:', l, ', left:', left, ', tOffset.left:', tableOffset.width);\n\n    if (Math.abs(left) + width > tableOffset.width) {\n        horizontalScrollbar.move({left: l + width - tableOffset.width});\n    } else {\n        const fsw = data.freezeTotalWidth();\n        if (left < fsw) {\n            horizontalScrollbar.move({left: l - 1 - fsw});\n        }\n    }\n    // console.log('top:', top, ', height:', height, ', tof.height:', tableOffset.height);\n    if (Math.abs(top) + height > tableOffset.height) {\n        verticalScrollbar.move({top: t + height - tableOffset.height - 1});\n    } else {\n        const fsh = data.freezeTotalHeight();\n        if (top < fsh) {\n            verticalScrollbar.move({top: t - 1 - fsh});\n        }\n    }\n}\n\nfunction selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {\n    if (ri === -1 && ci === -1) return;\n    // console.log(multiple, ', ri:', ri, ', ci:', ci);\n    const {\n        table, selector, toolbar,\n    } = this;\n\n    if (multiple) {\n        selector.setEnd(ri, ci, moving, true);\n    } else {\n        selector.set(ri, ci, indexesUpdated);\n    }\n\n    toolbar.reset();\n\n    // add\n    clearTimeout(this.render_timer);\n\n    this.render_timer = setTimeout(() => {\n        table.render();\n    }, 100);\n}\n\n// multiple: boolean\n// direction: left | right | up | down | row-first | row-last | col-first | col-last\nfunction selectorMove(multiple, direction) {\n    const {\n        selector, data, editor\n    } = this;\n    const {rows, cols} = data;\n    if (editor.isCors) {\n        selector.indexes = [editor.ri, editor.ci];\n    }\n    let [ri, ci] = selector.indexes;\n    const {eri, eci} = selector.range;\n    if (multiple) {\n        [ri, ci] = selector.moveIndexes;\n    }\n\n\n    // console.log(\"92\", ri, ci, editor.ri, editor.ci)\n    // if((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n    //     return;\n    // }\n\n    // console.log('selector.move:', ri, ci);\n    if (direction === 'left') {\n        if (ci > 0) ci -= 1;\n    } else if (direction === 'right') {\n        if (eci !== ci) ci = eci;\n        if (ci < cols.len - 1) ci += 1;\n    } else if (direction === 'up') {\n        if (ri > 0) ri -= 1;\n    } else if (direction === 'down') {\n        // if (eri !== ri) ri = eri;\n        if (ri < rows.len - 1) ri += 1;\n    } else if (direction === 'row-first') {\n        ci = 0;\n    } else if (direction === 'row-last') {\n        ci = cols.len - 1;\n    } else if (direction === 'col-first') {\n        ri = 0;\n    } else if (direction === 'col-last') {\n        ri = rows.len - 1;\n    }\n\n    if (multiple) {\n        selector.moveIndexes = [ri, ci];\n    }\n    selector.selectCell.setData(ri, ci);\n    selector.selectCell.resetSelectOffset();\n    selectorSet.call(this, multiple, ri, ci);\n    // editor.clear();\n\n    editorSetOffset.call(this);\n    scrollbarMove.call(this);\n}\n\n// private methods\nfunction overlayerMousemove(evt) {\n    // console.log('x:', evt.offsetX, ', y:', evt.offsetY);\n    if (evt.buttons !== 0) return;\n    if (evt.target.className === `${cssPrefix}-resizer-hover`) return;\n    const {offsetX, offsetY} = evt;\n\n    const {\n        rowResizer, colResizer, tableEl, data, website\n    } = this;\n    const cRect = data.getCellRectByXY(evt.offsetX, evt.offsetY);\n\n    // moveCell.call(this);\n\n    // url 展开\n    website.show(cRect.ri, cRect.ci);\n    const {rows, cols} = data;\n    if (offsetX > cols.indexWidth && offsetY > rows.height) {\n        rowResizer.hide();\n        colResizer.hide();\n        return;\n    }\n    const tRect = tableEl.box();\n    if (cRect.ri >= 0 && cRect.ci === -1) {\n        cRect.width = cols.indexWidth;\n        rowResizer.show(cRect, {\n            width: tRect.width,\n        });\n    } else {\n        rowResizer.hide();\n    }\n    if (cRect.ri === -1 && cRect.ci >= 0) {\n        cRect.height = rows.height;\n        colResizer.show(cRect, {\n            height: tRect.height,\n        });\n    } else {\n        colResizer.hide();\n    }\n}\n\nfunction overlayerMousescroll(evt) {\n    const {verticalScrollbar, data} = this;\n    const {autoLoad} = data.settings;\n    const {top} = verticalScrollbar.scroll();\n    // console.log('evt:::', evt.wheelDelta, evt.detail * 40);\n    let delta = evt.deltaY;\n    const {rows} = data;\n    if (evt.detail) delta = evt.detail * 40;\n    if (delta > 0 && autoLoad == true) {\n        // up\n        const ri = data.scroll.ri + 1;\n        if (ri < rows.len) {\n            verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n        }\n    } else if (autoLoad == true) {\n        // down\n        const ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    }\n}\n\nfunction overlayerTouch(direction, distance) {\n    const {verticalScrollbar, horizontalScrollbar} = this;\n    const {top} = verticalScrollbar.scroll();\n    const {left} = horizontalScrollbar.scroll();\n    // console.log('direction:', direction, ', distance:', distance, left);\n    if (direction === 'left' || direction === 'right') {\n        horizontalScrollbar.move({left: left - distance});\n    } else if (direction === 'up' || direction === 'down') {\n        verticalScrollbar.move({top: top - distance});\n    }\n}\n\nfunction verticalScrollbarSet() {\n    const {data, verticalScrollbar} = this;\n    const {height} = this.getTableOffset();\n    verticalScrollbar.set(height, data.rows.totalHeight());\n}\n\nfunction horizontalScrollbarSet() {\n    const {data, horizontalScrollbar} = this;\n    const {width} = this.getTableOffset();\n    if (data) {\n        horizontalScrollbar.set(width, data.cols.totalWidth());\n    }\n}\n\nfunction sheetFreeze() {\n    const {\n        selector, data, editor,\n    } = this;\n    const [ri, ci] = data.freeze;\n    if (ri > 0 || ci > 0) {\n        const fwidth = data.freezeTotalWidth();\n        const fheight = data.freezeTotalHeight();\n        editor.setFreezeLengths(fwidth, fheight);\n    }\n    selector.resetAreaOffset();\n}\n\nfunction sheetReset(state = true) {\n    // debugger\n    const {\n        tableEl,\n        overlayerEl,\n        overlayerCEl,\n        table,\n        toolbar,\n        selector,\n        el,\n    } = this;\n    const tOffset = this.getTableOffset();\n    const vRect = this.getRect();\n    tableEl.attr(vRect);\n    overlayerEl.offset(vRect);\n    overlayerCEl.offset(tOffset);\n    el.css('width', `${vRect.width}px`);\n    renderAutoAdapt.call(this);\n    autoRowResizer.call(this);\n\n    verticalScrollbarSet.call(this);\n    horizontalScrollbarSet.call(this);\n    sheetFreeze.call(this);\n    selector.selectCell.toolbarChangeSelectorCell();\n    table.render();\n    toolbar.reset();\n    selector.reset();\n}\n\nfunction clearClipboard() {\n    const {data, selector} = this;\n    data.clearClipboard();\n    selector.hideClipboard();\n}\n\nfunction copy() {\n    const {data, selector} = this;\n    data.copy();\n    selector.showClipboard();\n}\n\nfunction cut() {\n    const {data, selector} = this;\n    data.cut();\n    selector.showClipboard();\n}\n\nconst a = () => {\n}\n\nfunction paste(what, cb = (p) => {\n    if (p) {\n        clearClipboard.call(this);\n        sheetReset.call(this);\n    }\n}) {\n    const {data} = this;\n    let p = data.paste(what, msg => xtoast('Tip', msg));\n    cb(p);\n\n    return p;\n}\n\nfunction autofilter() {\n    const {data} = this;\n    data.autofilter();\n    sheetReset.call(this);\n}\n\nfunction toolbarChangePaintformatPaste() {\n    const {toolbar, data} = this;\n    if (toolbar.paintformatActive()) {\n        // paste.call(this, 'format');\n        data.paintFormatChange((ri, ci) => {\n            selectorSet.call(this, true, ri, ci, true, true);\n        });\n        clearClipboard.call(this);\n        toolbar.paintformatToggle();\n        toolbar.reset();\n    }\n}\n\nfunction getPoint(obj) { //获取某元素以浏览器左上角为原点的坐标\n    let t = obj.offsetTop; //获取该元素对应父容器的上边距\n    let l = obj.offsetLeft; //对应父容器的上边距\n    //判断是否有父容器，如果存在则累加其边距\n    while (obj = obj.offsetParent) {//等效 obj = obj.offsetParent;while (obj != undefined)\n        t += obj.offsetTop; //叠加父容器的上边距\n        l += obj.offsetLeft; //叠加父容器的左边距\n    }\n\n    return {\n        t: t,\n        l: l\n    }\n}\n\nfunction dropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, pos = 0, offset, horizontalScrollbar, cols) {\n    this.selector.setBoxinner(\"none\");\n    this.container.css('pointer-events', 'none');\n    let dstRect = data.getCellRectByXYWithNotTotalResult(e.layerX || e.clientX, e.layerY || e.clientY);\n    let {ri, ci} = dstRect;\n\n    if (isAutofillEl) {\n        let {rpos, ey, ex,} = dropGetPos.call(this, data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos);\n\n        let orien = selector.showAutofill(ri, ci, rpos);\n        if (isOusideViewRange(this.data.settings.view.height(), this.data.settings.view.width(), ey, ex, orien)) {\n            // if (Math.round(Math.random()) === 1) {\n            continueMove.call(this, orien, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n            // }\n        }\n\n    } else if (e.buttons === 1 && !e.shiftKey) {\n        ri = ri <= 0 ? 0 : ri;\n        ci = ci <= 0 ? 0 : ci;\n        let cell = data.viewRange();\n        let pos = cell.getMovePos(ri, ci);\n\n        selectorBeyondMove.call(this, pos, verticalScrollbar, horizontalScrollbar, cols, rows, data);\n\n        console.log(\"ri: \", ri, \"ci: \", ci);\n        selectorSet.call(this, true, ri, ci, true, true);\n    }\n}\n\n\nfunction dropGetPos(data, selector, verticalScrollbar, horizontalScrollbar, offset, e, rows, cols, ri, ci, pos) {\n    let rect = data.getRect(selector.range);\n    let rectProxy = new RectProxy(rect);\n    let clientX = rect.width + rect.left;\n    let clientY = rect.height + rect.top + offsetTop;\n    let ex = e.clientX - offset.l - offsetLeft;\n    let ey = e.clientY;\n\n    if (rectProxy.isLocInside(ex, ey)) {\n        pos = -1;\n        selector.arange = null;\n    } else {\n        pos = rectProxy.getUpDownLeftRight(ex, ey, clientX, clientY)\n    }\n\n    return {\n        rpos: pos,\n        ex,\n        ey\n    };\n}\n\nfunction selectorBeyondMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    if (orien === 2) {   //往下\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 6) {    // 往上\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 3) {        //往右\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 5) {    // 往左\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 1) { // 往下往右\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 7) {         // 往下往左\n        scrollTo.call(this, 1, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 8) {     // 往上往右\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 4, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    } else if (orien === 4) {       // 往上往左\n        scrollTo.call(this, 2, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n        scrollTo.call(this, 3, verticalScrollbar, horizontalScrollbar, rows, data, cols);\n    }\n}\n\nfunction scrollTo(orien, verticalScrollbar, horizontalScrollbar, rows, data, cols) {\n    if (Math.round(Math.random()) !== 1) {\n        return;\n    }\n    // 1 下 2 上 3左 4 右\n    let ri = 0, ci = 0;\n    if (orien === 1) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 2) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n\n        verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n    } else if (orien === 4) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 3) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\nfunction continueMove(orien, verticalScrollbar, horizontalScrollbar, cols, rows, data) {\n    let ri = 0, ci = 0;\n    if (orien === 44) {\n        const {top} = verticalScrollbar.scroll();  // 可见视图上边缘距离toolbar的像素\n        ri = data.scroll.ri + 1;\n        verticalScrollbar.move({top: top + rows.getHeight(ri) - 1});\n    } else if (orien === 22) {\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri - 1;\n        if (ri >= 0) {\n            verticalScrollbar.move({top: ri === 0 ? 0 : top - rows.getHeight(ri)});\n        }\n    } else if (orien === 33 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci + 1;\n        horizontalScrollbar.move({left: left + cols.getWidth(ci)});\n    } else if (orien === 11 && Math.round(Math.random()) === 1 && Math.round(Math.random()) === 1) {\n        const {left} = horizontalScrollbar.scroll();\n        ci = data.scroll.ci - 1;\n        horizontalScrollbar.move({left: left - cols.getWidth(ci)});\n    }\n}\n\n\nfunction overlayerMousedown(evt) {\n    // console.log(':::::overlayer.mousedown:', evt.detail, evt.button, evt.buttons, evt.shiftKey);\n    // console.log('evt.target.className:', evt.target.className);\n    const {\n        selector, data, table, sortFilter, editor, advice\n    } = this;\n    const {offsetX, offsetY} = evt;\n    const isAutofillEl = isHave(evt.corner) ? true : evt.target.className === `${cssPrefix}-selector-corner`;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n    const {\n        left, top, width, height,\n    } = cellRect;\n    let {ri, ci} = cellRect;\n    editor.setRiCi(ri, ci);\n\n    // sort or filter\n    const {autoFilter} = data;\n\n    // trait add\n    hideDirectionArr.call(this);\n    advice.el.hide();\n\n    if (autoFilter.includes2(ri, ci)) {\n        autoFilter.getSet(data.exceptRowSet, ri);\n    }\n\n    if (autoFilter.includes(ri, ci)) {\n        if (left + width - 20 < offsetX && top + height - 20 < offsetY) {\n            const items = autoFilter.items(ci, (r, c) => data.rows.getCell(r, c));\n            sortFilter.set(ci, items, autoFilter.getFilter(ci), autoFilter.getSort(ci));\n            sortFilter.setOffset({left, top: top + height + 2});\n            return;\n        }\n    }\n\n    // console.log('ri:', ri, ', ci:', ci);\n    if (!evt.shiftKey) {\n        // console.log('selectorSetStart:::');\n        if (isAutofillEl) {\n            selector.showAutofill(ri, ci);\n        } else {\n            selectorSet.call(this, false, ri, ci);\n        }\n\n\n        // let {pageX, pageY} = evt;\n        let {verticalScrollbar, horizontalScrollbar} = this;\n        const {rows, cols} = data;\n        const {top} = verticalScrollbar.scroll();\n        ri = data.scroll.ri + 1;\n        let ttop = top + rows.getHeight(ri) - 1;\n\n        let point = getPoint(this.el.el);\n        // mouse move up\n        mouseMoveUp(window, (e) => {\n            console.log(\"dropdown\")\n            clearStopTimer.call(this);\n\n            continueDropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols);\n\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols);\n        }, (e) => {\n            clearStopTimer.call(this);\n\n            if (isAutofillEl) {\n                if (data.autofill(selector.arange, 'all', msg => xtoast('Tip', msg))) {\n                    testValid.call(this);\n                    autofillNext.call(this);\n                }\n            }\n            this.selector.setBoxinner(\"auto\");\n\n            selector.hideAutofill();\n            toolbarChangePaintformatPaste.call(this);\n            this.container.css('pointer-events', 'auto');\n        });\n    }\n\n    if (!isAutofillEl && evt.buttons === 1) {\n        if (evt.shiftKey) {\n            // console.log('shiftKey::::');\n            selectorSet.call(this, true, ri, ci);\n        }\n    }\n}\n\nfunction continueDropDown(e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, point, horizontalScrollbar, cols) {\n    let stopTimer = setTimeout(() => {\n        let stopTimer2 = setInterval(() => {\n            dropDown.call(this, e, isAutofillEl, selector, data, verticalScrollbar, rows, evt, 0, point, horizontalScrollbar, cols,);\n        }, 50);\n        this.stopTimer2.push(stopTimer2);\n    }, 200);\n\n    this.stopTimer.push(stopTimer);\n}\n\nfunction clearStopTimer() {\n    this.stopTimer.clear();\n    this.stopTimer2.clear();\n}\n\nfunction autofillNext() {\n    const {\n        data, table, editor\n    } = this;\n    editor.display = true;\n    let enter = false;\n    // this.selector.arange.each((ri, ci) => {\n    //     // let cell = data.rows.getCell(ri, ci);\n    //     // if (cell && cell.formulas) {\n    //     //     let enter2 = this.editorProxy.change(ri, ci, cell.formulas, data.rows, data, true);\n    //     //     if (enter2 === true) {\n    //     //         enter = true;\n    //     //     }\n    //     // }\n    // });\n    if (enter) {\n        data.change(data.getData());\n    }\n    this.selector.arange = null;\n    loadFormula.call(this);\n    table.render();\n}\n\nfunction loadFormula(load = false) {\n    // this.table.proxy.diff = 305;\n    // this.table.proxy.oldData = \"\";\n    // sheetReset.call(this);\n    // clearTimeout(this.formulaTime);\n    // let {data, table} = this;\n    // this.formulaTime = setTimeout(() => {\n    //     let {date_formula} = data.settings;\n    //     if (date_formula && typeof date_formula.wland == \"function\") {\n    //         date_formula.wland(date_formula, data, table, load);\n    //     }\n    // }, 1500);\n}\n\nfunction firstRowToWidth(width) {\n    let cRect = {ri: -1, ci: 0, left: 60, top: 0, width: 100}\n    colResizerFinished.call(this, cRect, width);\n}\n\nfunction adviceSetOffset() {\n    const {data} = this;\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n\n    this.advice.el.el.style['top'] = `${top}px`;\n    this.advice.el.el.style['left'] = `${ left}px`;\n}\n\nfunction pictureSetOffset() {\n    const {data} = this;\n    let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n\n    this.data.pasteDirectionsArr.forEach(i => {\n        const sOffset = data.getMoveRect(i.range);\n\n        i.img.el.style['top'] = `${sOffset.top + pictureOffsetTop + i.number * 15 + i.offsetTop }px`;\n        i.img.el.style['left'] = `${sOffset.left + pictureOffsetLeft + i.number * 15 + i.offsetLeft}px`;\n    });\n}\n\n\nfunction editorSetOffset(show = true, cri = -1, cci = -1) {\n    const {\n        selector, data, editor\n    } = this;\n    let [ri, ci] = selector.indexes;\n    ri = cri == -1 ? ri : cri;\n    ci = cci == -1 ? ci : cci;\n\n    const sOffset = data.getMoveRect(new CellRange(ri, ci, selector.range.eri, selector.range.eci));\n    const tOffset = this.getTableOffset();\n\n    let sPosition = 'top';\n    // console.log('sOffset:', sOffset, ':', tOffset);\n    if (sOffset.top > tOffset.height / 2) {\n        sPosition = 'bottom';\n    }\n\n    editor.setOffset(sOffset, sPosition, show);\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction selectorsSetOffset() {\n    for (let i = 0; i < this.selectors.length; i++) {\n        let selector = this.selectors[i];\n        selector.selector.resetSelectorBRLAreaOffset(new CellRange(selector.ri, selector.ci, selector.ri, selector.ci));\n    }\n}\n\nfunction hasEditor(showEditor = true) {\n    let {selector} = this\n    if (showEditor === true) {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                this.editor.el,\n                this.selectorMoveEl.el,\n                this.selector.el,\n            );\n    } else {\n        return this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)\n            .children(\n                // this.editor.el,\n                // this.selector.el,\n                this.selectorMoveEl.el\n            );\n    }\n}\n\nfunction editorSet(type = 1) {\n    const {editor, data, selector} = this;\n    editorSetOffset.call(this);\n    editor.setCellEnd(data.getSelectedCell());\n    // editor.setCell(data.getSelectedCell(), data.getSelectedValidator(), type);\n    if (this.data.settings.showEditor) {\n        selector.el.hide();\n    }\n    clearClipboard.call(this);\n\n    setTimeout(() => {\n        editor.setCursorPos(editor.editorText.getText().length);\n    });\n}\n\nfunction verticalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrolly(distance, () => {\n        editor.display = false;\n        selector.resetBRLAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction horizontalScrollbarMove(distance) {\n    const {data, table, selector, editor} = this;\n    data.scrollx(distance, () => {\n        editor.display = false;\n        selector.resetBRTAreaOffset();\n        pictureSetOffset.call(this);\n        adviceSetOffset.call(this);\n        selectorsSetOffset.call(this);\n        editorSetOffset.call(this, false);\n        table.render();\n    });\n}\n\nfunction renderAutoAdapt() {\n    let {data, table} = this;\n    const viewRange = data.viewRange2();\n    let {autoAdapt} = data.settings.style;\n    let {ignoreRi} = data.settings;\n    let viewWidth = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            let txt = table.getCellTextContent(ri, ci);\n            const dbox = table.getDrawBox(ri, ci);\n\n            if (txt != undefined) {\n                const style = table.getCellTextStyle(ri, ci);\n                const font = Object.assign({}, style.font);\n                font.size = getFontSizePxByPt(font.size);\n                // 得到当前文字最宽的width\n                let txtWidth = null;\n                if (style.format != undefined) {\n                    // txtWidth = table.draw.selfAdaptionTxtWidth(formatm[style.format].render(txt), font, dbox);\n\n                } else {\n                    txtWidth = table.draw.selfAdaptionTxtWidth(txt, font, dbox);\n                }\n                if ((table.autoAdaptList[ci] == undefined || table.autoAdaptList[ci] < txtWidth) && ri > ignoreRi - 1) {\n                    table.autoAdaptList[ci] = txtWidth;\n                }\n            }\n        });\n        if (table.autoAdaptList.length < 0) {\n            return;\n        }\n        let {ignore} = data.settings;\n        for (let i = 0; i < table.autoAdaptList.length; i++) {\n            let _ignore = false;\n            for (let j = 0; j < ignore.length; j++) {\n                if (i == ignore[j]) _ignore = true;\n            }\n            if (_ignore == false) {\n                if (table.autoAdaptList[i] == undefined) {\n                    viewWidth += 50;\n                    data.cols.setWidth(i, 50);\n                } else {\n                    if (table.autoAdaptList[i] < 30) {\n                        table.autoAdaptList[i] = 30;\n                    }\n                    data.cols.setWidth(i, table.autoAdaptList[i]);\n                }\n            }\n            viewWidth += table.autoAdaptList[i];\n\n        }\n        if (viewWidth > 0)\n            data.settings.cellWidth = () => viewWidth;\n    }\n}\n\nfunction autoRowResizer() {\n    let {data, table} = this;\n    let viewRange = data.viewRange2();\n    let record_rc = 0, max = 0;\n    let r_h = data.settings.row.height;\n    let {autoAdapt} = data.settings.style;\n    let viewHeight = 0;\n\n    if (autoAdapt) {\n        viewRange.each((ri, ci) => {\n            const txt = table.getCellTextContent(record_rc, ci);\n            const style = table.getCellTextStyle(ri, ci);\n            const font = Object.assign({}, style.font);\n            font.size = getFontSizePxByPt(font.size);\n            const dbox = table.getDrawBox(record_rc, ci);\n            // 1. 自适应调整一行的高度\n            // 2. 进入下一行 得到 本行的max\n            if (record_rc != ri && txt != undefined) {\n                let record_h = data.rows.getHeight(record_rc);\n                if (r_h * max != record_h) {\n                    let c_h = font.size * max + dbox.padding * 2 + 2 * max;\n                    // console.log(\"451\", view.height(r_h * max));\n                    data.rows.setHeight(record_rc, c_h);\n                    viewHeight += c_h;\n                } else {\n                    viewHeight += record_h;\n                }\n                max = 0;\n            } else if (txt != undefined && record_rc == ri) {\n                if (txt != undefined) {\n                    const n = table.draw.selfAdaptionHeight(dbox, txt, font);\n                    if (n > max || max == 0) {\n                        max = n;\n                    }\n                }\n            }\n            record_rc = ri;\n        });\n        let record_h = data.rows.getHeight(record_rc);\n        const style = table.getCellTextStyle(record_h, 0);\n        const font = Object.assign({}, style.font);\n        font.size = getFontSizePxByPt(font.size);\n        const dbox = table.getDrawBox(record_rc, 0);\n        if (r_h * max != record_h && viewHeight > 0) {\n            let c_h = font.size * max + dbox.padding * 2;\n            viewHeight += c_h;\n            data.rows.setHeight(record_rc, c_h);\n        } else if (viewHeight > 0) {\n            viewHeight += record_h;\n        }\n    }\n    console.log(503, viewHeight)\n    if (viewHeight > 0)\n        data.settings.view.height = () => viewHeight + 40;\n}\n\nfunction clickSelectorChangeRiCi(evt) {\n    const overlayer = evt.target.className === `${cssPrefix}-overlayer` ? true : false;\n    if (!overlayer) {\n        return;\n    }\n\n    let {selector, data} = this;\n\n    const {offsetX, offsetY} = evt;\n    const cellRect = data.getCellRectByXY(offsetX, offsetY);\n\n    selector.selectCell.setData(cellRect.ri, cellRect.ci);\n    selector.selectCell.resetSelectOffset();\n}\n\nfunction rowResizerFinished(cRect, distance) {\n    const {ri} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setRowHeight(ri, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    table.render();\n    selector.resetAreaOffset();\n    verticalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction colResizerFinished(cRect, distance) {\n    const {ci} = cRect;\n    const {table, selector, data, toolbar} = this;\n    data.setColWidth(ci, distance);\n    data.change(data.getData());\n    toolbar.reset();\n    // console.log('data:', data);\n    table.render();\n    selector.resetAreaOffset();\n    horizontalScrollbarSet.call(this);\n    editorSetOffset.call(this);\n}\n\nfunction errorPop(enter, msg) {\n    const {errorPopUp} = this;\n\n    if (enter && !errorPopUp.open) {\n        errorPopUp.show(msg);\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else if (errorPopUp.open) {\n        errorPopUp.hide();\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    }\n    return {\n        \"state\": false,\n        \"msg\": msg\n    };\n}\n\nexport function selectorCellText(ri, ci, {text, style}, state, proxy = \"\") {\n    const {data, editor,} = this;\n    let args = data.selectorCellText(ri, ci, text + \"\", state);\n    if (args.state) {\n        args = errorPop.call(this, true, args.msg);\n        if (args.state) {\n            return true;\n        }\n    }\n\n    data.setCellText(ri, ci, {text, style});\n    editor.setRiCi(-1, -1);\n\n    return false;\n}\n\nfunction dataSetCellText(text, state = 'finished') {\n    const {data, table, editor} = this;\n    // const [ri, ci] = selector.indexes;\n    let {ri, ci} = data.selector;\n    if ((editor.ri != ri && editor.ri != -1) || (editor.ci != ci && editor.ci != -1)) {\n        return;\n    }\n\n    data.setSelectedCellText(text, state);\n    if (state === 'finished') table.render();\n}\n\nfunction throwFormula() {\n    const {data} = this;\n    data.throwFormula();\n    // sheetReset.call(this);\n}\n\nexport function insertDeleteRowColumn(type) {\n    const {data} = this;\n    if (type === 'insert-row') {\n        data.insert('row');\n    } else if (type === 'delete-row') {\n        data.delete('row');\n    } else if (type === 'insert-column') {\n        data.insert('column');\n    } else if (type === 'delete-column') {\n        data.delete('column');\n    } else if (type === 'delete-cell') {\n        data.deleteCell();\n    } else if (type === 'delete-cell-format') {\n        data.deleteCell('format');\n    } else if (type === 'delete-cell-text') {\n        data.deleteCell('text');\n    }\n    clearClipboard.call(this);\n    sheetReset.call(this);\n}\n\nfunction toolbarChange(type, value) {\n    const {data} = this;\n    if (type === 'undo') {\n        this.undo();\n    } else if (type === 'undoList') {\n        value.setContent(data.historyList(1));\n    } else if (type === 'redoList') {\n        value.setContent(data.historyList(2));\n    } else if (type === 'redo') {\n        this.redo();\n    } else if (type === 'print') {\n        // print\n    } else if (type === 'paintformat') {\n        if (value === true) copy.call(this);\n        else clearClipboard.call(this);\n    } else if (type === 'clearformat') {\n        insertDeleteRowColumn.call(this, 'delete-cell-format');\n    } else if (type === 'link') {\n        // link\n    } else if (type === 'chart') {\n        // chart\n    } else if (type === 'autofilter') {\n        // filter\n        autofilter.call(this);\n    } else if (type === 'throwFormula') {\n        throwFormula.call(this);\n    } else if (type === 'close') {\n        let {mri, mci} = data.getMax();\n\n        data.changeDataForCalc = new PreAction({\n            type: 999,\n            action: \"重新计算\", ri: -1, ci: -1, oldCell: {}, newCell: data.rows.eachRange(new CellRange(0, 0, mri, mci))\n        }, this.data);\n        sheetReset.call(this);\n        // loadFormula.call(this, true);\n    } else if (type === 'freeze') {\n        let {showFreeze} = data.settings;\n        if (value && showFreeze === true) {\n            const {ri, ci} = data.selector;\n            this.freeze(ri, ci);\n        } else {\n            this.freeze(0, 0);\n        }\n    } else if (type === 'add') {\n        data.showEquation = !data.showEquation;\n        sheetReset.call(this, true);\n    } else {\n        //format percent 473\n        data.setSelectedCellAttr(type, value);\n        if (type === 'border') {\n            borderResSet.call(this, 'none');\n        }\n        if (type === 'formula') {\n            editorSet.call(this);\n        }\n        sheetReset.call(this);\n    }\n}\n\nfunction borderResSet(value = \"1px solid rgb(75, 137, 255\") {\n    this.selector.br.border(value);\n}\n\nfunction sortFilterChange(ci, order, operator, value) {\n    this.data.setAutoFilter(ci, order, operator, value);\n    sheetReset.call(this);\n}\n\nfunction afterSelector(editor) {\n    if (editor.getLock() || editor.state === 2) {\n        let {ri, ci} = editor;\n        let inputText = editor.editorText.getText();\n        let {selector} = this;\n        selector.indexes = [ri, ci];\n        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input', this.table.proxy);\n        return error;\n    }\n    return false;\n}\n\nfunction pasteEvent(evt) {\n    clearClipboard.call(this);\n    mountPaste.call(this, evt, () => {\n        sheetReset.call(this);\n        let {data} = this;\n        data.change(data.getData());\n    });\n}\n\nfunction sheetInitEvents() {\n    const {\n        overlayerEl,\n        rowResizer,\n        colResizer,\n        verticalScrollbar,\n        horizontalScrollbar,\n        editor,\n        table,\n        contextMenu,\n        data,\n        toolbar,\n        modalValidation,\n        pasteOverlay,\n        sortFilter,\n    } = this;\n\n    // pasteOverlay.on('mousedown', evt => {\n    //   console.log(\"669\");\n    //   pasteOverlay.hide();\n    // });\n\n    // overlayer\n    overlayerEl\n        .on('mousemove', (evt) => {\n            overlayerMousemove.call(this, evt);\n        })\n        .on('mousedown', (evt) => {\n            // renderAutoAdapt.call(this);\n            // autoRowResizer.call(this);\n            // the left mouse button: mousedown → mouseup → click\n            // the right mouse button: mousedown → contenxtmenu → mouseup\n            if (evt.buttons === 2) {\n                if (data.xyInSelectedRect(evt.offsetX, evt.offsetY)) {\n                    contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                    evt.stopPropagation();\n                } else {\n                    contextMenu.hide();\n                    overlayerMousedown.call(this, evt);\n                    setTimeout(() => {\n                        contextMenu.setPosition(evt.offsetX, evt.offsetY);\n                        evt.stopPropagation();\n                    }, 100);\n                }\n                clickSelectorChangeRiCi.call(this, evt);\n            } else if (evt.detail === 2) {\n                clearTimeout(this.render_timer);\n                editor.setMouseDownIndex([]);\n\n                if (editor.getLock()) {\n                    return;\n                }\n                editorSet.call(this, 2);\n            } else {\n                if (editor.getLock() || editor.isCors) {\n                    let _selector = null;\n                    let change = 0;\n                    mouseMoveUp(window, (e) => {\n                        this.container.css('pointer-events', 'none');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"none\");\n                        }\n\n                        let enter = true;\n                        let {merges} = data;\n                        // let {inputText} = editor;\n                        let inputText = editor.editorText.getText();\n                        let it = inputText;\n\n                        Object.keys(merges._).forEach(i => {\n                            let m = merges._[i];\n                            const cut = cutStr(it, true);\n                            for (let i = 0; i < cut.length; i++) {\n                                if (cut[i].indexOf(\":\") != -1) {\n                                    let a1 = cut[i].split(\":\")[0];\n                                    let a2 = cut[i].split(\":\")[1];\n                                    let e1 = expr2xy(a1);\n                                    let e2 = expr2xy(a2);\n\n                                    if (m.sci >= e1[0] && m.sri >= e1[1] && m.eci <= e2[0] && m.eri <= e2[1]) {\n                                        enter = false;\n                                    }\n                                }\n                            }\n                        });\n\n                        if (enter) {\n                            if (e.buttons === 1 && !e.shiftKey) {\n                                let {ri, ci} = data.getCellRectByXY(e.offsetX, e.offsetY);\n                                if (_selector && _selector.selector) {\n                                    _selector = makeSelector.call(this, ri, ci, this.selectors, true, _selector.selector, true);\n                                    lockCells.call(this, evt, _selector);\n                                    this.mergeSelector = true;\n                                } else {\n                                    let {pos} = editor;\n                                    let inputText = editor.editorText.getText();\n                                    for (let i = 0; i < this.selectors.length; i++) {\n                                        let selector = this.selectors[i];\n                                        let {erpx} = selector;\n\n                                        if (erpx === cuttingByPos(inputText, pos)) {\n                                            _selector = selector;\n                                            change = 1;\n                                            _selector.selector.set(ri, ci, true);\n                                            break;\n                                        }\n                                    }\n\n                                    _selector = _selector ? _selector : makeSelector.call(this, ri, ci, this.selectors, true, null, false);\n                                }\n                            }\n                        }\n                    }, () => {\n                        this.container.css('pointer-events', 'auto');\n                        if (_selector && _selector.selector) {\n                            _selector.selector.setBoxinner(\"auto\");\n                        }\n\n                        if (this.mergeSelector === false) {\n                            if (_selector && !change) {\n                                this.selectors.push(_selector);\n                            }\n                            lockCells.call(this, evt, _selector);\n                        } else if (_selector && !change && _selector.selector) {\n                            this.selectors.push(_selector);\n                        }\n                        if (_selector) {\n                            for (let i = 0; i < this.selectors.length; i++) {\n                                let selector = this.selectors[i];\n\n                                if (selector.className === _selector.className) {\n                                    selector.erpx = _selector.erpx;\n                                    break;\n                                }\n                            }\n                        }\n                        _selector = null;\n                        change = 0;\n                        this.mergeSelector = false;\n                    });\n                }\n\n                console.time(\"dbclick time1\");\n\n                if (!editor.getLock() && !editor.isCors) {\n                    console.time(\"dbclick time2\");\n\n                    let {ri, ci} = editor;\n                    let inputText = editor.editorText.getText();\n                    if (ri !== -1 && ci !== -1 && inputText[0] === \"=\") {\n                        let error = selectorCellText.call(this, ri, ci, {text: inputText}, 'input', this.table.proxy);\n\n                        if (error) {\n                            return;\n                        }\n                    }\n                    console.timeEnd(\"dbclick time2\");\n\n                    let state = editor.clear();\n\n                    if (state) {\n\n                        let cell = data.rows.getCell(ri, ci);\n                        // if (cell && cell.formulas) {\n                        //     this.editorProxy.change(ri, ci, cell.formulas, data.rows, data);\n                        // }\n                        loadFormula.call(this);\n\n                    }\n\n\n                    this.selector.longTimeBefore();\n                    overlayerMousedown.call(this, evt);\n                    clickSelectorChangeRiCi.call(this, evt);\n                    borderResSet.call(this);\n                    clearSelectors.call(this);\n                    editorSetOffset.call(this);\n                }\n                testValid.call(this);\n                console.timeEnd(\"dbclick time1\");\n\n            }\n        }).on('mousewheel.stop', (evt) => {\n        overlayerMousescroll.call(this, evt);\n    });\n\n    // slide on mobile\n    bindTouch(overlayerEl.el, {\n        move: (direction, d) => {\n            overlayerTouch.call(this, direction, d);\n        }\n    });\n\n    // toolbar change\n    toolbar.change = (type, value) => toolbarChange.call(this, type, value);\n\n    // sort filter ok\n    sortFilter.ok = (ci, order, o, v) => sortFilterChange.call(this, ci, order, o, v);\n\n    // resizer finished callback\n    rowResizer.finishedFn = (cRect, distance) => {\n        rowResizerFinished.call(this, cRect, distance);\n    };\n    colResizer.finishedFn = (cRect, distance) => {\n        colResizerFinished.call(this, cRect, distance);\n    };\n    // scrollbar move callback\n    verticalScrollbar.moveFn = (distance, evt) => {\n        verticalScrollbarMove.call(this, distance, evt);\n    };\n    horizontalScrollbar.moveFn = (distance, evt) => {\n        horizontalScrollbarMove.call(this, distance, evt);\n    };\n    // editor\n    editor.change = (state, itext) => {\n        if (state === 'finish') { //  用户输入\n            data.editorChangeToHistory(editor.editorText.getOldCell(), editor.editorText.getRICI(), 1);\n            editor.editorText.setOldCell({}, {ri: -1, ci: -1});\n            return;\n        }\n\n        // 如果是 esc\n        if (itext == \"@~esc\") {\n            let {text, formulas} = editor.editorText.getOldCell();\n            editor.editorText.setOldCell({\n                text: '',\n                formulas: '',\n            });\n            let {ri, ci} = editor;\n            data.setSelectedCell(text, 'input', formulas, ri, ci);\n            editor.setText(\"\");\n            clearSelectors.call(this);\n            editor.clear(true);\n            // editor.setRiCi(-1, -1);\n            return;\n        }\n\n        if (state == \"format\") {\n            data.setSelectedCellAttr(state, \"rmb\");\n            // return;\n        }\n        // let {selector} = this;\n        // selector.el.hide();\n        //实时更新this.selectors\n        let {lock} = editor;\n        editor.setMouseDownIndex(data.rows, []);\n        editingSelectors.call(this, itext);\n\n        if (lock && itext != '=') {\n            return;\n        }\n\n        // if (this.selectors.length > 0) {\n        //     return;\n        // }\n\n        if (state == \"format\") {\n            return;\n        }\n\n        dataSetCellText.call(this, itext, state);\n    };\n    // modal validation\n    modalValidation.change = (action, ...args) => {\n        if (action === 'save') {\n            data.addValidation(...args);\n        } else {\n            data.removeValidation();\n        }\n    };\n    // contextmenu\n    contextMenu.itemClick = (type, evt) => {\n        // console.log('type:', type);\n        if (type === 'validation') {\n            modalValidation.setValue(data.getSelectedValidation());\n        } else if (type === 'copy') {\n            copy.call(this);\n        } else if (type === 'cut') {\n            cut.call(this);\n        } else if (type === 'paste') {\n            // paste.call(this, 'all');\n            // process.call(this, document.execCommand(\"sheetCopy\"));\n            // createEvent(1, false, \"paste\");\n            // console.log(  document.execCommand(\"paste\"));\n        } else if (type === 'paste-value') {\n            paste.call(this, 'text');\n        } else if (type === 'paste-format') {\n            paste.call(this, 'format');\n        } else {\n            insertDeleteRowColumn.call(this, type);\n        }\n    };\n\n\n    // let windows = this.el.el;\n    bind(window, 'resize', () => {\n        this.reload();\n    });\n\n    bind(window, 'click', (evt) => {\n        this.focusing = overlayerEl.contains(evt.target);\n    });\n\n    bind(window, 'copy', (evt) => {\n        mountCopy.call(this, evt);\n        // data.history.add(data.getData());\n    });\n\n    bind(window, 'cut', (evt) => {\n        console.log(\"cut\", evt);\n        cut.call(this);\n        mountCopy.call(this, evt);\n        let {data} = this;\n        data.history.add(data.getData());\n    });\n\n    bind(window, 'paste', (evt) => {\n        pasteEvent.call(this, evt);\n    });\n\n    // for selector\n    bind(window, 'keydown', evt => {\n        // if (!this.focusing) return;\n        const keyCode = evt.keyCode || evt.which;\n        const {\n            key, ctrlKey, shiftKey, altKey, metaKey,\n        } = evt;\n        // console.log('keydown.evt: ', keyCode);\n        if (getChooseImg.call(this)) {\n            console.log(keyCode);\n            switch (keyCode) {\n                case 8:         // delete\n                    data.history.addPic(data.getData().pictures, \"add\");\n                    deleteImg.call(this);\n                    break;\n                // case 90:         // delete\n                //     data.history.addPic(data.getData().pictures, \"add\");\n                //     deleteImg.call(this);\n                //     break;\n            }\n\n            if (ctrlKey || metaKey) {\n                if (90 === keyCode) {\n                    this.undo();\n                    evt.preventDefault();\n                }\n            }\n        } else if (ctrlKey || metaKey) {\n            // const { sIndexes, eIndexes } = selector;\n            let what = 'all';\n            if (shiftKey) what = 'text';\n            if (altKey) what = 'format';\n            switch (keyCode) {\n                case 90:\n                    // undo: ctrl + z\n                    this.undo();\n                    evt.preventDefault();\n                    break;\n                case 89:\n                    // redo: ctrl + y\n                    this.redo();\n                    evt.preventDefault();\n                    break;\n                case 67:\n                    // ctrl + c\n                    //  加上这里是因为 需要展示虚线\n                    if (getChooseImg.call(this))\n                        return;\n                    copy.call(this);\n                    // table.render();\n                    // sheetReset.call(this);\n                    evt.preventDefault();\n                    break;\n                case 88:\n                    // ctrl + x\n                    cut.call(this);\n                    evt.preventDefault();\n                    break;\n                case 85:\n                    // ctrl + u\n                    toolbar.trigger('underline');\n                    evt.preventDefault();\n                    break;\n                case 86:\n                    // ctrl + v\n                    // paste.call(this, what, () => {\n                    //     console.log(\"837\")\n                    // });\n                    break;\n                case 37:\n                    // ctrl + left\n\n                    selectorMove.call(this, shiftKey, 'row-first');\n                    evt.preventDefault();\n                    break;\n                case 38:\n                    // ctrl + up\n                    selectorMove.call(this, shiftKey, 'col-first');\n                    evt.preventDefault();\n                    break;\n                case 39:\n                    // ctrl + right\n                    selectorMove.call(this, shiftKey, 'row-last');\n                    evt.preventDefault();\n                    break;\n                case 40:\n                    // ctrl + down\n                    selectorMove.call(this, shiftKey, 'col-last');\n                    evt.preventDefault();\n                    break;\n                case 32:\n                    // ctrl + space, all cells in col\n                    selectorSet.call(this, false, -1, data.selector.ci, false);\n                    evt.preventDefault();\n                    break;\n                case 66:\n                    // ctrl + B\n                    toolbar.trigger('font-bold');\n                    break;\n                case 73:\n                    // ctrl + I\n                    toolbar.trigger('font-italic');\n                    break;\n                default:\n                    break;\n            }\n        } else {\n            // console.log('evt.keyCode:', evt.keyCode);\n            switch (keyCode) {\n                case 32:\n                    if (shiftKey) {\n                        // shift + space, all cells in row\n                        selectorSet.call(this, false, data.selector.ri, -1, false);\n                    }\n                    break;\n                case 27: // esc\n                    contextMenu.hide();\n                    clearClipboard.call(this);\n                    break;\n                case 37: // left\n                    selectorMove.call(this, shiftKey, 'left');\n                    evt.preventDefault();\n                    break;\n                case 38: // up\n                    selectorMove.call(this, shiftKey, 'up');\n                    evt.preventDefault();\n                    break;\n                case 39: // right\n                    selectorMove.call(this, shiftKey, 'right');\n                    evt.preventDefault();\n                    break;\n                case 40: // down\n                    selectorMove.call(this, shiftKey, 'down');\n                    evt.preventDefault();\n                    break;\n                case 9: // tab\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error = afterSelector.call(this, editor);\n                    if (error) {\n                        return;\n                    }\n\n                    editor.clear();\n                    // shift + tab => move left\n                    // tab => move right\n                    selectorMove.call(this, false, shiftKey ? 'left' : 'right');\n                    evt.preventDefault();\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 13: // enter\n                    // lockCells\n                    // this.editorProxy.change(editor.ri, editor.ci, editor.editorText.getText(), data.rows, data);\n                    let error2 = afterSelector.call(this, editor);\n                    if (error2) {\n                        return;\n                    }\n                    editor.clear();\n                    renderAutoAdapt.call(this);\n                    autoRowResizer.call(this);\n                    selectorMove.call(this, false, shiftKey ? 'up' : 'down');\n                    loadFormula.call(this);\n\n                    evt.preventDefault();\n                    editorSetOffset.call(this, true);\n                    // 清除各种属性\n                    clearSelectors.call(this);\n                    break;\n                case 8: // backspace\n                    insertDeleteRowColumn.call(this, 'delete-cell-text');\n                    // evt.preventDefault();\n                    break;\n                default:\n                    break;\n            }\n\n            if (key === 'Delete') {\n                insertDeleteRowColumn.call(this, 'delete-cell-text');\n                evt.preventDefault();\n            } else if ((keyCode >= 65 && keyCode <= 90)\n                || (keyCode >= 48 && keyCode <= 57)\n                || (keyCode >= 96 && keyCode <= 105)\n                || evt.key === '='\n            ) {\n                // dataSetCellText.call(this, evt.key, 'input');\n                // editorSet.call(this);\n                // editor.inputEventHandler();\n            } else if (keyCode === 113) {\n                // F2\n                editorSet.call(this);\n            }\n        }\n    });\n}\n\nexport {\n    sheetReset,\n    selectorSet,\n}\n\nexport default class Sheet {\n    constructor(targetEl, data) {\n        const {view, showToolbar, showContextmenu, showEditor, rowWidth} = data.settings;\n        this.el = h('div', `${cssPrefix}-sheet`);\n        this.toolbar = new Toolbar(data, view.width, !showToolbar);\n\n        targetEl.children(this.toolbar.el, this.el);\n        this.pictureOffsetLeft = 10;\n        this.pictureOffsetTop = 10;\n\n        this.data = data;\n        // table\n        this.tableEl = h('canvas', `${cssPrefix}-table`);\n        // resizer\n        this.rowResizer = new Resizer(false, data.rows.height);\n        this.colResizer = new Resizer(true, data.cols.minWidth);\n        // scrollbar\n        this.verticalScrollbar = new Scrollbar(true);\n        this.horizontalScrollbar = new Scrollbar(false);\n        // editor\n        this.editor = new Editor(\n            formulas,\n            () => this.getTableOffset(),\n            data.rows.height,\n            data.cols.width,\n            data,\n            this,\n        );\n        this.stopTimer = new Timer();\n        this.stopTimer2 = new Timer();\n        this.website = new Website(data, this.editor);\n\n        // data validation\n        this.modalValidation = new ModalValidation();\n        this.errorPopUp = new ErrorPopUp();\n        // contextMenu\n        this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);\n        // selector\n        this.selector = new Selector(data, this, true);\n        this.selectorMoveEl = new Selector(data, this, false);\n        // this.editorProxy = new EditorProxy();\n\n        this.advice = new Advice(data, this);\n        // this.pasteDirectionsArr = [];\n        // this.pasteOverlay = h('div', `${cssPrefix}-paste-overlay-container`).hide();\n\n        this.overlayerCEl = hasEditor.call(this, showEditor);\n        this.selectors = [];\n        this.container = h('div', '');\n        this.selectorsEl = h('div', `selector_clear`).attr(\"id\", \"selector_clear\");\n\n        // 把图片容器移到了 overlayerCEl 下面，原因是 如果在 overlayerEl下面 会遮挡表头\n        this.overlayerCEl.children(this.selectorsEl, this.container);\n\n        this.mergeSelector = false;\n\n        this.overlayerEl = h('div', `${cssPrefix}-overlayer`)\n            .children(this.overlayerCEl);\n        // sortFilter\n        this.sortFilter = new SortFilter();\n        this.direction = false;   // 图片移动\n\n        // root element\n        this.el.children(\n            this.tableEl,\n            this.rowResizer.el,\n            this.overlayerEl.el,\n            this.colResizer.el,\n            this.verticalScrollbar.el,\n            this.horizontalScrollbar.el,\n            this.contextMenu.el,\n            this.modalValidation.el,\n            this.errorPopUp.el,\n            this.sortFilter.el,\n            this.advice.el,\n            this.website.el,\n            this.website.tableEl,\n            // this.pasteOverlay.el,\n        );\n\n        // table\n        this.table = new Table(this.tableEl.el, data, this.editor);\n        sheetInitEvents.call(this);\n        sheetReset.call(this, false);\n        // init selector [0, 0]\n        selectorSet.call(this, false, 0, 0);\n\n        if (rowWidth && rowWidth.state) {\n            firstRowToWidth.call(this, rowWidth.width)\n        }\n    }\n\n    selectorMoveReset() {\n        editorSetOffset.call(this);\n        this.editor.setRiCi(this.data.selector.ri, this.data.selector.ci)\n        sheetReset.call(this);\n    }\n\n    getTable() {\n        let {table} = this;\n        return {\n            recalc: false,\n            table: table\n        }\n    }\n\n    clickCopyPaste() {\n        let {data} = this;\n        let args = data.clickCopyPaste();\n        if (args.enter) {\n            this.selector.arange = args.dstCellRange;\n            data.clickAutofill(args.srcCellRange, args.dstCellRange, \"all\", msg => xtoast('Tip', msg));\n            autofillNext.call(this);\n        }\n    }\n\n    setCellRange(reference, tableProxy, styleBool, cellRange) {\n        let {table, data} = this;\n        data.paste(cellRange);\n        for (let i = 0; i < reference.length; i++) {\n            let {ri, ci} = reference[i];\n            let cell = deepCopy(tableProxy.rows.getCellOrNew(ri, ci));\n            if (styleBool === false) {\n                delete cell['style'];\n            }\n            selectorCellText.call(this, ri, ci, cell, 'style', table.proxy);\n            selectorSet.call(this, true, ri, ci, true, true);\n        }\n    }\n\n    selectorEditorReset(ri, ci) {\n        let {selector} = this;\n        editorSetOffset.call(this, true, ri, ci);\n        this.editor.setRiCi(ri, ci);\n        selector.hide();\n        sheetReset.call(this);\n    }\n\n    loadData(data) {\n        this.data.setData(data, this);\n        // 把所有后端计算的公式过滤出来\n        // this.editorProxy.associatedArr(this.data.rows);\n        sheetReset.call(this);\n        return this;\n    }\n\n    // freeze rows or cols\n    freeze(ri, ci) {\n        const {data} = this;\n        data.setFreeze(ri, ci);\n        sheetReset.call(this);\n        return this;\n    }\n\n    undo() {\n        this.data.undo(this);\n        sheetReset.call(this);\n    }\n\n    redo() {\n        this.data.redo();\n        sheetReset.call(this);\n    }\n\n    reload() {\n        sheetReset.call(this);\n        return this;\n    }\n\n    removeEvent() {\n        remove.call(this);\n    }\n\n    getRect() {\n        const {data} = this;\n        return {width: data.viewWidth(), height: data.viewHeight()};\n    }\n\n    getTableOffset() {\n        const {rows, cols} = this.data;\n        const {width, height} = this.getRect();\n        return {\n            width: width - cols.indexWidth,\n            height: height - rows.height,\n            left: cols.indexWidth,\n            top: rows.height,\n        };\n    }\n}\n\n","function Drag(options, self) {\n\n    /**\n     *\n     * @param el 节点\n     */\n    this.register = function (el) {\n        el.addEventListener('mousedown', function (e) {\n            if (e.button != 0) {\n                //屏蔽左键以外的按键\n                return;\n            }\n\n\n            //获取x坐标和y坐标\n            var x = e.clientX;\n            var y = e.clientY;\n\n            //获取左部和顶部的偏移量\n            var l = el.offsetLeft;\n            var t = el.offsetTop;\n\n            if (options && options.onBegin) {\n                options.onBegin.call(el, {\n                    left: x - l,\n                    top: y - t\n                });\n            }\n\n\n            //开关打开\n            var isDown = true;\n            //设置样式\n            el.style.cursor = 'move';\n\n            var nl = x, nt = y;\n\n\n            window.onmousemove = function (e) {\n                if (!isDown) {\n                    return;\n                }\n                //获取x和y\n                var nx = e.clientX;\n                var ny = e.clientY;\n\n\n                //计算移动后的左偏移量和顶部的偏移量\n                nl = nx - (x - l);\n                nt = ny - (y - t);\n\n                // console.log( nl, nt);\n\n                let drag = false;\n                if (nl > 0) {\n                    drag = false;\n                    el.style.left = nl + 'px';\n                } else {\n                    drag = true;\n                    el.style.left = 0 + 'px';\n                }\n                if (nt > 0) {\n                    drag = false;\n                    el.style.top = nt + 'px';\n                } else {\n                    drag = true;\n                    el.style.top = 0 + 'px';\n                }\n                // el.style.left = nl + 'px';\n                // el.style.top = nt + 'px';\n\n\n                if (options && options.onDrag) {\n                    options.onDrag.call(el, {\n                        left: nl,\n                        top: nt,\n                        x: nx - x,\n                        y: ny - y,\n                        isDown: isDown\n                    });\n                }\n\n                return false;\n            };\n\n            window.onmouseup = function (e) {\n                //开关关闭\n                isDown = false;\n                el.style.cursor = 'default';\n\n                if (options && options.onEnd) {\n                    options.onEnd.call(el, {left: parseInt(el.style.left), top: parseInt(el.style.top)}, self);\n                }\n\n                return false;\n            };\n            // e.stopPropagation();\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            } else if (e.preventDefault) {\n                e.preventDefault();\n            } else {\n                window.event.returnValue == false;\n            }\n        });\n    }\n}\n\nexport default Drag;","function Resize(options, self) {\n\n    this.register = function (el) {\n        var directionsArr = [];\n        var directions = ['nw', 'w', 'ws', 's', 'se', 'e', 'ne', 'n'];\n        //增加元素\n        directions.forEach(str => {\n            //direction ws\n\n            var div = document.createElement('div');\n            div.style.display = \"block\";\n            div.className = 'direction ' + str;\n            //注册事件\n\n            directionsArr.push(div);\n            el.appendChild(div);\n        });\n\n        for(let i = 0; i < 4; i++) {\n            var line = document.createElement('div');\n            line.style.display = \"block\";\n            line.className = `line${i+1}`;\n            el.appendChild(line);\n            directionsArr.push(line);\n        }\n\n\n        var border = document.createElement('div');\n        border.className = 'border';\n        el.appendChild(border);\n\n\n        //注册事件\n\n        directions.forEach(str => {\n            var isDown = false;\n            var obj = el.querySelector(\".\" + str);\n            obj.onmousedown = function (e) {\n\n                if (e.button != 0) {\n                    return;\n                }\n\n                var ox = e.clientX;\n                var oy = e.clientY;\n\n                var data = {\n                    ox: ox,\n                    oy: oy,\n                    ow: el.offsetWidth,\n                    oh: el.offsetHeight,\n                    ol: el.offsetLeft,\n                    ot: el.offsetTop\n\n                };\n\n                if (options && options.onBegin) {\n                    options.onBegin.call(el,data)\n                }\n\n                var isResize = true;\n                window.onmousemove = function (event) {\n                    if (!isResize) {\n                        return;\n                    }\n                    var x = event.clientX;\n                    var y = event.clientY;\n\n                    //计算 width和height 差值\n\n                    var width = x - data.ox;\n                    var height = y - data.oy;\n\n\n                    data.width = width;\n                    data.height = height;\n\n                    var fun = mappers[str];\n                    if (fun) {\n                        fun.call(obj, data, event);\n                    }\n\n                    event.stopPropagation();\n                }\n                window.onmouseup = function (ee) {\n                    isResize = false;\n                    ee.stopPropagation()\n\n                    if (options && options.onEnd) {\n                        options.onEnd.call(el)\n                    }\n                };\n\n                //阻止事件冒泡\n                e.stopPropagation()\n            }\n\n        });\n\n\n        if (!options) {\n            options = {\n                onResize: function () {\n\n                }\n            }\n        } else if (!options.onResize) {\n            options.onResize = function () {\n\n            }\n        }\n\n        function setLeft(l) {\n            options.onResize({left: l}, self);\n            el.style.left = l + 'px';\n        }\n\n        function setTop(t) {\n            options.onResize({top: t}, self);\n            el.style.top = t + 'px';\n        }\n\n        function setWidth(w) {\n            if (w < 20) {\n                w = 20;\n            }\n            options.onResize({width: w}, self);\n            el.style.width = w + 'px';\n        }\n\n        function setHeight(h) {\n\n            if (h < 20) {\n                h = 20;\n            }\n            options.onResize({height: h}, self);\n            el.style.height = h + 'px';\n        }\n\n        var mappers = {\n            s: function (data) {\n                setHeight(data.oh + data.height);\n            },\n            e: function (data) {\n                setWidth(data.ow + data.width)\n            },\n            w: function (data) {\n                var value = data.width;\n\n\n                var l = data.ol + value;\n                var w = data.ow + Math.abs(value);\n\n                if (value > 0) {\n                    w = data.ow - value;\n                }\n\n                if (w > 20) {\n                    setLeft(l);\n                    setWidth(w);\n                }\n            },\n            n: function (data) {\n                var value = data.height;\n\n                var t = data.ot + value;\n                var h = data.oh + Math.abs(value);\n\n                if (value > 0) {\n                    h = data.oh - value;\n                }\n                if (h > 20) {\n                    setHeight(h);\n                    setTop(t);\n                }\n            },\n            se: function (data) {\n                mappers.s(data);\n                mappers.e(data);\n            },\n            nw: function (data) {\n                mappers.n(data);\n                mappers.w(data);\n            },\n            ws: function (data) {\n                mappers.w(data);\n                mappers.s(data);\n            },\n            ne: function (data) {\n                mappers.n(data);\n                mappers.e(data);\n            }\n        }\n\n        // el.querySelector()\n        return directionsArr;\n    }\n}\n\nexport default Resize;\n","import {isHaveStyle} from \"./paste\";\nimport {Rows} from \"../core/row\";\nimport {splitStr} from \"../core/operator\";\nimport {xy2expr} from \"../core/alphabet\";\nimport CellRange from '../core/cell_range';\nimport {isHave} from \"../core/helper\";\n// jobs: todo: 为什么TableProxy放在event文件夹里面，似乎应该放到core文件夹？\nexport default class TableProxy {\n    constructor(data ) {\n        this.data = data;\n         this.rows = new Rows({len: 0, height: 0}, data);\n    }\n\n    getComputedStyle(computedStyle) {\n        let bold = false;\n        if (computedStyle.fontWeight > 400) {\n            bold = true;\n        }\n        let args = {\n            color: computedStyle.color,\n            bgcolor: computedStyle.background.substring(0,\n                computedStyle.background.indexOf(\")\") + 1),\n            font: {\n                bold: bold,\n            },\n        };\n\n        return args;\n    }\n\n    extend(tableDom, {ri, ci}) {\n        let {data} = this;\n        if (tableDom.rows.length >= data.rows.len - ri) {\n            let diff = tableDom.rows.length - (data.rows.len - ri);\n            if(diff > 0) {\n                data.insert('row', diff);\n            }\n        }\n\n        if (isHave(tableDom.rows[0]) === false || isHave(tableDom.rows[0].cells) === false) {\n            return;\n        }\n\n        let colLen = tableDom.rows[0].cells.length;\n        if (colLen >= data.cols.len) {\n            let diff = colLen - (data.cols.len - ci);\n            if(diff > 0) {\n                data.insert('column', diff, data.cols.len);\n            }\n        }\n    }\n\n    each(obj, cb) {\n        for (let i = 0; i < obj.rows.length; i++) {\n            for (let j = 0; j < obj.rows[i].cells.length; j++) {\n                cb(i, j, obj.rows[i].cells[j]);\n            }\n        }\n    }\n\n    dealColSpan(tableDom) {\n        this.each(tableDom, (i, j, cell) => {\n            let len = cell.getAttribute(\"colspan\");\n            if (len && len > 1) {\n                for (let c = 0; c < len - 1; c++) {\n                    tableDom.rows[i].insertBefore(document.createElement(\"td\"), tableDom.rows[i].cells[j + 1]);\n                }\n            }\n        });\n    }\n\n    dealStyle(tableDom, {ri, ci}) {\n        let {data, rows} = this;\n        let styles = data.styles;\n\n        this.each(tableDom, (i, j, cell) => {\n            let computedStyle = document.defaultView.getComputedStyle(cell, false);\n            let args = this.getComputedStyle(computedStyle);\n            let index = isHaveStyle(styles, args);\n            if (index === -1) {\n                styles.push(args);\n            }\n            rows.setCell(ri + i, ci + j, {\"style\": index === -1 ? styles.length - 1 : index}, 'all');\n        });\n    }\n\n    parseTableCellRange(tableDom, {ri, ci}) {\n      let maxRi = ri, maxCi = ci;\n      this.each(tableDom, (i, j, cell) => {\n        let rii = ri + i;\n        let cij = ci + j;\n            if(maxRi < rii) {\n              maxRi = rii;\n            }\n            if(maxCi < cij) {\n              maxCi = cij;\n            }\n        });\n        let cellRange = new CellRange(ri, ci, maxRi, maxCi);\n        return cellRange;\n    }\n\n    dealReference(tableDom, {ri, ci}) {\n        let {rows} = this;\n         let reference = [];\n\n        this.each(tableDom, (i, j, cell) => { // 处理reference函数提取一下，填充也用引用这个函数。 updateCEllReferenceByShift， 跟填充的逻辑共享\n            let node = cell.querySelector(\"reference\");\n            let innerText = cell.innerText || \"\";\n            if (node) {\n                let eri = node.getAttribute('ri');\n                let eci = node.getAttribute('ci');\n\n                let strList = splitStr(innerText);\n                let dci = i + ri - eri;\n                let dei = j + ci - eci;\n\n                let {bad, result} = rows.getCellTextByShift(strList, dei, dci);\n                rows.updateCellReferenceByShift(bad, result, ri + i, ci + j);\n            } else {\n                let _cell = rows.getCell(ri + i, ci + j) || {};\n                _cell.text = innerText;\n                _cell.formulas = innerText;\n\n                rows.setCell(ri + i, ci + j, _cell, 'all');\n            }\n            // proxy.setCell(data.name, xy2expr(ci + j, ri + i));\n\n            reference.push({\n                ri: ri + i,\n                ci: ci + j\n            });\n        });\n        return {\"reference\": reference};\n    }\n}\n","import {sheetReset} from \"../component/sheet\";\nimport {h} from \"../component/element\";\nimport Drag from \"../external/drag\";\nimport Resize from \"../external/resize\";\nimport {cssPrefix} from \"../config\";\nimport {getChooseImg} from \"../event/copy\";\nimport {xy2expr} from \"../core/alphabet\";\nimport CellRange from \"../core/cell_range\";\nimport {deepCopy} from \"../core/operator\";\nimport TableProxy from \"./table_proxy\";\n\nexport let resizeOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n\n    onEnd(data) {\n\n    },\n    onResize(data, self) {\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n\n        img.img2.style['width'] = img.img.el.style['width'];\n        img.img2.style['height'] = img.img.el.style['height'];\n    }\n};\n\nexport let dragOption = {\n    onBegin(data) {\n        console.log(\"obegin\", data)\n    },\n    onEnd(data, self) {\n        let {left, top} = data;\n        let img = getChooseImg.call(self);\n        if (!img)\n            return;\n        // img.left = left + 70;\n        // img.top = top + 31;\n\n        if (top - 31 < 0) {\n            top = 0;\n        } else if (left - 60 < 0) {\n            left = 0;\n        }\n\n        let range = self.data.getCellRectByXY(left + 60, top + 31);\n        range.sri = range.ri;\n        range.sci = range.ci;\n        range.eri = range.ri;\n        range.eci = range.ci;\n        let offsetLeft = left - range.left + 50;\n        let offsetTop = top - range.top + 21;\n\n        img.offsetLeft = offsetLeft;\n        img.offsetTop = offsetTop;\n        img.range = range;\n        if (typeof img.lastCi !== 'undefined' && typeof img.lastRi !== 'undefined') {\n            img.ri = img.lastRi;\n            img.ci = img.lastCi;\n        }\n        img.lastCi = range.ci;\n        img.lastRi = range.ri;\n\n        self.data.history.addPic(deepCopy(self.data.pasteDirectionsArr), \"delete\");\n    },\n    onDrag(data) {\n    },\n};\n\nfunction spanDomPackage(spanDom, tableDom) {\n    let table = h(\"table\", \"\");\n    let tbody = h('tbody', '');\n\n    let textArr = spanDom.innerText.split(\"\\n\");\n    for (let i = 0; i < textArr.length; i++) {\n        let text = textArr[i];\n        let tr = h('tr', '');\n        let td = h('td', '');\n        td.html(text);\n        td.css('background', spanDom.style['background']);\n        td.css('font-weight', spanDom.style['font-weight']);\n        td.css('color', spanDom.style['color']);\n        tr.child(td);\n        tbody.child(tr);\n    }\n\n    table.child(tbody);\n    tableDom = table.el;\n\n    return tableDom;\n}\n\nexport function process(tableDom, styleDom = \"\") {\n    let {el, data} = this;\n    data.history.add(data.getData());\n    el.child(tableDom);\n    GetInfoFromTable.call(this, tableDom);\n    tableDom.parentNode.removeChild(tableDom);\n    if (styleDom) {\n        styleDom.parentNode.removeChild(styleDom);\n    }\n    sheetReset.call(this);\n}\n\nfunction mountPaste(e, cb) {\n    let cbd = e.clipboardData;\n    let p = false;\n\n    for (let i = 0; i < cbd.items.length; i++) {\n        let item = cbd.items[i];\n        if (item.kind === \"string\") {\n            item.getAsString((str) => {\n                let textDom = h('head', '');\n                let d = h('span', '');\n                if ((str.indexOf('<span') == -1 && str.indexOf('span>') == -1) && (str.indexOf('<table') == -1 && str.indexOf('table>') == -1)) {\n                    d.html(str);\n                    textDom.child(d.el);\n                    textDom = textDom.el;\n                }\n                else {\n                    textDom.html(str);\n                    textDom = textDom.el;\n                }\n                let imgDom = textDom.getElementsByTagName(\"img\")[0];\n                let styleDom = textDom.getElementsByTagName(\"style\")[0];\n                let tableDom = textDom.getElementsByTagName(\"table\")[0];\n                let spanDom = textDom.getElementsByTagName(\"span\")[0];\n                if (imgDom && !styleDom) {\n                    mountImg.call(this, imgDom);\n                    p = true;\n                } else {\n                    if (!tableDom) {\n                        setTimeout(() => {\n                            if (p) {\n                                return;\n                            }\n                            if (spanDom) {\n                                tableDom = spanDomPackage.call(this, spanDom, tableDom);\n                            }\n                            if (styleDom) {\n                                let {el} = this;\n                                el.child(styleDom);\n                            }\n\n                            if (tableDom && p == false) {\n                                let {el} = this;\n                                el.child(tableDom);\n                                GetInfoFromTable.call(this, tableDom);\n                                tableDom.parentNode.removeChild(tableDom);\n                                if (styleDom) {\n                                    styleDom.parentNode.removeChild(styleDom);\n                                }\n                                sheetReset.call(this);\n                                p = true;\n                            }\n                        }, 100)\n                    } else {\n                        if (styleDom) {\n                            let {el} = this;\n                            el.child(styleDom);\n                        }\n\n                        if (tableDom && p == false) {\n                            process.call(this, tableDom, styleDom);\n                            p = true;\n                        }\n                    }\n                }\n            });\n        } else if (item.kind === \"file\" && !p) {\n            let f = item.getAsFile();\n            let reader = new FileReader();\n            reader.onload = (evt) => {\n                let {x, y, overlayerEl} = this;\n                let {pasteDirectionsArr} = this.data;\n                let img = h('img', 'paste-img');\n                img.el.src = evt.target.result;\n\n                setTimeout(() => {\n                    if (p) {\n                        return;\n                    }\n                    p = true;\n                    mountImg.call(this, img.el);\n                }, 0);\n            };\n\n            if (!f)\n                return;\n            reader.readAsDataURL(f);\n        }\n    }\n    setTimeout(() => {\n        if (!p)\n            cb();\n        else {\n            let {data} = this;\n            data.change(data.getData());\n        }\n    })\n}\n\nfunction processImg(item) {\n    let f = item.getAsFile();\n    let reader = new FileReader();\n    reader.onload = (evt) => {\n        // let {x, y, overlayerEl, pasteDirectionsArr} = this;\n        let img = h('img', 'paste-img');\n        img.el.src = evt.target.result;\n\n        setTimeout(() => {\n            if (p) {\n                return;\n            }\n            p = true;\n            mountImg.call(this, img.el);\n        }, 0);\n    };\n\n    reader.readAsDataURL(f);\n}\n\nfunction moveArr(top, left) {\n    let {pasteDirectionsArr} = this.data;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        console.log(p.img.el['style'].top, \"108\");\n        p.img.css(\"top\", `${top }px`)\n            .css(\"left\", `${left  }px`)\n    }\n}\n\nfunction getMaxCoord(ri, ci) {\n    let top = 0;\n    let left = 0;\n    let {pasteDirectionsArr} = this.data;\n    let number = 0;\n    for (let i = 0; i < pasteDirectionsArr.length; i++) {\n        let p = pasteDirectionsArr[i];\n        if (p.ri === ri && p.ci === ci) {\n            if (left < p.nextLeft) {\n                left = p.nextLeft;\n            }\n            if (top < p.nextTop) {\n                top = p.nextTop;\n            }\n            number++;\n        }\n    }\n\n    return {\n        top: top,\n        left: left,\n        number: number,\n    }\n}\n\n\nexport function mountImg(imgDom, init = false, sri, sci, range, add = true) {\n    let image = new Image();\n    image.src = imgDom.src;\n    image.onload = () => {\n        let width = image.width;\n        let height = image.height;\n        let img = imgDom;\n        let {container, data} = this;\n        let {pasteDirectionsArr} = data;\n        if (add) {\n            data.history.addPic(Object.assign([], pasteDirectionsArr), \"delete\");\n        }\n\n        let {ri, ci} = data.selector;\n        if (init) {\n            ri = sri;\n            ci = sci;\n        }\n        let {pictureOffsetLeft, pictureOffsetTop} = this;\n\n        const rect = data.getMoveRect(new CellRange(ri, ci, ri, ci));\n        let left = rect.left + pictureOffsetLeft;\n        let top = rect.top + pictureOffsetTop;\n        let number = 0;\n        let choose = getChooseImg.call(this);\n        if (choose) {\n            let args = getMaxCoord.call(this, choose.ri, choose.ci);\n            left = args.left;\n            top = args.top;\n            ri = choose.ri;\n            ci = choose.ci;\n            number = args.number;\n        }\n\n        let div = h('div', `${cssPrefix}-object-container`)\n            .css(\"position\", \"absolute\")\n            .css(\"top\", `${top}px`)\n            .css(\"width\", `${width}px`)\n            .css(\"height\", `${height}px`)\n            .css(\"z-index\", `100000`)\n            .css(\"left\", `${left}px`)\n            .child(img);\n        container.child(div);\n        new Drag(dragOption, this).register(div.el);\n        setTimeout(() => {\n            let {data} = this;\n            let directionsArr = new Resize(resizeOption, this).register(div.el);\n            let index = pasteDirectionsArr.length;\n\n            pasteDirectionsArr.push({\n                \"src\": img.src,\n                \"state\": true,\n                \"arr\": directionsArr,\n                \"img\": div,\n                \"index\": index,\n                \"img2\": img,\n                \"ri\": ri,\n                \"ci\": ci,\n                \"offsetLeft\": 0,\n                \"offsetTop\": 0,\n                \"number\": number,\n                \"range\": init ? range : data.selector.range,\n                \"top\": top,\n                \"left\": left,\n                \"nextLeft\": left + 15,\n                \"nextTop\": top + 15,\n            });\n            if (!init) {\n                this.data.change(this.data.getData());\n            }\n            this.direction = true;\n            div.css(\"width\", `${img.offsetWidth}px`);\n            div.css(\"height\", `${img.offsetHeight}px`);\n            containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr, init);\n            div.on('mousedown', evt => containerHandlerEvent.call(this, directionsArr, index, pasteDirectionsArr));\n        }, 0);\n    };\n}\n\nfunction hideDirectionArr() {\n    let {pasteDirectionsArr} = this.data;\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let arr = pasteDirectionsArr[i].arr;\n            if (arr.length > 0) {\n                for (let j = 0; j < arr.length; j++) {\n                    arr[j].style.display = 'none';\n                }\n            }\n            pasteDirectionsArr[i].state = false;\n            pasteDirectionsArr[i].img.css(\"z-index\", \"10000\");\n            pasteDirectionsArr[i].img2.style['border'] = \"none\";\n        }\n    }\n}\n\nfunction deleteImg(d = false) {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            if (pasteDirectionsArr[i].state === true || d == true) {\n                direction_delete.push(pasteDirectionsArr[i]);\n            } else {\n                direction_new.push(pasteDirectionsArr[i]);\n            }\n        }\n    }\n\n    Object.keys(direction_delete).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n\n    let {data} = this;\n    data.pasteDirectionsArr = direction_new;\n    data.change(data.getData());\n}\n\nfunction deleteAllImg() {\n    let {pasteDirectionsArr} = this.data;\n    let direction_new = [];\n    let direction_delete = [];\n    this.direction = false;\n    if (pasteDirectionsArr.length > 0) {\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            direction_delete.push(pasteDirectionsArr[i]);\n        }\n    }\n\n    Object.keys(pasteDirectionsArr).forEach(i => {\n        direction_delete[i].img.removeEl();\n    });\n\n    this.pasteDirectionsArr = direction_new;\n}\n\nfunction containerHandlerEvent(directionsArr, index, pasteDirectionsArr, init) {\n    hideDirectionArr.call(this);\n    this.direction = true;\n    Object.keys(directionsArr).forEach(i => {\n        directionsArr[i].style.display = 'block';\n    });\n\n    let {selector, editor} = this;\n    if (!init) {\n        selector.hide();\n        editor.clear();\n\n        pasteDirectionsArr[index].img.css(\"z-index\", \"99999999\");\n        pasteDirectionsArr[index].state = true;\n    } else {\n        hideDirectionArr.call(this);\n    }\n}\n\nfunction equals(x, y) {\n    let f1 = x instanceof Object;\n    let f2 = y instanceof Object;\n    if (!f1 || !f2) {\n        return x === y\n    }\n    if (Object.keys(x).length !== Object.keys(y).length) {\n        return false\n    }\n    let newX = Object.keys(x);\n    for (let p in newX) {\n        p = newX[p];\n        let a = x[p] instanceof Object;\n        let b = y[p] instanceof Object;\n        if (a && b) {\n            let equal = equals(x[p], y[p])\n            if (!equal) {\n                return equal\n            }\n        } else if (x[p] != y[p]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isHaveStyle(styles, style) {\n    for (let i = 0; i < styles.length; i++) {\n        if (equals(styles[i], style)) {\n            return i;\n        }\n    }\n    return -1;\n}\n\n\nfunction GetInfoFromTable(tableObj) { // class ClipboardTableProxy; .tableDom 属性  .dealColSpan() [477~483], dealStyle(), dealReferrence()， 最终得到row2； sheet层面上：（1）增加行与列。（2）setCellRange变更值。（3）给出黏贴选项\n    let {data} = this;\n    let {ri, ci} = data.selector;\n    let styles = data.styles;\n    console.time(\"paste\");\n    let tableProxy = new TableProxy(data);\n\n    tableProxy.extend(tableObj, {ri, ci});\n    tableProxy.dealColSpan(tableObj);\n    tableProxy.dealStyle(tableObj, {ri, ci});\n    let {reference} = tableProxy.dealReference(tableObj, {ri, ci});\n    this.setCellRange(reference, tableProxy, true, tableProxy.parseTableCellRange(tableObj, {ri, ci}));\n\n    const rect = data.getSelectedRect();\n    let left = rect.left + rect.width + 60;\n    let top = rect.top + rect.height + 31;\n    let {advice, editor} = this;\n    editor.clear();\n    advice.show(left, top, 1, reference, tableProxy);\n    console.timeEnd(\"paste\");\n    return {\n        rows: data.rows._,\n        styles: styles\n    };\n}\n\nfunction pasteType(type, ds, dei) {\n    if (type === 1) {\n\n    } else if (type === 2) {\n        xy2expr(ds[0] + dei, ds[1], 2);\n    }\n}\n\nexport {\n    mountPaste,\n    hideDirectionArr,\n    deleteImg,\n    moveArr,\n    deleteAllImg,\n    GetInfoFromTable,\n}\n\n","import dayjs from 'dayjs'\nimport {datePattern, str2Re} from \"../utils/reg_pattern\";\nimport {formatNumberRender} from \"../core/format\";\nimport {isHave, isNumber} from \"../core/helper\";\n\n\nexport function formatDate(diff) {\n    if(!isHave(diff) || !isNumber(diff)) {\n        return {\n            \"state\": false,\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n\n    let str = calcDecimals(diff, (i) => {\n        return i * 24 * 60;\n    });\n    str = formatNumberRender(str, 5);\n    let beginDate = dayjs('1900-01-01');\n    let beginDate2 = dayjs('1900-01-01');\n    let enter = false;\n\n    if (isHave(str) && str * 1 > 0) {\n        let second = calcDecimals(str, (i) => {\n            return i * 60;\n        });\n        enter = true;\n        second = formatNumberRender(second, 5);\n        beginDate2 = dayjs('1900-01-01  00:00:00').set('minute', str).set('second', second);\n    }\n\n    let date = \"\";\n    if (enter) {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n\n        let formula = beginDate2.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD  h:mm:ss');\n        return {\n            \"state\": date === 'Invalid Date' ? false : true,\n            \"date\": date,\n            \"date_formula\": formula,\n            \"minute\": true\n        }\n    } else {\n        date = beginDate.add(diff, 'day').subtract(2, 'day').format('YYYY-MM-DD');\n        return {\n            \"state\": date === 'Invalid Date' ? false : true,\n            \"date\": date,\n            \"date_formula\": \"\",\n            \"minute\": false\n        }\n    }\n}\n\nexport function changeFormat(date, format = 'YYYY年MM月DD日') {\n  return dayjs(date).format(format);\n}\n\nexport function calcDecimals(diff, cb = () => {\n}) {\n    let arr = diff.toString().split('.');\n    if (arr.length > 2) {\n        return diff;\n    }\n    let fix = arr[1] + \"\";\n    let newData = fix;\n    for (let i = 0; i < fix.length; i++) {\n        newData = newData * 0.1;\n    }\n    let str = cb(newData);\n\n    return str;\n}\n\nexport function cellDate() {\n\n}\n\n// 已写test\nexport function dateDiff(date) {\n    let valid = false;\n\n    for (let i = 0; valid === false && i < datePattern.length; i++) {\n        valid = str2Re(datePattern[i]).test(date);\n    }\n\n    if (valid === false) {\n        return {\n            \"isValid\": false,\n        };\n    } else {\n        date = date.replace(/[年|月]/g, \"-\");\n        date = date.replace(/[日]/g, \"\");\n\n        return {\n            \"diff\": dayjs(date).diff(dayjs('1900-01-01'), 'day') + 2,\n            \"isValid\": true,\n        }\n    }\n}\n","import {xy2expr} from \"./alphabet\";\nimport PreAction from \"../model/pre_action\";\nimport {testValid} from \"../utils/test\";\n\nfunction operationItem(preAction) {\n    this.undoItems.push(preAction);\n    this.redoItems = [];\n}\n\nexport default class MultiPreAction {\n    constructor(data) {\n        this.undoItems = [];\n        this.redoItems = [];\n        this.data = data;\n    }\n\n    addStep({type, action, ri, ci, expr, cellRange, cells, height, width, property, value, oldData}, {oldCell, newCell, oldMergesData, newMergesData, oldStep}) {\n        let preAction = \"\";\n\n        if(type === 1) {\n            preAction = new PreAction({\n                type,\n                action, ri, ci, expr, oldCell, newCell\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 2 || type === 5 || type === 11 || type === 12 || type === 6) {\n            preAction = new PreAction({\n                type, oldMergesData, property, value, newMergesData,\n                action, cellRange,  oldCell, newCell: cells\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 13) {\n            preAction = new PreAction({\n                type, oldData, newData: oldStep.oldData,\n                action,\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 3) {\n            preAction = new PreAction({\n                type,\n                action, height, ri, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        } else if(type === 4) {\n            preAction = new PreAction({\n                type,\n                action, width, ci, oldStep\n            }, this.data);\n            operationItem.call(this, preAction);\n        }\n\n        testValid.call(this);\n    }\n\n    getStepType(type, {ri, ci, expr, text, range, cellRange, property, value, merges}) {\n        let str = \"\";\n        let {rows, cols} = this.data;\n\n        if(type === 1) {\n            str = `在${expr}中键入\"${text}\"`;\n            return {\n                action: str,\n                type,\n                ri, ci, expr\n            };\n        } else if(type === 2) {\n            let expr1 = xy2expr(range.sci, range.sri);\n            let expr2 = xy2expr(range.eci, range.eri);\n            expr = expr1 === expr2 ? expr1 : `${expr1}:${expr2}`;\n            str = `删除${expr}的单元格内容`;\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(range),\n            };\n        } else if(type === 3) {\n            let height = rows.getHeight(ri);\n            str = `行宽`;\n            return {\n                action: str,\n                type,\n                height: height,\n                ri: ri\n            };\n        } else if(type === 4) {\n            let width = cols.getWidth(ci);\n            str = `列宽`;\n            return {\n                action: str,\n                type,\n                width: width,\n                ci: ci\n            };\n        } else if(type === 5) {\n            str = '自动填充';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 12) {\n            str = '选择性粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 13) {\n            str = '插入单元格';\n\n            return {\n                action: str,\n                type, oldData: this.data.getData(),\n            };\n        }else if(type === 11) {\n            if (property === 'font-bold' || property === 'font-italic'\n                || property === 'font-name' || property === 'font-size' || property === 'color') {\n                str = \"字体\";\n            } else if (property === 'underline') {\n                str = \"下划线\";\n            } else if (property === 'bgcolor' || property === 'format') {\n                str = \"单元格格式\";\n            } else if (property === 'align') {\n                if (value === 'left') {\n                    str = \"左对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'right') {\n                    str = \"右对齐\";\n                }\n            } else if (property === 'valign') {\n                if (value === 'top') {\n                    str = \"顶端对齐\";\n                } else if (value === 'center') {\n                    str = \"居中\";\n                } else if (value === 'bottom') {\n                    str = \"底端对齐\";\n                }\n            } else if (property === 'border') {\n                str = \"边框\";\n            } else if (property === 'strike') {\n                str = \"删除线\";\n            } else if (property === 'merge') {\n                str = '合并单元格';\n            }\n\n            return {\n                action: str,\n                type,\n                cellRange: range, property, value,\n                cells: this.eachRange(cellRange),\n            };\n        } else if(type === 6) {\n            str = '粘贴';\n            return {\n                action: str,\n                type,\n                cellRange: range,\n                cells: this.eachRange(cellRange),\n            };\n        }\n    }\n\n    undo() {\n        let preAction = this.does(this.getItems(1), 1);\n        this.redoItems.push(preAction);\n    }\n\n    redo() {\n        let preAction = this.does(this.getItems(2), 2);\n        this.undoItems.push(preAction);\n    }\n\n    eachRange(range) {\n        let {rows} = this.data;\n        let cells = rows.eachRange(range);\n\n        return cells;\n    }\n\n    does(actionItems, actionType) {\n        if (!this.data.settings.showEditor) {\n            return;\n        }\n\n        if (actionItems.length <= 0) {\n            return;\n        }\n        let {data} = this;\n        let {sheet} = data;\n\n        let preAction = actionItems.pop();\n        preAction.restore(data, sheet, actionType);\n\n        return preAction;\n    }\n\n    getItems(type) {\n        if (type === 1) {\n            return this.undoItems;\n        } else {\n            return this.redoItems;\n        }\n    }\n}\n","import CellProp from \"./cell_prop\";\nimport {isHave} from \"../core/helper\";\nimport {xy2expr} from \"../core/alphabet\";\n\nfunction getType(dType, sType) {\n    if (dType === 1 && sType === 1) {\n        return 1;           // 1行多列 * 1行多列\n    } else if (dType === 1 && sType === 2) {\n        return 2;\n    } else if (dType === 1 && sType === 3) {    // 多行多列 * 一行多列\n        return 3;\n    } else if (dType === 2 && sType === 1) {\n        return 4;\n    } else if (dType === 3 && sType === 1) {\n        return 5;\n    } else if (dType === 2 && sType === 2) {\n        return 6;\n    } else if (dType === 2 && sType === 3) {\n        return 7;\n    } else if (dType === 3 && sType === 2) {\n        return 8;\n    } else if (dType === 3 && sType === 3) {\n        return 9;\n    }\n}\n\nfunction changeDarrToDoubleArr(darr, selectorRange) {\n    let ri = selectorRange.sri;\n    let _darr = [];\n    let arr = [];\n    let index = 0;\n    selectorRange.each((i, j) => {\n        if (ri !== i) {\n            ri = i;\n            _darr.push(arr);\n            arr = [];\n        }\n        arr.push(darr[index]);\n        index += 1;\n    });\n    _darr.push(arr);\n\n    return _darr;\n}\n\nexport default class PaintFormat {\n    constructor(selectorRange, dstRange) {\n        this.selectorRange = selectorRange;\n        this.dstRange = dstRange;\n    }\n\n    getPaintType() {\n        let {dstRange, selectorRange} = this;\n\n        let dType = dstRange.getType();\n        let sType = selectorRange.getType();\n\n        let paintType = getType(dType, sType);\n\n        return paintType;\n    }\n\n    makePaintArr(type, darr) {\n        let {dstRange, selectorRange} = this;\n        let pArr = [];\n        // if (type === 1 || type === 6) {  // 1行多列 // 1列多行\n        //     let index = 0;\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         index += 1;\n        //         if (index === darr.length) {\n        //             index = 0;\n        //         }\n        //     });\n        // } else if (type === 3) {        // 3 多行多列 * 1行多列\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         let {cell} = _darr[0][index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //     });\n        // } else if(type === 7) {\n        //     let recordRi = dstRange.sri;\n        //     let rowIndex = 0;\n        //\n        //     let _darr = changeDarrToDoubleArr(darr, selectorRange);\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === _darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = _darr[rowIndex][0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // }else if (type === 4 || type === 2) {   // 4: 1行多列 * 1列多行    6: 1列多行 * 1行多列\n        //     dstRange.each((i, j) => {\n        //         let {cell} = darr[0];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //     });\n        // } else if (type === 5) {\n        //     let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             index = 0;\n        //         }\n        //\n        //         let {cell} = darr[index];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         if (index === dci) {\n        //             index = 0;\n        //         } else {\n        //             index += 1;\n        //         }\n        //         recordRi = i;\n        //     });\n        // } else if (type === 8) {\n        //     let rowIndex = 0, recordRi = dstRange.sri;\n        //\n        //     dstRange.each((i, j) => {\n        //         if (recordRi !== i) {\n        //             rowIndex += 1;\n        //\n        //             if (rowIndex === darr.length) {\n        //                 rowIndex = 0;\n        //             }\n        //         }\n        //\n        //         let {cell} = darr[rowIndex];\n        //         let cellProp = new CellProp(i, j, cell);\n        //         pArr.push(cellProp);\n        //\n        //         recordRi = i;\n        //     });\n        // } else if (type === 9) {\n            let dci = selectorRange.eci - selectorRange.sci, index = 0, recordRi = dstRange.sri;\n            let rowIndex = 0;\n\n            let _darr = changeDarrToDoubleArr(darr, selectorRange);\n\n            dstRange.each((i, j) => {\n                if (recordRi !== i) {\n                    rowIndex += 1;\n                    index = 0;\n                    if (rowIndex === _darr.length) {\n                        rowIndex = 0;\n                    }\n                }\n\n                let {cell} = _darr[rowIndex][index];\n\n                let cellProp = new CellProp(i, j, cell, xy2expr(i, j));\n                pArr.push(cellProp);\n\n                if (index === dci) {\n                    index = 0;\n                } else {\n                    index += 1;\n                }\n                recordRi = i;\n            });\n        // }\n\n        return pArr;\n    }\n}","/* global document */\n\nimport {formulaCalc} from '../core/formula';\nimport Selector from './selector';\nimport Scroll from './scroll';\nimport Clipboard from './clipboard';\nimport AutoFilter from './auto_filter';\nimport {Merges} from './merge';\nimport helper, {isHave, isNumber, useOne} from './helper';\nimport {isFormula, Rows} from './row';\nimport {Cols} from './col';\nimport {Validations} from './validation';\nimport {CellRange} from './cell_range';\nimport {expr2xy, xy2expr} from './alphabet';\nimport {t} from '../locale/locale';\nimport Moved from '../event/move';\nimport {h} from \"../component/element\";\nimport {mountImg} from \"../event/paste\";\nimport {parseCell2} from \"../component/table\";\nimport {isLegal} from \"./operator\";\nimport Recast from \"../utils/reg_pattern.js\";\nimport {changeFormat, dateDiff, formatDate} from '../utils/date';\nimport {formatNumberRender} from \"./format\";\nimport MultiPreAction from \"../core/multi_pre_action\";\nimport CellProxy from \"./cell_proxy\";\nimport CellProp from \"../model/cell_prop\";\nimport PaintFormat from \"../model/paint_format\";\n// private methods\n/*\n * {\n *  name: ''\n *  freeze: [0, 0],\n *  formats: [],\n *  styles: [\n *    {\n *      bgcolor: '',\n *      align: '',\n *      valign: '',\n *      textwrap: false,\n *      strike: false,\n *      underline: false,\n *      color: '',\n *      format: 1,\n *      border: {\n *        left: [style, color],\n *        right: [style, color],\n *        top: [style, color],\n *        bottom: [style, color],\n *      },\n *      font: {\n *        family: 'Helvetica',\n *        size: 10,\n *        bold: false,\n *        italic: false,\n *      }\n *    }\n *  ],\n *  merges: [\n *    'A1:F11',\n *    ...\n *  ],\n *  rows: {\n *    1: {\n *      height: 50,\n *      style: 1,\n *      cells: {\n *        1: {\n *          style: 2,\n *          type: 'string',\n *          text: '',\n *          value: '', // cal result\n *        }\n *      }\n *    },\n *    ...\n *  },\n *  cols: {\n *    2: { width: 100, style: 1 }\n *  }\n * }\n */\nconst defaultSettings = {\n    view: {\n        height: () => document.documentElement.clientHeight,\n        width: () => document.documentElement.clientWidth,\n    },\n    formula: {},\n    showGrid: true,\n    showToolbar: true,\n    showContextmenu: true,\n    showEditor: true,\n    autoLoad: true,\n    ignore: [],\n    cellWidth: 0,\n    ignoreRi: 0,\n    minus: false,\n    row: {\n        len: 100,\n        height: 25,\n    },\n    col: {\n        len: 26,\n        width: 100,\n        indexWidth: 60,\n        minWidth: 10,\n    },\n    rowsInit: false,\n    style: {\n        bgcolor: '#ffffff',\n        align: 'left',\n        valign: 'middle',\n        textwrap: false,\n        strike: false,\n        flexible: false,\n        underline: false,\n        autoAdapt: false,\n        color: '#0a0a0a',\n        font: {\n            name: 'Arial',\n            size: 10,\n            bold: false,\n            italic: false,\n        },\n    },\n};\n\nconst toolbarHeight = 41;\n\n\n// src: cellRange\n// dst: cellRange\nfunction canPaste(src, dst, error = () => {\n}) {\n    if (!dst) {\n        return false;\n    }\n    const {merges} = this;\n    const cellRange = dst.clone();\n    const [srn, scn] = src.size();\n    const [drn, dcn] = dst.size();\n    if (srn > drn) {\n        cellRange.eri = dst.sri + srn - 1;\n    }\n    if (scn > dcn) {\n        cellRange.eci = dst.sci + scn - 1;\n    }\n    if (merges.intersects(cellRange)) {\n        error(t('error.pasteForMergedCell'));\n        return false;\n    }\n    return true;\n}\n\nfunction copyPaste(srcCellRange, dstCellRange, what, autofill = false) {\n    const {rows, merges} = this;\n    // delete dest merge\n    if (what === 'all' || what === 'format') {\n        rows.deleteCells(dstCellRange, what);\n        merges.deleteWithin(dstCellRange);\n    }\n    rows.copyPaste(srcCellRange, dstCellRange, what, autofill, (ri, ci, cell) => {\n        if (cell && cell.merge) {\n            // console.log('cell:', ri, ci, cell);\n            const [rn, cn] = cell.merge;\n            if (rn <= 0 && cn <= 0) return;\n            merges.add(new CellRange(ri, ci, ri + rn, ci + cn));\n        }\n    });\n}\n\nfunction cutPaste(srcCellRange, dstCellRange, cleard) {\n    const {clipboard, rows, merges} = this;\n    rows.cutPaste(srcCellRange, dstCellRange);\n    merges.move(srcCellRange,\n        dstCellRange.sri - srcCellRange.sri,\n        dstCellRange.sci - srcCellRange.sci);\n    if (cleard)\n        clipboard.clear();\n}\n\n// bss: { top, bottom, left, right }\nfunction setStyleBorder(ri, ci, bss) {\n    const {styles, rows} = this;\n    const cell = rows.getCellOrNew(ri, ci);\n    let cstyle = {};\n    if (isHave(cell.style)) {\n        cstyle = helper.cloneDeep(styles[cell.style]);\n    }\n\n    Object.assign(cstyle, {border: bss});\n    cell.style = this.addStyle(cstyle);\n}\n\nfunction selectorCellText(ri, ci, text, event_type) {\n    if (ri == -1 || ci == -1) {\n        return {\n            \"state\": true,\n            \"msg\": \"单元格坐标有误\"\n        };\n    }\n    if (event_type !== 'style' && (!text || text[0] !== '=')) {\n        return {\n            \"state\": false,\n            \"msg\": \"正确\"\n        };\n    }\n\n    // state\n    let args = errorPop.call(this, text);\n    if (event_type !== 'style' && args.state === true) {\n        return {\n            \"msg\": args.msg,\n            \"state\": true,\n        };\n    }\n    return {\n        \"msg\": args.msg,\n        \"state\": false,\n    };\n}\n\nfunction errorPop(text) {\n    let enter = false;\n    let msg = \"\";\n    try {\n        let recast = new Recast(text);\n        recast.parse();\n    } catch (e) {\n        msg = '您输入的公式存在问题，请更正, 错误原因: ' + e.description;\n        enter = true;\n    }\n\n    if (enter == true) {\n        if (isLegal(text) == false) {\n            msg = '缺少左括号或右括号';\n            enter = true;\n        }\n    }\n\n    if (enter) {\n        return {\n            \"state\": true,\n            \"msg\": msg\n        };\n    } else {\n        return {\n            \"state\": false,\n            \"msg\": msg\n        };\n    }\n}\n\nfunction processPasteDirectionsArr(pasteDirectionsArr, type = 'to', sheet) {\n    if (type == 'to') {\n        let arr = [];\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            console.log(item);\n            let newItem = {\n                src: item.img2.src,\n                ri: item.ri,\n                ci: item.ci,\n                top: item.top,\n                left: item.left,\n                range: item.range,\n                offsetLeft: item.offsetLeft,\n                offsetTop: item.offsetTop,\n                nextLeft: item.nextLeft,\n                nextTop: item.nextTop,\n                img: item.img,\n                arr: item.arr,\n                img2: item.img2\n            };\n\n            arr.push(newItem);\n        }\n\n        return arr;\n    } else if (type == 'from') {\n        if (typeof sheet === 'string') {\n            return;\n        }\n        for (let i = 0; i < pasteDirectionsArr.length; i++) {\n            let item = pasteDirectionsArr[i];\n            let img = h('img', '');\n            img.el.src = item.src;\n            mountImg.call(sheet, img.el, true, item.ri, item.ci, item.range);\n        }\n    }\n}\n\nfunction clickCopyPasteHelp(ri, lci) {\n    let {rows} = this;\n    let lri = ri + 1;\n    let enter = true;\n    while (enter) {\n        let lcell = rows.getCellOrNew(lri, lci);\n        if (!lcell || !lcell.text) {\n            enter = false;\n        } else {\n            lri = lri + 1;\n        }\n    }\n\n    return lri;\n}\n\nfunction setStyleBorders({mode, style, color}) {\n    const {styles, selector, rows} = this;\n    const {\n        sri, sci, eri, eci,\n    } = selector.range;\n    const multiple = !this.isSignleSelected();\n    if (!multiple) {\n        if (mode === 'inside' || mode === 'horizontal' || mode === 'vertical') {\n            return;\n        }\n    }\n\n    for (let ri = sri; ri <= eri; ri += 1) {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            setStyleBorder.call(this, ri, ci, {});\n        }\n    }\n\n    if (mode === 'outside' && !multiple) {\n        setStyleBorder.call(this, sri, sci, {\n            top: [style, color], bottom: [style, color], left: [style, color], right: [style, color],\n        });\n    } else if (mode === 'none') {\n        selector.range.each((ri, ci) => {\n            const cell = rows.getCell(ri, ci);\n            if (cell && cell.style !== undefined) {\n                const ns = helper.cloneDeep(styles[cell.style]);\n                delete ns.border;\n                // ['bottom', 'top', 'left', 'right'].forEach((prop) => {\n                //   if (ns[prop]) delete ns[prop];\n                // });\n                cell.style = this.addStyle(ns);\n            }\n        });\n    } else if (mode === 'all' || mode === 'inside' || mode === 'outside'\n        || mode === 'horizontal' || mode === 'vertical') {\n        const merges = [];\n        for (let ri = sri; ri <= eri; ri += 1) {\n            for (let ci = sci; ci <= eci; ci += 1) {\n                // jump merges -- start\n                const mergeIndexes = [];\n                for (let ii = 0; ii < merges.length; ii += 1) {\n                    const [mri, mci, rn, cn] = merges[ii];\n                    if (ri === mri + rn + 1) mergeIndexes.push(ii);\n                    if (mri <= ri && ri <= mri + rn) {\n                        if (ci === mci) {\n                            ci += cn + 1;\n                            break;\n                        }\n                    }\n                }\n                mergeIndexes.forEach(it => merges.splice(it, 1));\n                if (ci > eci) break;\n                // jump merges -- end\n                const cell = rows.getCell(ri, ci);\n                let [rn, cn] = [0, 0];\n                if (cell && cell.merge) {\n                    [rn, cn] = cell.merge;\n                    merges.push([ri, ci, rn, cn]);\n                }\n                const mrl = rn > 0 && ri + rn === eri;\n                const mcl = cn > 0 && ci + cn === eci;\n                let bss = {};\n                if (mode === 'all') {\n                    bss = {\n                        bottom: [style, color],\n                        top: [style, color],\n                        left: [style, color],\n                        right: [style, color],\n                    };\n                } else if (mode === 'inside') {\n                    if (!mcl && ci < eci) bss.right = [style, color];\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'horizontal') {\n                    if (!mrl && ri < eri) bss.bottom = [style, color];\n                } else if (mode === 'vertical') {\n                    if (!mcl && ci <= eci) bss.right = [style, color];\n                } else if (mode === 'outside' && multiple) {\n                    if (sri === ri) bss.top = [style, color];\n                    if (mrl || eri === ri) bss.bottom = [style, color];\n                    if (sci === ci) bss.left = [style, color];\n                    if (mcl || eci === ci) bss.right = [style, color];\n                }\n                if (Object.keys(bss).length > 0) {\n                    setStyleBorder.call(this, ri, ci, bss);\n                }\n                ci += cn;\n            }\n        }\n    } else if (mode === 'top' || mode === 'bottom') {\n        for (let ci = sci; ci <= eci; ci += 1) {\n            if (mode === 'top') {\n                setStyleBorder.call(this, sri, ci, {top: [style, color]});\n                ci += rows.getCellMerge(sri, ci)[1];\n            }\n            if (mode === 'bottom') {\n                setStyleBorder.call(this, eri, ci, {bottom: [style, color]});\n                ci += rows.getCellMerge(eri, ci)[1];\n            }\n        }\n    } else if (mode === 'left' || mode === 'right') {\n        for (let ri = sri; ri <= eri; ri += 1) {\n            if (mode === 'left') {\n                setStyleBorder.call(this, ri, sci, {left: [style, color]});\n                ri += rows.getCellMerge(ri, sci)[0];\n            }\n            if (mode === 'right') {\n                setStyleBorder.call(this, ri, eci, {right: [style, color]});\n                ri += rows.getCellMerge(ri, eci)[0];\n            }\n        }\n    }\n}\n\nfunction getCellRowByAbsX(scrollOffsetx) {\n    let x = scrollOffsetx;\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: 0, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction getCellRowByAbsY(scrollOffsety) {\n    let y = scrollOffsety;\n    let {rows} = this;\n    let ri = 0;\n    let top = rows.height;\n    const frset = this.exceptRowSet;\n    let {height} = rows;\n\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n\n    if (ri <= 0) {\n        ri = 0;\n    }\n    if (height <= 0) {\n        height = 0;\n    }\n\n    return {ri: ri, top, height};\n}\n\nfunction getCellRowByY(y, scrollOffsety) {\n    const {rows} = this;\n    const fsh = this.freezeTotalHeight();\n    // console.log('y:', y, ', fsh:', fsh);\n    let inits = rows.height;\n    if (fsh + rows.height < y) inits -= scrollOffsety;\n\n    // handle ri in autofilter\n    const frset = this.exceptRowSet;\n\n    let ri = 0;\n    let top = inits;\n    let {height} = rows;\n    for (; ri < rows.len; ri += 1) {\n        if (top > y) break;\n        if (!frset.has(ri)) {\n            height = rows.getHeight(ri);\n            top += height;\n        }\n    }\n    top -= height;\n    // console.log('ri:', ri, ', top:', top, ', height:', height);\n\n    if (top <= 0) {\n        return {ri: -1, top: 0, height};\n    }\n\n    return {ri: ri - 1, top, height};\n}\n\nfunction getCellColByX(x, scrollOffsetx) {\n    const {cols} = this;\n    const fsw = this.freezeTotalWidth();\n    let inits = cols.indexWidth;\n    if (fsw + cols.indexWidth <= x) inits -= scrollOffsetx;\n    const [ci, left, width] = helper.rangeReduceIf(\n        0,\n        cols.len,\n        inits,\n        cols.indexWidth,\n        x,\n        i => cols.getWidth(i),\n    );\n    if (left <= 0) {\n        return {ci: -1, left: 0, width: cols.indexWidth};\n    }\n    return {ci: ci - 1, left, width};\n}\n\nfunction makeFormatCell({text, formula}, {symbol, position}, cb) {\n    if (!isHave(text) || !isNumber(text)) {\n        return null;\n    }\n\n    let cText = cb(formatNumberRender(text, -1));\n    formula = isFormula(formula) ? formula : cText;\n    if (!isNaN(cText)) {\n        let _cell = {\n            \"text\": position === 'begin' ? symbol + cText : cText + symbol,\n            \"value\": text,\n            \"formulas\": formula,\n        };\n        return _cell;\n    } else {\n        return null;\n    }\n}\n\n// what = 'input' || 'change'\nfunction tryParseToNum(cell, ri, ci) {\n    return getType.call(this, ri, ci, cell);\n}\n\nfunction getType(ri, ci, cell) {\n    let data = this;\n    let {rows} = this;\n    let cellStyle = data.getCellStyle(ri, ci);\n    let {isValid, diff} = dateDiff(cell.text);\n\n    let format = rows.getCellStyleConvert(cellStyle, isValid);\n    if (format === 'number') {\n        let text = cell.text, formula = cell.formulas;\n        let _cell = {};\n        if (isValid) {\n            _cell = {\n                \"text\": diff.toFixed(2),\n                \"formulas\": formula,\n            };\n        } else {\n            text = formatNumberRender(text, 2);\n            _cell = {\n                \"text\": text,\n                \"value\": cell.text,\n                \"formulas\": formula,\n            };\n        }\n\n        if (isHave(_cell.text) && isNumber(_cell.text)) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        } else {\n            return {\n                \"state\": false,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'date' || format === 'datetime') {\n        let text = cell.text, formula = cell.formulas, minute = false;\n        let _cell = {};\n\n        if (!isValid) {\n            let args = formatDate(text);\n            let {state, date, date_formula} = args;\n            minute = args.minute;\n            isValid = state;\n            diff = cell.text;\n            text = date;\n        }\n\n        if (isValid) {\n            if (format === 'datetime') {\n                text = changeFormat(formatDate(dateDiff(text).diff).date);\n            }\n            _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n        }\n\n        return {\n            \"state\": isValid,\n            \"style\": format,\n            \"text\": !isHave(cellStyle) ? diff : text,\n        };\n    } else if (format === 'normal') {\n        if (isValid) {\n            let text = diff, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": rows.toString(formula),\n                \"text\": rows.toString(text),\n            };\n\n            return {\n                \"state\": true,\n                \"text\": _cell.text,\n                \"style\": format,\n                \"cell\": _cell,\n            }\n        } else {\n            let text = cell.text, formula = cell.formulas;\n            let _cell = {\n                \"formulas\": formula,\n                \"text\": text,\n            };\n\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            }\n        }\n    } else if (format === 'rmb') {\n        let text = \"\", formula = \"\";\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = formatNumberRender(cell.text, 0);\n            formula = cell.formulas;\n        }\n\n        let _cell = makeFormatCell({text, formula}, {symbol: \"￥\", position: \"begin\"}, (s) => {\n            return s;\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    } else if (format === 'percent') {\n        let text = \"\", formula = \"\";\n\n        if (isValid) {\n            text = diff;\n            formula = isFormula(cell.formulas) ? cell.formulas : diff;\n        } else {\n            text = rows.useOne(cell.value, cell.text);\n            formula = cell.formulas;\n        }\n        let _cell = makeFormatCell({text, formula}, {symbol: \"%\", position: \"end\"}, (s) => {\n            return Number(s * 100).toFixed(2);\n        });\n        if (_cell) {\n            return {\n                \"state\": true,\n                \"style\": format,\n                \"text\": _cell.text,\n                \"cell\": _cell,\n            };\n        }\n    }\n\n    return {\n        \"state\": false,\n        \"style\": format,\n        \"text\": cell.text,\n        \"cell\": {},\n    };\n}\n\n\nexport default class DataProxy {\n    constructor(name, settings, methods) {\n        this.settings = helper.merge(defaultSettings, settings || {});\n        // save data begin\n        this.name = name || 'sheet';\n        this.methods = methods;\n        this.freeze = [0, 0];\n        this.styles = []; // Array<Style>\n        this.merges = new Merges(); // [CellRange, ...]\n        this.rows = new Rows(this.settings.row, this);\n        this.cols = new Cols(this.settings.col);\n        this.validations = new Validations();\n        this.hyperlinks = {};\n        this.comments = {};\n        this.showEquation = false;\n        this.calc = formulaCalc();\n        this.pasteDirectionsArr = [];\n        this.changeDataForCalc = null;\n\n        // save data end\n\n        // don't save object\n        this.multiPreAction = new MultiPreAction(this);\n        this.selector = new Selector();\n        this.scroll = new Scroll();\n        // this.history = new History(this);\n        this.clipboard = new Clipboard();\n        this.moved = new Moved();\n        this.autoFilter = new AutoFilter();\n        this.change = () => {\n        };\n        this.exceptRowSet = new Set();\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n    }\n\n    addValidation(mode, ref, validator) {\n        // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);\n        this.changeData(() => {\n            this.validations.add(mode, ref, validator);\n        });\n    }\n\n    removeValidation() {\n        const {range} = this.selector;\n        this.changeData(() => {\n            this.validations.remove(range);\n        });\n    }\n\n    tryParseToNum(cell, ri, ci) {\n        return tryParseToNum.call(this, cell, ri, ci);\n    }\n\n    clickCopyPaste() {\n        let ri = this.selector.range.eri;\n        let ci = this.selector.range.eci;\n        let {rows} = this;\n        const cell = rows.getCellOrNew(ri, ci);\n        const cell2 = rows.getCellOrNew(ri + 1, ci);\n        if (!cell || !cell.text || (cell2 && cell2.text)) {\n            return {\n                enter: false\n            };\n        }\n\n        let left = clickCopyPasteHelp.call(this, ri, ci - 1);\n        let right = clickCopyPasteHelp.call(this, ri, ci + 1);\n        let eri = left < right ? right : left;\n\n        let enter = false;\n        for (let i = 1; i < eri && enter === false; i++) {\n            let cell3 = rows.getCellOrNew(ri + i, ci);\n\n            if (cell3 && cell3.text) {\n                eri = ri + i;\n                enter = true;\n            }\n        }\n\n\n        let dstCellRange = new CellRange(ri + 1, ci, eri - 1, ci);\n        let srcCellRange = new CellRange(ri, ci, ri, ci);\n\n        return {\n            enter: true,\n            dstCellRange: dstCellRange,\n            srcCellRange: srcCellRange\n        };\n    }\n\n\n    getSelectedValidator() {\n        const {ri, ci} = this.selector;\n        const v = this.validations.get(ri, ci);\n        return v ? v.validator : null;\n    }\n\n    getSelectedValidation() {\n        const {ri, ci, range} = this.selector;\n        const v = this.validations.get(ri, ci);\n        const ret = {ref: range.toString()};\n        if (v !== null) {\n            ret.mode = v.mode;\n            ret.validator = v.validator;\n        }\n        return ret;\n    }\n\n    canUndo() {\n        return this.multiPreAction.getItems(1).length > 0;\n        // return this.history.canUndo();\n    }\n\n    canRedo() {\n        return this.multiPreAction.getItems(2).length > 0;\n    }\n\n    undo(sheet) {\n        this.multiPreAction.undo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.undo(this.getData(), (d) => {\n        //     this.setData(d);\n        // }, sheet);\n    }\n\n    historyList(item) {\n        return this.multiPreAction.getItems(item);\n    }\n\n    redo() {\n        this.multiPreAction.redo();\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        // this.history.redo(this.getData(), (d) => {\n        //     this.setData(d);\n        // });\n    }\n\n    copy() {\n        document.execCommand('copy', true);\n        this.clipboard.copy(this.selector.range);\n    }\n\n    makeCellPropArr(range, dsri, dsci) {\n        let {rows} = this;\n        let darr = [];\n        let cells = rows.eachRange(range);\n        for (let i = 0; i < cells.length; i++) {\n            let {ri, ci, cell} = cells[i];\n\n            if (isHave(cell) && isHave(cell.style) === false) {\n                let cstyle = this.defaultStyle();\n                cell.style = this.addStyle(cstyle);\n            }\n\n            let cellProp = new CellProp(ri + dsri, ci + dsci, cell, xy2expr(ri + dsri, ci + dsci));\n            darr.push(cellProp);\n        }\n\n        return darr;\n    }\n\n    setCellByCellProp(pArr, cb) {\n        let {rows} = this;\n        for (let i = 0; i < pArr.length; i++) {\n            let {ri, ci, cell} = pArr[i];\n            if (isHave(cell) && isHave(cell.style)) {\n                rows.setCell(ri, ci, cell, 'style');\n            }\n            cb(ri, ci);\n        }\n    }\n\n    paintFormatChange(cb) {\n        this.changeData(() => {\n            let {clipboard, rows, selector} = this;\n            let {range} = clipboard;\n            let sri = selector.ri;\n            let sci = selector.ci;\n\n            let dsri = sri - range.sri;\n            let dsci = sci - range.sci;\n            let darr = this.makeCellPropArr(range, dsri, dsci);\n\n            if (selector.range.eri - selector.range.sri === 0 && selector.range.eci - selector.range.sci === 0) {\n                this.setCellByCellProp(darr, cb);\n            } else {\n                let paintFormat = new PaintFormat(range, selector.range);\n                let paintType = paintFormat.getPaintType();\n                let pArr = paintFormat.makePaintArr(paintType, darr);\n\n                this.setCellByCellProp(pArr, cb);\n            }\n        }, {type: 12, cellRange: this.selector.range});\n    }\n\n    move() {\n        this.moved.move();\n    }\n\n    cut() {\n        this.clipboard.cut(this.selector.range);\n    }\n\n    paste(cellRange) {\n        this.changeData(() => {\n\n        }, {type: 6, cellRange: cellRange});\n    }\n\n    // what: all | text | format\n    // paste(what = 'all', error = () => {\n    // }) {\n    //\n    //     // console.log('sIndexes:', sIndexes);\n    //     // const {clipboard, selector} = this;\n    //     // if (clipboard.isClear()) return false;\n    //     // if (!canPaste.call(this, clipboard.range, selector.range, error)) return false;\n    //     //\n    //     // this.changeData(() => {\n    //     //     if (clipboard.isCopy()) {\n    //     //         copyPaste.call(this, clipboard.range, selector.range, what);\n    //     //     } else if (clipboard.isCut()) {\n    //     //         cutPaste.call(this, clipboard.range, selector.range);\n    //     //     }\n    //     // });\n    //     return true;\n    // }\n\n    autofill(cellRange, what, error = () => {\n    }) {\n        const srcRange = this.selector.range;\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        }, {type: 5, cellRange: cellRange});\n\n        return true;\n    }\n\n\n    clickAutofill(srcRange, cellRange, what, error = () => {\n    }) {\n        if (!canPaste.call(this, srcRange, cellRange, error)) return false;\n        this.changeData(() => {\n            copyPaste.call(this, srcRange, cellRange, what, true);\n        });\n        return true;\n    }\n\n    clearClipboard() {\n        this.clipboard.clear();\n    }\n\n    calSelectedRangeByEnd(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let {\n            sri, sci, eri, eci,\n        } = selector.range;\n        const cri = selector.ri;\n        const cci = selector.ci;\n        let [nri, nci] = [ri, ci];\n        if (ri < 0) nri = rows.len - 1;\n        if (ci < 0) nci = cols.len - 1;\n        // row index\n        if (nri <= cri) [sri, eri] = [nri, cri];\n        else eri = nri;\n        // col index\n        if (nci <= cci) [sci, eci] = [nci, cci];\n        else eci = nci;\n        selector.range = merges.union(new CellRange(\n            sri, sci, eri, eci,\n        ));\n        // console.log('selector.range:', selector.range);\n        return selector.range;\n    }\n\n\n    calSelectedRangeByStart(ri, ci) {\n        const {\n            selector, rows, cols, merges,\n        } = this;\n        let cellRange = merges.getFirstIncludes(ri, ci);\n        // console.log('cellRange:', cellRange, ri, ci, merges);\n        if (cellRange === null) {\n            cellRange = new CellRange(ri, ci, ri, ci);\n            if (ri === -1) {\n                cellRange.sri = 0;\n                cellRange.eri = rows.len - 1;\n            }\n            if (ci === -1) {\n                cellRange.sci = 0;\n                cellRange.eci = cols.len - 1;\n            }\n        }\n        selector.range = cellRange;\n        return cellRange;\n    }\n\n    initPercent() {\n\n    }\n\n    setSelectedCellAttr(property, value) {\n        this.changeData(() => {\n            const {selector, styles, rows} = this;\n            if (property === 'merge') {\n                if (value) this.merge();\n                else this.unmerge();\n            } else if (property === 'border') {\n                setStyleBorders.call(this, value);\n            } else if (property === 'formula') {\n                const cell = rows.getCellOrNew(selector.ri, selector.ci);\n                cell.text = `=${value}()`;\n                cell.formulas = `=${value}()`;\n            } else {\n                selector.range.each((ri, ci) => {\n                    let cell = rows.getCellOrNew(ri, ci);\n\n                    let cstyle = {};\n                    if (isHave(cell.style)) {\n                        cstyle = helper.cloneDeep(styles[cell.style]);\n                    }\n                    if (property === 'format') {\n                        cstyle.format = value;\n                        // cell.text = cell.text.replace(\"¥\", \"\");\n                        // cell.formulas = cell.formulas.replace(\"¥\", \"\");\n                        rows.setCellText(ri, ci, {\n                            text: cell.text,\n                            style: this.addStyle(cstyle)\n                        }, 'format');\n                        // this.rows.workbook.change(ri, ci, cell, deepCopy(cell), 'change');\n                    } else if (property === 'font-bold' || property === 'font-italic'\n                        || property === 'font-name' || property === 'font-size') {\n                        const nfont = {};\n                        nfont[property.split('-')[1]] = value;\n                        cstyle.font = Object.assign(cstyle.font || {}, nfont);\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'flexible') {\n                        if (this.exceptRowSet.has(ri + 1) && this.exceptRowSet.has(ri + 2) && !this.exceptRowSet.has(ri + 3)) {\n                            this.exceptRowSet.delete(ri);\n                            this.exceptRowSet.delete(ri + 1);\n                            this.exceptRowSet.delete(ri + 2);\n                        } else {\n                            this.exceptRowSet.add(ri);\n                            this.exceptRowSet.add(ri + 1);\n                            this.exceptRowSet.add(ri + 2);\n                        }\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    } else if (property === 'strike' || property === 'textwrap'\n                        || property === 'underline'\n                        || property === 'align' || property === 'valign'\n                        || property === 'color' || property === 'bgcolor') {\n                        cstyle[property] = value;\n                        cell.style = this.addStyle(cstyle);\n                    }\n                });\n            }\n        }, {type: 11, cellRange: this.selector.range, property, value});\n    }\n\n    // state: input | finished\n    setSelectedCellText(text, state = 'input') {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        this.setCellText(nri, ci, {text}, state);\n        this.resetAutoFilter();\n    }\n\n    // state: input | finished\n    setSelectedCell(text, state = 'input', formulas, ri, ci) {\n        this.setCellAll(ri, ci, text, formulas, state);\n        this.resetAutoFilter();\n    }\n\n    getSelectedCell() {\n        const {ri, ci} = this.selector;\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    editorChangeToHistory(oldCell, {ri, ci}, type) {\n        if (ri === -1 || ci === -1) {\n            return {\"state\": false}\n        }\n        let newCell = this.rows.getCell(ri, ci);\n        // if (oldCell.text === newCell.text || oldCell.formulas === newCell.text) {\n        //     return {\n        //         \"state\": false,\n        //     };\n        // }\n        let {multiPreAction} = this;\n        let expr = xy2expr(ci, ri);\n        let step = multiPreAction.getStepType(type, {ri, ci, expr, text: newCell.text});\n\n        let oc = new CellProp(ri, ci, oldCell, expr)\n        let nc = new CellProp(ri, ci, newCell, expr)\n        multiPreAction.addStep(step, {oldCell: [oc], newCell: [nc]});\n        this.changeDataForCalc = this.getChangeDataToCalc();\n        return {\n            \"state\": true\n        }\n    }\n\n    changeToHistory({ri, type, ci, cellRange, property, value, oldCell, oldMergesData}, oldStep) {\n        if (type === -1) {\n            return {\"state\": false,}\n        }\n\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n        multiPreAction.addStep(step, {oldCell, oldMergesData, newMergesData: this.merges.getData(), oldStep,});\n        return {\n            \"state\": true\n        }\n    }\n\n    getSelectedCellRiCi(ri, ci) {\n        let nri = ri;\n        if (this.unsortedRowMap.has(ri)) {\n            nri = this.unsortedRowMap.get(ri);\n        }\n        return this.rows.getCell(nri, ci);\n    }\n\n    xyInSelectedRect(x, y) {\n        const {\n            left, top, width, height,\n        } = this.getSelectedRect();\n        const x1 = x - this.cols.indexWidth;\n        const y1 = y - this.rows.height;\n        // console.log('x:', x, ',y:', y, 'left:', left, 'top:', top);\n        return x1 > left && x1 < (left + width)\n            && y1 > top && y1 < (top + height);\n    }\n\n    isMergeCell(ri, ci) {\n        let state = false;\n        let data = \"\";\n        this.merges.each((range) => {\n            if (range.includeByRiCi(ri, ci)) {\n                state = true;\n                data = range;\n            }\n        });\n        return {\n            \"state\": state,\n            \"data\": data,\n        };\n    }\n\n    getSelectedRect() {\n        return this.getRect(this.selector.range);\n    }\n\n    getClipboardRect() {\n        const {clipboard} = this;\n        if (!clipboard.isClear()) {\n            return this.getRect(clipboard.range);\n        }\n        return {left: -100, top: -100};\n    }\n\n\n    getMoveRect(range) {\n        return this.getRect(range);\n    }\n\n    getRect(cellRange) {\n        const {\n            scroll, rows, cols, exceptRowSet,\n        } = this;\n        const {\n            sri, sci, eri, eci,\n        } = cellRange;\n        // console.log('sri:', sri, ',sci:', sci, ', eri:', eri, ', eci:', eci);\n        // no selector\n        if (sri < 0 && sci < 0) {\n            return {\n                left: 0, l: 0, top: 0, t: 0, scroll,\n            };\n        }\n        const left = cols.sumWidth(0, sci);\n        const top = rows.sumHeight(0, sri, exceptRowSet);\n        const height = rows.sumHeight(sri, eri + 1, exceptRowSet);\n        const width = cols.sumWidth(sci, eci + 1);\n        // console.log('sri:', sri, ', sci:', sci, ', eri:', eri, ', eci:', eci);\n        let left0 = left - scroll.x;\n        let top0 = top - scroll.y;\n        const fsh = this.freezeTotalHeight();\n        const fsw = this.freezeTotalWidth();\n        if (fsw > 0 && fsw > left) {\n            left0 = left;\n        }\n        if (fsh > 0 && fsh > top) {\n            top0 = top;\n        }\n        return {\n            l: left,\n            t: top,\n            left: left0,\n            top: top0,\n            height,\n            width,\n            scroll,\n        };\n    }\n\n    getCellRectByXY(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n        if (ci === -1) {\n            width = cols.totalWidth();\n        }\n        if (ri === -1) {\n            height = rows.totalHeight();\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    getCellRectByXYWithNotTotalResult(x, y) {\n        const {\n            scroll, merges, rows, cols,\n        } = this;\n\n        let {ri, top, height} = getCellRowByY.call(this, y, scroll.y);\n        let {ci, left, width} = getCellColByX.call(this, x, scroll.x);\n\n\n        if (ci === -1) {\n            // // width = cols.totalWidth();\n            // let args = getCellRowByAbsX.call(this, scroll.x);\n            // console.log(args);\n            // // ci = args.ci;\n        }\n        if (ri === -1) {\n            // let args = getCellRowByAbsY.call(this, scroll.y);\n            // console.log(\"1179: \", args.ri);\n            // ri = args.ri;\n        }\n        if (ri >= 0 || ci >= 0) {\n            const merge = merges.getFirstIncludes(ri, ci);\n            if (merge) {\n                ri = merge.sri;\n                ci = merge.sci;\n                ({\n                    left, top, width, height,\n                } = this.cellRect(ri, ci));\n            }\n        }\n        return {\n            ri, ci, left, top, width, height,\n        };\n    }\n\n\n    isSignleSelected() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return !this.selector.multiple();\n    }\n\n    canUnmerge() {\n        const {\n            sri, sci, eri, eci,\n        } = this.selector.range;\n        const cell = this.getCell(sri, sci);\n        if (cell && cell.merge) {\n            const [rn, cn] = cell.merge;\n            if (sri + rn === eri && sci + cn === eci) return true;\n        }\n        return false;\n    }\n\n    dateInput(cell, ri, ci, type) {\n        // let cstyle = this.getCellStyle(ri, ci) || {};\n        // cstyle.format = type;\n        // cell.style = this.addStyle(cstyle);\n        // this.rows.setCell(ri, ci, cell, type);\n    }\n\n    merge() {\n        const {selector, rows} = this;\n        if (this.isSignleSelected()) return;\n        const [rn, cn] = selector.size();\n        // console.log('merge:', rn, cn);\n        if (rn > 1 || cn > 1) {\n            const {sri, sci} = selector.range;\n            const cell = rows.getCellOrNew(sri, sci);\n            cell.merge = [rn - 1, cn - 1];\n            this.merges.add(selector.range);\n            // delete merge cells\n            this.rows.deleteCells(selector.range);\n            // console.log('cell:', cell, this.d);\n            this.rows.setCell(sri, sci, cell);\n        }\n    }\n\n    unmerge() {\n        const {selector} = this;\n        if (!this.isSignleSelected()) return;\n        const {sri, sci} = selector.range;\n        this.changeData(() => {\n            this.rows.deleteCell(sri, sci, 'merge');\n            this.merges.deleteWithin(selector.range);\n        });\n    }\n\n    canAutofilter() {\n        return !this.autoFilter.active();\n    }\n\n    autofilter() {\n        const {autoFilter, selector} = this;\n        this.changeData(() => {\n            if (autoFilter.active()) {\n                autoFilter.clear();\n                this.exceptRowSet = new Set();\n                this.sortedRowMap = new Map();\n                this.unsortedRowMap = new Map();\n            } else {\n                let v = selector.range.toString();\n                let eri = selector.range.eri;\n                const {rows} = this;\n\n                for (let i = selector.range.sci; i <= selector.range.eci; i++) {\n                    let range = new CellRange(selector.range.sri, i, selector.range.sri, i);\n                    range = rows.autoFilterRef(v, range);\n                    if (eri < range.eri) {\n                        eri = range.eri;\n                    }\n                }\n                let range = new CellRange(selector.range.sri, selector.range.sci, eri, selector.range.eci);\n                autoFilter.ref = range.toString();\n            }\n        });\n    }\n\n    throwFormula() {\n        const {selector, rows} = this;\n\n        this.changeData(() => {\n            selector.range.each((i, j) => {\n                const cell = rows.getCellOrNew(i, j);\n                if (cell && cell.text && cell.formulas) {\n                    rows.setCellAll(i, j, cell.text, cell.text);\n                }\n            });\n        });\n    }\n\n    setAutoFilter(ci, order, operator, value) {\n        const {autoFilter} = this;\n        autoFilter.addFilter(ci, operator, value);\n        autoFilter.setSort(ci, order);\n        this.resetAutoFilter();\n    }\n\n    resetAutoFilter() {\n        const {autoFilter, rows} = this;\n        if (!autoFilter.active()) return;\n        const {sort} = autoFilter;\n\n        const {rset, fset} = autoFilter.filteredRows((r, c) => rows.getCell(r, c));\n        const fary = Array.from(fset);\n        const oldAry = Array.from(fset);\n        if (sort) {\n            fary.sort((a, b) => {\n                if (sort.order === 'asc') return a - b;\n                if (sort.order === 'desc') return b - a;\n                return 0;\n            });\n        }\n        this.exceptRowSet = rset;\n        this.sortedRowMap = new Map();\n        this.unsortedRowMap = new Map();\n        fary.forEach((it, index) => {\n            this.sortedRowMap.set(oldAry[index], it);\n            this.unsortedRowMap.set(it, oldAry[index]);\n        });\n    }\n\n    deleteCell(what = 'all') {\n        const {selector} = this;\n        this.changeData(() => {\n            this.rows.deleteCells(selector.range, what);\n            if (what === 'all' || what === 'format') {\n                this.merges.deleteWithin(selector.range);\n            }\n        }, {type: 2});\n    }\n\n    // type: row | column\n    insert(type, n = 1, begin = -1) {\n        let {\n            mri,\n            mci\n        } = this.getMax();\n        const {sri, sci} = this.selector.range;\n        const {rows, merges, cols} = this;\n        let dri = 0, dci = 0;\n        if (type === 'row') {\n            begin = begin != -1 ? begin : sri;\n            dri = begin;\n            dci = 0;\n        } else if ('column') {\n            begin = begin != -1 ? begin : sci;\n            dci = begin;\n            dri = 0;\n        }\n\n        this.changeData(() => {\n            let si = begin;\n            if (type === 'row') {\n                rows.insert(begin, n);\n            } else if (type === 'column') {\n                rows.insertColumn(begin, n);\n                si = begin;\n                cols.len += n;\n            }\n            merges.shift(type, si, n, (ri, ci, rn, cn) => {\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n            });\n        }, {type: 13, data: this.getData(), property: \"insert\"});\n    }\n\n    // type: row | column\n    delete(type) {\n        this.changeData(() => {\n            const {\n                rows, merges, selector, cols,\n            } = this;\n            const {range} = selector;\n            const {\n                sri, sci, eri, eci,\n            } = selector.range;\n            const [rsize, csize] = selector.range.size();\n            let si = sri;\n            let size = rsize;\n            if (type === 'row') {\n                rows.delete(sri, eri);\n            } else if (type === 'column') {\n                rows.deleteColumn(sci, eci);\n                si = range.sci;\n                size = csize;\n                cols.len -= 1;\n            }\n            // console.log('type:', type, ', si:', si, ', size:', size);\n            merges.shift(type, si, -size, (ri, ci, rn, cn) => {\n                // console.log('ri:', ri, ', ci:', ci, ', rn:', rn, ', cn:', cn);\n                const cell = rows.getCell(ri, ci);\n                cell.merge[0] += rn;\n                cell.merge[1] += cn;\n                if (cell.merge[0] === 0 && cell.merge[1] === 0) {\n                    delete cell.merge;\n                }\n            });\n        });\n    }\n\n    scrollx(x, cb) {\n        const {scroll, freeze, cols} = this;\n        const [, fci] = freeze;\n        const [\n            ci, left, width,\n        ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));\n        // console.log('fci:', fci, ', ci:', ci);\n        let x1 = left;\n        if (x > 0) x1 += width;\n        if (scroll.x !== x1) {\n            scroll.ci = x > 0 ? ci : 0;\n            scroll.x = x1;\n            cb();\n        }\n    }\n\n    scrolly(y, cb) {\n        const {scroll, freeze, rows} = this;\n        const [fri] = freeze;\n        const [\n            ri, top, height,\n        ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));\n        let y1 = top;\n        if (y > 0) y1 += height;\n        // console.log('ri:', ri, ' ,y:', y1);\n        if (scroll.y !== y1) {\n            scroll.ri = y > 0 ? ri : 0;\n            scroll.y = y1;\n            cb();\n        }\n    }\n\n    cellRect(ri, ci) {\n        const {rows, cols} = this;\n        const left = cols.sumWidth(0, ci);\n        const top = rows.sumHeight(0, ri);\n        const cell = rows.getCell(ri, ci);\n        let width = cols.getWidth(ci);\n        let height = rows.getHeight(ri);\n        if (cell !== null) {\n            if (cell.merge) {\n                const [rn, cn] = cell.merge;\n                // console.log('cell.merge:', cell.merge);\n                if (rn > 0) {\n                    for (let i = 1; i <= rn; i += 1) {\n                        height += rows.getHeight(ri + i);\n                    }\n                }\n                if (cn > 0) {\n                    for (let i = 1; i <= cn; i += 1) {\n                        width += cols.getWidth(ci + i);\n                    }\n                }\n            }\n        }\n        // console.log('data:', this.d);\n        return {\n            left, top, width, height, cell,\n        };\n    }\n\n    getCell(ri, ci) {\n        return this.rows.getCell(ri, ci);\n    }\n\n    getMax() {\n        let mci = this.cols.len;\n        let mri = this.rows.len;\n\n        return {\n            mri,\n            mci\n        }\n    }\n\n\n    isEmpty(cell) {\n        return this.rows.isEmpty(cell);\n    }\n\n    renderFormat(style, cell, nrindex, cindex, filter) {\n        let cellProxy = new CellProxy(cell);\n        return cellProxy.renderFormat(style, nrindex, cindex, this, filter);\n    }\n\n    isFormula(text) {\n        return this.rows.isFormula(text);\n    }\n\n    toString(text) {\n        return this.rows.toString(text);\n    }\n\n    isBackEndFunc(text) {\n        return this.rows.isBackEndFunc(text);\n    }\n\n    isReferOtherSheet(cell) {\n        return this.rows.isReferOtherSheet(cell);\n    }\n\n    getCellTextOrDefault(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        return (cell && cell.text) ? cell.text : '';\n    }\n\n    getCellStyle(ri, ci) {\n        const cell = this.getCell(ri, ci);\n        if (cell && cell.style !== undefined) {\n            return this.styles[cell.style];\n        }\n        return null;\n    }\n\n    getCellStyleHandle(index, type, cell, ri, ci) {\n        let style = this.styles[index];\n\n        if (style && style.format === type) {\n            return true;\n        }\n        return false;\n    }\n\n    getCellStyleOrDefault(ri, ci) {\n        const {styles, rows} = this;\n        const cell = rows.getCell(ri, ci);\n        const cellStyle = (cell && cell.style !== undefined) ? styles[cell.style] : {};\n        return helper.merge(this.defaultStyle(), cellStyle);\n    }\n\n    getSelectedCellStyle() {\n        const {ri, ci} = this.selector;\n        return this.getCellStyleOrDefault(ri, ci);\n    }\n\n    getCellByExpr(src, table, name, inputText, pos) {\n        let p1 = inputText.substring(0, pos);\n        let p2 = inputText.substring(pos, inputText.length);\n        inputText = p1 + src + p2;\n        let workbook = parseCell2.call(table, this.viewRange(), true, inputText);\n        return {\n            \"text\": workbook['Sheets'][name].A1.w ? workbook['Sheets'][name].A1.w : workbook['Sheets'][name].A1.v,\n            \"formulas\": p1 + `${name}!` + src + p2\n        };\n    }\n\n    // state: input | finished\n    setCellText(ri, ci, {text, style}, state) {\n        // text = text.replace(/\\\"/g)\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellText(ri, ci, {text: ''});\n            history.add(this.getData());\n            rows.setCellText(ri, ci, {text});\n        } else {\n            if (state === 'end') {\n                rows.setCellAll(ri, ci, text);\n            } else if (state === 'formulas') {\n                rows.setCellAll(ri, ci, text, \"-\");\n            } else if (state === 'style') {\n                rows.setCellText(ri, ci, {text, style}, 'style');\n            } else {\n                rows.setCellText(ri, ci, {text});\n                // rows.\n            }\n            // 不应该没打开一个单元格就 change一次\n            this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text);\n    }\n\n    setCellWithFormulas(ri, ci, text, formulas, what = 'all') {\n        const {rows} = this;\n        rows.setCellAll(ri, ci, text, formulas, what);\n    }\n\n\n    // state: input | finished\n    setCellAll(ri, ci, text, formulas, state) {\n        const {rows, history, validations} = this;\n        if (state === 'finished') {\n            rows.setCellAll(ri, ci, '', '');\n            history.add(this.getData());\n            rows.setCellAll(ri, ci, text, formulas);\n        } else {\n            rows.setCellAll(ri, ci, text, formulas);\n            // this.change(this.getData());\n        }\n        // validator\n        validations.validate(ri, ci, text, formulas);\n    }\n\n    equationIsActive() {\n        return this.showEquation;\n    }\n\n    freezeIsActive() {\n        const [ri, ci] = this.freeze;\n        return ri > 0 || ci > 0;\n    }\n\n    setFreeze(ri, ci) {\n        this.changeData(() => {\n            this.freeze = [ri, ci];\n        });\n    }\n\n    freezeTotalWidth() {\n        return this.cols.sumWidth(0, this.freeze[1]);\n    }\n\n    freezeTotalHeight() {\n        return this.rows.sumHeight(0, this.freeze[0]);\n    }\n\n    setRowHeight(ri, height) {\n        this.changeData(() => {\n            this.rows.setHeight(ri, height);\n        }, {type: 3, ri: ri});\n    }\n\n    setColWidth(ci, width) {\n        this.changeData(() => {\n            this.cols.setWidth(ci, width);\n        }, {type: 4, ci: ci});\n    }\n\n    viewHeight() {\n        const {view, showToolbar} = this.settings;\n        let h = view.height();\n        if (showToolbar) {\n            h -= toolbarHeight;\n        }\n        return h;\n    }\n\n    viewWidth() {\n        return this.settings.view.width();\n    }\n\n    freezeViewRange() {\n        const [ri, ci] = this.freeze;\n        return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());\n    }\n\n    viewRange() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n            if (x > this.viewWidth()) break;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    viewRange2() {\n        const {\n            scroll, rows, cols, freeze,\n        } = this;\n        let {ri, ci} = scroll;\n        if (ri <= 0) [ri] = freeze;\n        if (ci <= 0) [, ci] = freeze;\n\n        let [x, y] = [0, 0];\n        let [eri, eci] = [rows.len, cols.len];\n        for (let i = ri; i < rows.len; i += 1) {\n            y += rows.getHeight(i);\n            eri = i;\n            if (y > this.viewHeight()) break;\n        }\n        for (let j = ci; j < cols.len; j += 1) {\n            x += cols.getWidth(j);\n            eci = j;\n        }\n\n        // console.log(ri, ci, eri, eci, x, y);\n        return new CellRange(ri, ci, eri, eci, x, y);\n    }\n\n    eachMergesInView(viewRange, cb) {\n        this.merges.filterIntersects(viewRange)\n            .forEach(it => cb(it));\n    }\n\n    rowEach(min, max, cb) {\n        let y = 0;\n        const {rows} = this;\n        const frset = this.exceptRowSet;\n        const frary = [...frset];\n        let offset = 0;\n        for (let i = 0; i < frary.length; i += 1) {\n            if (frary[i] < min) offset += 1;\n        }\n        // console.log('min:', min, ', max:', max, ', scroll:', scroll);\n        for (let i = min + offset; i <= max + offset; i += 1) {\n            if (frset.has(i)) {\n                offset += 1;\n            } else {\n                const rowHeight = rows.getHeight(i);\n                cb(i, y, rowHeight);\n                y += rowHeight;\n                if (y > this.viewHeight()) break;\n            }\n        }\n    }\n\n    colEach(min, max, cb) {\n        let x = 0;\n        const {cols} = this;\n        for (let i = min; i <= max; i += 1) {\n            const colWidth = cols.getWidth(i);\n            cb(i, x, colWidth);\n            x += colWidth;\n            if (x > this.viewWidth()) break;\n        }\n    }\n\n    defaultStyle() {\n        return this.settings.style;\n    }\n\n    addStyle(nstyle) {\n        const {styles} = this;\n        // console.log('old.styles:', styles, nstyle);\n        for (let i = 0; i < styles.length; i += 1) {\n            const style = styles[i];\n            if (helper.equals(style, nstyle)) return i;\n        }\n        styles.push(nstyle);\n        return styles.length - 1;\n    }\n\n    // addPicture(pic) {\n    //     const {pictures} = this;\n    //\n    // }\n\n    getChangeDataToCalc() {\n        let {multiPreAction} = this;\n        if (multiPreAction.undoItems.length <= 0) {\n            return null;\n        }\n        let lastStep = multiPreAction.undoItems[multiPreAction.undoItems.length - 1];\n        if (!isHave(lastStep)) {\n            return null;\n        }\n\n        return lastStep;\n    }\n\n    changeData(cb, {type = -1, ri = -1, ci = -1, cellRange = \"\", property = \"\", value = \"\"} = -1) {\n        if (this.settings.showEditor === false) {\n            return;\n        }\n\n        let oldCell = {};\n        let oldMergesData = this.merges.getData();\n        let {multiPreAction} = this;\n        const {selector} = this;\n\n        let step = multiPreAction.getStepType(type, {\n            expr: '',\n            property,\n            value,\n            oldCell,\n            range: selector.range,\n            ri,\n            ci,\n            cellRange: cellRange,\n        });\n\n        if (cellRange !== \"\") {\n            let {multiPreAction} = this;\n            oldCell = multiPreAction.eachRange(cellRange);\n        }\n        cb();\n        this.changeToHistory({type, ri, ci, cellRange, property, value, oldCell, oldMergesData, newData: this.getData(), }, step);\n        this.changeDataForCalc = this.getChangeDataToCalc();\n\n        this.change(this.getData());\n    }\n\n    cutPaste(srcCellRange, dstCellRange, cleard = true) {\n        cutPaste.call(this, srcCellRange, dstCellRange, cleard);\n    }\n\n    setData(d, sheet = \"\", out = false) {\n        const {autoFilter} = this;\n        Object.keys(d).forEach((property) => {\n            // this.judgeAutoWidth(d.rows);\n            if (property === 'merges'\n                || property === 'cols' || property === 'validations') {\n                this[property].setData(d[property]);\n            } else if (property === 'flex') {\n                autoFilter.addFiexRows(d[property]);\n            } else if (property === 'rows') {\n                this[property].setData(d[property], sheet, out, this.settings.rowsInit);\n            } else if (property === 'freeze') {\n                const [x, y] = expr2xy(d[property]);\n                this.freeze = [y, x];\n            } else if (property === 'pictures') {\n                if (d[property]) {\n                    processPasteDirectionsArr.call(this, d[property], 'from', sheet);\n                }\n            } else if (property === 'autofilter') {\n                if (d[property] && d[property].ref) {\n                    autoFilter.ref = d[property].ref;\n                    autoFilter.filters = d[property].filters;\n                    autoFilter.sort = d[property].sort;\n                }\n            } else if (d[property] !== undefined) {\n                this[property] = d[property];\n            }\n        });\n        return this;\n    }\n\n    selectorCellText(ri, ci, text, event_type) {\n        return selectorCellText.call(this, ri, ci, text, event_type);\n    }\n\n    getData() {\n        const {\n            name, freeze, styles, merges, rows, cols, validations, autoFilter, pasteDirectionsArr,\n        } = this;\n        return {\n            editor: this.settings.showEditor,\n            name,\n            freeze: xy2expr(freeze[1], freeze[0]),\n            styles,\n            pictures: processPasteDirectionsArr(pasteDirectionsArr, 'to'),\n            merges: merges.getData(),\n            rows: rows.getData(),\n            cols: cols.getData(),\n            validations: validations.getData(),\n            autofilter: autoFilter.getData(),\n        };\n    }\n}\n","export default {\n    toolbar: {\n        undo: '撤销',\n        redo: '恢复',\n        paintformat: '格式刷',\n        clearformat: '清除格式',\n        format: '数据格式',\n        font: '字体',\n        fontSize: '字号',\n        fontBold: '加粗',\n        fontItalic: '倾斜',\n        underline: '下划线',\n        strike: '删除线',\n        textColor: '字体颜色',\n        fillColor: '填充颜色',\n        border: '边框',\n        merge: '合并单元格',\n        align: '水平对齐',\n        valign: '垂直对齐',\n        textwrap: '自动换行',\n        freeze: '冻结',\n        autofilter: '自动筛选',\n        add: '显示公式',\n        calc: '开始计算',\n        formula: '函数',\n        more: '更多',\n        throwFormula: '清除公式',\n        comeBack: '返回',\n    },\n    revision: {\n        comeBack: '退出',\n    },\n    contextmenu: {\n        copy: '复制',\n        cut: '剪切',\n        paste: '粘贴',\n        pasteValue: '粘贴数据',\n        pasteFormat: '粘贴格式',\n        insertRow: '插入行',\n        insertColumn: '插入列',\n        deleteRow: '删除行',\n        deleteColumn: '删除列',\n        deleteCell: '删除',\n        deleteCellText: '删除数据',\n        validation: '数据验证',\n        errorPop: '出现问题',\n        recover: '恢复此版本',\n    },\n    format: {\n        normal: '常规',\n        text: '文本',\n        number: '数值',\n        percent: '百分比',\n        rmb: '人民币',\n        usd: '美元',\n        date: '短日期',\n        time: '时间',\n        datetime: '长日期',\n        duration: '持续时间',\n    },\n    date_formula: {\n        sum: '求和',\n        average: '求平均值',\n        max: '求最大值',\n        min: '求最小值',\n        concat: '字符拼接',\n        wland: 'MD.WLAND',\n        wfr: 'MD.WFR',\n        rtd: 'MD.RTD',\n    },\n    validation: {\n        required: '此值必填',\n        notMatch: '此值不匹配验证规则',\n        between: '此值应在 {} 和 {} 之间',\n        notBetween: '此值不应在 {} 和 {} 之间',\n        notIn: '此值不在列表中',\n        equal: '此值应该等于 {}',\n        notEqual: '此值不应该等于 {}',\n        lessThan: '此值应该小于 {}',\n        lessThanEqual: '此值应该小于等于 {}',\n        greaterThan: '此值应该大于 {}',\n        greaterThanEqual: '此值应该大于等于 {}',\n    },\n    error: {\n        pasteForMergedCell: '无法对合并的单元格执行此操作',\n    },\n    calendar: {\n        weeks: ['日', '一', '二', '三', '四', '五', '六'],\n        months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],\n    },\n    button: {\n        cancel: '取消',\n        remove: '删除',\n        save: '保存',\n        ok: '确认',\n    },\n    sort: {\n        desc: '降序',\n        asc: '升序',\n    },\n    filter: {\n        empty: '空白',\n    },\n    dataValidation: {\n        mode: '模式',\n        range: '单元区间',\n        criteria: '条件',\n        modeType: {\n            cell: '单元格',\n            column: '列模式',\n            row: '行模式',\n        },\n        type: {\n            list: '列表',\n            number: '数字',\n            date: '日期',\n            phone: '手机号',\n            email: '电子邮件',\n        },\n        operator: {\n            be: '在区间',\n            nbe: '不在区间',\n            lt: '小于',\n            lte: '小于等于',\n            gt: '大于',\n            gte: '大于等于',\n            eq: '等于',\n            neq: '不等于',\n        },\n    },\n};\n\n","import {debugout} from \"./debugout\";\nlet bugout = \"\";\ntry {\n    bugout = new debugout();\n} catch (e) {\n\n}\n\nexport {\n    bugout,\n}","/*\n\n    debugout.js\n    by @inorganik\n    \n*/\n\n\n// save all the console.logs\nexport function debugout() {\n    var self = this;\n\n    // OPTIONS\n    self.realTimeLoggingOn = true; // log in real time (forwards to console.log)\n    self.useTimestamps = false; // insert a timestamp in front of each log\n    self.useLocalStorage = true; // store the output using window.localStorage() and continuously add to the same log each session\n    self.recordLogs = true; // set to false after you're done debugging to avoid the log eating up memory\n    self.autoTrim = true; // to avoid the log eating up potentially endless memory\n    self.maxLines = 2500; // if autoTrim is true, this many most recent lines are saved\n    self.tailNumLines = 100; // how many lines tail() will retrieve\n    self.logFilename = 'debugout.txt'; // filename of log downloaded with downloadLog()\n\n    // vars\n    self.depth = 0;\n    self.parentSizes = [0];\n    self.currentResult = '';\n    self.startTime = new Date();\n    self.output = '';\n\n    this.version = function () {\n        return '0.5.0'\n    }\n\n    /*\n        USER METHODS\n    */\n    this.getLog = function () {\n        var retrievalTime = new Date();\n        // if recording is off, so dev knows why they don't have any logs\n        if (!self.recordLogs) {\n            self.log('[debugout.js] log recording is off.');\n        }\n        // if using local storage, get values\n        if (self.useLocalStorage) {\n            var saved = window.localStorage.getItem('debugout.js');\n            if (saved) {\n                saved = JSON.parse(saved);\n                self.startTime = new Date(saved.startTime);\n                self.output = saved.log;\n                retrievalTime = new Date(saved.lastLog);\n            }\n        }\n        return self.output\n            + '\\n---- Log retrieved: ' + retrievalTime + ' ----\\n'\n            + self.formatSessionDuration(self.startTime, retrievalTime);\n    }\n    // accepts optional number or uses the default for number of lines\n    this.tail = function (numLines) {\n        var numLines = numLines || self.tailLines;\n        return self.trimLog(self.getLog(), numLines);\n    }\n    // accepts a string to search for\n    this.search = function (string) {\n        var lines = self.output.split('\\n');\n        var rgx = new RegExp(string);\n        var matched = [];\n        // can't use a simple Array.prototype.filter() here\n        // because we need to add the line number\n        for (var i = 0; i < lines.length; i++) {\n            var addr = '[' + i + '] ';\n            if (lines[i].match(rgx)) {\n                matched.push(addr + lines[i]);\n            }\n        }\n        var result = matched.join('\\n');\n        if (result.length == 0) result = 'Nothing found for \"' + string + '\".';\n        return result\n    }\n    // accepts the starting line and how many lines after the starting line you want\n    this.getSlice = function (lineNumber, numLines) {\n        var lines = self.output.split('\\n');\n        var segment = lines.slice(lineNumber, lineNumber + numLines);\n        return segment.join('\\n');\n    }\n    // immediately downloads the log - for desktop browser use\n    this.downloadLog = function () {\n        var file = \"data:text/plain;charset=utf-8,\";\n        var logFile = self.getLog();\n        var encoded = encodeURIComponent(logFile);\n        file += encoded;\n        var a = document.createElement('a');\n        a.href = file;\n        a.target = '_blank';\n        a.download = self.logFilename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n    }\n    // clears the log\n    this.clear = function () {\n        var clearTime = new Date();\n        self.output = '---- Log cleared: ' + clearTime + ' ----\\n';\n        if (self.useLocalStorage) {\n            // local storage\n            var saveObject = {\n                startTime: self.startTime,\n                log: self.output,\n                lastLog: clearTime\n            }\n            saveObject = JSON.stringify(saveObject);\n            window.localStorage.setItem('debugout.js', saveObject);\n        }\n        if (self.realTimeLoggingOn) console.log('[debugout.js] clear()');\n    }\n    // records a log\n    this.log = function (obj) {\n        // log in real time\n        if (self.realTimeLoggingOn) console.log(obj);\n        // record log\n        var type = self.determineType(obj);\n        if (type != null && self.recordLogs) {\n            var addition = obj;\n            // timestamp, formatted for brevity\n            if (self.useTimestamps) {\n                var logTime = new Date();\n                self.output += self.formatTimestamp(logTime);\n            }\n            self.output += addition + '\\n';\n            if (self.autoTrim) self.output = self.trimLog(self.output, self.maxLines);\n            // local storage\n            if (self.useLocalStorage) {\n                var last = new Date();\n                var saveObject = {\n                    startTime: self.startTime,\n                    log: self.output,\n                    lastLog: last\n                }\n                saveObject = JSON.stringify(saveObject);\n                window.localStorage.setItem('debugout.js', saveObject);\n            }\n        }\n        self.depth = 0;\n        self.parentSizes = [0];\n        self.currentResult = '';\n    }\n    /*\n        METHODS FOR CONSTRUCTING THE LOG\n    */\n\n    // like typeof but classifies objects of type 'object'\n    // kept separate from formatType() so you can use at your convenience!\n    this.determineType = function (object) {\n        if (object != null) {\n            var typeResult;\n            var type = typeof object;\n            if (type == 'object') {\n                var len = object.length;\n                if (len == null) {\n                    if (typeof object.getTime == 'function') {\n                        typeResult = 'Date';\n                    }\n                    else if (typeof object.test == 'function') {\n                        typeResult = 'RegExp';\n                    }\n                    else {\n                        typeResult = 'Object';\n                    }\n                } else {\n                    typeResult = 'Array';\n                }\n            } else {\n                typeResult = type;\n            }\n            return typeResult;\n        } else {\n            return null;\n        }\n    }\n    // format type accordingly, recursively if necessary\n    this.formatType = function (type, obj) {\n        switch (type) {\n            case 'Object' :\n                self.currentResult += '{\\n';\n                self.depth++;\n                self.parentSizes.push(self.objectSize(obj));\n                var i = 0;\n                for (var prop in obj) {\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    self.currentResult += prop + ': ';\n                    var subtype = self.determineType(obj[prop]);\n                    var subresult = self.formatType(subtype, obj[prop]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ',';\n                        self.currentResult += '\\n';\n                    }\n                    i++;\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += self.indentsForDepth(self.depth);\n                self.currentResult += '}';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'Array' :\n                self.currentResult += '[';\n                self.depth++;\n                self.parentSizes.push(obj.length);\n                for (var i = 0; i < obj.length; i++) {\n                    var subtype = self.determineType(obj[i]);\n                    if (subtype == 'Object' || subtype == 'Array') self.currentResult += '\\n' + self.indentsForDepth(self.depth);\n                    var subresult = self.formatType(subtype, obj[i]);\n                    if (subresult) {\n                        self.currentResult += subresult;\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype == 'Array') self.currentResult += '\\n';\n                    } else {\n                        if (i != self.parentSizes[self.depth] - 1) self.currentResult += ', ';\n                        if (subtype != 'Object') self.currentResult += '\\n';\n                        else if (i == self.parentSizes[self.depth] - 1) self.currentResult += '\\n';\n                    }\n                }\n                self.depth--;\n                self.parentSizes.pop();\n                self.currentResult += ']';\n                if (self.depth == 0) return self.currentResult;\n                break;\n            case 'function' :\n                obj += '';\n                var lines = obj.split('\\n');\n                for (var i = 0; i < lines.length; i++) {\n                    if (lines[i].match(/\\}/)) self.depth--;\n                    self.currentResult += self.indentsForDepth(self.depth);\n                    if (lines[i].match(/\\{/)) self.depth++;\n                    self.currentResult += lines[i] + '\\n';\n                }\n                return self.currentResult;\n                break;\n            case 'RegExp' :\n                return '/' + obj.source + '/';\n                break;\n            case 'Date' :\n            case 'string' :\n                if (self.depth > 0 || obj.length == 0) {\n                    return '\"' + obj + '\"';\n                } else {\n                    return obj;\n                }\n            case 'boolean' :\n                if (obj) return 'true';\n                else return 'false';\n            case 'number' :\n                return obj + '';\n                break;\n        }\n    }\n    this.indentsForDepth = function (depth) {\n        var str = '';\n        for (var i = 0; i < depth; i++) {\n            str += '\\t';\n        }\n        return str;\n    }\n    this.trimLog = function (log, maxLines) {\n        var lines = log.split('\\n');\n        if (lines.length > maxLines) {\n            lines = lines.slice(lines.length - maxLines);\n        }\n        return lines.join('\\n');\n    }\n    this.lines = function () {\n        return self.output.split('\\n').length;\n    }\n    // calculate testing time\n    this.formatSessionDuration = function (startTime, endTime) {\n        var msec = endTime - startTime;\n        var hh = Math.floor(msec / 1000 / 60 / 60);\n        var hrs = ('0' + hh).slice(-2);\n        msec -= hh * 1000 * 60 * 60;\n        var mm = Math.floor(msec / 1000 / 60);\n        var mins = ('0' + mm).slice(-2);\n        msec -= mm * 1000 * 60;\n        var ss = Math.floor(msec / 1000);\n        var secs = ('0' + ss).slice(-2);\n        msec -= ss * 1000;\n        return '---- Session duration: ' + hrs + ':' + mins + ':' + secs + ' ----'\n    }\n    this.formatTimestamp = function (timestamp) {\n        var year = timestamp.getFullYear();\n        var date = timestamp.getDate();\n        var month = ('0' + (timestamp.getMonth() + 1)).slice(-2);\n        var hrs = Number(timestamp.getHours());\n        var mins = ('0' + timestamp.getMinutes()).slice(-2);\n        var secs = ('0' + timestamp.getSeconds()).slice(-2);\n        return '[' + year + '-' + month + '-' + date + ' ' + hrs + ':' + mins + ':' + secs + ']: ';\n    }\n    this.objectSize = function (obj) {\n        var size = 0, key;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) size++;\n        }\n        return size;\n    }\n\n    /*\n        START/RESUME LOG\n    */\n    if (self.useLocalStorage) {\n        var saved = window.localStorage.getItem('debugout.js');\n        if (saved) {\n            saved = JSON.parse(saved);\n            self.output = saved.log;\n            var start = new Date(saved.startTime);\n            var end = new Date(saved.lastLog);\n            self.output += '\\n---- Session end: ' + saved.lastLog + ' ----\\n';\n            self.output += self.formatSessionDuration(start, end);\n            self.output += '\\n\\n';\n        }\n    }\n    self.output += '---- Session started: ' + self.startTime + ' ----\\n\\n';\n}","/* global window, document */\nimport {h} from './component/element';\nimport DataProxy from './core/data_proxy';\nimport Sheet from './component/sheet';\nimport {cssPrefix} from './config';\nimport {locale} from './locale/locale';\nimport './index.less';\nimport zhCN from './locale/zh-cn';\nimport {bugout} from \"./log/log_proxy\";\nimport Drag from \"./external/drag\";\nclass Spreadsheet {\n    constructor(selectors, options = {}, methods = {}, alias = 'sheet1') {\n        let targetEl = selectors;\n          if (typeof selectors === 'string') {\n            targetEl = document.querySelector(selectors);\n        }\n        this.locale('zh-cn', zhCN);\n        this.data = new DataProxy(alias, options, methods);\n        const rootEl = h('div', `${cssPrefix}`)\n            .on('contextmenu', evt => evt.preventDefault());\n        // create canvas element\n        targetEl.appendChild(rootEl.el);\n\n        this.sheet = new Sheet(rootEl, this.data);\n        this.data.sheet = this.sheet;\n    }\n\n    setDataSettings(value) {\n        this.data.settings.showEditor = value;\n    }\n\n    loadData(data) {\n        this.sheet.loadData(data);\n        return this;\n    }\n\n    getData() {\n        return this.data.getData();\n    }\n\n    validate() {\n        const {validations} = this.data;\n        return validations.errors.size <= 0;\n    }\n\n    change(cb) {\n        this.data.change = cb;\n        return this;\n    }\n\n    static locale(lang, message) {\n        locale(lang, message);\n    }\n\n    locale(lang, message) {\n        locale(lang, message);\n    }\n\n    getEditorStatus() {\n        let {editor} = this.sheet;\n        let { ri, ci, pos} = editor;\n        let inputText = editor.editorText.getText();\n        let args = {\n            \"status\": editor.isDisplay(),\n            \"inputText\": inputText,\n            \"ri\": ri,\n            \"ci\": ci,\n            \"pos\": pos,\n        }\n        return args;\n    }\n\n    setEditorText(text = '', pos = 1) {\n        let {editor} = this.sheet;\n        text = text != '' ? text : '=';\n        editor.inputEventHandler(text, pos, true);\n    }\n\n    setTextEnd(cell, ri, ci) {\n        let {editor, data} = this.sheet;\n        editor.setCellEnd({\n            text: cell.text,\n            formulas: cell.formulas\n        });\n        data.setCellAll(ri, ci, cell.formulas + \"\", cell.formulas + \"\", '');\n\n        this.sheet.selectorEditorReset(ri, ci);\n\n        setTimeout(() => {\n            editor.setCursorPos(cell.formulas.length);\n        }, 100)\n    }\n\n    getText(alias, inputText, pos) {\n        let {selectors, data, table} = this.sheet;\n        let text = \"\";\n        for(let i = 0; i < selectors.length; i++) {\n            let {erpx} = selectors[i];\n            text += erpx;\n        }\n        let t = data.getCellByExpr(text, table, alias, inputText, pos);\n\n        return t;\n    }\n\n    removeEvent() {\n        this.sheet.removeEvent();\n    }\n}\n\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\n\nif (window) {\n    window.jsSpreadsheet = require('js-spreadsheet');\n    window.drag = Drag;\n    window.x = window.x || {};\n    window.bugout = bugout;\n    window.x.spreadsheet = spreadsheet;\n    window.x.spreadsheet.locale = (lang, message) => locale(lang, message);\n}\n\nexport default Spreadsheet;\nexport {\n    spreadsheet,\n};\n","\"use strict\";\n\nconst col_str_2_int = require('./col_str_2_int.js');\nconst int_2_col_str = require('./int_2_col_str.js');\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nclass Range{\n    constructor(str_expression, formula, possition_i){\n        var range_expression, sheet_name, sheet;\n        this.start_pst = possition_i - str_expression.length\n        this.end_pst = possition_i\n\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            range_expression = aux[1];\n            this.range_start_pst = possition_i - aux[1].length\n        }\n        else {\n            sheet_name = formula.sheet_name;\n            range_expression = str_expression;\n            this.range_start_pst = this.start_pst\n\n        }\n        this.sheet = formula.wb.Sheets[sheet_name];\n        this.range_expression = range_expression\n        this.sheet_name = sheet_name\n        this.formula = formula\n\n    }\n    calc(){\n        let sheet_name = this.sheet_name\n        let sheet = this.sheet\n        let range_expression = this.range_expression\n        let formula = this.formula\n        var arr = range_expression.split(':');\n        var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n        var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n        var max_row;\n        if (str_max_row === '' && sheet['!ref']) {\n            str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n        }\n        // the max is 1048576, but TLE\n        max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n        var min_col = col_str_2_int(arr[0]);\n        var max_col = col_str_2_int(arr[1]);\n        var matrix = [];\n        for (var i = min_row; i <= max_row; i++) {\n            var row = [];\n            matrix.push(row);\n            for (var j = min_col; j <= max_col; j++) {\n                var cell_name = int_2_col_str(j) + i;\n                var cell_full_name = sheet_name + '!' + cell_name;\n                if (formula.formula_ref[cell_full_name]) {\n                    if (formula.formula_ref[cell_full_name].status === 'new') {\n                        formula.exec_formula(formula.formula_ref[cell_full_name]);\n                    }\n                    else if (formula.formula_ref[cell_full_name].status === 'working') {\n                        throw new Error('Circular ref');\n                    }\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else if (sheet[cell_name]) {\n                    if (sheet[cell_name].t === 'e') {\n                        row.push(sheet[cell_name]);\n                    }\n                    else {\n                        row.push(sheet[cell_name].v);\n                    }\n                }\n                else {\n                    row.push(null);\n                }\n            }\n        }\n        return matrix;\n\n    }\n\n}\n\nmodule.exports = Range\n//     function Range(str_expression, formula) { // 这是一个Range 类; 把信息都封装到calc方法里面\n//     var range_expression, sheet_name, sheet;\n//     if (str_expression.indexOf('!') != -1) {\n//         var aux = str_expression.split('!');\n//         sheet_name = getSanitizedSheetName(aux[0]);\n//         range_expression = aux[1];\n//     }\n//     else {\n//         sheet_name = formula.sheet_name;\n//         range_expression = str_expression;\n//     }\n//     sheet = formula.wb.Sheets[sheet_name];\n//     this.range_expression = range_expression\n//     this.sheet_name = sheet_name\n//     console.log(this.range_expression)\n//\n//     this.calc = function() {\n//         var arr = range_expression.split(':');\n//         var min_row = parseInt(arr[0].replace(/^[A-Z]+/, ''), 10) || 0;\n//         var str_max_row = arr[1].replace(/^[A-Z]+/, '');\n//         var max_row;\n//         if (str_max_row === '' && sheet['!ref']) {\n//             str_max_row = sheet['!ref'].split(':')[1].replace(/^[A-Z]+/, '');\n//         }\n//         // the max is 1048576, but TLE\n//         max_row = parseInt(str_max_row == '' ? '500000' : str_max_row, 10);\n//         var min_col = col_str_2_int(arr[0]);\n//         var max_col = col_str_2_int(arr[1]);\n//         var matrix = [];\n//         for (var i = min_row; i <= max_row; i++) {\n//             var row = [];\n//             matrix.push(row);\n//             for (var j = min_col; j <= max_col; j++) {\n//                 var cell_name = int_2_col_str(j) + i;\n//                 var cell_full_name = sheet_name + '!' + cell_name;\n//                 if (formula.formula_ref[cell_full_name]) {\n//                     if (formula.formula_ref[cell_full_name].status === 'new') {\n//                         formula.exec_formula(formula.formula_ref[cell_full_name]);\n//                     }\n//                     else if (formula.formula_ref[cell_full_name].status === 'working') {\n//                         throw new Error('Circular ref');\n//                     }\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else if (sheet[cell_name]) {\n//                     if (sheet[cell_name].t === 'e') {\n//                         row.push(sheet[cell_name]);\n//                     }\n//                     else {\n//                         row.push(sheet[cell_name].v);\n//                     }\n//                 }\n//                 else {\n//                     row.push(null);\n//                 }\n//             }\n//         }\n//         return matrix;\n//     };\n// };\n","var utils = require('./utils');\nvar error = require('./error');\nvar numeral = require('numeral');\n\n//TODO\nexports.ASC = function(str) {\n  var tmp = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str.charCodeAt(i) > 65248 && str.charCodeAt(i) < 65375) {\n      tmp += String.fromCharCode(str.charCodeAt(i) - 65248);\n    }\n    else {\n      tmp += String.fromCharCode(str.charCodeAt(i));\n    }\n  }\n  return tmp\n};\n\n//TODO\nexports.BAHTTEXT = function() {\n throw new Error('BAHTTEXT is not implemented');\n};\n\nexports.CHAR = function(number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return String.fromCharCode(number);\n};\n\nexports.CLEAN = function(text) {\n  text = text || '';\n  var re = /[\\0-\\x1F]/g;\n  return text.replace(re, \"\");\n};\n\nexports.CODE = function(text) {\n  text = text || '';\n  return text.charCodeAt(0);\n};\n\nexports.CONCATENATE = function() {\n  var args = utils.flatten(arguments);\n\n  var trueFound = 0;\n  while ((trueFound = args.indexOf(true)) > -1) {\n    args[trueFound] = 'TRUE';\n  }\n\n  var falseFound = 0;\n  while ((falseFound = args.indexOf(false)) > -1) {\n    args[falseFound] = 'FALSE';\n  }\n\n  return args.join('');\n};\n\n//TODO\nexports.DBCS = function() {\n throw new Error('DBCS is not implemented');\n};\n\nexports.DOLLAR = function(number, decimals) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n  var format = '';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n    format = '($0,0)';\n  } else if (decimals > 0) {\n    format = '($0,0.' + new Array(decimals + 1).join('0') + ')';\n  }\n  return numeral(number).format(format);\n};\n\nexports.EXACT = function(text1, text2) {\n  return text1 === text2;\n};\n\nexports.FIND = function (find_text, within_text, position) {\n  position = (position === undefined) ? 0 : position;\n  within_text.indexOf(find_text)\n  return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\n};\nexports.FIXED = function(number, decimals, no_commas) {\n  decimals = (decimals === undefined) ? 2 : decimals;\n  no_commas = (no_commas === undefined) ? false : no_commas;\n\n  number = utils.parseNumber(number);\n  decimals = utils.parseNumber(decimals);\n  if (utils.anyIsError(number, decimals)) {\n    return error.value;\n  }\n\n  var format = no_commas ? '0' : '0,0';\n  if (decimals <= 0) {\n    number = Math.round(number * Math.pow(10, decimals)) / Math.pow(10, decimals);\n  } else if (decimals > 0) {\n    format += '.' + new Array(decimals + 1).join('0');\n  }\n  return numeral(number).format(format);\n};\n\nexports.HTML2TEXT = function (value) {\n  var result = '';\n\n  if (value) {\n    if (value instanceof Array) {\n      value.forEach(function (line) {\n        if (result !== '') {\n          result += '\\n';\n        }\n        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\n      });\n    } else {\n      result = value.replace(/<(?:.|\\n)*?>/gm, '');\n    }\n  }\n\n  return result;\n};\nexports.INDEX = function (matrix, row_num, column_num) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n  return matrix[row_num][column_num-1]\n};\nexports.LEFT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error || typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.substring(0, number) : null;\n};\n\nexports.LEN = function(text) {\n  if (arguments.length === 0) {\n    return error.error;\n  }\n\n  if (typeof text === 'string') {\n    return text ? text.length : 0;\n  }\n\n  if (text.length) {\n    return text.length;\n  }\n\n  return error.value;\n};\n\nexports.LOWER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text ? text.toLowerCase() : text;\n};\n\nexports.MID = function(text, start, number) {\n  start = utils.parseNumber(start);\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(start, number) || typeof text !== 'string') {\n    return number;\n  }\n\n  var begin = start - 1;\n  var end = begin + number;\n\n  return text.substring(begin, end);\n};\n\n// TODO\nexports.NUMBERVALUE = function (text, decimal_separator, group_separator) {\n  decimal_separator = (typeof decimal_separator === 'undefined') ? '.' : decimal_separator;\n  group_separator = (typeof group_separator === 'undefined') ? ',' : group_separator;\n  if (text.indexOf('%') > 0){\n    text = text.replace('%', '')\n    return parseFloat(text)/100\n  }\n  return Number(text.replace(decimal_separator, '.').replace(group_separator, ''));\n};\n\n// TODO\nexports.PRONETIC = function() {\n throw new Error('PRONETIC is not implemented');\n};\n\nexports.PROPER = function(text) {\n  if (text === undefined || text.length === 0) {\n    return error.value;\n  }\n  if (text === true) {\n    text = 'TRUE';\n  }\n  if (text === false) {\n    text = 'FALSE';\n  }\n  if (isNaN(text) && typeof text === 'number') {\n    return error.value;\n  }\n  if (typeof text === 'number') {\n    text = '' + text;\n  }\n\n  return text.replace(/\\w\\S*/g, function(txt) {\n    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n  });\n};\n\nexports.REGEXEXTRACT = function (text, regular_expression) {\n  var match = text.match(new RegExp(regular_expression));\n  return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\n};\n\nexports.REGEXMATCH = function (text, regular_expression, full) {\n  var match = text.match(new RegExp(regular_expression));\n  return full ? match : !!match;\n};\n\nexports.REGEXREPLACE = function (text, regular_expression, replacement) {\n  return text.replace(new RegExp(regular_expression), replacement);\n};\n\nexports.REPLACE = function(text, position, length, new_text) {\n  position = utils.parseNumber(position);\n  length = utils.parseNumber(length);\n  if (utils.anyIsError(position, length) ||\n    typeof text !== 'string' ||\n    typeof new_text !== 'string') {\n    return error.value;\n  }\n  return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\n};\n\nexports.REPT = function(text, number) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return new Array(number + 1).join(text);\n};\n\nexports.RIGHT = function(text, number) {\n  number = (number === undefined) ? 1 : number;\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  return text ? text.substring(text.length - number) : null;\n};\n\nexports.SEARCH = function(find_text, within_text, position) {\n  var foundAt;\n  if (typeof find_text !== 'string' || typeof within_text !== 'string') {\n    return error.value;\n  }\n  position = (position === undefined) ? 0 : position;\n  foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\n  return (foundAt === 0)?error.value:foundAt;\n};\n\nexports.SPLIT = function (text, separator) {\n  return text.split(separator);\n};\n\nexports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\n  if (!text || !old_text || !new_text) {\n    return text;\n  } else if (occurrence === undefined) {\n    return text.replace(new RegExp(old_text, 'g'), new_text);\n  } else {\n    var index = 0;\n    var i = 0;\n    while (text.indexOf(old_text, index) > 0) {\n      index = text.indexOf(old_text, index + 1);\n      i++;\n      if (i === occurrence) {\n        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\n      }\n    }\n  }\n};\n\nexports.T = function(value) {\n  if (value == 'TRUE' || value == 'FALSE'){\n    return ''\n  }\n  return (typeof value === \"string\") ? value : '';\n};\n\n// TODO incomplete implementation\nfunction num2e(num){\n  var p = Math.floor(Math.log(num)/Math.LN10);\n  var n = num * Math.pow(10, -p);\n  if (p.toString().length < 10){\n    p = '0' + p\n  }\n  return n + 'E+' + p;\n}\nfunction allzero(num){\n  num = num.toString()\n  for (var i=0;i<num.length;i++){\n    if (num[i] != '0'){\n      return false\n    }\n  }\n  return true\n}\nfunction decimalsToFractional(decimals){\n  formatDecimals = decimals.toFixed(2);\n  var denominator = 3;//初始化分母\n  var numerator  = formatDecimals*3;//初始化分子\n  var bigger = 0;\n  function  recursion (){\n    bigger = denominator>numerator?denominator:numerator;\n    for(let i=bigger;i>1;i--){\n      if(Number.isInteger(numerator/i)&&Number.isInteger(denominator/i)){\n        numerator=numerator/i;\n        denominator=denominator/i;\n        recursion();\n      }\n    }\n  }\n  recursion();\n  numerator = parseInt(numerator)\n  return `${numerator}/${denominator}`\n}\nexports.TEXT = function (value, format) {\n  try{\n    if (format.indexOf('%') >= 0){\n      var fixed = format.split('.')[1].length-1\n      return (parseFloat(value) *100).toFixed(fixed) + '%'\n    }\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    var result = Formulas.TEXT(value, format);\n    console.log(result)\n  }catch (e) {\n    var result = undefined\n  }\n  if (result == undefined){\n    if (format.indexOf('#') >= 0 && format.indexOf('?/?') >=0){\n      var x = parseFloat(value) - parseInt(value);\n      if (parseInt(value) != 0){\n        return parseInt(value) + ' ' + decimalsToFractional(x)\n      }\n      return decimalsToFractional(x)\n    }\n    if (format.indexOf('E+') >=0){\n      return num2e(value)\n    }else if(allzero(value)){\n      var result = ''\n      for (var i=0;i<format.length-value.length; i++){\n        result += '0'\n      }\n      return result + value\n    }else if (format.indexOf('#') >=0){\n      var fmt = format\n      if (format.indexOf('[')>=0 && format.indexOf(';')>=0){\n        var valid = format.split('#')[0]\n        fmt = format.split(']')[1].split(';')\n        valid = valid.replace('[', '').replace(']', '')\n        if (eval(value + valid)){\n          fmt = fmt[0]\n        }else {\n          fmt = fmt[1]\n        }\n      }\n      if (format.indexOf('#') >=0 && format.indexOf('.' >=0) && format.indexOf('0') >=0 && format.indexOf('°') <=0){\n        if (value.toString().split('.')[1].length > format.split('.')[1].length){\n          value = value.toFixed(format.split('.')[1].length)\n        }\n        value = value.toString()\n        var result = ''\n        var n = 0\n        for (var i=0; i< fmt.length; i ++){\n          if (fmt[i] == '#' || fmt[i] == '0' || fmt[i] == '.'){\n            result += value[n]\n            n += 1\n          }else{\n            result += fmt[i]\n          }\n        }\n        return result\n      }\n      fmt = fmt.replace('##0', '##')\n      value = value.toString()\n      var result = ''\n      var n = 0\n      for (var i=0; i< fmt.length; i ++){\n        if (fmt[i] == '#' || fmt[i] == '0'){\n          result += value[n]\n          n += 1\n        }else{\n          result += fmt[i]\n        }\n      }\n      return result\n    }\n  }\n  return result\n};\n\nexports.TRIM = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.replace(/ +/g, ' ').trim();\n};\n\nexports.UNICHAR = function (text) {\n  if (text == 0){\n    return error.value\n  }\n  return String.fromCharCode(text);\n};\n\nexports.UNICODE = function (text){\n  return text.charCodeAt(0)\n}\n\nexports.UPPER = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return text.toUpperCase();\n};\n\nexports.VALUE = function(text) {\n  if (typeof text !== 'string') {\n    return error.value;\n  }\n  return numeral().unformat(text);\n};\n","var error = require('./error');\n\n// TODO\nexports.CELL = function() {\n throw new Error('CELL is not implemented');\n};\n\nexports.ERROR = {};\nexports.ERROR.TYPE = function (error_val) {\n  switch (error_val) {\n    case error.nil.message:\n      return 1;\n    case error.div0.message:\n      return 2;\n    case error.value.message:\n      return 3;\n    case error.ref.message:\n      return 4;\n    case error.name.message:\n      return 5;\n    case error.num.message:\n      return 6;\n    case error.na.message:\n      return 7;\n    case error.data.message:\n      return 8;\n  }\n  return error.na;\n};\n\n// TODO\nexports.INFO = function() {\n throw new Error('INFO is not implemented');\n};\n\nexports.ISBLANK = function(value) {\n  return value === null;\n};\n\nexports.ISBINARY = function (number) {\n  return (/^[01]{1,10}$/).test(number);\n};\n\nexports.ISERR = function(value) {\n  return ([error.value.message, error.ref.message, error.div0.message, error.num.message, error.name.message, error.nil.message]).indexOf(value) >= 0 ||\n    (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\n};\n\nexports.ISERROR = function(value) {\n  return exports.ISERR(value) || value === error.na;\n};\n\nexports.ISEVEN = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? false : true;\n};\n\n// TODO\nexports.ISFORMULA = function() {\n  throw new Error('ISFORMULA is not implemented');\n};\n\nexports.ISLOGICAL = function(value) {\n  if(value == 'FALSE'){\n    return false\n  }\n  return value == true || value == false;\n};\n\nexports.ISNA = function(value) {\n  return value === error.na || value === error.na.message;;\n};\n\nexports.ISNONTEXT = function(value) {\n  return typeof(value) !== 'string';\n};\n\nexports.ISNUMBER = function(value) {\n  return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\n};\n\nexports.ISODD = function(number) {\n  return (Math.floor(Math.abs(number)) & 1) ? true : false;\n};\n\n// TODO\nexports.ISREF = function() {\n  return arguments['0'] != null\n};\n\nexports.ISTEXT = function(value) {\n  return typeof(value) === 'string';\n};\n\nexports.N = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return value;\n  }\n  if (value instanceof Date) {\n    return value.getTime();\n  }\n  if (value === true || value.toString().toUpperCase() == 'TRUE' || value.toString().toUpperCase() == 'FALSE') {\n    return 1;\n  }\n  if (value === false || typeof(value)=='string') {\n    return 0;\n  }\n  if (ISERROR(value)) {\n    return value;\n  }\n  return 0;\n};\n\nexports.NA = function() {\n  return error.na;\n};\n\n\n// TODO\nexports.SHEET = function() {\n  throw new Error('SHEET is not implemented');\n};\n\n// TODO\nexports.SHEETS = function() {\n  throw new Error('SHEETS is not implemented');\n};\n\nexports.TYPE = function (value) {\n  if (typeof(value) === 'number' && !isNaN(value) && isFinite(value)) {\n    return 1;\n  }\n  // if (typeof(value) !== 'string' && isNaN(value)){\n  //   return error.value\n  // }\n  if (typeof(value) === 'string') {\n    if (value.slice(0,1) == '{'){\n      var arr = utils.strToMatrix(value)\n      if (Array.isArray(arr)) {\n        return 64;\n      }\n    }else{\n      return 2\n    }\n  }\n  if(value == 'FALSE'){\n    return false\n  }\n  if (value == true || value == false) {\n    return 4;\n  }\n  if (exports.ISERR(value) || value === error.na) {\n    return 16;\n  }\n  if (Array.isArray(arr)) {\n    return 64;\n  }\n\n};\n","var error = require('./error');\nvar utils = require('./utils');\n\nvar d1900 = new Date(1900, 0, 1);\nvar WEEK_STARTS = [\n  undefined,\n  0,\n  1,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  undefined,\n  1,\n  2,\n  3,\n  4,\n  5,\n  6,\n  0\n];\nvar WEEK_TYPES = [\n  [],\n  [1, 2, 3, 4, 5, 6, 7],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 0, 1, 2, 3, 4, 5],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [],\n  [7, 1, 2, 3, 4, 5, 6],\n  [6, 7, 1, 2, 3, 4, 5],\n  [5, 6, 7, 1, 2, 3, 4],\n  [4, 5, 6, 7, 1, 2, 3],\n  [3, 4, 5, 6, 7, 1, 2],\n  [2, 3, 4, 5, 6, 7, 1],\n  [1, 2, 3, 4, 5, 6, 7]\n];\nvar WEEKEND_TYPES = [\n  [],\n  [6, 0],\n  [0, 1],\n  [1, 2],\n  [2, 3],\n  [3, 4],\n  [4, 5],\n  [5, 6],\n  undefined,\n  undefined,\n  undefined, [0, 0],\n  [1, 1],\n  [2, 2],\n  [3, 3],\n  [4, 4],\n  [5, 5],\n  [6, 6]\n];\n\nexports.DATE = function(year, month, day) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.DATE(year, month, day)\n  // year = utils.parseNumber(year);\n  // month = utils.parseNumber(month);\n  // day = utils.parseNumber(day);\n  // if (utils.anyIsError(year, month, day)) {\n  //   return error.value;\n  // }\n  // if (year < 0 || month < 0 || day < 0) {\n  //   return error.num;\n  // }\n  // var date = new Date(year, month - 1, day);\n  // return date;\n};\n\nexports.DATEVALUE = function(date_text) {\n  if (typeof date_text !== 'string') {\n    return error.value;\n  }\n  var date = Date.parse(date_text);\n  if (isNaN(date)) {\n    return error.value;\n  }\n  if (date <= -2203891200000) {\n    return (date - d1900) / 86400000 + 1;\n  }\n  return (date - d1900) / 86400000 + 2;\n};\n\nexports.DAY = function(serial_number) {\n  var date = utils.parseDate(serial_number);\n  if (date instanceof Error) {\n    return date;\n  }\n  return date.getDate();\n};\n\nexports.DAYS = function(end_date, start_date) {\n  end_date = utils.parseDate(end_date);\n  start_date = utils.parseDate(start_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  return serial(end_date) - serial(start_date);\n};\n\nexports.DAYS360 = function(start_date, end_date, method) {\n  method = utils.parseBool(method);\n  start_date = utils.parseDate(start_date);\n  end_date = utils.parseDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (method instanceof Error) {\n    return method;\n  }\n  var sm = start_date.getMonth();\n  var em = end_date.getMonth();\n  var sd, ed;\n  if (method) {\n    sd = start_date.getDate() === 31 ? 30 : start_date.getDate();\n    ed = end_date.getDate() === 31 ? 30 : end_date.getDate();\n  } else {\n    var smd = new Date(start_date.getFullYear(), sm + 1, 0).getDate();\n    var emd = new Date(end_date.getFullYear(), em + 1, 0).getDate();\n    sd = start_date.getDate() === smd ? 30 : start_date.getDate();\n    if (end_date.getDate() === emd) {\n      if (sd < 30) {\n        em++;\n        ed = 1;\n      } else {\n        ed = 30;\n      }\n    } else {\n      ed = end_date.getDate();\n    }\n  }\n  return 360 * (end_date.getFullYear() - start_date.getFullYear()) +\n    30 * (em - sm) + (ed - sd);\n};\n\nexports.EDATE = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  start_date.setMonth(start_date.getMonth() + months);\n  return serial(start_date);\n};\n\nexports.EOMONTH = function(start_date, months) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (isNaN(months)) {\n    return error.value;\n  }\n  months = parseInt(months, 10);\n  return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\n};\n\nexports.HOUR = function(serial_number) {\n  if (typeof serial_number === 'number' && !isNaN(serial_number)){\n    //XW: 参数为数字时获取对应的小时数\n    return parseInt((parseFloat(serial_number)-parseInt(serial_number)) * 24)\n    //XW: end\n  }\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getHours();\n};\n\nexports.INTERVAL = function (second) {\n  if (typeof second !== 'number' && typeof second !== 'string') {\n    return error.value;\n  } else {\n    second = parseInt(second, 10);\n  }\n\n  var year  = Math.floor(second/946080000);\n  second    = second%946080000;\n  var month = Math.floor(second/2592000);\n  second    = second%2592000;\n  var day   = Math.floor(second/86400);\n  second    = second%86400;\n\n  var hour  = Math.floor(second/3600);\n  second    = second%3600;\n  var min   = Math.floor(second/60);\n  second    = second%60;\n  var sec   = second;\n\n  year  = (year  > 0) ? year  + 'Y' : '';\n  month = (month > 0) ? month + 'M' : '';\n  day   = (day   > 0) ? day   + 'D' : '';\n  hour  = (hour  > 0) ? hour  + 'H' : '';\n  min   = (min   > 0) ? min   + 'M' : '';\n  sec   = (sec   > 0) ? sec   + 'S' : '';\n\n  return 'P' + year + month + day +\n  'T' + hour + min + sec;\n};\n\nexports.ISOWEEKNUM = function(date) {\n  date = utils.parseDate(date);\n  if (date instanceof Error) {\n    return date;\n  }\n\n  date.setHours(0, 0, 0);\n  date.setDate(date.getDate() + 4 - (date.getDay() || 7));\n  var yearStart = new Date(date.getFullYear(), 0, 1);\n  return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\n};\n\nexports.MINUTE = function(serial_number) {\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.MINUTE(serial_number);\n};\n\nexports.MONTH = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getMonth() + 1;\n};\n\nexports.NETWORKDAYS = function (start_date, end_date, holidays) {\n  if (holidays instanceof Array){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.NETWORKDAYS(start_date, end_date, holidays);\n};\nexports.NETWORKDAYSINTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays)[0])\n  }\n  try{\n    var Formulas = window.jsSpreadsheet.AllFormulas;\n    return Formulas.NETWORKDAYS$INTL(start_date, end_date, weekend, holidays);\n  }catch (e) {\n    start_date = utils.ExcelDateToJSDate(utils.parseDate(start_date));\n    end_date = utils.ExcelDateToJSDate(utils.parseDate(end_date));\n    if (start_date instanceof Error) {\n      return start_date;\n    }\n    if (end_date instanceof Error) {\n      return end_date;\n    }\n    if (weekend === undefined) {\n      weekend = WEEKEND_TYPES[1];\n    } else if (typeof weekend=='string' && weekend.length === 7) {\n      var arr = []\n      for (var i=0;i<weekend.length;i++){\n        if (weekend[i] == '1'){\n          arr.push(((i+1)>6)? 0: i+1)\n        }\n      }\n      weekend = arr\n    }else {\n      weekend = WEEKEND_TYPES[weekend];\n    }\n    if (!(weekend instanceof Array)) {\n      return error.value;\n    }\n    if (holidays === undefined) {\n      holidays = [];\n    } else if (!(holidays instanceof Array)) {\n      holidays = [holidays];\n    }\n    for (var i = 0; i < holidays.length; i++) {\n      var h = utils.parseDate(holidays[i]);\n      if (h instanceof Error) {\n        return h;\n      }\n      holidays[i] = h;\n    }\n    var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n    var total = days;\n    var day = start_date;\n    for (i = 0; i < days; i++) {\n      var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n      var dec = false;\n      if (d === weekend[0] || d === weekend[1]) {\n        dec = true;\n      }\n      for (var j = 0; j < holidays.length; j++) {\n        var holiday = holidays[j];\n        if (holiday.getDate() === day.getDate() &&\n          holiday.getMonth() === day.getMonth() &&\n          holiday.getFullYear() === day.getFullYear()) {\n          dec = true;\n          break;\n        }\n      }\n      if (dec) {\n        total--;\n      }\n      day.setDate(day.getDate() + 1);\n    }\n    return total;\n  }\n};\n\n\nexports.NETWORKDAYS.INTL = function (start_date, end_date, weekend, holidays) {\n  if (typeof holidays == 'string' && holidays.indexOf('{') >=0){\n    holidays = utils.parseDateArray(utils.strToMatrix(holidays))\n  }\n  start_date = utils.ExcelDateToJSDate(start_date);\n  end_date = utils.ExcelDateToJSDate(end_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var days = (end_date - start_date) / (1000 * 60 * 60 * 24) + 1;\n  var total = days;\n  var day = start_date;\n  for (i = 0; i < days; i++) {\n    var d = (new Date().getTimezoneOffset() > 0) ? day.getUTCDay() : day.getDay();\n    var dec = false;\n    if (d === weekend[0] || d === weekend[1]) {\n      dec = true;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === day.getDate() &&\n        holiday.getMonth() === day.getMonth() &&\n        holiday.getFullYear() === day.getFullYear()) {\n        dec = true;\n        break;\n      }\n    }\n    if (dec) {\n      total--;\n    }\n    day.setDate(day.getDate() + 1);\n  }\n  return total;\n};\n\nexports.NOW = function() {\n  return new Date();\n};\n\nexports.SECOND = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getSeconds();\n};\n\nexports.TIME = function(hour, minute, second) {\n  hour = utils.parseNumber(hour);\n  minute = utils.parseNumber(minute);\n  second = utils.parseNumber(second);\n  if (utils.anyIsError(hour, minute, second)) {\n    return error.value;\n  }\n  if (hour < 0 || minute < 0 || second < 0) {\n    return error.num;\n  }\n  return (3600 * hour + 60 * minute + second) / 86400;\n};\n\nexports.TIMEVALUE = function(time_text) {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  try{\n    return Formulas.TIMEVALUE(time_text);\n  }catch(e){\n    return error.value\n  }\n};\n\nexports.TODAY = function() {\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.TODAY()\n};\n\nexports.WEEKDAY = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  var day = serial_number.getDay();\n  return WEEK_TYPES[return_type][day];\n};\n\nexports.WEEKNUM = function(serial_number, return_type) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  if (return_type === undefined) {\n    return_type = 1;\n  }\n  if (return_type === 21) {\n    return this.ISOWEEKNUM(serial_number);\n  }\n  var week_start = WEEK_STARTS[return_type];\n  var jan = new Date(serial_number.getFullYear(), 0, 1);\n  var inc = jan.getDay() < week_start ? 1 : 0;\n  jan -= Math.abs(jan.getDay() - week_start) * 24 * 60 * 60 * 1000;\n  return Math.floor(((serial_number - jan) / (1000 * 60 * 60 * 24)) / 7 + 1) + inc;\n};\n\nexports.WORKDAY = function (start_date, days, holidays) {\n  if (holidays != undefined){\n    holidays = utils.flatten(holidays)\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.WORKDAY(start_date, days, holidays);\n};\nexports.WORKDAYINTL = function (start_date, days, weekend, holidays) {\n  // var Formulas = window.jsSpreadsheet.AllFormulas;\n  // return Formulas.WORKDAY$INTL(start_date, days, weekend, holidays);\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  if (weekend == 0){\n    return error.num\n  }\n  days = utils.parseNumber(days);\n  if (days instanceof Error) {\n    return days;\n  }\n  if (days < 0) {\n    return error.num;\n  }\n  if (weekend === undefined) {\n    weekend = WEEKEND_TYPES[1];\n  } else {\n    weekend = WEEKEND_TYPES[weekend];\n  }\n  if (!(weekend instanceof Array)) {\n    return error.value;\n  }\n  if (holidays === undefined) {\n    holidays = [];\n  } else if (!(holidays instanceof Array)) {\n    holidays = [holidays];\n  }\n  for (var i = 0; i < holidays.length; i++) {\n    var h = utils.parseDate(holidays[i]);\n    if (h instanceof Error) {\n      return h;\n    }\n    holidays[i] = h;\n  }\n  var d = 0;\n  while (d < days) {\n    start_date.setDate(start_date.getDate() + 1);\n    var day = start_date.getDay();\n    if (day === weekend[0] || day === weekend[1]) {\n      continue;\n    }\n    for (var j = 0; j < holidays.length; j++) {\n      var holiday = holidays[j];\n      if (holiday.getDate() === start_date.getDate() &&\n        holiday.getMonth() === start_date.getMonth() &&\n        holiday.getFullYear() === start_date.getFullYear()) {\n        d--;\n        break;\n      }\n    }\n    d++;\n  }\n  var year = start_date.getFullYear();\n  var month = start_date.getMonth();\n  var day = start_date.getDay();\n  return year+ '/' + month + '/' + day;\n};\n\nexports.YEAR = function(serial_number) {\n  serial_number = utils.parseDate(serial_number);\n  if (serial_number instanceof Error) {\n    return serial_number;\n  }\n  return serial_number.getFullYear();\n};\n\nfunction isLeapYear(year) {\n  return new Date(year, 1, 29).getMonth() === 1;\n}\n\n// TODO : Use DAYS ?\nfunction daysBetween(start_date, end_date) {\n  return Math.ceil((end_date - start_date) / 1000 / 60 / 60 / 24);\n}\n\nexports.YEARFRAC = function(start_date, end_date, basis) {\n  start_date = utils.parseDate(start_date);\n  if (start_date instanceof Error) {\n    return start_date;\n  }\n  end_date = utils.parseDate(end_date);\n  if (end_date instanceof Error) {\n    return end_date;\n  }\n\n  basis = basis || 0;\n  var sd = start_date.getDate();\n  var sm = start_date.getMonth() + 1;\n  var sy = start_date.getFullYear();\n  var ed = end_date.getDate();\n  var em = end_date.getMonth() + 1;\n  var ey = end_date.getFullYear();\n\n  switch (basis) {\n    case 0:\n      // US (NASD) 30/360\n      if (sd === 31 && ed === 31) {\n        sd = 30;\n        ed = 30;\n      } else if (sd === 31) {\n        sd = 30;\n      } else if (sd === 30 && ed === 31) {\n        ed = 30;\n      }\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n    case 1:\n      // Actual/actual\n      var feb29Between = function(date1, date2) {\n        var year1 = date1.getFullYear();\n        var mar1year1 = new Date(year1, 2, 1);\n        if (isLeapYear(year1) && date1 < mar1year1 && date2 >= mar1year1) {\n          return true;\n        }\n        var year2 = date2.getFullYear();\n        var mar1year2 = new Date(year2, 2, 1);\n        return (isLeapYear(year2) && date2 >= mar1year2 && date1 < mar1year2);\n      };\n      var ylength = 365;\n      if (sy === ey || ((sy + 1) === ey) && ((sm > em) || ((sm === em) && (sd >= ed)))) {\n        if ((sy === ey && isLeapYear(sy)) ||\n            feb29Between(start_date, end_date) ||\n            (em === 1 && ed === 29)) {\n          ylength = 366;\n        }\n        return daysBetween(start_date, end_date) / ylength;\n      }\n      var years = (ey - sy) + 1;\n      var days = (new Date(ey + 1, 0, 1) - new Date(sy, 0, 1)) / 1000 / 60 / 60 / 24;\n      var average = days / years;\n      return daysBetween(start_date, end_date) / average;\n    case 2:\n      // Actual/360\n      return daysBetween(start_date, end_date) / 360;\n    case 3:\n      // Actual/365\n      return daysBetween(start_date, end_date) / 365;\n    case 4:\n      // European 30/360\n      return ((ed + em * 30 + ey * 360) - (sd + sm * 30 + sy * 360)) / 360;\n  }\n};\n\nfunction serial(date) {\n  var addOn = (date > -2203891200000)?2:1;\n  return (date - d1900) / 86400000 + addOn;\n}","\"use strict\";\n\nmodule.exports = function getSanitizedSheetName(sheet_name) {\n    var quotedMatch = sheet_name.match(/^'(.*)'$/);\n    if (quotedMatch) {\n        return quotedMatch[1];\n    }\n    else {\n        return sheet_name;\n    }\n};\n","const RawValue = require('./RawValue.js');\nconst RefValue = require('./RefValue.js');\nconst Range = require('./Range.js');\n\nmodule.exports = function str_2_val(buffer, formula, position_i) { // buffer 在这里是但一个字符串表达式\n    var v;\n    if (!isNaN(buffer)) {\n        v = new RawValue(+buffer);\n    }\n    else if (buffer === 'TRUE') {\n        v = new RawValue(1);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+:[A-Z]+$/)) {\n        v = new Range(buffer.trim().replace(/\\$/g, ''), formula, position_i);\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n\n    }\n    else if (typeof buffer === 'string' && buffer.trim().replace(/\\$/g, '').match(/^[^!]+![A-Z]+[0-9]+$/)) {\n        v = new RefValue(buffer.trim().replace(/\\$/g, ''), formula);\n        v.end_pst = position_i // 后面一个字符的位置\n        v.buffer = buffer\n        v.start_pst = position_i - buffer.length\n\n    }\n    else if (typeof buffer === 'string' && !isNaN(buffer.trim().replace(/%$/, ''))) {\n        v = new RawValue(+(buffer.trim().replace(/%$/, '')) / 100.0);\n    }\n    else {\n        v = buffer;\n        v.end_pst = position_i // 后面一个字符的位置\n    }\n    return v;\n};\n","\"use strict\";\n\nconst getSanitizedSheetName = require('./getSanitizedSheetName.js');\n\nmodule.exports = function RefValue(str_expression, formula) {\n    var self = this;\n    this.name = 'RefValue';\n    this.str_expression = str_expression;\n    this.formula = formula;\n\n    self.parseRef = function() {\n        var sheet, sheet_name, cell_name, cell_full_name;\n        if (str_expression.indexOf('!') != -1) {\n            var aux = str_expression.split('!');\n            sheet_name = getSanitizedSheetName(aux[0]);\n            sheet = formula.wb.Sheets[sheet_name];\n            cell_name = aux[1];\n        }\n        else {\n            sheet = formula.sheet;\n            sheet_name = formula.sheet_name;\n            cell_name = str_expression;\n        }\n        if (!sheet) {\n            throw Error(\"Sheet \" + sheet_name + \" not found.\");\n        }\n        cell_full_name = sheet_name + '!' + cell_name;\n        return {\n            sheet: sheet,\n            sheet_name: sheet_name,\n            cell_name: cell_name,\n            cell_full_name: cell_full_name\n        };\n    };\n\n    this.calc = function() {\n        var resolved_ref = self.parseRef();\n        var sheet = resolved_ref.sheet;\n        var cell_name = resolved_ref.cell_name;\n        var cell_full_name = resolved_ref.cell_full_name;\n        var ref_cell = sheet[cell_name];\n        if (!ref_cell) {\n            return null;\n        }\n        var formula_ref = formula.formula_ref[cell_full_name];\n        if (formula_ref) {\n            if (formula_ref.status === 'new') {\n                formula.exec_formula(formula_ref);\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error with new formula', cell_full_name);\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n            else if (formula_ref.status === 'working') {\n                throw new Error('Circular ref');\n            }\n            else if (formula_ref.status === 'done') {\n                if (ref_cell.t === 'e') {\n                    console.log('ref is an error after formula eval');\n                    throw new Error(ref_cell.w);\n                }\n                return ref_cell.v;\n            }\n        }\n        else {\n            if (ref_cell.t === 'e') {\n                console.log('ref is an error with no formula', cell_name);\n                throw new Error(ref_cell.w);\n            }\n            return ref_cell.v;\n        }\n    };\n};\n","var categories = [\n  require('./lib/compatibility'),\n  require('./lib/database'),\n  require('./lib/engineering'),\n  require('./lib/logical'),\n  require('./lib/math-trig'),\n  require('./lib/text'),\n  require('./lib/date-time'),\n  require('./lib/financial'),\n  require('./lib/information'),\n  require('./lib/lookup-reference'),\n  require('./lib/statistical'),\n  require('./lib/miscellaneous'),\n  require('./lib/custom')\n];\n\nfor (var c in categories) {\n  var category = categories[c];\n  for (var f in category) {\n    exports[f] = exports[f] || category[f];\n  }\n}\n","var utils   = require('./utils');\nvar numeral = require('numeral');\n\nexports.UNIQUE = function () {\n  var result = [];\n  for (var i = 0; i < arguments.length; ++i) {\n    var hasElement = false;\n    var element    = arguments[i];\n\n    // Check if we've already seen this element.\n    for (var j = 0; j < result.length; ++j) {\n      hasElement = result[j] === element;\n      if (hasElement) { break; }\n    }\n\n    // If we did not find it, add it to the result.\n    if (!hasElement) {\n      result.push(element);\n    }\n  }\n  return result;\n};\n\nexports.FLATTEN = utils.flatten;\n\nexports.ARGS2ARRAY = function () {\n  return Array.prototype.slice.call(arguments, 0);\n};\n\nexports.REFERENCE = function (context, reference) {\n  try {\n    var path = reference.split('.');\n    var result = context;\n    for (var i = 0; i < path.length; ++i) {\n      var step = path[i];\n      if (step[step.length - 1] === ']') {\n        var opening = step.indexOf('[');\n        var index = step.substring(opening + 1, step.length - 1);\n        result = result[step.substring(0, opening)][index];\n      } else {\n        result = result[step];\n      }\n    }\n    return result;\n  } catch (error) {}\n};\n\nexports.JOIN = function (array, separator) {\n  return array.join(separator);\n};\n\nexports.NUMBERS = function () {\n  var possibleNumbers = utils.flatten(arguments);\n  return possibleNumbers.filter(function (el) {\n    return typeof el === 'number';\n  });\n};\n\nexports.NUMERAL = function (number, format) {\n  return numeral(number).format(format);\n};","var error = require('./error');\nvar jStat = require('jStat').jStat;\nvar text = require('./text');\nvar utils = require('./utils');\nvar bessel = require('bessel');\n\nfunction isValidBinaryNumber(number) {\n  return (/^[01]{1,10}$/).test(number);\n}\n\nexports.BESSELI = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besseli(x, n);\n};\n\nexports.BESSELJ = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselj(x, n);\n};\n\nexports.BESSELK = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.besselk(x, n);\n};\n\nexports.BESSELY = function(x, n) {\n  x = utils.parseNumber(x);\n  n = utils.parseNumber(n);\n  if (utils.anyIsError(x, n)) {\n    return error.value;\n  }\n  return bessel.bessely(x, n);\n};\n\nexports.BIN2DEC = function(number) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Convert binary number to decimal\n  var result = parseInt(number, 2);\n\n  // Handle negative numbers\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return parseInt(stringified.substring(1), 2) - 512;\n  } else {\n    return result;\n  }\n};\n\n\nexports.BIN2HEX = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\n  }\n\n  // Convert binary number to hexadecimal\n  var result = parseInt(number, 2).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BIN2OCT = function(number, places) {\n  // Return error if number is not binary or contains more than 10 characters (10 digits)\n  if (!isValidBinaryNumber(number)) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  var stringified = number.toString();\n  if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\n    return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\n  }\n\n  // Convert binary number to octal\n  var result = parseInt(number, 2).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.BITAND = function(number1, number2) {\n  // Return error if either number is a non-numeric value\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise AND of two numbers\n  return number1 & number2;\n};\n\nexports.BITLSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the left or to the right if shift is negative\n  return (shift >= 0) ? number << shift : number >> -shift;\n};\n\nexports.BITOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise OR of two numbers\n  return number1 | number2;\n};\n\nexports.BITRSHIFT = function(number, shift) {\n  number = utils.parseNumber(number);\n  shift = utils.parseNumber(shift);\n  if (utils.anyIsError(number, shift)) {\n    return error.value;\n  }\n\n  // Return error if number is less than 0\n  if (number < 0) {\n    return error.num;\n  }\n\n  // Return error if number is a non-integer\n  if (Math.floor(number) !== number) {\n    return error.num;\n  }\n\n  // Return error if number is greater than (2^48)-1\n  if (number > 281474976710655) {\n    return error.num;\n  }\n\n  // Return error if the absolute value of shift is greater than 53\n  if (Math.abs(shift) > 53) {\n    return error.num;\n  }\n\n  // Return number shifted by shift bits to the right or to the left if shift is negative\n  return (shift >= 0) ? number >> shift : number << -shift;\n};\n\nexports.BITXOR = function(number1, number2) {\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return error if either number is less than 0\n  if (number1 < 0 || number2 < 0) {\n    return error.num;\n  }\n\n  // Return error if either number is a non-integer\n  if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\n    return error.num;\n  }\n\n  // Return error if either number is greater than (2^48)-1\n  if (number1 > 281474976710655 || number2 > 281474976710655) {\n    return error.num;\n  }\n\n  // Return bitwise XOR of two numbers\n  return number1 ^ number2;\n};\n\nexports.COMPLEX = function(real, imaginary, suffix) {\n  real = utils.parseNumber(real);\n  imaginary = utils.parseNumber(imaginary);\n  //XW: 参数报错\n  if (utils.anyIsError(real, imaginary)) {\n    return error.value;\n  }\n  //XW：end\n\n  // Set suffix\n  suffix = (suffix === undefined) ? 'i' : suffix;\n  suffix = suffix.toLowerCase();\n  // Return error if suffix is neither \"i\" nor \"j\"\n  if (suffix !== 'i' && suffix !== 'j') {\n    return error.value;\n  }\n\n  // Return complex number\n  if (real === 0 && imaginary === 0) {\n    return 0;\n  } else if (real === 0) {\n    return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\n  } else if (imaginary === 0) {\n    return real.toString();\n  } else {\n    var sign = (imaginary > 0) ? '+' : '';\n    return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\n  }\n};\n\nexports.CONVERT = function(number, from_unit, to_unit) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n  // List of units supported by CONVERT and units defined by the International System of Units\n  // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion ratio]\n  var units = [\n    [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\n    [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\n    [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\n    [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\n    [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\n    [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\n    [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\n    [\"ångström\", \"Å\", [\"ang\"], \"length\", false, true, 1e-10],\n    [\"are\", \"ar\", null, \"area\", false, true, 100],\n    [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\n    [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\n    [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\n    [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\n    [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\n    [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\n    [\"byte\", \"byte\", null, \"information\", false, true, 8],\n    [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\n    [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\n    [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\n    [\"cubic ångström\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\n    [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\n    [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\n    [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\n    [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\n    [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\n    [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\n    [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\n    [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\n    [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\n    [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\n    [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\n    [\"degree\", \"°\", null, \"angle\", false, false, 0.0174532925199433],\n    [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\n    [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\n    [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\n    [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\n    [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\n    [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\n    [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\n    [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\n    [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\n    [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\n    [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\n    [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\n    [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\n    [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\n    [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\n    [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\n    [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\n    [\"henry\", \"H\", null, \"inductance\", true, false, 1],\n    [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\n    [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\n    [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\n    [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\n    [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\n    [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\n    [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\n    [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\n    [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\n    [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\n    [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\n    [\"joule\", \"J\", null, \"energy\", true, true, 1],\n    [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\n    [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\n    [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\n    [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\n    [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\n    [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\n    [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\n    [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\n    [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\n    [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\n    [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\n    [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\n    [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\n    [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\n    [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\n    [\"metre\", \"m\", null, \"length\", true, true, 1],\n    [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\n    [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\n    [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\n    [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\n    [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\n    [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\n    [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\n    [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\n    [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\n    [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\n    [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\n    [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1],\n    [\"newton\", \"N\", null, \"force\", true, true, 1],\n    [\"œrsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\n    [\"ohm\", \"Ω\", null, \"electric_resistance\", true, false, 1],\n    [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\n    [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\n    [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\n    [\"pferdestärke\", \"PS\", null, \"power\", false, true, 735.49875],\n    [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\n    [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\n    [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\n    [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\n    [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\n    [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\n    [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\n    [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\n    [\"radian\", \"rad\", null, \"angle\", true, false, 1],\n    [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\n    [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\n    [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\n    [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\n    [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\n    [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\n    [\"square ångström\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\n    [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\n    [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\n    [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\n    [\"square meter\", \"m?\", null, \"area\", true, true, 1],\n    [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\n    [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\n    [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\n    [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\n    [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\n    [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\n    [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\n    [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\n    [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\n    [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\n    [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\n    [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\n    [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\n    [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\n    [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\n    [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\n    [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\n    [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\n    [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\n    [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\n    [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\n    [\"volt\", \"V\", null, \"voltage\", true, false, 1],\n    [\"watt\", \"W\", null, \"power\", true, true, 1],\n    [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\n    [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\n    [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\n    [\"year\", \"yr\", null, \"time\", false, true, 31557600]\n  ];\n\n  // Binary prefixes\n  // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived from]\n  var binary_prefixes = {\n    Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\n    Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\n    Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\n    Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\n    Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\n    Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\n    Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\n    ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\n  };\n\n  // Unit prefixes\n  // [Name, Multiplier, Abbreviation]\n  var unit_prefixes = {\n    Y: [\"yotta\", 1e+24, \"Y\"],\n    Z: [\"zetta\", 1e+21, \"Z\"],\n    E: [\"exa\", 1e+18, \"E\"],\n    P: [\"peta\", 1e+15, \"P\"],\n    T: [\"tera\", 1e+12, \"T\"],\n    G: [\"giga\", 1e+09, \"G\"],\n    M: [\"mega\", 1e+06, \"M\"],\n    k: [\"kilo\", 1e+03, \"k\"],\n    h: [\"hecto\", 1e+02, \"h\"],\n    e: [\"dekao\", 1e+01, \"e\"],\n    d: [\"deci\", 1e-01, \"d\"],\n    c: [\"centi\", 1e-02, \"c\"],\n    m: [\"milli\", 1e-03, \"m\"],\n    u: [\"micro\", 1e-06, \"u\"],\n    n: [\"nano\", 1e-09, \"n\"],\n    p: [\"pico\", 1e-12, \"p\"],\n    f: [\"femto\", 1e-15, \"f\"],\n    a: [\"atto\", 1e-18, \"a\"],\n    z: [\"zepto\", 1e-21, \"z\"],\n    y: [\"yocto\", 1e-24, \"y\"]\n  };\n\n  // Initialize units and multipliers\n  var from = null;\n  var to = null;\n  var base_from_unit = from_unit.toLowerCase();\n  var base_to_unit = to_unit.toLowerCase();\n  var from_multiplier = 1;\n  var to_multiplier = 1;\n  var alt;\n  // Lookup from and to units\n  for (var i = 0; i < units.length; i++) {\n    alt = (units[i][2] === null) ? [] : units[i][2];\n    if (units[i][1].toLowerCase() === base_from_unit || alt.indexOf(from_unit) >= 0) {\n      from = units[i];\n    }\n    if (units[i][1].toLowerCase() === base_to_unit || alt.indexOf(to_unit) >= 0) {\n      to = units[i];\n    }\n  }\n  // Lookup from prefix\n  if (from === null) {\n    var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\n    var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (from_unit.substring(0, 2) === 'da') {\n      from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (from_binary_prefix) {\n      from_multiplier = from_binary_prefix[2];\n      base_from_unit = from_unit.substring(2);\n    } else if (from_unit_prefix) {\n      from_multiplier = from_unit_prefix[1];\n      base_from_unit = from_unit.substring(from_unit_prefix[2].length);\n    }\n\n    // Lookup from unit\n    for (var j = 0; j < units.length; j++) {\n      alt = (units[j][2] === null) ? [] : units[j][2];\n      if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\n        from = units[j];\n      }\n    }\n  }\n\n  // Lookup to prefix\n  if (to === null) {\n    var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\n    var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\n\n    // Handle dekao unit prefix (only unit prefix with two characters)\n    if (to_unit.substring(0, 2) === 'da') {\n      to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\n    }\n\n    // Handle binary prefixes first (so that 'Yi' is processed before 'Y')\n    if (to_binary_prefix) {\n      to_multiplier = to_binary_prefix[2];\n      base_to_unit = to_unit.substring(2);\n    } else if (to_unit_prefix) {\n      to_multiplier = to_unit_prefix[1];\n      base_to_unit = to_unit.substring(to_unit_prefix[2].length);\n    }\n\n    // Lookup to unit\n    for (var k = 0; k < units.length; k++) {\n      alt = (units[k][2] === null) ? [] : units[k][2];\n      if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\n        to = units[k];\n      }\n    }\n  }\n\n  // Return error if a unit does not exist\n  if (from === null || to === null) {\n    return error.na;\n  }\n\n  //Return error if units represent different quantities\n  if (from[3] !== to[3]) {\n    if(from_unit == 'F' && to_unit == 'C'){\n      return (number-32)/1.8\n    }\n    if(from_unit == 'C' && to_unit == 'F'){\n      return number * 1.8 + 32\n    }\n    return error.na;\n  }\n\n  // Return converted number\n  return number * from[6] * from_multiplier / (to[6] * to_multiplier);\n};\n\nexports.DEC2BIN = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -512, or is greater than 511\n  if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (number < 0) {\n    return '1' + text.REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = parseInt(number, 10).toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2HEX = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character hexadecimal number if number is negative\n  if (number < 0) {\n    return (1099511627776 + number).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = parseInt(number, 10).toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DEC2OCT = function(number, places) {\n  number = utils.parseNumber(number);\n  if (number instanceof Error) {\n    return number;\n  }\n\n  // Return error if number is not decimal, is lower than -549755813888, or is greater than 549755813887\n  if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (number < 0) {\n    return (1073741824 + number).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = parseInt(number, 10).toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.DELTA = function(number1, number2) {\n  // Set number2 to zero if undefined\n  number2 = (number2 === undefined) ? 0 : number2;\n  number1 = utils.parseNumber(number1);\n  number2 = utils.parseNumber(number2);\n  if (utils.anyIsError(number1, number2)) {\n    return error.value;\n  }\n\n  // Return delta\n  return (number1 === number2) ? 1 : 0;\n};\n\n// TODO: why is upper_bound not used ? The excel documentation has no examples with upper_bound\nexports.ERF = function(lower_bound, upper_bound) {\n  // Set number2 to zero if undefined\n  upper_bound = (upper_bound === undefined) ? 0 : upper_bound;\n\n  lower_bound = utils.parseNumber(lower_bound);\n  upper_bound = utils.parseNumber(upper_bound);\n  if (utils.anyIsError(lower_bound, upper_bound)) {\n    return error.value;\n  }\n\n  return jStat.erf(lower_bound);\n};\n\n// TODO\nexports.ERF.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERF(x)\n};\n\nexports.ERFC = function(x) {\n  // Return error if x is not a number\n  if (isNaN(x)) {\n    return error.value;\n  }\n\n  return jStat.erfc(x);\n};\n\n// TODO\nexports.ERFC.PRECISE = function(x) {\n  if (isNaN(x)) {\n    return error.value;\n  }\n  var Formulas = window.jsSpreadsheet.AllFormulas;\n  return Formulas.ERFC(x)\n};\n\nexports.GESTEP = function(number, step) {\n  step = step || 0;\n  number = utils.parseNumber(number);\n  if (utils.anyIsError(step, number)) {\n    return number;\n  }\n\n  // Return delta\n  return (number >= step) ? 1 : 0;\n};\n\nexports.HEX2BIN = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\n\n  // Convert hexadecimal number to decimal\n  var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\n\n  // Return error if number is lower than -512 or greater than 511\n  if (decimal < -512 || decimal > 511) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.HEX2DEC = function(number) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return decimal number\n  return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\n};\n\nexports.HEX2OCT = function(number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert hexadecimal number to decimal\n  var decimal = parseInt(number, 16);\n\n  // Return error if number is positive and greater than 0x1fffffff (536870911)\n  if (decimal > 536870911 && decimal < 1098974756864) {\n    return error.num;\n  }\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 1098974756864) {\n    return (decimal - 1098437885952).toString(8);\n  }\n\n  // Convert decimal number to octal\n  var result = decimal.toString(8);\n\n  // Return octal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\nexports.ROWS = function (matrix) {\n  if (typeof matrix == 'string'){\n    matrix = utils.strToMatrix(matrix)\n  }\n\n  if (!(matrix instanceof Array)) {\n    return error.value;\n  }\n\n  if (matrix.length === 0) {\n    return 0;\n  }\n\n  return jStat.rows(matrix);\n};\nfunction trans_num(inumber){\n  inumber = inumber.toString()\n  inumber = inumber.replace('I', 'i').replace('J', 'j')\n  return inumber\n}\nexports.IMABS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return absolute value of complex number\n  return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n};\n\nexports.IMAGINARY = function (inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', 'j'].indexOf(inumber) >= 0) {\n    return 1;\n  }\n\n  // Normalize imaginary coefficient\n  inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return imaginary coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(plus + 1, inumber.length - 1));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        -Number(inumber.substring(minus + 1, inumber.length - 1));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\n    } else {\n      return (isNaN(inumber)) ? error.num : 0;\n    }\n  }\n};\n\nexports.IMARGUMENT = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return error if inumber is equal to zero\n  if (x === 0 && y === 0) {\n    return error.div0;\n  }\n\n  // Return PI/2 if x is equal to zero and y is positive\n  if (x === 0 && y > 0) {\n    return Math.PI / 2;\n  }\n\n  // Return -PI/2 if x is equal to zero and y is negative\n  if (x === 0 && y < 0) {\n    return -Math.PI / 2;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x > 0) {\n    return 0;\n  }\n\n  // Return zero if x is negative and y is equal to zero\n  if (y === 0 && x < 0) {\n    return -Math.PI;\n  }\n\n  // Return argument of complex number\n  if (x > 0) {\n    return Math.atan(y / x);\n  } else if (x < 0 && y >= 0) {\n    return Math.atan(y / x) + Math.PI;\n  } else {\n    return Math.atan(y / x) - Math.PI;\n  }\n};\n\nexports.IMCONJUGATE = function (inumber) {\n  inumber = trans_num(inumber)\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return conjugate of complex number\n  return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\n};\n\nexports.IMCOS = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return cosine of complex number\n  return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMCOSH = function (inumber) {\n  // Lookup real and imaginary coefficients using exports.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic cosine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\n};\n\nexports.IMCOT = function (inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return cotangent of complex number\n  return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\n};\n\nexports.IMDIV = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return error if inumber2 is null\n  if (c === 0 && d === 0) {\n    return error.num;\n  }\n\n  // Return exponential of complex number\n  var den = c * c + d * d;\n  return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\n};\n\nexports.IMEXP = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  var e = Math.exp(x);\n  return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\n};\n\nexports.IMLN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\n};\n\nexports.IMLOG10 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\n};\n\nexports.IMLOG2 = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return exponential of complex number\n  return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\n};\n\nexports.IMPOWER = function(inumber, number) {\n  inumber = trans_num(inumber)\n  number = utils.parseNumber(number);\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n  if (utils.anyIsError(number, x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var p = Math.pow(exports.IMABS(inumber), number);\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\n};\n\nexports.IMPRODUCT = function() {\n  // Initialize result\n  var result = arguments[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < arguments.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(arguments[i]);\n    var d = exports.IMAGINARY(arguments[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a * c - b * d, a * d + b * c);\n  }\n\n  // Return product of complex numbers\n  return result;\n};\n\nexports.IMREAL = function(inumber) {\n  inumber = trans_num(inumber)\n  if (inumber === undefined || inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Return 0 if inumber is equal to 0\n  if (inumber === 0 || inumber === '0') {\n    return 0;\n  }\n\n  // Handle special cases\n  if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\n    return 0;\n  }\n\n  // Lookup sign\n  var plus = inumber.indexOf('+');\n  var minus = inumber.indexOf('-');\n  if (plus === 0) {\n    plus = inumber.indexOf('+', 1);\n  }\n  if (minus === 0) {\n    minus = inumber.indexOf('-', 1);\n  }\n\n  // Lookup imaginary unit\n  var last = inumber.substring(inumber.length - 1, inumber.length);\n  var unit = (last === 'i' || last === 'j');\n\n  if (plus >= 0 || minus >= 0) {\n    // Return error if imaginary unit is neither i nor j\n    if (!unit) {\n      return error.num;\n    }\n\n    // Return real coefficient of complex number\n    if (plus >= 0) {\n      return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, plus));\n    } else {\n      return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\n        error.num :\n        Number(inumber.substring(0, minus));\n    }\n  } else {\n    if (unit) {\n      return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\n    } else {\n      return (isNaN(inumber)) ? error.num : inumber;\n    }\n  }\n};\n\nexports.IMSEC = function(inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return secant of complex number\n  return exports.IMDIV('1', exports.IMCOS(inumber));\n};\n\nexports.IMSECH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return hyperbolic secant of complex number\n  return exports.IMDIV('1', exports.IMCOSH(inumber));\n};\n\nexports.IMSIN = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return sine of complex number\n  return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\n};\n\nexports.IMSINH = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Return hyperbolic sine of complex number\n  return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\n};\n\nexports.IMSQRT = function(inumber) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber = trans_num(inumber)\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit = inumber.substring(inumber.length - 1);\n  unit = (unit === 'i' || unit === 'j') ? unit : 'i';\n\n  // Calculate power of modulus\n  var s = Math.sqrt(exports.IMABS(inumber));\n\n  // Calculate argument\n  var t = exports.IMARGUMENT(inumber);\n\n  // Return exponential of complex number\n  return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\n};\n\nexports.IMCSC = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return cosecant of complex number\n  return exports.IMDIV('1', exports.IMSIN(inumber));\n};\n\nexports.IMCSCH = function (inumber) {\n  // Return error if inumber is a logical value\n  inumber = trans_num(inumber)\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  // Return error if either coefficient is not a number\n  if (utils.anyIsError(x, y)) {\n    return error.num;\n  }\n\n  // Return hyperbolic cosecant of complex number\n  return exports.IMDIV('1', exports.IMSINH(inumber));\n};\n\nexports.IMSUB = function(inumber1, inumber2) {\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  inumber1 = trans_num(inumber1)\n  inumber2 = trans_num(inumber2)\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var a = exports.IMREAL(inumber1);\n  var b = exports.IMAGINARY(inumber1);\n  var c = exports.IMREAL(inumber2);\n  var d = exports.IMAGINARY(inumber2);\n\n  if (utils.anyIsError(a, b, c, d)) {\n    return error.value;\n  }\n\n  // Lookup imaginary unit\n  var unit1 = inumber1.substring(inumber1.length - 1);\n  var unit2 = inumber2.substring(inumber2.length - 1);\n  var unit = 'i';\n  if (unit1 === 'j') {\n    unit = 'j';\n  } else if (unit2 === 'j') {\n    unit = 'j';\n  }\n\n  // Return _ of two complex numbers\n  return exports.COMPLEX(a - c, b - d, unit);\n};\n\nexports.IMSUM = function (inumber) {\n  inumber = trans_num(inumber)\n  var args = utils.flatten(arguments);\n\n  // Initialize result\n  var result = args[0];\n\n  // Loop on all numbers\n  for (var i = 1; i < args.length; i++) {\n    // Lookup coefficients of two complex numbers\n    var a = exports.IMREAL(result);\n    var b = exports.IMAGINARY(result);\n    var c = exports.IMREAL(args[i]);\n    var d = exports.IMAGINARY(args[i]);\n\n    if (utils.anyIsError(a, b, c, d)) {\n      return error.value;\n    }\n\n    // Complute product of two complex numbers\n    result = exports.COMPLEX(a + c, b + d);\n  }\n\n  // Return sum of complex numbers\n  return result;\n};\n\nexports.IMTAN = function (inumber) {\n  inumber = trans_num(inumber)\n  // Return error if inumber is a logical value\n  if (inumber === true || inumber === false) {\n    return error.value;\n  }\n\n  // Lookup real and imaginary coefficients using Formula.js [http://formulajs.org]\n  var x = exports.IMREAL(inumber);\n  var y = exports.IMAGINARY(inumber);\n\n  if (utils.anyIsError(x, y)) {\n    return error.value;\n  }\n\n  // Return tangent of complex number\n  return exports.IMDIV(exports.IMSIN(inumber), exports.IMCOS(inumber));\n};\n\nexports.OCT2BIN = function (number, places) {\n  // Return error if number is not hexadecimal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Check if number is negative\n  var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\n\n  // Convert octal number to decimal\n  var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\n\n  // Return error if number is lower than -512 or greater than 511\n  // if (decimal < -512 || decimal > 511) {\n  //     return error.num;\n  // }\n\n  // Ignore places and return a 10-character binary number if number is negative\n  if (negative) {\n    return '1' + text.REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\n  }\n\n  // Convert decimal number to binary\n  var result = decimal.toString(2);\n  if (result.length >=10){\n    return result.slice(result.length-10, result.length)\n  }\n  // Return binary number using the minimum number of characters necessary if places is undefined\n  if (typeof places === 'undefined') {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};\n\nexports.OCT2DEC = function(number) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Return decimal number\n  return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\n};\n\nexports.OCT2HEX = function(number, places) {\n  // Return error if number is not octal or contains more than ten characters (10 digits)\n  if (!/^[0-7]{1,10}$/.test(number)) {\n    return error.num;\n  }\n\n  // Convert octal number to decimal\n  var decimal = parseInt(number, 8);\n\n  // Ignore places and return a 10-character octal number if number is negative\n  if (decimal >= 536870912) {\n    return 'ff' + (decimal + 3221225472).toString(16);\n  }\n\n  // Convert decimal number to hexadecimal\n  var result = decimal.toString(16);\n\n  // Return hexadecimal number using the minimum number of characters necessary if places is undefined\n  if (places === undefined) {\n    return result;\n  } else {\n    // Return error if places is nonnumeric\n    if (isNaN(places)) {\n      return error.value;\n    }\n\n    // Return error if places is negative\n    if (places < 0) {\n      return error.num;\n    }\n\n    // Truncate places in case it is not an integer\n    places = Math.floor(places);\n\n    // Pad return value with leading 0s (zeros) if necessary (using Underscore.string)\n    return (places >= result.length) ? text.REPT('0', places - result.length) + result : error.num;\n  }\n};","\"use strict\";\nmodule.exports = function find_all_need_calc_cell(wb, tileArr, exec_formula) {\n    var need_calc_cells = tileArr.findAllNeedCalcCell()\n    let formula_ref = {};\n    let cells = [];\n    for (let sheet_name in wb.Sheets) {\n        let sheet = wb.Sheets[sheet_name];\n        for(let i=0; i<need_calc_cells.length; i++){\n            let cell_name = need_calc_cells[i]\n            let formula = formula_ref[sheet_name + '!' + cell_name] = {\n                formula_ref: formula_ref,\n                wb: wb,\n                sheet: sheet,\n                sheet_name: sheet_name,\n                cell: sheet[cell_name],\n                name: cell_name,\n                status: 'new',\n                exec_formula: exec_formula\n            };\n            cells.push(formula);\n        }\n    }\n    return cells;\n};\n","var helper = require(\"../core/helper\")\n//XW: end\n//XW:大括号参数判断,有大括号参数用''包起来作为一个参数\nexports.trans_params = function (cell) {\n  var reg = new RegExp('\\{(.*?)\\}', 'g')\n  var arg = cell.f.match(reg)\n  if (arg != null){\n    for (var i=0; i<arg.length; i++){\n      var param = arg[i]\n      var rep = \"'\" + param + \"'\"\n      cell.f = cell.f.replace(param, rep)\n    }\n  }\n  return cell\n}\n//XW:end\n//XW: 将空单元格置为default_0\nexports.trans_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 0 && sheet[i].f === \"\"){\n      sheet[i].v = 'default_0'\n    }\n  });\n  return sheet\n}\n\nexports.recover_sheet = function (sheet) {\n  Object.keys(sheet).forEach(i => {\n    if (sheet[i].v === 'default_0'){\n      if (!helper.isHave(sheet[i].f)) {\n        sheet[i].f = \"\"\n      }\n      sheet[i].v = 0\n    }\n  });\n  return sheet\n}\n//XW: end\n//XW: 去除公式开头结尾的空格\nexports.strim = function (str){\n  let str1 = str.replace(/\\s+$/,'');\n  let str2 = str1.replace(/^\\s+/,'')\n  return str2;\n}\n//XW： end\n\n//xW: 公式参数转换\nexports.trans_formula = function(f){\n  //特殊公式转换 FLOOR->FLOORMATH, vap-> vara等\n  var trans_dict = {\n    'FLOOR': 'FLOORMATH',\n    'VAR': 'VARA',\n    'WORKDAY.INTL': 'WORKDAYINTL'\n  }\n  for(var i in trans_dict){\n    var b = trans_dict[i]\n    if (f.indexOf(b) < 0 && f.indexOf(i)>=0 && f.indexOf(i + '.') <=0){\n      f = f.replace(i, b)\n    }\n  }\n  //_XLFN. 开头的函数去掉开头\n  f = f.replace('_XLFN.', '')\n  //将函数公式中除\"\"中的其他部分转成大写\n  var reg = new RegExp('\"(.*?)\"', 'g')\n  var arg = f.match(reg)\n  if (f.indexOf('=') === 0){\n    f = f.toUpperCase()\n    if (arg != null) {\n      for (var i = 0; i < arg.length; i++) {\n        var param = arg[i].toUpperCase()\n        if(f.indexOf(param) >= 0){\n          f = f.replace(param, arg[i])\n        }\n      }\n    }\n  }\n  return f\n}\n//xW:end\n","exports.nil = new Error('#NULL!');\nexports.div0 = new Error('#DIV/0!');\nexports.value = new Error('#VALUE?');\nexports.ref = new Error('#REF!');\nexports.name = new Error('#NAME?');\nexports.num = new Error('#NUM!');\nexports.na = new Error('#N/A');\nexports.error = new Error('#ERROR!');\nexports.data = new Error('#GETTING_DATA');\n"],"sourceRoot":""}