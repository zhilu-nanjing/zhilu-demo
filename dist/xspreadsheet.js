!function(e){function t(t){for(var n,o,s=t[0],l=t[1],u=t[2],f=0,h=[];f<s.length;f++)o=s[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(c&&c(t);h.length;)h.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,s=1;s<r.length;s++){var l=r[s];0!==i[l]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},i={3:0},a=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=l;a.push([221,2,0]),r()}([,function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.Element=void 0;var a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t?(this.el=document.createElement(t),this.el.className=r):this.el=t,this.data={}}var t,r,a;return t=e,(r=[{key:"data",value:function(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}},{key:"on",value:function(e,t){var r=n(e.split(".")),i=r[0],a=r.slice(1),o=i;return"mousewheel"===o&&/Firefox/i.test(window.navigator.userAgent)&&(o="DOMMouseScroll"),this.el.addEventListener(o,(function(e){t(e);for(var r=0;r<a.length;r+=1){var n=a[r];if("left"===n&&0!==e.button)return;if("right"===n&&2!==e.button)return;"stop"===n&&e.stopPropagation()}})),this}},{key:"offset",value:function(e){var t=this;if(void 0!==e)return Object.keys(e).forEach((function(r){t.css(r,"".concat(e[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(e){var t=this.el;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"children",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(t){return e.child(t)})),this)}},{key:"child",value:function(t){var r=t;return"string"==typeof t?r=document.createTextNode(t):t instanceof e&&(r=t.el),this.el.appendChild(r),this}},{key:"contains",value:function(e){return this.el.contains(e)}},{key:"className",value:function(e){return void 0!==e?(this.el.className=e,this):this.el.className}},{key:"addClass",value:function(e){return this.el.classList.add(e),this}},{key:"hasClass",value:function(e){return this.el.classList.contains(e)}},{key:"removeClass",value:function(e){return this.el.classList.remove(e),this}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(e)}},{key:"toggleClass",value:function(e){return this.el.classList.toggle(e)}},{key:"active",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return e?this.addClass(t):this.removeClass(t),this}},{key:"checked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(e,"checked"),this}},{key:"disabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(e,t){var r=this;if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((function(t){r.el.setAttribute(t,e[t])}))}return this}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"html",value:function(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}},{key:"val",value:function(e){return void 0!==e?(this.el.value=e,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){return e.el.style.removeProperty(t)})),this}},{key:"css",value:function(e,t){var r=this;return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach((function(t){r.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}},{key:"removeEl",value:function(){this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"isShow",value:function(){return"block"===this.el.style.display}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";return this.css(e,t),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";return this.css(e,t),this}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Element=a;t.h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new a(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offsetTop=t.offsetLeft=t.filterFormula=t.look2=t.look=t.cssPrefix=void 0;t.cssPrefix="fin-cell";t.look=["*悬浮查看*","*HYPERLINK*","*MULTIPLECELLS*"];t.look2="#CHECK！";t.filterFormula=["CITY"];t.offsetLeft=60;t.offsetTop=70},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNumber=function(e){return"NaN"!==parseFloat(e).toString()},t.isOusideViewRange=function(e,t,r,n,i){if(44===i&&r-e+100>0)return!0;if(11===i&&n-100<0)return!0;if(33===i&&n-t+100>0)return!0;if(22===i&&r-100<0)return!0;return!1},t.find=function(e,t){for(var r=0;r<e.length;r++)if(-1!==t.indexOf(e[r]))return!0;return!1},t.isHave=function(e){if(void 0===e)return!1;return null!==e},t.default=void 0;var n=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((function(r){null!=r&&void 0!==r&&Object.keys(r).forEach((function(n){var i=r[n];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?t[n]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(t[n]=t[n]||{},e(t[n],i)):t[n]=i}))})),t};var i={cloneDeep:function(e){return JSON.parse(JSON.stringify(e))},merge:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,[{}].concat(t))},equals:function e(t,r){var n=Object.keys(t);if(n.length!==Object.keys(r).length)return!1;for(var i=0;i<n.length;i+=1){var a=n[i],o=t[a],s=r[a];if(void 0===s)return!1;if("string"==typeof o||"number"==typeof o||"boolean"==typeof o){if(o!==s)return!1}else if(Array.isArray(o)){if(o.length!==s.length)return!1;for(var l=0;l<o.length;l+=1)if(!e(o[l],s[l]))return!1}else if("function"!=typeof o&&!Array.isArray(o)&&o instanceof Object&&!e(o,s))return!1}return!0},arrayEquals:function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(e[r]!==t[r])return!1;return!0},sum:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},r=0,n=0;return Object.keys(e).forEach((function(i){r+=t(e[i],i),n+=1})),[r,n]},rangeSum:function(e,t,r){for(var n=0,i=e;i<t;i+=1)n+=r(i);return n},rangeReduceIf:function(e,t,r,n,i,a){for(var o=r,s=n,l=e;l<t&&!(o>i);l+=1)o+=s=a(l);return[l,o-s,s]}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringAt=i,t.indexAt=a,t.expr2xy=o,t.xy2expr=s,t.default=void 0;var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function i(e){for(var t="",r=e;r>=n.length;)r/=n.length,r-=1,t+=n[parseInt(r,10)%n.length];var i=e%n.length;return t+=n[i]}function a(e){for(var t=0,r=0;r<e.length-1;r+=1){var i=e.charCodeAt(r)-65,a=e.length-1-r;t+=Math.pow(n.length,a)+n.length*i}return t+=e.charCodeAt(e.length-1)-65}function o(e){for(var t="",r="",n=0;n<e.length;n+=1)e.charAt(n)>="0"&&e.charAt(n)<="9"?r+=e.charAt(n):t+=e.charAt(n);return[a(t),parseInt(r,10)-1]}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e*=1,t*=1,2===r?"".concat(i(e),"$").concat(t+1):1===r?"$".concat(i(e)).concat(t+1):"".concat(i(e)).concat(t+1)}var l={expr2xy:o,xy2expr:s};t.default=l},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellRange=t.default=void 0;var n=r(4);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sri=t,this.sci=r,this.eri=n,this.eci=i,this.w=a,this.h=o}var t,r,o;return t=e,o=[{key:"valueOf",value:function(t){var r=t.split(":"),a=i((0,n.expr2xy)(r[0]),2),o=a[0],s=a[1],l=s,u=o;if(r.length>1){var c=i((0,n.expr2xy)(r[1]),2);u=c[0],l=c[1]}return new e(s,o,l,u)}}],(r=[{key:"set",value:function(e,t,r,n){this.sri=e,this.sci=t,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var e=0,t=0,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];if(1===a.length){var s=(0,n.expr2xy)(a[0]),l=i(s,2);t=l[0],e=l[1]}else 2===a.length&&(e=a[0],t=a[1]);var u=this.sri,c=this.sci,f=this.eri,h=this.eci;return u<=e&&e<=f&&c<=t&&t<=h}},{key:"each",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,i=this.eri,a=this.eci,o=r;o<=i;o+=1)if(t(o))for(var s=n;s<=a;s+=1)e(o,s)}},{key:"getType",value:function(){var e=this.sri,t=this.sci,r=this.eri,n=this.eci;return e===r&&t!==n?1:e!==r&&t===n?2:e!==r&&t!==n?3:e===r&&t===n?1:(console.error("未知情况"),4)}},{key:"move",value:function(e,t){var r=this.eri-this.sri,n=this.eci-this.sci;this.sri=e,this.sci=t,this.eri=this.sri+r,this.eci=this.sci+n}},{key:"move2",value:function(e,t,r,n){this.sri=e,this.sci=t,this.eri=r,this.eci=n}},{key:"contains",value:function(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}},{key:"within",value:function(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}},{key:"disjoint",value:function(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}},{key:"intersects",value:function(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}},{key:"getMovePos",value:function(e,t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci,o=0;return e>i&&t>a?o=1:e>i&&t<n?o=7:e<r&&t>a?o=8:t<n&&e<r?o=4:e>i?o=2:t>a?o=3:t<n?o=5:e<r&&(o=6),o}},{key:"union",value:function(t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci;return new e(t.sri<r?t.sri:r,t.sci<n?t.sci:n,t.eri>i?t.eri:i,t.eci>a?t.eci:a)}},{key:"difference",value:function(t){var r=[],n=function(t,n,i,a){r.push(new e(t,n,i,a))},i=this.sri,a=this.sci,o=this.eri,s=this.eci,l=t.sri-i,u=t.sci-a,c=o-t.eri,f=s-t.eci;return l>0?(n(i,a,t.sri-1,s),c>0?(n(t.eri+1,a,o,s),u>0&&n(t.sri,a,t.eri,t.sci-1),f>0&&n(t.sri,t.eci+1,t.eri,s)):(u>0&&n(t.sri,a,o,t.sci-1),f>0&&n(t.sri,t.eci+1,o,s))):c>0&&(n(t.eri+1,a,o,s),u>0&&n(i,a,t.eri,t.sci-1),f>0&&n(i,t.eci+1,t.eri,s)),u>0?(n(i,a,o,t.sci-1),f>0?(n(i,t.eri+1,o,s),l>0&&n(i,t.sci,t.sri-1,t.eci),c>0&&n(t.sri+1,t.sci,o,t.eci)):(l>0&&n(i,t.sci,t.sri-1,s),c>0&&n(t.sri+1,t.sci,o,s))):f>0&&(n(o,t.eci+1,o,s),l>0&&n(i,a,t.sri-1,t.eci),c>0&&n(t.eri+1,a,o,t.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var e=this.sri,t=this.sci,r=this.eri,i=this.eci,a=(0,n.xy2expr)(t,e);return this.multiple()&&(a="".concat(a,":").concat((0,n.xy2expr)(i,r))),a}},{key:"includeByRiCi",value:function(e,t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci;return r<=e&&i>=e&&n<=t&&a>=t}},{key:"getLocationArray",value:function(e){var t=[],r=0;return this.each((function(n,i){t.push({ri:n,ci:i,v:e[r%e.length].tmp,type:e[r%e.length].type}),r+=1})),t}},{key:"equals",value:function(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}}])&&a(t.prototype,r),o&&a(t,o),e}();t.CellRange=o;var s=o;t.default=s},,,function(e,t,r){"use strict";t.nil=new Error("#NULL!"),t.div0=new Error("#DIV/0!"),t.value=new Error("#VALUE?"),t.ref=new Error("#REF!"),t.name=new Error("#NAME?"),t.num=new Error("#NUM!"),t.na=new Error("#N/A"),t.error=new Error("#ERROR!"),t.data=new Error("#GETTING_DATA")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bind=i,t.remove=function(){for(var e=0;e<n.length;e++){var t=n[e];a(t.target,t.name,t.fn)}},t.unbind=a,t.unbindClickoutside=o,t.createEvent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keydown",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=document.createEvent("HTMLEvents");i.initEvent(r,!0,!0),i.eventType="message",i.buttons=n,i.keyCode=e,i.metaKey=t,document.dispatchEvent(i)},t.bindClickoutside=function(e,t){e.xclickoutside=function(r){2===r.detail||e.contains(r.target)||(t?t(e):(e.hide(),o(e)))},i(window.document.body,"click",e.xclickoutside)},t.mouseMoveUp=function(e,t,r){i(e,"mousemove",t),e.xEvtUp=function(n){a(e,"mousemove",t),a(e,"mouseup",e.xEvtUp),r(n)},i(e,"mouseup",e.xEvtUp)},t.bindTouch=function(e,t){var r=t.move,n=t.end,a=0,o=0;i(e,"touchstart",(function(e){var t=e.touches[0],r=t.pageX,n=t.pageY;a=r,o=n})),i(e,"touchmove",(function(e){if(r){var t=e.changedTouches[0],n=t.pageX,i=t.pageY,l=n-a,u=i-o;(Math.abs(l)>10||Math.abs(u)>10)&&(s(l,u,e,r),a=n,o=i),e.preventDefault()}})),i(e,"touchend",(function(e){if(n){var t=e.changedTouches[0],r=t.pageX,i=t.pageY;s(r-a,i-o,e,n)}}))};var n=[];function i(e,t,r){e.addEventListener(t,r),n.push({name:t,fn:r,target:e})}function a(e,t,r){e.removeEventListener(t,r)}function o(e){e.xclickoutside&&(a(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function s(e,t,r,n){Math.abs(e)>Math.abs(t)?n(e>0?"right":"left",e,r):n(t>0?"down":"up",t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locale=function(e,t){a=e,t&&(o[e]=t)},t.t=l,t.tf=function(e){return function(){return l(e)}},t.default=void 0;var n,i=(n=r(223))&&n.__esModule?n:{default:n};var a="en",o={en:i.default};function s(e,t){if(t&&t[a])for(var r=t[a],n=e.split("."),i=0;i<n.length;i+=1){var o=r[n[i]];if(i===n.length-1)return o;if(!o)return;r=o}}function l(e){var t=s(e,o);return!t&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(t=s(e,window.x.spreadsheet.$messages)),t||""}var u={t:l};t.default=u},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=s(this,l(t).call(this,"div","".concat(i.cssPrefix,"-icon")))).iconNameEl=(0,n.h)("div","".concat(i.cssPrefix,"-icon-img ").concat(e)),r.child(r.iconNameEl),r}var r,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(a=[{key:"setName",value:function(e){this.iconNameEl.className("".concat(i.cssPrefix,"-icon-img ").concat(e))}}])&&o(r.prototype,a),c&&o(r,c),t}(n.Element);t.default=c},,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(9);function a(e){return e&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?e.concat(t):r?(e.push(t),e):n?[e].concat(t):[e,t]})):e}function o(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function s(e){if(e instanceof Error)return e;if(e instanceof Array){for(var t=[],r=0;r<e.length;r++){if("string"==typeof e[r][0]&&"default_0"!==e[r][0])return i.name;if("number"==typeof e[r][0]&&t.push(e[r][0]),e[r][0]instanceof Object)return i.name}return t}return"string"==typeof e?"default_0"===e?"pass":i.name:"number"==typeof e?e:void 0}t.flatten=function(){for(var e=t.argsToArray.apply(null,arguments);!o(e);)e=a(e);return e},t.argsToArray=function(e){return Array.prototype.slice.call(e,0)},t.numbers=function(){return possibleNumbers.filter((function(e){return"number"==typeof e}))},t.flattenNum=function(e){try{if(1===e.length&&"default_0"===e[0][0])return i.div0;for(var t=[],r=0;r<e.length;r++){var n=s(e[r]);if(void 0===n)return i.name;if(n instanceof Error)return n;if("pass"!==n)if(n instanceof Array)for(var a=0;a<n.length;a++)t.push(n[a]);else t.push(n)}return t}catch(e){return i.name}},t.cleanFloat=function(e){return Math.round(1e14*e)/1e14},t.parseBool=function(e){if(void 0===e)return!0;if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||i.value},t.parseNumber=function(e){return void 0===e||""===e?i.value:isNaN(e)?i.value:parseFloat(e)},t.parseNumberArray=function(e){var r,n;if(!e||0===(r=e.length))return i.value;for(;r--;){if((n=t.parseNumber(e[r]))===i.value)return n;e[r]=n}return e},t.parseMatrix=function(e){var r;if(!e||0===e.length)return i.value;for(var n=0;n<e.length;n++)if(r=t.parseNumberArray(e[n]),e[n]=r,r instanceof Error)return r;return e};var l=new Date(1900,0,1);function u(e){return isNaN(parseInt(e))?e.replace('"',"").replace('"',""):parseInt(e)}t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?i.num:t<=60?new Date(l.getTime()+864e5*(t-1)):new Date(l.getTime()+864e5*(t-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?i.value:e},t.Copy=function(e){if(null==e||"object"!=n(e))return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(var t=[],r=0;r<e.length;++r)t[r]=clone(e[r]);return t}if(e instanceof Object){t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=clone(e[i]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},t.strToMatrix=function(e){for(var t=e.slice(2,e.length-2).split(","),r=[],n=[],i=0;i<t.length;i++){var a=t[i].toString();a.indexOf(";")>0?(n.push(u(a.split(";")[0])),r.push(n),n=[u(a.split(";")[1])]):n.push(u(a))}return r.push(n),r},t.ExcelDateToJSDate=function(e){return"string"==typeof e&&(e=utils.parseDate(issue)),e instanceof Date?e:new Date(Math.round(86400*(e-25569)*1e3))},t.isNumber=function(e){return!(!/^\d+(\.\d+)?$/.test(e)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e))},t.parseDateArray=function(e){for(var t,r=e.length;r--;){if((t=this.parseDate(e[r]))===i.value)return t;e[r]=t}return e},t.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){for(var t,r=e.length;r--;)if("number"!=typeof(t=e[r]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=this.parseNumber(t);n instanceof Error?e[r]=0:e[r]=n}}else e[r]=0;else e[r]=1;return e},t.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},t.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(10),a=r(2);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e,r,i,o,s){var c,f,h=s.type,d=s.change,p=s.arrowChange,v=s.historyBorder;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=l(this,u(t).call(this,"div","".concat(a.cssPrefix,"-dropdown ").concat(o)))).title=e,f.change=function(){},"string"==typeof e?f.title=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-title")).child(e):i&&f.title.addClass("arrow-left");for(var g=arguments.length,m=new Array(g>5?g-5:0),y=5;y<g;y++)m[y-5]=arguments[y];return f.contentEl=(c=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-content"))).children.apply(c,m).css("width",r).hide(),h?(f.headerEl=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-header")).on("click",d),f.headerEl.children(f.title,i?(0,n.h)("div","".concat(a.cssPrefix,"-icon arrow-right_d")).child((0,n.h)("div","".concat(a.cssPrefix,"-icon-img arrow-down")).on("click.stop",(function(e){p(v),"block"!==f.contentEl.css("display")?f.show():f.hide()}))):""),f.children(f.headerEl,f.contentEl)):(f.headerEl=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-header")),f.headerEl.on("click",(function(){"block"!==f.contentEl.css("display")?f.show():f.hide()})).children(f.title,i?(0,n.h)("div","".concat(a.cssPrefix,"-icon arrow-right")).child((0,n.h)("div","".concat(a.cssPrefix,"-icon-img arrow-down"))):""),f.children(f.headerEl,f.contentEl)),f}var r,o,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),r=t,(o=[{key:"setTitle",value:function(e){this.title.html(e),this.hide()}},{key:"show",value:function(){var e=this;this.contentEl.show(),this.parent().active(),(0,i.bindClickoutside)(this.parent(),(function(){e.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),(0,i.unbindClickoutside)(this.parent())}}])&&s(r.prototype,o),f&&s(r,f),t}(n.Element);t.default=f},,,,,function(e,t,r){"use strict";e.exports=function(e){this.setValue=function(t){e=t},this.calc=function(){return e}}},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulaCalc=t.baseFormulas=t.formulas=t.formulam=void 0;var n,i=r(11),a=(n=r(224))&&n.__esModule?n:{default:n};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=r(56),l=[{key:"MD.WLAND",title:(0,i.tf)("formula.wland"),render:function(e){return e.join("")}},{key:"MD.WFR",title:(0,i.tf)("formula.wfr"),render:function(e){return e.join("")}},{key:"MD.RTD",title:(0,i.tf)("formula.rtd"),render:function(e){return e.join("")}}];t.baseFormulas=l;var u=c(l);t.formulas=u;function c(e){var t=Array.isArray(e)?[]:{};for(var r in e)e.hasOwnProperty(r)&&("object"===o(e[r])&&null!==e[r]?t[r]=c(e[r]):t[r]=e[r]);return t}t.formulaCalc=function(){a.default.import_functions(s);var e=a.default.xlsx_Fx;return t.formulas=u=c(l),Object.keys(e).forEach((function(t){var r={key:t,title:t,render:e[t]};u.push(r)})),a.default};var f={};t.formulam=f,l.forEach((function(e){f[e.key]=e}))},,function(module,exports,__webpack_require__){"use strict";var numeric=__webpack_require__(232),utils=__webpack_require__(15),error=__webpack_require__(9),statistical=__webpack_require__(28),information=__webpack_require__(40);exports.ABS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(utils.parseNumber(e))},exports.ACOS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.acos(e)},exports.ACOSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},exports.ACOT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},exports.ACOTH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},exports.AGGREGATE=function(e,t,r,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),"string"==typeof r)return error.value;if(utils.anyIsError(e,t))return error.value;switch(e){case 1:return statistical.AVERAGE(r);case 2:return statistical.COUNT(r);case 3:return statistical.COUNTA(r);case 4:return statistical.MAX(r);case 5:return statistical.MIN(r);case 6:return exports.PRODUCT(r);case 7:return statistical.STDEV.S(r);case 8:return statistical.STDEV.P(r);case 9:return exports.SUM(r);case 10:return statistical.VAR.S(r);case 11:return statistical.VAR.P(r);case 12:return statistical.MEDIAN(r,n);case 13:return statistical.MODE.SNGL(r);case 14:return statistical.LARGE(r,n);case 15:return null==n?error.value:statistical.SMALL(r,n);case 16:return statistical.PERCENTILE.INC(r,n);case 17:return statistical.QUARTILE.INC(r,n);case 18:return statistical.PERCENTILE.EXC(r,n);case 19:return statistical.QUARTILE.EXC(r,n)}},exports.ARABIC=function(e){if(e=e.toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},exports.ASIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.asin(e)},exports.ASINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},exports.ATANH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.BASE=function(e,t,r){if(r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(e,t,r))return error.value;r=void 0===r?0:r;var n=e.toString(t);return new Array(Math.max(r+1-n.length,0)).join("0")+n},exports.CEILING=function(e,t,r){if(t=void 0===t?1:Math.abs(t),r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(e,t,r))return error.value;if(0===t)return 0;var n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,n):0===r?-exports.ROUND(Math.floor(Math.abs(e)/t)*t,n):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,n)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return(e=utils.parseNumber(e))instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){if((e=utils.parseNumber(e))<0)return error.num;if(e instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:(MEMOIZED_FACT[t]=exports.FACT(t-1)*t,MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR={};var ROUND=function(e,t){var r=e,n=t;return Math.round(r*Math.pow(10,n))/Math.pow(10,n)};exports.FLOORMATH=function(e,t,r){if("number"!=typeof e)return error.value;if(e>0&&t<0)return error.num;if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,n):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,n):-ROUND(Math.floor(Math.abs(e)/t)*t,n)},exports.FLOORPRACE=function(e,t,r){if("number"!=typeof e)return error.value;if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,n):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,n):-ROUND(Math.floor(Math.abs(e)/t)*t,n)},exports.FLOOR.MATH=exports.FLOORMATH,exports.FLOOR.PRECISE=exports.FLOORPRACE,exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=e[0],n=r<0?-r:r,i=1;i<t;i++){for(var a=e[i],o=a<0?-a:a;n&&o;)n>o?n%=o:o%=n;n+=o}return n},exports.INT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,r,n,i,a=1;void 0!==(n=e.pop());)for(;n>1;){if(n%2){for(t=3,r=Math.floor(Math.sqrt(n));t<=r&&n%t;t+=2);i=t<=r?t:n}else i=2;for(n/=i,a*=i,t=e.length;t;e[--t]%i==0&&1==(e[t]/=i)&&e.splice(t,1));}return a},exports.LN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(t)&&(t=10),t=void 0===t?10:t,Math.log(e)/Math.log(t)},exports.LOG10=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=function(e){"string"==typeof e&&(e=utils.strToMatrix(e));try{return numeric.det(e)}catch(e){return error.value}},exports.MINVERSE=function(e){return(e=utils.parseMatrix(e))instanceof Error?e:numeric.inv(e)},exports.MMULT=function(e,t){return e=utils.parseMatrix(e),t=utils.parseMatrix(t),utils.anyIsError(e,t)?error.value:(console.log(numeric.dot(e,t)),numeric.dot(e,t))},exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var r=Math.abs(e%t);return t>0?r:-r},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,r=1,n=0;n<e.length;n++)t+=e[n],r*=exports.FACT(e[n]);return exports.FACT(t)/r},exports.MUNIT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:numeric.identity(e)},exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var r=Math.pow(e,t);return isNaN(r)?error.num:r},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,r=0;r<e.length;r++)t*=e[r];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return arguments.length>0&&void 0!==arguments[0]?error.value:Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;for(var t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",i=3;i--;)n=(r[+t.pop()+10*i]||"")+n;return new Array(+t.join("")+1).join("M")+n},exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0?(e=0-e,0-Math.round(e*Math.pow(10,t))/Math.pow(10,t)):Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,r,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),n=utils.parseNumberArray(n),utils.anyIsError(e,t,r,n))return error.value;for(var i=n[0]*Math.pow(e,t),a=1;a<n.length;a++)i+=n[a]*Math.pow(e,t+a*r);return i},exports.SIGN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}},exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.name:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),r=0;r<t.length;++r){var n=arguments[t[r]];if("number"==typeof n)e+=n;else if("string"==typeof n){var i=parseFloat(n);!isNaN(i)&&(e+=i)}else Array.isArray(n)&&(e+=exports.SUM.apply(null,n))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var e=utils.argsToArray(arguments),t=utils.flatten(e.shift());if(t instanceof Error)return t;if(e.length%2!=0)return error.value;for(var r=0;r<e.length;r+=2)if(e[r].length!==t.length||!e[r+1])return error.value;for(var n=[],i=0,a=0;a<e.length;a+=2){for(var o=[],s=0;s<e[a].length;s++){var l=e[a+1]+"";if(0==l.lastIndexOf(">=")?(l=l.replace(/>=/,""),isNaN(l)&&(str=!0),1*l<=e[a][s][0]&&o.push(s)):0==l.lastIndexOf("<=")&&(l=l.replace(/<=/,""),isNaN(l)&&(str=!0),1*l>=e[a][s][0]&&o.push(s)),0==(l=l.replace("=","")).lastIndexOf("<>"))(l=l.replace(/<>/,""))!==e[a][s][0]&&o.push(s);else{var u=!1;if(0==l.lastIndexOf("<"))l=l.replace(/</,""),isNaN(l)&&(u=!0),1*l>e[a][s][0]&&o.push(s);else if(0==l.lastIndexOf(">"))l=l.replace(/>/,""),isNaN(l)&&(u=!0),1*l<e[a][s][0]&&o.push(s);else{if(l.indexOf("*")>0){var c=l;c=c.replace("*",""),"string"==typeof e[a][s][0]&&e[a][s][0].indexOf(c)>=0&&o.push(s)}isNaN(l)?l===e[a][s][0]&&o.push(s):1*l===e[a][s][0]&&o.push(s)}if(u)return error.value}}n.push(o)}for(var f=[],h=0;h<n.length;h++)for(var d=0;d<n[h].length;d++){for(var p=n[h][d],v=1,g=0;3!==v&&g<n.length;g++)g!==h&&-1!=n[g].indexOf(p)?v=2:g!==h&&(v=3);1==v&&n.length>1?v=3:1==v&&1===n.length&&(v=2),2==v&&-1==f.indexOf(p)&&f.push(p)}if(n.length<=0)return error.value;for(var m=0;m<f.length;m++){var y=t[f[m]];if(!y||isNaN(y))return 0;i+=y}return i},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var e,t,r,n,i=arguments.length+1,a=0,o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var s=0;s<arguments[0][o].length;s++){for(e=1,t=1;t<i;t++){if((n=utils.parseNumber(arguments[t-1][o][s]))instanceof Error)return n;e*=n}a+=e}else{for(e=1,t=1;t<i;t++){if((r=utils.parseNumber(arguments[t-1][o]))instanceof Error)return r;e*=r}a+=e}return a},exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,r=e.length,n=0;n<r;n++)t+=information.ISNUMBER(e[n])?e[n]*e[n]:0;return t},exports.SUMX2MY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]-t[n]*t[n];return r},exports.SUMX2PY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]+t[n]*t[n];return r},exports.SUMXMY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.flatten(e),t=utils.flatten(t);for(var n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},exports.TAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(e,t,r){"use strict";var n=r(27),i=r(39),a=r(59).jStat,o=r(15),s=r(9),l=r(60),u=r(233);t.AVEDEV=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:a.sum(a(e).subtract(a.mean(e)).abs()[0])/e.length},t.AVERAGE=function(){var e=o.flattenNum(arguments);if(e instanceof Error)return e;if(0===e.length)return s.div0;for(var t=e.length,r=0,n=0,i=0;i<t;i++)r+=e[i],n+=1;return r/n},t.AVERAGEA=function(){var e=o.flattenNum(arguments);if(1==e.length&&isNaN(e[0]))return s.value;for(var t=e.length,r=0,n=0,i=0;i<t;i++){var a=e[i];"number"==typeof a&&(r+=a),!0===a&&r++,null!==a&&n++}return r/n},t.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return s.na;if(r=r||e,e=o.flatten(e),(r=o.parseNumberArray(o.flatten(r)))instanceof Error)return r;for(var n=0,i=0,a=void 0===t||"*"===t,l=a?null:u.parse(t+""),c=t.replace("=","").replace("*","").replace("<>",""),f=0;f<e.length;f++){var h=e[f];if(a)i+=r[f],n++;else{var d=[u.createToken(h,u.TOKEN_TYPE_LITERAL)].concat(l);t.indexOf("<>")>=0?h.indexOf(c)<0&&(i+=r[f],n++):(u.compute(d)||h.toString().indexOf(c)>=0)&&(i+=r[f],n++)}}return 0==n?s.div0:i/n},t.AVERAGEIFS=function(){for(var e=o.argsToArray(arguments),t=(e.length-1)/2,r=o.flatten(e[0]),n=0,i=0,a=0;a<r.length;a++){for(var l=!1,c=0;c<t;c++){var f=e[2*c+1][a],h=e[2*c+2],d=void 0===h||"*"===h,p=!1;if(d)p=!0;else{var v=u.parse(h+""),g=[u.createToken(f,u.TOKEN_TYPE_LITERAL)].concat(v);p=u.compute(g)}if(!p){l=!1;break}l=!0}l&&(i+=r[a],n++)}var m=i/n;return isNaN(m)?s.div0:m},t.BETA={},t.BETA.DIST=function(e,t,r,n,i,l){return arguments.length<4?s.value:(i=void 0===i?0:i,l=void 0===l?1:l,e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),i=o.parseNumber(i),l=o.parseNumber(l),o.anyIsError(e,t,r,i,l)?s.value:(e=(e-i)/(l-i),(n=o.parseBool(n))?a.beta.cdf(e,t,r):a.beta.pdf(e,t,r)/2))},t.BETA.INV=function(e,t,r,n,i){return n=void 0===n?0:n,i=void 0===i?1:i,e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),n=o.parseNumber(n),i=o.parseNumber(i),o.anyIsError(e,t,r,n,i)?s.value:a.beta.inv(e,t,r)*(i-n)+n},t.BINOM={},t.BINOM.DIST=function(e,t,r,n){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),n=o.parseBool(n),n=o.parseNumber(n),o.anyIsError(e,t,r,n)?s.value:n?a.binomial.cdf(e,t,r):a.binomial.pdf(e,t,r)},t.BINOM.INV=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return s.value;for(var n=0;n<=e;){if(a.binomial.cdf(n,e,t)>=r)return n;n++}},t.CHISQ={},t.CHISQ.DIST=function(e,t,r){return r=o.parseBool(r),e<0?s.num:(e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:r?a.chisquare.cdf(e,t):a.chisquare.pdf(e,t))},t.CHISQ.DIST.RT=function(e,t){return!e|!t?s.na:e<1||t>Math.pow(10,10)?s.num:"number"!=typeof e||"number"!=typeof t?s.value:1-a.chisquare.cdf(e,t)},t.CHISQ.INV=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:a.chisquare.inv(e,t)},t.CHISQ.INV.RT=function(e,t){return!e|!t?s.na:e<0||e>1||t<1||t>Math.pow(10,10)?s.num:"number"!=typeof e||"number"!=typeof t?s.value:a.chisquare.inv(1-e,t)},t.CHISQ.TEST=function(e,t){if(2!==arguments.length)return s.na;if(!(e instanceof Array&&t instanceof Array))return s.value;if(e.length!==t.length)return s.value;if(e[0]&&t[0]&&e[0].length!==t[0].length)return s.value;var r,n,i,a=e.length;for(n=0;n<a;n++)e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r)),t[n]instanceof Array||(r=t[n],t[n]=[],t[n].push(r));var o=e[0].length,l=1===o?a-1:(a-1)*(o-1),u=0,c=Math.PI;for(n=0;n<a;n++)for(i=0;i<o;i++)u+=Math.pow(e[n][i]-t[n][i],2)/t[n][i];function f(e,t){var r=Math.exp(-.5*e);t%2==1&&(r*=Math.sqrt(2*e/c));for(var n=t;n>=2;)r=r*e/n,n-=2;for(var i=r,a=t;i>1e-10*r;)r+=i=i*e/(a+=2);return 1-r}return Math.round(1e6*f(u,l))/1e6},t.COLUMN=function(){return col_list=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],cell_name=this.args[0].formula.name,cell_name=cell_name.replace(/\d+/g,""),col_list.indexOf(cell_name)+1},t.COLUMNS=function(e){return"string"==typeof e&&(e=o.strToMatrix(e)),e instanceof Array?0===e.length?0:a.cols(e):s.value},t.CONFIDENCE={},t.CONFIDENCE.NORM=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:a.normalci(1,e,t,r)[1]-1},t.CONFIDENCE.T=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:a.tci(1,e,t,r)[1]-1},t.IFS=function(){for(var e=0;e+1<arguments.length;e+=2){var t=arguments[e],r=arguments[e+1];if(t)return r}return s.na},t.CORREL=function(e,t){return e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t)?s.value:a.corrcoeff(e,t)},t.COUNT=function(){return o.numbers(o.flatten(arguments)).length},t.COUNTA=function(){var e=o.flatten(arguments);return e.length-t.COUNTBLANK(e)},t.COUNTIN=function(e,t){for(var r=0,n=0;n<e.length;n++)e[n]===t&&r++;return r},t.COUNTBLANK=function(){for(var e,t=o.flatten(arguments),r=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||r++;return r},t.COUNTIF=function(e,t){if(e=o.flatten(e),void 0===t)return s.value;if(void 0===t||"*"===t)return e.length;for(var r=0,n=u.parse(t+""),i=0;i<e.length;i++){var a=e[i],l=[u.createToken(a,u.TOKEN_TYPE_LITERAL)].concat(n);u.compute(l)&&r++}return r},t.COUNTIFS=function(){for(var e=o.argsToArray(arguments),t=new Array(o.flatten(e[0]).length),r=0;r<t.length;r++)t[r]=!0;for(r=0;r<e.length;r+=2){var n=o.flatten(e[r]),i=e[r+1],a=void 0===i||"*"===i;if(!a)for(var s=u.parse(i+""),l=0;l<n.length;l++){var c=n[l],f=[u.createToken(c,u.TOKEN_TYPE_LITERAL)].concat(s);t[l]=t[l]&&u.compute(f)}}var h=0;for(r=0;r<t.length;r++)t[r]&&h++;return h},t.COUNTUNIQUE=function(){return l.UNIQUE.apply(null,o.flatten(arguments)).length},t.COVARIANCE={},t.COVARIANCE.P=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var r=a.mean(e),n=a.mean(t),i=0,l=e.length,u=0;u<l;u++)i+=(e[u]-r)*(t[u]-n);return i/l},t.COVARIANCE.S=function(e,t){return"string"==typeof e&&(e=o.strToMatrix(e)),"string"==typeof t&&(t=o.strToMatrix(t)),e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t)?s.value:a.covariance(e,t)},t.DEVSQ=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},t.EXPON={},t.EXPON.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:r?a.exponential.cdf(e,t):a.exponential.pdf(e,t)},t.F={},t.F.DIST=function(e,t,r,n){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:(null==n&&(n=!0),"string"==typeof n&&"FALSE"!=n&&"TRUE"!=n?s.value:("FALSE"==n&&(n=!1),n?a.centralF.cdf(e,t,r):a.centralF.pdf(e,t,r)))},t.F.DIST.RT=function(e,t,r){return 3!==arguments.length?s.na:e<0||t<1||r<1?s.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?s.value:1-a.centralF.cdf(e,t,r)},t.F.INV=function(e,t,r){return 3!==arguments.length?s.na:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?s.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?s.value:a.centralF.inv(1-e,t,r)},t.F.INV.RT=function(e,t,r){return 3!==arguments.length?s.na:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?s.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?s.value:a.centralF.inv(1-e,t,r)},t.F.TEST=function(e,t){if(!e||!t)return s.na;if(!(e instanceof Array&&t instanceof Array))return s.na;if(e.length<2||t.length<2)return s.div0;var r=function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},i=n.SUM(e)/e.length,a=n.SUM(t)/t.length;return r(e,i)/(e.length-1)/(r(t,a)/(t.length-1))},t.FISHER=function(e){return(e=o.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=o.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},t.FORECAST=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,t,r))return s.value;for(var n=a.mean(r),i=a.mean(t),l=r.length,u=0,c=0,f=0;f<l;f++)u+=(r[f]-n)*(t[f]-i),c+=Math.pow(r[f]-n,2);var h=u/c;return i-h*n+h*e},t.FREQUENCY=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var r=e.length,n=t.length,i=[],a=0;a<=n;a++){i[a]=0;for(var l=0;l<r;l++)0===a?e[l]<=t[0]&&(i[0]+=1):a<n?e[l]>t[a-1]&&e[l]<=t[a]&&(i[a]+=1):a===n&&e[l]>t[n-1]&&(i[n]+=1)}return i},t.GAMMA=function(e){return(e=o.parseNumber(e))instanceof Error?e:0===e?s.num:parseInt(e,10)===e&&e<0?s.num:a.gammafn(e)},t.GAMMA.DIST=function(e,t,r,n){return n=o.parseBool(n),4!==arguments.length?s.na:e<0||t<=0||r<=0?s.value:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?s.value:n?a.gamma.cdf(e,t,r,!0):a.gamma.pdf(e,t,r,!1)},t.GAMMA.INV=function(e,t,r){return 3!==arguments.length?s.na:e<0||e>1||t<=0||r<=0?s.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?s.value:a.gamma.inv(e,t,r)},t.GAMMALN=function(e){return(e=o.parseNumber(e))instanceof Error?e:a.gammaln(e)},t.GAMMALN.PRECISE=function(e){return 1!==arguments.length?s.na:e<=0?s.num:"number"!=typeof e?s.value:a.gammaln(e)},t.GAUSS=function(e){return(e=o.parseNumber(e))instanceof Error?e:a.normal.cdf(e,0,1)-.5},t.GEOMEAN=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:a.geomean(e)},t.GROWTH=function(e,t,r,n){if((e=o.parseNumberArray(e))instanceof Error)return e;var i;if(void 0===t)for(t=[],i=1;i<=e.length;i++)t.push(i);if(void 0===r)for(r=[],i=1;i<=e.length;i++)r.push(i);if(t=o.parseNumberArray(t),r=o.parseNumberArray(r),o.anyIsError(t,r))return s.value;void 0===n&&(n=!0);var a,l,u=e.length,c=0,f=0,h=0,d=0;for(i=0;i<u;i++){var p=t[i],v=Math.log(e[i]);c+=p,f+=v,h+=p*v,d+=p*p}c/=u,f/=u,h/=u,d/=u,n?l=f-(a=(h-c*f)/(d-c*c))*c:(a=h/d,l=0);var g=[];for(i=0;i<r.length;i++)g.push(Math.exp(l+a*r[i]));return g},t.HARMEAN=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=0,n=0;n<t;n++)r+=1/e[n];return t/r},t.HYPGEOM={},t.HYPGEOM.DIST=function(e,t,r,i,a){if(a=o.parseBool(a),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),i=o.parseNumber(i),o.anyIsError(e,t,r,i))return s.value;function l(e,t,r,i){return n.COMBIN(r,e)*n.COMBIN(i-r,t-e)/n.COMBIN(i,t)}return a?function(e,t,r,n){for(var i=0,a=0;a<=e;a++)i+=l(a,t,r,n);return i}(e,t,r,i):l(e,t,r,i)},t.INTERCEPT=function(e,r){return e=o.parseNumberArray(e),r=o.parseNumberArray(r),o.anyIsError(e,r)?s.value:e.length!==r.length?s.na:t.FORECAST(0,e,r)},t.KURT=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,4);return r*(r+1)/((r-1)*(r-2)*(r-3))*(n/=Math.pow(a.stdev(e,!0),4))-3*(r-1)*(r-1)/((r-2)*(r-3))},t.LARGE=function(e,t){e=o.flatten(e);for(var r=[],n=0;n<e.length;n++)parseFloat(e[n])&&r.push(parseFloat(e[n]));return e=r,t=o.parseNumber(t),o.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},t.LINEST=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var r=a.mean(e),n=a.mean(t),i=t.length,l=0,u=0,c=0;c<i;c++)l+=(t[c]-n)*(e[c]-r),u+=Math.pow(t[c]-n,2);var f=l/u;return[f,r-f*n]},t.LOGEST=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r))return s.value;for(var n=0;n<e.length;n++)e[n]=Math.log(e[n]);var i=t.LINEST(e,r);return i[0]=Math.round(1e6*Math.exp(i[0]))/1e6,i[1]=Math.round(1e6*Math.exp(i[1]))/1e6,i},t.LOGNORM={},t.LOGNORM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:n?a.lognormal.cdf(e,t,r):a.lognormal.pdf(e,t,r)},t.LOGNORM.INV=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:a.lognormal.inv(e,t,r)},t.MAX=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MAXA=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MEDIAN=function(){for(var e=o.arrayValuesToNumbers(o.flatten(arguments)),t=[],r=0;r<e.length;r++)"number"==typeof e[r]&&t.push(e[r]);var n=o.arrayValuesToNumbers(o.flatten(t));return a.median(n)},t.MIN=function(){var e=o.flatten(arguments);return 0===e.length?0:Math.min.apply(Math,e)},t.MINA=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.MODE={},t.MODE.MULT=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t,r=e.length,n={},i=[],a=0,s=0;s<r;s++)n[t=e[s]]=n[t]?n[t]+1:1,n[t]>a&&(a=n[t],i=[]),n[t]===a&&(i[i.length]=t);return i},t.MODE.SNGL=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.NEGBINOM={},t.NEGBINOM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:n?a.negbin.cdf(e,t,r):a.negbin.pdf(e,t,r)},t.NORM={},t.NORM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:r<=0?s.num:n?a.normal.cdf(e,t,r):a.normal.pdf(e,t,r)},t.NORM.INV=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:a.normal.inv(e,t,r)},t.NORM.S={},t.NORM.S.DIST=function(e,t){return t=o.parseBool(t),(e=o.parseNumber(e))instanceof Error?s.value:t?a.normal.cdf(e,0,1):a.normal.pdf(e,0,1)},t.NORM.S.INV=function(e){return(e=o.parseNumber(e))instanceof Error?s.value:a.normal.inv(e,0,1)},t.PEARSON=function(e,t){if(t=o.parseNumberArray(o.flatten(t)),e=o.parseNumberArray(o.flatten(e)),o.anyIsError(t,e))return s.value;for(var r=a.mean(e),n=a.mean(t),i=e.length,l=0,u=0,c=0,f=0;f<i;f++)l+=(e[f]-r)*(t[f]-n),u+=Math.pow(e[f]-r,2),c+=Math.pow(t[f]-n,2);return l/Math.sqrt(u*c)},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return s.value;var r=(e=e.sort((function(e,t){return e-t}))).length;if(t<1/(r+1)||t>1-1/(r+1))return s.num;var n=t*(r+1)-1,i=Math.floor(n);return o.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},t.PERCENTILE.INC=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return s.value;var r=t*((e=e.sort((function(e,t){return e-t}))).length-1),n=Math.floor(r);return o.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,r){if(r=void 0===r?3:r,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return s.value;e=e.sort((function(e,t){return e-t}));for(var n=l.UNIQUE.apply(null,e),i=e.length,a=n.length,u=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<a;)t===n[h]?(c=(e.indexOf(n[h])+1)/(i+1),f=!0):t>=n[h]&&(t<n[h+1]||h===a-1)&&(c=(e.indexOf(n[h])+1+(t-n[h])/(n[h+1]-n[h]))/(i+1),f=!0),h++;return Math.floor(c*u)/u},t.PERCENTRANK.INC=function(e,t,r){if(r=void 0===r?3:r,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return s.value;e=e.sort((function(e,t){return e-t}));for(var n=l.UNIQUE.apply(null,e),i=e.length,a=n.length,u=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<a;)t===n[h]?(c=e.indexOf(n[h])/(i-1),f=!0):t>=n[h]&&(t<n[h+1]||h===a-1)&&(c=(e.indexOf(n[h])+(t-n[h])/(n[h+1]-n[h]))/(i-1),f=!0),h++;return Math.floor(c*u)/u},t.PERMUT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:n.FACT(e)/n.FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:Math.pow(e,t)},t.PHI=function(e){return(e=o.parseNumber(e))instanceof Error?s.value:Math.exp(-.5*e*e)/2.5066282746310002},t.POISSON={},t.POISSON.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:r?a.poisson.cdf(e,t):a.poisson.pdf(e,t)},t.PROB=function(e,t,r,n){if(void 0===r)return 0;if(n=void 0===n?r:n,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),r=o.parseNumber(r),n=o.parseNumber(n),o.anyIsError(e,t,r,n))return s.value;if(r===n)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;for(var i=e.sort((function(e,t){return e-t})),a=i.length,l=0,u=0;u<a;u++)i[u]>=r&&i[u]<=n&&(l+=t[e.indexOf(i[u])]);return l},t.QUARTILE={},t.QUARTILE.EXC=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return s.value;switch(r){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return s.num}},t.QUARTILE.INC=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return s.value;switch(r){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return s.num}},t.RANK={},t.RANK.AVG=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e},i=(t=(t=o.flatten(t)).sort(n)).length,a=0,l=0;l<i;l++)t[l]===e&&a++;return a>1?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e};return(t=t.sort(n)).indexOf(e)+1},t.ROW=function(e,t){return 2!==arguments.length?s.na:t<0?s.num:e instanceof Array&&"number"==typeof t?0!==e.length?a.row(e,t):void 0:s.value},t.ROWS=function(e){return 1!==arguments.length?s.na:e instanceof Array?0===e.length?0:a.rows(e):s.value},t.RSQ=function(e,r){return e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r)?s.value:Math.pow(t.PEARSON(e,r),2)},t.SKEW=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,3);return r*n/((r-1)*(r-2)*Math.pow(a.stdev(e,!0),3))},t.SKEW.P=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0,s=0;s<r;s++)i+=Math.pow(e[s]-t,3),n+=Math.pow(e[s]-t,2);return n/=r,(i/=r)/Math.pow(n,1.5)},t.SLOPE=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var r=a.mean(t),n=a.mean(e),i=t.length,l=0,u=0,c=0;c<i;c++)l+=(t[c]-r)*(e[c]-n),u+=Math.pow(t[c]-r,2);return l/u},t.SMALL=function(e,t){return e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:(e-t)/r},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments);return Math.sqrt(e)},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments);return Math.sqrt(e)},t.STDEVA=function(){var e=t.VARA.apply(this,arguments);return Math.sqrt(e)},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments);return Math.sqrt(e)},t.STEYX=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return s.value;for(var r=a.mean(t),n=a.mean(e),i=t.length,l=0,u=0,c=0,f=0;f<i;f++)l+=Math.pow(e[f]-n,2),u+=(t[f]-r)*(e[f]-n),c+=Math.pow(t[f]-r,2);return Math.sqrt((l-u*u/c)/(i-2))},t.TRANSPOSE=function(e){return e?a.transpose(e):s.na},t.T=i.T,t.T.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?s.value:r?a.studentt.cdf(e,t):a.studentt.pdf(e,t)},t.T.DIST["2T"]=function(e,t){return 2!==arguments.length?s.na:e<0||t<1?s.num:"number"!=typeof e||"number"!=typeof t?s.value:2*(1-a.studentt.cdf(e,t))},t.T.DIST.RT=function(e,t){return 2!==arguments.length?s.na:e<0||t<1?s.num:"number"!=typeof e||"number"!=typeof t?s.value:1-a.studentt.cdf(e,t)},t.T.INV=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),e<=0||e>1||t<1?s.num:o.anyIsError(e,t)?s.value:Math.abs(a.studentt.inv(e/2,t))},t.T.INV["2T"]=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),e<=0||e>1||t<1?s.num:o.anyIsError(e,t)?s.value:Math.abs(a.studentt.inv(e/2,t))},t.T.TEST=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r))return s.value;var n,i=a.mean(e),l=a.mean(r),u=0,c=0;for(n=0;n<e.length;n++)u+=Math.pow(e[n]-i,2);for(n=0;n<r.length;n++)c+=Math.pow(r[n]-l,2);u/=e.length-1,c/=r.length-1;var f=Math.abs(i-l)/Math.sqrt(u/e.length+c/r.length);return t.T.DIST["2T"](f,e.length+r.length-2)},t.TREND=function(e,r,n){e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r));var i=t.LINEST(e,r);return i[0]*n+i[1]},t.TRIMMEAN=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return s.value;var r=n.FLOORMATH(e.length*t,2)/2;return a.mean(o.initial(o.rest(e.sort((function(e,t){return e-t})),r),r))},t.VAR={},t.VAR.P=function(){var e=o.numbers(o.flatten(arguments));if(0==e.length)return s.value;for(var r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return isNaN(n/r)?s.value:n/r},t.VAR.S=function(){for(var e=o.numbers(o.flatten(arguments)),r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return n/(r-1)},t.VARA=function(){for(var e=o.flatten(arguments),r=e.length,n=0,i=0,a=t.AVERAGEA(e),s=0;s<r;s++){var l=e[s];n+="number"==typeof l?Math.pow(l-a,2):!0===l?Math.pow(1-a,2):Math.pow(0-a,2),null!==l&&i++}return n/(i-1)},t.VARPA=function(){for(var e=o.flatten(arguments),r=e.length,n=0,i=0,a=t.AVERAGEA(e),s=0;s<r;s++){var l=e[s];n+="number"==typeof l?Math.pow(l-a,2):!0===l?Math.pow(1-a,2):Math.pow(0-a,2),null!==l&&i++}return n/i},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?s.value:n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},t.Z={},t.Z.TEST=function(e,r,n){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return s.value;n=n||t.STDEV.S(e);var i=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-r)/(n/Math.sqrt(i)),!0)}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(3),i=r(4);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ri=t,this.ci=r,this.cell=n,this.expr=i,this.empty=a}var t,r,s;return t=e,(r=[{key:"isInclude",value:function(){}},{key:"each",value:function(e){var t=this.cell;if(!1!==(0,n.isHave)(t.depend))for(var r=0;r<t.depend.length;r++){var o=t.depend[r],s=a((0,i.expr2xy)(o),2),l=s[0];e(s[1],l)}}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lockCells=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=this.data,s=this.editor,l=e.offsetX,f=e.offsetY,h=i.getCellRectByXY(l,f),d=h.ri,v=h.ci,g=s.pos,m=s.editorText.getText(),y="";s.handler(m);var b=s.mousedownIndex;if((0,a.isAbsoluteValue)((0,a.cuttingByPos)(m,g),2)||t)if(t){var w=t.selector.range,x=w.sri,E=w.sci,C=w.eri,k=w.eci,N=(0,o.xy2expr)(E,x),T=(0,o.xy2expr)(k,C),O=N===T?N:"".concat(N,":").concat(T);if(2===r){var M=(0,a.value2absolute)(N),A=(0,a.value2absolute)(T);O=M.s1===A.s1?M.s1:"".concat(M.s1,":").concat(A.s1)}else if(1===r){var S=(0,a.value2absolute)(N),I=(0,a.value2absolute)(T);O=S.s2===I.s2?S.s2:"".concat(S.s2,":").concat(I.s2)}else if(3===r){var R=(0,a.value2absolute)(N),_=(0,a.value2absolute)(T);O=R.s3===_.s3?R.s3:"".concat(R.s3,":").concat(_.s3)}t.erpx=O,s.isCors&&(g=1);var j=-1!==n?n:g-(0,a.cuttingByPos)(m,g).length;y=m.substring(0,j)+O+m.substring(g,m.length),s.setText(y),s.setCursorPos(m.substring(0,j).length+O.length)}else for(var D=0,P=0;P<this.selectors.length&&0===D;P++){var L=this.selectors[P].erpx;if(L===(0,a.cuttingByPos)(m,g)){var F=h.ri,B=h.ci;this.selectors[P].ri=F,this.selectors[P].ci=B,this.selectors[P].erpx=(0,o.xy2expr)(B,F),this.selectors[P].selector.set(F,B),y="".concat(m.substring(0,g-L.length)).concat((0,o.xy2expr)(B,F)).concat(m.substring(g,m.length)),s.setText(y),s.setCursorPos(m.substring(0,g-L.length).length+(0,o.xy2expr)(B,F).length),D=1}}else if(b.length>0){if((0,a.operation)(b[1][0])&&(0,a.isAbsoluteValue)((0,a.cuttingByPos)(b[1],b[1].length),2))return void s.setLock(!1);var H=c.call(this,d,v);this.selectors.push(H);var V=(y="".concat(b[0]).concat((0,o.xy2expr)(v,d)).concat(b[1])).substring(b[0].length+(0,o.xy2expr)(v,d).length,y.length),z=(0,a.cutFirst)(V.substring(1));if((0,a.operation)(V[0])&&!(0,a.isAbsoluteValue)(z,2))return s.setText(y),void s.setMouseDownIndex([]);z=(0,a.cutFirst)(b[1]),console.log((0,o.xy2expr)(v,d));var U=(0,a.cutStr)("".concat(b[0]).concat((0,o.xy2expr)(v,d),"+4").concat(b[1])),Y=u.call(this,U),W=Y.selectors_delete,X=Y.selectors_new;Object.keys(W).forEach((function(e){W[e].removeEl()})),this.selectors=X,y=y.replace(z,""),s.setText(y),s.setCursorPos(b[0].length+(0,o.xy2expr)(v,d).length)}else{var G=s.pos,q=t||c.call(this,d,v);if(-1!==G){for(var $="",K=!1,Z=G,Q="",J=G;J<m.length;J++)Q+=m[J];for(var ee=(0,a.cutFirst)(Q).length,te=0;te<m.length;te++)G===te&&(K=!0,$+=(0,o.xy2expr)(v,d)),Z===te&&ee>0?(Z+=1,ee-=1):$+=m[te];if(t){var re=i.selector.range,ne=re.sri,ie=re.sci,ae=re.eri,oe=re.eci,se=(0,o.xy2expr)(ie,ne),le=(0,o.xy2expr)(oe,ae);y=se===le?se:"".concat(se,":").concat(le),$=K?$:$+y}else this.selectors.push(q),$=K?$:$+(0,o.xy2expr)(v,d);s.setText($),s.setCursorPos($.length),s.parse()}else this.selectors.push(q),y="".concat(m).concat((0,o.xy2expr)(v,d)),s.setText(y)}if(s.parse(s.pos),this.selectors.length>0||t){var ue=s.editorText.getText(),ce=!1,fe=this.data.merges;Object.keys(fe._).forEach((function(e){for(var t=fe._[e],r=(0,a.cutStr)(ue,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],l=(0,o.expr2xy)(i),u=(0,o.expr2xy)(s);t.sci>=l[0]&&t.sri>=l[1]&&t.eci<=u[0]&&t.eri<=u[1]&&(ue=ue.replace(new RegExp(r[n],"g"),i),ce=!0)}})),p.call(this,(0,a.cutting)(ue),(0,a.cutting2)(ue)),ce&&setTimeout((function(){s.setCursorPos(ue.length)}),10)}},t.clearSelectors=function(){this.selectorsEl.html(""),this.selectors=[];var e=this.editor,t=this.selector;e.setLock(!1),e.state=1,t.el.show()},t.editingSelectors=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("number"==typeof t)return;var r=(0,a.cutStr)(t,!0),n=u.call(this,r).selectors_delete;Object.keys(n).forEach((function(e){n[e].removeEl()}));var i=[];Object.keys(r).forEach((function(t){var n=1;Object.keys(e.selectors).forEach((function(t){e.selectors[t].selector.el.removeEl()}));var s="",l=r[t].replace(/\$/g,"");if((0,a.isAbsoluteValue)(r[t])){var u=r[t].replace(/\$/g,"");s=(0,o.expr2xy)(u)}else-1!==l.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)?n=2:s=(0,o.expr2xy)(r[t]);if(1===n){var f=s[1],h=s[0],d=c.call(e,f,h,i);d.erpx=r[t],i.push(d)}else if(2===n){var p=r[t].replace(/\$/g,"").split(":")[0],v=r[t].replace(/\$/g,"").split(":")[1],g=(0,o.expr2xy)(p),m=(0,o.expr2xy)(v),y=c.call(e,g[1],g[0],i,!0,null,!1);(y=c.call(e,m[1],m[0],i,!0,y.selector,!0)).erpx=r[t],i.push(y)}})),this.selectors=i,(this.selectors.length>0||"="===t[0])&&p.call(this,(0,a.cutting)(t),(0,a.cutting2)(t))},t.findBracket=function(e,t,r){var n={left:0,right:0,exist:!1};if(")"!==r[e])return n;var i=e,a=f.call(this,t,i);-1!==a&&-1!==i&&(n={left:a,right:i,exist:!0});return n},t.suggestContent=d,t.makeSelector=c;var n,i=(n=r(291))&&n.__esModule?n:{default:n},a=r(8),o=r(4),s=r(84),l=r(1);function u(e){var t=this,r=[],n=[];return Object.keys(this.selectors).forEach((function(i){for(var a=t.selectors[i],o=a.erpx,s=0,l=0;l<e.length&&0===s;l++)e[l].replace(/\$/g,"")===o&&(s=1,r.push(a));0===s&&n.push(a.selector.el)})),{selectors_delete:n,selectors_new:r}}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=this.data,f=null,h=this.editor.editorText.getText(),d=(0,s.selectorColor)(r.length),p=d.color,v=d.index;if(l)f=l;else{var g="selector".concat(999999*Math.random());(f=new i.default(c,this,g)).el.attr("class","".concat(g," clear_selector")),f.setCss(p)}n?u?f.setEnd(e,t):f.set(e,t,!0):f.set(e,t,!1),f.el.css("z-index","100");var m=h.split((0,o.xy2expr)(t,e)).length-2,y=(0,o.xy2expr)(t,e),b=c.merges;Object.keys(b._).forEach((function(e){for(var t=b._[e],r=(0,a.cutStr)(y,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],l=(0,o.expr2xy)(i),u=(0,o.expr2xy)(s);t.sci>=l[0]&&t.sri>=l[1]&&t.eci<=u[0]&&t.eri<=u[1]&&(y=y.replace(new RegExp(r[n],"g"),i))}}));var w={ri:e,ci:t,index:m,color:p,index2:v,className:f.el.el.className,erpx:y,selector:f};return u||(f.el.show(),this.selectorsEl.child(f.el)),n?w:(this.selectorsEl.child(f.el),w)}function f(e,t){for(var r=-1,n=0,i=!1,a=t-1;a>0&&!1===i;a--)"("===e[a]&&(i=!0),")"===e[a]&&n++;for(var o=t;o>0&&-1===r;o--)"("===e[o]&&(0===n&&(r=o),n--);return r}function h(e,t){for(var r=-1,n=0,i=!1,a=t+1;a<e.length&&!1===i;a++)")"===e[a]&&(i=!0),"("===e[a]&&n++;for(var o=t;o<e.length&&-1===r;o++)")"===e[o]&&(0===n&&(r=o),n--);return r}function d(e,t,r){var n={suggestContent:!1,cut:"",pos:1},i=e-1,o=f.call(this,t,i),s=h.call(this,t,o);o<=i&&-1!==o&&(s>=i||-1===s)&&(n.suggestContent=!0,n.cut=(0,a.cuttingByPos)(r,o));for(var l=o;l<i+1;l++)","===r[l]&&(n.pos+=2);return n}function p(e,t){var r=this.editor,n=[],i=-1,a=-1;Object.keys(e).forEach((function(r){var i=(0,l.h)("span","formula_span".concat(r));Object.keys(t).forEach((function(){if(t[r]&&-1!==t[r].code&&t[r].data===e[r]){var n=(0,s.selectorColor)(t[r].code).color;i.css("color",n)}})),i.css("display","inline-block"),i.css("cursor","text")," "===e[r]?i.html("&emsp;"):i.html(e[r]),n.push(i)}));var o=r.pos,u=r.editorText.getText(),c={suggestContent:!1,cut:""};if(")"===u[o-1]?(i=o-1,a=f.call(this,e,i)):c=d.call(this,o+1,e,u),""!==u&&n.length<=0){var h=(0,l.h)("span","formula_span");n.push(h)}r.mount2span(n,i,a,c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontSizePxByPt=function(e){for(var t=0;t<n.length;t+=1){var r=n[t];if(r.pt===e)return r.px}return e},t.baseFonts=t.fontSizes=void 0;t.baseFonts=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}];var n=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];t.fontSizes=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testValid=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.valid;(0,n.isHave)(e)&&e.assert()};var n=r(3)},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(8),i=r(3),a=r(4);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e){for(var t=[],r=0;r<e.length;r++)(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].expr)&&t.push(e[r].expr),(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].cell)&&(0,i.isHave)(e[r].cell.depend)&&t.push.apply(t,s(e[r].cell.depend)),(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].cell)&&(0,i.isHave)(e[r].cell.multivalueRefsCell)&&t.push(e[r].cell.multivalueRefsCell);return t}var u=function(){function e(t,r){var n=t.type,i=void 0===n?-1:n,a=t.action,o=void 0===a?"":a,s=t.ri,l=void 0===s?-1:s,u=t.ci,c=void 0===u?-1:u,f=t.oldData,h=void 0===f?"":f,d=t.newData,p=void 0===d?"":d,v=t.expr,g=void 0===v?"":v,m=t.oldStep,y=void 0===m?"":m,b=t.cellRange,w=void 0===b?"":b,x=t.cells,E=void 0===x?{}:x,C=t.height,k=void 0===C?-1:C,N=t.width,T=void 0===N?-1:N,O=t.oldCell,M=void 0===O?{}:O,A=t.newCell,S=void 0===A?{}:A,I=t.newMergesData,R=void 0===I?"":I,_=t.oldMergesData,j=void 0===_?"":_,D=t.property,P=void 0===D?"":D,L=t.value,F=void 0===L?"":L;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=i,this.action=o,this.ri=l,this.ci=c,this.expr=g,this.cellRange=w,this.cells=E,this.height=k,this.width=T,this.oldCell=M,this.newCell=S,this.oldMergesData=j,this.newMergesData=R,this.property=P,this.value=F,this.oldStep=y,this.oldData=h,this.newData=p,this.data=r}var t,r,i;return t=e,(r=[{key:"findAllNeedCalcCell",value:function(){var e,t,r=[],i=this.oldCell,o=this.newCell,u=this.ri,c=this.ci;return(e=r).push.apply(e,s(l(i))),(t=r).push.apply(t,s(l(o))),-1!==u&&-1!==c&&r.push((0,a.xy2expr)(c,u)),r=(0,n.distinct)(r)}},{key:"restore",value:function(e,t,r){var i=this.type;if(1===i){var a=this.oldCell,o=this.newCell,s="";s=1===r?(0,n.deepCopy)(a):(0,n.deepCopy)(o);for(var l=0;l<s.length;l++){var u=s[l],c=u.cell,f=u.ri,h=u.ci;e.rows.setCellText(f,h,c,"cell")}}else if(13===i){var d=this.oldData,p=this.newData,v="";v=1===r?(0,n.deepCopy)(p):(0,n.deepCopy)(d),e.setData(v)}else if(2===i||5===i||6===i||11===i||12===i){var g=this.newCell,m=this.oldCell,y=this.oldMergesData,b=this.newMergesData,w=(this.cellRange,this.property),x=(this.value,"");x=1===r?(0,n.deepCopy)(m):(0,n.deepCopy)(g),"merge"===w&&(1===r?this.data.merges.setData(y):this.data.merges.setData(b));for(var E=0;E<x.length;E++){var C=x[E],k=C.cell,N=C.ri,T=C.ci;e.rows.setCellText(N,T,k,"cell")}}else if(3===i){var O=this.ri,M=this.height,A=this.oldStep;1===r?e.rows.setHeight(O,A.height):e.rows.setHeight(O,M)}else if(4===i){var S=this.ci,I=this.width,R=this.oldStep;1===r?e.cols.setWidth(S,R.width):e.cols.setWidth(S,I)}}}])&&o(t.prototype,r),i&&o(t,i),e}();t.default=u},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=e+1,n="",i=10;r>0&&i--;)t=(r-1)%26,n=String.fromCharCode(t+65)+n,r=(r-t-1)/26;return n}},function(e,t,r){"use strict";e.exports=function(e){for(var t=0,r=e.replace(/[0-9]+$/,""),n=r.length;n--;)t+=Math.pow(26,r.length-n-1)*(r.charCodeAt(n)-64);return t-1}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(37),a=r(36),o=r(53),s=function(){function e(t,r,n){var i,a;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start_pst=n-t.length,this.end_pst=n,-1!=t.indexOf("!")){var s=t.split("!");a=o(s[0]),i=s[1],this.range_start_pst=n-s[1].length}else a=r.sheet_name,i=t,this.range_start_pst=this.start_pst;this.sheet=r.wb.Sheets[a],this.range_expression=i,this.sheet_name=a,this.formula=r}var t,r,s;return t=e,(r=[{key:"calc",value:function(){var e,t=this.sheet_name,r=this.sheet,n=this.range_expression,o=this.formula,s=n.split(":"),l=parseInt(s[0].replace(/^[A-Z]+/,""),10)||0,u=s[1].replace(/^[A-Z]+/,"");""===u&&r["!ref"]&&(u=r["!ref"].split(":")[1].replace(/^[A-Z]+/,"")),e=parseInt(""==u?"500000":u,10);for(var c=i(s[0]),f=i(s[1]),h=[],d=l;d<=e;d++){var p=[];h.push(p);for(var v=c;v<=f;v++){var g=a(v)+d,m=t+"!"+g;if(o.formula_ref[m]){if("new"===o.formula_ref[m].status)o.exec_formula(o.formula_ref[m]);else if("working"===o.formula_ref[m].status)throw new Error("Circular ref");"e"===r[g].t?p.push(r[g]):p.push(r[g].v)}else r[g]?"e"===r[g].t?p.push(r[g]):p.push(r[g].v):p.push(null)}}return h}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},function(module,exports,__webpack_require__){"use strict";var utils=__webpack_require__(15),error=__webpack_require__(9),numeral=__webpack_require__(58);function num2e(e){var t=Math.floor(Math.log(e)/Math.LN10),r=e*Math.pow(10,-t);return t.toString().length<10&&(t="0"+t),r+"E+"+t}function allzero(e){e=e.toString();for(var t=0;t<e.length;t++)if("0"!=e[t])return!1;return!0}function decimalsToFractional(e){formatDecimals=e.toFixed(2);var t=3,r=3*formatDecimals;return function e(){for(var n=t>r?t:r;n>1;n--)Number.isInteger(r/n)&&Number.isInteger(t/n)&&(r/=n,t/=n,e())}(),r=parseInt(r),"".concat(r,"/").concat(t)}exports.ASC=function(e){for(var t="",r=0;r<e.length;r++)e.charCodeAt(r)>65248&&e.charCodeAt(r)<65375?t+=String.fromCharCode(e.charCodeAt(r)-65248):t+=String.fromCharCode(e.charCodeAt(r));return t},exports.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},exports.CHAR=function(e){return(e=utils.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},exports.CLEAN=function(e){return(e=e||"").replace(/[\0-\x1F]/g,"")},exports.CODE=function(e){return(e=e||"").charCodeAt(0)},exports.CONCATENATE=function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var r=0;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")},exports.DBCS=function(){throw new Error("DBCS is not implemented")},exports.DOLLAR=function(e,t){if(t=void 0===t?2:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var r="";return t<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),r="($0,0)"):t>0&&(r="($0,0."+new Array(t+1).join("0")+")"),numeral(e).format(r)},exports.EXACT=function(e,t){return e===t},exports.FIND=function(e,t,r){return r=void 0===r?0:r,t.indexOf(e),t?t.indexOf(e,r-1)+1:null},exports.FIXED=function(e,t,r){if(t=void 0===t?2:t,r=void 0!==r&&r,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=r?"0":"0,0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(n+="."+new Array(t+1).join("0")),numeral(e).format(n)},exports.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},exports.INDEX=function(e,t,r){return"string"==typeof e&&(e=utils.strToMatrix(e)),e[t][r-1]},exports.LEFT=function(e,t){return t=void 0===t?1:t,(t=utils.parseNumber(t))instanceof Error||"string"!=typeof e?error.value:e?e.substring(0,t):null},exports.LEN=function(e){return 0===arguments.length?error.error:"string"==typeof e?e?e.length:0:e.length?e.length:error.value},exports.LOWER=function(e){return"string"!=typeof e?error.value:e?e.toLowerCase():e},exports.MID=function(e,t,r){if(t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||"string"!=typeof e)return r;var n=t-1,i=n+r;return e.substring(n,i)},exports.NUMBERVALUE=function(e,t,r){return t=void 0===t?".":t,r=void 0===r?",":r,e.indexOf("%")>0?(e=e.replace("%",""),parseFloat(e)/100):Number(e.replace(t,".").replace(r,""))},exports.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},exports.PROPER=function(e){return void 0===e||0===e.length?error.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?error.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},exports.REGEXEXTRACT=function(e,t){var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null},exports.REGEXMATCH=function(e,t,r){var n=e.match(new RegExp(t));return r?n:!!n},exports.REGEXREPLACE=function(e,t,r){return e.replace(new RegExp(t),r)},exports.REPLACE=function(e,t,r,n){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||"string"!=typeof e||"string"!=typeof n?error.value:e.substr(0,t-1)+n+e.substr(t-1+r)},exports.REPT=function(e,t){return(t=utils.parseNumber(t))instanceof Error?t:new Array(t+1).join(e)},exports.RIGHT=function(e,t){return t=void 0===t?1:t,(t=utils.parseNumber(t))instanceof Error?t:e?e.substring(e.length-t):null},exports.SEARCH=function(e,t,r){var n;return"string"!=typeof e||"string"!=typeof t?error.value:(r=void 0===r?0:r,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1)?error.value:n)},exports.SPLIT=function(e,t){return e.split(t)},exports.SUBSTITUTE=function(e,t,r,n){if(!(e&&t&&r))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),r);for(var i=0,a=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++a===n)return e.substring(0,i)+r+e.substring(i+t.length)},exports.T=function(e){return"TRUE"==e||"FALSE"==e?"":"string"==typeof e?e:""},exports.TEXT=function(value,format){try{if(format.indexOf("%")>=0){var fixed=format.split(".")[1].length-1;return(100*parseFloat(value)).toFixed(fixed)+"%"}var Formulas=window.jsSpreadsheet.AllFormulas,result=Formulas.TEXT(value,format);console.log(result)}catch(e){var result=void 0}if(null==result){if(format.indexOf("#")>=0&&format.indexOf("?/?")>=0){var x=parseFloat(value)-parseInt(value);return 0!=parseInt(value)?parseInt(value)+" "+decimalsToFractional(x):decimalsToFractional(x)}if(format.indexOf("E+")>=0)return num2e(value);if(allzero(value)){for(var result="",i=0;i<format.length-value.length;i++)result+="0";return result+value}if(format.indexOf("#")>=0){var fmt=format;if(format.indexOf("[")>=0&&format.indexOf(";")>=0){var valid=format.split("#")[0];fmt=format.split("]")[1].split(";"),valid=valid.replace("[","").replace("]",""),fmt=eval(value+valid)?fmt[0]:fmt[1]}if(format.indexOf("#")>=0&&format.indexOf(!1)&&format.indexOf("0")>=0&&format.indexOf("°")<=0){value.toString().split(".")[1].length>format.split(".")[1].length&&(value=value.toFixed(format.split(".")[1].length)),value=value.toString();for(var result="",n=0,i=0;i<fmt.length;i++)"#"==fmt[i]||"0"==fmt[i]||"."==fmt[i]?(result+=value[n],n+=1):result+=fmt[i];return result}fmt=fmt.replace("##0","##"),value=value.toString();for(var result="",n=0,i=0;i<fmt.length;i++)"#"==fmt[i]||"0"==fmt[i]?(result+=value[n],n+=1):result+=fmt[i];return result}}return result},exports.TRIM=function(e){return"string"!=typeof e?error.value:e.replace(/ +/g," ").trim()},exports.UNICHAR=function(e){return 0==e?error.value:String.fromCharCode(e)},exports.UNICODE=function(e){return e.charCodeAt(0)},exports.UPPER=function(e){return"string"!=typeof e?error.value:e.toUpperCase()},exports.VALUE=function(e){return"string"!=typeof e?error.value:numeral().unformat(e)}},function(e,t,r){"use strict";var n=r(9);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){switch(e){case n.nil.message:return 1;case n.div0.message:return 2;case n.value.message:return 3;case n.ref.message:return 4;case n.name.message:return 5;case n.num.message:return 6;case n.na.message:return 7;case n.data.message:return 8}return n.na},t.INFO=function(){throw new Error("INFO is not implemented")},t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return[n.value.message,n.ref.message,n.div0.message,n.num.message,n.name.message,n.nil.message].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===n.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=function(e){return"FALSE"!=e&&(1==e||0==e)},t.ISNA=function(e){return e===n.na||e===n.na.message},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=function(){return null!=arguments[0]},t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)?e:e instanceof Date?e.getTime():!0===e||"TRUE"==e.toString().toUpperCase()||"FALSE"==e.toString().toUpperCase()?1:!1===e||"string"==typeof e?0:ISERROR(e)?e:0},t.NA=function(){return n.na},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){if("number"==typeof e&&!isNaN(e)&&isFinite(e))return 1;if("string"==typeof e){if("{"!=e.slice(0,1))return 2;var r=utils.strToMatrix(e);if(Array.isArray(r))return 64}return"FALSE"!=e&&(1==e||0==e?4:t.ISERR(e)||e===n.na?16:Array.isArray(r)?64:void 0)}},function(e,t,r){"use strict";var n=r(9),i=r(15),a=new Date(1900,0,1),o=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function u(e){return 1===new Date(e,1,29).getMonth()}function c(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function f(e){return(e-a)/864e5+(e>-22038912e5?2:1)}t.DATE=function(e,t,r){return window.jsSpreadsheet.AllFormulas.DATE(e,t,r)},t.DATEVALUE=function(e){if("string"!=typeof e)return n.value;var t=Date.parse(e);return isNaN(t)?n.value:t<=-22038912e5?(t-a)/864e5+1:(t-a)/864e5+2},t.DAY=function(e){var t=i.parseDate(e);return t instanceof Error?t:t.getDate()},t.DAYS=function(e,t){return e=i.parseDate(e),t=i.parseDate(t),e instanceof Error?e:t instanceof Error?t:f(e)-f(t)},t.DAYS360=function(e,t,r){if(r=i.parseBool(r),e=i.parseDate(e),t=i.parseDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;var n,a,o=e.getMonth(),s=t.getMonth();if(r)n=31===e.getDate()?30:e.getDate(),a=31===t.getDate()?30:t.getDate();else{var l=new Date(e.getFullYear(),o+1,0).getDate(),u=new Date(t.getFullYear(),s+1,0).getDate();n=e.getDate()===l?30:e.getDate(),t.getDate()===u?n<30?(s++,a=1):a=30:a=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(s-o)+(a-n)},t.EDATE=function(e,t){return(e=i.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),f(e))},t.EOMONTH=function(e,t){return(e=i.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),f(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},t.HOUR=function(e){return"number"!=typeof e||isNaN(e)?(e=i.parseDate(e))instanceof Error?e:e.getHours():parseInt(24*(parseFloat(e)-parseInt(e)))},t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return n.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var r=Math.floor(e/2592e3);e%=2592e3;var i=Math.floor(e/86400);e%=86400;var a=Math.floor(e/3600);e%=3600;var o=Math.floor(e/60),s=e%=60;return"P"+(t=t>0?t+"Y":"")+(r=r>0?r+"M":"")+(i=i>0?i+"D":"")+"T"+(a=a>0?a+"H":"")+(o=o>0?o+"M":"")+(s=s>0?s+"S":"")},t.ISOWEEKNUM=function(e){if((e=i.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return window.jsSpreadsheet.AllFormulas.MINUTE(e)},t.MONTH=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,r){return r instanceof Array&&(r=i.flatten(r)),window.jsSpreadsheet.AllFormulas.NETWORKDAYS(e,t,r)},t.NETWORKDAYSINTL=function(e,t,r,a){"string"==typeof a&&a.indexOf("{")>=0&&(a=i.parseDateArray(i.strToMatrix(a)[0]));try{return window.jsSpreadsheet.AllFormulas.NETWORKDAYS$INTL(e,t,r,a)}catch(m){if(e=i.ExcelDateToJSDate(i.parseDate(e)),t=i.ExcelDateToJSDate(i.parseDate(t)),e instanceof Error)return e;if(t instanceof Error)return t;if(void 0===r)r=l[1];else if("string"==typeof r&&7===r.length){for(var o=[],s=0;s<r.length;s++)"1"==r[s]&&o.push(s+1>6?0:s+1);r=o}else r=l[r];if(!(r instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(s=0;s<a.length;s++){var u=i.parseDate(a[s]);if(u instanceof Error)return u;a[s]=u}var c=(t-e)/864e5+1,f=c,h=e;for(s=0;s<c;s++){var d=(new Date).getTimezoneOffset()>0?h.getUTCDay():h.getDay(),p=!1;d!==r[0]&&d!==r[1]||(p=!0);for(var v=0;v<a.length;v++){var g=a[v];if(g.getDate()===h.getDate()&&g.getMonth()===h.getMonth()&&g.getFullYear()===h.getFullYear()){p=!0;break}}p&&f--,h.setDate(h.getDate()+1)}return f}},t.NETWORKDAYS.INTL=function(e,t,r,a){if("string"==typeof a&&a.indexOf("{")>=0&&(a=i.parseDateArray(i.strToMatrix(a))),e=i.ExcelDateToJSDate(e),t=i.ExcelDateToJSDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var s=i.parseDate(a[o]);if(s instanceof Error)return s;a[o]=s}var u=(t-e)/864e5+1,c=u,f=e;for(o=0;o<u;o++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),d=!1;h!==r[0]&&h!==r[1]||(d=!0);for(var p=0;p<a.length;p++){var v=a[p];if(v.getDate()===f.getDate()&&v.getMonth()===f.getMonth()&&v.getFullYear()===f.getFullYear()){d=!0;break}}d&&c--,f.setDate(f.getDate()+1)}return c},t.NOW=function(){return new Date},t.SECOND=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,r){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:e<0||t<0||r<0?n.num:(3600*e+60*t+r)/86400},t.TIMEVALUE=function(e){var t=window.jsSpreadsheet.AllFormulas;try{return t.TIMEVALUE(e)}catch(e){return n.value}},t.TODAY=function(){return window.jsSpreadsheet.AllFormulas.TODAY()},t.WEEKDAY=function(e,t){if((e=i.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var r=e.getDay();return s[t][r]},t.WEEKNUM=function(e,t){if((e=i.parseDate(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var r=o[t],n=new Date(e.getFullYear(),0,1),a=n.getDay()<r?1:0;return n-=24*Math.abs(n.getDay()-r)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+a},t.WORKDAY=function(e,t,r){return null!=r&&(r=i.flatten(r)),window.jsSpreadsheet.AllFormulas.WORKDAY(e,t,r)},t.WORKDAYINTL=function(e,t,r,a){if((e=i.parseDate(e))instanceof Error)return e;if(0==r)return n.num;if((t=i.parseNumber(t))instanceof Error)return t;if(t<0)return n.num;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var s=i.parseDate(a[o]);if(s instanceof Error)return s;a[o]=s}for(var u=0;u<t;){if(e.setDate(e.getDate()+1),(h=e.getDay())!==r[0]&&h!==r[1]){for(var c=0;c<a.length;c++){var f=a[c];if(f.getDate()===e.getDate()&&f.getMonth()===e.getMonth()&&f.getFullYear()===e.getFullYear()){u--;break}}u++}}var h;return e.getFullYear()+"/"+e.getMonth()+"/"+(h=e.getDay())},t.YEAR=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,r){if((e=i.parseDate(e))instanceof Error)return e;if((t=i.parseDate(t))instanceof Error)return t;r=r||0;var n=e.getDate(),a=e.getMonth()+1,o=e.getFullYear(),s=t.getDate(),l=t.getMonth()+1,f=t.getFullYear();switch(r){case 0:return 31===n&&31===s?(n=30,s=30):31===n?n=30:30===n&&31===s&&(s=30),(s+30*l+360*f-(n+30*a+360*o))/360;case 1:var h=365;if(o===f||o+1===f&&(a>l||a===l&&n>=s))return(o===f&&u(o)||function(e,t){var r=e.getFullYear(),n=new Date(r,2,1);if(u(r)&&e<n&&t>=n)return!0;var i=t.getFullYear(),a=new Date(i,2,1);return u(i)&&t>=a&&e<a}(e,t)||1===l&&29===s)&&(h=366),c(e,t)/h;var d=f-o+1,p=(new Date(f+1,0,1)-new Date(o,0,1))/1e3/60/60/24/d;return c(e,t)/p;case 2:return c(e,t)/360;case 3:return c(e,t)/365;case 4:return(s+30*l+360*f-(n+30*a+360*o))/360}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFormula=E,t.Rows=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==b(e)&&"function"!=typeof e)return{default:e};var t=g();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(r(3)),i=r(4),a=r(8),o=r(4),s=v(r(64)),l=r(8),u=v(r(65)),c=v(r(278)),f=v(r(80)),h=v(r(6)),d=v(r(30)),p=v(r(279));function v(e){return e&&e.__esModule?e:{default:e}}function g(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return g=function(){return e},e}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=r(280);function E(e){return e&&"="===e[0]}function C(e,t,r,n,i,a,o,s){var l=this.getCellByTopCell(e,r,n,"other",s,0),u=l.text,c=l.formulas,f=""!==c?c:u;this.isFormula(f)?this.calcFormulaCellByTopCell(f,t,e,r,n,a):this.calcCellByTopCell(a,i,l,t,n,f,e,u)}function k(e,t,r,n,i,a,o,s){var l="";n?i=Math.abs(i):i*=-1,s?l=this.getCellByTopCell(e,r,n):(l={text:e.v,formulas:e.v},i=0),this.calcNumberCellByTopCell(l,i,t,e,a,o)}function N(e,t,r,n,i,a,o){var s=t,l="",u=r?1:-1;o?l=this.getCellByTopCell(e,s,r,"date"):(l={text:e.v,formulas:e.v},u=0),this.calcDateCellByTopCell(l,n,e,r,i,a,u)}var T=function(){function e(t){var r=t.len,n=t.height,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.height=n,this.data=i,this.pasteProxy=new c.default,this.workbook=null}var t,r,v;return t=e,(r=[{key:"getHeight",value:function(e){var t=this.get(e);return t&&t.height?t.height:this.height}},{key:"setHeight",value:function(e,t){this.getOrNew(e).height=t}},{key:"setStyle",value:function(e,t){this.getOrNew(e).style=t}},{key:"sumHeight",value:function(e,t,r){var i=this;return n.default.rangeSum(e,t,(function(e){return r&&r.has(e)?0:i.getHeight(e)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(e){return this._[e]}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{cells:{}},this._[e]}},{key:"getCell",value:function(e,t){var r=this.get(e);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[t]&&((0,n.isHave)(r.cells[t].text)||(0,n.isHave)(r.cells[t].formulas)||(0,n.isHave)(r.cells[t].style||"object"===b(r.cells[t])))?r.cells[t]:null}},{key:"getCellMerge",value:function(e,t){var r=this.getCell(e,t);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(e,t){var r=this.getOrNew(e);return r.cells[t]=r.cells[t]||{},r.cells[t]}},{key:"toString",value:function(e){return!1===(0,n.isHave)(e)&&(e=""),e+""}},{key:"isBackEndFunc",value:function(e){return-1!==e.indexOf("MD.RTD")}},{key:"isReferOtherSheet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.formulas&&"="===e.formulas[0]&&(t||(0,l.isSheetVale)(e.formulas))}},{key:"isEmpty",value:function(e){return e&&(e.text||e.formulas||e.depend)}},{key:"isFormula",value:function(e){return E(e)}},{key:"setValue",value:function(e,t,r){r[e]=t}},{key:"setCell",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.data,s=this.getOrNew(e),l=new p.default;if(l.setCell(r),"all"===a)s.cells[t]=l;else if("formulas"===a)s.cells[t]=s.cells[t]||{},s.cells[t].formulas=l.formulas;else if("text"===a)s.cells[t]=s.cells[t]||{},s.cells[t].text=l.text;else if("format"===a)s.cells[t]=s.cells[t]||{},s.cells[t].style=l.style,r.merge&&(s.cells[t].merge=l.merge);else if("date"===a||"datetime"===a)(0,n.isHave)(s.cells[t])||(s.cells[t]={}),this.isFormula(r.formulas)?s.cells[t].formulas=l.formulas:s.cells[t].formulas=l.text,s.cells[t].text=l.text,s.cells[t].style=l.style,s.cells[t].to_calc_num=l.to_calc_num;else if("normal"===a||"number"===a)(0,n.isHave)(s.cells[t])||(s.cells[t]={}),this.isFormula(r.formulas)?s.cells[t].formulas=l.formulas:s.cells[t].formulas=l.text,s.cells[t].text=l.text,s.cells[t].style=l.style;else if("rmb"===a||"percent"===a)(0,n.isHave)(s.cells[t])||(s.cells[t]={}),s.cells[t].text=l.text,s.cells[t].formulas=l.formulas,s.cells[t].style=l.style;else{if("all_with_no_workbook"===a)return void(s.cells[t]=l);if("style"===a)return(0,n.isHave)(s.cells[t])||(s.cells[t]={}),void(s.cells[t].style=l.style)}this.getDependCell((0,i.xy2expr)(t,e),this.getCell(e,t)),l.setFormatText(o.tryParseToNum(l,e,t))}},{key:"getDependCell",value:function(e,t){var r=t.formulas;if(!1!==(0,n.isHave)(r)&&E(r)){for(var i=(0,a.cutStr)(r,!0,!0),s=0;s<i.length;s++){var u,c=this.mergeCellExpr(i[s]);c.state&&(u=i).push.apply(u,y(c.mergeArr))}i=(0,l.distinct)(i),!1===(0,n.isHave)(t.depend)&&(t.depend=[]);for(var f=0;f<i.length;f++){var h=i[f],d=m((0,o.expr2xy)(h),2),p=d[0],v=d[1],g=this.getCell(v,p);!1===(0,n.isHave)(g)&&(g={}),!1===(0,n.isHave)(g.depend)&&(g.depend=[]),g.depend.push(e),g.depend=(0,l.distinct)(g.depend),this.setCell(v,p,g,"all_with_no_workbook")}}}},{key:"mergeCellExpr",value:function(e){if(!(0,a.isAbsoluteValue)(e,6))return{state:!1};e=(e=e.replace(/\$/g,"")).split(":");var t=(0,o.expr2xy)(e[0]),r=(0,o.expr2xy)(e[1]);if(t[0]>r[0]){var n=r[0];r[0]=t[0],t[0]=n}if(t[1]>r[1]){var s=r[1];r[1]=t[1],t[1]=s}var l=new h.default(t[1],t[0],r[1],r[0]),u=[];return l.each((function(e,t){u.push((0,i.xy2expr)(t,e))})),{state:!0,mergeArr:u}}},{key:"useOne",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!1===(0,n.isHave)(e)?t:r&&this.isFormula(e)?t:e}},{key:"setCellText",value:function(e,t,r){var n=r.text,a=r.style,o=r.formulas,s=r.merge,l=void 0===s?"":s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all";if("all_with_no_workbook"!==u){var c=this.getCellOrNew(e,t),f=new p.default;f.setCell(c),"style"===u?(f.style=a,f.formulas=n):"format"===u?(f.formulas=c.formulas,f.style=a):"cell"===u?(f.style=a,f.formulas=o,f.merge=void 0,""!==l&&(f.merge=l)):f.formulas=n,f.text=n,this.setCell(e,t,f),this.getDependCell((0,i.xy2expr)(t,e),this.getCell(e,t))}else this.setCell(e,t,{},"all_with_no_workbook")}},{key:"setCellAll",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=this.getCellOrNew(e,t),o=new p.default;o.formulas=""===n?a.formulas:n,o.text=r,this.setCell(e,t,o,"formulas"),this.setCell(e,t,o,"text"),this.getDependCell((0,i.xy2expr)(t,e),this.getCell(e,t))}},{key:"moveChange",value:function(e,t,r){var i=this;if(e.length===t.length||r.length===t.length)for(var o=function(o){var s=e[o].expr;e[o].each((function(e,l){var u=i.getCell(e,l);!1===(0,n.isHave)(u)&&(u={}),(0,n.isHave)(u.formulas)||(u.formulas="");var c=(0,a.changeFormula)((0,a.cutStr)(u.formulas));if(-1!==c.indexOf(s)){var f=r[o].expr.replace(/\$/g,"\\$");i.setCellAll(e,l,u.text.replace(new RegExp(f,"g"),t[o].expr),u.formulas.replace(f,t[o].expr))}else{var h=(0,a.value2absolute)(s),d=(0,a.value2absolute)(t[o].expr);-1!==c.indexOf(h.s3)?((h=(0,a.value2absolute)(r[o].expr)).s3=h.s3.replace(/\$/g,"\\$"),i.setCellAll(e,l,u.text.replace(new RegExp(h.s3,"g"),d.s3),u.formulas.replace(new RegExp(h.s3,"g"),d.s3))):-1!==c.indexOf(h.s2)?((h=(0,a.value2absolute)(r[o].expr)).s2=h.s2.replace(/\$/g,"\\$"),i.setCellAll(e,l,u.text.replace(new RegExp(h.s2,"g"),d.s2),u.formulas.replace(new RegExp(h.s2,"g"),d.s2))):-1!==c.indexOf(h.s1)&&((h=(0,a.value2absolute)(r[o].expr)).s1=h.s1.replace(/\$/g,"\\$"),i.setCellAll(e,l,u.text.replace(new RegExp(h.s1,"g"),d.s1),u.formulas.replace(new RegExp(h.s1,"g"),d.s1)))}}))},s=0;s<e.length;s++)o(s)}},{key:"formatMoney",value:function(e,t){if(/[^0-9\.]/.test(e))return"0";if(null==e||""===e)return"0";e=(e=((e=e.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var r=/(\d)(\d{3},)/;r.test(e);)e=e.replace(r,"$1,$2");if(e=e.replace(/,(\d\d)$/,".$1"),0===t){var n=e.split(".");"00"===n[1]&&(e=n[0])}return e}},{key:"getCellStyleConvert",value:function(e,t){return e&&e.format&&"number"===e.format?"number":e&&e.format&&"rmb"===e.format?"rmb":e&&e.format&&"normal"===e.format?"normal":e&&e.format&&"percent"===e.format?"percent":e&&e.format&&"datetime"===e.format?"datetime":t&&!(0,n.isHave)(e)||t&&e&&"normal"!==e.format||e&&e.format&&"date"===e.format?"date":""}},{key:"getCellTextIsAdd",value:function(e,t,r,n,a,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7?arguments[7]:void 0,u=!1,c="";return e&&(t<=r[1]&&n&&l?(c=(0,i.xy2expr)(r[0]+a,r[1]+o,s),u=!0):t<=r[1]&&!n&&l?(c=(0,i.xy2expr)(r[0]+a,r[1]+o,s),u=!0):t<=r[0]&&n&&!1===l&&(c=(0,i.xy2expr)(r[0]+a,r[1]+o,s),u=!0)),{enter:u,data:c}}},{key:"eachRange",value:function(e){var t=this,r=[];return e.each((function(e,a){var o,s,u,c=t.getCell(e,a);if((0,n.isHave)(c)){var f=(o=c,!((0,n.isHave)(o)&&""!==o||(0,n.isHave)(s)&&""!==s||(0,n.isHave)(u)));c=(0,l.deepCopy)(c);var h=new d.default(e,a,c,(0,i.xy2expr)(e,a),f);r.push(h)}else{c={};var p=new d.default(e,a,c,(0,i.xy2expr)(e,a),!0);r.push(p)}})),r}},{key:"getCellTextByShift",value:function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=!1,f=!1,h="",d=0;d<e.length;d++){if("string"==typeof e[d]&&(e[d]=e[d].toUpperCase()),-1!==e[d].search(/^[A-Z]+\d+$/)){var p=(0,o.expr2xy)(e[d]);(p[0]+t<0||p[1]+r<0)&&(c=!0);var v=this.getCellTextIsAdd(n,l,p,s,t,r,0,u);v.enter?e[d]=v.data:!1===n&&(e[d]=(0,i.xy2expr)(p[0]+t,p[1]+r)),f=!0}else if(-1!==e[d].search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var g=e[d].split(":")[0],m=e[d].split(":")[1],y=(0,o.expr2xy)(g),b=(0,o.expr2xy)(m);(y[0]+t<0||y[1]+r<0)&&(c=!0),(b[0]+t<0||b[1]+r<0)&&(c=!0);var w="",x=this.getCellTextIsAdd(n,l,y,s,t,r,0,u);w=x.enter?x.data+":":!1===n?(0,i.xy2expr)(y[0]+t,y[1]+r)+":":g+":",(x=this.getCellTextIsAdd(n,l,b,s,t,r,0,u)).enter?w+=x.data:w+=!1===n?(0,i.xy2expr)(b[0]+t,b[1]+r):m,f=!0,e[d]=w}else{var E=(0,a.isAbsoluteValue)(e[d],5);if(2===E){var C=(0,o.expr2xy)(e[d].replace(/\$/g,""));(C[0]+t<0||C[1]+r<0)&&(c=!0);var k=this.getCellTextIsAdd(n,l,C,s,t,r,2,u);k.enter?e[d]=k.data:!1===n&&(e[d]=(0,i.xy2expr)(C[0]+t,C[1],2)),f=!0}else if(1===E){var N=(0,o.expr2xy)(e[d].replace(/\$/g,""));(N[0]+t<0||N[1]+r<0)&&(c=!0);var T=this.getCellTextIsAdd(n,l,N,s,t,r,1,u);T.enter?e[d]=T.data:!1===n&&(e[d]=(0,i.xy2expr)(N[0],N[1]+r,1)),f=!0}else if(4===E){var O=e[d].split(":");console.log(e[d],O);for(var M=0;M<O.length;M++){var A=(0,o.expr2xy)(O[M].replace(/\$/g,""));(A[0]+t<0||A[1]+r<0)&&(c=!0);var S=this.getCellTextIsAdd(n,l,A,s,t,r,2,u);S.enter?O[M]=S.data:!1===n&&(O[M]=(0,i.xy2expr)(A[0]+t,A[1],2))}e[d]=O.join(":"),f=!0}else if(5===E){for(var I=e[d].split(":"),R=0;R<I.length;R++){var _=(0,o.expr2xy)(I[R].replace(/\$/g,""));if((_[0]+t<0||_[1]+r<0)&&(c=!0),1===R){var j=this.getCellTextIsAdd(n,l,_,s,t,r,1,u);j.enter?I[R]=j.data:!1===n&&(I[R]=(0,i.xy2expr)(_[0],_[1]+r,1))}else{var D=this.getCellTextIsAdd(n,l,_,s,t,r,2,u);D.enter?I[R]=D.data:!1===n&&(I[R]=(0,i.xy2expr)(_[0],_[1]+r,2))}}e[d]=I.join(":"),f=!0}else if(7===E){for(var P=e[d].split(":"),L=0;L<P.length;L++){var F=(0,o.expr2xy)(P[L].replace(/\$/g,""));(F[0]+t<0||F[1]+r<0)&&(c=!0);var B=this.getCellTextIsAdd(n,l,F,s,t,r,1,u);B.enter?P[L]=B.data:!1===n&&(P[L]=(0,i.xy2expr)(F[0],F[1]+r,1))}e[d]=P.join(":"),f=!0}else if(6===E){for(var H=e[d].split(":"),V=0;V<H.length;V++){var z=(0,o.expr2xy)(H[V].replace(/\$/g,""));if((z[0]+t<0||z[1]+r<0)&&(c=!0),0===V){var U=this.getCellTextIsAdd(n,l,z,s,t,r,1,u);U.enter?H[V]=U.data:!1===n&&(H[V]=(0,i.xy2expr)(z[0],z[1]+r,1))}else{var Y=this.getCellTextIsAdd(n,l,z,s,t,r,2,u);Y.enter?H[V]=Y.data:!1===n&&(H[V]=(0,i.xy2expr)(z[0]+t,z[1],2))}}e[d]=H.join(":"),f=!0}else if(8===E){for(var W=e[d].split(":"),X=0;X<W.length;X++){var G=(0,o.expr2xy)(W[X].replace(/\$/g,""));if((G[0]+t<0||G[1]+r<0)&&(c=!0),0===X){var q=this.getCellTextIsAdd(n,l,G,s,t,r,0,u);q.enter?W[X]=q.data:!1===n&&(W[X]=(0,i.xy2expr)(G[0]+t,G[1]+r,0))}else{var $=this.getCellTextIsAdd(n,l,G,s,t,r,1,u);$.enter?W[X]=$.data:!1===n&&(W[X]=(0,i.xy2expr)(G[0]+t,G[1],1))}}e[d]=W.join(":"),f=!0}else if(9===E){for(var K=e[d].split(":"),Z=0;Z<K.length;Z++){var Q=(0,o.expr2xy)(K[Z].replace(/\$/g,""));if((Q[0]+t<0||Q[1]+r<0)&&(c=!0),0===Z){var J=this.getCellTextIsAdd(n,l,Q,s,t,r,1,u);J.enter?K[Z]=J.data:!1===n&&(K[Z]=(0,i.xy2expr)(Q[0]+t,Q[1]+r,0))}else{var ee=this.getCellTextIsAdd(n,l,Q,s,t,r,2,u);ee.enter?K[Z]=ee.data:!1===n&&(K[Z]=(0,i.xy2expr)(Q[0]+t,Q[1],2))}}e[d]=K.join(":"),f=!0}else if(10===E){for(var te=e[d].split(":"),re=0;re<te.length;re++){var ne=(0,o.expr2xy)(te[re].replace(/\$/g,""));if((ne[0]+t<0||ne[1]+r<0)&&(c=!0),1===re){var ie=this.getCellTextIsAdd(n,l,ne,s,t,r,0,u);ie.enter?te[re]=ie.data:!1===n&&(te[re]=(0,i.xy2expr)(ne[0]+t,ne[1]+r,0))}else{var ae=this.getCellTextIsAdd(n,l,ne,s,t,r,2,u);ae.enter?te[re]=ae.data:!1===n&&(te[re]=(0,i.xy2expr)(ne[0]+t,ne[1],2))}}e[d]=te.join(":"),f=!0}else if(11===E){for(var oe=e[d].split(":"),se=0;se<oe.length;se++){var le=(0,o.expr2xy)(oe[se].replace(/\$/g,""));if((le[0]+t<0||le[1]+r<0)&&(c=!0),1===se){var ue=this.getCellTextIsAdd(n,l,le,s,t,r,0,u);ue.enter?oe[se]=ue.data:!1===n&&(oe[se]=(0,i.xy2expr)(le[0]+t,le[1]+r,0))}else{var ce=this.getCellTextIsAdd(n,l,le,s,t,r,1,u);ce.enter?oe[se]=ce.data:!1===n&&(oe[se]=(0,i.xy2expr)(le[0]+t,le[1],1))}}e[d]=oe.join(":"),f=!0}}h+=e[d]}return{bad:c,enter:f,result:h}}},{key:"autoFilterRef",value:function(e,t){for(var r=m((0,o.expr2xy)(e),2),n=r[0],i=r[1],a=this.getCell(i,n);null!==a;)i+=1,a=this.getCell(i,n);return t.eri=i,t}},{key:"getAllDataType",value:function(e){var t=this,r=!0,n=!0,i=[];return e.each((function(e,a){var o=!1,s=t.getCell(e,a);if(s){s=(0,l.deepCopy)(s);var u=new f.default(s).getCellDataType(i,{isDate:n,isNumber:r});n=u.isDate,r=u.isNumber}else o=!0,r=!1,n=!1;o&&i.push({text:0,formulas:0,tmp:"",type:"other"})})),{isDate:n,isNumber:r,sarr:i}}},{key:"calcNumberCellByTopCell",value:function(e,t,r,n,i,a){var o=e.text,s=e.formulas;o=this.toString(o),s=this.toString(s);var l={};if(this.isFormula(s)){var u=1*o.replace("=","")+t;l={text:"="+u,formulas:"="+u}}else if(""!==o){var c=1*o;if(-1!==o.indexOf(",")){c=c.replace(/,/g,"");var f=parseFloat(c)+t;c=this.formatMoney(f,0)}else c+=t;l={text:c+"",formulas:c+""}}this.copyRender(r,n.ri,n.ci,l,i,a)}},{key:"calcFormulaCellByTopCell",value:function(e,t,r,n,i,a){var o=(0,l.splitStr)(e),s=this.getRangeByTopCell({ri:r.ri,ci:r.ci},n,i),u=r.ri-s.ri,c=r.ci-s.ci,f=this.getCellTextByShift(o,c,u),h=f.bad,d=f.result;this.updateCellReferenceByShift(h,d,r.ri,r.ci,a)}},{key:"calcCellByTopCell",value:function(e,t,r,i,a,o,s,l){if((0,n.isHave)(o)||(o=""),isNaN(o)){var u=this.toString(o).split(/\d+/g);if(u){var c=0;r.text=a?o.replace(/\d+/g,(function(e){return c+=1,u.length-1===c?1*e+1:e})):o.replace(/\d+/g,(function(e){return c+=1,u.length-1===c?1*e-1:e})),r.formulas=r.text}}else r.text=o,r.formulas=r.text;this.copyRender(i,s.ri,s.ci,r,t,e)}},{key:"calcDateCellByTopCell",value:function(e,t,r,n,i,a,o){if(""!==e.text){var l=e.text,u="";u=(0,s.default)(l).add(o,"day").format("YYYY-MM-DD"),e.text=this.toString(u),e.formulas=this.toString(u),this.copyRender(t,r.ri,r.ci,e,i,a)}}},{key:"getRangeByTopCell",value:function(e,t,r){var n=e.ri,i=e.ci;return r?(n=t?n:n-1,i=t?i-1:i):(n=t?n:n+1,i=t?i+1:i),{ri:n,ci:i}}},{key:"getCellByTopCell",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(arguments.length>5&&void 0!==arguments[5]&&arguments[5],"date"!==n){var a=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},t,r),o=a.ri,s=a.ci;return this.getCellByCell(o,s)}if(1===t){var l=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},!1,r),u=l.ri,c=l.ci;return this.getCellByCell(u,c)}return 2===t?this.getCellByCell(e.ri,e.ci-1):3===t?this.getCellByCell(e.ri,e.ci+1):void 0}},{key:"getCellByCell",value:function(e,t){var r=this.getCell(e,t);return r||(r={text:"",formulas:""}),n.default.cloneDeep(r)}},{key:"updateCellReferenceByShift",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a={};e?(a.text="#REF!",a.formulas="#REF!"):(a.text=""!==t?t:"",a.formulas=""!==t?t:""),this.setCell(r,n,a,"all"),i(r,n,a)}},{key:"copyPaste",value:function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},i=this.pasteProxy;i.setSrcAndDstCellRange(e,t);for(var a=i.use(),o=a.rn,s=a.cn,l=i.autoFilterDirection(),u=l?o:s,c=0;c<u;c++){for(var f=i.upOrDown(),h=i.getOneDRangeObj(l,c),d=h.srcOneDRange,p=h.dstOneDRange,v=this.getAllDataType(d),g=v.isNumber,m=v.isDate,y=v.sarr,b=p.getLocationArray(y),w=i.leftOrRight(),x=!1,E=0;E<b.length;E++){var T=b[E];(g||"number"===T.type||m||"date"===T.type)&&(x=!0)}if(f)for(var O=0;O<b.length;O++){var M=b[O];if(g||"number"===M.type){var A=i.calcDiff(y,f);k.call(this,b[O],b,l,f,A,r,n,g)}else m||"date"===M.type?N.call(this,b[O],w,f,b,r,n,m):C.call(this,b[O],b,l,f,r,n,x,y.length-1)}else for(var S=b.length-1;S>=0;S--){var I=b[S];if(g||"number"===I.type){var R=i.calcDiff(y,f);k.call(this,b[S],b,l,f,R,r,n,g)}else m||"date"===I.type?N.call(this,b[S],w,f,b,r,n,m):C.call(this,b[S],b,l,f,r,n,x,y.length-1)}}}},{key:"copyRender",value:function(e,t,r,n,i,a){for(var o=!1,s=0;!1===o&&s<e.length;s++)e[s].ri===t&&e[s].ci===r&&(o=!0);o&&(this.setCell(t,r,n,i),a(t,r,n))}},{key:"cutPaste",value:function(e,t){var r=this,n=[];this.each((function(i){r.eachCells(i,(function(a){var o=parseInt(i,10),s=parseInt(a,10);e.includes(i,a)&&(o=t.sri+(o-e.sri),s=t.sci+(s-e.sci)),1*i===o&&1*a===s||""!==r._[i].cells[a].text&&""!==r._[i].cells[a].formulas&&n.push({nri:o,nci:s,ri:i,ci:a,cell:(0,l.deepCopy)(r._[i].cells[a])})}))}));for(var i=0;i<n.length;i++){var a=n[i],o=a.ri,s=a.ci;this.setCell(o,s,{},"all")}for(var u=0;u<n.length;u++){var c=n[u],f=c.nri,h=c.nci,d=c.cell;this.setCell(f,h,d,"all")}}},{key:"insert",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i={},a=[];this.each((function(o,s){var u=parseInt(o,10);u>=e&&(u+=r,t.eachCells(o,(function(i,o){if((0,n.isHave)(o)&&(0,n.isHave)(o.formulas)&&t.isFormula(o.formulas)){var s=t.getCellTextByShift((0,l.splitStr)(o.formulas),0,r,!0,!0,e,!0),c=s.bad,f=s.result;s.enter&&!c&&a.push({ri:u,ci:i,cell:{text:f,formulas:f}})}}))),i[u]=s})),this._=i;for(var o=0;o<a.length;o++){var s=a[o],u=s.ri,c=s.ci,f=s.cell;this.setCell(u,c,f,"all")}this.len+=r}},{key:"delete",value:function(e,t){var r=this,i=t-e+1,a={},o=[];this.each((function(s,u){var c=parseInt(s,10);c<e?a[c]=u:s>t&&(a[c-i]=u,r.eachCells(s,(function(t,a){if((0,n.isHave)(a)&&(0,n.isHave)(a.formulas)&&r.isFormula(a.formulas)){var s=r.getCellTextByShift((0,l.splitStr)(a.formulas),0,-1*i,!0,!1,e,!0),u=s.bad,f=s.result;s.enter&&!u&&o.push({ri:c-i,ci:t,cell:{text:f,formulas:f}})}})))})),this._=a;for(var s=0;s<o.length;s++){var u=o[s],c=u.ri,f=u.ci,h=u.cell;this.setCell(c,f,h,"all")}this.len-=i}},{key:"insertColumn",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=[];this.each((function(a,o){var s={};t.eachCells(a,(function(o,u){var c=parseInt(o,10);if(c>=e&&(c+=r,(0,n.isHave)(u)&&(0,n.isHave)(u.formulas)&&t.isFormula(u.formulas))){var f=t.getCellTextByShift((0,l.splitStr)(u.formulas),r,0,!0,!0,e,!1),h=f.bad,d=f.result;f.enter&&!h&&i.push({ri:a,ci:c,cell:{text:d,formulas:d}})}s[c]=u})),o.cells=s}));for(var a=0;a<i.length;a++){var o=i[a],s=o.ri,u=o.ci,c=o.cell;this.setCell(s,u,c,"all")}}},{key:"deleteColumn",value:function(e,t){var r=this,n=t-e+1;this.each((function(i,a){var o={};r.eachCells(i,(function(r,i){var a=parseInt(r,10);a<e?o[a]=i:a>t&&(o[a-n]=i)})),a.cells=o}))}},{key:"deleteCells",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";e.each((function(e,n){t.deleteCell(e,n,r)}))}},{key:"deleteCell",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",i=this.get(e);if(null!==i){var a=this.getCell(e,t);null!==a&&("all"===r?delete i.cells[t]:"text"===r?((0,n.isHave)(a.text)&&delete a.text,(0,n.isHave)(a.value)&&delete a.value,(0,n.isHave)(a.formulas)&&delete a.formulas):"format"===r?(void 0!==a.style&&delete a.style,a.merge&&delete a.merge):"merge"===r&&a.merge&&delete a.merge)}}},{key:"each",value:function(e){Object.entries(this._).forEach((function(t){var r=m(t,2),n=r[0],i=r[1];e(n,i)}))}},{key:"eachCells",value:function(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((function(e){var r=m(e,2),n=r[0],i=r[1];t(n,i)}))}},{key:"recast",value:function(e){try{if(this.isReferOtherSheet(e,!0)){var t=new u.default(e.formulas);t.parse(),e.recast=t}else e.recast=null}catch(t){e.recast=null}}},{key:"init",value:function(){var e=this;this.each((function(t){e.eachCells(t,(function(r){e.getDependCell((0,i.xy2expr)(r,t),e.getCell(t,r))}))}))}},{key:"setData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{e.len&&(this.len=e.len,delete e.len),this._=e,r||""!==t&&(console.time("setData"),n&&(this.init(),this.workbook=x.Rows2Workbook(this),t.toolbar.change("close","")),console.timeEnd("setData"))}catch(e){console.error(e)}}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}}])&&w(t.prototype,r),v&&w(t,v),e}();t.Rows=T},,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.process=v,t.mountImg=m,t.isHaveStyle=function(e,t){for(var r=0;r<e.length;r++)if(w(e[r],t))return r;return-1},t.mountPaste=function(e,t){for(var r=this,a=e.clipboardData,o=!1,s=0;s<a.items.length;s++){var l=a.items[s];if("string"===l.kind)l.getAsString((function(e){var t=(0,i.h)("head",""),a=(0,i.h)("span","");-1===e.indexOf("<span")&&-1===e.indexOf("span>")&&-1===e.indexOf("<table")&&-1===e.indexOf("table>")?(a.html(e),t.child(a.el),t=t.el):(t.html(e),t=t.el);var s=t.getElementsByTagName("img")[0],l=t.getElementsByTagName("style")[0],u=t.getElementsByTagName("table")[0],c=t.getElementsByTagName("span")[0];if(s&&!l)m.call(r,s),o=!0;else if(u){if(l)r.el.child(l);u&&!1===o&&(v.call(r,u,l),o=!0)}else setTimeout((function(){if(!o){if(c&&(u=p.call(r,c,u)),l)r.el.child(l);if(u&&!1===o)r.el.child(u),x.call(r,u),u.parentNode.removeChild(u),l&&l.parentNode.removeChild(l),n.sheetReset.call(r),o=!0}}),100)}));else if("file"===l.kind&&!o){var u=l.getAsFile(),c=new FileReader;if(c.onload=function(e){var t=(0,i.h)("img","paste-img");t.el.src=e.target.result,setTimeout((function(){o||(o=!0,m.call(r,t.el))}),0)},!u)return;c.readAsDataURL(u)}}setTimeout((function(){if(o){var e=r.data;e.change(e.getData())}else t()}))},t.hideDirectionArr=y,t.deleteImg=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data.pasteDirectionsArr,r=[],n=[];if(this.direction=!1,t.length>0)for(var i=0;i<t.length;i++)!0===t[i].state||!0===e?n.push(t[i]):r.push(t[i]);Object.keys(n).forEach((function(e){n[e].img.removeEl()})),this.pasteDirectionsArr=r;var a=this.data;a.pasteDirectionsArr=r,a.change(a.getData())},t.GetInfoFromTable=x,t.dragOption=t.resizeOption=void 0;var n=r(46),i=r(1),a=f(r(88)),o=f(r(322)),s=r(2),l=r(87),u=f(r(6)),c=f(r(323));function f(e){return e&&e.__esModule?e:{default:e}}var h={onBegin:function(e){console.log("obegin",e)},onEnd:function(e){},onResize:function(e,t){var r=l.getChooseImg.call(t);r&&(r.img2.style.width=r.img.el.style.width,r.img2.style.height=r.img.el.style.height)}};t.resizeOption=h;var d={onBegin:function(e){console.log("obegin",e)},onEnd:function(e,t){var r=e.left,n=e.top,i=l.getChooseImg.call(t);if(i){n-31<0?n=0:r-60<0&&(r=0);var a=t.data.getCellRectByXY(r+60,n+31);a.sri=a.ri,a.sci=a.ci,a.eri=a.ri,a.eci=a.ci;var o=r-a.left+50,s=n-a.top+21;i.offsetLeft=o,i.offsetTop=s,i.range=a,void 0!==i.lastCi&&void 0!==i.lastRi&&(i.ri=i.lastRi,i.ci=i.lastCi),i.lastCi=a.ci,i.lastRi=a.ri}},onDrag:function(e){}};function p(e,t){for(var r=(0,i.h)("table",""),n=(0,i.h)("tbody",""),a=e.innerText.split("\n"),o=0;o<a.length;o++){var s=a[o],l=(0,i.h)("tr",""),u=(0,i.h)("td","");u.html(s),u.css("background",e.style.background),u.css("font-weight",e.style["font-weight"]),u.css("color",e.style.color),l.child(u),n.child(l)}return r.child(n),r.el}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.el,i=this.data;i.history.add(i.getData()),r.child(e),x.call(this,e),e.parentNode.removeChild(e),t&&t.parentNode.removeChild(t),n.sheetReset.call(this)}function g(e,t){for(var r=0,n=0,i=this.data.pasteDirectionsArr,a=0,o=0;o<i.length;o++){var s=i[o];s.ri===e&&s.ci===t&&(n<s.nextLeft&&(n=s.nextLeft),r<s.nextTop&&(r=s.nextTop),a++)}return{top:r,left:n,number:a}}function m(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0,p=new Image;p.src=e.src,p.onload=function(){var v=p.width,m=p.height,y=e,w=t.container,x=t.data,E=x.pasteDirectionsArr,C=x.selector,k=C.ri,N=C.ci;r&&(k=n,N=c);var T=t.pictureOffsetLeft,O=t.pictureOffsetTop,M=x.getMoveRect(new u.default(k,N,k,N)),A=M.left+T,S=M.top+O,I=0,R=l.getChooseImg.call(t);if(R){var _=g.call(t,R.ri,R.ci);A=_.left,S=_.top,k=R.ri,N=R.ci,I=_.number}var j=(0,i.h)("div","".concat(s.cssPrefix,"-object-container")).css("position","absolute").css("top","".concat(S,"px")).css("width","".concat(v,"px")).css("height","".concat(m,"px")).css("z-index","100000").css("left","".concat(A,"px")).child(y);w.child(j),new a.default(d,t).register(j.el),setTimeout((function(){var e=t.data,n=new o.default(h,t).register(j.el),i=E.length;E.push({src:y.src,state:!0,arr:n,img:j,index:i,img2:y,ri:k,ci:N,offsetLeft:0,offsetTop:0,number:I,range:r?f:e.selector.range,top:S,left:A,nextLeft:A+15,nextTop:S+15}),r||t.data.change(t.data.getData()),t.direction=!0,j.css("width","".concat(y.offsetWidth,"px")),j.css("height","".concat(y.offsetHeight,"px")),b.call(t,n,i,E,r),j.on("mousedown",(function(){return b.call(t,n,i,E)}))}),0)}}function y(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++){var r=e[t].arr;if(r.length>0)for(var n=0;n<r.length;n++)r[n].style.display="none";e[t].state=!1,e[t].img.css("z-index","10000"),e[t].img2.style.border="none"}}function b(e,t,r,n){y.call(this),this.direction=!0,Object.keys(e).forEach((function(t){e[t].style.display="block"}));var i=this.selector,a=this.editor;n?y.call(this):(i.hide(),a.clear(),r[t].img.css("z-index","99999999"),r[t].state=!0)}function w(e,t){if(!(e instanceof Object)||!(t instanceof Object))return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;var r=Object.keys(e);for(var n in r){var i=e[n=r[n]]instanceof Object,a=t[n]instanceof Object;if(i&&a){var o=w(e[n],t[n]);if(!o)return o}else if(e[n]!==t[n])return!1}return!0}function x(e){var t=this.data,r=t.selector,n=r.ri,i=r.ci,a=t.styles;console.time("paste");var o=new c.default(t);o.extend(e,{ri:n,ci:i}),o.dealColSpan(e),o.dealStyle(e,{ri:n,ci:i});var s=o.dealReference(e,{ri:n,ci:i}).reference;this.setCellRange(s,o,!0,o.parseTableCellRange(e,{ri:n,ci:i}));var l=t.getSelectedRect(),u=l.left+l.width+60,f=l.top+l.height+31,h=this.advice;return this.editor.clear(),h.show(u,f,1,s,o),console.timeEnd("paste"),{rows:t.rows._,styles:a}}t.dragOption=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectorCellText=Ee,t.insertDeleteRowColumn=Ne,t.sheetReset=Y,t.selectorSet=P,t.default=void 0;var n=r(1),i=r(10),a=R(r(284)),o=R(r(285)),s=R(r(82)),l=R(r(287)),u=R(r(297)),c=R(r(47)),f=R(r(298)),h=R(r(310)),d=R(r(314)),p=r(315),v=r(2),g=r(25),m=r(32),y=R(r(316)),b=r(31),w=r(45),x=r(87),E=R(r(317)),C=r(8),k=(r(81),R(r(6))),N=r(3),T=r(4),O=R(r(319)),M=R(r(320)),A=r(33),S=R(r(321)),I=R(r(35));function R(e){return e&&e.__esModule?e:{default:e}}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function D(){var e=this.data,t=this.verticalScrollbar,r=this.horizontalScrollbar,n=e.getSelectedRect(),i=n.l,a=n.t,o=n.left,s=n.top,l=n.width,u=n.height,c=this.getTableOffset();if(Math.abs(o)+l>c.width)r.move({left:i+l-c.width});else{var f=e.freezeTotalWidth();o<f&&r.move({left:i-1-f})}if(Math.abs(1*s)+u>c.height)t.move({top:a+u-c.height-1});else{var h=e.freezeTotalHeight();s<h&&t.move({top:a-1-h})}}function P(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==t||-1!==r){var a=this.table,o=this.selector,s=this.toolbar;e?o.setEnd(t,r,i,!0):o.set(t,r,n),s.reset(),clearTimeout(this.render_timer),this.render_timer=setTimeout((function(){a.render()}),100)}}function L(e,t){var r=this.selector,n=this.data,i=this.editor,a=n.rows,o=n.cols;i.isCors&&(r.indexes=[i.ri,i.ci]);var s=j(r.indexes,2),l=s[0],u=s[1],c=r.range.eci;if(e){var f=j(r.moveIndexes,2);l=f[0],u=f[1]}"left"===t?u>0&&(u-=1):"right"===t?(c!==u&&(u=c),u<o.len-1&&(u+=1)):"up"===t?l>0&&(l-=1):"down"===t?l<a.len-1&&(l+=1):"row-first"===t?u=0:"row-last"===t?u=o.len-1:"col-first"===t?l=0:"col-last"===t&&(l=a.len-1),e&&(r.moveIndexes=[l,u]),r.selectCell.setData(l,u),r.selectCell.resetSelectOffset(),P.call(this,e,l,u),ce.call(this),D.call(this)}function F(e){if(0===e.buttons&&e.target.className!=="".concat(v.cssPrefix,"-resizer-hover")){var t=e.offsetX,r=e.offsetY,n=this.rowResizer,i=this.colResizer,a=this.tableEl,o=this.data,s=this.website,l=o.getCellRectByXY(e.offsetX,e.offsetY);s.show(l.ri,l.ci);var u=o.rows,c=o.cols;if(t>c.indexWidth&&r>u.height)return n.hide(),void i.hide();var f=a.box();l.ri>=0&&-1===l.ci?(l.width=c.indexWidth,n.show(l,{width:f.width})):n.hide(),-1===l.ri&&l.ci>=0?(l.height=u.height,i.show(l,{height:f.height})):i.hide()}}function B(e){var t=this.verticalScrollbar,r=this.data,n=r.settings.autoLoad,i=t.scroll().top,a=e.deltaY,o=r.rows;if(e.detail&&(a=40*e.detail),a>0&&!0===n){var s=r.scroll.ri+1;s<o.len&&t.move({top:i+o.getHeight(s)-1})}else if(!0===n){var l=r.scroll.ri-1;l>=0&&t.move({top:0===l?0:i-o.getHeight(l)})}}function H(e,t){var r=this.verticalScrollbar,n=this.horizontalScrollbar,i=r.scroll().top,a=n.scroll().left;"left"===e||"right"===e?n.move({left:a-t}):"up"!==e&&"down"!==e||r.move({top:i-t})}function V(){var e=this.data,t=this.verticalScrollbar,r=this.getTableOffset().height;t.set(r,e.rows.totalHeight())}function z(){var e=this.data,t=this.horizontalScrollbar,r=this.getTableOffset().width;e&&t.set(r,e.cols.totalWidth())}function U(){var e=this.selector,t=this.data,r=this.editor,n=j(t.freeze,2),i=n[0],a=n[1];if(i>0||a>0){var o=t.freezeTotalWidth(),s=t.freezeTotalHeight();r.setFreezeLengths(o,s)}e.resetAreaOffset()}function Y(){var e=this.tableEl,t=this.overlayerEl,r=this.overlayerCEl,n=this.table,i=this.toolbar,a=this.selector,o=this.el,s=this.getTableOffset(),l=this.getRect();e.attr(l),t.offset(l),r.offset(s),o.css("width","".concat(l.width,"px")),ge.call(this),me.call(this),V.call(this),z.call(this),U.call(this),a.selectCell.toolbarChangeSelectorCell(),n.render(),i.reset(),a.reset()}function W(){var e=this.data,t=this.selector;e.clearClipboard(),t.hideClipboard()}function X(){var e=this.data,t=this.selector;e.copy(),t.showClipboard()}function G(){var e=this.data,t=this.selector;e.cut(),t.showClipboard()}function q(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e&&(W.call(t),Y.call(t))},n=this.data.paste(e,(function(e){return(0,p.xtoast)("Tip",e)}));return r(n),n}function $(){this.data.autofilter(),Y.call(this)}function K(){var e=this,t=this.toolbar,r=this.data;t.paintformatActive()&&(r.paintFormatChange((function(t,r){P.call(e,!0,t,r,!0,!0)})),W.call(this),t.paintformatToggle(),t.reset())}function Z(e,t,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0;this.selector.setBoxinner("none"),this.container.css("pointer-events","none");var f=n.getCellRectByXYWithNotTotalResult(e.layerX||e.clientX,e.layerY||e.clientY),h=f.ri,d=f.ci;if(t){var p=Q.call(this,n,r,i,u,l,e,a,c,h,d,s),v=p.rpos,g=p.ey,m=p.ex,y=r.showAutofill(h,d,v);(0,N.isOusideViewRange)(this.data.settings.view.height(),this.data.settings.view.width(),g,m,y)&&te.call(this,y,i,u,c,a,n)}else if(1===e.buttons&&!e.shiftKey){h=h<=0?0:h,d=d<=0?0:d;var b=n.viewRange().getMovePos(h,d);J.call(this,b,i,u,c,a,n),console.log("ri: ",h,"ci: ",d),P.call(this,!0,h,d,!0,!0)}}function Q(e,t,r,n,i,a,o,s,l,u,c){var f=e.getRect(t.range),h=new M.default(f),d=f.width+f.left,p=f.height+f.top+v.offsetTop,g=a.clientX-i.l-v.offsetLeft,m=a.clientY;return h.isLocInside(g,m)?(c=-1,t.arange=null):c=h.getUpDownLeftRight(g,m,d,p),{rpos:c,ex:g,ey:m}}function J(e,t,r,n,i,a){2===e?ee.call(this,1,t,r,i,a,n):6===e?ee.call(this,2,t,r,i,a,n):3===e?ee.call(this,4,t,r,i,a,n):5===e?ee.call(this,3,t,r,i,a,n):1===e?(ee.call(this,1,t,r,i,a,n),ee.call(this,4,t,r,i,a,n)):7===e?(ee.call(this,1,t,r,i,a,n),ee.call(this,3,t,r,i,a,n)):8===e?(ee.call(this,2,t,r,i,a,n),ee.call(this,4,t,r,i,a,n)):4===e&&(ee.call(this,2,t,r,i,a,n),ee.call(this,3,t,r,i,a,n))}function ee(e,t,r,n,i,a){if(1===Math.round(Math.random())){var o=0,s=0;if(1===e){var l=t.scroll().top;o=i.scroll.ri+1,t.move({top:l+n.getHeight(o)-1})}else if(2===e){var u=t.scroll().top;o=i.scroll.ri-1,t.move({top:0===o?0:u-n.getHeight(o)})}else if(4===e){var c=r.scroll().left;s=i.scroll.ci+1,r.move({left:c+a.getWidth(s)})}else if(3===e){var f=r.scroll().left;s=i.scroll.ci-1,r.move({left:f-a.getWidth(s)})}}}function te(e,t,r,n,i,a){var o=0,s=0;if(44===e){var l=t.scroll().top;o=a.scroll.ri+1,t.move({top:l+i.getHeight(o)-1})}else if(22===e){var u=t.scroll().top;(o=a.scroll.ri-1)>=0&&t.move({top:0===o?0:u-i.getHeight(o)})}else if(33===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var c=r.scroll().left;s=a.scroll.ci+1,r.move({left:c+n.getWidth(s)})}else if(11===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var f=r.scroll().left;s=a.scroll.ci-1,r.move({left:f-n.getWidth(s)})}}function re(e){var t=this,r=this.selector,n=this.data,a=this.sortFilter,o=this.editor,s=this.advice,l=e.offsetX,u=e.offsetY,c=e.target.className==="".concat(v.cssPrefix,"-selector-corner"),f=n.getCellRectByXY(l,u),h=f.left,d=f.top,g=f.width,m=f.height,y=f.ri,b=f.ci;o.setRiCi(y,b);var x=n.autoFilter;if(w.hideDirectionArr.call(this),s.el.hide(),x.includes2(y,b)&&x.getSet(n.exceptRowSet,y),x.includes(y,b)&&h+g-20<l&&d+m-20<u){var E=x.items(b,(function(e,t){return n.rows.getCell(e,t)}));return a.set(b,E,x.getFilter(b),x.getSort(b)),void a.setOffset({left:h,top:d+m+2})}if(!e.shiftKey){c?r.showAutofill(y,b):P.call(this,!1,y,b);var C=this.verticalScrollbar,k=this.horizontalScrollbar,N=n.rows,T=n.cols;y=n.scroll.ri+1;var O=function(e){for(var t=e.offsetTop,r=e.offsetLeft;e=e.offsetParent;)t+=e.offsetTop,r+=e.offsetLeft;return{t:t,l:r}}(this.el.el);(0,i.mouseMoveUp)(window,(function(i){console.log("dropdown"),ie.call(t),ne.call(t,i,c,r,n,C,N,e,O,k,T),Z.call(t,i,c,r,n,C,N,e,0,O,k,T)}),(function(){ie.call(t),c&&n.autofill(r.arange,"all",(function(e){return(0,p.xtoast)("Tip",e)}))&&(A.testValid.call(t),ae.call(t)),t.selector.setBoxinner("auto"),r.hideAutofill(),K.call(t),t.container.css("pointer-events","auto")}))}c||1!==e.buttons||e.shiftKey&&P.call(this,!0,y,b)}function ne(e,t,r,n,i,a,o,s,l,u){var c=this,f=setTimeout((function(){var f=setInterval((function(){Z.call(c,e,t,r,n,i,a,o,0,s,l,u)}),50);c.stopTimer2.push(f)}),200);this.stopTimer.push(f)}function ie(){this.stopTimer.clear(),this.stopTimer2.clear()}function ae(){this.data;var e=this.table;this.editor.display=!0;this.selector.arange=null,oe.call(this),e.render()}function oe(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}function se(e){we.call(this,{ri:-1,ci:0,left:60,top:0,width:100},e)}function le(){var e=this.data.getSelectedRect(),t=e.left+e.width+60,r=e.top+e.height+31;this.advice.el.el.style.top="".concat(r,"px"),this.advice.el.el.style.left="".concat(t,"px")}function ue(){var e=this.data,t=this.pictureOffsetLeft,r=this.pictureOffsetTop;this.data.pasteDirectionsArr.forEach((function(n){var i=e.getMoveRect(n.range);n.img.el.style.top="".concat(i.top+r+15*n.number+n.offsetTop,"px"),n.img.el.style.left="".concat(i.left+t+15*n.number+n.offsetLeft,"px")}))}function ce(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.selector,i=this.data,a=this.editor,o=j(n.indexes,2),s=o[0],l=o[1];s=-1===t?s:t,l=-1===r?l:r;var u=i.getMoveRect(new k.default(s,l,n.range.eri,n.range.eci)),c=this.getTableOffset(),f="top";u.top>c.height/2&&(f="bottom"),a.setOffset(u,f,e),setTimeout((function(){a.setCursorPos(a.editorText.getText().length)}))}function fe(){for(var e=0;e<this.selectors.length;e++){var t=this.selectors[e];t.selector.resetSelectorBRLAreaOffset(new k.default(t.ri,t.ci,t.ri,t.ci))}}function he(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.overlayerCEl=!0===e?(0,n.h)("div","".concat(v.cssPrefix,"-overlayer-content")).children(this.editor.el,this.selectorMoveEl.el,this.selector.el):(0,n.h)("div","".concat(v.cssPrefix,"-overlayer-content")).children(this.selectorMoveEl.el)}function de(){var e=this.editor,t=this.data,r=this.selector;ce.call(this),e.setCellEnd(t.getSelectedCell()),this.data.settings.showEditor&&r.el.hide(),W.call(this),setTimeout((function(){e.setCursorPos(e.editorText.getText().length)}))}function pe(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrolly(e,(function(){a.display=!1,i.resetBRLAreaOffset(),ue.call(t),le.call(t),fe.call(t),ce.call(t,!1),n.render()}))}function ve(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrollx(e,(function(){a.display=!1,i.resetBRTAreaOffset(),ue.call(t),le.call(t),fe.call(t),ce.call(t,!1),n.render()}))}function ge(){var e=this.data,t=this.table,r=e.viewRange2(),n=e.settings.style.autoAdapt,i=e.settings.ignoreRi,a=0;if(n){if(r.each((function(e,r){var n=t.getCellTextContent(e,r),a=t.getDrawBox(e,r);if(void 0!==n){var o=t.getCellTextStyle(e,r),s=Object.assign({},o.font);s.size=(0,m.getFontSizePxByPt)(s.size);var l=null;void 0!==o.format||(l=t.draw.selfAdaptionTxtWidth(n,s,a)),(void 0===t.autoAdaptList[r]||t.autoAdaptList[r]<l)&&e>i-1&&(t.autoAdaptList[r]=l)}})),t.autoAdaptList.length<0)return;for(var o=e.settings.ignore,s=0;s<t.autoAdaptList.length;s++){for(var l=!1,u=0;u<o.length;u++)s===o[u]&&(l=!0);!1===l&&(void 0===t.autoAdaptList[s]?(a+=50,e.cols.setWidth(s,50)):(t.autoAdaptList[s]<30&&(t.autoAdaptList[s]=30),e.cols.setWidth(s,t.autoAdaptList[s]))),a+=t.autoAdaptList[s]}a>0&&(e.settings.cellWidth=function(){return a})}}function me(){var e=this.data,t=this.table,r=e.viewRange2(),n=0,i=0,a=e.settings.row.height,o=e.settings.style.autoAdapt,s=0;if(o){r.each((function(r,o){var l=t.getCellTextContent(n,o),u=t.getCellTextStyle(r,o),c=Object.assign({},u.font);c.size=(0,m.getFontSizePxByPt)(c.size);var f=t.getDrawBox(n,o);if(n!==r&&void 0!==l){var h=e.rows.getHeight(n);if(a*i!==h){var d=c.size*i+2*f.padding+2*i;e.rows.setHeight(n,d),s+=d}else s+=h;i=0}else if(void 0!==l&&n===r&&void 0!==l){var p=t.draw.selfAdaptionHeight(f,l,c);(p>i||0===i)&&(i=p)}n=r}));var l=e.rows.getHeight(n),u=t.getCellTextStyle(l,0),c=Object.assign({},u.font);c.size=(0,m.getFontSizePxByPt)(c.size);var f=t.getDrawBox(n,0);if(a*i!==l&&s>0){var h=c.size*i+2*f.padding;s+=h,e.rows.setHeight(n,h)}else s>0&&(s+=l)}console.log(503,s),s>0&&(e.settings.view.height=function(){return s+40})}function ye(e){if(e.target.className==="".concat(v.cssPrefix,"-overlayer")){var t=this.selector,r=this.data,n=e.offsetX,i=e.offsetY,a=r.getCellRectByXY(n,i);t.selectCell.setData(a.ri,a.ci),t.selectCell.resetSelectOffset()}}function be(e,t){var r=e.ri,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setRowHeight(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),V.call(this),ce.call(this)}function we(e,t){var r=e.ci,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setColWidth(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),z.call(this),ce.call(this)}function xe(e,t){var r=this.errorPopUp;return e&&!r.open?(r.show(t),{state:!0,msg:t}):r.open?(r.hide(),{state:!0,msg:t}):{state:!1,msg:t}}function Ee(e,t,r,n){var i=r.text,a=r.style,o=this.data,s=this.editor,l=o.selectorCellText(e,t,i+"",n);return!(!l.state||!(l=xe.call(this,!0,l.msg)).state)||(o.setCellText(e,t,{text:i,style:a}),s.setRiCi(-1,-1),!1)}function Ce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table,i=this.editor,a=r.selector,o=a.ri,s=a.ci;i.ri!==o&&-1!==i.ri||i.ci!==s&&-1!==i.ci||(r.setSelectedCellText(e,t),"finished"===t&&n.render())}function ke(){this.data.throwFormula()}function Ne(e){var t=this.data;"insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e&&t.deleteCell("text"),W.call(this),Y.call(this)}function Te(e,t){var r=this.data;if("undo"===e)this.undo();else if("undoList"===e)t.setContent(r.historyList(1));else if("redoList"===e)t.setContent(r.historyList(2));else if("redo"===e)this.redo();else if("print"===e);else if("paintformat"===e)!0===t?X.call(this):W.call(this);else if("clearformat"===e)Ne.call(this,"delete-cell-format");else if("link"===e);else if("chart"===e);else if("autofilter"===e)$.call(this);else if("throwFormula"===e)ke.call(this);else if("close"===e){var n=r.getMax(),i=n.mri,a=n.mci;r.changeDataForCalc=new I.default({type:999,action:"重新计算",ri:-1,ci:-1,oldCell:{},newCell:r.rows.eachRange(new k.default(0,0,i,a))},this.data),Y.call(this)}else if("freeze"===e){var o=r.settings.showFreeze;if(t&&!0===o){var s=r.selector,l=s.ri,u=s.ci;this.freeze(l,u)}else this.freeze(0,0)}else"add"===e?(r.showEquation=!r.showEquation,Y.call(this,!0)):(r.setSelectedCellAttr(e,t),"border"===e&&Oe.call(this,"none"),"formula"===e&&de.call(this),Y.call(this))}function Oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1px solid rgb(75, 137, 255";this.selector.br.border(e)}function Me(e,t,r,n){this.data.setAutoFilter(e,t,r,n),Y.call(this)}function Ae(e){if(e.getLock()||2===e.state){var t=e.ri,r=e.ci,n=e.editorText.getText();return this.selector.indexes=[t,r],Ee.call(this,t,r,{text:n},"input")}return!1}function Se(e){var t=this;W.call(this),w.mountPaste.call(this,e,(function(){Y.call(t);var e=t.data;e.change(e.getData())}))}function Ie(){var e=this,t=this.overlayerEl,r=this.rowResizer,n=this.colResizer,a=this.verticalScrollbar,o=this.horizontalScrollbar,s=this.editor,l=this.contextMenu,u=this.data,c=this.toolbar,f=this.modalValidation,h=this.sortFilter;t.on("mousemove",(function(t){F.call(e,t)})).on("mousedown",(function(t){if(2===t.buttons)u.xyInSelectedRect(t.offsetX,t.offsetY)?(l.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):(l.hide(),re.call(e,t),setTimeout((function(){l.setPosition(t.offsetX,t.offsetY),t.stopPropagation()}),100)),ye.call(e,t);else if(2===t.detail){if(clearTimeout(e.render_timer),s.setMouseDownIndex([]),s.getLock())return;de.call(e)}else{if(s.getLock()||s.isCors){var r=null,n=0;(0,i.mouseMoveUp)(window,(function(i){e.container.css("pointer-events","none"),r&&r.selector&&r.selector.setBoxinner("none");var a=!0,o=u.merges,l=s.editorText.getText();if(Object.keys(o._).forEach((function(e){for(var t=o._[e],r=(0,C.cutStr)(l,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],u=(0,T.expr2xy)(i),c=(0,T.expr2xy)(s);t.sci>=u[0]&&t.sri>=u[1]&&t.eci<=c[0]&&t.eri<=c[1]&&(a=!1)}})),a&&1===i.buttons&&!i.shiftKey){var c=u.getCellRectByXY(i.offsetX,i.offsetY),f=c.ri,h=c.ci;if(r&&r.selector)r=b.makeSelector.call(e,f,h,e.selectors,!0,r.selector,!0),b.lockCells.call(e,t,r),e.mergeSelector=!0;else{for(var d=s.pos,p=s.editorText.getText(),v=0;v<e.selectors.length;v++){var g=e.selectors[v];if(g.erpx===(0,C.cuttingByPos)(p,d)){n=1,(r=g).selector.set(f,h,!0);break}}r=r||b.makeSelector.call(e,f,h,e.selectors,!0,null,!1)}}}),(function(){if(e.container.css("pointer-events","auto"),r&&r.selector&&r.selector.setBoxinner("auto"),!1===e.mergeSelector?(r&&!n&&e.selectors.push(r),b.lockCells.call(e,t,r)):r&&!n&&r.selector&&e.selectors.push(r),r)for(var i=0;i<e.selectors.length;i++){var a=e.selectors[i];if(a.className===r.className){a.erpx=r.erpx;break}}r=null,n=0,e.mergeSelector=!1}))}if(console.time("dbclick time1"),!s.getLock()&&!s.isCors){console.time("dbclick time2");var a=s.ri,o=s.ci,c=s.editorText.getText();if(-1!==a&&-1!==o&&"="===c[0])if(Ee.call(e,a,o,{text:c},"input"))return;console.timeEnd("dbclick time2"),s.clear()&&oe.call(e),e.selector.longTimeBefore(),re.call(e,t),ye.call(e,t),Oe.call(e),b.clearSelectors.call(e),ce.call(e)}A.testValid.call(e),console.timeEnd("dbclick time1")}})).on("mousewheel.stop",(function(t){B.call(e,t)})),(0,i.bindTouch)(t.el,{move:function(t,r){H.call(e,t,r)}}),c.change=function(t,r){return Te.call(e,t,r)},h.ok=function(t,r,n,i){return Me.call(e,t,r,n,i)},r.finishedFn=function(t,r){be.call(e,t,r)},n.finishedFn=function(t,r){we.call(e,t,r)},a.moveFn=function(t,r){pe.call(e,t,r)},o.moveFn=function(t,r){ve.call(e,t,r)},s.change=function(t,r){if("finish"===t)return u.editorChangeToHistory(s.editorText.getOldCell(),s.editorText.getRICI(),1),void s.editorText.setOldCell({},{ri:-1,ci:-1});if("@~esc"===r){var n=s.editorText.getOldCell(),i=n.text,a=n.formulas;s.editorText.setOldCell({text:"",formulas:""});var o=s.ri,l=s.ci;return u.setSelectedCell(i,"input",a,o,l),s.setText(""),b.clearSelectors.call(e),void s.clear(!0)}"format"===t&&u.setSelectedCellAttr(t,"rmb");var c=s.lock;s.setMouseDownIndex(u.rows,[]),b.editingSelectors.call(e,r),c&&"="!==r||"format"!==t&&Ce.call(e,r,t)},f.change=function(e){if("save"===e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];u.addValidation.apply(u,r)}else u.removeValidation()},l.itemClick=function(t){"validation"===t?f.setValue(u.getSelectedValidation()):"copy"===t?X.call(e):"cut"===t?G.call(e):"paste"===t||("paste-value"===t?q.call(e,"text"):"paste-format"===t?q.call(e,"format"):Ne.call(e,t))},(0,i.bind)(window,"resize",(function(){e.reload()})),(0,i.bind)(window,"click",(function(e){t.contains(e.target)})),(0,i.bind)(window,"copy",(function(t){x.mountCopy.call(e,t)})),(0,i.bind)(window,"cut",(function(t){console.log("cut",t),G.call(e),x.mountCopy.call(e,t);var r=e.data;r.history.add(r.getData())})),(0,i.bind)(window,"paste",(function(t){Se.call(e,t)})),(0,i.bind)(window,"keydown",(function(t){var r=t.keyCode||t.which,n=t.key,i=t.ctrlKey,a=t.shiftKey,o=t.metaKey;if(x.getChooseImg.call(e)){switch(console.log(r),r){case 8:u.history.addPic(u.getData().pictures,"add"),w.deleteImg.call(e)}(i||o)&&90===r&&(e.undo(),t.preventDefault())}else if(i||o)switch(r){case 90:e.undo(),t.preventDefault();break;case 89:e.redo(),t.preventDefault();break;case 67:if(x.getChooseImg.call(e))return;X.call(e),t.preventDefault();break;case 88:G.call(e),t.preventDefault();break;case 85:c.trigger("underline"),t.preventDefault();break;case 86:break;case 37:L.call(e,a,"row-first"),t.preventDefault();break;case 38:L.call(e,a,"col-first"),t.preventDefault();break;case 39:L.call(e,a,"row-last"),t.preventDefault();break;case 40:L.call(e,a,"col-last"),t.preventDefault();break;case 32:P.call(e,!1,-1,u.selector.ci,!1),t.preventDefault();break;case 66:c.trigger("font-bold");break;case 73:c.trigger("font-italic")}else{switch(r){case 32:a&&P.call(e,!1,u.selector.ri,-1,!1);break;case 27:l.hide(),W.call(e);break;case 37:L.call(e,a,"left"),t.preventDefault();break;case 38:L.call(e,a,"up"),t.preventDefault();break;case 39:L.call(e,a,"right"),t.preventDefault();break;case 40:L.call(e,a,"down"),t.preventDefault();break;case 9:if(Ae.call(e,s))return;s.clear(),L.call(e,!1,a?"left":"right"),t.preventDefault(),b.clearSelectors.call(e);break;case 13:if(Ae.call(e,s))return;s.clear(),ge.call(e),me.call(e),L.call(e,!1,a?"up":"down"),oe.call(e),t.preventDefault(),ce.call(e,!0),b.clearSelectors.call(e);break;case 8:Ne.call(e,"delete-cell-text")}"Delete"===n?(Ne.call(e,"delete-cell-text"),t.preventDefault()):r>=65&&r<=90||r>=48&&r<=57||r>=96&&r<=105||"="===t.key||113===r&&de.call(e)}}))}var Re=function(){function e(t,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var p=r.settings,m=p.view,b=p.showToolbar,w=p.showContextmenu,x=p.showEditor,C=p.rowWidth;this.el=(0,n.h)("div","".concat(v.cssPrefix,"-sheet")),this.toolbar=new f.default(r,m.width,!b),t.children(this.toolbar.el,this.el),this.pictureOffsetLeft=10,this.pictureOffsetTop=10,this.data=r,this.tableEl=(0,n.h)("canvas","".concat(v.cssPrefix,"-table")),this.rowResizer=new a.default(!1,r.rows.height),this.colResizer=new a.default(!0,r.cols.minWidth),this.verticalScrollbar=new o.default(!0),this.horizontalScrollbar=new o.default(!1),this.editor=new l.default(g.formulas,(function(){return i.getTableOffset()}),r.rows.height,r.cols.width,r,this),this.stopTimer=new S.default,this.stopTimer2=new S.default,this.website=new E.default(r,this.editor),this.modalValidation=new h.default,this.errorPopUp=new O.default,this.contextMenu=new u.default((function(){return i.getTableOffset()}),!w),this.selector=new s.default(r,this,!0),this.selectorMoveEl=new s.default(r,this,!1),this.advice=new y.default(r,this),this.overlayerCEl=he.call(this,x),this.selectors=[],this.container=(0,n.h)("div",""),this.selectorsEl=(0,n.h)("div","selector_clear").attr("id","selector_clear"),this.overlayerCEl.children(this.selectorsEl,this.container),this.mergeSelector=!1,this.overlayerEl=(0,n.h)("div","".concat(v.cssPrefix,"-overlayer")).children(this.overlayerCEl),this.sortFilter=new d.default,this.direction=!1,this.el.children(this.tableEl,this.rowResizer.el,this.overlayerEl.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.errorPopUp.el,this.sortFilter.el,this.advice.el,this.website.el,this.website.tableEl),this.table=new c.default(this.tableEl.el,r,this.editor),Ie.call(this),Y.call(this,!1),P.call(this,!1,0,0),C&&C.state&&se.call(this,C.width)}var t,r,m;return t=e,(r=[{key:"selectorMoveReset",value:function(){ce.call(this),this.editor.setRiCi(this.data.selector.ri,this.data.selector.ci),Y.call(this)}},{key:"getTable",value:function(){return{recalc:!1,table:this.table}}},{key:"clickCopyPaste",value:function(){var e=this.data,t=e.clickCopyPaste();t.enter&&(this.selector.arange=t.dstCellRange,e.clickAutofill(t.srcCellRange,t.dstCellRange,"all",(function(e){return(0,p.xtoast)("Tip",e)})),ae.call(this))}},{key:"setCellRange",value:function(e,t,r,n){this.data.paste(n);for(var i=0;i<e.length;i++){var a=e[i],o=a.ri,s=a.ci,l=(0,C.deepCopy)(t.rows.getCellOrNew(o,s));!1===r&&delete l.style,Ee.call(this,o,s,l,"style"),P.call(this,!0,o,s,!0,!0)}}},{key:"selectorEditorReset",value:function(e,t){var r=this.selector;ce.call(this,!0,e,t),this.editor.setRiCi(e,t),r.hide(),Y.call(this)}},{key:"loadData",value:function(e){return this.data.setData(e,this),Y.call(this),this}},{key:"freeze",value:function(e,t){return this.data.setFreeze(e,t),Y.call(this),this}},{key:"undo",value:function(){this.data.undo(this),Y.call(this)}},{key:"redo",value:function(){this.data.redo(),Y.call(this)}},{key:"reload",value:function(){return Y.call(this),this}},{key:"removeEvent",value:function(){i.remove.call(this)}},{key:"getRect",value:function(){var e=this.data;return{width:e.viewWidth(),height:e.viewHeight()}}},{key:"getTableOffset",value:function(){var e=this.data,t=e.rows,r=e.cols,n=this.getRect(),i=n.width,a=n.height;return{width:i-r.indexWidth,height:a-t.height,left:r.indexWidth,top:t.height}}}])&&_(t.prototype,r),m&&_(t,m),e}();t.default=Re},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUpperCase=function(e){return e=e.toString().toUpperCase()},t.default=void 0;var n,i=r(4),a=r(32),o=(n=r(294))&&n.__esModule?n:{default:n},s=r(25),l=r(295),u=r(296),c=r(2),f=r(33),h=r(3);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=5,g={fillStyle:"#f4f5f8"},m={fillStyle:"#fff",lineWidth:u.thinLineWidth,strokeStyle:"#e6e6e6"};function y(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new u.DrawBox(n,i,a,o,v)}function b(){var e=this.data.changeDataForCalc;return(0,h.isHave)(e)?{state:!0,data:e}:{state:!1,data:null}}function w(){var e=this.data,t=b.call(this);try{e.calc(e.rows,t.data)}catch(e){console.error("公式模块报错："+e)}t.state&&(e.changeDataForCalc=null)}function x(e,t){var r=this.draw,n=this.data,i=n.sortedRowMap,o=e;i.has(e)&&(o=i.get(e));var s=n.getCell(o,t);if((0,h.isHave)(s)){var u=n.getCellStyleOrDefault(o,t),f=y.call(this,e,t);f.bgcolor=u.bgcolor,void 0!==u.border&&(f.setBorders(u.border),r.strokeBorders(f));var d="";n.showEquation?(0,h.isHave)(s.formulas)&&(d=s.formulas):(0,h.isHave)(s.text)&&(d=s.text),r.rect2(f,(function(){var i=n.renderFormat(u,s,o,t,!1);d=i.state?i.cellText:d;var h=Object.assign({},u.font);h.size=(0,a.getFontSizePxByPt)(h.size);var p=n.settings,v=p.ignore,g=p.minus,m=u.color;!0===g&&(0,l.isMinus)(d)&&(m="red");var y=u.underline,b="www"===(d+="").substr(0,3).toLowerCase()?"http://"+d:d;(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?$/.test(b)||function(e){return!!(e+="")&&1===c.look.indexOf(e.split("!")[0])}(s.text))&&(m="#4b89ff",y=!0),r.text(d,f,{align:u.align,valign:u.valign,font:h,color:m,strike:u.strike,underline:y,ignore:v,cindex:t},u.textwrap),n.validations.getError(e,t)&&r.error(f)}))}}function E(){for(var e=this.draw,t=this.data.autoFilter.flex,r=0;r<t.length;r++){for(var n=t[r],i=n.ri,a=n.ci,o=n.state,s=0,l=0;l<r;l++){var u=t[l],c=u.set_total;!0===u.state&&(s+=c)}var f=y.call(this,i,a);e.dropUp(f,o,25*s)}}function C(e){var t=this,r=this.data,n=this.draw;if(e){var i=r.autoFilter;if(!i.active())return;var a=i.hrange();e.intersects(a)&&a.each((function(e,r){var i=y.call(t,e,r);n.dropdown(i)}))}}function k(e,t,r,n,i){var a=this,o=this.draw,s=this.data;o.save(),o.translate(t,r).translate(n,i);var l=s.exceptRowSet;o.save(),e.each((function(e,t){x.call(a,e,t)}),(function(e){return function(e){var t=l.has(e);if(t){var r=s.rows.getHeight(e);o.translate(0,-r)}return!t}(e)})),o.restore();var u=new Set;o.save(),s.eachMergesInView(e,(function(e){var t=e.sri,r=e.sci,n=e.eri;if(l.has(t)){if(!u.has(t)){u.add(t);var i=s.rows.sumHeight(t,n+1);o.translate(0,-i)}}else x.call(a,t,r)})),o.restore(),C.call(this,e),E.call(this),o.restore()}function N(e,t,r,n){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,r,n),i.restore()}function T(e,t,r,n,a,o){var s=this,l=this.draw,c=this.data,f=t.h,h=t.w,d=o+n,p=a+r;l.save(),l.attr(g),"all"!==e&&"left"!==e||l.fillRect(0,d,r,f),"all"!==e&&"top"!==e||l.fillRect(p,0,h,n);var v=c.selector.range,m=v.sri,y=v.sci,b=v.eri,w=v.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat((0,u.npx)(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:(0,u.thinLineWidth)(),strokeStyle:"#e6e6e6"}),"all"!==e&&"left"!==e||(c.rowEach(t.sri,t.eri,(function(e,t,n){var i=d+t,a=e;l.line([0,i],[r,i]),m<=a&&a<b+1&&N.call(s,0,i,r,n),l.fillText(a+1,r/2,i+n/2)})),l.line([0,f+d],[r,f+d]),l.line([r,d],[r,f+d])),"all"!==e&&"top"!==e||(c.colEach(t.sci,t.eci,(function(e,t,r){var a=p+t,o=e;l.line([a,0],[a,n]),y<=o&&o<w+1&&N.call(s,a,0,r,n),l.fillText((0,i.stringAt)(o),a+r/2,n/2)})),l.line([h+p,0],[h+p,n]),l.line([0,n],[h+p,n])),l.restore()}function O(e,t){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),r.restore()}function M(e,t,r,n,i){var a=e.sri,o=e.sci,s=e.eri,l=e.eci,u=e.w,c=e.h,f=this.draw,h=this.data,d=h.settings;f.save(),f.attr(m).translate(t+n,r+i),f.clearRect(0,0,u,c),d.showGrid?(h.rowEach(a,s,(function(e,t,r){e!==a&&f.line([0,t],[u,t]),e===s&&f.line([0,t+r],[u,t+r])})),h.colEach(o,l,(function(e,t,r){e!==o&&f.line([t,0],[t,c]),e===l&&f.line([t+r,0],[t+r,c])})),f.restore()):f.restore()}function A(e,t,r,n){var i=this.draw,a=this.data,o=a.viewWidth()-e,s=a.viewHeight()-t;i.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,n],[o,n]),i.line([r,0],[r,s]),i.restore()}var S=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.draw=new u.Draw(t,r.viewWidth(),r.viewHeight()),this.editor=n,this.data=r,this.timer=null,this.autoAdaptList=[]}var t,r,n;return t=e,(r=[{key:"getCellTextContent",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;n.has(e)&&(i=n.get(e));var a=r.getCell(i,t);if(null!==a)return o.default.render(a.text||"",s.formulam,(function(e,t){return r.getCellTextOrDefault(t,e)}))}},{key:"getDrawBox",value:function(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new u.DrawBox(n,i,a,o,v)}},{key:"getCellTextStyle",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;return n.has(e)&&(i=n.get(e)),r.getCellStyleOrDefault(i,t)}},{key:"render",value:function(){var e=this.data,t=e.rows,r=e.cols,n=e.viewRange();w.call(this),this.clear(),this.draw.resize(e.viewWidth(),e.viewHeight());var i=e.freezeTotalWidth(),a=e.freezeTotalHeight(),o=e.scroll,s=o.x,l=o.y,u=r.indexWidth,c=t.height;M.call(this,n,u,c,i,a),k.call(this,n,u,c,-s,-l),T.call(this,"all",n,u,c,i,a),O.call(this,u,c);var h=d(e.freeze,2),p=h[0],v=h[1];if(p>0||v>0){if(p>0){var g=n.clone();g.sri=0,g.eri=p-1,g.h=a,M.call(this,g,u,c,i,0),k.call(this,g,u,c,-s,0),T.call(this,"top",g,u,c,i,0)}if(v>0){var m=n.clone();m.sci=0,m.eci=v-1,m.w=i,M.call(this,m,u,c,0,a),T.call(this,"left",m,u,c,0,a),k.call(this,m,u,c,0,-l)}var y=e.freezeViewRange();M.call(this,y,u,c,0,0),T.call(this,"all",y,u,c,0,0),k.call(this,y,u,c,0,0),A.call(this,u,c,i,a)}f.testValid.call(this)}},{key:"clear",value:function(){this.draw.clear()}}])&&p(t.prototype,r),n&&p(t,n),e}();t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiply=u,t.formatNumberRender=t.baseFormats=t.formatm=void 0;var n=r(11),i=r(3);function a(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=function(e){return e},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!(0,i.isHave)(e)||!(0,i.isNumber)(e))return e;if(/^(-?\d*.?\d*)$/.test(e)){var r=-1===t?e.toString():Number(e).toFixed(t).toString(),n=r.split("\\."),o=a(n),s=o[0],l=(o.slice(1),s.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"));return"NaN"===l?e:l}return e};t.formatNumberRender=s;var l=[{key:"normal",title:(0,n.tf)("format.normal"),type:"string",render:o},{key:"number",title:(0,n.tf)("format.number"),type:"number",label:"1,000.12",render:s},{key:"percent",title:(0,n.tf)("format.percent"),type:"number",label:"10.12%",render:function(e){var t=u(e,100),r="".concat(t);return"".concat(r,"%")}},{key:"rmb",title:(0,n.tf)("format.rmb"),type:"number",label:"￥10.00",render:function(e){return"￥".concat(s(e))}},{key:"date",title:(0,n.tf)("format.date"),type:"date",label:"2009-01-01",render:o},{key:"datetime",title:(0,n.tf)("format.datetime"),type:"datetime",label:"2009年01月01日",render:o}];function u(e,t,r){return f(e,t,r,"multiply")}function c(e){var t,r={times:1,num:0},n=e<0;if(t=e,Math.floor(t)===t)return r.num=e,r;var i="".concat(e),a=i.indexOf("."),o=i.substr(a+1).length,s=Math.pow(10,o),l=parseInt(Math.abs(e)*s+.5,10);return r.times=s,n&&(l=-l),r.num=l,r}function f(e,t,r,n){var i=c(e),a=c(t),o=i.num,s=a.num,l=i.times,u=a.times,f=l>u?l:u;switch(n){case"add":return(l===u?o+s:l>u?o+s*(l/u):o*(u/l)+s)/f;case"subtract":return(l===u?o-s:l>u?o-s*(l/u):o*(u/l)-s)/f;case"multiply":return o*s/(l*u);case"divide":return o/s*(u/l)}}t.baseFormats=l;var h={};t.formatm=h,l.forEach((function(e){h[e.key]=e}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2),a=r(11);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=s(this,l(t).call(this,"div","".concat(i.cssPrefix,"-button ").concat(n)))).child((0,a.t)("button.".concat(e))),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),t}(n.Element);t.default=c},,,,function(e,t,r){"use strict";e.exports=function(e){var t=e.match(/^'(.*)'$/);return t?t[1]:e}},function(e,t,r){"use strict";var n=r(22),i=r(55),a=r(38);e.exports=function(e,t,r){var o;return isNaN(e)?"TRUE"===e?o=new n(1):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+:[A-Z]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+:[A-Z]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+$/)?((o=new i(e.trim().replace(/\$/g,""),t)).end_pst=r,o.buffer=e,o.start_pst=r-e.length):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+$/)?((o=new i(e.trim().replace(/\$/g,""),t)).end_pst=r,o.buffer=e,o.start_pst=r-e.length):"string"!=typeof e||isNaN(e.trim().replace(/%$/,""))?(o=e).end_pst=r:o=new n(+e.trim().replace(/%$/,"")/100):o=new n(+e),o}},function(e,t,r){"use strict";var n=r(53);e.exports=function(e,t){var r=this;this.name="RefValue",this.str_expression=e,this.formula=t,r.parseRef=function(){var r,i,a;if(-1!=e.indexOf("!")){var o=e.split("!");i=n(o[0]),r=t.wb.Sheets[i],a=o[1]}else r=t.sheet,i=t.sheet_name,a=e;if(!r)throw Error("Sheet "+i+" not found.");return{sheet:r,sheet_name:i,cell_name:a,cell_full_name:i+"!"+a}},this.calc=function(){var e=r.parseRef(),n=e.sheet,i=e.cell_name,a=e.cell_full_name,o=n[i];if(!o)return null;var s=t.formula_ref[a];if(!s){if("e"===o.t)throw console.log("ref is an error with no formula",i),new Error(o.w);return o.v}if("new"===s.status){if(t.exec_formula(s),"e"===o.t)throw console.log("ref is an error with new formula",a),new Error(o.w);return o.v}if("working"===s.status)throw new Error("Circular ref");if("done"===s.status){if("e"===o.t)throw console.log("ref is an error after formula eval"),new Error(o.w);return o.v}}}},function(e,t,r){"use strict";var n=[r(231),r(235),r(61),r(236),r(27),r(39),r(41),r(237),r(40),r(238),r(28),r(60),r(239)];for(var i in n){var a=n[i];for(var o in a)t[o]=t[o]||a[o]}},,,,function(e,t,r){"use strict";var n=r(15),i=r(58);t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var r=!1,n=arguments[t],i=0;i<e.length&&!(r=e[i]===n);++i);r||e.push(n)}return e},t.FLATTEN=n.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){try{for(var r=t.split("."),n=e,i=0;i<r.length;++i){var a=r[i];if("]"===a[a.length-1]){var o=a.indexOf("["),s=a.substring(o+1,a.length-1);n=n[a.substring(0,o)][s]}else n=n[a]}return n}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){var e=n.flatten(arguments);return e.filter((function(e){return"number"==typeof e}))},t.NUMERAL=function(e,t){return i(e).format(t)}},function(e,t,r){"use strict";var n=r(9),i=r(59).jStat,a=r(39),o=r(15),s=r(234);function l(e){return/^[01]{1,10}$/.test(e)}function u(e){return e=(e=e.toString()).replace("I","i").replace("J","j")}t.BESSELI=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:s.besseli(e,t)},t.BESSELJ=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:s.besselj(e,t)},t.BESSELK=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:s.besselk(e,t)},t.BESSELY=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:s.bessely(e,t)},t.BIN2DEC=function(e){if(!l(e))return n.num;var t=parseInt(e,2),r=e.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!l(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var i=parseInt(e,2).toString(16);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.BIN2OCT=function(e,t){if(!l(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var i=parseInt(e,2).toString(8);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.BITAND=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e&t},t.BITLSHIFT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0?n.num:Math.floor(e)!==e?n.num:e>0xffffffffffff?n.num:Math.abs(t)>53?n.num:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e|t},t.BITRSHIFT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0?n.num:Math.floor(e)!==e?n.num:e>0xffffffffffff?n.num:Math.abs(t)>53?n.num:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e^t},t.COMPLEX=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t))return n.value;if("i"!==(r=(r=void 0===r?"i":r).toLowerCase())&&"j"!==r)return n.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?r:t.toString()+r;if(0===t)return e.toString();var i=t>0?"+":"";return e.toString()+i+(1===t?r:t.toString()+r)},t.CONVERT=function(e,t,r){if((e=o.parseNumber(e))instanceof Error)return e;for(var i,a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=t.toLowerCase(),h=r.toLowerCase(),d=1,p=1,v=0;v<a.length;v++)i=null===a[v][2]?[]:a[v][2],(a[v][1].toLowerCase()===f||i.indexOf(t)>=0)&&(u=a[v]),(a[v][1].toLowerCase()===h||i.indexOf(r)>=0)&&(c=a[v]);if(null===u){var g=s[t.substring(0,2)],m=l[t.substring(0,1)];"da"===t.substring(0,2)&&(m=["dekao",10,"da"]),g?(d=g[2],f=t.substring(2)):m&&(d=m[1],f=t.substring(m[2].length));for(var y=0;y<a.length;y++)i=null===a[y][2]?[]:a[y][2],(a[y][1]===f||i.indexOf(f)>=0)&&(u=a[y])}if(null===c){var b=s[r.substring(0,2)],w=l[r.substring(0,1)];"da"===r.substring(0,2)&&(w=["dekao",10,"da"]),b?(p=b[2],h=r.substring(2)):w&&(p=w[1],h=r.substring(w[2].length));for(var x=0;x<a.length;x++)i=null===a[x][2]?[]:a[x][2],(a[x][1]===h||i.indexOf(h)>=0)&&(c=a[x])}return null===u||null===c?n.na:u[3]!==c[3]?"F"==t&&"C"==r?(e-32)/1.8:"C"==t&&"F"==r?1.8*e+32:n.na:e*u[6]*d/(c[6]*p)},t.DEC2BIN=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return n.num;if(e<0)return"1"+a.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var r=parseInt(e,10).toString(2);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DEC2HEX=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return n.num;if(e<0)return(1099511627776+e).toString(16);var r=parseInt(e,10).toString(16);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DEC2OCT=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return n.num;if(e<0)return(1073741824+e).toString(8);var r=parseInt(e,10).toString(8);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DELTA=function(e,t){return t=void 0===t?0:t,e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e===t?1:0},t.ERF=function(e,t){return t=void 0===t?0:t,e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:i.erf(e)},t.ERF.PRECISE=function(e){return isNaN(e)?n.value:window.jsSpreadsheet.AllFormulas.ERF(e)},t.ERFC=function(e){return isNaN(e)?n.value:i.erfc(e)},t.ERFC.PRECISE=function(e){return isNaN(e)?n.value:window.jsSpreadsheet.AllFormulas.ERFC(e)},t.GESTEP=function(e,t){return t=t||0,e=o.parseNumber(e),o.anyIsError(t,e)?e:e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=10===e.length&&"f"===e.substring(0,1).toLowerCase(),i=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(i<-512||i>511)return n.num;if(r)return"1"+a.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);var o=i.toString(2);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?a.REPT("0",t-o.length)+o:n.num},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return n.num;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);var i=r.toString(8);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.ROWS=function(e){return"string"==typeof e&&(e=o.strToMatrix(e)),e instanceof Array?0===e.length?0:i.rows(e):n.value},t.IMABS=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:Math.sqrt(Math.pow(r,2)+Math.pow(i,2))},t.IMAGINARY=function(e){if(void 0===(e=u(e))||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return t>=0||r>=0?a?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:-Number(e.substring(r+1,e.length-1)):n.num:a?isNaN(e.substring(0,e.length-1))?n.num:e.substring(0,e.length-1):isNaN(e)?n.num:0},t.IMARGUMENT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:0===r&&0===i?n.div0:0===r&&i>0?Math.PI/2:0===r&&i<0?-Math.PI/2:0===i&&r>0?0:0===i&&r<0?-Math.PI:r>0?Math.atan(i/r):r<0&&i>=0?Math.atan(i/r)+Math.PI:Math.atan(i/r)-Math.PI},t.IMCONJUGATE=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",0!==i?t.COMPLEX(r,-i,a):e},t.IMCOS=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(r)*(Math.exp(i)+Math.exp(-i))/2,-Math.sin(r)*(Math.exp(i)-Math.exp(-i))/2,a)},t.IMCOSH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(i)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(i)*(Math.exp(r)-Math.exp(-r))/2,a)},t.IMCOT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,r){var i=t.IMREAL(e),a=t.IMAGINARY(e),s=t.IMREAL(r),l=t.IMAGINARY(r);if(o.anyIsError(i,a,s,l))return n.value;var u=e.substring(e.length-1),c=r.substring(r.length-1),f="i";if("j"===u?f="j":"j"===c&&(f="j"),0===s&&0===l)return n.num;var h=s*s+l*l;return t.COMPLEX((i*s+a*l)/h,(a*s-i*l)/h,f)},t.IMEXP=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);a="i"===a||"j"===a?a:"i";var s=Math.exp(r);return t.COMPLEX(s*Math.cos(i),s*Math.sin(i),a)},t.IMLN=function(e){var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i)),Math.atan(i/r),a)},t.IMLOG10=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i))/Math.log(10),Math.atan(i/r)/Math.log(10),a)},t.IMLOG2=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i))/Math.log(2),Math.atan(i/r)/Math.log(2),a)},t.IMPOWER=function(e,r){e=u(e),r=o.parseNumber(r);var i=t.IMREAL(e),a=t.IMAGINARY(e);if(o.anyIsError(r,i,a))return n.value;var s=e.substring(e.length-1);s="i"===s||"j"===s?s:"i";var l=Math.pow(t.IMABS(e),r),c=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(r*c),l*Math.sin(r*c),s)},t.IMPRODUCT=function(){for(var e=arguments[0],r=1;r<arguments.length;r++){var i=t.IMREAL(e),a=t.IMAGINARY(e),s=t.IMREAL(arguments[r]),l=t.IMAGINARY(arguments[r]);if(o.anyIsError(i,a,s,l))return n.value;e=t.COMPLEX(i*s-a*l,i*l+a*s)}return e},t.IMREAL=function(e){if(void 0===(e=u(e))||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return t>=0||r>=0?a?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:Number(e.substring(0,r)):n.num:a?isNaN(e.substring(0,e.length-1))?n.num:0:isNaN(e)?n.num:e},t.IMSEC=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.sin(r)*(Math.exp(i)+Math.exp(-i))/2,Math.cos(r)*(Math.exp(i)-Math.exp(-i))/2,a)},t.IMSINH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(i)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(i)*(Math.exp(r)+Math.exp(-r))/2,a)},t.IMSQRT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);a="i"===a||"j"===a?a:"i";var s=Math.sqrt(t.IMABS(e)),l=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),a)},t.IMCSC=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.num:t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.num:t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,r){e=u(e),r=u(r);var i=t.IMREAL(e),a=t.IMAGINARY(e),s=t.IMREAL(r),l=t.IMAGINARY(r);if(o.anyIsError(i,a,s,l))return n.value;var c=e.substring(e.length-1),f=r.substring(r.length-1),h="i";return"j"===c?h="j":"j"===f&&(h="j"),t.COMPLEX(i-s,a-l,h)},t.IMSUM=function(e){e=u(e);for(var r=o.flatten(arguments),i=r[0],a=1;a<r.length;a++){var s=t.IMREAL(i),l=t.IMAGINARY(i),c=t.IMREAL(r[a]),f=t.IMAGINARY(r[a]);if(o.anyIsError(s,l,c,f))return n.value;i=t.COMPLEX(s+c,l+f)}return i},t.IMTAN=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV(t.IMSIN(e),t.IMCOS(e))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=10===e.length&&"7"===e.substring(0,1),i=r?parseInt(e,8)-1073741824:parseInt(e,8);if(r)return"1"+a.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);var o=i.toString(2);return o.length>=10?o.slice(o.length-10,o.length):void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?a.REPT("0",t-o.length)+o:n.num},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return n.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);var i=r.toString(16);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=t.findAllNeedCalcCell(),i={},a=[];for(var o in e.Sheets)for(var s=e.Sheets[o],l=0;l<n.length;l++){var u=n[l],c=i[o+"!"+u]={formula_ref:i,wb:e,sheet:s,sheet_name:o,cell:s[u],name:u,status:"new",exec_formula:r};a.push(c)}return a}},function(e,t,r){"use strict";var n=r(3);t.trans_params=function(e){var t=new RegExp("{(.*?)}","g"),r=e.f.match(t);if(null!=r)for(var n=0;n<r.length;n++){var i=r[n],a="'"+i+"'";e.f=e.f.replace(i,a)}return e},t.trans_sheet=function(e){return Object.keys(e).forEach((function(t){0===e[t].v&&""===e[t].f&&(e[t].v="default_0")})),e},t.recover_sheet=function(e){return Object.keys(e).forEach((function(t){"default_0"===e[t].v&&(n.isHave(e[t].f)||(e[t].f=""),e[t].v=0)})),e},t.strim=function(e){return e.replace(/\s+$/,"").replace(/^\s+/,"")},t.trans_formula=function(e){var t={FLOOR:"FLOORMATH",VAR:"VARA","WORKDAY.INTL":"WORKDAYINTL"};for(var r in t){var n=t[r];e.indexOf(n)<0&&e.indexOf(r)>=0&&e.indexOf(r+".")<=0&&(e=e.replace(r,n))}e=e.replace("_XLFN.","");var i=new RegExp('"(.*?)"',"g"),a=e.match(i);if(0===e.indexOf("=")&&(e=e.toUpperCase(),null!=a))for(r=0;r<a.length;r++){var o=a[r].toUpperCase();e.indexOf(o)>=0&&(e=e.replace(o,a[r]))}return e}},,function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(249),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formula=t,this.ast=""}var t,r,a;return t=e,(r=[{key:"preProcess",value:function(){this.formula=this.formula.replace(/=/g,""),this.formula=this.formula.replace(/:/g,"$$$"),this.formula=this.formula.replace(/""""/g,""),this.formula=this.formula.replace(/!/g,""),this.formula=this.formula.replace(/{/g,""),this.formula=this.formula.replace(/}/g,""),this.formula=this.formula.replace(/#/g,""),this.formula=this.formula.replace(/\./g,"a"),this.formula=this.formula.replace(/[0-9][0-9]*/g,"a"),this.formula=this.formula.replace(/\“/g,'"'),this.formula=this.formula.replace(/\（/g,"("),this.formula=this.formula.replace(/\）/g,")"),this.formula=this.formula.replace(/\”/g,'"'),this.formula=this.formula.replace(/\%/g,""),this.formula=this.formula.replace(/\,/g,""),this.formula=this.formula.replace(/\，/g,""),this.formula=this.formula.replace(/"([\s\S]+)"""/g,""),this.formula=this.formula.replace(/""/,"")}},{key:"parse",value:function(){this.preProcess();var e=this.formula;this.ast=i.parse(e)}},{key:"ignoreSpace",value:function(){}}])&&n(t.prototype,r),a&&n(t,a),e}();t.default=a},,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(3),i=r(42),a=r(26);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cell=t}var t,r,s;return t=e,(r=[{key:"renderFormat",value:function(e,t,r,i,a){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(e.format))return{cellText:"",state:!1};var o=this.cell,s="";if(e.format){var l=i.tryParseToNum(o,t,r);return l.state?a?"date"===l.style||"datetime"===l.style?s=l.text:l.state=!1:s=l.text:(!1===(0,n.isHave)(o.text)&&(o.text=""),s=o.text),{cellText:s,state:l.state}}return{cellText:s,state:!1}}},{key:"getCellDataType",value:function(e,t){var r=t.isDate,o=t.isNumber,s=this.cell,l=!0;(0,n.isHave)(s.formulas)||(s.formulas=""),(0,n.isHave)(s.text)||(s.text="");var u=""!==s.formulas?s.formulas+"":s.text+"",c=1*(u=u.replace(/,/g,""));return!c&&0!==c||"number"!=typeof c||isNaN(c)||!0!==/^\d+$/.test(u)?u&&!0===l&&(0,i.isFormula)(u)?(l=!0,o=!1,r=!1,s.type="na"):u&&-1!==u.search((0,a.str2Re)(a.datePattern2),"")?(!0===r?(l=!1,o=!1,r=!0):(l=!1,o=!1,r=!1),s.type="date"):(l=!1,o=!1,r=!1,s.type="other"):(!0===o?(o=!0,l=!1,r=!1):(l=!1,o=!1,r=!1),s.type="number"),s.tmp=u,e.push(s),{nA:l,isDate:r,isNumber:o}}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="move"}var t,r,i;return t=e,(r=[{key:"move",value:function(e){return this.range=e,this.state="move",this}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.selectorHeightBorderWidth=void 0;var n=r(1),i=r(2),a=r(6),o=r(10),s=r(4),l=r(8),u=f(r(286)),c=f(r(30));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}t.selectorHeightBorderWidth=3;var v=10,g=function(){function e(t,r,a){var o=this;h(this,e),this.cornerEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-corner")),this.data=t,this.sheet=a,this._selector=r,this.l=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():o.moveEvent(1)})),this.r=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-r")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():o.moveEvent(2)})).on("click",(function(e){2===e.detail&&e.stopPropagation()})),this.t=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-t")).on("mousedown.stop",(function(e){e.detail,e.stopPropagation(),o.moveEvent(3)})),this.b=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-b")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():o.moveEvent(4)})),this.cornerEl.on("mousedown",(function(e){2===e.detail&&(a.clickCopyPaste(),e.stopPropagation())})),this.boxinner=(0,n.h)("div","".concat(i.cssPrefix,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.areaEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-area")).children(this.cornerEl,this.boxinner).hide(),this.clipboardEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-clipboard")).hide(),this.autofillEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-autofill")).hide(),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-selector")).css("z-index","".concat(v)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),v+=1}return p(e,[{key:"border",value:function(e){this.areaEl.css("border",e)}},{key:"longTimeBefore",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.boxinner.hide(),setTimeout((function(){e.boxinner.show()}),t)}},{key:"moveEvent",value:function(e){console.log(60);var t=this.data,r=this._selector,n=this.sheet,i=t.selector,u=r.range,f=u.sri,h=u.sci,d=u.eri,p=u.eci,v=u.w,g=u.h,m=new a.CellRange(f,h,d,p,v,g),y=new a.CellRange(f,h,d,p,v,g),b=n.selectorMoveEl;b.set(-1,-1,!0),b.hide(),(0,o.mouseMoveUp)(window,(function(e){n.container.css("pointer-events","none"),r.setBoxinner("none");var i=t.getCellRectByXY(e.layerX,e.layerY),o=i.ri,s=i.ci;if(-1!==o&&-1!==s){(y=new a.CellRange(f,h,d,p,v,g)).move(o,s);var l=t.getMoveRect(y);b.range=y,b.setMove(l),b.el.show()}}),(function(){var e=t.rows,a=[],o=[],u=[];m.each((function(t,r){console.log(e.getCell(t,r),t,r);var n=e.getCell(t,r),i=new c.default(t,r,(0,l.deepCopy)(n||{}),"".concat((0,s.xy2expr)(r,t),":").concat((0,s.xy2expr)(r,t))),o=new c.default(t,r,(0,l.deepCopy)(n||{}),"".concat((0,s.xy2expr)(r,t)));a.push(i),u.push(o)})),y.each((function(t,r){var n=new c.default(t,r,(0,l.deepCopy)(e.getCell(t,r)||{}),(0,s.xy2expr)(r,t));o.push(n)})),t.cutPaste(m,y,!1),n.container.css("pointer-events","auto"),r.setBoxinner("auto"),b.hide();var f=t.getMoveRect(y);i.range=y,i.ci=y.sci,i.ri=y.sri,r.indexes=[i.ri,i.ci],r.moveIndexes=[y.sri,y.sci],r.range=y,r.setMove(f),n.selector.selectCell.setData(y.sri,y.sci),console.time("move"),e.moveChange(a,o,u),console.timeEnd("move"),n.selectorMoveReset()}))}},{key:"setCss",value:function(e){this.areaEl.css("border","2px dashed ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.cornerEl.css("pointer-events",e)}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-3+.8,height:i-3+.8,left:t-.8,top:r-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-3,height:i-3,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function m(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,s=e.l,l=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>s&&(f-=o.x);var h=n-c;return c>l&&(h-=o.y),{left:f,top:h,width:i,height:a}}function y(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalWidth(),u=r-l;return l>a&&(u-=s.x),{left:u,top:o,width:n,height:i}}function b(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalHeight(),u=r-l;return l>o&&(u-=s.y),{left:a,top:u,width:n,height:i}}function w(e){this.br.setAreaOffset(m.call(this,e))}function x(e){this.tl.setAreaOffset(e)}function E(e){this.t.setAreaOffset(y.call(this,e))}function C(e){this.l.setAreaOffset(b.call(this,e))}function k(e){this.l.setClipboardOffset(b.call(this,e))}function N(e){this.br.setClipboardOffset(m.call(this,e))}function T(e){this.tl.setClipboardOffset(e)}function O(e){this.t.setClipboardOffset(y.call(this,e))}function M(e){w.call(this,e),x.call(this,e),E.call(this,e),C.call(this,e)}function A(e){N.call(this,e),T.call(this,e),O.call(this,e),k.call(this,e)}var S=function(){function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];h(this,e),this.data=t,this.br=new g(t,this,r),this.t=new g(t,this,r),this.l=new g(t,this,r),this.tl=new g(t,this,r),this.sheet=r,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,n.h)("div","".concat(i.cssPrefix,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),a?(this.selectCell=new u.default(t,a),this.el.child(this.selectCell.el)):this.selectCell=new u.default(t,a),this.lastri=-1,this.lastci=-1,v+=1}return p(e,[{key:"longTimeBefore",value:function(){this.tl.longTimeBefore(),this.br.longTimeBefore(),this.t.longTimeBefore(),this.l.longTimeBefore()}},{key:"setCss",value:function(e){this.br.setCss(e),this.t.setCss(e),this.l.setCss(e),this.tl.setCss(e)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br;this.selectCell.resetSelectOffset();var a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();M.call(this,e),A.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();w.call(this,e),E.call(this,e),N.call(this,t),O.call(this,t),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();w.call(this,e),C.call(this,e),N.call(this,t),k.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();w.call(this,t),C.call(this,t),N.call(this,r),k.call(this,r),this.resetOffset()}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var s=e,l=t;e<0&&(s=0),t<0&&(l=0),n.selector.setIndexes(s,l),this.indexes=[s,l]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"autoFilterRef",value:function(){console.log(this.range)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this.data);r&&(this.lastri=e,this.lastci=t),this.range=n.calSelectedRangeByEnd(e,t),M.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"reset",value:function(){var e=this.data.selector.range,t=e.eri,r=e.eci,n=e.sci,i=e.sri;this.set(i,n),this.setEnd(t,r,!0,!0)}},{key:"setMove",value:function(e){M.call(this,e)}},{key:"showAutofill",value:function(e,t,r){if(-1!==e||-1!==t){var n=this.range,i=n.sri,o=n.sci,s=n.eri,l=n.eci,u=0,c=e,f=t;if(2===r)u=11,this.arange=new a.CellRange(i,f,s,o-1);else if(4===r)u=22,this.arange=new a.CellRange(c,o,i-1,l);else if(3===r)u=33,this.arange=new a.CellRange(i,l+1,s,f);else{if(1!==r)return this.arange=null,u;u=44,this.arange=new a.CellRange(s+1,o,c,l)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var d=this.br,p=this.l,v=this.t,g=this.tl;d.showAutofill(m.call(this,h)),p.showAutofill(b.call(this,h)),v.showAutofill(y.call(this,h)),g.showAutofill(h)}return u}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();A.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();t.default=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=r(10),o=r(2),s=(n=r(6))&&n.__esModule?n:{default:n};function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){e.preventDefault(),e.stopPropagation();var t=this.filterItems;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1,this.el.el.scrollTop=this.el.el.scrollHeight),this.el.el.scrollTop=33*(this.itemIndex-9),t[this.itemIndex].toggle())}function f(e){e.stopPropagation();var t=this.filterItems;t.length<=0||t.length<this.itemIndex||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0,this.el.el.scrollTop=0),this.el.el.scrollTop=33*(this.itemIndex-9),console.log(t.length),t[this.itemIndex].toggle())}function h(e){e.preventDefault();var t=this.filterItems;if(!(t.length<=0)){if(e.stopPropagation(),this.itemIndex<0)return this.itemIndex=0,this.hide(),void a.createEvent.call(this,13,!1);t[this.itemIndex].el.click(),this.hide()}}function d(e){var t=e.keyCode;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:e.stopPropagation();break;case 38:c.call(this,e),e.stopPropagation();break;case 39:e.stopPropagation();break;case 40:f.call(this,e),e.stopPropagation();break;case 13:case 9:h.call(this,e);break;default:e.stopPropagation()}}var p=function(){function e(t,r,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"200px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterItems=[],this.items=t,this.data=n,this.editor=a,this.el=(0,i.h)("div","".concat(o.cssPrefix,"-suggest")).css("width",s).css("overflow-y","auto").css("max-height","306px").hide(),this.el.attr("tabindex",0),this.itemClick=r,this.itemIndex=-1,this.show=!1}var t,r,n;return t=e,(r=[{key:"setOffset",value:function(e){this.el.cssRemoveKeys("top","bottom").offset(e)}},{key:"hide",value:function(){var e=this.el;this.filterItems=[],this.itemIndex=-1,e.hide(),this.show=!1,(0,a.unbindClickoutside)(this.el.parent())}},{key:"setItems",value:function(e){this.items=e}},{key:"search",value:function(e){var t,r=this,n=this.items,u=this.data,c=this.editor;if(/^\s*$/.test(e)||(n=n.filter((function(t){return(t.key.toUpperCase()||t.toUpperCase()).startsWith(e.toUpperCase())}))),n=n.map((function(e){var t=e.title;t?"function"==typeof t&&(t=t()):t=e;var n=(0,i.h)("div","".concat(o.cssPrefix,"-item")).child(t).on("click.stop",(function(){r.itemClick(e)}));return e.label&&n.child((0,i.h)("div","label").html(e.label)),n})),this.filterItems=n,n.length<=0)return this.hide(),void(this.show=!1);var f=this.el,h=u.getRect(new s.default(c.ri,c.ci,c.ri,c.ci)),d=h.left+55,p=h.top+50;n.length>=9&&h.top-306>=50&&(p-=306,p-=h.height),f.css("left","".concat(d,"px")),f.css("top","".concat(p,"px")),(t=f.html("")).children.apply(t,l(n)).show(),this.show=!0,(0,a.bindClickoutside)(f.parent(),(function(){r.hide(),r.show=!1}))}},{key:"bindInputEvents",value:function(e){var t=this;e.on("keydown",(function(e){return d.call(t,e)}))}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectorColor=function(e){return e%=l.length,{color:l[e],index:e}},t.default=void 0;var n=r(1),i=r(2);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],s=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],l=["#EE0000","#8A2BE2","#FF3E96","#8B4500","#3A5FCD","#FF7F24"];var u=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function c(e){var t=this,r=(0,n.h)("div","".concat(i.cssPrefix,"-color-palette-cell")).on("click.stop",(function(){return t.change(e)})).css("background-color",e);return this.items.push(r),(0,n.h)("td","").child(r)}t.default=function e(){var t,r,l,f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-color-palette")),this.change=function(){},this.items=[];var h=(0,n.h)("table","").children((t=(0,n.h)("tbody","")).children.apply(t,[(r=(0,n.h)("tr","".concat(i.cssPrefix,"-theme-color-placeholders"))).children.apply(r,a(o.map((function(e){return c.call(f,e)}))))].concat(a(s.map((function(e){var t;return(t=(0,n.h)("tr","".concat(i.cssPrefix,"-theme-colors"))).children.apply(t,a(e.map((function(e){return c.call(f,e)}))))}))),[(l=(0,n.h)("tr","".concat(i.cssPrefix,"-standard-colors"))).children.apply(l,a(u.map((function(e){return c.call(f,e)}))))])));this.el.child(h)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(17)),i=o(r(13)),a=o(r(84));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(e,r){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=new i.default(e).css("height","16px").css("border-bottom","3px solid ".concat(r)),s=new a.default;return s.change=function(e){n.setTitle(e),n.change(e)},(n=u(this,c(t).call(this,o,"auto",!1,"bottom-left",{type:!1},s.el))).colorPalette=s,n}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.css("border-color",e),this.hide()}}])&&l(r.prototype,n),o&&l(r,o),t}(n.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=(n=r(13))&&n.__esModule?n:{default:n},o=r(2),s=r(10);function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){var n,s=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title=t,this.el=(0,i.h)("div","".concat(o.cssPrefix,"-modal")).css("width",u).children((0,i.h)("div","".concat(o.cssPrefix,"-modal-header")).children(new a.default("close").on("click.stop",(function(){return s.hide()})),this.title),(n=(0,i.h)("div","".concat(o.cssPrefix,"-modal-content"))).children.apply(n,l(r))).hide(),this.open=!1}var t,r,n;return t=e,(r=[{key:"show",value:function(){var e=this;this.dimmer=(0,i.h)("div","".concat(o.cssPrefix,"-dimmer active")),document.body.appendChild(this.dimmer.el);var t=this.el.show().box(),r=t.width,n=t.height,a=document.documentElement,l=a.clientHeight,u=a.clientWidth;this.el.offset({left:(u-r)/2,top:(l-n)/3}),window.xkeydownEsc=function(t){27===t.keyCode&&e.hide()},this.open=!0,(0,s.bind)(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),this.open=!1,document.body.removeChild(this.dimmer.el),(0,s.unbind)(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountCopy=function(e){e.preventDefault();var t=a.call(this);if(t)return void(e.clipboardData&&(e.clipboardData.setData("text/html",s(t.img2)),e.clipboardData.setData("text/plain","")));var r=o.call(this);e.clipboardData&&(e.clipboardData.setData("text/html",s(r.html.el)),e.clipboardData.setData("text/plain",r.plain))},t.getChooseImg=a,t.sheetCopy=o;var n=r(1),i=r(8);function a(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++)if(!0===e[t].state)return this.container.css("pointer-events","auto"),e[t];return null}function o(){for(var e={plain:"",html:(0,n.h)("table","")},t=this.data,r=t.selector,a=t.rows,o=t.styles,s=r.range,l=s.sri,u=s.eri,c=s.sci,f=s.eci,h=(0,n.h)("tbody",""),d=l;d<=u;d+=1){for(var p=(0,n.h)("tr",""),v=c;v<=f;v+=1){var g=(0,n.h)("td","");if(a._[d]&&a._[d].cells&&a._[d].cells[v]){if(a._[d].cells[v]&&o[a._[d].cells[v].style]){if(g.css("color",o[a._[d].cells[v].style].color),o[a._[d].cells[v].style]&&o[a._[d].cells[v].style].font&&o[a._[d].cells[v].style].font.bold){var m=o[a._[d].cells[v].style].font.bold?"900":"";g.css("font-weight",m)}g.css("background",o[a._[d].cells[v].style].bgcolor)}a._[d].cells[v].text||(a._[d].cells[v].text=""),a._[d].cells[v].formulas||(a._[d].cells[v].formulas="");var y=""!==a._[d].cells[v].formulas?a._[d].cells[v].formulas:a._[d].cells[v].text;if(a._[d].cells[v].formulas&&(0,i.cutStr)(a._[d].cells[v].formulas,!1,!0).length>0){var b=(0,n.h)("reference","");b.html(y),b.attr("ri",d),b.attr("ci",v),g.child(b.el)}else g.html(y);e.plain+=y,e.plain+="\t"}else e.plain+="\t";p.child(g)}h.child(p),e.plain+="\n"}return e.html.child(h),e}function s(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){this.register=function(r){r.addEventListener("mousedown",(function(n){if(0===n.button){var i=n.clientX,a=n.clientY,o=r.offsetLeft,s=r.offsetTop;e&&e.onBegin&&e.onBegin.call(r,{left:i-o,top:a-s});var l=!0;r.style.cursor="move";var u=i,c=a;window.onmousemove=function(t){if(l){var n=t.clientX,f=t.clientY;return u=n-(i-o),c=f-(a-s),r.style.left=u>0?u+"px":"0px",r.style.top=c>0?c+"px":"0px",e&&e.onDrag&&e.onDrag.call(r,{left:u,top:c,x:n-i,y:f-a,isDown:l}),!1}},window.onmouseup=function(){return l=!1,r.style.cursor="default",e&&e.onEnd&&e.onEnd.call(r,{left:parseInt(r.style.left),top:parseInt(r.style.top)},t),!1},n.stopPropagation?n.stopPropagation():n.preventDefault&&n.preventDefault()}}))}};t.default=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spreadsheet=void 0;var n=r(1),i=f(r(222)),a=f(r(46)),o=r(2),s=r(11);r(327);var l=f(r(328)),u=r(329),c=f(r(88));function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sheet1";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var c=t;"string"==typeof t&&(c=document.querySelector(t)),this.locale("zh-cn",l.default),this.data=new i.default(u,r,s);var f=(0,n.h)("div","".concat(o.cssPrefix)).on("contextmenu",(function(e){return e.preventDefault()}));c.appendChild(f.el),this.sheet=new a.default(f,this.data),this.data.sheet=this.sheet}var t,r,u;return t=e,u=[{key:"locale",value:function(e,t){(0,s.locale)(e,t)}}],(r=[{key:"setDataSettings",value:function(e){this.data.settings.showEditor=e}},{key:"loadData",value:function(e){return this.sheet.loadData(e),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(e){return this.data.change=e,this}},{key:"locale",value:function(e,t){(0,s.locale)(e,t)}},{key:"getText",value:function(e,t,r){for(var n=this.sheet,i=n.selectors,a=n.data,o=n.table,s="",l=0;l<i.length;l++)s+=i[l].erpx;return a.getCellByExpr(s,o,e,t,r)}},{key:"removeEvent",value:function(){this.sheet.removeEvent()}}])&&h(t.prototype,r),u&&h(t,u),e}(),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new d(e,t)};t.spreadsheet=p,window&&(window.jsSpreadsheet=r(331),window.drag=c.default,window.x=window.x||{},window.bugout=u.bugout,window.x.spreadsheet=p,window.x.spreadsheet.locale=function(e,t){return(0,s.locale)(e,t)})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(25),a=A(r(244)),o=A(r(245)),s=A(r(246)),l=A(r(247)),u=r(248),c=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=M();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,t&&t.set(e,r);return r}(r(3)),f=r(42),h=r(281),d=r(282),p=r(6),v=r(4),g=r(11),m=A(r(81)),y=r(1),b=r(45),w=(r(47),r(8)),x=A(r(65)),E=r(324),C=r(48),k=A(r(325)),N=A(r(80)),T=A(r(30)),O=A(r(326));function M(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return M=function(){return e},e}function A(e){return e&&e.__esModule?e:{default:e}}function S(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var _={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},formula:{},showGrid:!0,showToolbar:!0,showContextmenu:!0,showEditor:!0,autoLoad:!0,ignore:[],cellWidth:0,ignoreRi:0,minus:!1,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:10},rowsInit:!1,style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,flexible:!1,underline:!1,autoAdapt:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}};function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!t)return!1;var n=this.merges,i=t.clone(),a=R(e.size(),2),o=a[0],s=a[1],l=R(t.size(),2),u=l[0],c=l[1];return o>u&&(i.eri=t.sri+o-1),s>c&&(i.eci=t.sci+s-1),!n.intersects(i)||(r((0,g.t)("error.pasteForMergedCell")),!1)}function D(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,a=this.merges;"all"!==r&&"format"!==r||(i.deleteCells(t,r),a.deleteWithin(t)),i.copyPaste(e,t,r,n,(function(e,t,r){if(r&&r.merge){var n=R(r.merge,2),i=n[0],o=n[1];if(i<=0&&o<=0)return;a.add(new p.CellRange(e,t,e+i,t+o))}}))}function P(e,t,r){var n=this.clipboard,i=this.rows,a=this.merges;i.cutPaste(e,t),a.move(e,t.sri-e.sri,t.sci-e.sci),r&&n.clear()}function L(e,t,r){var n=this.styles,i=this.rows.getCellOrNew(e,t),a={};(0,c.isHave)(i.style)&&(a=c.default.cloneDeep(n[i.style])),Object.assign(a,{border:r}),i.style=this.addStyle(a)}function F(e,t,r,n){if(-1===e||-1===t)return{state:!0,msg:"单元格坐标有误"};if("style"!==n&&(!r||"="!==r[0]))return{state:!1,msg:"正确"};var i=B.call(this,r);return"style"!==n&&!0===i.state?{msg:i.msg,state:!0}:{msg:i.msg,state:!1}}function B(e){var t=!1,r="";try{new x.default(e).parse()}catch(e){r="您输入的公式存在问题，请更正, 错误原因: "+e.description,t=!0}return!0===t&&!1===(0,w.isLegal)(e)&&(r="缺少左括号或右括号",t=!0),t?{state:!0,msg:r}:{state:!1,msg:r}}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"to",r=arguments.length>2?arguments[2]:void 0;if("to"===t){for(var n=[],i=0;i<e.length;i++){var a=e[i];console.log(a);var o={src:a.img2.src,ri:a.ri,ci:a.ci,top:a.top,left:a.left,range:a.range,offsetLeft:a.offsetLeft,offsetTop:a.offsetTop,nextLeft:a.nextLeft,nextTop:a.nextTop,img:a.img,arr:a.arr,img2:a.img2};n.push(o)}return n}if("from"===t){if("string"==typeof r)return;for(var s=0;s<e.length;s++){var l=e[s],u=(0,y.h)("img","");u.el.src=l.src,b.mountImg.call(r,u.el,!0,l.ri,l.ci,l.range)}}}function V(e,t){for(var r=this.rows,n=e+1,i=!0;i;){var a=r.getCellOrNew(n,t);a&&a.text?n+=1:i=!1}return n}function z(e){var t=this,r=e.mode,n=e.style,i=e.color,a=this.styles,o=this.selector,s=this.rows,l=o.range,u=l.sri,f=l.sci,h=l.eri,d=l.eci,p=!this.isSignleSelected();if(p||"inside"!==r&&"horizontal"!==r&&"vertical"!==r){for(var v=u;v<=h;v+=1)for(var g=f;g<=d;g+=1)L.call(this,v,g,{});if("outside"!==r||p){if("none"===r)o.range.each((function(e,r){var n=s.getCell(e,r);if(n&&void 0!==n.style){var i=c.default.cloneDeep(a[n.style]);delete i.border,n.style=t.addStyle(i)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)!function(){for(var e=[],a=u;a<=h;a+=1)for(var o=f;o<=d;o+=1){for(var l=[],c=0;c<e.length;c+=1){var v=R(e[c],4),g=v[0],m=v[1],y=v[2],b=v[3];if(a===g+y+1&&l.push(c),g<=a&&a<=g+y&&o===m){o+=b+1;break}}if(l.forEach((function(t){return e.splice(t,1)})),o>d)break;var w=s.getCell(a,o),x=0,E=0;if(w&&w.merge){var C=R(w.merge,2);x=C[0],E=C[1],e.push([a,o,x,E])}var k=x>0&&a+x===h,N=E>0&&o+E===d,T={};"all"===r?T={bottom:[n,i],top:[n,i],left:[n,i],right:[n,i]}:"inside"===r?(!N&&o<d&&(T.right=[n,i]),!k&&a<h&&(T.bottom=[n,i])):"horizontal"===r?!k&&a<h&&(T.bottom=[n,i]):"vertical"===r?!N&&o<=d&&(T.right=[n,i]):"outside"===r&&p&&(u===a&&(T.top=[n,i]),(k||h===a)&&(T.bottom=[n,i]),f===o&&(T.left=[n,i]),(N||d===o)&&(T.right=[n,i])),Object.keys(T).length>0&&L.call(t,a,o,T),o+=E}}();else if("top"===r||"bottom"===r)for(var m=f;m<=d;m+=1)"top"===r&&(L.call(this,u,m,{top:[n,i]}),m+=s.getCellMerge(u,m)[1]),"bottom"===r&&(L.call(this,h,m,{bottom:[n,i]}),m+=s.getCellMerge(h,m)[1]);else if("left"===r||"right"===r)for(var y=u;y<=h;y+=1)"left"===r&&(L.call(this,y,f,{left:[n,i]}),y+=s.getCellMerge(y,f)[0]),"right"===r&&(L.call(this,y,d,{right:[n,i]}),y+=s.getCellMerge(y,d)[0])}else L.call(this,u,f,{top:[n,i],bottom:[n,i],left:[n,i],right:[n,i]})}}function U(e,t){var r=this.rows,n=this.freezeTotalHeight(),i=r.height;n+r.height<e&&(i-=t);for(var a=this.exceptRowSet,o=0,s=i,l=r.height;o<r.len&&!(s>e);o+=1)a.has(o)||(s+=l=r.getHeight(o));return(s-=l)<=0?{ri:-1,top:0,height:l}:{ri:o-1,top:s,height:l}}function Y(e,t){var r=this.cols,n=this.freezeTotalWidth(),i=r.indexWidth;n+r.indexWidth<=e&&(i-=t);var a=R(c.default.rangeReduceIf(0,r.len,i,r.indexWidth,e,(function(e){return r.getWidth(e)})),3),o=a[0],s=a[1],l=a[2];return s<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:o-1,left:s,width:l}}function W(e,t,r){var n=e.text,i=e.formula,a=t.symbol,o=t.position;if(!(0,c.isHave)(n)||!(0,c.isNumber)(n))return null;var s=r((0,C.formatNumberRender)(n,-1));return i=(0,f.isFormula)(i)?i:s,isNaN(s)?null:{text:"begin"===o?a+s:s+a,value:n,formulas:i}}function X(e,t,r){return G.call(this,t,r,e)}function G(e,t,r){var n=this.rows,i=this.getCellStyle(e,t),a=(0,E.dateDiff)(r.text),o=a.isValid,s=a.diff,l=n.getCellStyleConvert(i,o);if("number"===l){var u=r.text,h=r.formulas,d={};return d=o?{text:s.toFixed(2),formulas:h}:{text:u=(0,C.formatNumberRender)(u,2),value:r.text,formulas:h},(0,c.isHave)(d.text)&&(0,c.isNumber)(d.text)?{state:!0,style:l,text:d.text,cell:d}:{state:!1,style:l,text:d.text,cell:d}}if("date"===l||"datetime"===l){var p=r.text;if(!o){var v=(0,E.formatDate)(p),g=v.state,m=v.date;o=g,s=r.text,p=m}return o&&"datetime"===l&&(p=(0,E.changeFormat)((0,E.formatDate)((0,E.dateDiff)(p).diff).date)),{state:o,style:l,text:(0,c.isHave)(i)?p:s}}if("normal"===l){if(o){var y=s,b=r.formulas,w={formulas:n.toString(b),text:n.toString(y)};return{state:!0,text:w.text,style:l,cell:w}}var x=r.text,k={formulas:r.formulas,text:x};return{state:!0,style:l,text:k.text,cell:k}}if("rmb"===l){var N="",T="";o?(N=s,T=(0,f.isFormula)(r.formulas)?r.formulas:s):(N=(0,C.formatNumberRender)(r.text,0),T=r.formulas);var O=W({text:N,formula:T},{symbol:"￥",position:"begin"},(function(e){return e}));if(O)return{state:!0,style:l,text:O.text,cell:O}}else if("percent"===l){var M="",A="";o?(M=s,A=(0,f.isFormula)(r.formulas)?r.formulas:s):(M=n.useOne(r.value,r.text),A=r.formulas);var S=W({text:M,formula:A},{symbol:"%",position:"end"},(function(e){return Number(100*e).toFixed(2)}));if(S)return{state:!0,style:l,text:S.text,cell:S}}return{state:!1,style:l,text:r.text,cell:{}}}var q=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=c.default.merge(_,r||{}),this.name=t||"sheet",this.methods=n,this.freeze=[0,0],this.styles=[],this.merges=new u.Merges,this.rows=new f.Rows(this.settings.row,this),this.cols=new h.Cols(this.settings.col),this.validations=new d.Validations,this.hyperlinks={},this.comments={},this.showEquation=!1,this.calc=(0,i.formulaCalc)(),this.pasteDirectionsArr=[],this.changeDataForCalc=null,this.multiPreAction=new k.default(this),this.selector=new a.default,this.scroll=new o.default,this.clipboard=new s.default,this.moved=new m.default,this.autoFilter=new l.default,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var t,r,n;return t=e,(r=[{key:"addValidation",value:function(e,t,r){var n=this;this.changeData((function(){n.validations.add(e,t,r)}))}},{key:"removeValidation",value:function(){var e=this,t=this.selector.range;this.changeData((function(){e.validations.remove(t)}))}},{key:"tryParseToNum",value:function(e,t,r){return X.call(this,e,t,r)}},{key:"clickCopyPaste",value:function(){var e=this.selector.range.eri,t=this.selector.range.eci,r=this.rows,n=r.getCellOrNew(e,t),i=r.getCellOrNew(e+1,t);if(!n||!n.text||i&&i.text)return{enter:!1};for(var a=V.call(this,e,t-1),o=V.call(this,e,t+1),s=a<o?o:a,l=!1,u=1;u<s&&!1===l;u++){var c=r.getCellOrNew(e+u,t);c&&c.text&&(s=e+u,l=!0)}return{enter:!0,dstCellRange:new p.CellRange(e+1,t,s-1,t),srcCellRange:new p.CellRange(e,t,e,t)}}},{key:"getSelectedValidation",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=e.range,i=this.validations.get(t,r),a={ref:n.toString()};return null!==i&&(a.mode=i.mode,a.validator=i.validator),a}},{key:"canUndo",value:function(){return this.multiPreAction.getItems(1).length>0}},{key:"canRedo",value:function(){return this.multiPreAction.getItems(2).length>0}},{key:"undo",value:function(){this.multiPreAction.undo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"historyList",value:function(e){return this.multiPreAction.getItems(e)}},{key:"redo",value:function(){this.multiPreAction.redo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"copy",value:function(){document.execCommand("copy",!0),this.clipboard.copy(this.selector.range)}},{key:"makeCellPropArr",value:function(e,t,r){for(var n=[],i=this.rows.eachRange(e),a=0;a<i.length;a++){var o=i[a],s=o.ri,l=o.ci,u=o.cell;if((0,c.isHave)(u)&&!1===(0,c.isHave)(u.style)){var f=this.defaultStyle();u.style=this.addStyle(f)}var h=new T.default(s+t,l+r,u,(0,v.xy2expr)(s+t,l+r));n.push(h)}return n}},{key:"setCellByCellProp",value:function(e,t){for(var r=this.rows,n=0;n<e.length;n++){var i=e[n],a=i.ri,o=i.ci,s=i.cell;(0,c.isHave)(s)&&(0,c.isHave)(s.style)&&r.setCell(a,o,s,"style"),t(a,o)}}},{key:"paintFormatChange",value:function(e){var t=this;this.changeData((function(){var r=t.clipboard,n=t.selector,i=r.range,a=n.ri,o=n.ci,s=a-i.sri,l=o-i.sci,u=t.makeCellPropArr(i,s,l);if(n.range.eri-n.range.sri==0&&n.range.eci-n.range.sci==0)t.setCellByCellProp(u,e);else{var c=new O.default(i,n.range),f=c.getPaintType(),h=c.makePaintArr(f,u);t.setCellByCellProp(h,e)}}),{type:12,cellRange:this.selector.range})}},{key:"move",value:function(){this.moved.move()}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(e){this.changeData((function(){}),{type:6,cellRange:e})}},{key:"autofill",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!j.call(this,i,e,n)&&(this.changeData((function(){D.call(r,i,e,t,!0)}),{type:5,cellRange:e}),!0)}},{key:"clickAutofill",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return!!j.call(this,e,t,i)&&(this.changeData((function(){D.call(n,e,t,r,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges,o=r.range,s=o.sri,l=o.sci,u=o.eri,c=o.eci,f=r.ri,h=r.ci,d=e,v=t;return e<0&&(d=n.len-1),t<0&&(v=i.len-1),d<=f?(s=d,u=f):u=d,v<=h?(l=v,c=h):c=v,r.range=a.union(new p.CellRange(s,l,u,c)),r.range}},{key:"calSelectedRangeByStart",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges.getFirstIncludes(e,t);return null===a&&(a=new p.CellRange(e,t,e,t),-1===e&&(a.sri=0,a.eri=n.len-1),-1===t&&(a.sci=0,a.eci=i.len-1)),r.range=a,a}},{key:"setSelectedCellAttr",value:function(e,t){var r=this;this.changeData((function(){var n=r.selector,i=r.styles,a=r.rows;if("merge"===e)t?r.merge():r.unmerge();else if("border"===e)z.call(r,t);else if("formula"===e){var o=a.getCellOrNew(n.ri,n.ci);o.text="=".concat(t,"()"),o.formulas="=".concat(t,"()")}else n.range.each((function(n,o){var s=a.getCellOrNew(n,o),l={};if((0,c.isHave)(s.style)&&(l=c.default.cloneDeep(i[s.style])),"format"===e)l.format=t,a.setCellText(n,o,{text:s.text,style:r.addStyle(l)},"format");else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){var u={};u[e.split("-")[1]]=t,l.font=Object.assign(l.font||{},u),s.style=r.addStyle(l)}else"flexible"===e?(r.exceptRowSet.has(n+1)&&r.exceptRowSet.has(n+2)&&!r.exceptRowSet.has(n+3)?(r.exceptRowSet.delete(n),r.exceptRowSet.delete(n+1),r.exceptRowSet.delete(n+2)):(r.exceptRowSet.add(n),r.exceptRowSet.add(n+1),r.exceptRowSet.add(n+2)),l[e]=t,s.style=r.addStyle(l)):"strike"!==e&&"textwrap"!==e&&"underline"!==e&&"align"!==e&&"valign"!==e&&"color"!==e&&"bgcolor"!==e||(l[e]=t,s.style=r.addStyle(l))}))}),{type:11,cellRange:this.selector.range,property:e,value:t})}},{key:"setSelectedCellText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.selector,n=r.ri,i=r.ci,a=n;this.unsortedRowMap.has(n)&&(a=this.unsortedRowMap.get(n)),this.setCellText(a,i,{text:e},t),this.resetAutoFilter()}},{key:"setSelectedCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.setCellAll(n,i,e,r,t),this.resetAutoFilter()}},{key:"getSelectedCell",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=t;return this.unsortedRowMap.has(t)&&(n=this.unsortedRowMap.get(t)),this.rows.getCell(n,r)}},{key:"editorChangeToHistory",value:function(e,t,r){var n=t.ri,i=t.ci;if(-1===n||-1===i)return{state:!1};var a=this.rows.getCell(n,i),o=this.multiPreAction,s=(0,v.xy2expr)(i,n),l=o.getStepType(r,{ri:n,ci:i,expr:s,text:a.text}),u=new T.default(n,i,e,s),c=new T.default(n,i,a,s);return o.addStep(l,{oldCell:[u],newCell:[c]}),this.changeDataForCalc=this.getChangeDataToCalc(),{state:!0}}},{key:"changeToHistory",value:function(e,t){var r=e.ri,n=e.type,i=e.ci,a=e.cellRange,o=e.property,s=e.value,l=e.oldCell,u=e.oldMergesData;if(-1===n)return{state:!1};var c=this.multiPreAction,f=this.selector,h=c.getStepType(n,{expr:"",property:o,value:s,oldCell:l,range:f.range,ri:r,ci:i,cellRange:a});return c.addStep(h,{oldCell:l,oldMergesData:u,newMergesData:this.merges.getData(),oldStep:t}),{state:!0}}},{key:"getSelectedCellRiCi",value:function(e,t){var r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,t)}},{key:"xyInSelectedRect",value:function(e,t){var r=this.getSelectedRect(),n=r.left,i=r.top,a=r.width,o=r.height,s=e-this.cols.indexWidth,l=t-this.rows.height;return s>n&&s<n+a&&l>i&&l<i+o}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var e=this.clipboard;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}},{key:"getMoveRect",value:function(e){return this.getRect(e)}},{key:"getRect",value:function(e){var t=this.scroll,r=this.rows,n=this.cols,i=this.exceptRowSet,a=e.sri,o=e.sci,s=e.eri,l=e.eci;if(a<0&&o<0)return{left:0,l:0,top:0,t:0,scroll:t};var u=n.sumWidth(0,o),c=r.sumHeight(0,a,i),f=r.sumHeight(a,s+1,i),h=n.sumWidth(o,l+1),d=u-t.x,p=c-t.y,v=this.freezeTotalHeight(),g=this.freezeTotalWidth();return g>0&&g>u&&(d=u),v>0&&v>c&&(p=c),{l:u,t:c,left:d,top:p,height:f,width:h,scroll:t}}},{key:"getCellRectByXY",value:function(e,t){var r=this.scroll,n=this.merges,i=this.rows,a=this.cols,o=U.call(this,t,r.y),s=o.ri,l=o.top,u=o.height,c=Y.call(this,e,r.x),f=c.ci,h=c.left,d=c.width;if(-1===f&&(d=a.totalWidth()),-1===s&&(u=i.totalHeight()),s>=0||f>=0){var p=n.getFirstIncludes(s,f);if(p){s=p.sri,f=p.sci;var v=this.cellRect(s,f);h=v.left,l=v.top,d=v.width,u=v.height}}return{ri:s,ci:f,left:h,top:l,width:d,height:u}}},{key:"getCellRectByXYWithNotTotalResult",value:function(e,t){var r=this.scroll,n=this.merges,i=U.call(this,t,r.y),a=i.ri,o=i.top,s=i.height,l=Y.call(this,e,r.x),u=l.ci,c=l.left,f=l.width;if(a>=0||u>=0){var h=n.getFirstIncludes(a,u);if(h){a=h.sri,u=h.sci;var d=this.cellRect(a,u);c=d.left,o=d.top,f=d.width,s=d.height}}return{ri:a,ci:u,left:c,top:o,width:f,height:s}}},{key:"isSignleSelected",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=R(a.merge,2),s=o[0],l=o[1];if(t+s===n&&r+l===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=R(a.merge,2),s=o[0],l=o[1];if(t+s===n&&r+l===i)return!0}return!1}},{key:"merge",value:function(){var e=this.selector,t=this.rows;if(!this.isSignleSelected()){var r=R(e.size(),2),n=r[0],i=r[1];if(n>1||i>1){var a=e.range,o=a.sri,s=a.sci,l=t.getCellOrNew(o,s);l.merge=[n-1,i-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(o,s,l)}}}},{key:"unmerge",value:function(){var e=this,t=this.selector;if(this.isSignleSelected()){var r=t.range,n=r.sri,i=r.sci;this.changeData((function(){e.rows.deleteCell(n,i,"merge"),e.merges.deleteWithin(t.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var e=this,t=this.autoFilter,r=this.selector;this.changeData((function(){if(t.active())t.clear(),e.exceptRowSet=new Set,e.sortedRowMap=new Map,e.unsortedRowMap=new Map;else{for(var n=r.range.toString(),i=r.range.eri,a=e.rows,o=r.range.sci;o<=r.range.eci;o++){var s=new p.CellRange(r.range.sri,o,r.range.sri,o);i<(s=a.autoFilterRef(n,s)).eri&&(i=s.eri)}var l=new p.CellRange(r.range.sri,r.range.sci,i,r.range.eci);t.ref=l.toString()}}))}},{key:"throwFormula",value:function(){var e=this.selector,t=this.rows;this.changeData((function(){e.range.each((function(e,r){var n=t.getCellOrNew(e,r);n&&n.text&&n.formulas&&t.setCellAll(e,r,n.text,n.text)}))}))}},{key:"setAutoFilter",value:function(e,t,r,n){var i=this.autoFilter;i.addFilter(e,r,n),i.setSort(e,t),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var e=this,t=this.autoFilter,r=this.rows;if(t.active()){var n=t.sort,i=t.filteredRows((function(e,t){return r.getCell(e,t)})),a=i.rset,o=i.fset,s=Array.from(o),l=Array.from(o);n&&s.sort((function(e,t){return"asc"===n.order?e-t:"desc"===n.order?t-e:0})),this.exceptRowSet=a,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,s.forEach((function(t,r){e.sortedRowMap.set(l[r],t),e.unsortedRowMap.set(t,l[r])}))}}},{key:"deleteCell",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){e.rows.deleteCells(r.range,t),"all"!==t&&"format"!==t||e.merges.deleteWithin(r.range)}),{type:2})}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.selector.range,i=n.sri,a=n.sci,o=this.rows,s=this.merges,l=this.cols;r="row"===e?-1!==r?r:i:-1!==r?r:a,this.changeData((function(){var n=r;"row"===e?o.insert(r,t):"column"===e&&(o.insertColumn(r,t),n=r,l.len+=t),s.shift(e,n,t,(function(e,t,r,n){var i=o.getCell(e,t);i.merge[0]+=r,i.merge[1]+=n}))}),{type:13,data:this.getData(),property:"insert"})}},{key:"delete",value:function(e){var t=this;this.changeData((function(){var r=t.rows,n=t.merges,i=t.selector,a=t.cols,o=i.range,s=i.range,l=s.sri,u=s.sci,c=s.eri,f=s.eci,h=R(i.range.size(),2),d=h[0],p=h[1],v=l,g=d;"row"===e?r.delete(l,c):"column"===e&&(r.deleteColumn(u,f),v=o.sci,g=p,a.len-=1),n.shift(e,v,-g,(function(e,t,n,i){var a=r.getCell(e,t);a.merge[0]+=n,a.merge[1]+=i,0===a.merge[0]&&0===a.merge[1]&&delete a.merge}))}))}},{key:"scrollx",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.cols,a=R(n,2)[1],o=R(c.default.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getWidth(e)})),3),s=o[0],l=o[1],u=o[2],f=l;e>0&&(f+=u),r.x!==f&&(r.ci=e>0?s:0,r.x=f,t())}},{key:"scrolly",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.rows,a=R(n,1)[0],o=R(c.default.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getHeight(e)})),3),s=o[0],l=o[1],u=o[2],f=l;e>0&&(f+=u),r.y!==f&&(r.ri=e>0?s:0,r.y=f,t())}},{key:"cellRect",value:function(e,t){var r=this.rows,n=this.cols,i=n.sumWidth(0,t),a=r.sumHeight(0,e),o=r.getCell(e,t),s=n.getWidth(t),l=r.getHeight(e);if(null!==o&&o.merge){var u=R(o.merge,2),c=u[0],f=u[1];if(c>0)for(var h=1;h<=c;h+=1)l+=r.getHeight(e+h);if(f>0)for(var d=1;d<=f;d+=1)s+=n.getWidth(t+d)}return{left:i,top:a,width:s,height:l,cell:o}}},{key:"getCell",value:function(e,t){return this.rows.getCell(e,t)}},{key:"getMax",value:function(){var e=this.cols.len;return{mri:this.rows.len,mci:e}}},{key:"renderFormat",value:function(e,t,r,n,i){return new N.default(t).renderFormat(e,r,n,this,i)}},{key:"isFormula",value:function(e){return this.rows.isFormula(e)}},{key:"toString",value:function(e){return this.rows.toString(e)}},{key:"getCellTextOrDefault",value:function(e,t){var r=this.getCell(e,t);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(e,t){var r=this.getCell(e,t);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(e,t){var r=this.styles,n=this.rows.getCell(e,t),i=n&&void 0!==n.style?r[n.style]:{};return c.default.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var e=this.selector,t=e.ri,r=e.ci;return this.getCellStyleOrDefault(t,r)}},{key:"getCellByExpr",value:function(e,t,r,n,i){}},{key:"setCellText",value:function(e,t,r,n){var i=r.text,a=r.style,o=this.rows,s=this.history,l=this.validations;"finished"===n?(o.setCellText(e,t,{text:""}),s.add(this.getData()),o.setCellText(e,t,{text:i})):("end"===n?o.setCellAll(e,t,i):"formulas"===n?o.setCellAll(e,t,i,"-"):"style"===n?o.setCellText(e,t,{text:i,style:a},"style"):o.setCellText(e,t,{text:i}),this.change(this.getData())),l.validate(e,t,i)}},{key:"setCellAll",value:function(e,t,r,n,i){var a=this.rows,o=this.history,s=this.validations;"finished"===i?(a.setCellAll(e,t,"",""),o.add(this.getData()),a.setCellAll(e,t,r,n)):a.setCellAll(e,t,r,n),s.validate(e,t,r,n)}},{key:"equationIsActive",value:function(){return this.showEquation}},{key:"freezeIsActive",value:function(){var e=R(this.freeze,2),t=e[0],r=e[1];return t>0||r>0}},{key:"setFreeze",value:function(e,t){var r=this;this.changeData((function(){r.freeze=[e,t]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(e,t){var r=this;this.changeData((function(){r.rows.setHeight(e,t)}),{type:3,ri:e})}},{key:"setColWidth",value:function(e,t){var r=this;this.changeData((function(){r.cols.setWidth(e,t)}),{type:4,ci:e})}},{key:"viewHeight",value:function(){var e=this.settings,t=e.view,r=e.showToolbar,n=t.height();return r&&(n-=41),n}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var e=R(this.freeze,2),t=e[0],r=e[1];return new p.CellRange(0,0,t-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"viewRange",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=R(n,1)[0]),a<=0&&(a=R(n,2)[1]);for(var o=0,s=0,l=[t.len,r.len],u=l[0],c=l[1],f=i;f<t.len&&(u=f,!((s+=t.getHeight(f))>this.viewHeight()));f+=1);for(var h=a;h<r.len&&(c=h,!((o+=r.getWidth(h))>this.viewWidth()));h+=1);return new p.CellRange(i,a,u,c,o,s)}},{key:"viewRange2",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=R(n,1)[0]),a<=0&&(a=R(n,2)[1]);for(var o=0,s=0,l=[t.len,r.len],u=l[0],c=l[1],f=i;f<t.len&&(u=f,!((s+=t.getHeight(f))>this.viewHeight()));f+=1);for(var h=a;h<r.len;h+=1)o+=r.getWidth(h),c=h;return new p.CellRange(i,a,u,c,o,s)}},{key:"eachMergesInView",value:function(e,t){this.merges.filterIntersects(e).forEach((function(e){return t(e)}))}},{key:"rowEach",value:function(e,t,r){for(var n=0,i=this.rows,a=this.exceptRowSet,o=S(a),s=0,l=0;l<o.length;l+=1)o[l]<e&&(s+=1);for(var u=e+s;u<=t+s;u+=1)if(a.has(u))s+=1;else{var c=i.getHeight(u);if(r(u,n,c),(n+=c)>this.viewHeight())break}}},{key:"colEach",value:function(e,t,r){for(var n=0,i=this.cols,a=e;a<=t;a+=1){var o=i.getWidth(a);if(r(a,n,o),(n+=o)>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(e){for(var t=this.styles,r=0;r<t.length;r+=1){var n=t[r];if(c.default.equals(n,e))return r}return t.push(e),t.length-1}},{key:"getChangeDataToCalc",value:function(){var e=this.multiPreAction;if(e.undoItems.length<=0)return null;var t=e.undoItems[e.undoItems.length-1];return(0,c.isHave)(t)?t:null}},{key:"changeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.type,n=void 0===r?-1:r,i=t.ri,a=void 0===i?-1:i,o=t.ci,s=void 0===o?-1:o,l=t.cellRange,u=void 0===l?"":l,c=t.property,f=void 0===c?"":c,h=t.value,d=void 0===h?"":h;if(!1!==this.settings.showEditor){var p={},v=this.merges.getData(),g=this.multiPreAction,m=this.selector,y=g.getStepType(n,{expr:"",property:f,value:d,oldCell:p,range:m.range,ri:a,ci:s,cellRange:u});if(""!==u){var b=this.multiPreAction;p=b.eachRange(u)}e(),this.changeToHistory({type:n,ri:a,ci:s,cellRange:u,property:f,value:d,oldCell:p,oldMergesData:v,newData:this.getData()},y),this.changeDataForCalc=this.getChangeDataToCalc(),this.change(this.getData())}}},{key:"cutPaste",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];P.call(this,e,t,r)}},{key:"setData",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.autoFilter;return Object.keys(e).forEach((function(a){if("merges"===a||"cols"===a||"validations"===a)t[a].setData(e[a]);else if("flex"===a)i.addFiexRows(e[a]);else if("rows"===a)t[a].setData(e[a],r,n,t.settings.rowsInit);else if("freeze"===a){var o=R((0,v.expr2xy)(e[a]),2),s=o[0],l=o[1];t.freeze=[l,s]}else"pictures"===a?e[a]&&H.call(t,e[a],"from",r):"autofilter"===a?e[a]&&e[a].ref&&(i.ref=e[a].ref,i.filters=e[a].filters,i.sort=e[a].sort):void 0!==e[a]&&(t[a]=e[a])})),this}},{key:"selectorCellText",value:function(e,t,r,n){return F.call(this,e,t,r,n)}},{key:"getData",value:function(){var e=this.name,t=this.freeze,r=this.styles,n=this.merges,i=this.rows,a=this.cols,o=this.validations,s=this.autoFilter,l=this.pasteDirectionsArr;return{editor:this.settings.showEditor,name:e,freeze:(0,v.xy2expr)(t[1],t[0]),styles:r,pictures:H(l,"to"),merges:n.getData(),rows:i.getData(),cols:a.getData(),validations:o.getData(),autofilter:s.getData()}}}])&&I(t.prototype,r),n&&I(t,n),e}();t.default=q},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={toolbar:{undo:"Undo",redo:"Redo",paintformat:"Paint format",clearformat:"Clear format",format:"Format",font:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",textColor:"Text color",fillColor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",add:"display equation",autofilter:"Filter",formula:"Functions",more:"More",flexible:"Flexible",throwFormula:"Throw formulas",comeBack:"come back"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",recover:"recover"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},date_formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",concat:"Concat",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}},function(e,t,r){"use strict";var n=r(225),i=r(36),a=r(37),o=r(226),s=r(62),l=r(241),u=r(242),c=r(63),f=r(3),h=r(243),d=function(e,t){var r=new n({type:999,action:"重新计算",ri:-1,ci:-1,oldCell:{}},e.data);if(console.log(r),f.isHave(t)){var i=new h(e,t),a=e.workbook;a=i.get_workbook(a);for(var l=s(a,t,o),d=l.length-1;d>=0;d--)try{var p=new u(l[d],e),v=p.check_valid();!0!==v?l[d].cell.v=v:(l[d].cell.f=p.trans_formula(),c.trans_sheet(l[d].sheet),o(l[d]),l[d].cell.f=p.recover_formula(),c.recover_sheet(l[d].sheet)),(i.is_muti_cell(l[d])||Array.isArray(l[d].cell.v))&&i.deal_muti_cell(a,l[d])}catch(e){console.log(e)}i.calcDoneToSetCells(a,e)}};d.calculator=function(e){return new l(e,o)},d.set_fx=o.set_fx,d.exec_fx=o.exec_fx,d.col_str_2_int=a,d.int_2_col_str=i,d.import_functions=o.import_functions,d.import_raw_functions=o.import_raw_functions,d.xlsx_Fx=o.xlsx_Fx,d.localizeFunctions=o.localizeFunctions,d.XLSX_CALC=d,e.exports=d},function(e,t,r){"use strict";var n,i=(n=r(35))&&n.__esModule?n:{default:n};e.exports=i.default},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(227),a={},o={};function s(e,t){for(var r in e)o[r]=e[r]}function l(e,t){var r=(t=t||{}).prefix||"";for(var i in e){var o=e[i];"function"==typeof o?!t.override&&a[r+i]||(a[r+i]=o):"object"===n(o)&&l(o,u(t,{prefix:i+"."}))}}function u(e,t){var r=JSON.parse(JSON.stringify(e));for(var n in t)r[n]=t[n];return r}function c(e){return i(e,{xlsx_Fx:a,xlsx_raw_Fx:o})}function f(e){c(e).update_cell_value()}l(r(56)),s(r(240)),f.set_fx=function(e,t){a[e]=t},f.exec_fx=function(e,t){return a[e].apply(this,t)},f.localizeFunctions=function(e){for(var t in e){var r=e[t];a[r]&&(a[t]=a[r]),o[r]&&(o[t]=o[r])}},f.import_functions=l,f.import_raw_functions=s,f.build_expression=c,f.xlsx_Fx=a,e.exports=f},function(e,t,r){"use strict";var n=r(228),i=r(22),a=r(229),o=r(230),s={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};e.exports=function(e,t){e.status="working";var r,l=t.xlsx_Fx||{},u=t.xlsx_raw_Fx||{},c=e.cell.f;"="==c[0]&&(c=c.substr(1));var f=r=new n(e),h="",d=!1,p=[{exp:f}];function v(e){'"'===e?(f.push(new i(h)),d=!0,h="",y=m):h+=e}function g(e){"'"===e&&(y=m),h+=e}function m(t){var r,i,c;'"'===t?(y=v,h=""):"'"===t?(y=g,h="'"):"("===t?function(){var t,r=h.trim(),i=l[r],s=u[r];if(s)i=new o(s,e);else if(i)i=new a(i,e);else if(r)throw new Error('"'+e.sheet_name+'"!'+e.name+": Function "+h+" not found");t=new n(e),p.push({exp:t,special:i}),f=t,h=""}():")"===t?(c=p.pop(),(f=c.exp).push(h,b),i=f,h="",f=p[p.length-1].exp,c.special?(c.special.push(i),f.push(c.special,b)):f.push(i,b)):s[t]?(r=t,d||f.push(h,b),d=!1,f.push(r,b),h=""):","===t&&p[p.length-1].special?(d=!1,p[p.length-1].exp.push(h,b),p[p.length-1].special.push(p[p.length-1].exp),p[p.length-1].exp=f=new n(e),h=""):h+=t}for(var y=m,b=0;b<c.length;b++)y(c[b]);return r.push(h,b),r}},function(e,t,r){"use strict";var n=r(22),i=r(38),a=r(54),o=r(9),s=864e5,l=0;e.exports=function(e){var t,r=this;function u(e){return null==e||""===e}function c(e){return"function"!=typeof e.calc?0:1}function f(e,t,r){for(var i=0;i<t.length;i++)if(t[i]===e)try{if(0===i&&"+"===e){if(!c(t[i+1]))break;var a=t[i+1].calc();t.splice(i,2,new n(a))}else{var o=c(t[i-1]);if(!o)break;if(!(o=c(t[i+1])))break;var s=r(t[i-1].calc(),t[i+1].calc());t.splice(i-1,3,new n(s)),i--}}catch(e){throw e}}r.id=++l,r.args=[],r.name="Expression",r.update_cell_value=function(){try{if(Array.isArray(r.args)&&1===r.args.length&&r.args[0]instanceof i)throw o.value;e.cell.v=r.calc(),"string"==typeof e.cell.v?e.cell.t="s":"number"==typeof e.cell.v&&(e.cell.t="n")}catch(r){var t={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};if(void 0===t[r.message])throw r;e.cell.t="e",e.cell.w=r.message,e.cell.v=t[r.message]}finally{e.status="done"}},r.formula=e,r.calc=function(){var e=r.args.concat();try{for(var t=0;t<e.length;t++){if("RefValue"==e[t].name)if(void 0===(i=e[t].formula.sheet)[e[t].str_expression]&&(e[t].formula.sheet[e[t].str_expression]={v:"default_0"}),"0"==e[t].str_expression.slice(1,e[t].str_expression.length))return o.name}}catch(e){}try{if("RefValue"==e[0].name&&"-"==e[1]&&"RefValue"==e[2].name){var i,a=(i=e[0].formula.sheet)[e[0].str_expression].v,l=i[e[2].str_expression].v;a=a.replace("年","-").replace("月","-").replace("日",""),l=l.replace("年","-").replace("月","-").replace("日","");return datedifference(a,l)}}catch(e){}if(function(e){for(var t=e.length;t--;)if("-"===e[t]){c(e[t+1]);var r=e[t+1].calc();if(t>0&&"string"!=typeof e[t-1]){if(e.splice(t,1,"+"),r instanceof Date){r=Date.parse(r),c(e[t-1]);var i=e[t-1].calc();i instanceof Date&&(i=Date.parse(i)/s,r/=s,e.splice(t-1,1,new n(i)))}e.splice(t+1,1,new n(-r))}else e.splice(t,2,new n(-r))}}(e),f("^",e,(function(e,t){return Math.pow(+e,+t)})),f("/",e,(function(e,t){if(0==t)throw o.div0;return+e/+t})),f("*",e,(function(e,t){return+e*+t})),f("+",e,(function(e,t){return e instanceof Date&&"number"==typeof t&&(t*=s),+e+ +t})),f("&",e,(function(e,t){return""+e+t})),f("<",e,(function(e,t){return e<t})),f(">",e,(function(e,t){return e>t})),f(">=",e,(function(e,t){return e>=t})),f("<=",e,(function(e,t){return e<=t})),f("<>",e,(function(e,t){return e instanceof Date&&t instanceof Date?e.getTime()!==t.getTime():(!u(e)||!u(t))&&e!=t})),f("=",e,(function(e,t){return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!(!u(e)||!u(t))||(null==e&&0===t||0===e&&null==t||("string"==typeof e&&"string"==typeof t&&e.toLowerCase()===t.toLowerCase()||e==t))})),1==e.length)return"function"!=typeof e[0].calc?e[0]:e[0].calc()},r.push=function(n,i){if(n){var o=a(n,e,i);"="===o&&(">"==t||"<"==t)||"<"==t&&">"===o?r.args[r.args.length-1]+=o:r.args.push(o),t=o}}}},function(e,t,r){"use strict";e.exports=function(e){var t=this;t.name="UserFn",t.args=[],t.calc=function(){var r,n={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};try{r=e.apply(t,t.args.map((function(e){return e.calc()})))}catch(t){if("is_blank"===e.name&&void 0!==n[t.message])r=0;else{if("iserror"!==e.name||void 0===n[t.message])throw t;r=!0}}return r},t.push=function(e){t.args.push(e)}}},function(e,t,r){"use strict";e.exports=function(e){var t=this;t.name="UserRawFn",t.args=[],t.calc=function(){return e.apply(t,t.args)},t.push=function(e){t.args.push(e)}}},function(e,t,r){"use strict";var n=r(27),i=r(28),a=r(61),o=r(41);function s(e,t){if(t)for(var r in t)e[r]=t[r];return e}t.BETADIST=i.BETA.DIST,t.BETAINV=i.BETA.INV,t.BINOMDIST=i.BINOM.DIST,t.CEILING=t.ISOCEILING=s(n.CEILING.MATH,n.CEILING),t.CEILINGMATH=n.CEILING.MATH,t.CEILINGPRECISE=n.CEILING.PRECISE,t.CHIDIST=i.CHISQ.DIST,t.CHIDISTRT=i.CHISQ.DIST.RT,t.CHIINV=i.CHISQ.INV,t.CHIINVRT=i.CHISQ.INV.RT,t.CHITEST=i.CHISQ.TEST,t.CONFIDENCE=s(i.CONFIDENCE.NORM,i.CONFIDENCE),t.COVAR=i.COVARIANCE.P,t.COVARIANCEP=i.COVARIANCE.P,t.COVARIANCES=i.COVARIANCE.S,t.CRITBINOM=i.BINOM.INV,t.EXPONDIST=i.EXPON.DIST,t.ERFCPRECISE=a.ERFC.PRECISE,t.ERFPRECISE=a.ERF.PRECISE,t.FDIST=i.F.DIST,t.FDISTRT=i.F.DIST.RT,t.FINVRT=i.F.INV.RT,t.FINV=i.F.INV,t.FLOORMATH=n.FLOORMATH,t.FLOORPRECISE=n.FLOORPRACE,t.FTEST=i.F.TEST,t.GAMMADIST=i.GAMMA.DIST,t.GAMMAINV=i.GAMMA.INV,t.GAMMALNPRECISE=i.GAMMALN.PRECISE,t.HYPGEOMDIST=i.HYPGEOM.DIST,t.LOGINV=i.LOGNORM.INV,t.LOGNORMINV=i.LOGNORM.INV,t.LOGNORMDIST=i.LOGNORM.DIST,t.MODE=s(i.MODE.SNGL,i.MODE),t.MODEMULT=i.MODE.MULT,t.MODESNGL=i.MODE.SNGL,t.NEGBINOMDIST=i.NEGBINOM.DIST,t.NETWORKDAYSINTL=o.NETWORKDAYSINTL,t.NORMDIST=i.NORM.DIST,t.NORMINV=i.NORM.INV,t.NORMSDIST=i.NORM.S.DIST,t.NORMSINV=i.NORM.S.INV,t.PERCENTILE=s(i.PERCENTILE.EXC,i.PERCENTILE),t.PERCENTILEEXC=i.PERCENTILE.EXC,t.PERCENTILEINC=i.PERCENTILE.INC,t.PERCENTRANK=s(i.PERCENTRANK.INC,i.PERCENTRANK),t.PERCENTRANKEXC=i.PERCENTRANK.EXC,t.PERCENTRANKINC=i.PERCENTRANK.INC,t.POISSON=s(i.POISSON.DIST,i.POISSON),t.POISSONDIST=i.POISSON.DIST,t.QUARTILE=s(i.QUARTILE.INC,i.QUARTILE),t.QUARTILEEXC=i.QUARTILE.EXC,t.QUARTILEINC=i.QUARTILE.INC,t.RANK=s(i.RANK.EQ,i.RANK),t.RANKAVG=i.RANK.AVG,t.RANKEQ=i.RANK.EQ,t.SKEWP=i.SKEW.P,t.STDEV=s(i.STDEV.S,i.STDEV),t.STDEVP=i.STDEV.P,t.STDEVS=i.STDEV.S,t.TDIST=i.T.DIST,t.TDISTRT=i.T.DIST.RT,t.TINV=i.T.INV,t.TTEST=i.T.TEST,t.VARP=i.VAR.P,t.VARS=i.VAR.S,t.WEIBULL=s(i.WEIBULL.DIST,i.WEIBULL),t.WEIBULLDIST=i.WEIBULL.DIST,t.WORKDAYINTL=o.WORKDAYINTL,t.ZTEST=i.Z.TEST,t._XLFN=s(n.FLOOR.MATH,i.COVARIANCE.P,i.NORM.INV,i.VAR.P)},,function(e,t,r){"use strict";var n="=",i=[">",">=","<","<=","=","<>"],a="operator",o="literal",s=[a,o];function l(e,t){if(-1===s.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function u(e){for(var t,r="",s=[],u=0;u<e.length;u++){var c=e[u];0===u&&i.indexOf(c)>=0?s.push(l(c,a)):r+=c}return r.length>0&&s.push(l("string"!=typeof(t=r)?t:(/^\d+(\.\d+)?$/.test(t)&&(t=-1===t.indexOf(".")?parseInt(t,10):parseFloat(t)),t),o)),s.length>0&&s[0].type!==a&&s.unshift(l(n,a)),s}t.TOKEN_TYPE_OPERATOR=a,t.TOKEN_TYPE_LITERAL=o,t.parse=function(e){return u(function(e){for(var t=e.length,r=[],n=0,i="",a="";n<t;){var o=e.charAt(n);switch(o){case">":case"<":case"=":a+=o,i.length>0&&(r.push(i),i="");break;default:a.length>0&&(r.push(a),a=""),i+=o}n++}return i.length>0&&r.push(i),a.length>0&&r.push(a),r}(e))},t.createToken=l,t.compute=function(e){for(var t,r=[],n=0;n<e.length;n++){var i=e[n];switch(i.type){case a:t=i.value;break;case o:r.push(i.value)}}return function(e,t){var r=!1;switch(t){case">":r=e[0]>e[1];break;case">=":r=e[0]>=e[1];break;case"<":r=e[0]<e[1];break;case"<=":r=e[0]<=e[1];break;case"=":r=e[0]==e[1];break;case"<>":r=e[0]!=e[1]}return r}(r,t)}},,function(module,exports,__webpack_require__){"use strict";var error=__webpack_require__(9),stats=__webpack_require__(28),maths=__webpack_require__(27),utils=__webpack_require__(15);function compact(e){if(!e)return e;for(var t=[],r=0;r<e.length;++r)e[r]&&t.push(e[r]);return t}function find_result_idx(database,criteria){for(var valid_arr=[],filter_arr=[],i=0;i<criteria[0].length;i++)filter_arr.push(criteria[0][i]);for(var i=1;i<criteria.length;i++){for(var arr=criteria[i],valid_str=[],j=0;j<filter_arr.length;j++)null!=arr[j]&&valid_str.push(database[0].indexOf(criteria[0][j])+"-"+arr[j]);valid_arr.push(valid_str)}for(var result_idx=[],i=1;i<database.length;i++)for(var data=database[i],j=0;j<valid_arr.length;j++){for(var is_valid=!0,k=0;k<valid_arr[j].length;k++){var a=data[parseInt(valid_arr[j][k].split("-")[0])],b=valid_arr[j][k].split("-")[1];b.indexOf("=")>=0?is_valid=a==b.replace("=",""):eval(a+b)||(is_valid=!1)}is_valid&&result_idx.push(i)}return result_idx}function get_values(e,t,r){if("number"==typeof r)var n=r-1;else n=t[0].indexOf(r);for(var i=[],a=0;a<e.length;a++)i.push(t[e[a]][n]);return i}exports.FINDFIELD=function(e,t){for(var r=null,n=0;n<e.length;n++)if(e[n][0]===t){r=n;break}return null==r?error.value:r},exports.DAVERAGE=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;if("number"==typeof t)for(var n=[],i=1;i<e.length;i++)n.push(i);else n=find_result_idx(e,r);var a=get_values(n,e,t),o=0;for(i=0;i<a.length;i++)o+=a[i];return 0===n.length?error.div0:o/a.length},exports.DCOUNT=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.COUNT(n)},exports.DCOUNTA=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.COUNTA(n)},exports.DGET=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=find_result_idx(e,r);return n.length>1?error.num:get_values(n,e,t)[0]},exports.DMAX=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]>i&&(i=n[a]);return i},exports.DMIN=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]<i&&(i=n[a]);return i},exports.DPRODUCT=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=1,a=0;a<n.length;a++)i*=n[a];return i},exports.DSTDEV=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.S(n)},exports.DSTDEVP=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.P(n)},exports.DSUM=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return maths.SUM(n)},exports.DVAR=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.S(n)},exports.DVARP=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.P(n)}},function(e,t,r){"use strict";var n=r(9),i=r(15),a=r(40);t.AND=function(){for(var e=i.flatten(arguments),t=!0,r=0;r<e.length;r++)e[r]||(t=!1);return t},t.CHOOSE=function(){if(arguments.length<2)return n.na;var e=arguments[0];return e<1||e>254?n.value:arguments.length<e+1?n.value:arguments[e]},t.FALSE=function(){return!1},t.IF=function(e,t,r){return e?t:r},t.IFERROR=function(e,t){return a.ISERROR(e)?t:e},t.IFNA=function(e,t){return e===n.na?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=i.flatten(arguments),t=!1,r=0;r<e.length;r++)e[r]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=i.flatten(arguments),t=0,r=0;r<e.length;r++)e[r]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],r=arguments.length-1,i=Math.floor(r/2),a=!1,o=r%2==0?null:arguments[arguments.length-1];if(i)for(var s=0;s<i;s++)if(t===arguments[2*s+1]){e=arguments[2*s+2],a=!0;break}!a&&o&&(e=o)}return null==e?n.na:e}},function(e,t,r){"use strict";var n=r(9),i=r(41),a=r(15);function o(e){return e&&e.getTime&&!isNaN(e.getTime())}t.ACCRINT=function(e,t,r,s,l,u,c){"string"==typeof e&&(e=a.parseDate(e));try{e=a.ExcelDateToJSDate(e),t=a.ExcelDateToJSDate(t),r=a.ExcelDateToJSDate(r)}catch(e){return n.value}return o(e)&&o(t)&&o(r)?s<=0||l<=0?n.num:-1===[1,2,4].indexOf(u)?n.num:-1===[0,1,2,3,4].indexOf(c)?n.num:r<=e?n.num:(c=c||0,(l=l||0)*s*i.YEARFRAC(e,r,c)):n.value},t.ACCRINTM=function(e,t,r,o,s){try{e=a.ExcelDateToJSDate(e),t=a.ExcelDateToJSDate(t)}catch(e){return n.value}if(r<=0||o<=0)return n.num;if(s<0||s>4)return n.num;if(t<=e)return n.num;s=s||0;var l=(o=o||0)*r*i.YEARFRAC(e,t,s);return isNaN(l)?n.value:l},t.AMORDEGRC=function(e,t,r,i,a,s,l){return o(issue)&&o(settlement)?s<=0||par<=0?n.num:l<0||l>4?n.num:settlement<=issue?n.num:void 0:n.value},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.COUPDAYBS=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:e>=t?n.num:void 0:n.value},t.COUPDAYS=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPDAYSNC=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPNCD=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.numerror.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPNUM=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPPCD=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.CUMIPMT=function(e,r,i,o,s,l){if(e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;if(e<=0||r<=0||i<=0)return n.num;if(o<1||s<1||o>s)return n.num;if(0!==l&&1!==l)return n.num;var u=t.PMT(e,r,i,0,l),c=0;1===o&&0===l&&(c=-i,o++);for(var f=o;f<=s;f++)c+=1===l?t.FV(e,f-2,u,i,1)-u:t.FV(e,f-1,u,i,0);return c*=e},t.CUMPRINC=function(e,r,i,o,s,l){if(e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;if(e<=0||r<=0||i<=0)return n.num;if(o<1||s<1||o>s)return n.num;if(0!==l&&1!==l)return n.num;var u=t.PMT(e,r,i,0,l),c=0;1===o&&(c=0===l?u+i*e:u,o++);for(var f=o;f<=s;f++)c+=l>0?u-(t.FV(e,f-2,u,i,1)-u)*e:u-t.FV(e,f-1,u,i,0)*e;return c},t.DB=function(e,t,r,i,o){if(o=void 0===o?12:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;if(e<0||t<0||r<0||i<0)return n.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return n.num;if(i>r)return n.num;if(t>=e)return 0;for(var s=(1-Math.pow(t/e,1/r)).toFixed(3),l=e*s*o/12,u=l,c=0,f=i===r?r-1:i,h=2;h<=f;h++)u+=c=(e-u)*s;return 1===i?l:i===r?(e-u)*s:c},t.DDB=function(e,t,r,i,o){if(o=void 0===o?2:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;if(e<0||t<0||r<0||i<0||o<=0)return n.num;if(i>r)return n.num;if(t>=e)return 0;for(var s=0,l=0,u=1;u<=i;u++)s+=l=Math.min(o/r*(e-s),e-t-s);return l},t.DISC=function(e,t,r,a,o){if(r<=0||a<=0)return n.num;if(o<0||o>4)return n.num;if(e>=t)return n.num;return(a-r)/r*360/Math.abs(i.DAYS(t,e,!1))},t.DOLLARDE=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var i=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*i)/i},t.DOLLARFR=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.DURATION=function(e,t,r,i,s,l){return e=a.parseDate(e),o(t=a.parseDate(t))&&o(e)?l<0||l>4?n.num:e>=t?n.num:void 0:n.value},t.EFFECT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.FV=function(e,t,r,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var s;if(0===e)s=i+r*t;else{var l=Math.pow(1+e,t);s=1===o?i*l+r*(1+e)*(l-1)/e:i*l+r*(l-1)/e}return-s},t.FVSCHEDULE=function(e,t){if(e=a.parseNumber(e),"string"==typeof t&&(t=a.strToMatrix(t)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return n.value;for(var r=t.length,i=e,o=0;o<r;o++)i*=1+t[o];return i},t.INTRATE=function(e,t,r,i,a){if(r<=0||i<=0)return n.value;if(a<0||a>4)return n.num;if(e>=t)return n.num;return(i-r)/r*.5},t.IPMT=function(e,r,i,o,s,l){if(s=s||0,l=l||0,e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),s=a.parseNumber(s),l=a.parseNumber(l),a.anyIsError(e,r,i,o,s,l))return n.value;var u=t.PMT(e,i,o,s,l);return(1===r?1===l?0:-o:1===l?t.FV(e,r-2,u,o,1)-u:t.FV(e,r-1,u,o,0))*e},t.IRR=function(e,t){if(t=t||0,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;for(var r=function(e,t,r){for(var n=r+1,i=e[0],a=1;a<e.length;a++)i+=e[a]/Math.pow(n,(t[a]-t[0])/365);return i},i=function(e,t,r){for(var n=r+1,i=0,a=1;a<e.length;a++){var o=(t[a]-t[0])/365;i-=o*e[a]/Math.pow(n,o+1)}return i},o=[],s=!1,l=!1,u=0;u<e.length;u++)o[u]=0===u?0:o[u-1]+365,e[u]>0&&(s=!0),e[u]<0&&(l=!0);if(!s||!l)return n.num;var c,f,h,d=t=void 0===t?.1:t,p=!0;do{c=d-(h=r(e,o,d))/i(e,o,d),f=Math.abs(c-d),d=c,p=f>1e-10&&Math.abs(h)>1e-10}while(p);return d},t.ISPMT=function(e,t,r,i){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,t,r,i)?n.value:i*e*(t/r-1)},t.MDURATION=function(e,t,r,i,a,o){return r<0||i<0?n.num:o<0||o>4?n.num:-1===[1,2,4].indexOf(a)?n.num:void 0},t.MIRR=function(e,r,i){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;for(var o=e.length,s=[],l=[],u=0;u<o;u++)e[u]<0?s.push(e[u]):l.push(e[u]);var c=-t.NPV(i,l)*Math.pow(1+i,o-1),f=t.NPV(r,s)*(1+r);return Math.pow(c/f,1/(o-1))-1},t.NOMINAL=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,r,i,o){if(o=void 0===o?0:o,i=void 0===i?0:i,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var s=t*(1+e*o)-i*e,l=r*e+t*(1+e*o);return Math.log(s/l)/Math.log(1+e)},t.NPV=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],r=0,n=1;n<e.length;n++)r+=e[n]/Math.pow(1+t,n);return r},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:e<=0?n.num:(Math.log(r)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,r,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var s;if(0===e)s=(r+i)/t;else{var l=Math.pow(1+e,t);s=1===o?(i*e/(l-1)+r*e/(1-1/l))/(1+e):i*e/(l-1)+r*e/(1-1/l)}return-s},t.PPMT=function(e,r,i,o,s,l){return s=s||0,l=l||0,e=a.parseNumber(e),i=a.parseNumber(i),o=a.parseNumber(o),s=a.parseNumber(s),l=a.parseNumber(l),a.anyIsError(e,i,o,s,l)?n.value:t.PMT(e,i,o,s,l)-t.IPMT(e,r,i,o,s,l)},t.PRICE=function(e,t,r,o,s,l,u){if(e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t))return n.value;if(u<0||u>4)return n.na;if(e>=t)return n.na;var c=Math.abs(i.DAYS(e,t,!1));return s-discount*s*c/360},t.PRICEDISC=function(e,t,r,o,s){return e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t)?n.value:s<0||s>4?n.na:e>=t?n.na:o-r*o*Math.abs(i.DAYS(e,t,!1))/360},t.PRICEMAT=function(e,t,r,o,s,l){if(e=a.parseDate(e),t=a.parseDate(t),r=a.parseDate(r),a.anyIsError(e,t))return n.value;if(l<0||l>4)return n.na;if(e>=t)return n.na;var u=Math.abs(i.DAYS(e,t,!1));return(100+Math.abs(i.DAYS(t,r,!1))/360*o*100)/(1+u/360*s)-Math.abs(i.DAYS(r,e,!1))/360*o*100},t.PV=function(e,t,r,i,o){return i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o)?n.value:0===e?-r*t-i:((1-Math.pow(1+e,t))/e*r*(1+e*o)-i)/Math.pow(1+e,t)},t.RATE=function(e,t,r,i,o,s){if(s=void 0===s?.01:s,i=void 0===i?0:i,o=void 0===o?0:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),s=a.parseNumber(s),a.anyIsError(e,t,r,i,o,s))return n.value;for(var l=0,u=!1,c=s;l<100&&!u;){var f=Math.pow(c+1,e),h=Math.pow(c+1,e-1),d=c-(i+f*r+t*(f-1)*(c*o+1)/c)/(e*h*r-t*(f-1)*(c*o+1)/Math.pow(c,2)+(e*t*h*(c*o+1)/c+t*(f-1)*o/c));Math.abs(d-c)<1e-6&&(u=!0),l++,c=d}return u?c:Number.NaN+c},t.RECEIVED=function(e,t,r,o,s){return e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t)?n.value:r<=0||o<=0?n.na:s<0||s>4?n.na:e>=t?n.na:r/(1-o*Math.abs(i.DAYS(e,t,!1))/360)},t.RRI=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:0===e||0===t?n.num:Math.pow(r/t,1/e)-1},t.SLN=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:0===r?n.num:(e-t)/r},t.SYD=function(e,t,r,i){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,t,r,i)?n.value:0===r?n.num:i<1||i>r?n.num:(e-t)*(r-(i=parseInt(i,10))+1)*2/(r*(r+1))},t.TBILLEQ=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:365*r/(360-r*i.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:100*(1-r*i.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:360*(100-r)/(r*i.DAYS360(e,t,!1))},t.VDB=function(){throw new Error("VDB is not implemented")},t.XIRR=function(e,t,r){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseDateArray(a.flatten(t)),r=a.parseNumber(r),a.anyIsError(e,t,r))return n.value;for(var o=function(e,t,r){for(var n=r+1,a=e[0],o=1;o<e.length;o++)a+=e[o]/Math.pow(n,i.DAYS(t[o],t[0])/365);return a},s=function(e,t,r){for(var n=r+1,a=0,o=1;o<e.length;o++){var s=i.DAYS(t[o],t[0])/365;a-=s*e[o]/Math.pow(n,s+1)}return a},l=!1,u=!1,c=0;c<e.length;c++)e[c]>0&&(l=!0),e[c]<0&&(u=!0);if(!l||!u)return n.num;var f,h,d,p=r=r||.1,v=!0;do{f=p-(d=o(e,t,p))/s(e,t,p),h=Math.abs(f-p),p=f,v=h>1e-10&&Math.abs(d)>1e-10}while(v);return p},t.XNPV=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),r=a.parseDateArray(a.flatten(r)),a.anyIsError(e,t,r))return n.value;for(var o=0,s=0;s<t.length;s++)o+=t[s]/Math.pow(1+e,i.DAYS(r[s],r[0])/365);return o},t.YIELD=function(e,t,r,o,s,l,u){if(e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t))return n.value;if(r<=0)return n.num;if(o<=0)return n.num;if(s<=0)return n.num;if(e>=t)return n.num;Math.abs(i.DAYS(e,t,!1))},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,r){"use strict";var n=r(9),i=r(15);function a(e,t){for(var r,i,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]<t&&(i?e[a]>i&&(r=a+1,i=e[a]):(r=a+1,i=e[a]))}return r||n.na}function o(e,t){for(var r=0;r<e.length;r++)if(t=t.replace(/\?/g,"."),Array.isArray(e[r])){if(1===e[r].length&&"string"==typeof e[r][0]&&e[r][0].toLowerCase()===t.toLowerCase())return r+1}else if("string"==typeof e[r]&&e[r].toLowerCase()===t.toLowerCase())return r+1;return n.na}function s(e,t){for(var r=0;r<e.length;r++)if(Array.isArray(e[r])){if(1===e[r].length&&e[r][0]===t)return r+1}else if(e[r]===t)return r+1;return n.na}function l(e,t){for(var r,i,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]>t&&(i?e[a]<i&&(r=a+1,i=e[a]):(r=a+1,i=e[a]))}return r||n.na}t.MATCH=function(e,t,r){if(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),!e&&!t)return n.na;if(2===arguments.length&&(r=1),!(t instanceof Array))return n.na;if(0===r)return"string"==typeof e?o(t,e):s(t,e);if(1===r)return a(t,e);if(-1===r){for(var i=t[0][0],u=1;u<t.length;u++)if(t[u][0]>i)return n.na;return l(t,e)}return n.na},t.VLOOKUP=function(e,t,r,i){if("string"==typeof i&&"FALSE"!=i&&"TRUE"!=i)return n.value;i="FALSE"!=i;for(var a=0;a<t.length;a++)if(t[a][0]==e)return t[a][r-1];return n.na},t.HLOOKUP=function(e,t,r,a){if("TRUE"==a&&(a=!0),"FALSE"==a&&(a=!1),"string"==typeof t&&t.indexOf("{")>=0&&(t=i.strToMatrix(t)),void 0===e||t[0].indexOf(e)<0)return n.na;r=r||0;for(var o=t[0],s=0;s<o.length;s++)if(a&&o[s]===e||-1!==o[s].toString().toLowerCase().indexOf(e.toString().toLowerCase()))return r<t.length+1?t[r-1][s]:t[0][s];return n.na}},function(e,t,r){"use strict";var n=r(9);function i(e,t,r){this.name=e,this.type=t,this.url=r}t.PQUERY=function(){if(5!==arguments.length)return n.error;if(arguments[0].length!==arguments[1].length)return n.error;if(arguments[1].length!==arguments[3].length)return n.error;for(var e=[],t=arguments[4],r=0;r<arguments[3].length;r++)arguments[3][r]=parseFloat(arguments[3][r]),isNaN(arguments[3][r])||e.push({number:r,value:Math.abs(arguments[3][r]-t)});e=e.sort((function(e,t){var r=e.value,n=t.value;return r<n?-1:r>n?1:0}));for(var i=[],a=1,o=0;o<e.length;o++){var s=e[o],l=s.number,u=s.value,c=arguments[0][l][0],f=arguments[1][l][0],h=arguments[3][l];f===arguments[2]&&(i.push({number:a,name:c,city:f,area:h,value:u}),a+=1)}return"*悬浮查看*!"+JSON.stringify(i)},t.HYPERLINK=function(){if(console.log(arguments),!arguments||!arguments[0]||!arguments[1])return n.na;var e=arguments[0];e="http://"==e.substr(0,7).toLowerCase()||"https://"==e.substr(0,8).toLowerCase()?e:"http://"+e;var t={text:arguments[1],url:e};return"*HYPERLINK*!"+JSON.stringify(t)+" "};!function(e){e.push(new i("合肥",0,"https://hf.lianjia.com/ditu")),e.push(new i("安庆",0,"https://aq.lianjia.com/ditu")),e.push(new i("滁州",0,"https://cz.fang.lianjia.com/ditu/")),e.push(new i("马鞍山",0,"https://mas.lianjia.com/ditu")),e.push(new i("北京",0,"https://bj.lianjia.com/ditu")),e.push(new i("重庆",0,"https://cq.lianjia.com/ditu")),e.push(new i("福州",0,"https://fz.lianjia.com/ditu")),e.push(new i("泉州",0,"https://quanzhou.lianjia.com/ditu")),e.push(new i("厦门",0,"https://xm.lianjia.com/ditu")),e.push(new i("漳州",0,"https://zhangzhou.lianjia.com/ditu")),e.push(new i("东莞",0,"https://dg.lianjia.com/ditu")),e.push(new i("佛山",0,"https://fs.lianjia.com/ditu")),e.push(new i("广州",0,"https://gz.lianjia.com/ditu")),e.push(new i("惠州",0,"https://hui.lianjia.com/ditu")),e.push(new i("江门",0,"https://jiangmen.lianjia.com/ditu")),e.push(new i("清远",0,"https://qy.lianjia.com/ditu")),e.push(new i("深圳",0,"https://sz.lianjia.com/ditu")),e.push(new i("珠海",0,"https://zh.lianjia.com/ditu")),e.push(new i("湛江",0,"https://zhanjiang.lianjia.com/ditu")),e.push(new i("中山",0,"https://zs.lianjia.com/ditu")),e.push(new i("贵阳",0,"https://gy.lianjia.com/ditu")),e.push(new i("北海",0,"https://bh.lianjia.com/ditu")),e.push(new i("防城港",0,"https://fcg.lianjia.com/ditu")),e.push(new i("桂林",0,"https://gl.lianjia.com/ditu")),e.push(new i("柳州",0,"https://liuzhou.lianjia.com/ditu")),e.push(new i("南宁",0,"https://nn.lianjia.com/ditu")),e.push(new i("兰州",0,"https://lz.lianjia.com/ditu")),e.push(new i("鄂州",0,"https://ez.lianjia.com/ditu")),e.push(new i("黄石",0,"https://huangshi.lianjia.com/ditu")),e.push(new i("武汉",0,"https://wh.lianjia.com/ditu")),e.push(new i("襄阳",0,"https://xy.lianjia.com/ditu")),e.push(new i("宜昌",0,"https://yichang.lianjia.com/ditu")),e.push(new i("长沙",0,"https://cs.lianjia.com/ditu")),e.push(new i("常德",0,"https://changde.lianjia.com/ditu")),e.push(new i("岳阳",0,"https://yy.lianjia.com/ditu")),e.push(new i("株洲",0,"https://zhuzhou.lianjia.com/ditu")),e.push(new i("保定",0,"https://bd.lianjia.com/ditu")),e.push(new i("廊坊",0,"https://lf.lianjia.com/ditu")),e.push(new i("秦皇岛",0,"https://qhd.fang.lianjia.com/ditu")),e.push(new i("石家庄",0,"https://sjz.lianjia.com/ditu")),e.push(new i("唐山",0,"https://ts.lianjia.com/ditu")),e.push(new i("张家口",0,"https://zjk.lianjia.com/ditu")),e.push(new i("保亭",0,"https://bt.fang.lianjia.com/ditu")),e.push(new i("澄迈",0,"https://cm.fang.lianjia.com/ditu")),e.push(new i("儋州",0,"https://dz.fang.lianjia.com/ditu")),e.push(new i("海口",0,"https://hk.lianjia.com/ditu")),e.push(new i("临高",0,"https://lg.fang.lianjia.com/ditu")),e.push(new i("乐东",0,"https://ld.fang.lianjia.com/ditu")),e.push(new i("陵水",0,"https://ls.fang.lianjia.com/ditu")),e.push(new i("琼海",0,"https://qh.fang.lianjia.com/ditu")),e.push(new i("三亚",0,"https://san.lianjia.com/ditu")),e.push(new i("五指山",0,"https://wzs.fang.lianjia.com/ditu")),e.push(new i("文昌",0,"https://wc.fang.lianjia.com/ditu")),e.push(new i("万宁",0,"https://wn.fang.lianjia.com/ditu")),e.push(new i("开封",0,"https://kf.lianjia.com/ditu")),e.push(new i("洛阳",0,"https://luoyang.lianjia.com/ditu")),e.push(new i("新乡",0,"https://xinxiang.lianjia.com/ditu")),e.push(new i("许昌",0,"https://xc.lianjia.com/ditu")),e.push(new i("郑州",0,"https://zz.lianjia.com/ditu")),e.push(new i("哈尔滨",0,"https://kf.lianjia.com/ditu")),e.push(new i("常州",0,"https://changzhou.lianjia.com/ditu")),e.push(new i("淮安",0,"https://ha.lianjia.com/ditu")),e.push(new i("昆山",0,"https://ks.lianjia.com/ditu")),e.push(new i("南京",0,"https://nj.lianjia.com/ditu/")),e.push(new i("南通",0,"https://nt.lianjia.com/ditu")),e.push(new i("苏州",0,"https://su.lianjia.com/ditu")),e.push(new i("无锡",0,"https://wx.lianjia.com/ditu")),e.push(new i("徐州",0,"https://xz.lianjia.com/ditu")),e.push(new i("盐城",0,"https://yc.lianjia.com/ditu")),e.push(new i("镇江",0,"https://zj.lianjia.com/ditu")),e.push(new i("长春",0,"https://cc.lianjia.com/ditu/")),e.push(new i("吉林",0,"https://jl.lianjia.com/ditu")),e.push(new i("赣州",0,"https://ganzhou.lianjia.com/ditu")),e.push(new i("九江",0,"https://jiujiang.lianjia.com/ditu")),e.push(new i("吉安",0,"https://jian.lianjia.com/ditu")),e.push(new i("南昌",0,"https://nc.lianjia.com/ditu")),e.push(new i("上饶",0,"https://sr.lianjia.com/ditu")),e.push(new i("大连",0,"https://dl.lianjia.com/ditu")),e.push(new i("丹东",0,"https://dd.lianjia.com/ditu")),e.push(new i("沈阳",0,"https://sy.lianjia.com/ditu")),e.push(new i("呼和浩特",0,"https://hhht.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("上海",0,"https://sh.lianjia.com/ditu")),e.push(new i("成都",0,"https://cd.lianjia.com/ditu")),e.push(new i("德阳",0,"https://dy.fang.lianjia.com/ditu")),e.push(new i("达州",0,"https://dazhou.lianjia.com/ditu")),e.push(new i("乐山",0,"https://leshan.fang.lianjia.com/ditu")),e.push(new i("凉山",0,"https://liangshan.lianjia.com/ditu")),e.push(new i("绵阳",0,"https://mianyang.lianjia.com/ditu")),e.push(new i("眉山",0,"https://ms.fang.lianjia.com/ditu")),e.push(new i("南充",0,"https://nanchong.lianjia.com/ditu")),e.push(new i("济南",0,"https://jn.lianjia.com/ditu")),e.push(new i("临沂",0,"https://linyi.lianjia.com/ditu")),e.push(new i("青岛",0,"https://qd.lianjia.com/ditu")),e.push(new i("潍坊",0,"https://wf.lianjia.com/ditu")),e.push(new i("威海",0,"https://weihai.lianjia.com/ditu")),e.push(new i("烟台",0,"https://yt.lianjia.com/ditu")),e.push(new i("淄博",0,"https://zb.lianjia.com/ditu")),e.push(new i("宝鸡",0,"https://baoji.lianjia.com/ditu")),e.push(new i("汉中",0,"https://hanzhong.lianjia.com/ditu")),e.push(new i("西安",0,"https://xa.lianjia.com/ditu")),e.push(new i("咸阳",0,"https://xianyang.lianjia.com/ditu")),e.push(new i("晋中",0,"https://jz.fang.lianjia.com/ditu")),e.push(new i("太原",0,"https://ty.lianjia.com/ditu")),e.push(new i("天津",0,"https://tj.lianjia.com/ditu")),e.push(new i("大理",0,"https://dali.lianjia.com/ditu")),e.push(new i("昆明",0,"https://km.lianjia.com/ditu")),e.push(new i("西双版纳",0,"https://xsbn.fang.lianjia.com/ditu")),e.push(new i("杭州",0,"https://hz.lianjia.com/ditu")),e.push(new i("湖州",0,"https://huzhou.lianjia.com/ditu")),e.push(new i("嘉兴",0,"https://jx.lianjia.com/ditu")),e.push(new i("金华",0,"https://jh.lianjia.com/ditu")),e.push(new i("宁波",0,"https://nb.lianjia.com/ditu")),e.push(new i("绍兴",0,"https://sx.lianjia.com/ditu")),e.push(new i("台州",0,"https://taizhou.lianjia.com/ditu")),e.push(new i("温州",0,"https://wz.lianjia.comditu"))}([]);!function(e){e.push(new i("北京",0,"https://bj.5i5j.com/map")),e.push(new i("杭州",0,"https://hz.5i5j.com/map")),e.push(new i("青岛",0,"https://qd.5i5j.com/map")),e.push(new i("天津",0,"https://tj.5i5j.com/map")),e.push(new i("太原",0,"https://zz.5i5j.com/map")),e.push(new i("郑州",0,"https://zz.5i5j.com/map")),e.push(new i("成都",0,"https://cd.5i5j.com/map")),e.push(new i("长沙",0,"https://cs.5i5j.com/map")),e.push(new i("南昌",0,"https://nc.5i5j.com/map")),e.push(new i("南京",0,"https://nj.5i5j.com/map")),e.push(new i("南宁",0,"https://nn.5i5j.com/map")),e.push(new i("上海",0,"https://sh.5i5j.com/map")),e.push(new i("苏州",0,"https://sz.5i5j.com/map")),e.push(new i("武汉",0,"https://wh.5i5j.com/map")),e.push(new i("无锡",0,"https://wx.5i5j.com/map"))}([]);!function(e){e.push(new i("全国",0,"https://www1.fang.com"))}([])},function(e,t,r){"use strict";var n=r(36),i=r(37),a=r(22),o=r(38),s=r(55);e.exports={OFFSET:function(e,t,r,l,u){if(l=(l||new a(1)).calc(),u=(u||new a(1)).calc(),1===e.args.length&&"RefValue"===e.args[0].name){var c=e.args[0],f=c.parseRef(),h=i(f.cell_name)+r.calc(),d=n(h),p=+f.cell_name.replace(/^[A-Z]+/g,"")+t.calc(),v=d+p;if(1===l&&1===u)return new s(v,c.formula).calc();var g=n(h+u-1)+(p+l-1),m=f.sheet_name+"!"+v+":"+g;return new o(m,c.formula).calc()}},IFERROR:function(e,t){try{var r=e.calc();return"number"!=typeof r||!isNaN(r)&&r!==1/0&&r!==-1/0?r:t.calc()}catch(e){return t.calc()}},IF:function(e,t,r){return e.calc()?t.calc():r.calc()},AND:function(){for(var e=0;e<arguments.length;e++)if(!arguments[e].calc())return!1;return!0}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(22),o=r(54),s=r(62),l=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workbook=t,this.expressions=[],this.exec_formula=r,this.variables={},this.formulas=s(t,r);for(var n=this.formulas.length-1;n>=0;n--){var i=r.build_expression(this.formulas[n]);this.expressions.push(i)}this.calcNames()}var t,r,l;return t=e,(r=[{key:"setVar",value:function(e,t){var r=this,n=this.variables[e];n?n.setValue(t):this.expressions.forEach((function(n){r.setVarOfExpression(n,e,t)}))}},{key:"getVars",value:function(){var e={};for(var t in this.variables)e[t]=this.variables[t].calc();return e}},{key:"calcNames",value:function(){var e=this;this.workbook&&this.workbook.Workbook&&this.workbook.Workbook.Names&&this.workbook.Workbook.Names.forEach((function(t){var r=e.getRef(t.Ref);e.variables[t.Name]=r,e.expressions.forEach((function(r){e.setVarOfExpression(r,t.Name)}))}))}},{key:"getRef",value:function(e){if(!this.formulas.length)throw new Error("No formula found.");var t={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return o(e,t)}},{key:"setVarOfExpression",value:function(e,t,r){for(var i=0;i<e.args.length;i++){var o=e.args[i];o===t?e.args[i]=this.variables[t]||(this.variables[t]=new a(r)):"object"!==n(o)||"Expression"!==o.name&&"UserFn"!==o.name||this.setVarOfExpression(o,t,r)}}},{key:"execute",value:function(){this.expressions.forEach((function(e){e.update_cell_value()}))}}])&&i(t.prototype,r),l&&i(t,l),e}();e.exports=l},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(63),a=r(9),o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cell=t.cell,this.rows=r,this.f=t.cell.f,this.name=t.name,this.sheet=t.sheet}var t,r,o;return t=e,(r=[{key:"check_valid",value:function(){var e=this.f;return"="===e[1]?a.name:null!=e.match("=[a-z|A-Z]{2,100}")&&this.f.indexOf("(")<0&&this.f.indexOf(")")<0?a.name:!(this.f.indexOf('""')>=1&&this.f.indexOf("(")<0&&this.f.indexOf(")")<0)||this.f.slice(2,this.f.length-1).replace('""','"')}},{key:"trans_params",value:function(e){var t=new RegExp("{(.*?)}","g"),r=e.match(t);if(null!=r)for(var n=0;n<r.length;n++){var i=r[n],a="'"+i+"'";e=e.replace(i,a)}return e}},{key:"trans_formula",value:function(){var e=this.f;return e=i.strim(e),(e=i.trans_formula(e)).indexOf("{")>=0&&e.indexOf("}")>=0&&e.indexOf("'{")<0&&(e=this.trans_params(e)),e}},{key:"recover_formula",value:function(){return i.strim(this.f)}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=o},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(4),a=r(9);function o(e){return void 0!==e&&null!==e}var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rows=t,this.tileArr=r}var t,r,s;return t=e,(r=[{key:"get_workbook",value:function(e){for(var t=this.rows.data.name,r=this.tileArr.findAllNeedCalcCell(),n=0;n<r.length;n++){var a=r[n],s=i.expr2xy(a),l=this.rows.getCell(s[1],s[0]);o(l)&&(e.Sheets[t][a]={v:l.text,f:l.formulas,multivalueRefsCell:l.multivalueRefsCell,source_v:l.source_v})}return e}},{key:"calcDoneToSetCells",value:function(e,t){var r=t.data.name,n=e.Sheets[r];Object.keys(n).forEach((function(e){var r=i.expr2xy(e);if(o(n[e])&&o(n[e].v)&&o(n[e].f)){var a=t.getCell(r[1],r[0]);o(a)||(a={}),a.text=n[e].v,a.formulas=n[e].f,a.multivalueRefsCell=n[e].multivalueRefsCell,o(n[e].source_v)&&(a.source_v=n[e].source_v),t.setCell(r[1],r[0],a)}})),t.workbook=e}},{key:"is_muti_cell",value:function(e){var t=e.cell;return null!==t&&(t=t.multivalueRefsCell),!!o(t)}},{key:"process_arr",value:function(){}},{key:"process_matrix",value:function(e,t){for(var r,n,a=!0,s=e.cell.v,l=i.expr2xy(t),u=l[0],c=l[1],f=s.length,h="",d=0,p=e.sheet,v=0;v<f;v++)for(var g=0;g<s[v].length;g++){var m=i.xy2expr(u+v,c+g),y=s[v][g];if(0===v&&0===g)p[m]={v:y,f:e.cell.f,multivalueRefsCell:t};else{var b=this.rows.getCell(c+g,u+v);!o(b)||!o(b.text)||o(b.text)&&(r=b.text,n=y,n+="",(r=(r+="").toUpperCase())===(n=n.toUpperCase())||""===b.text)?p[m]={v:s[v][g],f:s[v][g],multivalueRefsCell:t}:(p[m]={v:b.v,f:b.f,multivalueRefsCell:t},a=!1,h=b,d=m)}}return a?p:this.clean_matrix(p,s,h,t,d)}},{key:"clean_matrix",value:function(e,t,r,n,o){for(var s=i.expr2xy(n),l=s[0],u=s[1],c=t.length,f=0;f<c;f++)for(var h=0;h<t[f].length;h++){var d=i.xy2expr(l+f,u+h);e[d]=0===f&&0===h?{v:a.ref,f:e[d].f,multivalueRefsCell:n}:o===d?{v:r.text,f:r.formulas,multivalueRefsCell:n}:{v:"",f:""}}return e}},{key:"clean_all_flag",value:function(e,t){for(var r=e.sheet,n=i.expr2xy(t),a=n[0],o=n[1],s=this.rows.getCell(n[1],n[0]).source_v,l=s.length,u=0;u<l;u++)for(var c=0;c<s[u].length;c++){var f=i.xy2expr(a+u,o+c);0===u&&0===c?r[f]={v:e.cell.v,f:e.cell.f,source_v:""}:this.rows.getCell(o+c,a+u).text!==s[u][c]?r[f]={v:this.rows.getCell(o+c,a+u).text,f:this.rows.getCell(o+c,a+u).formulas}:r[f]={v:"",f:""}}return r}},{key:"deal_muti_cell",value:function(e,t){var r=t.cell,n=this.rows.data.name;r=o(r)&&o(r.multivalueRefsCell)?r.multivalueRefsCell:t.name;var s=t.cell.v;if(t.name!==r)s instanceof Array?(e.Sheets[n][t.name].v=a.ref,e.Sheets[n][t.name].source_v=s):o(s)&&(e.Sheets[n][t.name].v=s);else if(s instanceof Array){var l=i.expr2xy(r);o(this.rows.getCell(l[1],l[0]).source_v)&&this.rows.getCell(l[1],l[0]).source_v!==s&&(e.Sheets[n]=this.clean_all_flag(t,r)),1===s.length?(e.Sheets[n]=this.process_arr(t,r),e.Sheets[n][t.name].source_v=s):(e.Sheets[n]=this.process_matrix(t,r),e.Sheets[n][t.name].source_v=s)}else e.Sheets[n]=this.clean_all_flag(t,r)}}])&&n(t.prototype,r),s&&n(t,s),e}();e.exports=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=new n.CellRange(0,0,0,0),this.ri=0,this.ci=0}var t,r,a;return t=e,(r=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(e,t){this.ri=e,this.ci=t}},{key:"size",value:function(){return this.range.size()}}])&&i(t.prototype,r),a&&i(t,a),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.ri=0,this.ci=0}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="clear"}var t,r,i;return t=e,(r=[{key:"copy",value:function(e){return this.range=e,this.state="copy",this}},{key:"cut",value:function(e){return this.range=e,this.state="cut",this}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}var s=function(){function e(t,r,n){i(this,e),this.ci=t,this.operator=r,this.value=n}return o(e,[{key:"set",value:function(e,t){this.operator=e,this.value=t}},{key:"includes",value:function(e){var t=this.operator,r=this.value;return"all"===t||"in"===t&&r.includes(e)}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),e}(),l=function(){function e(t,r){i(this,e),this.ci=t,this.order=r}return o(e,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),e}(),u=function(){function e(){i(this,e),this.ref=null,this.filters=[],this.sort=null,this.flex=[]}return o(e,[{key:"setData",value:function(e){var t=e.ref,r=e.filters,n=e.sort;null!=t&&(this.ref=t,this.fitlers=r.map((function(e){return new s(e.ci,e.operator,e.value)})),n&&(this.sort=new l(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var e=this.ref,t=this.filters,r=this.sort;return{ref:e,filters:t.map((function(e){return e.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(e,t,r){var n=this.getFilter(e);null==n?this.filters.push(new s(e,t,r)):n.set(t,r)}},{key:"addFiexRows",value:function(e){this.flex=e}},{key:"setSort",value:function(e,t){this.sort=t?new l(e,t):null}},{key:"includes",value:function(e,t){return!!this.active()&&this.hrange().includes(e,t)}},{key:"getSet",value:function(e,t){for(var r=0;r<this.flex.length;r++)for(var n=this.flex[r],i=n.ri,a=n.set_total,o=n.state,s=i;s<a+i;s++)console.log(o,"114",t,i,o),!1===o&&t===i?(e.add(s+1),this.flex[r].state=!0):!0===o&&t===i&&(e.delete(s+1),this.flex[r].state=!1);return e}},{key:"includes2",value:function(e,t){for(var r=!1,n=0;n<this.flex.length;n++){var i=this.flex[n],a=i.ri,o=i.ci;e===a&&t===o&&(r=!0)}return r}},{key:"getSort",value:function(e){var t=this.sort;return t&&t.ci===e?t:null}},{key:"getFilter",value:function(e){for(var t=this.filters,r=0;r<t.length;r+=1)if(t[r].ci===e)return t[r];return null}},{key:"filteredRows",value:function(e){var t=new Set,r=new Set;if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=this.filters,s=i+1;s<=a;s+=1)for(var l=0;l<o.length;l+=1){var u=o[l],c=e(s,u.ci),f=c?c.text:"";if(!u.includes(f)){t.add(s);break}r.add(s)}return{rset:t,fset:r}}},{key:"items",value:function(e,t){var r={};if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=i+1;o<=a;o+=1){var s=t(o,e);if(null===s||/^\s*$/.test(s.text))r[""]=(r[""]||0)+1;else{var l=s.text;r[l]=(r[l]||0)+1}}return r}},{key:"range",value:function(){return n.CellRange.valueOf(this.ref)}},{key:"hrange",value:function(){var e=this.range();return e.eri=e.sri,e}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Merges=void 0;var n=r(6);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._=t}var t,r,a;return t=e,(r=[{key:"forEach",value:function(e){this._.forEach(e)}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"deleteWithin",value:function(e){this._=this._.filter((function(t){return!t.within(e)}))}},{key:"getFirstIncludes",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"filterIntersects",value:function(t){return new e(this._.filter((function(e){return e.intersects(t)})))}},{key:"intersects",value:function(e){for(var t=0;t<this._.length;t+=1)if(this._[t].intersects(e))return!0;return!1}},{key:"union",value:function(e){var t=e;return this._.forEach((function(e){e.intersects(t)&&(t=e.union(t))})),t}},{key:"add",value:function(e){this.deleteWithin(e),this._.push(e)}},{key:"shift",value:function(e,t,r,n){this._.forEach((function(i){var a=i.sri,o=i.sci,s=i.eri,l=i.eci,u=i;"row"===e?a>=t?(u.sri+=r,u.eri+=r):a<t&&t<=s&&(u.eri+=r,n(a,o,r,0)):"column"===e&&(o>=t?(u.sci+=r,u.eci+=r):o<t&&t<=l&&(u.eci+=r,n(a,o,0,r)))}))}},{key:"move",value:function(e,t,r){this._.forEach((function(n){var i=n;i.within(e)&&(i.eri+=t,i.sri+=t,i.sci+=r,i.eci+=r)}))}},{key:"setData",value:function(e){return this._=e.map((function(e){return n.CellRange.valueOf(e)})),this}},{key:"getData",value:function(){return this._.map((function(e){return e.toString()}))}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Merges=a},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6))&&n.__esModule?n:{default:n};function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.srcCellRange="",this.dstCellRange="",this.srcOneDRange="",this.dstOneDRange=""}var t,r,n;return t=e,(r=[{key:"setSrcAndDstCellRange",value:function(e,t){this.srcCellRange=e,this.dstCellRange=t}},{key:"use",value:function(){var e=this.srcCellRange,t=this.dstCellRange,r=e.sri,n=e.sci,i=e.eri,o=e.eci,s=t.sri,l=t.sci,u=t.eri,c=t.eci,f=a(e.size(),2),h=f[0],d=f[1],p=a(t.size(),2);return{sri:r,sci:n,eri:i,eci:o,dsri:s,dsci:l,deri:u,deci:c,rn:h,cn:d,drn:p[0],dcn:p[1]}}},{key:"autoFilterDirection",value:function(){var e=this.use(),t=e.sri,r=e.dsri,n=e.deri,i=e.eri,a=!1;return t===r&&n===i&&(a=!0),a}},{key:"upOrDown",value:function(){var e=this.use(),t=e.deri,r=e.sri,n=e.deci,i=e.sci,a=!0;return(t<r||n<i)&&(a=!1),a}},{key:"leftOrRight",value:function(){var e=this.getRangeByWay(),t=e.srcOneDRange,r=e.dstOneDRange,n=1;return t.sri===t.eri&&r.eci>t.eci?n=2:t.sri===t.eri&&r.eci<t.eci&&(n=3),n}},{key:"getOneDRangeObj",value:function(e,t){var r=this.use(),n=r.sri,a=r.sci,o=r.eri,s=r.eci,l=r.dsri,u=r.dsci,c=r.deri,f=r.deci;return e?(this.srcOneDRange=new i.default(n+t,a,n+t,s),this.dstOneDRange=new i.default(l+t,u,l+t,f)):(this.srcOneDRange=new i.default(n,a+t,o,a+t),this.dstOneDRange=new i.default(l,u+t,c,u+t)),this.getRangeByWay()}},{key:"getRangeByWay",value:function(){return{srcOneDRange:this.srcOneDRange,dstOneDRange:this.dstOneDRange}}},{key:"calcDiff",value:function(e,t){var r=1;if(t||(r=1),t&&e.length>1){var n=e[e.length-2];r=1*e[e.length-1].text-1*n.text}else if(e.length>1){var i=e[1];r=1*e[0].text-1*i.text}return isNaN(r)&&(r=1),r}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(3);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text="",this.depend=[],this.formulas="",this.style=null,this.merge=null,this.formatText=null,this.multivalueRefsCell=null,this.source_v=null}var t,r,a;return t=e,(r=[{key:"setCell",value:function(e){(0,n.isHave)(e)&&((0,n.isHave)(e.text)&&(this.text=e.text),(0,n.isHave)(e.formulas)&&(this.formulas=e.formulas),(0,n.isHave)(e.formatText)&&(this.formatText=e.formatText),(0,n.isHave)(e.depend)&&(this.depend=e.depend),(0,n.isHave)(e.style)&&(this.style=e.style),(0,n.isHave)(e.multivalueRefsCell)&&(this.multivalueRefsCell=e.multivalueRefsCell),(0,n.isHave)(e.merge)&&(this.merge=e.merge),(0,n.isHave)(e.source_v)&&(this.source_v=e.source_v))}},{key:"setFormatText",value:function(e){e.state&&(this.formatText=e.text)}}])&&i(t.prototype,r),a&&i(t,a),e}();t.default=a},function(e,t,r){"use strict";var n=r(4),i=r(3);t.Rows2Workbook=function(e){var t=e._,r={Sheets:{}},a=e.data.name;return r.Sheets[a]={},Object.keys(t).forEach((function(o){Object.keys(t[o].cells).forEach((function(t){var s=e.getCell(o,t),l=n.xy2expr(t,o);i.isHave(s)&&(r.Sheets[a][l]={v:s.text,f:s.formulas,multivalueRefsCell:s.multivalueRefsCell,source_v:s.source_v})}))})),r},t.Rows2Workbook=function(e){var t=e._,r={Sheets:{}},a=e.data.name;return r.Sheets[a]={},Object.keys(t).forEach((function(o){Object.keys(t[o].cells).forEach((function(t){var s=e.getCell(o,t),l=n.xy2expr(t,o);i.isHave(s)&&(r.Sheets[a][l]={v:s.text,f:s.formulas,multivalueRefsCell:s.multivalueRefsCell,source_v:s.source_v})}))})),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cols=void 0;var n,i=(n=r(3))&&n.__esModule?n:{default:n};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){var r=t.len,n=t.width,i=t.indexWidth,a=t.minWidth;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.width=n,this.indexWidth=i,this.minWidth=a}var t,r,n;return t=e,(r=[{key:"setData",value:function(e){e.len&&(this.len=e.len,delete e.len),this._=e}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}},{key:"getWidth",value:function(e){var t=this._[e];return t&&t.width?t.width:this.width}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{},this._[e]}},{key:"setWidth",value:function(e,t){this.getOrNew(e).width=t}},{key:"sumWidth",value:function(e,t){var r=this;return i.default.rangeSum(e,t,(function(e){return r.getWidth(e)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&a(t.prototype,r),n&&a(t,n),e}();t.Cols=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Validations=void 0;var n,i=(n=r(283))&&n.__esModule?n:{default:n},a=r(6);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var c=function(){function e(t,r,n){s(this,e),this.refs=r,this.mode=t,this.validator=n}return u(e,[{key:"includes",value:function(e,t){for(var r=this.refs,n=0;n<r.length;n+=1){if(a.CellRange.valueOf(r[n]).includes(e,t))return!0}return!1}},{key:"addRef",value:function(e){this.remove(a.CellRange.valueOf(e)),this.refs.push(e)}},{key:"remove",value:function(e){var t=[];this.refs.forEach((function(r){var n=a.CellRange.valueOf(r);n.intersects(e)?n.difference(e).forEach((function(e){return t.push(e.toString())})):t.push(r)})),this.refs=t}},{key:"getData",value:function(){var e=this.refs,t=this.mode,r=this.validator;return{refs:e,mode:t,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(t){var r=t.refs,n=t.mode,a=t.type,o=t.required,s=t.operator,l=t.value;return new e(n,r,new i.default(a,o,l,s))}}]),e}(),f=function(){function e(){s(this,e),this._=[],this.errors=new Map}return u(e,[{key:"getError",value:function(e,t){return this.errors.get("".concat(e,"_").concat(t))}},{key:"validate",value:function(e,t,r){var n=this.get(e,t),i="".concat(e,"_").concat(t),a=this.errors;if(null!==n){var s=o(n.validator.validate(r),2),l=s[0],u=s[1];l?a.delete(i):a.set(i,u)}else a.delete(i);return!0}},{key:"add",value:function(e,t,r){var n=r.type,a=r.required,o=r.value,s=r.operator,l=new i.default(n,a,o,s),u=this.getByValidator(l);null!==u?u.addRef(t):this._.push(new c(e,[t],l))}},{key:"getByValidator",value:function(e){for(var t=0;t<this._.length;t+=1){var r=this._[t];if(r.validator.equals(e))return r}return null}},{key:"get",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"remove",value:function(e){this.each((function(t){t.remove(e)}))}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"getData",value:function(){return this._.filter((function(e){return e.refs.length>0})).map((function(e){return e.getData()}))}},{key:"setData",value:function(e){this._=e.map((function(e){return c.valueOf(e)}))}}]),e}();t.Validations=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(11),a=(n=r(3))&&n.__esModule?n:{default:n};function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function u(e,t){var r="";if(!e){for(var n=arguments.length,a=new Array(n>2?n-2:0),o=2;o<n;o++)a[o-2]=arguments[o];r=i.t.apply(void 0,["validation.".concat(t)].concat(a))}return[e,r]}var c=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.required=r,this.value=n,this.type=t,this.operator=i,this.message=""}var t,r,n;return t=e,(r=[{key:"parseValue",value:function(e){var t=this.type;return"date"===t?new Date(e):"number"===t?Number(e):e}},{key:"equals",value:function(e){var t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?a.default.arrayEquals(this.value,e.value):this.value===e.value),t}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(e){var t=this.required,r=this.operator,n=this.value,i=this.type;if(t&&/^\s*$/.test(e))return u(!1,"required");if(/^\s*$/.test(e))return[!0];if(l[i]&&!l[i].test(e))return u(!1,"notMatch");if("list"===i)return u(this.values().includes(e),"notIn");if(r){var a=this.parseValue(e);if("be"===r){var s=o(n,2),c=s[0],f=s[1];return u(a>=this.parseValue(c)&&a<=this.parseValue(f),"between",c,f)}if("nbe"===r){var h=o(n,2),d=h[0],p=h[1];return u(a<this.parseValue(d)||a>this.parseValue(p),"notBetween",d,p)}if("eq"===r)return u(a===this.parseValue(n),"equal",n);if("neq"===r)return u(a!==this.parseValue(n),"notEqual",n);if("lt"===r)return u(a<this.parseValue(n),"lessThan",n);if("lte"===r)return u(a<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return u(a>this.parseValue(n),"greaterThan",n);if("gte"===r)return u(a>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(10),a=r(2);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.moving=!1,this.vertical=r,this.el=(0,n.h)("div","".concat(a.cssPrefix,"-resizer ").concat(r?"vertical":"horizontal")).children(this.hoverEl=(0,n.h)("div","".concat(a.cssPrefix,"-resizer-hover")).on("mousedown.stop",(function(e){return t.mousedownHandler(e)})),this.lineEl=(0,n.h)("div","".concat(a.cssPrefix,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=i}var t,r,s;return t=e,(r=[{key:"show",value:function(e,t){var r=this.moving,n=this.vertical,i=this.hoverEl,a=this.lineEl,o=this.el;if(!r){this.cRect=e;var s=e.left,l=e.top,u=e.width,c=e.height;o.offset({left:n?s+u-5:s,top:n?l:l+c-5}).show(),i.offset({width:n?5:u,height:n?c:5}),a.offset({width:n?0:t.width,height:n?t.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(e){var t=this,r=e,n=this.el,a=this.lineEl,o=this.cRect,s=this.vertical,l=this.minDistance,u=s?o.width:o.height;a.show(),(0,i.mouseMoveUp)(window,(function(e){t.moving=!0,null!==r&&1===e.buttons&&(s?(u+=e.movementX)>l&&n.css("left","".concat(o.left+u,"px")):(u+=e.movementY)>l&&n.css("top","".concat(o.top+u,"px")),r=e)}),(function(){r=null,a.hide(),t.moving=!1,t.hide(),t.finishedFn&&(u<l&&(u=l),t.finishedFn(o,u))}))}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertical=t,this.moveFn=null,this.el=(0,n.h)("div","".concat(i.cssPrefix,"-scrollbar ").concat(t?"vertical":"horizontal")).child(this.contentEl=(0,n.h)("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(e){var t=e.target,n=t.scrollTop,i=t.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:i,e)}))}var t,r,o;return t=e,(r=[{key:"move",value:function(e){return this.el.scroll(e),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(e,t){var r=e-1;if(t>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(t,"px"))}else this.el.hide();return this}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6),i=r(2),a=r(1),o=r(82);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,a.h)("div","".concat(i.cssPrefix,"-selector-cell")),this.data=t,this._=new n.CellRange(0,0,0,0)}var t,r,l;return t=e,(r=[{key:"resetSelectOffset",value:function(){var e=this.data.getRect(this._);this.setOffset(e)}},{key:"setData",value:function(e,t){var r=this;e=-1===e?0:e,t=-1===t?0:t;var i=this.data.merges,a=!1;i.each((function(n){n.includeByRiCi(e,t)&&(r._=n,a=!0)})),a||(this._=new n.CellRange(e,t,e,t))}},{key:"toolbarChangeSelectorCell",value:function(){var e=this._.sri,t=this._.sci;this.setData(e,t)}},{key:"setOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.el.offset({width:n-o.selectorHeightBorderWidth+.8,height:i-o.selectorHeightBorderWidth+.8,left:t-.8,top:r-.8}).show()}}])&&s(t.prototype,r),l&&s(t,l),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=p(r(83)),a=p(r(288)),o=r(2),s=r(8),l=p(r(290)),u=r(31),c=r(10),f=p(r(293)),h=r(33),d=r(3);function p(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(){var e=this.textlineEl,t=this.textEl,r=this.areaOffset;if(r){var n=e.offset().width+9+15,i=this.viewFn().width-r.left-9;if(n>r.width&&0!==r.width){var a=n;if(n>i){a=i-15;var o=parseInt(n/(i-15),10);o+=n%i>0?1:0,(o*=this.rowHeight)>r.height&&t.css("height","".concat(o,"px"))}t.css("width","".concat(a,"px"))}}}var y=function(){var e=this;if(window.getSelection().rangeCount<=0)return 0;var t=window.getSelection().getRangeAt(0),r=t.cloneRange();r.selectNodeContents(this.textEl.el),r.setEnd(t.startContainer,t.startOffset);var n=r.toString().length,i=this.editorText.getText(),a=(0,u.findBracket)(n-1,(0,s.cutting)(i),i),o=a.exist,l=a.left,c=a.right;Object.keys(this.spanArr).forEach((function(t){e.spanArr[t].css("background-color","rgba(255,255,255,0.1)")}));var f=this.spanArr[l],h=this.spanArr[c];if(this.suggestContent.hide(),o&&f&&h)f.css("background-color","rgb(229, 229, 229)"),h.css("background-color","rgb(229, 229, 229)");else{var d=this.suggest.show,p=u.suggestContent.call(this,n,(0,s.cutting)(i),i);p.suggestContent&&!d&&this.suggestContent.content(p.cut,p.pos)}return n};function b(e){if(this){var t=this.pos,r=this.pos,n=0,i=document.createRange();i.setStart(e,0),i.collapse(!0);for(var a,o=[e],s=!1,l=!1;!l&&(a=o.pop());)if(3===a.nodeType){var u=n+a.length;!s&&t>=n&&t<=u&&(i.setStart(a,t-n),s=!0),s&&r>=n&&r<=u&&(i.setEnd(a,r-n),l=!0),n=u}else for(var c=a.childNodes.length;c--;)o.push(a.childNodes[c]);var f=window.getSelection();f.removeAllRanges(),f.addRange(i)}}function w(){var e=this.editorText.getText();this.pos=y.call(this),N.call(this,e,this.pos)}function x(){if(!1===I.call(this)){var e=this.data.getCell(this.ri,this.ci);this.editorText.setOldCell((0,s.deepCopy)(e),{ri:this.ri,ci:this.ci})}}function E(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";if(x.call(this),e){var a=e.inputType;if("insertFromPaste"===a&&"black"!==this.textEl.el.style["caret-color"])return void(this.copy=!0);if("historyUndo"===a)return}var o=this.editorText;setTimeout((function(){if(!1!==t.chinese){var a="";if(t.data.settings.showEditor){if(t.sheet.selector.hide(),""===r&&e&&e.target&&e.target.childNodes){for(var l="",u=0,c=e.target.childNodes.length;u<c;u++)1===e.target.childNodes[u].nodeType?a+=e.target.childNodes[u].innerText:3===e.target.childNodes[u].nodeType&&(l+=e.target.childNodes[u].nodeValue);a=""!==l?l:a}else a=""===r&&e&&(0,d.isHave)(e.data)?""!==e.data?e.data:a:r;t.copy&&(t.copy=!1,a=e&&e.data?e.data:"",t.textEl.html(a),t.pos=a.length,b.call(t,t.textEl.el,-1)),t.changed=!0;var f=t.suggest,h=t.textlineEl,p=t.validator,v=t.textEl;if(o.setText("".concat(a)),o.changeText(1),t.pos=y.call(t),p)"list"===p.type?f.search(a):f.hide();else{var g=(a+="").lastIndexOf("=");-1!==t.pos?N.call(t,a,t.pos):k.call(t,a);var w=!1,x=(0,s.cuttingByPos2)(a,t.pos,!0);if(a.length>=t.pos){var E="".concat(a[t.pos]);-1!==E.search(/^[0-9]+.?[0-9]*$/)?w=!0:E&&(x+=(0,s.cuttingByPosEnd)(a,t.pos+1))}0===g&&a.length>1&&""!==x&&!w&&x.trim().length>0?f.search(x):f.hide()}h.html(n||a),o.setText(n||a),t.suggest.itemIndex=-1,m.call(t),a&&"="!==a[0]&&b.call(t,v.el,-1),n&&"="===n[0]&&(a=n),t.change(i,a),setTimeout((function(){t.show()}))}}}))}function C(e){this.pos=y.call(this),"ArrowRight"===e.code?this.pos=this.pos+1:"ArrowLeft"===e.code&&(this.pos=this.pos-1);var t=e.keyCode||e.which;27===t&&"black"===this.textEl.el.style["caret-color"]&&"1"===this.textEl.el.style.opacity&&this.change("input","@~esc")}function k(e){var t=e.lastIndexOf("=");0===t&&e.length>=1&&(0,s.operation)(e[e.length-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==t?this.setLock(!1):0===t&&1===e.length&&this.setLock(!0),(0,s.isAbsoluteValue)((0,s.cuttingByPos)(e,this.pos),2)&&this.setLock(!0),0!==t&&this.setLock(!1)}function N(e,t){var r=(e+="").lastIndexOf("=");0===r&&e.length>=1&&(0,s.operation)(e[t-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==r?this.setLock(!1):0===r&&1===e.length&&this.setLock(!0),(0,s.isAbsoluteValue)((0,s.cuttingByPos)(e,t),2)&&this.setLock(!0),0!==r&&this.setLock(!1)}function T(){var e=this,t=this.textEl.el;setTimeout((function(){b.call(e,t)}),0)}function O(e){var t=this.textEl,r=this.textlineEl,n=this.tmp;t.el.blur(),n.html(e),r.html(e),T.call(this)}function M(e){var t=this.validator,r=this.editorText,n=r.getText();if(t&&"list"===t.type)n=r.setText(e);else{this.pos=y.call(this);for(var i=this.pos-(0,s.cuttingByPos)(n,this.pos).length,a=(0,s.cuttingByPosEnd)(n,this.pos+1),o=["",""],l=this.pos+a.length,u=0;u<n.length;u++)u<i&&(o[0]+=n[u]),u>l-1&&(o[1]+=n[u]);n=r.setText("".concat(o[0]+e.key,"(")),this.pos=r.getText().length,n=r.setText(n+")".concat(o[1]))}this.textEl.html(n),this.textlineEl.html(n),this.suggest.hide(),N.call(this,n,this.pos),this.change("input",n),b.call(this,this.textEl.el,-1),m.call(this)}function A(){this.suggestContent.hide()}function S(){this.suggest.setItems(this.formulas)}function I(){return"black"===this.textEl.el.style["caret-color"]&&"1"===this.textEl.el.style.opacity}var R=function(){function e(t,r,s,u,h,d){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewFn=r,this.rowHeight=s,this.formulas=t,this.sheet=d,this.display=!0,this.suggest=new i.default(t,(function(e){M.call(p,e)}),h,this),this.suggestContent=new l.default,this.lock=!1,this.state=1,this.data=h,this.datepicker=new a.default,this.isCors=!1,this.datepicker.change((function(e){p.setText(function(e){var t=e.getMonth()+1,r=e.getDate();return t<10&&(t="0".concat(t)),r<10&&(r="0".concat(r)),"".concat(e.getFullYear(),"-").concat(t,"-").concat(r)}(e)),p.clear()})),this.ri=-1,this.ci=-1,this.spanArr=[],this.mousedownIndex=[],this.changed=!1,this.chinese=!0,this.editorText=new f.default(""),this.areaEl=(0,n.h)("div","".concat(o.cssPrefix,"-editor-area")).children(this.textEl=(0,n.h)("div","".concat(o.cssPrefix,"-editor-textEl")).on("input",(function(e){return E.call(p,e)})).on("click",(function(){return w.call(p)})).on("keyup",(function(e){return C.call(p,e)})).on("mousedown",(function(e){if(2===e.detail){if(I.call(p))return;p.show(),setTimeout((function(){var e=p.ri,t=p.ci;console.log(e,t),p.setCellEnd(h.getSelectedCellRiCi(e,t))}))}})).on("compositionstart",(function(){p.chinese=!1})).on("compositionend",(function(){p.chinese=!0})).on("paste",(function(e){"black"===p.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("copy",(function(e){"black"===p.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("keydown",(function(e){m.call(p),p.textlineEl.html(e.currentTarget.innerText);var t=e.keyCode;if(38!==t&&40!==t||e.preventDefault(),115===t){var r=p.editorText.f4ShortcutKey(y.call(p)),n=r.inputText,i=r.pos;return E.call(p,null,n,n),void setTimeout((function(){p.pos=i,b.call(p,p.textEl.el,-1)}))}if("black"!==p.textEl.el.style["caret-color"]){var a=e.ctrlKey,o=e.metaKey;8===t||46===t?c.createEvent.call(p,8,!1):40===t?(p.clear(),c.createEvent.call(p,40,!1)):39===t?(p.clear(),c.createEvent.call(p,39,!1)):37===t?(p.clear(),c.createEvent.call(p,37,!1)):38===t?(p.clear(),c.createEvent.call(p,38,!1)):(a||o)&&(67===t?c.createEvent.call(p,67,!0):86===t?c.createEvent.call(p,86,!0):88===t?c.createEvent.call(p,88,!0):90===t?c.createEvent.call(p,90,!0):66===t&&c.createEvent.call(p,66,!0))}})),this.textlineEl=(0,n.h)("div","textline"),this.suggestContent.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),d.el.child(this.suggest.el),this.el=(0,n.h)("div","".concat(o.cssPrefix,"-editor")).children(this.areaEl),this.suggest.bindInputEvents(this.textEl),this.textEl.on("paste",(function(e){!1!==I.call(p)&&function(e){e.preventDefault();var t="",r=(e.originalEvent||e).clipboardData;if(null==r){if(""!==(t=window.clipboardData.getData("text")||""))if(window.getSelection){var n=document.createElement("span");n.innerHTML=t,window.getSelection().getRangeAt(0).insertNode(n)}else document.selection.createRange().pasteHTML(t)}else""!==(t=r.getData("text/plain")||"")&&document.execCommand("insertText",!1,t)}(e)})),this.tmp=(0,n.h)("span","span_tmp").hide(),this.textEl.attr("contenteditable","true"),this.textEl.css("width","".concat(u-3,"px")),this.textEl.css("height","".concat(s-2,"px")),this.textEl.child(this.tmp),this.pos=0,this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,setTimeout((function(){p.show(!1)})),this.change=function(){}}var t,r,s;return t=e,(r=[{key:"setFreezeLengths",value:function(e,t){this.freeze.w=e,this.freeze.h=t}},{key:"setMouseDownIndex",value:function(e){this.mousedownIndex=e}},{key:"setRiCi",value:function(e,t){this.ri=e,this.ci=t}},{key:"setLock",value:function(e){this.lock=e}},{key:"getLock",value:function(){return this.lock}},{key:"show",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.data.settings.showEditor?(this.textEl.css("caret-color","black"),this.textEl.css("cursor","text"),this.textEl.css("opacity","1"),this.textEl.el.focus(),this.areaEl.css("pointer-events","auto"),this.areaEl.css("border","2px solid #4b89ff"),this.areaEl.css("background","white")):(this.textEl.css("caret-color","white"),this.textEl.css("cursor","default"),this.textEl.css("opacity","0"),this.textEl.el.blur(),this.areaEl.css("pointer-events","none"),this.areaEl.css("background","rgba(75, 137, 255, 0)"),this.areaEl.css("border","none"))}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=this.editorText,r=t.getText();-1!==e?(this.pos=y.call(this),N.call(this,r,this.pos)):k.call(this,r)}},{key:"clear",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.editorText,n=r.getText();return this.display=I.call(this),""!==n&&isNaN(n)&&0===n.replace(/\s/g,"").lastIndexOf("¥")?this.change("format",n):this.changed&&this.change("finish",n),this.changed=!1,this.cell=null,this.areaOffset=null,r.setText(""),this.show(!1),this.copy=!1,b.call(this,this.textEl.el,-1),this.pos=0,this.tmp.hide(),this.textEl.html(""),this.textlineEl.html(""),A.call(this),S.call(this),this.datepicker.hide(),!t&&(setTimeout((function(){var t=e.data.selector,r=t.ri,n=t.ci;e.setRiCi(r,n)})),this.display)}},{key:"mount2span",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{suggestContent:!1,cut:"",pos:-1};if(this.spanArr!==e){var a,o=this.suggest.show;i.suggestContent&&!o?this.suggestContent.content(i.cut,i.pos):this.suggestContent.hide(),Object.keys(e).forEach((function(t){e[t].css("background-color","rgba(255,255,255,0.1)")})),"-1"!==t&&-1!==r&&e[t]&&(e[t].css("background-color","#e5e5e5"),e[r].css("background-color","#e5e5e5")),e.length>0&&(this.textEl.html(""),this.tmp=(a=(0,n.h)("span","span_tmp")).children.apply(a,v(e)).css("top","0px").css("color","black").css("font-size","14px").css("font-family","m-inconsolata,monospace,arial,sans,sans-serif"),this.textEl.el.insertBefore(this.tmp.el,this.textEl.el.childNodes[0]),b.call(this,this.textEl.el,-1)),this.spanArr=e}}},{key:"handler",value:function(e){var t=this.editorText.getText(),r=this.pos;if(r>=t)this.setMouseDownIndex([]);else{var n=e.substring(0,r),i=e.substring(r,e.length);k.call(this,n),""!==i?this.setMouseDownIndex([n,i]):this.setMouseDownIndex([])}}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.textEl,i=this.areaEl,a=this.suggest,o=this.freeze,s=this.el;if(e){this.areaOffset=e;var l=e.left,u=e.top,c=e.width,f=e.height,h=e.l,d=e.t,p={left:0,top:0};o.w>h&&o.h>d||(o.w<h&&o.h<d?(p.left=o.w,p.top=o.h):o.w>h?p.top=o.h:o.h>d&&(p.left=o.w)),s.offset(p),i.offset({left:l-p.left-.8,top:u-p.top-.8}),n.offset({width:c-2+.8,height:f-3+.8});var v={left:0};v[t]=f,a.hide(),m.call(this),r&&this.show(!1)}}},{key:"setCellEnd",value:function(e){var t=this,r="",n=e&&e.formulas||"";(0,d.isHave)(e)&&(0,d.isHave)(e.text)&&(r=e.text),(0,d.isHave)(e)&&(0,d.isHave)(e.formulas)&&(r=e.formulas);var i=this.data,a=i.rows,o=i.getCellStyleOrDefault(this.ri,this.ci),s=i.renderFormat(o,e,this.ri,this.ci,!0);s.state&&(r=s.cellText,n=s.cellText),this.textEl.child(r+""),this.pos=r.length,b.call(this,this.textEl.el,-1),this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci}),h.testValid.call(this),E.call(this,null,r,n,"end"),setTimeout((function(){t.pos=a.toString(r).length,b.call(t,t.textEl.el,-1)}),20)}},{key:"setCell",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.cell=e,this.show();var i=e&&e.formulas||"";i=""===i?e&&e.text||"":i,this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci});var a=this.el,o=this.datepicker,s=this.suggest;if(a.show(),this.textEl.show(),b.call(this,this.textEl.el,-1),setTimeout((function(){r.pos=i.length,b.call(r,r.textEl.el)}),10),this.validator=t,t){var l=t.type;"date"===l&&(o.show(),/^\s*$/.test(i)||o.setValue(i)),"list"===l&&(s.setItems(t.values()),s.search(""))}2===n&&""!==i&&"="===i[0]?(E.call(this,null,i),this.pos=i.length,b.call(this,this.textEl.el,i.length)):2===n&&"="!==i[0]&&this.textEl.child(i),setTimeout((function(){r.textlineEl.html(i),m.call(r)}))}},{key:"isDisplay2",value:function(){return I.call(this)}},{key:"setCursorPos",value:function(e){this.pos=e,b.call(this,this.textEl.el)}},{key:"setText",value:function(e){this.editorText.setText(e),O.call(this,e),m.call(this),this.textEl.child(this.tmp)}}])&&g(t.prototype,r),s&&g(t,s),e}();t.default=R},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(289))&&n.__esModule?n:{default:n},a=r(1),o=r(2),s=r(26);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.calendar=new i.default(new Date),this.el=(0,a.h)("div","".concat(o.cssPrefix,"-datepicker")).child(this.calendar.el).hide()}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){var t=this.calendar;return"string"==typeof e?(0,s.str2Re)(s.calendarPattern).test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}},{key:"change",value:function(e){var t=this;this.calendar.selectChange=function(r){e(r),t.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=(n=r(13))&&n.__esModule?n:{default:n},o=r(11);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){e.setMonth(e.getMonth()+t)}function c(e,t){var r=new Date(e);return r.setDate(t-e.getDay()+1),r}var f=function(){function e(t){var r,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.cvalue=new Date(t),this.headerLeftEl=(0,i.h)("div","calendar-header-left"),this.bodyEl=(0,i.h)("tbody",""),this.buildAll(),this.el=(0,i.h)("div","fin-cell-calendar").children((0,i.h)("div","calendar-header").children(this.headerLeftEl,(0,i.h)("div","calendar-header-right").children((0,i.h)("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new a.default("chevron-left")),(0,i.h)("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new a.default("chevron-right")))),(0,i.h)("table","calendar-body").children((0,i.h)("thead","").child((r=(0,i.h)("tr","")).children.apply(r,s((0,o.t)("calendar.weeks").map((function(e){return(0,i.h)("th","cell").child(e)}))))),this.bodyEl)),this.selectChange=function(){}}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}},{key:"prev",value:function(){u(this.value,-1),this.buildAll()}},{key:"next",value:function(){u(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var e=this.value;this.headerLeftEl.html("".concat((0,o.t)("calendar.months")[e.getMonth()]," ").concat(e.getFullYear()))}},{key:"buildBody",value:function(){var e,t=this,r=this.value,n=this.cvalue,a=this.bodyEl,o=function(e,t,r){for(var n=new Date(e,t,1,23,59,59),i=[[],[],[],[],[],[]],a=0;a<6;a+=1)for(var o=0;o<7;o+=1){var s=c(n,7*a+o),l=s.getMonth()!==t,u=s.getMonth()===r.getMonth()&&s.getDate()===r.getDate();i[a][o]={d:s,disabled:l,active:u}}return i}(r.getFullYear(),r.getMonth(),n).map((function(e){var r,n=e.map((function(e){var r="cell";return e.disabled&&(r+=" disabled"),e.active&&(r+=" active"),(0,i.h)("td","").child((0,i.h)("div",r).on("click.stop",(function(){t.selectChange(e.d)})).child(e.d.getDate().toString()))}));return(r=(0,i.h)("tr","")).children.apply(r,s(n))}));(e=a.html("")).children.apply(e,s(o))}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(2),i=r(1),a=r(8),o=r(10);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r,n){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=(0,i.h)("div",n),l=0;l<e[t].length;l++){var u=e[t][l],c=u.name,f=u.editor,h=u.index;r===l?s.child((0,i.h)("span",a).child(c)):!0===f&&r>=h?s.child((0,i.h)("span",a).child(c)):s.child((0,i.h)("span",o).child(c))}return s}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"300px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,i.h)("div","".concat(n.cssPrefix,"-suggest-content")).css("width",t).css("z-index","10000").css("position","absolute").hide(),this.el.attr("tabindex",0),(0,o.bind)(this.el.el,"paste",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"copy",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"keydown",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"keyup",(function(e){e.stopPropagation()}))}var t,r,u;return t=e,(r=[{key:"hide",value:function(){this.el.hide()}},{key:"content",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=this.el;t=t.toUpperCase();var s={};if(Object.keys(a.helpFormula).forEach((function(e){e===t&&(s=a.helpFormula[e])})),s&&"{}"!==JSON.stringify(s)){var u=[],c=l.call(this,s,"title",r,"".concat(n.cssPrefix,"-help-title"),"".concat(n.cssPrefix,"-help-span-title"),"".concat(n.cssPrefix,"-help-span2-title")),f=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-title")).child("示例"),h=l.call(this,s,"example",r,"".concat(n.cssPrefix,"-help-section-content"),"".concat(n.cssPrefix,"-help-span3-title"));u.push.apply(u,[c,f,h]),Object.keys(s.content).forEach((function(e){var t=s.content[e],r=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-title")).child(e),a=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-content")).child(t);u.push.apply(u,[r,a])})),(e=o.html("")).children.apply(e,u).show()}}}])&&s(t.prototype,r),u&&s(t,u),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=r(2),o=r(6),s=r(10),l=r(31),u=r(8),c=r(4),f=(n=r(292))&&n.__esModule?n:{default:n};function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}var v=10;function g(e,t){return e.lastIndexOf(t)}var m=function(){function e(t,r,n){var o=this;h(this,e),this.data=t,this._selector=r,this.sheet=n,this.l=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-l")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.r=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-r")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.t=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-t")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.b=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-b")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.boxinner=(0,i.h)("div","".concat(a.cssPrefix,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.selectorMove=new f.default(this.boxinner,t,n,r),this.areaEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-area")).child(this.boxinner).hide(),this.clipboardEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-clipboard")).hide(),this.autofillEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-autofill")).hide(),this.el=(0,i.h)("div","".concat(a.cssPrefix,"-selector")).css("z-index","".concat(v)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),v+=1}return p(e,[{key:"moveEvent",value:function(e){var t=this,r=this.data,n=this._selector,i=this.sheet,a=null,f=r.selector.range,h=f.sri,d=f.sci,p=f.eri,v=f.eci,m=f.w,y=f.h,b=new o.CellRange(h,d,p,v,m,y),w=-1;(0,s.mouseMoveUp)(window,(function(s){var f=t.sheet.selectors;i.container.css("pointer-events","none");for(var h=0;h<f.length;h++){f[h].selector.setBoxinner("none")}var d=r.getCellRectByXY(s.layerX,s.layerY),p=d.ri,v=d.ci;if(-1!==p&&-1!==v){var x=t.sheet.editor.pos,E=t.sheet.editor.editorText.getText(),C=(0,u.cuttingByPos)(E,x-1,!0);E.length>x-1&&(C+=(0,u.cuttingByPosEnd)(E,x-1));for(var k=0;k<f.length;k++){var N=f[k],T=N.className,O=N.erpx;if(O===C&&T===n.className+" clear_selector"){if(a=a||N,-1!==O.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var M=O.split(":"),A=(0,c.expr2xy)(M[0]),S=(0,c.expr2xy)(M[1]);(b=new o.CellRange(A[1],A[0],S[1],S[0],m,y)).move(p,v);var I=r.getMoveRect(b);a.selector.range=b,a.selector.setMove(I)}else a.selector.set(p,v,!0);break}if(O!==C&&T===n.className+" clear_selector"){if(w=-1!==w?w:g(E,N.erpx),t.sheet.editor.setCursorPos(w+N.erpx.length),a=a||N,-1!==N.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var R=O.split(":"),_=(0,c.expr2xy)(R[0]),j=(0,c.expr2xy)(R[1]);(b=new o.CellRange(_[1],_[0],j[1],j[0],m,y)).move(p,v);var D=r.getMoveRect(b);a.selector.range=b,a.selector.setMove(D)}else a.selector.set(p,v,!0);break}}a&&(a.selector.setCss(a.color,!1),l.lockCells.call(t.sheet,e,a,(0,u.isAbsoluteValue)(a.erpx),w))}}),(function(){var e=t.sheet.selectors;i.container.css("pointer-events","auto");for(var r=0;r<e.length;r++){e[r].selector.setBoxinner("all")}w=-1,a&&a.selector&&a.selector.setCss(a.color,!0),a=null}))}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.selectorMove.l.css("pointer-events",e),this.selectorMove.r.css("pointer-events",e),this.selectorMove.t.css("pointer-events",e),this.selectorMove.b.css("pointer-events",e)}},{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.areaEl.css("border","2px dashed ".concat(e)):this.areaEl.css("border","2px solid ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-3+.8,height:i-3+.8,left:t-.8,top:r-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-3,height:i-3,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function y(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,s=e.l,l=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>s&&(f-=o.x);var h=n-c;return c>l&&(h-=o.y),{left:f,top:h,width:i,height:a}}function b(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalWidth(),u=r-l;return l>a&&(u-=s.x),{left:u,top:o,width:n,height:i}}function w(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalHeight(),u=r-l;return l>o&&(u-=s.y),{left:a,top:u,width:n,height:i}}function x(e){this.br.setAreaOffset(y.call(this,e))}function E(e){this.tl.setAreaOffset(e)}function C(e){this.t.setAreaOffset(b.call(this,e))}function k(e){this.l.setAreaOffset(w.call(this,e))}function N(e){this.l.setClipboardOffset(w.call(this,e))}function T(e){this.br.setClipboardOffset(y.call(this,e))}function O(e){this.tl.setClipboardOffset(e)}function M(e){this.t.setClipboardOffset(b.call(this,e))}function A(e){x.call(this,e),E.call(this,e),C.call(this,e),k.call(this,e)}function S(e){T.call(this,e),O.call(this,e),M.call(this,e),N.call(this,e)}var I=function(){function e(t,r,n){h(this,e),this.data=t,this.className=n,this.br=new m(t,this,r),this.t=new m(t,this,r),this.l=new m(t,this,r),this.tl=new m(t,this,r),this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,i.h)("div","".concat(a.cssPrefix,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,v+=1}return p(e,[{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.br.setCss(e,t),this.t.setCss(e,t),this.l.setCss(e,t),this.tl.setCss(e,t)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br,a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();A.call(this,e),S.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();x.call(this,e),C.call(this,e),T.call(this,t),M.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();x.call(this,t),k.call(this,t),T.call(this,r),N.call(this,r),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();x.call(this,e),k.call(this,e),T.call(this,t),N.call(this,t),this.resetOffset()}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var s=e,l=t;e<0&&(s=0),t<0&&(l=0),n.selector.setIndexes(s,l),this.indexes=[s,l]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setMove",value:function(e){A.call(this,e)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=this.lastri,a=this.lastci;if(r){if(e===i&&t===a)return;this.lastri=e,this.lastci=t}this.range=n.calSelectedRangeByEnd(e,t),A.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"showAutofill",value:function(e,t){if(-1!==e||-1!==t){var r=this.range,n=r.sri,i=r.sci,a=r.eri,s=r.eci,l=e,u=t,c=n-e,f=a-e,h=s-t;if(i-t>0)this.arange=new o.CellRange(n,u,a,i-1);else if(c>0)this.arange=new o.CellRange(l,i,n-1,s);else if(h<0)this.arange=new o.CellRange(n,s+1,a,u);else{if(!(f<0))return void(this.arange=null);this.arange=new o.CellRange(a+1,i,l,s)}if(null!==this.arange){var d=this.data.getRect(this.arange);d.width+=2,d.height+=2;var p=this.br,v=this.l,g=this.t,m=this.tl;p.showAutofill(y.call(this,d)),v.showAutofill(w.call(this,d)),g.showAutofill(b.call(this,d)),m.showAutofill(d)}}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();S.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();t.default=I},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2),a=r(8),o=r(4),s=r(31),l=r(6),u=r(10);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return e.lastIndexOf(t)}var h=function(){function e(t,r,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.l=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-l")),this.r=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-r")),this.t=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-t")),this.b=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-b")),this.data=r,this.sheet=a,this._selector=o,this.event(this.l,1),this.event(this.r,2),this.event(this.t,3),this.event(this.b,4),this.boxinner=t,this.boxinner.children(this.l,this.r,this.t,this.b)}var t,r,h;return t=e,(r=[{key:"event",value:function(e,t){var r=this,n=null;e.on("mousedown.stop",(function(e){var i=r.data,c=r.sheet,h=r._selector,d=-1,p=i.selector,v=null,g=p.range,m=g.sri,y=g.sci,b=g.eri,w=g.eci,x=g.w,E=g.h,C=new l.CellRange(m,y,b,w,x,E),k=null,N=c.selectors,T=-1,O=-1,M=-1,A=-1;(0,u.mouseMoveUp)(window,(function(u){clearTimeout(n),n=setTimeout((function(){c.container.css("pointer-events","none");for(var n=0;n<N.length;n++)N[n].selector.setBoxinner("none");var p=i.getCellRectByXY(u.layerX,u.layerY),g=p.ri,m=p.ci;if(-1!==g&&-1!==m){var y=r.sheet.editor.pos,b=r.sheet.editor.editorText.getText(),w=(0,a.cuttingByPos)(b,y-1,!0);b.length>y-1&&(w+=(0,a.cuttingByPosEnd)(b,y-1));for(var S=0;S<N.length;S++){var I=N[S],R=I.className,_=I.erpx;if(_===w&&R===h.className+" clear_selector"){if(v=v||I,-1!==_.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var j=_.split(":"),D=(0,o.expr2xy)(j[0]),P=(0,o.expr2xy)(j[1]);(C=new l.CellRange(D[1],D[0],P[1],P[0],x,E)).move(g,m);var L=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(L)}else v.selector.set(g,m,!0);break}if(_!==w&&R===h.className+" clear_selector"){if(d=-1!==d?d:f(b,I.erpx),r.sheet.editor.setCursorPos(d+I.erpx.length),v=v||I,-1!==I.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var F=_.split(":"),B=(0,o.expr2xy)(F[0]),H=(0,o.expr2xy)(F[1]);if(C=new l.CellRange(B[1],B[0],H[1],H[0],x,E),null===k&&(k=C),4===t){var V=i.getCellRectByXY(u.layerX,u.layerY);C.move2(B[1],B[0],V.ri,V.ci);var z=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(z)}else if(1===t){var U=i.getCellRectByXY(u.layerX,u.layerY);C.move2(B[1],U.ci,U.ri,H[0]);var Y=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(Y)}else if(3===t){var W=i.getCellRectByXY(u.layerX,u.layerY);C.move2(W.ri,W.ci,H[1],H[0]);var X=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(X)}else if(2===t){var G=i.getCellRectByXY(u.layerX,u.layerY);C.move2(G.ri,B[0],H[1],G.ci);var q=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(q)}}else{var $=(0,o.expr2xy)(I.erpx),K=(0,o.expr2xy)(I.erpx),Z=i.getCellRectByXY(u.layerX,u.layerY);if(4===t){C.move2($[1],$[0],Z.ri,Z.ci);var Q=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(Q)}else if(1===t){C.move2($[1],Z.ci,Z.ri,K[0]);var J=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(J)}else if(3===t){C.move2(Z.ri,Z.ci,K[1],K[0]);var ee=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(ee)}else if(2===t){C.move2(Z.ri,$[0],K[1],Z.ci);var te=i.getMoveRect(C);v.selector.range=C,v.selector.setMove(te)}}break}}!v||T===C.sri&&O===C.sci&&M===C.eri&&A===C.eci||(v.selector.setCss(v.color,!1),s.lockCells.call(r.sheet,e,v,(0,a.isAbsoluteValue)(v.erpx),d)),T=C.sri,O=C.sci,M=C.eri,A=C.eci}}),6)}),(function(){clearTimeout(n);var e=r.sheet.selectors;c.container.css("pointer-events","auto");for(var t=0;t<e.length;t++)e[t].selector.setBoxinner("all");d=-1,v&&v.selector&&v.selector.setCss(v.color,!0),v=null}))}))}}])&&c(t.prototype,r),h&&c(t,h),e}();t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(8),i=r(47);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputText="",this.oldCell="",this.ri=-1,this.ci=-1}var t,r,o;return t=e,(r=[{key:"setText",value:function(e){return this.inputText=e,this.getText()}},{key:"getText",value:function(){return this.inputText}},{key:"setOldCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.ri,n=void 0===r?-1:r,i=t.ci,a=void 0===i?-1:i;return this.oldCell=e,this.ri=n,this.ci=a,this.getOldCell()}},{key:"getOldCell",value:function(){return this.oldCell}},{key:"getRICI",value:function(){return{ri:this.ri,ci:this.ci}}},{key:"changeText",value:function(e){1===e&&this.setText(this.getText().replace(/，/g,","))}},{key:"isFormula",value:function(){return 0===this.getText().lastIndexOf("=")}},{key:"f4ShortcutKey",value:function(e){var t=this.setText((0,i.toUpperCase)(this.inputText)),r=(0,n.cuttingByPos)(t,e,!0),a=(0,n.cuttingByPosEnd2)(t,e+1);console.log(a);var o=(0,n.isAbsoluteValue)(r,5),s="",l=r.split(":")[1];if(l&&(o=2===(o=1===(o=12===(o=3===(o=(0,n.isAbsoluteValue)(l,5))?6:o)?9:o)?7:o)?8:o,console.log(o)),!1!==o)switch(o){case 13:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s1;var u=t.substring(0,t.lastIndexOf(l));t=this.setText(u+s);break;case 12:l=r,s=(0,n.value2absolute)(l.replace(/\$/g,"")).s3,console.log((0,n.value2absolute)(r)),t=this.setText(t.substring(0,t.lastIndexOf(l))+s),console.log(this.getText());break;case 11:case 10:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s3,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 9:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 8:s=(l=r.split(":")[1]).replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 7:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 6:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 5:s=(0,n.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 4:s=(0,n.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 3:s=(0,n.value2absolute)(r.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 2:s=r.replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 1:s=(0,n.value2absolute)(r.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+s)}return{pos:t.length,inputText:t=this.setText(t+a)}}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.infixExprToSuffixExpr=t.default=void 0;var n=r(4),i=r(2);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.infixExprToSuffixExpr=function(e){for(var t=[],r=[],i=[],o=0,s=1,l=0;l<e.length;l+=1){var u=e.charAt(l);if(" "!==u)if(u>="a"&&u<="z")i.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)i.push(u);else if('"'===u){for(l+=1;'"'!==e.charAt(l);)i.push(e.charAt(l)),l+=1;r.push('"'.concat(i.join(""))),i=[]}else{if("("!==u&&i.length>0&&r.push(i.join("")),")"===u){var c=t.pop();if(2===o)try{for(var f=a((0,n.expr2xy)(r.pop()),2),h=f[0],d=f[1],p=a((0,n.expr2xy)(r.pop()),2),v=p[0],g=p[1],m=0,y=v;y<=h;y+=1)for(var b=g;b<=d;b+=1)r.push((0,n.xy2expr)(y,b)),m+=1;r.push([c,m])}catch(e){}else if(1===o)r.push([c,s]),s=1;else for(;"("!==c&&(r.push(c),!(t.length<=0));)c=t.pop();o=0}else if(":"===u)o=2;else if(","===u)o=1,s+=1;else if("("===u&&i.length>0)t.push(i.join(""));else{if(t.length>0&&("+"===u||"-"===u)){var w=t[t.length-1];if("("!==w&&r.push(t.pop()),"*"===w||"/"===w)for(;t.length>0&&"("!==(w=t[t.length-1]);)r.push(t.pop())}t.push(u)}i=[]}}for(i.length>0&&r.push(i.join(""));t.length>0;)r.push(t.pop());return r};function o(e,t){return"string"==typeof e&&-1!==e.toUpperCase().indexOf(t.toUpperCase())}var s={render:function(e,t,r,a,s,l,u){arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(void 0===s)return"";if("string"==typeof s&&-1!==i.look.indexOf(s.split("!")[0])){var c=s.length;s.split(" ")[0]&&(c=s.split(" ")[0].length);var f=JSON.parse(s.substring(s.indexOf("!")+1,c)),h=i.look.indexOf(s.split("!")[0]);if(1===h)return f.text;if(0===h&&f&&f[0]){var d=f[0],p=d.name,v=d.value;if(0===v&&f[1]&&0!==f[1].value)return p;if(0===v&&!f[1])return p}return i.look2}return"="===s[0]&&"="!==s[1]?o(s.substring(1),"wland")||o(s.substring(1),"wfr")||o(s.substring(1),"rtd")||o(s.substring(1),"city")?s.toUpperCase():s.substring(1)&&t&&t.Sheets&&t.Sheets[e.name]&&t.Sheets[e.name][(0,n.xy2expr)(a,r)]?t.Sheets[e.name][(0,n.xy2expr)(a,r)].f&&-1!==t.Sheets[e.name][(0,n.xy2expr)(a,r)].f.search(/\((\+|\-|\*|\/)/)||void 0===t.Sheets[e.name][(0,n.xy2expr)(a,r)].v||""===t.Sheets[e.name][(0,n.xy2expr)(a,r)].v?"#ERROR!":(t.Sheets[e.name][(0,n.xy2expr)(a,r)].v=t.Sheets[e.name][(0,n.xy2expr)(a,r)].v+"",t.Sheets[e.name][(0,n.xy2expr)(a,r)].w?t.Sheets[e.name][(0,n.xy2expr)(a,r)].w:t.Sheets[e.name][(0,n.xy2expr)(a,r)].v.replace(/'/g,'"')):s:s}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMinus=void 0;t.isMinus=function(e){return!isNaN(e)&&(""!==e&&parseInt(e)<0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thinLineWidth=c,t.npx=f,t.DrawBox=t.Draw=void 0;var n=r(3);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function u(){return window.devicePixelRatio||1}function c(){return u()-.5}function f(e){var t=e*u()+"";return parseInt(t,10)}function h(e){var t=f(e);return t>0?t-.5:.5}function d(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}function p(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t+6,r),e.lineTo(t+6,r+12),e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}var v=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o(this,e),this.x=t,this.y=r,this.width=n,this.height=i,this.padding=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return l(e,[{key:"setBorders",value:function(e){var t=e.top,r=e.bottom,n=e.left,i=e.right;t&&(this.borderTop=t),i&&(this.borderRight=i),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(e){var t=this.width,r=this.padding,n=this.x;return"left"===e?n+=r:"center"===e?n+=t/2:"right"===e&&(n+=t-r),n}},{key:"texty",value:function(e,t,r){var n=this.height,i=this.padding,a=this.y;return"top"===e?a+=i:"middle"===e?a=a+n/2-r:"bottom"===e&&(a+=n-2*r-i),a}},{key:"topxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e+this.width,t]]}},{key:"rightxys",value:function(){var e=this.x,t=this.y,r=this.width;return[[e+r,t],[e+r,t+this.height]]}},{key:"bottomxys",value:function(){var e=this.x,t=this.y,r=this.width,n=this.height;return[[e,t+n],[e+r,t+n]]}},{key:"leftxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e,t+this.height]]}}]),e}();function g(e,t,r,n,i,a,o){var s={x:0,y:0};"underline"===e?s.y="bottom"===i?0:"top"===i?-(a+2):-a/2:"strike"===e&&("bottom"===i?s.y=a/2:"top"===i&&(s.y=-(a/2+2))),"center"===n?s.x=o/2:"right"===n&&(s.x=o),this.line([t-s.x,r-s.y],[t-s.x+o,r-s.y])}t.DrawBox=v;var m=function(){function e(t,r,n){o(this,e),this.el=t,this.ctx=t.getContext("2d"),this.resize(r,n),this.ctx.scale(1*u(),1*u()),this.cxc={indent:250,vIndent:200,canvasContext:this.ctx}}return l(e,[{key:"resize",value:function(e,t){this.el.style.width="".concat(e,"px"),this.el.style.height="".concat(t,"px"),this.el.width=f(e),this.el.height=f(t)}},{key:"clear",value:function(){var e=this.el,t=e.width,r=e.height;return this.ctx.clearRect(0,0,t,r),this}},{key:"attr",value:function(e){return Object.assign(this.ctx,e),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(e,t){return this.ctx.translate(f(e),f(t)),this}},{key:"clearRect",value:function(e,t,r,n){return this.ctx.clearRect(e,t,r,n),this}},{key:"fillRect",value:function(e,t,r,n){return this.ctx.fillRect(f(e)-.5,f(t)-.5,f(r),f(n)),this}},{key:"fillText",value:function(e,t,r){return this.ctx.fillText(e,f(t),f(r)),this}},{key:"selfAdaptionHeight",value:function(e,t,r){if(void 0!==r&&void 0!==t){for(var n=1,i={len:0,start:0},a=e.width-2*e.padding,o=0;o<t.length;o+=1)i.len+e.padding>=a&&(n+=1,i.len=0,i.start=o),i.len+=this.selfAdaptionOneTxtWidth(t[o],r);return n}}},{key:"selfAdaptionTxtWidth",value:function(e,t,r){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(t)||e.length<=0)return 0;var i=this.ctx;return i.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(f(t.size),"px ").concat(t.name),i.measureText(e).width+2*r.padding}},{key:"selfAdaptionOneTxtWidth",value:function(e,t){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(t)||e.length<=0)return 0;var r=this.ctx;return r.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(f(t.size),"px ").concat(t.name),r.measureText(e).width}},{key:"text",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,a=r.align,o=r.valign,s=r.font,l=r.color,u=r.strike,c=r.underline,h=(r.ignore,t.textx(a));i.save(),i.beginPath(),this.attr({textAlign:a,textBaseline:o,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(f(s.size),"px ").concat(s.name),fillStyle:l,strokeStyle:l});var d=this.selfAdaptionTxtWidth(e,s,t),p=0,v=t.innerWidth();if(n){v=t.width-2*t.padding;var m=this.selfAdaptionHeight(t,e,s);p=(m-1)*s.size/2}var y=t.texty(o,s.size,p);if(n&&d>v){for(var b={len:0,start:0},w=0;w<e.length;w+=1)b.len+t.padding>=v&&(this.fillText(e.substring(b.start,w),h,y),u&&g.call(this,"strike",h,y,a,o,s.size,b.len),c&&g.call(this,"underline",h,y,a,o,s.size,b.len),y+=s.size+2,b.len=0,b.start=w),b.len+=this.selfAdaptionOneTxtWidth(e[w],s);b.len>0&&(this.fillText(e.substring(b.start),h,y),u&&g.call(this,"strike",h,y,a,o,s.size,b.len),c&&g.call(this,"underline",h,y,a,o,s.size,b.len))}else this.fillText(e,h,y),u&&g.call(this,"striket",h,y,a,o,s.size,d),c&&g.call(this,"underline",h,y,a,o,s.size,d);return i.restore(),this}},{key:"border",value:function(e,t){var r=this.ctx;return r.lineWidth=c,r.strokeStyle=t,"medium"===e?r.lineWidth=f(2)-.5:"thick"===e?r.lineWidth=f(3):"dashed"===e?r.setLineDash([f(3),f(2)]):"dotted"===e?r.setLineDash([f(1),f(1)]):"double"===e&&r.setLineDash([f(2),0]),this}},{key:"line",value:function(){var e=this.ctx;if(arguments.length>1){var t=arguments.length<=0?void 0:arguments[0],r=a(t,2),n=r[0],i=r[1];e.moveTo(h(n),h(i));for(var o=1;o<arguments.length;o+=1){var s=o<0||arguments.length<=o?void 0:arguments[o],l=a(s,2),u=l[0],c=l[1];e.lineTo(h(u),h(c))}e.stroke()}return this}},{key:"strokeBorders",value:function(e){var t=this.ctx;t.save(),t.beginPath();var r=e.borderTop,n=e.borderRight,a=e.borderBottom,o=e.borderLeft;r&&(this.border.apply(this,i(r)),this.line.apply(this,i(e.topxys()))),n&&(this.border.apply(this,i(n)),this.line.apply(this,i(e.rightxys()))),a&&(this.border.apply(this,i(a)),this.line.apply(this,i(e.bottomxys()))),o&&(this.border.apply(this,i(o)),this.line.apply(this,i(e.leftxys()))),t.restore()}},{key:"dropUp",value:function(e,t,r){var n=this.ctx,i=e.x+10,a=e.y+e.height-18-r;t?p.call(this,n,f(i),f(a)):d.call(this,n,f(i),f(a))}},{key:"lineTo",value:function(e,t){this.cxc.canvasContext.lineTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"moveTo",value:function(e,t){this.cxc.canvasContext.moveTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"dropdown",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-15,a=n+e.height-15;t.save(),t.beginPath(),t.moveTo(f(i),f(a)),t.lineTo(f(i+8),f(a)),t.lineTo(f(i+4),f(a+6)),t.closePath(),t.fillStyle="rgba(0, 0, 0, .45)",t.fill(),t.restore()}},{key:"error",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-1;t.save(),t.beginPath(),t.moveTo(f(i-8),f(n-1)),t.lineTo(f(i),f(n-1)),t.lineTo(f(i),f(n+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}},{key:"rect",value:function(e,t){var r=this.ctx,n=e.x,i=e.y,a=e.width,o=e.height,s=e.bgcolor;r.save(),r.beginPath(),r.fillStyle=s||"#fff",r.rect(h(n+1),h(i+1),f(a-2),f(o-2)),r.clip(),r.fill(),t(),r.restore()}},{key:"rect2",value:function(e,t){var r=this.ctx,n=e.x,i=e.y,a=e.width,o=e.bgcolor,s=e.height;r.save(),r.beginPath(),r.fillStyle="rgba(0, 0, 0, 0)"===o?"#fff":o||"#fff",r.rect(h(n+1),h(i+1),f(a-2),f(s-2)),r.clip(),r.fill(),t(),r.restore()}}]),e}();t.Draw=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(10),a=r(2),o=r(11);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=[{key:"copy",title:(0,o.tf)("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:(0,o.tf)("contextmenu.cut"),label:"Ctrl+X"},{key:"divider"},{key:"insert-row",title:(0,o.tf)("contextmenu.insertRow")},{key:"insert-column",title:(0,o.tf)("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:(0,o.tf)("contextmenu.deleteRow")},{key:"delete-column",title:(0,o.tf)("contextmenu.deleteColumn")},{key:"delete-cell-text",title:(0,o.tf)("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:(0,o.tf)("contextmenu.validation")}];function c(e){var t=this;return"divider"===e.key?(0,n.h)("div","".concat(a.cssPrefix,"-item divider")):(0,n.h)("div","".concat(a.cssPrefix,"-item")).on("click",(function(r){t.itemClick(e.key,r),t.hide()})).children(e.title(),(0,n.h)("div","label").child(e.label||""))}function f(){var e=this;return u.map((function(t){return c.call(e,t)}))}var h=function(){function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.menus=f.call(this),this.el=(r=(0,n.h)("div","".concat(a.cssPrefix,"-contextmenu"))).children.apply(r,s(this.menus)).hide(),this.viewFn=t,this.itemClick=function(){},this.isHide=i}var t,r,o;return t=e,(r=[{key:"hide",value:function(){var e=this.el;e.hide(),(0,i.unbindClickoutside)(e)}},{key:"setPosition",value:function(e,t){if(!this.isHide){var r=this.el,n=r.show().offset(),a=n.height,o=n.width,s=this.viewFn(),l=t,u=e;s.height-t<=a&&(l-=a),s.width-e<=o&&(u-=o),r.offset({left:u,top:l}),(0,i.bindClickoutside)(r)}}}])&&l(t.prototype,r),o&&l(t,o),e}();t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildButton=O,t.buildButtonWithIcon=A,t.default=void 0;var n=r(1),i=r(10),a=y(r(299)),o=y(r(300)),s=y(r(301)),l=y(r(302)),u=y(r(303)),c=y(r(85)),f=y(r(304)),h=y(r(305)),d=y(r(17)),p=y(r(13)),v=r(2),g=r(11),m=y(r(308));function y(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){return(0,n.h)("div","".concat(v.cssPrefix,"-toolbar-btn")).on("mouseenter",(function(t){(0,a.default)(e,t.target)})).attr("data-tooltip",e)}function M(){return(0,n.h)("div","".concat(v.cssPrefix,"-toolbar-divider"))}function A(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return O(e).child((r=t,new p.default(r))).on("click",(function(){return n()}))}function S(){var e=this;this.ddFormat.change=function(t){return e.change("format",t.key)},this.ddFont.change=function(t){return e.change("font-name",t.key)},this.ddFormula.change=function(t){return e.change("formula",t.key)},this.ddFontSize.change=function(t){return e.change("font-size",t.pt)},this.ddTextColor.change=function(t){return e.change("color",t)},this.ddFillColor.change=function(t){return e.change("bgcolor",t)},this.ddAlign.change=function(t){return e.change("align",t)},this.ddVAlign.change=function(t){return e.change("valign",t)},this.ddBorder.change=function(t){return e.change("border",t)},this.undoEl.change=function(t){return e.change("undo",t)}}function I(e){var t=e,r=e.split("-");r.length>1&&r.forEach((function(e,r){0===r?t=e:t+=e[0].toUpperCase()+e.substring(1)}));var n=this["".concat(t,"El")];n.toggle(),this.change(e,n.hasClass("active"))}var R=function(e){function t(){var e;C(this,t);var r=new p.default("ellipsis"),i=(0,n.h)("div","".concat(v.cssPrefix,"-toolbar-more"));return(e=k(this,N(t).call(this,r,"auto",!1,"bottom-right",!1,i))).moreBtns=i,e.contentEl.css("max-width","420px"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),t}(d.default);function _(){this.btns2=this.btnChildren.map((function(e){var t=e.box(),r=e.computedStyle(),n=r.marginLeft,i=r.marginRight;return[e,t.width+parseInt(n,10)+parseInt(i,10)]}))}function j(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.widthFn,n=this.el,i=this.btns,a=this.moreEl,o=this.ddMore,s=this.btns2,l=o.moreBtns,u=o.contentEl;n.css("width","".concat(r()-60,"px"));var c=n.box(),f=160,h=12,d=[],p=[];s.forEach((function(e,t){var r=x(e,2),n=r[0],i=r[1];f+=i,t===s.length-1||f<c.width?d.push(n):(h+=i,p.push(n))})),(e=i.html("")).children.apply(e,d),(t=l.html("")).children.apply(t,p),u.css("width","".concat(h,"px")),p.length>0?a.show():a.hide()}var D=function(){function e(t,r){var a,d=this,p=arguments.length>2&&void 0!==arguments[2]&&arguments[2];C(this,e),this.data=t,this.change=function(){},this.widthFn=r;var y=t.defaultStyle();this.ddFormat=new l.default,this.ddFont=new o.default,this.ddFormula=new u.default,this.ddFontSize=new s.default,this.ddTextColor=new c.default("text-color",y.color),this.ddFillColor=new c.default("fill-color",y.bgcolor),this.ddAlign=new f.default(["left","center","right"],y.align),this.ddVAlign=new f.default(["top","middle","bottom"],y.valign),this.ddBorder=new h.default,this.ddMore=new R,this.undoEl=new m.default("undo",(function(){return d.change("undo")}),(function(e){return d.change("undoList",e)})),this.redoEl=new m.default("redo",(function(){return d.change("redo")}),(function(e){return d.change("redoList",e)})),this.btnChildren=[O("".concat((0,g.t)("toolbar.undo"))).child(this.undoEl.el),O("".concat((0,g.t)("toolbar.redo"))).child(this.redoEl.el),this.paintformatEl=A("".concat((0,g.t)("toolbar.paintformat")),"paintformat",(function(){return I.call(d,"paintformat")})),M(),O("".concat((0,g.t)("toolbar.format"))).child(this.ddFormat.el),M(),O("".concat((0,g.t)("toolbar.font"))).child(this.ddFont.el),O("".concat((0,g.t)("toolbar.fontSize"))).child(this.ddFontSize.el),M(),this.fontBoldEl=A("".concat((0,g.t)("toolbar.fontBold")," (Ctrl+B)"),"bold",(function(){return I.call(d,"font-bold")})),this.fontItalicEl=A("".concat((0,g.t)("toolbar.fontItalic")," (Ctrl+I)"),"italic",(function(){return I.call(d,"font-italic")})),this.underlineEl=A("".concat((0,g.t)("toolbar.underline")," (Ctrl+U)"),"underline",(function(){return I.call(d,"underline")})),this.strikeEl=A("".concat((0,g.t)("toolbar.strike")),"strike",(function(){return I.call(d,"strike")})),O("".concat((0,g.t)("toolbar.textColor"))).child(this.ddTextColor.el),M(),O("".concat((0,g.t)("toolbar.fillColor"))).child(this.ddFillColor.el),O("".concat((0,g.t)("toolbar.border"))).child(this.ddBorder.el),this.mergeEl=A("".concat((0,g.t)("toolbar.merge")),"merge",(function(){return I.call(d,"merge")})),M(),O("".concat((0,g.t)("toolbar.align"))).child(this.ddAlign.el),O("".concat((0,g.t)("toolbar.valign"))).child(this.ddVAlign.el),this.textwrapEl=A("".concat((0,g.t)("toolbar.textwrap")),"textwrap",(function(){return I.call(d,"textwrap")})),M(),this.freezeEl=A("".concat((0,g.t)("toolbar.freeze")),"freeze",(function(){return I.call(d,"freeze")})),this.addEl=A("".concat((0,g.t)("toolbar.add")),"add",(function(){return I.call(d,"add")})),this.closeEl=A("".concat((0,g.t)("toolbar.calc")),"close",(function(){return I.call(d,"close")})),this.autofilterEl=A("".concat((0,g.t)("toolbar.autofilter")),"autofilter",(function(){return I.call(d,"autofilter")})),this.throwFormulaEl=A("".concat((0,g.t)("toolbar.throwFormula")),"chevron-right",(function(){return I.call(d,"throwFormula")})),this.moreEl=O("".concat((0,g.t)("toolbar.more"))).child(this.ddMore.el).hide()],this.el=(0,n.h)("div","".concat(v.cssPrefix,"-toolbar")),this.btns=(a=(0,n.h)("div","".concat(v.cssPrefix,"-toolbar-btns"))).children.apply(a,b(this.btnChildren)),this.el.child(this.btns),p&&this.el.hide(),S.call(this),this.reset(),setTimeout((function(){_.call(d),j.call(d)}),0),(0,i.bind)(window,"resize",(function(){j.call(d,t.settings.view.width)}))}var t,r,a;return t=e,(r=[{key:"paintformatActive",value:function(){return this.paintformatEl.hasClass("active")}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(e){I.call(this,e)}},{key:"reset",value:function(){var e=this.data,t=e.getSelectedCellStyle(),r=e.getSelectedCell();this.undoEl.disabled(!e.canUndo()),this.redoEl.disabled(!e.canRedo()),this.mergeEl.active(e.canUnmerge()).disabled(!e.selector.multiple()),this.autofilterEl.active(!e.canAutofilter());var n=t.font;this.ddFont.setTitle(n.name),this.ddFontSize.setTitle(n.size),this.fontBoldEl.active(n.bold),this.fontItalicEl.active(n.italic),this.underlineEl.active(t.underline),this.strikeEl.active(t.strike),this.ddTextColor.setTitle(t.color),this.ddFillColor.setTitle(t.bgcolor),this.ddAlign.setTitle(t.align),this.ddVAlign.setTitle(t.valign),this.textwrapEl.active(t.textwrap),this.addEl.active(e.equationIsActive()),this.closeEl.active(!1),this.throwFormulaEl.active(!1),this.freezeEl.active(e.freezeIsActive()),r&&r.format&&this.ddFormat.setTitle(r.format)}}])&&w(t.prototype,r),a&&w(t,a),e}();t.default=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t.classList.contains("active"))return;var r=t.getBoundingClientRect(),o=r.left,s=r.top,l=r.width,u=r.height,c=(0,n.h)("div","".concat(a.cssPrefix,"-tooltip")).html(e).show();document.body.appendChild(c.el);var f=c.box();c.css("left","".concat(o+l/2-f.width/2,"px")).css("top","".concat(s+u+2,"px")),(0,i.bind)(t,"mouseleave",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)})),(0,i.bind)(t,"click",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)}))};var n=r(1),i=r(10),a=r(2)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},a=r(1),o=r(32),s=r(2);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.baseFonts.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.setTitle(e.title),r.change(e)})).child(e.title)}));return r=c(this,(e=f(t)).call.apply(e,[this,o.baseFonts[0].title,"160px",!0,"bottom-left",{type:!1}].concat(u(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),t}(i.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},a=r(1),o=r(32),s=r(2);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.fontSizes.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.setTitle("".concat(e.pt)),r.change(e)})).child("".concat(e.pt))}));return r=c(this,(e=f(t)).call.apply(e,[this,"10","60px",!0,"bottom-left",{type:!1}].concat(u(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),t}(i.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},a=r(1),o=r(48),s=r(2);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.baseFormats.slice(0);return n.splice(1,0,{key:"divider"}),n.splice(5,0,{key:"divider"}),n=n.map((function(e){var t=(0,a.h)("div","".concat(s.cssPrefix,"-item"));return"divider"===e.key?t.addClass("divider"):(t.child(e.title()).on("click",(function(){r.setTitle(e.title()),r.change(e)})),e.label&&t.child((0,a.h)("div","label").html(e.label))),t})),r=f(this,(e=h(t)).call.apply(e,[this,"Normal","220px",!0,"bottom-left",{type:!1}].concat(u(n))))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){for(var t=0;t<o.baseFormats.length;t+=1)o.baseFormats[t].key===e&&this.title.html(o.baseFormats[t].title);this.hide()}}])&&c(r.prototype,n),i&&c(r,i),t}(i.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(17)),i=l(r(13)),a=r(1),o=r(25),s=r(2);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.baseFormulas.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.hide(),r.change(e)})).child(e.key)}));return r=f(this,(e=h(t)).call.apply(e,[this,new i.default("formula"),"180px",!0,"bottom-left",{type:!1}].concat(c(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(17)),i=r(1),a=s(r(13)),o=r(2);function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e,r){var n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=new a.default("align-".concat(r)),c=e.map((function(e){return(t="align-".concat(e),(0,i.h)("div","".concat(o.cssPrefix,"-item")).child(new a.default(t))).on("click",(function(){s.setTitle(e),s.change(e)}));var t}));return s=f(this,(n=h(t)).call.apply(n,[this,l,"auto",!0,"bottom-left",{type:!1}].concat(u(c))))}var r,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.setName("align-".concat(e)),this.hide()}}])&&c(r.prototype,n),s&&c(r,s),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(17)),i=o(r(13)),a=o(r(306));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new i.default("border-all"),n=new a.default;return n.change=function(t){e.change(t),e.hide()},(e=l(this,u(t).call(this,r,"auto",!1,"bottom-left",{type:!1},n.el))).borderPalette=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),t}(n.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=l(r(13)),a=l(r(85)),o=l(r(307)),s=r(2);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(){var e;return(0,n.h)("table","").child((e=(0,n.h)("tbody","")).children.apply(e,arguments))}function h(e){var t=this,r=(0,n.h)("div","".concat(s.cssPrefix,"-border-palette-cell"));return this.items.push(r),(0,n.h)("td","").child(r.child(new i.default("border-".concat(e))).on("click",(function(){t.mode=e;var r=t.mode,n=t.style,i=t.color;t.change({mode:r,style:n,color:i})})))}t.default=function e(){var t,r,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new a.default("line-color",this.color),this.ddColor.change=function(e){i.color=e},this.ddType=new o.default(this.style),this.ddType.change=function(e){var t=c(e,1)[0];i.style=t},this.el=(0,n.h)("div","".concat(s.cssPrefix,"-border-palette")),this.items=[];var l=f((0,n.h)("tr","").children((0,n.h)("td","".concat(s.cssPrefix,"-border-palette-left")).child(f((t=(0,n.h)("tr","")).children.apply(t,u(["all","inside","horizontal","vertical","outside"].map((function(e){return h.call(i,e)})))),(r=(0,n.h)("tr","")).children.apply(r,u(["left","top","right","bottom","none"].map((function(e){return h.call(i,e)})))))),(0,n.h)("td","".concat(s.cssPrefix,"-border-palette-right")).children((0,n.h)("div","".concat(s.cssPrefix,"-toolbar-btn")).child(this.ddColor.el),(0,n.h)("div","".concat(s.cssPrefix,"-toolbar-btn")).child(this.ddType.el))));this.el.child(l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(17)),i=r(1),a=s(r(13)),o=r(2);function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],p=function(e){function t(e){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=new a.default("line-type"),l=0,h=d.map((function(t,r){return(0,i.h)("div","".concat(o.cssPrefix,"-item state ").concat(e===t[0]?"checked":"")).on("click",(function(){h[l].toggle("checked"),h[r].toggle("checked"),l=r,n.hide(),n.change(t)})).child((0,i.h)("div","".concat(o.cssPrefix,"-line-type")).html(t[1]))}));return n=c(this,(r=f(t)).call.apply(r,[this,s,"auto",!1,"bottom-left",{type:!1}].concat(u(h))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(17)),i=o(r(13)),a=o(r(309));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=new i.default(e).css("height","18px"),s=new a.default;return l(this,u(t).call(this,o,"auto",!0,"bottom-left",{type:!0,change:r,arrowChange:n,historyBorder:s},s.el))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),t}(n.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-history-border")),this.history=(0,n.h)("div","".concat(i.cssPrefix,"-history-content")).html("暂无内容"),this.el.child(this.history)}var t,r,o;return t=e,(r=[{key:"setContent",value:function(e){var t;e=e.slice(e.length-100<0?0:e.length,e.length),this.el.html("");for(var r=[],i=e.length-1;i>=0;i--){var a=(0,n.h)("div",""),o=e[i].action;a.html(o),r.push(a)}console.log(this,this.el),(t=this.el).children.apply(t,r)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(r(86)),i=f(r(311)),a=f(r(312)),o=f(r(313)),s=f(r(49)),l=r(11),u=r(1),c=r(2);function f(e){return e&&e.__esModule?e:{default:e}}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=100,y=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new o.default(new a.default("cell",["cell"],"100%",(function(e){return(0,l.t)("dataValidation.modeType.".concat(e))})),{required:!0},"".concat((0,l.t)("dataValidation.range"),":"),m),n=new o.default(new i.default("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),f=new o.default(new a.default("list",["list","number","date","phone","email"],"100%",(function(e){return(0,l.t)("dataValidation.type.".concat(e))}),(function(t){return e.criteriaSelected(t)})),{required:!0},"".concat((0,l.t)("dataValidation.criteria"),":"),m),h=new o.default(new a.default("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(e){return(0,l.t)("dataValidation.operator.".concat(e))}),(function(t){return e.criteriaOperatorSelected(t)})),{required:!0}).hide(),d=new o.default(new i.default("70px","10"),{required:!0}).hide(),g=new o.default(new i.default("70px","100"),{required:!0,type:"number"}).hide(),y=new o.default(new i.default("120px","a,b,c"),{required:!0}),b=new o.default(new i.default("70px","10"),{required:!0,type:"number"}).hide();return(e=p(this,v(t).call(this,(0,l.t)("contextmenu.validation"),[(0,u.h)("div","".concat(c.cssPrefix,"-form-fields")).children(r.el,n.el),(0,u.h)("div","".concat(c.cssPrefix,"-form-fields")).children(f.el,h.el,d.el,g.el,b.el,y.el),(0,u.h)("div","".concat(c.cssPrefix,"-buttons")).children(new s.default("cancel").on("click",(function(){return e.btnClick("cancel")})),new s.default("remove").on("click",(function(){return e.btnClick("remove")})),new s.default("save","primary").on("click",(function(){return e.btnClick("save")})))]))).mf=r,e.rf=n,e.cf=f,e.of=h,e.minvf=d,e.maxvf=g,e.vf=b,e.svf=y,e.change=function(){},e}var r,n,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,e),r=t,(n=[{key:"criteriaSelected",value:function(e){var t=this.of,r=this.minvf,n=this.maxvf,i=this.vf,a=this.svf;"date"===e||"number"===e?(t.show(),r.rule.type=e,n.rule.type=e,"date"===e?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),i.hide(),a.hide()):("list"===e?a.show():a.hide(),i.hide(),t.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(e){if(e){var t=this.minvf,r=this.maxvf,n=this.vf;if("be"===e||"nbe"===e)t.show(),r.show(),n.hide();else{var i=this.cf.val();n.rule.type=i,"date"===i?n.hint("2018-11-12"):n.hint("10"),n.show(),t.hide(),r.hide()}}}},{key:"btnClick",value:function(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){for(var t=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<t.length;r+=1){var n=this[t[r]];if(n.isShow()&&!n.validate())return}var i=this.mf.val(),a=this.rf.val(),o=this.cf.val(),s=this.of.val(),l=this.svf.val();"number"!==o&&"date"!==o||(l="be"===s||"nbe"===s?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,a,{type:o,operator:s,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(e){if(e){var t=this.mf,r=this.rf,n=this.cf,i=this.of,a=this.svf,o=this.vf,s=this.minvf,l=this.maxvf,u=e.mode,c=e.ref,f=e.validator||{type:"list"},h=f.type,d=f.operator,p=f.value;t.val(u||"cell"),r.val(c),n.val(h),i.val(d),Array.isArray(p)?(s.val(p[0]),l.val(p[1])):(a.val(p||""),o.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(d)}this.show()}}])&&d(r.prototype,n),f&&d(r,f),t}(n.default);t.default=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vchange=function(){},this.el=(0,n.h)("div","".concat(i.cssPrefix,"-form-input")),this.input=(0,n.h)("input","").css("width",t).on("input",(function(e){return a.vchange(e)})).attr("placeholder",r),this.el.child(this.input)}var t,r,o;return t=e,(r=[{key:"hint",value:function(e){this.input.attr("placeholder",e)}},{key:"val",value:function(e){return this.input.val(e)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=(n=r(83))&&n.__esModule?n:{default:n},o=r(2);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r,n){var s=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t,this.getTitle=l,this.vchange=function(){},this.el=(0,i.h)("div","".concat(o.cssPrefix,"-form-select")),this.suggest=new a.default(r.map((function(e){return{key:e,title:s.getTitle(e)}})),(function(e){s.itemClick(e.key),u(e.key),s.vchange(e.key)}),n,this.el),this.el.children(this.itemEl=(0,i.h)("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",(function(){return s.show()}))}var t,r,n;return t=e,(r=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(e){this.key=e,this.itemEl.html(this.getTitle(e))}},{key:"val",value:function(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2),a=r(11);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},l=function(){function e(t,r,a,o){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label="",this.rule=r,a&&(this.label=(0,n.h)("label","label").css("width","".concat(o,"px")).html(a)),this.tip=(0,n.h)("div","tip").child("tip").hide(),this.input=t,this.input.vchange=function(){return s.validate()},this.el=(0,n.h)("div","".concat(i.cssPrefix,"-form-field")).children(this.label,t.el,this.tip)}var t,r,l;return t=e,(r=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(e){return this.input.val(e)}},{key:"hint",value:function(e){this.input.hint(e)}},{key:"validate",value:function(){var e=this.input,t=this.rule,r=this.tip,n=this.el,i=e.val();return t.required&&/^\s*$/.test(i)?(r.html((0,a.t)("validation.required")),n.addClass("error"),!1):!t.type&&!t.pattern||(t.pattern||s[t.type]).test(i)?(n.removeClass("error"),!0):(r.html((0,a.t)("validation.notMatch")),n.addClass("error"),!1)}}])&&o(t.prototype,r),l&&o(t,l),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=(n=r(49))&&n.__esModule?n:{default:n},o=r(10),s=r(2),l=r(11);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){return(0,i.h)("div","".concat(s.cssPrefix,"-item ").concat(e))}function f(e){var t=this;return c("state").child((0,l.t)("sort.".concat(e))).on("click.stop",(function(){return t.itemClick(e)}))}function h(e){var t=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(e).forEach((function(a,o){var u=e[a],c=n.includes(a)?"checked":"";r.child((0,i.h)("div","".concat(s.cssPrefix,"-item state ").concat(c)).on("click.stop",(function(){return t.filterClick(o,a)})).children(""===a?(0,l.t)("filter.empty"):a,(0,i.h)("div","label").html("(".concat(u,")"))))}))}function d(){var e=this.filterhEl,t=this.filterValues,r=this.values;e.html("".concat(t.length," / ").concat(r.length)),e.checked(t.length===r.length)}var p=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterbEl=(0,i.h)("div","".concat(s.cssPrefix,"-body")),this.filterhEl=(0,i.h)("div","".concat(s.cssPrefix,"-header state")).on("click.stop",(function(){return t.filterClick(0,"all")})),this.tindex=1,this.el=(0,i.h)("div","".concat(s.cssPrefix,"-sort-filter")).children(this.sortAscEl=f.call(this,"asc"),this.sortDescEl=f.call(this,"desc"),c("divider"),(0,i.h)("div","".concat(s.cssPrefix,"-filter")).children(this.filterhEl,this.filterbEl),(0,i.h)("div","".concat(s.cssPrefix,"-buttons")).children(new a.default("cancel").on("click",(function(){return t.btnClick("cancel")})),new a.default("ok","primary").on("click",(function(){return t.btnClick("ok")})))).hide(),this.el.on("mousedown.stop",(function(e){t.tindex=1})),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var t,r,n;return t=e,(r=[{key:"btnClick",value:function(e){if("ok"===e){var t=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(t,r,"in",n)}this.hide()}},{key:"itemClick",value:function(e){this.sort=e;var t=this.sortAscEl,r=this.sortDescEl;t.checked("asc"===e),r.checked("desc"===e)}},{key:"filterClick",value:function(e,t){var r=this.filterbEl,n=this.filterValues,a=this.values,o=r.children();"all"===t?o.length===n.length?(this.filterValues=[],o.forEach((function(e){return(0,i.h)(e).checked(!1)}))):(this.filterValues=Array.from(a),o.forEach((function(e){return(0,i.h)(e).checked(!0)}))):(0,i.h)(o[e]).toggle("checked")?n.push(t):n.splice(n.findIndex((function(e){return e===t})),1),d.call(this)}},{key:"set",value:function(e,t,r,n){this.ci=e;var i=this.sortAscEl,a=this.sortDescEl;null!==n?(this.sort=n.order,i.checked(n.asc()),a.checked(n.desc())):(this.sortDesc=null,i.checked(!1),a.checked(!1)),this.values=Object.keys(t),this.filterValues=r?Array.from(r.value):Object.keys(t),h.call(this,t,r),d.call(this)}},{key:"setOffset",value:function(e){var t=this;if(this.el.isShow())this.hide();else{this.el.offset(e).show();var r=1;console.log(this.el),(0,o.bindClickoutside)(this.el,(function(){0===r&&t.hide(),r=0}))}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),(0,o.unbindClickoutside)(this.el)}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xtoast=function(e,t){var r=(0,i.h)("div","".concat(o.cssPrefix,"-toast")),n=(0,i.h)("div","".concat(o.cssPrefix,"-dimmer active"));r.children((0,i.h)("div","".concat(o.cssPrefix,"-toast-header")).children(new a.default("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),e),(0,i.h)("div","".concat(o.cssPrefix,"-toast-content")).html(t)),document.body.appendChild(r.el),document.body.appendChild(n.el);var s=r.box(),l=s.width,u=s.height,c=document.documentElement,f=c.clientHeight,h=c.clientWidth;r.offset({left:(h-l)/2,top:(f-u)/3})};var n,i=r(1),a=(n=r(13))&&n.__esModule?n:{default:n},o=r(2)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(2),a=r(46);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-advice")).children(this.save=(0,n.h)("div","".concat(i.cssPrefix,"-advice-style")).css("border-bottom","1px solid"),this.text=(0,n.h)("div","".concat(i.cssPrefix,"-advice-style"))).hide(),this.save.children(this.saveCheck=(0,n.h)("span","check").hide("visibility","hidden"),(0,n.h)("span","").html("保留样式")),this.text.children(this.textCheck=(0,n.h)("span","check").hide("visibility","hidden"),(0,n.h)("span","").html("仅文本")),this.data=t,this.sheet=r,this.left=0,this.top=0,this.save.on("mousedown.stop",(function(){o.saveCheck.show("visibility","initial"),o.textCheck.hide("visibility","hidden"),o.sheet.setCellRange(o.reference,o.tableProxy,!0),a.sheetReset.call(o.sheet)})),this.text.on("mousedown.stop",(function(){o.sheet.setCellRange(o.reference,o.tableProxy,!1),o.saveCheck.show("visibility","hidden"),o.textCheck.hide("visibility","initial"),a.sheetReset.call(o.sheet)}))}var t,r,s;return t=e,(r=[{key:"show",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.el.css("left","".concat(e,"px")),this.el.css("top","".concat(t,"px")),1===r&&(this.saveCheck.show("visibility","initial"),this.textCheck.hide("visibility","hidden")),this.left=parseInt(e),this.top=parseInt(t),this.tableProxy=i,this.reference=n,this.el.show()}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(1),a=r(2),o=(n=r(6))&&n.__esModule?n:{default:n},s=r(318);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.el=(0,i.h)("div","".concat(a.cssPrefix,"-hyperlink-tooltip")).hide(),this.tableEl=(0,i.h)("div","".concat(a.cssPrefix,"-hyperlink-tooltip")).hide(),this.editor=r,this.tableEl.attr("tabindex",0),this.tableEl.css("overflow-y","auto"),this.tableEl.css("max-height","400px"),this.timer=null,this.timer2=null}var t,r,n;return t=e,(r=[{key:"show",value:function(e,t){var r=this;if(this.editor.isDisplay2())return this.el.hide(),void this.tableEl.hide();var n=this.data,l=n.getCellTextOrDefault(e,t)+"";if(clearTimeout(this.timer),clearTimeout(this.timer2),0===a.look.indexOf(l.split("!")[0])){var u=n.getRect(new o.default(e,t,e,t)),c=u.left+55,f=u.top+50,h=JSON.parse(l.substring(l.indexOf("!")+1,l.length));this.tableEl.css("left","".concat(c,"px")),this.tableEl.css("top","".concat(f,"px")),this.tableEl.css("user-select","text"),this.tableEl.html("");var d=(0,i.h)("table","");d.css("border-spacing","0px");var p=(0,i.h)("tr","");p.children((0,i.h)("td","").css("border","1px solid black").html("序号"),(0,i.h)("td","").css("border","1px solid black").html("项目名称"),(0,i.h)("td","").css("border","1px solid black").html("城市"),(0,i.h)("td","").css("border","1px solid black").html("占地面积"),(0,i.h)("td","").css("border","1px solid black").html("差额")),d.children(p);for(var v=0;v<h.length;v++){var g=h[v],m=g.number,y=g.name,b=g.city,w=g.area,x=g.value,E=(0,i.h)("tr",""),C=(0,i.h)("td","");C.html(m),C.css("border","1px solid black");var k=(0,i.h)("td","");k.html(y),k.css("border","1px solid black");var N=(0,i.h)("td","");N.html(b),N.css("border","1px solid black");var T=(0,i.h)("td","");T.html(w),T.css("border","1px solid black");var O=(0,i.h)("td","");O.html(x),O.css("border","1px solid black"),E.children(C,k,N,T,O),d.children(E)}this.tableEl.children(d),this.timer=setTimeout((function(){r.tableEl.show(),r.el.hide()}),150)}else{var M=(0,s.isSpecialWebsite)(l);if(M.state&&(l=M.text),"http://"!==(l="www"===l.substr(0,3).toLowerCase()?"http://"+l:l).substr(0,7).toLowerCase()&&"https://"!==l.substr(0,8).toLowerCase())return this.el.hide(),void this.tableEl.hide();var A=n.getRect(new o.default(e,t,e,t)),S=A.left+55,I=A.top+5;this.el.html(""),this.el.css("color","blue"),this.el.children((0,i.h)("div","aaa").css("border-bottom","1px solid blue").on("click",(function(e){console.log(e);var t=e.screenX,r=e.screenY;window.open(l,"","width=".concat(650,",height=").concat(500,",left=").concat(t+A.width,",top=").concat(r))})).html(l)),this.el.css("left","".concat(S,"px")),this.el.css("top","".concat(I,"px")),this.timer2=setTimeout((function(){r.el.show(),r.tableEl.hide()}),150)}}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSpecialWebsite=function(e){if(1===n.look.indexOf(e.split("!")[0]))return{state:!0,text:JSON.parse(e.split("!")[1]).url};return{state:!1,text:""}},t.specialWebsiteValue=function(e,t){var r=function(e,t){if(1===n.look.indexOf(e.split("!")[0])&&-1===t.toUpperCase().indexOf(i))return 2;return 0}(e,t);if(2===r){var a=e.split(" "),o="";if(a.length>=1){e=a[0];for(var s=1;s<a.length;s++)o+=a[s]}return{state:!0,type:r,text:JSON.parse(e.split("!")[1]).text+o}}return{state:!1,type:r,text:""}},t.multipleCellsRender=function(e,t){var r=[];return Object.keys(t).forEach((function(n){e[n]=t[n],r.push(n)})),r};var n=r(2),i="HYPERLINK"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(86)),i=r(1),a=l(r(49)),o=r(11),s=r(2);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e,t,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=(0,i.h)("span","").html("您输入的公式好像至少缺少一个左括号");return(e=f(this,d(t).call(this,(0,o.t)("contextmenu.errorPop"),[(0,i.h)("div","".concat(s.cssPrefix,"-form-fields")).children(r),(0,i.h)("div","".concat(s.cssPrefix,"-form-fields")),(0,i.h)("div","".concat(s.cssPrefix,"-buttons")).children(new a.default("ok","primary").on("click",(function(){return e.btnClick("ok")})))]))).tip=r,e}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),r=t,(n=[{key:"show",value:function(e){this.tip.html(e),h(d(t.prototype),"show",this).call(this)}},{key:"btnClick",value:function(e){"ok"===e&&this.hide()}}])&&c(r.prototype,n),l&&c(r,l),t}(n.default);t.default=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(2),i=r(8);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rect=t}var t,r,o;return t=e,(r=[{key:"isLocInside",value:function(e,t){var r=this.rect;return e<r.width+r.left&&e>r.left&&t-n.offsetTop>r.top&&t-n.offsetTop<r.top+r.height}},{key:"getUpDownLeftRight",value:function(e,t,r,a){var o=this.rect,s=0;return e<o.width+o.left&&e>o.left?t>o.top+o.height+n.offsetTop?s=1:t-n.offsetTop<o.top&&(s=4):t-(o.top-o.height+n.offsetTop)>0&&o.height+o.top+n.offsetTop>t&&(e>o.width+o.left?s=3:e<o.left&&(s=2)),0===s&&(s=(0,i.positionAngle)(r,e,a,t)),1===s&&t<0?s=4:document.body.clientHeight<t&&4===s&&(s=1),3===s&&e<0?s=2:document.body.clientWidth<e&&2===s&&(s=3),s}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timer=[]}var t,r,i;return t=e,(r=[{key:"push",value:function(e){this.timer.push(e)}},{key:"clear",value:function(){for(var e=0;e<this.timer.length;e++){var t=this.timer[e];clearTimeout(t),clearInterval(t)}}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){this.register=function(r){var n=[],i=["nw","w","ws","s","se","e","ne","n"];i.forEach((function(e){var t=document.createElement("div");t.style.display="block",t.className="direction "+e,n.push(t),r.appendChild(t)}));for(var a=0;a<4;a++){var o=document.createElement("div");o.style.display="block",o.className="line".concat(a+1),r.appendChild(o),n.push(o)}var s=document.createElement("div");function l(n){n<20&&(n=20),e.onResize({width:n},t),r.style.width=n+"px"}function u(n){n<20&&(n=20),e.onResize({height:n},t),r.style.height=n+"px"}s.className="border",r.appendChild(s),i.forEach((function(t){var n=r.querySelector("."+t);n.onmousedown=function(i){if(0===i.button){var a={ox:i.clientX,oy:i.clientY,ow:r.offsetWidth,oh:r.offsetHeight,ol:r.offsetLeft,ot:r.offsetTop};e&&e.onBegin&&e.onBegin.call(r,a);var o=!0;window.onmousemove=function(e){if(o){var r=e.clientX,i=e.clientY,s=r-a.ox,l=i-a.oy;a.width=s,a.height=l;var u=c[t];u&&u.call(n,a,e),e.stopPropagation()}},window.onmouseup=function(t){o=!1,t.stopPropagation(),e&&e.onEnd&&e.onEnd.call(r)},i.stopPropagation()}}})),e?e.onResize||(e.onResize=function(){}):e={onResize:function(){}};var c={s:function(e){u(e.oh+e.height)},e:function(e){l(e.ow+e.width)},w:function(n){var i=n.width,a=n.ol+i,o=n.ow+Math.abs(i);i>0&&(o=n.ow-i),o>20&&(!function(n){e.onResize({left:n},t),r.style.left=n+"px"}(a),l(o))},n:function(n){var i=n.height,a=n.ot+i,o=n.oh+Math.abs(i);i>0&&(o=n.oh-i),o>20&&(u(o),function(n){e.onResize({top:n},t),r.style.top=n+"px"}(a))},se:function(e){c.s(e),c.e(e)},nw:function(e){c.n(e),c.w(e)},ws:function(e){c.w(e),c.s(e)},ne:function(e){c.n(e),c.e(e)}};return n}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(45),a=r(42),o=r(8),s=(n=r(6))&&n.__esModule?n:{default:n},l=r(3);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.rows=new a.Rows({len:0,height:0},t)}var t,r,n;return t=e,(r=[{key:"getComputedStyle",value:function(e){var t=!1;return e.fontWeight>400&&(t=!0),{color:e.color,bgcolor:e.background.substring(0,e.background.indexOf(")")+1),font:{bold:t}}}},{key:"extend",value:function(e,t){var r=t.ri,n=t.ci,i=this.data;if(e.rows.length>=i.rows.len-r){var a=e.rows.length-(i.rows.len-r);a>0&&i.insert("row",a)}if(!1!==(0,l.isHave)(e.rows[0])&&!1!==(0,l.isHave)(e.rows[0].cells)){var o=e.rows[0].cells.length;if(o>=i.cols.len){var s=o-(i.cols.len-n);s>0&&i.insert("column",s,i.cols.len)}}}},{key:"each",value:function(e,t){for(var r=0;r<e.rows.length;r++)for(var n=0;n<e.rows[r].cells.length;n++)t(r,n,e.rows[r].cells[n])}},{key:"dealColSpan",value:function(e){this.each(e,(function(t,r,n){var i=n.getAttribute("colspan");if(i&&i>1)for(var a=0;a<i-1;a++)e.rows[t].insertBefore(document.createElement("td"),e.rows[t].cells[r+1])}))}},{key:"dealStyle",value:function(e,t){var r=this,n=t.ri,a=t.ci,o=this.data,s=this.rows,l=o.styles;this.each(e,(function(e,t,o){var u=document.defaultView.getComputedStyle(o,null),c=r.getComputedStyle(u),f=(0,i.isHaveStyle)(l,c);-1===f&&l.push(c),s.setCell(n+e,a+t,{style:-1===f?l.length-1:f},"all")}))}},{key:"parseTableCellRange",value:function(e,t){var r=t.ri,n=t.ci,i=r,a=n;return this.each(e,(function(e,t){var o=r+e,s=n+t;i<o&&(i=o),a<s&&(a=s)})),new s.default(r,n,i,a)}},{key:"dealReference",value:function(e,t){var r=t.ri,n=t.ci,i=this.rows,a=[];return this.each(e,(function(e,t,s){var l=s.querySelector("reference"),u=s.innerText||"";if(l){var c=l.getAttribute("ri"),f=l.getAttribute("ci"),h=(0,o.splitStr)(u),d=e+r-c,p=t+n-f,v=i.getCellTextByShift(h,p,d),g=v.bad,m=v.result;i.updateCellReferenceByShift(g,m,r+e,n+t)}else{var y=i.getCell(r+e,n+t)||{};y.text=u,y.formulas=u,i.setCell(r+e,n+t,y,"all")}a.push({ri:r+e,ci:n+t})})),{reference:a}}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDate=function(e){if(!(0,s.isHave)(e)||!(0,s.isNumber)(e))return{state:!1,date_formula:"",minute:!1};var t=l(e,(function(e){return 24*e*60}));t=(0,o.formatNumberRender)(t,5);var r=(0,i.default)("1900-01-01"),n=(0,i.default)("1900-01-01"),a=!1;if((0,s.isHave)(t)&&1*t>0){var u=l(t,(function(e){return 60*e}));a=!0,u=(0,o.formatNumberRender)(u,5),n=(0,i.default)("1900-01-01  00:00:00").set("minute",t).set("second",u)}var c="";if(a){c=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD");var f=n.add(e,"day").subtract(2,"day").format("YYYY-MM-DD  h:mm:ss");return{state:"Invalid Date"!==c,date:c,date_formula:f,minute:!0}}return{state:"Invalid Date"!==(c=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD")),date:c,date_formula:"",minute:!1}},t.changeFormat=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY年MM月DD日";return(0,i.default)(e).format(t)},t.calcDecimals=l,t.dateDiff=function(e){for(var t=!1,r=0;!1===t&&r<a.datePattern.length;r++)t=(0,a.str2Re)(a.datePattern[r]).test(e);return!1===t?{isValid:!1}:(e=(e=e.replace(/[年|月]/g,"-")).replace(/[日]/g,""),{diff:(0,i.default)(e).diff((0,i.default)("1900-01-01"),"day")+2,isValid:!0})};var n,i=(n=r(64))&&n.__esModule?n:{default:n},a=r(26),o=r(48),s=r(3);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=e.toString().split(".");if(r.length>2)return e;for(var n=r[1]+"",i=n,a=0;a<n.length;a++)i*=.1;return t(i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(4),a=(n=r(35))&&n.__esModule?n:{default:n},o=r(33);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){this.undoItems.push(e),this.redoItems=[]}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.undoItems=[],this.redoItems=[],this.data=t}var t,r,n;return t=e,(r=[{key:"addStep",value:function(e,t){var r=e.type,n=e.action,i=e.ri,s=e.ci,u=e.expr,c=e.cellRange,f=e.cells,h=e.height,d=e.width,p=e.property,v=e.value,g=e.oldData,m=t.oldCell,y=t.newCell,b=t.oldMergesData,w=t.newMergesData,x=t.oldStep,E="";1===r?(E=new a.default({type:r,action:n,ri:i,ci:s,expr:u,oldCell:m,newCell:y},this.data),l.call(this,E)):2===r||5===r||11===r||12===r||6===r?(E=new a.default({type:r,oldMergesData:b,property:p,value:v,newMergesData:w,action:n,cellRange:c,oldCell:m,newCell:f},this.data),l.call(this,E)):13===r?(E=new a.default({type:r,oldData:g,newData:x.oldData,action:n},this.data),l.call(this,E)):3===r?(E=new a.default({type:r,action:n,height:h,ri:i,oldStep:x},this.data),l.call(this,E)):4===r&&(E=new a.default({type:r,action:n,width:d,ci:s,oldStep:x},this.data),l.call(this,E)),o.testValid.call(this)}},{key:"getStepType",value:function(e,t){var r=t.ri,n=t.ci,a=t.expr,o=t.text,s=t.range,l=t.cellRange,u=t.property,c=t.value,f="",h=this.data,d=h.rows,p=h.cols;if(1===e)return{action:f="在".concat(a,'中键入"').concat(o,'"'),type:e,ri:r,ci:n,expr:a};if(2===e){var v=(0,i.xy2expr)(s.sci,s.sri),g=(0,i.xy2expr)(s.eci,s.eri);return a=v===g?v:"".concat(v,":").concat(g),{action:f="删除".concat(a,"的单元格内容"),type:e,cellRange:s,cells:this.eachRange(s)}}return 3===e?{action:f="行宽",type:e,height:d.getHeight(r),ri:r}:4===e?{action:f="列宽",type:e,width:p.getWidth(n),ci:n}:5===e?{action:f="自动填充",type:e,cellRange:s,cells:this.eachRange(l)}:12===e?{action:f="选择性粘贴",type:e,cellRange:s,property:u,value:c,cells:this.eachRange(l)}:13===e?{action:f="插入单元格",type:e,oldData:this.data.getData()}:11===e?("font-bold"===u||"font-italic"===u||"font-name"===u||"font-size"===u||"color"===u?f="字体":"underline"===u?f="下划线":"bgcolor"===u||"format"===u?f="单元格格式":"align"===u?"left"===c?f="左对齐":"center"===c?f="居中":"right"===c&&(f="右对齐"):"valign"===u?"top"===c?f="顶端对齐":"center"===c?f="居中":"bottom"===c&&(f="底端对齐"):"border"===u?f="边框":"strike"===u?f="删除线":"merge"===u&&(f="合并单元格"),{action:f,type:e,cellRange:s,property:u,value:c,cells:this.eachRange(l)}):6===e?{action:f="粘贴",type:e,cellRange:s,cells:this.eachRange(l)}:void 0}},{key:"undo",value:function(){var e=this.does(this.getItems(1),1);this.redoItems.push(e)}},{key:"redo",value:function(){var e=this.does(this.getItems(2),2);this.undoItems.push(e)}},{key:"eachRange",value:function(e){return this.data.rows.eachRange(e)}},{key:"does",value:function(e,t){if(this.data.settings.showEditor&&!(e.length<=0)){var r=this.data,n=r.sheet,i=e.pop();return i.restore(r,n,t),i}}},{key:"getItems",value:function(e){return 1===e?this.undoItems:this.redoItems}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(30))&&n.__esModule?n:{default:n},a=(r(3),r(4));function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectorRange=t,this.dstRange=r}var t,r,n;return t=e,(r=[{key:"getPaintType",value:function(){var e=this.dstRange,t=this.selectorRange;return function(e,t){return 1===e&&1===t?1:1===e&&2===t?2:1===e&&3===t?3:2===e&&1===t?4:3===e&&1===t?5:2===e&&2===t?6:2===e&&3===t?7:3===e&&2===t?8:3===e&&3===t?9:void 0}(e.getType(),t.getType())}},{key:"makePaintArr",value:function(e,t){var r=this.dstRange,n=this.selectorRange,o=[],s=n.eci-n.sci,l=0,u=r.sri,c=0,f=function(e,t){var r=t.sri,n=[],i=[],a=0;return t.each((function(t,o){r!==t&&(r=t,n.push(i),i=[]),i.push(e[a]),a+=1})),n.push(i),n}(t,n);return r.each((function(e,t){u!==e&&(l=0,(c+=1)===f.length&&(c=0));var r=f[c][l].cell,n=new i.default(e,t,r,(0,a.xy2expr)(e,t));o.push(n),l===s?l=0:l+=1,u=e})),o}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=s},function(e,t,r){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={toolbar:{undo:"撤销",redo:"恢复",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",font:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",textColor:"字体颜色",fillColor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",add:"显示公式",calc:"开始计算",formula:"函数",more:"更多",throwFormula:"清除公式",comeBack:"返回"},revision:{comeBack:"退出"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",insertRow:"插入行",insertColumn:"插入列",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",errorPop:"出现问题",recover:"恢复此版本"},format:{normal:"常规",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},date_formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bugout=void 0;var n=r(330),i="";t.bugout=i;try{t.bugout=i=new n.debugout}catch(e){console.error(e)}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.debugout=function(){var e=this;if(e.realTimeLoggingOn=!0,e.useTimestamps=!1,e.useLocalStorage=!0,e.recordLogs=!0,e.autoTrim=!0,e.maxLines=2500,e.tailNumLines=100,e.logFilename="debugout.txt",e.depth=0,e.parentSizes=[0],e.currentResult="",e.startTime=new Date,e.output="",this.version=function(){return"0.5.0"},this.getLog=function(){var t=new Date;if(e.recordLogs||e.log("[debugout.js] log recording is off."),e.useLocalStorage){var r=window.localStorage.getItem("debugout.js");r&&(r=JSON.parse(r),e.startTime=new Date(r.startTime),e.output=r.log,t=new Date(r.lastLog))}return e.output+"\n---- Log retrieved: "+t+" ----\n"+e.formatSessionDuration(e.startTime,t)},this.tail=function(t){t=t||e.tailLines;return e.trimLog(e.getLog(),t)},this.search=function(t){for(var r=e.output.split("\n"),n=new RegExp(t),i=[],a=0;a<r.length;a++){var o="["+a+"] ";r[a].match(n)&&i.push(o+r[a])}var s=i.join("\n");return 0==s.length&&(s='Nothing found for "'+t+'".'),s},this.getSlice=function(t,r){return e.output.split("\n").slice(t,t+r).join("\n")},this.downloadLog=function(){var t="data:text/plain;charset=utf-8,",r=e.getLog();t+=encodeURIComponent(r);var n=document.createElement("a");n.href=t,n.target="_blank",n.download=e.logFilename,document.body.appendChild(n),n.click(),n.remove()},this.clear=function(){var t=new Date;if(e.output="---- Log cleared: "+t+" ----\n",e.useLocalStorage){var r={startTime:e.startTime,log:e.output,lastLog:t};r=JSON.stringify(r),window.localStorage.setItem("debugout.js",r)}e.realTimeLoggingOn&&console.log("[debugout.js] clear()")},this.log=function(t){if(e.realTimeLoggingOn&&console.log(t),null!=e.determineType(t)&&e.recordLogs){var r=t;if(e.useTimestamps){var n=new Date;e.output+=e.formatTimestamp(n)}if(e.output+=r+"\n",e.autoTrim&&(e.output=e.trimLog(e.output,e.maxLines)),e.useLocalStorage){var i=new Date,a={startTime:e.startTime,log:e.output,lastLog:i};a=JSON.stringify(a),window.localStorage.setItem("debugout.js",a)}}e.depth=0,e.parentSizes=[0],e.currentResult=""},this.determineType=function(e){if(null!=e){var t,r=n(e);if("object"==r)t=null==e.length?"function"==typeof e.getTime?"Date":"function"==typeof e.test?"RegExp":"Object":"Array";else t=r;return t}return null},this.formatType=function(t,r){switch(t){case"Object":e.currentResult+="{\n",e.depth++,e.parentSizes.push(e.objectSize(r));var n=0;for(var i in r){e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+=i+": ";var a=e.determineType(r[i]);(o=e.formatType(a,r[i]))?(e.currentResult+=o,n!=e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"):(n!=e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"),n++}if(e.depth--,e.parentSizes.pop(),e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+="}",0==e.depth)return e.currentResult;break;case"Array":e.currentResult+="[",e.depth++,e.parentSizes.push(r.length);for(n=0;n<r.length;n++){var o;"Object"!=(a=e.determineType(r[n]))&&"Array"!=a||(e.currentResult+="\n"+e.indentsForDepth(e.depth)),(o=e.formatType(a,r[n]))?(e.currentResult+=o,n!=e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Array"==a&&(e.currentResult+="\n")):(n!=e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Object"!=a?e.currentResult+="\n":n==e.parentSizes[e.depth]-1&&(e.currentResult+="\n"))}if(e.depth--,e.parentSizes.pop(),e.currentResult+="]",0==e.depth)return e.currentResult;break;case"function":var s=(r+="").split("\n");for(n=0;n<s.length;n++)s[n].match(/\}/)&&e.depth--,e.currentResult+=e.indentsForDepth(e.depth),s[n].match(/\{/)&&e.depth++,e.currentResult+=s[n]+"\n";return e.currentResult;case"RegExp":return"/"+r.source+"/";case"Date":case"string":return e.depth>0||0==r.length?'"'+r+'"':r;case"boolean":return r?"true":"false";case"number":return r+""}},this.indentsForDepth=function(e){for(var t="",r=0;r<e;r++)t+="\t";return t},this.trimLog=function(e,t){var r=e.split("\n");return r.length>t&&(r=r.slice(r.length-t)),r.join("\n")},this.lines=function(){return e.output.split("\n").length},this.formatSessionDuration=function(e,t){var r=t-e,n=Math.floor(r/1e3/60/60),i=("0"+n).slice(-2);r-=1e3*n*60*60;var a=Math.floor(r/1e3/60),o=("0"+a).slice(-2);r-=1e3*a*60;var s=Math.floor(r/1e3);return r-=1e3*s,"---- Session duration: "+i+":"+o+":"+("0"+s).slice(-2)+" ----"},this.formatTimestamp=function(e){var t=e.getFullYear(),r=e.getDate();return"["+t+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+r+" "+Number(e.getHours())+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)+"]: "},this.objectSize=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},e.useLocalStorage){var t=window.localStorage.getItem("debugout.js");if(t){t=JSON.parse(t),e.output=t.log;var r=new Date(t.startTime),i=new Date(t.lastLog);e.output+="\n---- Session end: "+t.lastLog+" ----\n",e.output+=e.formatSessionDuration(r,i),e.output+="\n\n"}}e.output+="---- Session started: "+e.startTime+" ----\n\n"}},,,,function(e,t,r){var n={"./af":91,"./af.js":91,"./ar":92,"./ar-dz":93,"./ar-dz.js":93,"./ar-kw":94,"./ar-kw.js":94,"./ar-ly":95,"./ar-ly.js":95,"./ar-ma":96,"./ar-ma.js":96,"./ar-sa":97,"./ar-sa.js":97,"./ar-tn":98,"./ar-tn.js":98,"./ar.js":92,"./az":99,"./az.js":99,"./be":100,"./be.js":100,"./bg":101,"./bg.js":101,"./bm":102,"./bm.js":102,"./bn":103,"./bn.js":103,"./bo":104,"./bo.js":104,"./br":105,"./br.js":105,"./bs":106,"./bs.js":106,"./ca":107,"./ca.js":107,"./cs":108,"./cs.js":108,"./cv":109,"./cv.js":109,"./cy":110,"./cy.js":110,"./da":111,"./da.js":111,"./de":112,"./de-at":113,"./de-at.js":113,"./de-ch":114,"./de-ch.js":114,"./de.js":112,"./dv":115,"./dv.js":115,"./el":116,"./el.js":116,"./en-SG":117,"./en-SG.js":117,"./en-au":118,"./en-au.js":118,"./en-ca":119,"./en-ca.js":119,"./en-gb":120,"./en-gb.js":120,"./en-ie":121,"./en-ie.js":121,"./en-il":122,"./en-il.js":122,"./en-nz":123,"./en-nz.js":123,"./eo":124,"./eo.js":124,"./es":125,"./es-do":126,"./es-do.js":126,"./es-us":127,"./es-us.js":127,"./es.js":125,"./et":128,"./et.js":128,"./eu":129,"./eu.js":129,"./fa":130,"./fa.js":130,"./fi":131,"./fi.js":131,"./fo":132,"./fo.js":132,"./fr":133,"./fr-ca":134,"./fr-ca.js":134,"./fr-ch":135,"./fr-ch.js":135,"./fr.js":133,"./fy":136,"./fy.js":136,"./ga":137,"./ga.js":137,"./gd":138,"./gd.js":138,"./gl":139,"./gl.js":139,"./gom-latn":140,"./gom-latn.js":140,"./gu":141,"./gu.js":141,"./he":142,"./he.js":142,"./hi":143,"./hi.js":143,"./hr":144,"./hr.js":144,"./hu":145,"./hu.js":145,"./hy-am":146,"./hy-am.js":146,"./id":147,"./id.js":147,"./is":148,"./is.js":148,"./it":149,"./it-ch":150,"./it-ch.js":150,"./it.js":149,"./ja":151,"./ja.js":151,"./jv":152,"./jv.js":152,"./ka":153,"./ka.js":153,"./kk":154,"./kk.js":154,"./km":155,"./km.js":155,"./kn":156,"./kn.js":156,"./ko":157,"./ko.js":157,"./ku":158,"./ku.js":158,"./ky":159,"./ky.js":159,"./lb":160,"./lb.js":160,"./lo":161,"./lo.js":161,"./lt":162,"./lt.js":162,"./lv":163,"./lv.js":163,"./me":164,"./me.js":164,"./mi":165,"./mi.js":165,"./mk":166,"./mk.js":166,"./ml":167,"./ml.js":167,"./mn":168,"./mn.js":168,"./mr":169,"./mr.js":169,"./ms":170,"./ms-my":171,"./ms-my.js":171,"./ms.js":170,"./mt":172,"./mt.js":172,"./my":173,"./my.js":173,"./nb":174,"./nb.js":174,"./ne":175,"./ne.js":175,"./nl":176,"./nl-be":177,"./nl-be.js":177,"./nl.js":176,"./nn":178,"./nn.js":178,"./pa-in":179,"./pa-in.js":179,"./pl":180,"./pl.js":180,"./pt":181,"./pt-br":182,"./pt-br.js":182,"./pt.js":181,"./ro":183,"./ro.js":183,"./ru":184,"./ru.js":184,"./sd":185,"./sd.js":185,"./se":186,"./se.js":186,"./si":187,"./si.js":187,"./sk":188,"./sk.js":188,"./sl":189,"./sl.js":189,"./sq":190,"./sq.js":190,"./sr":191,"./sr-cyrl":192,"./sr-cyrl.js":192,"./sr.js":191,"./ss":193,"./ss.js":193,"./sv":194,"./sv.js":194,"./sw":195,"./sw.js":195,"./ta":196,"./ta.js":196,"./te":197,"./te.js":197,"./tet":198,"./tet.js":198,"./tg":199,"./tg.js":199,"./th":200,"./th.js":200,"./tl-ph":201,"./tl-ph.js":201,"./tlh":202,"./tlh.js":202,"./tr":203,"./tr.js":203,"./tzl":204,"./tzl.js":204,"./tzm":205,"./tzm-latn":206,"./tzm-latn.js":206,"./tzm.js":205,"./ug-cn":207,"./ug-cn.js":207,"./uk":208,"./uk.js":208,"./ur":209,"./ur.js":209,"./uz":210,"./uz-latn":211,"./uz-latn.js":211,"./uz.js":210,"./vi":212,"./vi.js":212,"./x-pseudo":213,"./x-pseudo.js":213,"./yo":214,"./yo.js":214,"./zh-cn":215,"./zh-cn.js":215,"./zh-hk":216,"./zh-hk.js":216,"./zh-tw":217,"./zh-tw.js":217};function i(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=334}]);
//# sourceMappingURL=xspreadsheet.js.map