!function(e){function t(t){for(var n,o,l=t[0],s=t[1],u=t[2],f=0,h=[];f<l.length;f++)o=l[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);h.length;)h.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,l=1;l<r.length;l++){var s=r[l];0!==i[s]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},i={3:0},a=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=s;a.push([206,2,0]),r()}({11:function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(8);function a(e){return e&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?e.concat(t):r?(e.push(t),e):n?[e].concat(t):[e,t]})):e}function o(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function l(e){if(e instanceof Error)return e;if(e instanceof Array){for(var t=[],r=0;r<e.length;r++){if("string"==typeof e[r][0]&&"default_0"!==e[r][0])return i.name;if("number"==typeof e[r][0]&&t.push(e[r][0]),e[r][0]instanceof Object)return i.name}return t}return"string"==typeof e?"default_0"===e?"pass":i.name:"number"==typeof e?e:void 0}t.flatten=function(){for(var e=t.argsToArray.apply(null,arguments);!o(e);)e=a(e);return e},t.argsToArray=function(e){return Array.prototype.slice.call(e,0)},t.numbers=function(){return possibleNumbers.filter((function(e){return"number"==typeof e}))},t.flattenNum=function(e){try{if(1===e.length&&"default_0"===e[0][0])return i.div0;for(var t=[],r=0;r<e.length;r++){var n=l(e[r]);if(void 0===n)return i.name;if(n instanceof Error)return n;if("pass"!==n)if(n instanceof Array)for(var a=0;a<n.length;a++)t.push(n[a]);else t.push(n)}return t}catch(e){return i.name}},t.cleanFloat=function(e){return Math.round(1e14*e)/1e14},t.parseBool=function(e){if(void 0===e)return!0;if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||i.value},t.parseNumber=function(e){return void 0===e||""===e?i.value:isNaN(e)?i.value:parseFloat(e)},t.parseNumberArray=function(e){var r,n;if(!e||0===(r=e.length))return i.value;for(;r--;){if((n=t.parseNumber(e[r]))===i.value)return n;e[r]=n}return e},t.parseMatrix=function(e){var r;if(!e||0===e.length)return i.value;for(var n=0;n<e.length;n++)if(r=t.parseNumberArray(e[n]),e[n]=r,r instanceof Error)return r;return e};var s=new Date(1900,0,1);function u(e){return isNaN(parseInt(e))?e.replace('"',"").replace('"',""):parseInt(e)}t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?i.num:t<=60?new Date(s.getTime()+864e5*(t-1)):new Date(s.getTime()+864e5*(t-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?i.value:e},t.Copy=function(e){if(null==e||"object"!=n(e))return e;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(var t=[],r=0;r<e.length;++r)t[r]=clone(e[r]);return t}if(e instanceof Object){t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=clone(e[i]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},t.strToMatrix=function(e){for(var t=e.slice(2,e.length-2).split(","),r=[],n=[],i=0;i<t.length;i++){var a=t[i].toString();a.indexOf(";")>0?(n.push(u(a.split(";")[0])),r.push(n),n=[u(a.split(";")[1])]):n.push(u(a))}return r.push(n),r},t.ExcelDateToJSDate=function(e){return"string"==typeof e&&(e=utils.parseDate(issue)),e instanceof Date?e:new Date(Math.round(86400*(e-25569)*1e3))},t.isNumber=function(e){return!(!/^\d+(\.\d+)?$/.test(e)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e))},t.parseDateArray=function(e){for(var t,r=e.length;r--;){if((t=this.parseDate(e[r]))===i.value)return t;e[r]=t}return e},t.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){for(var t,r=e.length;r--;)if("number"!=typeof(t=e[r]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=this.parseNumber(t);n instanceof Error?e[r]=0:e[r]=n}}else e[r]=0;else e[r]=1;return e},t.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},t.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e}},14:function(e,t,r){"use strict";e.exports=function(e){this.setValue=function(t){e=t},this.calc=function(){return e}}},15:function(module,exports,__webpack_require__){var numeric=__webpack_require__(176),utils=__webpack_require__(11),error=__webpack_require__(8),statistical=__webpack_require__(16),information=__webpack_require__(23);exports.ABS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.abs(utils.parseNumber(e))},exports.ACOS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.acos(e)},exports.ACOSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},exports.ACOT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(1/e)},exports.ACOTH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:.5*Math.log((e+1)/(e-1))},exports.AGGREGATE=function(e,t,r,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),"string"==typeof r)return error.value;if(utils.anyIsError(e,t))return error.value;switch(e){case 1:return statistical.AVERAGE(r);case 2:return statistical.COUNT(r);case 3:return statistical.COUNTA(r);case 4:return statistical.MAX(r);case 5:return statistical.MIN(r);case 6:return exports.PRODUCT(r);case 7:return statistical.STDEV.S(r);case 8:return statistical.STDEV.P(r);case 9:return exports.SUM(r);case 10:return statistical.VAR.S(r);case 11:return statistical.VAR.P(r);case 12:return statistical.MEDIAN(r,n);case 13:return statistical.MODE.SNGL(r);case 14:return statistical.LARGE(r,n);case 15:return null==n?error.value:statistical.SMALL(r,n);case 16:return statistical.PERCENTILE.INC(r,n);case 17:return statistical.QUARTILE.INC(r,n);case 18:return statistical.PERCENTILE.EXC(r,n);case 19:return statistical.QUARTILE.EXC(r,n)}},exports.ARABIC=function(e){if(e=e.toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},exports.ASIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.asin(e)},exports.ASINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},exports.ATANH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.BASE=function(e,t,r){if(r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(e,t,r))return error.value;r=void 0===r?0:r;var n=e.toString(t);return new Array(Math.max(r+1-n.length,0)).join("0")+n},exports.CEILING=function(e,t,r){if(t=void 0===t?1:Math.abs(t),r=r||0,e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(e,t,r))return error.value;if(0===t)return 0;var n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,n):0===r?-exports.ROUND(Math.floor(Math.abs(e)/t)*t,n):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,n)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return(e=utils.parseNumber(e))instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){if((e=utils.parseNumber(e))<0)return error.num;if(e instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:(MEMOIZED_FACT[t]=exports.FACT(t-1)*t,MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR={};var ROUND=function(e,t){var r=e,n=t;return Math.round(r*Math.pow(10,n))/Math.pow(10,n)};exports.FLOORMATH=function(e,t,r){if("number"!=typeof e)return error.value;if(e>0&&t<0)return error.num;if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,n):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,n):-ROUND(Math.floor(Math.abs(e)/t)*t,n)},exports.FLOORPRACE=function(e,t,r){if("number"!=typeof e)return error.value;if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,n):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,n):-ROUND(Math.floor(Math.abs(e)/t)*t,n)},exports.FLOOR.MATH=exports.FLOORMATH,exports.FLOOR.PRECISE=exports.FLOORPRACE,exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=e[0],n=r<0?-r:r,i=1;i<t;i++){for(var a=e[i],o=a<0?-a:a;n&&o;)n>o?n%=o:o%=n;n+=o}return n},exports.INT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,r,n,i,a=1;void 0!==(n=e.pop());)for(;n>1;){if(n%2){for(t=3,r=Math.floor(Math.sqrt(n));t<=r&&n%t;t+=2);i=t<=r?t:n}else i=2;for(n/=i,a*=i,t=e.length;t;e[--t]%i==0&&1==(e[t]/=i)&&e.splice(t,1));}return a},exports.LN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(t)&&(t=10),t=void 0===t?10:t,Math.log(e)/Math.log(t)},exports.LOG10=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=function(e){"string"==typeof e&&(e=utils.strToMatrix(e));try{return numeric.det(e)}catch(e){return error.value}},exports.MINVERSE=function(e){return(e=utils.parseMatrix(e))instanceof Error?e:numeric.inv(e)},exports.MMULT=function(e,t){return e=utils.parseMatrix(e),t=utils.parseMatrix(t),utils.anyIsError(e,t)?error.value:(console.log(numeric.dot(e,t)),numeric.dot(e,t))},exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var r=Math.abs(e%t);return t>0?r:-r},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,r=1,n=0;n<e.length;n++)t+=e[n],r*=exports.FACT(e[n]);return exports.FACT(t)/r},exports.MUNIT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:numeric.identity(e)},exports.ODD=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var r=Math.pow(e,t);return isNaN(r)?error.num:r},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,r=0;r<e.length;r++)t*=e[r];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return arguments.length>0&&void 0!==arguments[0]?error.value:Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;for(var t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",i=3;i--;)n=(r[+t.pop()+10*i]||"")+n;return new Array(+t.join("")+1).join("M")+n},exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e<0?(e=0-e,0-Math.round(e*Math.pow(10,t))/Math.pow(10,t)):Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=utils.parseNumber(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,r,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),r=utils.parseNumber(r),n=utils.parseNumberArray(n),utils.anyIsError(e,t,r,n))return error.value;for(var i=n[0]*Math.pow(e,t),a=1;a<n.length;a++)i+=n[a]*Math.pow(e,t+a*r);return i},exports.SIGN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=utils.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=utils.parseNumber(e))instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=function(e,t){if((e=utils.parseNumber(e))instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}},exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.name:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),r=0;r<t.length;++r){var n=arguments[t[r]];if("number"==typeof n)e+=n;else if("string"==typeof n){var i=parseFloat(n);!isNaN(i)&&(e+=i)}else Array.isArray(n)&&(e+=exports.SUM.apply(null,n))}return e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var e=utils.argsToArray(arguments),t=utils.flatten(e.shift());if(t instanceof Error)return t;if(e.length%2!=0)return error.value;for(var r=0;r<e.length;r+=2)if(e[r].length!==t.length||!e[r+1])return error.value;for(var n=[],i=0,a=0;a<e.length;a+=2){for(var o=[],l=0;l<e[a].length;l++){var s=e[a+1]+"";if(0==s.lastIndexOf(">=")?(s=s.replace(/>=/,""),isNaN(s)&&(str=!0),1*s<=e[a][l][0]&&o.push(l)):0==s.lastIndexOf("<=")&&(s=s.replace(/<=/,""),isNaN(s)&&(str=!0),1*s>=e[a][l][0]&&o.push(l)),0==(s=s.replace("=","")).lastIndexOf("<>"))(s=s.replace(/<>/,""))!==e[a][l][0]&&o.push(l);else{var u=!1;if(0==s.lastIndexOf("<"))s=s.replace(/</,""),isNaN(s)&&(u=!0),1*s>e[a][l][0]&&o.push(l);else if(0==s.lastIndexOf(">"))s=s.replace(/>/,""),isNaN(s)&&(u=!0),1*s<e[a][l][0]&&o.push(l);else{if(s.indexOf("*")>0){var c=s;c=c.replace("*",""),"string"==typeof e[a][l][0]&&e[a][l][0].indexOf(c)>=0&&o.push(l)}isNaN(s)?s===e[a][l][0]&&o.push(l):1*s===e[a][l][0]&&o.push(l)}if(u)return error.value}}n.push(o)}for(var f=[],h=0;h<n.length;h++)for(var p=0;p<n[h].length;p++){for(var v=n[h][p],d=1,g=0;3!==d&&g<n.length;g++)g!==h&&-1!=n[g].indexOf(v)?d=2:g!==h&&(d=3);1==d&&n.length>1?d=3:1==d&&1===n.length&&(d=2),2==d&&-1==f.indexOf(v)&&f.push(v)}if(n.length<=0)return error.value;for(var m=0;m<f.length;m++){var y=t[f[m]];if(!y||isNaN(y))return 0;i+=y}return i},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var e,t,r,n,i=arguments.length+1,a=0,o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var l=0;l<arguments[0][o].length;l++){for(e=1,t=1;t<i;t++){if((n=utils.parseNumber(arguments[t-1][o][l]))instanceof Error)return n;e*=n}a+=e}else{for(e=1,t=1;t<i;t++){if((r=utils.parseNumber(arguments[t-1][o]))instanceof Error)return r;e*=r}a+=e}return a},exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,r=e.length,n=0;n<r;n++)t+=information.ISNUMBER(e[n])?e[n]*e[n]:0;return t},exports.SUMX2MY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]-t[n]*t[n];return r},exports.SUMX2PY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]+t[n]*t[n];return r},exports.SUMXMY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var r=0;e=utils.flatten(e),t=utils.flatten(t);for(var n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},exports.TAN=function(e){return(e=utils.parseNumber(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=utils.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},16:function(e,t,r){var n=r(15),i=r(22),a=r(33).jStat,o=r(11),l=r(8),s=r(34),u=r(178);t.AVEDEV=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:a.sum(a(e).subtract(a.mean(e)).abs()[0])/e.length},t.AVERAGE=function(){var e=o.flattenNum(arguments);if(e instanceof Error)return e;if(0===e.length)return l.div0;for(var t=e.length,r=0,n=0,i=0;i<t;i++)r+=e[i],n+=1;return r/n},t.AVERAGEA=function(){var e=o.flattenNum(arguments);if(1==e.length&&isNaN(e[0]))return l.value;for(var t=e.length,r=0,n=0,i=0;i<t;i++){var a=e[i];"number"==typeof a&&(r+=a),!0===a&&r++,null!==a&&n++}return r/n},t.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return l.na;if(r=r||e,e=o.flatten(e),(r=o.parseNumberArray(o.flatten(r)))instanceof Error)return r;for(var n=0,i=0,a=void 0===t||"*"===t,s=a?null:u.parse(t+""),c=t.replace("=","").replace("*","").replace("<>",""),f=0;f<e.length;f++){var h=e[f];if(a)i+=r[f],n++;else{var p=[u.createToken(h,u.TOKEN_TYPE_LITERAL)].concat(s);t.indexOf("<>")>=0?h.indexOf(c)<0&&(i+=r[f],n++):(u.compute(p)||h.toString().indexOf(c)>=0)&&(i+=r[f],n++)}}return 0==n?l.div0:i/n},t.AVERAGEIFS=function(){for(var e=o.argsToArray(arguments),t=(e.length-1)/2,r=o.flatten(e[0]),n=0,i=0,a=0;a<r.length;a++){for(var s=!1,c=0;c<t;c++){var f=e[2*c+1][a],h=e[2*c+2],p=void 0===h||"*"===h,v=!1;if(p)v=!0;else{var d=u.parse(h+""),g=[u.createToken(f,u.TOKEN_TYPE_LITERAL)].concat(d);v=u.compute(g)}if(!v){s=!1;break}s=!0}s&&(i+=r[a],n++)}var m=i/n;return isNaN(m)?l.div0:m},t.BETA={},t.BETA.DIST=function(e,t,r,n,i,s){return arguments.length<4?l.value:(i=void 0===i?0:i,s=void 0===s?1:s,e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),i=o.parseNumber(i),s=o.parseNumber(s),o.anyIsError(e,t,r,i,s)?l.value:(e=(e-i)/(s-i),(n=o.parseBool(n))?a.beta.cdf(e,t,r):a.beta.pdf(e,t,r)/2))},t.BETA.INV=function(e,t,r,n,i){return n=void 0===n?0:n,i=void 0===i?1:i,e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),n=o.parseNumber(n),i=o.parseNumber(i),o.anyIsError(e,t,r,n,i)?l.value:a.beta.inv(e,t,r)*(i-n)+n},t.BINOM={},t.BINOM.DIST=function(e,t,r,n){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),n=o.parseBool(n),n=o.parseNumber(n),o.anyIsError(e,t,r,n)?l.value:n?a.binomial.cdf(e,t,r):a.binomial.pdf(e,t,r)},t.BINOM.INV=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return l.value;for(var n=0;n<=e;){if(a.binomial.cdf(n,e,t)>=r)return n;n++}},t.CHISQ={},t.CHISQ.DIST=function(e,t,r){return r=o.parseBool(r),e<0?l.num:(e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:r?a.chisquare.cdf(e,t):a.chisquare.pdf(e,t))},t.CHISQ.DIST.RT=function(e,t){return!e|!t?l.na:e<1||t>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t?l.value:1-a.chisquare.cdf(e,t)},t.CHISQ.INV=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:a.chisquare.inv(e,t)},t.CHISQ.INV.RT=function(e,t){return!e|!t?l.na:e<0||e>1||t<1||t>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t?l.value:a.chisquare.inv(1-e,t)},t.CHISQ.TEST=function(e,t){if(2!==arguments.length)return l.na;if(!(e instanceof Array&&t instanceof Array))return l.value;if(e.length!==t.length)return l.value;if(e[0]&&t[0]&&e[0].length!==t[0].length)return l.value;var r,n,i,a=e.length;for(n=0;n<a;n++)e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r)),t[n]instanceof Array||(r=t[n],t[n]=[],t[n].push(r));var o=e[0].length,s=1===o?a-1:(a-1)*(o-1),u=0,c=Math.PI;for(n=0;n<a;n++)for(i=0;i<o;i++)u+=Math.pow(e[n][i]-t[n][i],2)/t[n][i];function f(e,t){var r=Math.exp(-.5*e);t%2==1&&(r*=Math.sqrt(2*e/c));for(var n=t;n>=2;)r=r*e/n,n-=2;for(var i=r,a=t;i>1e-10*r;)r+=i=i*e/(a+=2);return 1-r}return Math.round(1e6*f(u,s))/1e6},t.COLUMN=function(){return col_list=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],cell_name=this.args[0].formula.name,cell_name=cell_name.replace(/\d+/g,""),col_list.indexOf(cell_name)+1},t.COLUMNS=function(e){return"string"==typeof e&&(e=o.strToMatrix(e)),e instanceof Array?0===e.length?0:a.cols(e):l.value},t.CONFIDENCE={},t.CONFIDENCE.NORM=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:a.normalci(1,e,t,r)[1]-1},t.CONFIDENCE.T=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:a.tci(1,e,t,r)[1]-1},t.IFS=function(){for(var e=0;e+1<arguments.length;e+=2){var t=arguments[e],r=arguments[e+1];if(t)return r}return l.na},t.CORREL=function(e,t){return e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t)?l.value:a.corrcoeff(e,t)},t.COUNT=function(){return o.numbers(o.flatten(arguments)).length},t.COUNTA=function(){var e=o.flatten(arguments);return e.length-t.COUNTBLANK(e)},t.COUNTIN=function(e,t){for(var r=0,n=0;n<e.length;n++)e[n]===t&&r++;return r},t.COUNTBLANK=function(){for(var e,t=o.flatten(arguments),r=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||r++;return r},t.COUNTIF=function(e,t){if(e=o.flatten(e),void 0===t)return l.value;if(void 0===t||"*"===t)return e.length;for(var r=0,n=u.parse(t+""),i=0;i<e.length;i++){var a=e[i],s=[u.createToken(a,u.TOKEN_TYPE_LITERAL)].concat(n);u.compute(s)&&r++}return r},t.COUNTIFS=function(){for(var e=o.argsToArray(arguments),t=new Array(o.flatten(e[0]).length),r=0;r<t.length;r++)t[r]=!0;for(r=0;r<e.length;r+=2){var n=o.flatten(e[r]),i=e[r+1],a=void 0===i||"*"===i;if(!a)for(var l=u.parse(i+""),s=0;s<n.length;s++){var c=n[s],f=[u.createToken(c,u.TOKEN_TYPE_LITERAL)].concat(l);t[s]=t[s]&&u.compute(f)}}var h=0;for(r=0;r<t.length;r++)t[r]&&h++;return h},t.COUNTUNIQUE=function(){return s.UNIQUE.apply(null,o.flatten(arguments)).length},t.COVARIANCE={},t.COVARIANCE.P=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var r=a.mean(e),n=a.mean(t),i=0,s=e.length,u=0;u<s;u++)i+=(e[u]-r)*(t[u]-n);return i/s},t.COVARIANCE.S=function(e,t){return"string"==typeof e&&(e=o.strToMatrix(e)),"string"==typeof t&&(t=o.strToMatrix(t)),e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t)?l.value:a.covariance(e,t)},t.DEVSQ=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},t.EXPON={},t.EXPON.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:r?a.exponential.cdf(e,t):a.exponential.pdf(e,t)},t.F={},t.F.DIST=function(e,t,r,n){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:(null==n&&(n=!0),"string"==typeof n&&"FALSE"!=n&&"TRUE"!=n?l.value:("FALSE"==n&&(n=!1),n?a.centralF.cdf(e,t,r):a.centralF.pdf(e,t,r)))},t.F.DIST.RT=function(e,t,r){return 3!==arguments.length?l.na:e<0||t<1||r<1?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:1-a.centralF.cdf(e,t,r)},t.F.INV=function(e,t,r){return 3!==arguments.length?l.na:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:a.centralF.inv(1-e,t,r)},t.F.INV.RT=function(e,t,r){return 3!==arguments.length?l.na:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:a.centralF.inv(1-e,t,r)},t.F.TEST=function(e,t){if(!e||!t)return l.na;if(!(e instanceof Array&&t instanceof Array))return l.na;if(e.length<2||t.length<2)return l.div0;var r=function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},i=n.SUM(e)/e.length,a=n.SUM(t)/t.length;return r(e,i)/(e.length-1)/(r(t,a)/(t.length-1))},t.FISHER=function(e){return(e=o.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=o.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},t.FORECAST=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,t,r))return l.value;for(var n=a.mean(r),i=a.mean(t),s=r.length,u=0,c=0,f=0;f<s;f++)u+=(r[f]-n)*(t[f]-i),c+=Math.pow(r[f]-n,2);var h=u/c;return i-h*n+h*e},t.FREQUENCY=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var r=e.length,n=t.length,i=[],a=0;a<=n;a++){i[a]=0;for(var s=0;s<r;s++)0===a?e[s]<=t[0]&&(i[0]+=1):a<n?e[s]>t[a-1]&&e[s]<=t[a]&&(i[a]+=1):a===n&&e[s]>t[n-1]&&(i[n]+=1)}return i},t.GAMMA=function(e){return(e=o.parseNumber(e))instanceof Error?e:0===e?l.num:parseInt(e,10)===e&&e<0?l.num:a.gammafn(e)},t.GAMMA.DIST=function(e,t,r,n){return n=o.parseBool(n),4!==arguments.length?l.na:e<0||t<=0||r<=0?l.value:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:n?a.gamma.cdf(e,t,r,!0):a.gamma.pdf(e,t,r,!1)},t.GAMMA.INV=function(e,t,r){return 3!==arguments.length?l.na:e<0||e>1||t<=0||r<=0?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:a.gamma.inv(e,t,r)},t.GAMMALN=function(e){return(e=o.parseNumber(e))instanceof Error?e:a.gammaln(e)},t.GAMMALN.PRECISE=function(e){return 1!==arguments.length?l.na:e<=0?l.num:"number"!=typeof e?l.value:a.gammaln(e)},t.GAUSS=function(e){return(e=o.parseNumber(e))instanceof Error?e:a.normal.cdf(e,0,1)-.5},t.GEOMEAN=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:a.geomean(e)},t.GROWTH=function(e,t,r,n){if((e=o.parseNumberArray(e))instanceof Error)return e;var i;if(void 0===t)for(t=[],i=1;i<=e.length;i++)t.push(i);if(void 0===r)for(r=[],i=1;i<=e.length;i++)r.push(i);if(t=o.parseNumberArray(t),r=o.parseNumberArray(r),o.anyIsError(t,r))return l.value;void 0===n&&(n=!0);var a,s,u=e.length,c=0,f=0,h=0,p=0;for(i=0;i<u;i++){var v=t[i],d=Math.log(e[i]);c+=v,f+=d,h+=v*d,p+=v*v}c/=u,f/=u,h/=u,p/=u,n?s=f-(a=(h-c*f)/(p-c*c))*c:(a=h/p,s=0);var g=[];for(i=0;i<r.length;i++)g.push(Math.exp(s+a*r[i]));return g},t.HARMEAN=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=0,n=0;n<t;n++)r+=1/e[n];return t/r},t.HYPGEOM={},t.HYPGEOM.DIST=function(e,t,r,i,a){if(a=o.parseBool(a),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),i=o.parseNumber(i),o.anyIsError(e,t,r,i))return l.value;function s(e,t,r,i){return n.COMBIN(r,e)*n.COMBIN(i-r,t-e)/n.COMBIN(i,t)}return a?function(e,t,r,n){for(var i=0,a=0;a<=e;a++)i+=s(a,t,r,n);return i}(e,t,r,i):s(e,t,r,i)},t.INTERCEPT=function(e,r){return e=o.parseNumberArray(e),r=o.parseNumberArray(r),o.anyIsError(e,r)?l.value:e.length!==r.length?l.na:t.FORECAST(0,e,r)},t.KURT=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,4);return r*(r+1)/((r-1)*(r-2)*(r-3))*(n/=Math.pow(a.stdev(e,!0),4))-3*(r-1)*(r-1)/((r-2)*(r-3))},t.LARGE=function(e,t){e=o.flatten(e);for(var r=[],n=0;n<e.length;n++)parseFloat(e[n])&&r.push(parseFloat(e[n]));return e=r,t=o.parseNumber(t),o.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},t.LINEST=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var r=a.mean(e),n=a.mean(t),i=t.length,s=0,u=0,c=0;c<i;c++)s+=(t[c]-n)*(e[c]-r),u+=Math.pow(t[c]-n,2);var f=s/u;return[f,r-f*n]},t.LOGEST=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r))return l.value;for(var n=0;n<e.length;n++)e[n]=Math.log(e[n]);var i=t.LINEST(e,r);return i[0]=Math.round(1e6*Math.exp(i[0]))/1e6,i[1]=Math.round(1e6*Math.exp(i[1]))/1e6,i},t.LOGNORM={},t.LOGNORM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:n?a.lognormal.cdf(e,t,r):a.lognormal.pdf(e,t,r)},t.LOGNORM.INV=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:a.lognormal.inv(e,t,r)},t.MAX=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MAXA=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MEDIAN=function(){for(var e=o.arrayValuesToNumbers(o.flatten(arguments)),t=[],r=0;r<e.length;r++)"number"==typeof e[r]&&t.push(e[r]);var n=o.arrayValuesToNumbers(o.flatten(t));return a.median(n)},t.MIN=function(){var e=o.flatten(arguments);return 0===e.length?0:Math.min.apply(Math,e)},t.MINA=function(){var e=o.arrayValuesToNumbers(o.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.MODE={},t.MODE.MULT=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t,r=e.length,n={},i=[],a=0,l=0;l<r;l++)n[t=e[l]]=n[t]?n[t]+1:1,n[t]>a&&(a=n[t],i=[]),n[t]===a&&(i[i.length]=t);return i},t.MODE.SNGL=function(){var e=o.parseNumberArray(o.flatten(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.NEGBINOM={},t.NEGBINOM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:n?a.negbin.cdf(e,t,r):a.negbin.pdf(e,t,r)},t.NORM={},t.NORM.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:r<=0?l.num:n?a.normal.cdf(e,t,r):a.normal.pdf(e,t,r)},t.NORM.INV=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:a.normal.inv(e,t,r)},t.NORM.S={},t.NORM.S.DIST=function(e,t){return t=o.parseBool(t),(e=o.parseNumber(e))instanceof Error?l.value:t?a.normal.cdf(e,0,1):a.normal.pdf(e,0,1)},t.NORM.S.INV=function(e){return(e=o.parseNumber(e))instanceof Error?l.value:a.normal.inv(e,0,1)},t.PEARSON=function(e,t){if(t=o.parseNumberArray(o.flatten(t)),e=o.parseNumberArray(o.flatten(e)),o.anyIsError(t,e))return l.value;for(var r=a.mean(e),n=a.mean(t),i=e.length,s=0,u=0,c=0,f=0;f<i;f++)s+=(e[f]-r)*(t[f]-n),u+=Math.pow(e[f]-r,2),c+=Math.pow(t[f]-n,2);return s/Math.sqrt(u*c)},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return l.value;var r=(e=e.sort((function(e,t){return e-t}))).length;if(t<1/(r+1)||t>1-1/(r+1))return l.num;var n=t*(r+1)-1,i=Math.floor(n);return o.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},t.PERCENTILE.INC=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return l.value;var r=t*((e=e.sort((function(e,t){return e-t}))).length-1),n=Math.floor(r);return o.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,r){if(r=void 0===r?3:r,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return l.value;e=e.sort((function(e,t){return e-t}));for(var n=s.UNIQUE.apply(null,e),i=e.length,a=n.length,u=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<a;)t===n[h]?(c=(e.indexOf(n[h])+1)/(i+1),f=!0):t>=n[h]&&(t<n[h+1]||h===a-1)&&(c=(e.indexOf(n[h])+1+(t-n[h])/(n[h+1]-n[h]))/(i+1),f=!0),h++;return Math.floor(c*u)/u},t.PERCENTRANK.INC=function(e,t,r){if(r=void 0===r?3:r,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r))return l.value;e=e.sort((function(e,t){return e-t}));for(var n=s.UNIQUE.apply(null,e),i=e.length,a=n.length,u=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<a;)t===n[h]?(c=e.indexOf(n[h])/(i-1),f=!0):t>=n[h]&&(t<n[h+1]||h===a-1)&&(c=(e.indexOf(n[h])+(t-n[h])/(n[h+1]-n[h]))/(i-1),f=!0),h++;return Math.floor(c*u)/u},t.PERMUT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:n.FACT(e)/n.FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:Math.pow(e,t)},t.PHI=function(e){return(e=o.parseNumber(e))instanceof Error?l.value:Math.exp(-.5*e*e)/2.5066282746310002},t.POISSON={},t.POISSON.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:r?a.poisson.cdf(e,t):a.poisson.pdf(e,t)},t.PROB=function(e,t,r,n){if(void 0===r)return 0;if(n=void 0===n?r:n,e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),r=o.parseNumber(r),n=o.parseNumber(n),o.anyIsError(e,t,r,n))return l.value;if(r===n)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;for(var i=e.sort((function(e,t){return e-t})),a=i.length,s=0,u=0;u<a;u++)i[u]>=r&&i[u]<=n&&(s+=t[e.indexOf(i[u])]);return s},t.QUARTILE={},t.QUARTILE.EXC=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return l.value;switch(r){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return l.num}},t.QUARTILE.INC=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return l.value;switch(r){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return l.num}},t.RANK={},t.RANK.AVG=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e},i=(t=(t=o.flatten(t)).sort(n)).length,a=0,s=0;s<i;s++)t[s]===e&&a++;return a>1?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e};return(t=t.sort(n)).indexOf(e)+1},t.ROW=function(e,t){return 2!==arguments.length?l.na:t<0?l.num:e instanceof Array&&"number"==typeof t?0!==e.length?a.row(e,t):void 0:l.value},t.ROWS=function(e){return 1!==arguments.length?l.na:e instanceof Array?0===e.length?0:a.rows(e):l.value},t.RSQ=function(e,r){return e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r)?l.value:Math.pow(t.PEARSON(e,r),2)},t.SKEW=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,3);return r*n/((r-1)*(r-2)*Math.pow(a.stdev(e,!0),3))},t.SKEW.P=function(){var e=o.parseNumberArray(o.flatten(arguments));if(e instanceof Error)return e;for(var t=a.mean(e),r=e.length,n=0,i=0,l=0;l<r;l++)i+=Math.pow(e[l]-t,3),n+=Math.pow(e[l]-t,2);return n/=r,(i/=r)/Math.pow(n,1.5)},t.SLOPE=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var r=a.mean(t),n=a.mean(e),i=t.length,s=0,u=0,c=0;c<i;c++)s+=(t[c]-r)*(e[c]-n),u+=Math.pow(t[c]-r,2);return s/u},t.SMALL=function(e,t){return e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:(e-t)/r},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments);return Math.sqrt(e)},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments);return Math.sqrt(e)},t.STDEVA=function(){var e=t.VARA.apply(this,arguments);return Math.sqrt(e)},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments);return Math.sqrt(e)},t.STEYX=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumberArray(o.flatten(t)),o.anyIsError(e,t))return l.value;for(var r=a.mean(t),n=a.mean(e),i=t.length,s=0,u=0,c=0,f=0;f<i;f++)s+=Math.pow(e[f]-n,2),u+=(t[f]-r)*(e[f]-n),c+=Math.pow(t[f]-r,2);return Math.sqrt((s-u*u/c)/(i-2))},t.TRANSPOSE=function(e){return e?a.transpose(e):l.na},t.T=i.T,t.T.DIST=function(e,t,r){return r=o.parseBool(r),e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?l.value:r?a.studentt.cdf(e,t):a.studentt.pdf(e,t)},t.T.DIST["2T"]=function(e,t){return 2!==arguments.length?l.na:e<0||t<1?l.num:"number"!=typeof e||"number"!=typeof t?l.value:2*(1-a.studentt.cdf(e,t))},t.T.DIST.RT=function(e,t){return 2!==arguments.length?l.na:e<0||t<1?l.num:"number"!=typeof e||"number"!=typeof t?l.value:1-a.studentt.cdf(e,t)},t.T.INV=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),e<=0||e>1||t<1?l.num:o.anyIsError(e,t)?l.value:Math.abs(a.studentt.inv(e/2,t))},t.T.INV["2T"]=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),e<=0||e>1||t<1?l.num:o.anyIsError(e,t)?l.value:Math.abs(a.studentt.inv(e/2,t))},t.T.TEST=function(e,r){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r)),o.anyIsError(e,r))return l.value;var n,i=a.mean(e),s=a.mean(r),u=0,c=0;for(n=0;n<e.length;n++)u+=Math.pow(e[n]-i,2);for(n=0;n<r.length;n++)c+=Math.pow(r[n]-s,2);u/=e.length-1,c/=r.length-1;var f=Math.abs(i-s)/Math.sqrt(u/e.length+c/r.length);return t.T.DIST["2T"](f,e.length+r.length-2)},t.TREND=function(e,r,n){e=o.parseNumberArray(o.flatten(e)),r=o.parseNumberArray(o.flatten(r));var i=t.LINEST(e,r);return i[0]*n+i[1]},t.TRIMMEAN=function(e,t){if(e=o.parseNumberArray(o.flatten(e)),t=o.parseNumber(t),o.anyIsError(e,t))return l.value;var r=n.FLOORMATH(e.length*t,2)/2;return a.mean(o.initial(o.rest(e.sort((function(e,t){return e-t})),r),r))},t.VAR={},t.VAR.P=function(){var e=o.numbers(o.flatten(arguments));if(0==e.length)return l.value;for(var r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return isNaN(n/r)?l.value:n/r},t.VAR.S=function(){for(var e=o.numbers(o.flatten(arguments)),r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return n/(r-1)},t.VARA=function(){for(var e=o.flatten(arguments),r=e.length,n=0,i=0,a=t.AVERAGEA(e),l=0;l<r;l++){var s=e[l];n+="number"==typeof s?Math.pow(s-a,2):!0===s?Math.pow(1-a,2):Math.pow(0-a,2),null!==s&&i++}return n/(i-1)},t.VARPA=function(){for(var e=o.flatten(arguments),r=e.length,n=0,i=0,a=t.AVERAGEA(e),l=0;l<r;l++){var s=e[l];n+="number"==typeof s?Math.pow(s-a,2):!0===s?Math.pow(1-a,2):Math.pow(0-a,2),null!==s&&i++}return n/i},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,r,n){return n=o.parseBool(n),e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?l.value:n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},t.Z={},t.Z.TEST=function(e,r,n){if(e=o.parseNumberArray(o.flatten(e)),r=o.parseNumber(r),o.anyIsError(e,r))return l.value;n=n||t.STDEV.S(e);var i=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-r)/(n/Math.sqrt(i)),!0)}},170:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(171),a={},o={};function l(e,t){for(var r in e)o[r]=e[r]}function s(e,t){var r=(t=t||{}).prefix||"";for(var i in e){var o=e[i];"function"==typeof o?!t.override&&a[r+i]||(a[r+i]=o):"object"===n(o)&&s(o,u(t,{prefix:i+"."}))}}function u(e,t){var r=JSON.parse(JSON.stringify(e));for(var n in t)r[n]=t[n];return r}function c(e){return i(e,{xlsx_Fx:a,xlsx_raw_Fx:o})}function f(e){c(e).update_cell_value()}s(r(31)),l(r(185)),f.set_fx=function(e,t){a[e]=t},f.exec_fx=function(e,t){return a[e].apply(this,t)},f.localizeFunctions=function(e){for(var t in e){var r=e[t];a[r]&&(a[t]=a[r]),o[r]&&(o[t]=o[r])}},f.import_functions=s,f.import_raw_functions=l,f.build_expression=c,f.xlsx_Fx=a,e.exports=f},171:function(e,t,r){var n=r(172),i=r(14),a=r(173),o=r(174),l={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};e.exports=function(e,t){e.status="working";var r,s=t.xlsx_Fx||{},u=t.xlsx_raw_Fx||{},c=e.cell.f;"="==c[0]&&(c=c.substr(1));var f=r=new n(e),h="",p=!1,v=[{exp:f}];function d(e){'"'===e?(f.push(new i(h)),p=!0,h="",y=m):h+=e}function g(e){"'"===e&&(y=m),h+=e}function m(t){var r,i,c;'"'===t?(y=d,h=""):"'"===t?(y=g,h="'"):"("===t?function(){var t,r=h.trim(),i=s[r],l=u[r];if(l)i=new o(l,e);else if(i)i=new a(i,e);else if(r)throw new Error('"'+e.sheet_name+'"!'+e.name+": Function "+h+" not found");t=new n(e),v.push({exp:t,special:i}),f=t,h=""}():")"===t?(c=v.pop(),(f=c.exp).push(h,b),i=f,h="",f=v[v.length-1].exp,c.special?(c.special.push(i),f.push(c.special,b)):f.push(i,b)):l[t]?(r=t,p||f.push(h,b),p=!1,f.push(r,b),h=""):","===t&&v[v.length-1].special?(p=!1,v[v.length-1].exp.push(h,b),v[v.length-1].special.push(v[v.length-1].exp),v[v.length-1].exp=f=new n(e),h=""):h+=t}for(var y=m,b=0;b<c.length;b++)y(c[b]);return r.push(h,b),r}},172:function(e,t,r){"use strict";var n=r(14),i=r(21),a=r(29),o=r(8),l=864e5,s=0;e.exports=function(e){var t,r=this;function u(e){return null==e||""===e}function c(e){return"function"!=typeof e.calc?0:1}function f(e,t,r){for(var i=0;i<t.length;i++)if(t[i]===e)try{if(0===i&&"+"===e){if(!c(t[i+1]))break;var a=t[i+1].calc();t.splice(i,2,new n(a))}else{var o=c(t[i-1]);if(!o)break;if(!(o=c(t[i+1])))break;var l=r(t[i-1].calc(),t[i+1].calc());t.splice(i-1,3,new n(l)),i--}}catch(e){throw e}}r.id=++s,r.args=[],r.name="Expression",r.update_cell_value=function(){try{if(Array.isArray(r.args)&&1===r.args.length&&r.args[0]instanceof i)throw o.value;e.cell.v=r.calc(),"string"==typeof e.cell.v?e.cell.t="s":"number"==typeof e.cell.v&&(e.cell.t="n")}catch(r){var t={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};if(void 0===t[r.message])throw r;e.cell.t="e",e.cell.w=r.message,e.cell.v=t[r.message]}finally{e.status="done"}},r.formula=e,r.calc=function(){var e=r.args.concat();try{for(var t=0;t<e.length;t++){if("RefValue"==e[t].name)if(void 0===(i=e[t].formula.sheet)[e[t].str_expression]&&(e[t].formula.sheet[e[t].str_expression]={v:"default_0"}),"0"==e[t].str_expression.slice(1,e[t].str_expression.length))return o.name}}catch(e){}try{if("RefValue"==e[0].name&&"-"==e[1]&&"RefValue"==e[2].name){var i,a=(i=e[0].formula.sheet)[e[0].str_expression].v,s=i[e[2].str_expression].v;a=a.replace("年","-").replace("月","-").replace("日",""),s=s.replace("年","-").replace("月","-").replace("日","");return datedifference(a,s)}}catch(e){}if(function(e){for(var t=e.length;t--;)if("-"===e[t]){c(e[t+1]);var r=e[t+1].calc();if(t>0&&"string"!=typeof e[t-1]){if(e.splice(t,1,"+"),r instanceof Date){r=Date.parse(r),c(e[t-1]);var i=e[t-1].calc();i instanceof Date&&(i=Date.parse(i)/l,r/=l,e.splice(t-1,1,new n(i)))}e.splice(t+1,1,new n(-r))}else e.splice(t,2,new n(-r))}}(e),f("^",e,(function(e,t){return Math.pow(+e,+t)})),f("/",e,(function(e,t){if(0==t)throw o.div0;return+e/+t})),f("*",e,(function(e,t){return+e*+t})),f("+",e,(function(e,t){return e instanceof Date&&"number"==typeof t&&(t*=l),+e+ +t})),f("&",e,(function(e,t){return""+e+t})),f("<",e,(function(e,t){return e<t})),f(">",e,(function(e,t){return e>t})),f(">=",e,(function(e,t){return e>=t})),f("<=",e,(function(e,t){return e<=t})),f("<>",e,(function(e,t){return e instanceof Date&&t instanceof Date?e.getTime()!==t.getTime():(!u(e)||!u(t))&&e!=t})),f("=",e,(function(e,t){return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!(!u(e)||!u(t))||(null==e&&0===t||0===e&&null==t||("string"==typeof e&&"string"==typeof t&&e.toLowerCase()===t.toLowerCase()||e==t))})),1==e.length)return"function"!=typeof e[0].calc?e[0]:e[0].calc()},r.push=function(n,i){if(n){var o=a(n,e,i);"="===o&&(">"==t||"<"==t)||"<"==t&&">"===o?r.args[r.args.length-1]+=o:r.args.push(o),t=o}}}},173:function(e,t,r){"use strict";e.exports=function(e){var t=this;t.name="UserFn",t.args=[],t.calc=function(){var r,n={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};try{r=e.apply(t,t.args.map((function(e){return e.calc()})))}catch(t){if("is_blank"===e.name&&void 0!==n[t.message])r=0;else{if("iserror"!==e.name||void 0===n[t.message])throw t;r=!0}}return r},t.push=function(e){t.args.push(e)}}},174:function(e,t,r){"use strict";e.exports=function(e){var t=this;t.name="UserRawFn",t.args=[],t.calc=function(){return e.apply(t,t.args)},t.push=function(e){t.args.push(e)}}},175:function(e,t,r){var n=r(15),i=r(16),a=r(35),o=r(24);function l(e,t){if(t)for(var r in t)e[r]=t[r];return e}t.BETADIST=i.BETA.DIST,t.BETAINV=i.BETA.INV,t.BINOMDIST=i.BINOM.DIST,t.CEILING=t.ISOCEILING=l(n.CEILING.MATH,n.CEILING),t.CEILINGMATH=n.CEILING.MATH,t.CEILINGPRECISE=n.CEILING.PRECISE,t.CHIDIST=i.CHISQ.DIST,t.CHIDISTRT=i.CHISQ.DIST.RT,t.CHIINV=i.CHISQ.INV,t.CHIINVRT=i.CHISQ.INV.RT,t.CHITEST=i.CHISQ.TEST,t.CONFIDENCE=l(i.CONFIDENCE.NORM,i.CONFIDENCE),t.COVAR=i.COVARIANCE.P,t.COVARIANCEP=i.COVARIANCE.P,t.COVARIANCES=i.COVARIANCE.S,t.CRITBINOM=i.BINOM.INV,t.EXPONDIST=i.EXPON.DIST,t.ERFCPRECISE=a.ERFC.PRECISE,t.ERFPRECISE=a.ERF.PRECISE,t.FDIST=i.F.DIST,t.FDISTRT=i.F.DIST.RT,t.FINVRT=i.F.INV.RT,t.FINV=i.F.INV,t.FLOORMATH=n.FLOORMATH,t.FLOORPRECISE=n.FLOORPRACE,t.FTEST=i.F.TEST,t.GAMMADIST=i.GAMMA.DIST,t.GAMMAINV=i.GAMMA.INV,t.GAMMALNPRECISE=i.GAMMALN.PRECISE,t.HYPGEOMDIST=i.HYPGEOM.DIST,t.LOGINV=i.LOGNORM.INV,t.LOGNORMINV=i.LOGNORM.INV,t.LOGNORMDIST=i.LOGNORM.DIST,t.MODE=l(i.MODE.SNGL,i.MODE),t.MODEMULT=i.MODE.MULT,t.MODESNGL=i.MODE.SNGL,t.NEGBINOMDIST=i.NEGBINOM.DIST,t.NETWORKDAYSINTL=o.NETWORKDAYSINTL,t.NORMDIST=i.NORM.DIST,t.NORMINV=i.NORM.INV,t.NORMSDIST=i.NORM.S.DIST,t.NORMSINV=i.NORM.S.INV,t.PERCENTILE=l(i.PERCENTILE.EXC,i.PERCENTILE),t.PERCENTILEEXC=i.PERCENTILE.EXC,t.PERCENTILEINC=i.PERCENTILE.INC,t.PERCENTRANK=l(i.PERCENTRANK.INC,i.PERCENTRANK),t.PERCENTRANKEXC=i.PERCENTRANK.EXC,t.PERCENTRANKINC=i.PERCENTRANK.INC,t.POISSON=l(i.POISSON.DIST,i.POISSON),t.POISSONDIST=i.POISSON.DIST,t.QUARTILE=l(i.QUARTILE.INC,i.QUARTILE),t.QUARTILEEXC=i.QUARTILE.EXC,t.QUARTILEINC=i.QUARTILE.INC,t.RANK=l(i.RANK.EQ,i.RANK),t.RANKAVG=i.RANK.AVG,t.RANKEQ=i.RANK.EQ,t.SKEWP=i.SKEW.P,t.STDEV=l(i.STDEV.S,i.STDEV),t.STDEVP=i.STDEV.P,t.STDEVS=i.STDEV.S,t.TDIST=i.T.DIST,t.TDISTRT=i.T.DIST.RT,t.TINV=i.T.INV,t.TTEST=i.T.TEST,t.VARP=i.VAR.P,t.VARS=i.VAR.S,t.WEIBULL=l(i.WEIBULL.DIST,i.WEIBULL),t.WEIBULLDIST=i.WEIBULL.DIST,t.WORKDAYINTL=o.WORKDAYINTL,t.ZTEST=i.Z.TEST,t._XLFN=l(n.FLOOR.MATH,i.COVARIANCE.P,i.NORM.INV,i.VAR.P)},178:function(e,t){var r="=",n=[">",">=","<","<=","=","<>"],i="operator",a="literal",o=[i,a];function l(e,t){if(-1===o.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function s(e){for(var t,o="",s=[],u=0;u<e.length;u++){var c=e[u];0===u&&n.indexOf(c)>=0?s.push(l(c,i)):o+=c}return o.length>0&&s.push(l("string"!=typeof(t=o)?t:(/^\d+(\.\d+)?$/.test(t)&&(t=-1===t.indexOf(".")?parseInt(t,10):parseFloat(t)),t),a)),s.length>0&&s[0].type!==i&&s.unshift(l(r,i)),s}t.TOKEN_TYPE_OPERATOR=i,t.TOKEN_TYPE_LITERAL=a,t.parse=function(e){return s(function(e){for(var t=e.length,r=[],n=0,i="",a="";n<t;){var o=e.charAt(n);switch(o){case">":case"<":case"=":a+=o,i.length>0&&(r.push(i),i="");break;default:a.length>0&&(r.push(a),a=""),i+=o}n++}return i.length>0&&r.push(i),a.length>0&&r.push(a),r}(e))},t.createToken=l,t.compute=function(e){for(var t,r=[],n=0;n<e.length;n++){var o=e[n];switch(o.type){case i:t=o.value;break;case a:r.push(o.value)}}return function(e,t){var r=!1;switch(t){case">":r=e[0]>e[1];break;case">=":r=e[0]>=e[1];break;case"<":r=e[0]<e[1];break;case"<=":r=e[0]<=e[1];break;case"=":r=e[0]==e[1];break;case"<>":r=e[0]!=e[1]}return r}(r,t)}},18:function(e,t,r){"use strict";var n=r(19),i=r(20),a=r(170),o=r(36),l=r(186),s=r(187),u=r(37),c=r(3),f=r(188),h=function(e,t){if(c.isHave(t)){var r=new f(e,t),n=e.workbook;n=r.get_workbook(n);for(var i=o(n,t,a),l=i.length-1;l>=0;l--)try{var h=new s(i[l],e),p=h.check_valid();!0!==p?i[l].cell.v=p:(i[l].cell.f=h.trans_formula(),u.trans_sheet(i[l].sheet),a(i[l]),i[l].cell.f=h.recover_formula(),u.recover_sheet(i[l].sheet)),(r.is_muti_cell(i[l])||Array.isArray(i[l].cell.v))&&r.deal_muti_cell(n,i[l])}catch(e){console.log(e)}r.calcDoneToSetCells(n,e)}};h.calculator=function(e){return new l(e,a)},h.set_fx=a.set_fx,h.exec_fx=a.exec_fx,h.col_str_2_int=i,h.int_2_col_str=n,h.import_functions=a.import_functions,h.import_raw_functions=a.import_raw_functions,h.xlsx_Fx=a.xlsx_Fx,h.localizeFunctions=a.localizeFunctions,h.XLSX_CALC=h,e.exports=h},180:function(module,exports,__webpack_require__){var error=__webpack_require__(8),stats=__webpack_require__(16),maths=__webpack_require__(15),utils=__webpack_require__(11);function compact(e){if(!e)return e;for(var t=[],r=0;r<e.length;++r)e[r]&&t.push(e[r]);return t}function find_result_idx(database,criteria){for(var valid_arr=[],filter_arr=[],i=0;i<criteria[0].length;i++)filter_arr.push(criteria[0][i]);for(var i=1;i<criteria.length;i++){for(var arr=criteria[i],valid_str=[],j=0;j<filter_arr.length;j++)null!=arr[j]&&valid_str.push(database[0].indexOf(criteria[0][j])+"-"+arr[j]);valid_arr.push(valid_str)}for(var result_idx=[],i=1;i<database.length;i++)for(var data=database[i],j=0;j<valid_arr.length;j++){for(var is_valid=!0,k=0;k<valid_arr[j].length;k++){var a=data[parseInt(valid_arr[j][k].split("-")[0])],b=valid_arr[j][k].split("-")[1];b.indexOf("=")>=0?is_valid=a==b.replace("=",""):eval(a+b)||(is_valid=!1)}is_valid&&result_idx.push(i)}return result_idx}function get_values(e,t,r){if("number"==typeof r)var n=r-1;else n=t[0].indexOf(r);for(var i=[],a=0;a<e.length;a++)i.push(t[e[a]][n]);return i}exports.FINDFIELD=function(e,t){for(var r=null,n=0;n<e.length;n++)if(e[n][0]===t){r=n;break}return null==r?error.value:r},exports.DAVERAGE=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;if("number"==typeof t)for(var n=[],i=1;i<e.length;i++)n.push(i);else n=find_result_idx(e,r);var a=get_values(n,e,t),o=0;for(i=0;i<a.length;i++)o+=a[i];return 0===n.length?error.div0:o/a.length},exports.DCOUNT=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.COUNT(n)},exports.DCOUNTA=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.COUNTA(n)},exports.DGET=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=find_result_idx(e,r);return n.length>1?error.num:get_values(n,e,t)[0]},exports.DMAX=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]>i&&(i=n[a]);return i},exports.DMIN=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]<i&&(i=n[a]);return i},exports.DPRODUCT=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;for(var n=get_values(find_result_idx(e,r),e,t),i=1,a=0;a<n.length;a++)i*=n[a];return i},exports.DSTDEV=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.S(n)},exports.DSTDEVP=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.P(n)},exports.DSUM=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return maths.SUM(n)},exports.DVAR=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.S(n)},exports.DVARP=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return error.value;var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.P(n)}},181:function(e,t,r){var n=r(8),i=r(11),a=r(23);t.AND=function(){for(var e=i.flatten(arguments),t=!0,r=0;r<e.length;r++)e[r]||(t=!1);return t},t.CHOOSE=function(){if(arguments.length<2)return n.na;var e=arguments[0];return e<1||e>254?n.value:arguments.length<e+1?n.value:arguments[e]},t.FALSE=function(){return!1},t.IF=function(e,t,r){return e?t:r},t.IFERROR=function(e,t){return a.ISERROR(e)?t:e},t.IFNA=function(e,t){return e===n.na?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=i.flatten(arguments),t=!1,r=0;r<e.length;r++)e[r]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=i.flatten(arguments),t=0,r=0;r<e.length;r++)e[r]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],r=arguments.length-1,i=Math.floor(r/2),a=!1,o=r%2==0?null:arguments[arguments.length-1];if(i)for(var l=0;l<i;l++)if(t===arguments[2*l+1]){e=arguments[2*l+2],a=!0;break}!a&&o&&(e=o)}return null==e?n.na:e}},182:function(e,t,r){var n=r(8),i=r(24),a=r(11);function o(e){return e&&e.getTime&&!isNaN(e.getTime())}t.ACCRINT=function(e,t,r,l,s,u,c){"string"==typeof e&&(e=a.parseDate(e));try{e=a.ExcelDateToJSDate(e),t=a.ExcelDateToJSDate(t),r=a.ExcelDateToJSDate(r)}catch(e){return n.value}return o(e)&&o(t)&&o(r)?l<=0||s<=0?n.num:-1===[1,2,4].indexOf(u)?n.num:-1===[0,1,2,3,4].indexOf(c)?n.num:r<=e?n.num:(c=c||0,(s=s||0)*l*i.YEARFRAC(e,r,c)):n.value},t.ACCRINTM=function(e,t,r,o,l){try{e=a.ExcelDateToJSDate(e),t=a.ExcelDateToJSDate(t)}catch(e){return n.value}if(r<=0||o<=0)return n.num;if(l<0||l>4)return n.num;if(t<=e)return n.num;l=l||0;var s=(o=o||0)*r*i.YEARFRAC(e,t,l);return isNaN(s)?n.value:s},t.AMORDEGRC=function(e,t,r,i,a,l,s){return o(issue)&&o(settlement)?l<=0||par<=0?n.num:s<0||s>4?n.num:settlement<=issue?n.num:void 0:n.value},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.COUPDAYBS=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:e>=t?n.num:void 0:n.value},t.COUPDAYS=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPDAYSNC=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPNCD=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.numerror.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPNUM=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.COUPPCD=function(e,t,r,i){return o(t)&&o(e)?i<0||i>4?n.num:1!=r&&2!=r&&4!=r?n.num:void 0:n.value},t.CUMIPMT=function(e,r,i,o,l,s){if(e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;if(e<=0||r<=0||i<=0)return n.num;if(o<1||l<1||o>l)return n.num;if(0!==s&&1!==s)return n.num;var u=t.PMT(e,r,i,0,s),c=0;1===o&&0===s&&(c=-i,o++);for(var f=o;f<=l;f++)c+=1===s?t.FV(e,f-2,u,i,1)-u:t.FV(e,f-1,u,i,0);return c*=e},t.CUMPRINC=function(e,r,i,o,l,s){if(e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;if(e<=0||r<=0||i<=0)return n.num;if(o<1||l<1||o>l)return n.num;if(0!==s&&1!==s)return n.num;var u=t.PMT(e,r,i,0,s),c=0;1===o&&(c=0===s?u+i*e:u,o++);for(var f=o;f<=l;f++)c+=s>0?u-(t.FV(e,f-2,u,i,1)-u)*e:u-t.FV(e,f-1,u,i,0)*e;return c},t.DB=function(e,t,r,i,o){if(o=void 0===o?12:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;if(e<0||t<0||r<0||i<0)return n.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return n.num;if(i>r)return n.num;if(t>=e)return 0;for(var l=(1-Math.pow(t/e,1/r)).toFixed(3),s=e*l*o/12,u=s,c=0,f=i===r?r-1:i,h=2;h<=f;h++)u+=c=(e-u)*l;return 1===i?s:i===r?(e-u)*l:c},t.DDB=function(e,t,r,i,o){if(o=void 0===o?2:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;if(e<0||t<0||r<0||i<0||o<=0)return n.num;if(i>r)return n.num;if(t>=e)return 0;for(var l=0,s=0,u=1;u<=i;u++)l+=s=Math.min(o/r*(e-l),e-t-l);return s},t.DISC=function(e,t,r,a,o){if(r<=0||a<=0)return n.num;if(o<0||o>4)return n.num;if(e>=t)return n.num;return(a-r)/r*360/Math.abs(i.DAYS(t,e,!1))},t.DOLLARDE=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var i=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*i)/i},t.DOLLARFR=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.DURATION=function(e,t,r,i,l,s){return e=a.parseDate(e),o(t=a.parseDate(t))&&o(e)?s<0||s>4?n.num:e>=t?n.num:void 0:n.value},t.EFFECT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.FV=function(e,t,r,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var l;if(0===e)l=i+r*t;else{var s=Math.pow(1+e,t);l=1===o?i*s+r*(1+e)*(s-1)/e:i*s+r*(s-1)/e}return-l},t.FVSCHEDULE=function(e,t){if(e=a.parseNumber(e),"string"==typeof t&&(t=a.strToMatrix(t)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return n.value;for(var r=t.length,i=e,o=0;o<r;o++)i*=1+t[o];return i},t.INTRATE=function(e,t,r,i,a){if(r<=0||i<=0)return n.value;if(a<0||a>4)return n.num;if(e>=t)return n.num;return(i-r)/r*.5},t.IPMT=function(e,r,i,o,l,s){if(l=l||0,s=s||0,e=a.parseNumber(e),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),l=a.parseNumber(l),s=a.parseNumber(s),a.anyIsError(e,r,i,o,l,s))return n.value;var u=t.PMT(e,i,o,l,s);return(1===r?1===s?0:-o:1===s?t.FV(e,r-2,u,o,1)-u:t.FV(e,r-1,u,o,0))*e},t.IRR=function(e,t){if(t=t||0,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return n.value;for(var r=function(e,t,r){for(var n=r+1,i=e[0],a=1;a<e.length;a++)i+=e[a]/Math.pow(n,(t[a]-t[0])/365);return i},i=function(e,t,r){for(var n=r+1,i=0,a=1;a<e.length;a++){var o=(t[a]-t[0])/365;i-=o*e[a]/Math.pow(n,o+1)}return i},o=[],l=!1,s=!1,u=0;u<e.length;u++)o[u]=0===u?0:o[u-1]+365,e[u]>0&&(l=!0),e[u]<0&&(s=!0);if(!l||!s)return n.num;var c,f,h,p=t=void 0===t?.1:t,v=!0;do{c=p-(h=r(e,o,p))/i(e,o,p),f=Math.abs(c-p),p=c,v=f>1e-10&&Math.abs(h)>1e-10}while(v);return p},t.ISPMT=function(e,t,r,i){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,t,r,i)?n.value:i*e*(t/r-1)},t.MDURATION=function(e,t,r,i,a,o){return r<0||i<0?n.num:o<0||o>4?n.num:-1===[1,2,4].indexOf(a)?n.num:void 0},t.MIRR=function(e,r,i){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,r,i))return n.value;for(var o=e.length,l=[],s=[],u=0;u<o;u++)e[u]<0?l.push(e[u]):s.push(e[u]);var c=-t.NPV(i,s)*Math.pow(1+i,o-1),f=t.NPV(r,l)*(1+r);return Math.pow(c/f,1/(o-1))-1},t.NOMINAL=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,r,i,o){if(o=void 0===o?0:o,i=void 0===i?0:i,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var l=t*(1+e*o)-i*e,s=r*e+t*(1+e*o);return Math.log(l/s)/Math.log(1+e)},t.NPV=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],r=0,n=1;n<e.length;n++)r+=e[n]/Math.pow(1+t,n);return r},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:e<=0?n.num:(Math.log(r)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,r,i,o){if(i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o))return n.value;var l;if(0===e)l=(r+i)/t;else{var s=Math.pow(1+e,t);l=1===o?(i*e/(s-1)+r*e/(1-1/s))/(1+e):i*e/(s-1)+r*e/(1-1/s)}return-l},t.PPMT=function(e,r,i,o,l,s){return l=l||0,s=s||0,e=a.parseNumber(e),i=a.parseNumber(i),o=a.parseNumber(o),l=a.parseNumber(l),s=a.parseNumber(s),a.anyIsError(e,i,o,l,s)?n.value:t.PMT(e,i,o,l,s)-t.IPMT(e,r,i,o,l,s)},t.PRICE=function(e,t,r,o,l,s,u){if(e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t))return n.value;if(u<0||u>4)return n.na;if(e>=t)return n.na;var c=Math.abs(i.DAYS(e,t,!1));return l-discount*l*c/360},t.PRICEDISC=function(e,t,r,o,l){return e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t)?n.value:l<0||l>4?n.na:e>=t?n.na:o-r*o*Math.abs(i.DAYS(e,t,!1))/360},t.PRICEMAT=function(e,t,r,o,l,s){if(e=a.parseDate(e),t=a.parseDate(t),r=a.parseDate(r),a.anyIsError(e,t))return n.value;if(s<0||s>4)return n.na;if(e>=t)return n.na;var u=Math.abs(i.DAYS(e,t,!1));return(100+Math.abs(i.DAYS(t,r,!1))/360*o*100)/(1+u/360*l)-Math.abs(i.DAYS(r,e,!1))/360*o*100},t.PV=function(e,t,r,i,o){return i=i||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),a.anyIsError(e,t,r,i,o)?n.value:0===e?-r*t-i:((1-Math.pow(1+e,t))/e*r*(1+e*o)-i)/Math.pow(1+e,t)},t.RATE=function(e,t,r,i,o,l){if(l=void 0===l?.01:l,i=void 0===i?0:i,o=void 0===o?0:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),o=a.parseNumber(o),l=a.parseNumber(l),a.anyIsError(e,t,r,i,o,l))return n.value;for(var s=0,u=!1,c=l;s<100&&!u;){var f=Math.pow(c+1,e),h=Math.pow(c+1,e-1),p=c-(i+f*r+t*(f-1)*(c*o+1)/c)/(e*h*r-t*(f-1)*(c*o+1)/Math.pow(c,2)+(e*t*h*(c*o+1)/c+t*(f-1)*o/c));Math.abs(p-c)<1e-6&&(u=!0),s++,c=p}return u?c:Number.NaN+c},t.RECEIVED=function(e,t,r,o,l){return e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t)?n.value:r<=0||o<=0?n.na:l<0||l>4?n.na:e>=t?n.na:r/(1-o*Math.abs(i.DAYS(e,t,!1))/360)},t.RRI=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:0===e||0===t?n.num:Math.pow(r/t,1/e)-1},t.SLN=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:0===r?n.num:(e-t)/r},t.SYD=function(e,t,r,i){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),i=a.parseNumber(i),a.anyIsError(e,t,r,i)?n.value:0===r?n.num:i<1||i>r?n.num:(e-t)*(r-(i=parseInt(i,10))+1)*2/(r*(r+1))},t.TBILLEQ=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:365*r/(360-r*i.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:100*(1-r*i.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,r){return e=a.parseDate(e),t=a.parseDate(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?n.value:r<=0?n.num:e>t?n.num:t-e>31536e6?n.num:360*(100-r)/(r*i.DAYS360(e,t,!1))},t.VDB=function(){throw new Error("VDB is not implemented")},t.XIRR=function(e,t,r){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseDateArray(a.flatten(t)),r=a.parseNumber(r),a.anyIsError(e,t,r))return n.value;for(var o=function(e,t,r){for(var n=r+1,a=e[0],o=1;o<e.length;o++)a+=e[o]/Math.pow(n,i.DAYS(t[o],t[0])/365);return a},l=function(e,t,r){for(var n=r+1,a=0,o=1;o<e.length;o++){var l=i.DAYS(t[o],t[0])/365;a-=l*e[o]/Math.pow(n,l+1)}return a},s=!1,u=!1,c=0;c<e.length;c++)e[c]>0&&(s=!0),e[c]<0&&(u=!0);if(!s||!u)return n.num;var f,h,p,v=r=r||.1,d=!0;do{f=v-(p=o(e,t,v))/l(e,t,v),h=Math.abs(f-v),v=f,d=h>1e-10&&Math.abs(p)>1e-10}while(d);return v},t.XNPV=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),r=a.parseDateArray(a.flatten(r)),a.anyIsError(e,t,r))return n.value;for(var o=0,l=0;l<t.length;l++)o+=t[l]/Math.pow(1+e,i.DAYS(r[l],r[0])/365);return o},t.YIELD=function(e,t,r,o,l,s,u){if(e=a.parseDate(e),t=a.parseDate(t),a.anyIsError(e,t))return n.value;if(r<=0)return n.num;if(o<=0)return n.num;if(l<=0)return n.num;if(e>=t)return n.num;Math.abs(i.DAYS(e,t,!1))},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},183:function(e,t,r){var n=r(8),i=r(11);function a(e,t){for(var r,i,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]<t&&(i?e[a]>i&&(r=a+1,i=e[a]):(r=a+1,i=e[a]))}return r||n.na}function o(e,t){for(var r=0;r<e.length;r++)if(t=t.replace(/\?/g,"."),Array.isArray(e[r])){if(1===e[r].length&&"string"==typeof e[r][0]&&e[r][0].toLowerCase()===t.toLowerCase())return r+1}else if("string"==typeof e[r]&&e[r].toLowerCase()===t.toLowerCase())return r+1;return n.na}function l(e,t){for(var r=0;r<e.length;r++)if(Array.isArray(e[r])){if(1===e[r].length&&e[r][0]===t)return r+1}else if(e[r]===t)return r+1;return n.na}function s(e,t){for(var r,i,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]>t&&(i?e[a]<i&&(r=a+1,i=e[a]):(r=a+1,i=e[a]))}return r||n.na}t.MATCH=function(e,t,r){if(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),!e&&!t)return n.na;if(2===arguments.length&&(r=1),!(t instanceof Array))return n.na;if(0===r)return"string"==typeof e?o(t,e):l(t,e);if(1===r)return a(t,e);if(-1===r){for(var i=t[0][0],u=1;u<t.length;u++)if(t[u][0]>i)return n.na;return s(t,e)}return n.na},t.VLOOKUP=function(e,t,r,i){if("string"==typeof i&&"FALSE"!=i&&"TRUE"!=i)return n.value;i="FALSE"!=i;for(var a=0;a<t.length;a++)if(t[a][0]==e)return t[a][r-1];return n.na},t.HLOOKUP=function(e,t,r,a){if("TRUE"==a&&(a=!0),"FALSE"==a&&(a=!1),"string"==typeof t&&t.indexOf("{")>=0&&(t=i.strToMatrix(t)),void 0===e||t[0].indexOf(e)<0)return n.na;r=r||0;for(var o=t[0],l=0;l<o.length;l++)if(a&&o[l]===e||-1!==o[l].toString().toLowerCase().indexOf(e.toString().toLowerCase()))return r<t.length+1?t[r-1][l]:t[0][l];return n.na}},184:function(e,t,r){var n=r(8);function i(e,t,r){this.name=e,this.type=t,this.url=r}t.PQUERY=function(){if(5!==arguments.length)return n.error;if(arguments[0].length!==arguments[1].length)return n.error;if(arguments[1].length!==arguments[3].length)return n.error;for(var e=[],t=arguments[4],r=0;r<arguments[3].length;r++)arguments[3][r]=parseFloat(arguments[3][r]),isNaN(arguments[3][r])||e.push({number:r,value:Math.abs(arguments[3][r]-t)});e=e.sort((function(e,t){var r=e.value,n=t.value;return r<n?-1:r>n?1:0}));for(var i=[],a=1,o=0;o<e.length;o++){var l=e[o],s=l.number,u=l.value,c=arguments[0][s][0],f=arguments[1][s][0],h=arguments[3][s];f===arguments[2]&&(i.push({number:a,name:c,city:f,area:h,value:u}),a+=1)}return"*悬浮查看*!"+JSON.stringify(i)},t.HYPERLINK=function(){if(console.log(arguments),!arguments||!arguments[0]||!arguments[1])return n.na;var e=arguments[0];e="http://"==e.substr(0,7).toLowerCase()||"https://"==e.substr(0,8).toLowerCase()?e:"http://"+e;var t={text:arguments[1],url:e};return"*HYPERLINK*!"+JSON.stringify(t)+" "};!function(e){e.push(new i("合肥",0,"https://hf.lianjia.com/ditu")),e.push(new i("安庆",0,"https://aq.lianjia.com/ditu")),e.push(new i("滁州",0,"https://cz.fang.lianjia.com/ditu/")),e.push(new i("马鞍山",0,"https://mas.lianjia.com/ditu")),e.push(new i("北京",0,"https://bj.lianjia.com/ditu")),e.push(new i("重庆",0,"https://cq.lianjia.com/ditu")),e.push(new i("福州",0,"https://fz.lianjia.com/ditu")),e.push(new i("泉州",0,"https://quanzhou.lianjia.com/ditu")),e.push(new i("厦门",0,"https://xm.lianjia.com/ditu")),e.push(new i("漳州",0,"https://zhangzhou.lianjia.com/ditu")),e.push(new i("东莞",0,"https://dg.lianjia.com/ditu")),e.push(new i("佛山",0,"https://fs.lianjia.com/ditu")),e.push(new i("广州",0,"https://gz.lianjia.com/ditu")),e.push(new i("惠州",0,"https://hui.lianjia.com/ditu")),e.push(new i("江门",0,"https://jiangmen.lianjia.com/ditu")),e.push(new i("清远",0,"https://qy.lianjia.com/ditu")),e.push(new i("深圳",0,"https://sz.lianjia.com/ditu")),e.push(new i("珠海",0,"https://zh.lianjia.com/ditu")),e.push(new i("湛江",0,"https://zhanjiang.lianjia.com/ditu")),e.push(new i("中山",0,"https://zs.lianjia.com/ditu")),e.push(new i("贵阳",0,"https://gy.lianjia.com/ditu")),e.push(new i("北海",0,"https://bh.lianjia.com/ditu")),e.push(new i("防城港",0,"https://fcg.lianjia.com/ditu")),e.push(new i("桂林",0,"https://gl.lianjia.com/ditu")),e.push(new i("柳州",0,"https://liuzhou.lianjia.com/ditu")),e.push(new i("南宁",0,"https://nn.lianjia.com/ditu")),e.push(new i("兰州",0,"https://lz.lianjia.com/ditu")),e.push(new i("鄂州",0,"https://ez.lianjia.com/ditu")),e.push(new i("黄石",0,"https://huangshi.lianjia.com/ditu")),e.push(new i("武汉",0,"https://wh.lianjia.com/ditu")),e.push(new i("襄阳",0,"https://xy.lianjia.com/ditu")),e.push(new i("宜昌",0,"https://yichang.lianjia.com/ditu")),e.push(new i("长沙",0,"https://cs.lianjia.com/ditu")),e.push(new i("常德",0,"https://changde.lianjia.com/ditu")),e.push(new i("岳阳",0,"https://yy.lianjia.com/ditu")),e.push(new i("株洲",0,"https://zhuzhou.lianjia.com/ditu")),e.push(new i("保定",0,"https://bd.lianjia.com/ditu")),e.push(new i("廊坊",0,"https://lf.lianjia.com/ditu")),e.push(new i("秦皇岛",0,"https://qhd.fang.lianjia.com/ditu")),e.push(new i("石家庄",0,"https://sjz.lianjia.com/ditu")),e.push(new i("唐山",0,"https://ts.lianjia.com/ditu")),e.push(new i("张家口",0,"https://zjk.lianjia.com/ditu")),e.push(new i("保亭",0,"https://bt.fang.lianjia.com/ditu")),e.push(new i("澄迈",0,"https://cm.fang.lianjia.com/ditu")),e.push(new i("儋州",0,"https://dz.fang.lianjia.com/ditu")),e.push(new i("海口",0,"https://hk.lianjia.com/ditu")),e.push(new i("临高",0,"https://lg.fang.lianjia.com/ditu")),e.push(new i("乐东",0,"https://ld.fang.lianjia.com/ditu")),e.push(new i("陵水",0,"https://ls.fang.lianjia.com/ditu")),e.push(new i("琼海",0,"https://qh.fang.lianjia.com/ditu")),e.push(new i("三亚",0,"https://san.lianjia.com/ditu")),e.push(new i("五指山",0,"https://wzs.fang.lianjia.com/ditu")),e.push(new i("文昌",0,"https://wc.fang.lianjia.com/ditu")),e.push(new i("万宁",0,"https://wn.fang.lianjia.com/ditu")),e.push(new i("开封",0,"https://kf.lianjia.com/ditu")),e.push(new i("洛阳",0,"https://luoyang.lianjia.com/ditu")),e.push(new i("新乡",0,"https://xinxiang.lianjia.com/ditu")),e.push(new i("许昌",0,"https://xc.lianjia.com/ditu")),e.push(new i("郑州",0,"https://zz.lianjia.com/ditu")),e.push(new i("哈尔滨",0,"https://kf.lianjia.com/ditu")),e.push(new i("常州",0,"https://changzhou.lianjia.com/ditu")),e.push(new i("淮安",0,"https://ha.lianjia.com/ditu")),e.push(new i("昆山",0,"https://ks.lianjia.com/ditu")),e.push(new i("南京",0,"https://nj.lianjia.com/ditu/")),e.push(new i("南通",0,"https://nt.lianjia.com/ditu")),e.push(new i("苏州",0,"https://su.lianjia.com/ditu")),e.push(new i("无锡",0,"https://wx.lianjia.com/ditu")),e.push(new i("徐州",0,"https://xz.lianjia.com/ditu")),e.push(new i("盐城",0,"https://yc.lianjia.com/ditu")),e.push(new i("镇江",0,"https://zj.lianjia.com/ditu")),e.push(new i("长春",0,"https://cc.lianjia.com/ditu/")),e.push(new i("吉林",0,"https://jl.lianjia.com/ditu")),e.push(new i("赣州",0,"https://ganzhou.lianjia.com/ditu")),e.push(new i("九江",0,"https://jiujiang.lianjia.com/ditu")),e.push(new i("吉安",0,"https://jian.lianjia.com/ditu")),e.push(new i("南昌",0,"https://nc.lianjia.com/ditu")),e.push(new i("上饶",0,"https://sr.lianjia.com/ditu")),e.push(new i("大连",0,"https://dl.lianjia.com/ditu")),e.push(new i("丹东",0,"https://dd.lianjia.com/ditu")),e.push(new i("沈阳",0,"https://sy.lianjia.com/ditu")),e.push(new i("呼和浩特",0,"https://hhht.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("上海",0,"https://sh.lianjia.com/ditu")),e.push(new i("成都",0,"https://cd.lianjia.com/ditu")),e.push(new i("德阳",0,"https://dy.fang.lianjia.com/ditu")),e.push(new i("达州",0,"https://dazhou.lianjia.com/ditu")),e.push(new i("乐山",0,"https://leshan.fang.lianjia.com/ditu")),e.push(new i("凉山",0,"https://liangshan.lianjia.com/ditu")),e.push(new i("绵阳",0,"https://mianyang.lianjia.com/ditu")),e.push(new i("眉山",0,"https://ms.fang.lianjia.com/ditu")),e.push(new i("南充",0,"https://nanchong.lianjia.com/ditu")),e.push(new i("济南",0,"https://jn.lianjia.com/ditu")),e.push(new i("临沂",0,"https://linyi.lianjia.com/ditu")),e.push(new i("青岛",0,"https://qd.lianjia.com/ditu")),e.push(new i("潍坊",0,"https://wf.lianjia.com/ditu")),e.push(new i("威海",0,"https://weihai.lianjia.com/ditu")),e.push(new i("烟台",0,"https://yt.lianjia.com/ditu")),e.push(new i("淄博",0,"https://zb.lianjia.com/ditu")),e.push(new i("宝鸡",0,"https://baoji.lianjia.com/ditu")),e.push(new i("汉中",0,"https://hanzhong.lianjia.com/ditu")),e.push(new i("西安",0,"https://xa.lianjia.com/ditu")),e.push(new i("咸阳",0,"https://xianyang.lianjia.com/ditu")),e.push(new i("晋中",0,"https://jz.fang.lianjia.com/ditu")),e.push(new i("太原",0,"https://ty.lianjia.com/ditu")),e.push(new i("天津",0,"https://tj.lianjia.com/ditu")),e.push(new i("大理",0,"https://dali.lianjia.com/ditu")),e.push(new i("昆明",0,"https://km.lianjia.com/ditu")),e.push(new i("西双版纳",0,"https://xsbn.fang.lianjia.com/ditu")),e.push(new i("杭州",0,"https://hz.lianjia.com/ditu")),e.push(new i("湖州",0,"https://huzhou.lianjia.com/ditu")),e.push(new i("嘉兴",0,"https://jx.lianjia.com/ditu")),e.push(new i("金华",0,"https://jh.lianjia.com/ditu")),e.push(new i("宁波",0,"https://nb.lianjia.com/ditu")),e.push(new i("绍兴",0,"https://sx.lianjia.com/ditu")),e.push(new i("台州",0,"https://taizhou.lianjia.com/ditu")),e.push(new i("温州",0,"https://wz.lianjia.comditu"))}([]);!function(e){e.push(new i("北京",0,"https://bj.5i5j.com/map")),e.push(new i("杭州",0,"https://hz.5i5j.com/map")),e.push(new i("青岛",0,"https://qd.5i5j.com/map")),e.push(new i("天津",0,"https://tj.5i5j.com/map")),e.push(new i("太原",0,"https://zz.5i5j.com/map")),e.push(new i("郑州",0,"https://zz.5i5j.com/map")),e.push(new i("成都",0,"https://cd.5i5j.com/map")),e.push(new i("长沙",0,"https://cs.5i5j.com/map")),e.push(new i("南昌",0,"https://nc.5i5j.com/map")),e.push(new i("南京",0,"https://nj.5i5j.com/map")),e.push(new i("南宁",0,"https://nn.5i5j.com/map")),e.push(new i("上海",0,"https://sh.5i5j.com/map")),e.push(new i("苏州",0,"https://sz.5i5j.com/map")),e.push(new i("武汉",0,"https://wh.5i5j.com/map")),e.push(new i("无锡",0,"https://wx.5i5j.com/map"))}([]);!function(e){e.push(new i("全国",0,"https://www1.fang.com"))}([])},185:function(e,t,r){"use strict";var n=r(19),i=r(20),a=r(14),o=r(21),l=r(30);e.exports={OFFSET:function(e,t,r,s,u){if(s=(s||new a(1)).calc(),u=(u||new a(1)).calc(),1===e.args.length&&"RefValue"===e.args[0].name){var c=e.args[0],f=c.parseRef(),h=i(f.cell_name)+r.calc(),p=n(h),v=+f.cell_name.replace(/^[A-Z]+/g,"")+t.calc(),d=p+v;if(1===s&&1===u)return new l(d,c.formula).calc();var g=n(h+u-1)+(v+s-1),m=f.sheet_name+"!"+d+":"+g;return new o(m,c.formula).calc()}},IFERROR:function(e,t){try{var r=e.calc();return"number"!=typeof r||!isNaN(r)&&r!==1/0&&r!==-1/0?r:t.calc()}catch(e){return t.calc()}},IF:function(e,t,r){return e.calc()?t.calc():r.calc()},AND:function(){for(var e=0;e<arguments.length;e++)if(!arguments[e].calc())return!1;return!0}}},186:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(14),o=r(29),l=r(36),s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workbook=t,this.expressions=[],this.exec_formula=r,this.variables={},this.formulas=l(t,r);for(var n=this.formulas.length-1;n>=0;n--){var i=r.build_expression(this.formulas[n]);this.expressions.push(i)}this.calcNames()}var t,r,s;return t=e,(r=[{key:"setVar",value:function(e,t){var r=this,n=this.variables[e];n?n.setValue(t):this.expressions.forEach((function(n){r.setVarOfExpression(n,e,t)}))}},{key:"getVars",value:function(){var e={};for(var t in this.variables)e[t]=this.variables[t].calc();return e}},{key:"calcNames",value:function(){var e=this;this.workbook&&this.workbook.Workbook&&this.workbook.Workbook.Names&&this.workbook.Workbook.Names.forEach((function(t){var r=e.getRef(t.Ref);e.variables[t.Name]=r,e.expressions.forEach((function(r){e.setVarOfExpression(r,t.Name)}))}))}},{key:"getRef",value:function(e){if(!this.formulas.length)throw new Error("No formula found.");var t={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return o(e,t)}},{key:"setVarOfExpression",value:function(e,t,r){for(var i=0;i<e.args.length;i++){var o=e.args[i];o===t?e.args[i]=this.variables[t]||(this.variables[t]=new a(r)):"object"!==n(o)||"Expression"!==o.name&&"UserFn"!==o.name||this.setVarOfExpression(o,t,r)}}},{key:"execute",value:function(){this.expressions.forEach((function(e){e.update_cell_value()}))}}])&&i(t.prototype,r),s&&i(t,s),e}();e.exports=s},187:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(37),a=r(8),o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cell=t.cell,this.rows=r,this.f=t.cell.f,this.name=t.name,this.sheet=t.sheet}var t,r,o;return t=e,(r=[{key:"check_valid",value:function(){var e=this.f;return"="===e[1]?a.name:null!=e.match("=[a-z|A-Z]{2,100}")&&this.f.indexOf("(")<0&&this.f.indexOf(")")<0?a.name:!(this.f.indexOf('""')>=1&&this.f.indexOf("(")<0&&this.f.indexOf(")")<0)||this.f.slice(2,this.f.length-1).replace('""','"')}},{key:"trans_params",value:function(e){var t=new RegExp("{(.*?)}","g"),r=e.match(t);if(null!=r)for(var n=0;n<r.length;n++){var i=r[n],a="'"+i+"'";e=e.replace(i,a)}return e}},{key:"trans_formula",value:function(){var e=this.f;return e=i.strim(e),(e=i.trans_formula(e)).indexOf("{")>=0&&e.indexOf("}")>=0&&e.indexOf("'{")<0&&(e=this.trans_params(e)),e}},{key:"recover_formula",value:function(){return i.strim(this.f)}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports=o},188:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(1),a=r(8);function o(e){return void 0!==e&&null!==e}var l=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rows=t,this.tileArr=r}var t,r,l;return t=e,(r=[{key:"get_workbook",value:function(e){for(var t=this.rows.data.name,r=this.tileArr.findAllNeedCalcCell(),n=0;n<r.length;n++){var a=r[n],l=i.expr2xy(a),s=this.rows.getCell(l[1],l[0]);o(s)&&(e.Sheets[t][a]={v:s.text,f:s.formulas,multivalueRefsCell:s.multivalueRefsCell,source_v:s.source_v})}return e}},{key:"calcDoneToSetCells",value:function(e,t){var r=t.data.name,n=e.Sheets[r];Object.keys(n).forEach((function(e){var r=i.expr2xy(e);if(o(n[e])&&o(n[e].v)&&o(n[e].f)){var a=t.getCell(r[1],r[0]);o(a)||(a={}),a.text=n[e].v,a.formulas=n[e].f,a.multivalueRefsCell=n[e].multivalueRefsCell,o(n[e].source_v)&&(a.source_v=n[e].source_v),t.setCell(r[1],r[0],a)}})),t.workbook=e}},{key:"is_muti_cell",value:function(e){var t=e.cell;return null!==t&&(t=t.multivalueRefsCell),!!o(t)}},{key:"process_arr",value:function(){}},{key:"process_matrix",value:function(e,t){for(var r,n,a=!0,l=e.cell.v,s=i.expr2xy(t),u=s[0],c=s[1],f=l.length,h="",p=0,v=e.sheet,d=0;d<f;d++)for(var g=0;g<l[d].length;g++){var m=i.xy2expr(u+d,c+g),y=l[d][g];if(0===d&&0===g)v[m]={v:y,f:e.cell.f,multivalueRefsCell:t};else{var b=this.rows.getCell(c+g,u+d);!o(b)||!o(b.text)||o(b.text)&&(r=b.text,n=y,n+="",(r=(r+="").toUpperCase())===(n=n.toUpperCase())||""===b.text)?v[m]={v:l[d][g],f:l[d][g],multivalueRefsCell:t}:(v[m]={v:b.v,f:b.f,multivalueRefsCell:t},a=!1,h=b,p=m)}}return a?v:this.clean_matrix(v,l,h,t,p)}},{key:"clean_matrix",value:function(e,t,r,n,o){for(var l=i.expr2xy(n),s=l[0],u=l[1],c=t.length,f=0;f<c;f++)for(var h=0;h<t[f].length;h++){var p=i.xy2expr(s+f,u+h);e[p]=0===f&&0===h?{v:a.ref,f:e[p].f,multivalueRefsCell:n}:o===p?{v:r.text,f:r.formulas,multivalueRefsCell:n}:{v:"",f:""}}return e}},{key:"clean_all_flag",value:function(e,t){for(var r=e.sheet,n=i.expr2xy(t),a=n[0],o=n[1],l=this.rows.getCell(n[1],n[0]).source_v,s=l.length,u=0;u<s;u++)for(var c=0;c<l[u].length;c++){var f=i.xy2expr(a+u,o+c);0===u&&0===c?r[f]={v:e.cell.v,f:e.cell.f,source_v:""}:this.rows.getCell(o+c,a+u).text!==l[u][c]?r[f]={v:this.rows.getCell(o+c,a+u).text,f:this.rows.getCell(o+c,a+u).formulas}:r[f]={v:"",f:""}}return r}},{key:"deal_muti_cell",value:function(e,t){var r=t.cell,n=this.rows.data.name;r=o(r)&&o(r.multivalueRefsCell)?r.multivalueRefsCell:t.name;var l=t.cell.v;if(t.name!==r)l instanceof Array?(e.Sheets[n][t.name].v=a.ref,e.Sheets[n][t.name].source_v=l):o(l)&&(e.Sheets[n][t.name].v=l);else if(l instanceof Array){var s=i.expr2xy(r);o(this.rows.getCell(s[1],s[0]).source_v)&&this.rows.getCell(s[1],s[0]).source_v!==l&&(e.Sheets[n]=this.clean_all_flag(t,r)),1===l.length?(e.Sheets[n]=this.process_arr(t,r),e.Sheets[n][t.name].source_v=l):(e.Sheets[n]=this.process_matrix(t,r),e.Sheets[n][t.name].source_v=l)}else e.Sheets[n]=this.clean_all_flag(t,r)}}])&&n(t.prototype,r),l&&n(t,l),e}();e.exports=l},189:function(e,t,r){var n=r(1),i=r(3);t.Rows2Workbook=function(e){var t=e._,r={Sheets:{}},a=e.data.name;return r.Sheets[a]={},Object.keys(t).forEach((function(o){Object.keys(t[o].cells).forEach((function(t){var l=e.getCell(o,t),s=n.xy2expr(t,o);i.isHave(l)&&(r.Sheets[a][s]={v:l.text,f:l.formulas,multivalueRefsCell:l.multivalueRefsCell,source_v:l.source_v})}))})),r},t.Rows2Workbook=function(e){var t=e._,r={Sheets:{}},a=e.data.name;return r.Sheets[a]={},Object.keys(t).forEach((function(o){Object.keys(t[o].cells).forEach((function(t){var l=e.getCell(o,t),s=n.xy2expr(t,o);i.isHave(l)&&(r.Sheets[a][s]={v:l.text,f:l.formulas,multivalueRefsCell:l.multivalueRefsCell,source_v:l.source_v})}))})),r}},19:function(e,t,r){"use strict";e.exports=function(e){for(var t,r=e+1,n="",i=10;r>0&&i--;)t=(r-1)%26,n=String.fromCharCode(t+65)+n,r=(r-t-1)/26;return n}},190:function(e,t,r){},194:function(e,t,r){var n={"./af":40,"./af.js":40,"./ar":41,"./ar-dz":42,"./ar-dz.js":42,"./ar-kw":43,"./ar-kw.js":43,"./ar-ly":44,"./ar-ly.js":44,"./ar-ma":45,"./ar-ma.js":45,"./ar-sa":46,"./ar-sa.js":46,"./ar-tn":47,"./ar-tn.js":47,"./ar.js":41,"./az":48,"./az.js":48,"./be":49,"./be.js":49,"./bg":50,"./bg.js":50,"./bm":51,"./bm.js":51,"./bn":52,"./bn.js":52,"./bo":53,"./bo.js":53,"./br":54,"./br.js":54,"./bs":55,"./bs.js":55,"./ca":56,"./ca.js":56,"./cs":57,"./cs.js":57,"./cv":58,"./cv.js":58,"./cy":59,"./cy.js":59,"./da":60,"./da.js":60,"./de":61,"./de-at":62,"./de-at.js":62,"./de-ch":63,"./de-ch.js":63,"./de.js":61,"./dv":64,"./dv.js":64,"./el":65,"./el.js":65,"./en-SG":66,"./en-SG.js":66,"./en-au":67,"./en-au.js":67,"./en-ca":68,"./en-ca.js":68,"./en-gb":69,"./en-gb.js":69,"./en-ie":70,"./en-ie.js":70,"./en-il":71,"./en-il.js":71,"./en-nz":72,"./en-nz.js":72,"./eo":73,"./eo.js":73,"./es":74,"./es-do":75,"./es-do.js":75,"./es-us":76,"./es-us.js":76,"./es.js":74,"./et":77,"./et.js":77,"./eu":78,"./eu.js":78,"./fa":79,"./fa.js":79,"./fi":80,"./fi.js":80,"./fo":81,"./fo.js":81,"./fr":82,"./fr-ca":83,"./fr-ca.js":83,"./fr-ch":84,"./fr-ch.js":84,"./fr.js":82,"./fy":85,"./fy.js":85,"./ga":86,"./ga.js":86,"./gd":87,"./gd.js":87,"./gl":88,"./gl.js":88,"./gom-latn":89,"./gom-latn.js":89,"./gu":90,"./gu.js":90,"./he":91,"./he.js":91,"./hi":92,"./hi.js":92,"./hr":93,"./hr.js":93,"./hu":94,"./hu.js":94,"./hy-am":95,"./hy-am.js":95,"./id":96,"./id.js":96,"./is":97,"./is.js":97,"./it":98,"./it-ch":99,"./it-ch.js":99,"./it.js":98,"./ja":100,"./ja.js":100,"./jv":101,"./jv.js":101,"./ka":102,"./ka.js":102,"./kk":103,"./kk.js":103,"./km":104,"./km.js":104,"./kn":105,"./kn.js":105,"./ko":106,"./ko.js":106,"./ku":107,"./ku.js":107,"./ky":108,"./ky.js":108,"./lb":109,"./lb.js":109,"./lo":110,"./lo.js":110,"./lt":111,"./lt.js":111,"./lv":112,"./lv.js":112,"./me":113,"./me.js":113,"./mi":114,"./mi.js":114,"./mk":115,"./mk.js":115,"./ml":116,"./ml.js":116,"./mn":117,"./mn.js":117,"./mr":118,"./mr.js":118,"./ms":119,"./ms-my":120,"./ms-my.js":120,"./ms.js":119,"./mt":121,"./mt.js":121,"./my":122,"./my.js":122,"./nb":123,"./nb.js":123,"./ne":124,"./ne.js":124,"./nl":125,"./nl-be":126,"./nl-be.js":126,"./nl.js":125,"./nn":127,"./nn.js":127,"./pa-in":128,"./pa-in.js":128,"./pl":129,"./pl.js":129,"./pt":130,"./pt-br":131,"./pt-br.js":131,"./pt.js":130,"./ro":132,"./ro.js":132,"./ru":133,"./ru.js":133,"./sd":134,"./sd.js":134,"./se":135,"./se.js":135,"./si":136,"./si.js":136,"./sk":137,"./sk.js":137,"./sl":138,"./sl.js":138,"./sq":139,"./sq.js":139,"./sr":140,"./sr-cyrl":141,"./sr-cyrl.js":141,"./sr.js":140,"./ss":142,"./ss.js":142,"./sv":143,"./sv.js":143,"./sw":144,"./sw.js":144,"./ta":145,"./ta.js":145,"./te":146,"./te.js":146,"./tet":147,"./tet.js":147,"./tg":148,"./tg.js":148,"./th":149,"./th.js":149,"./tl-ph":150,"./tl-ph.js":150,"./tlh":151,"./tlh.js":151,"./tr":152,"./tr.js":152,"./tzl":153,"./tzl.js":153,"./tzm":154,"./tzm-latn":155,"./tzm-latn.js":155,"./tzm.js":154,"./ug-cn":156,"./ug-cn.js":156,"./uk":157,"./uk.js":157,"./ur":158,"./ur.js":158,"./uz":159,"./uz-latn":160,"./uz-latn.js":160,"./uz.js":159,"./vi":161,"./vi.js":161,"./x-pseudo":162,"./x-pseudo.js":162,"./yo":163,"./yo.js":163,"./zh-cn":164,"./zh-cn.js":164,"./zh-hk":165,"./zh-hk.js":165,"./zh-tw":166,"./zh-tw.js":166};function i(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=a,e.exports=i,i.id=194},20:function(e,t,r){"use strict";e.exports=function(e){for(var t=0,r=e.replace(/[0-9]+$/,""),n=r.length;n--;)t+=Math.pow(26,r.length-n-1)*(r.charCodeAt(n)-64);return t-1}},206:function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t);var a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t?(this.el=document.createElement(t),this.el.className=r):this.el=t,this.data={}}var t,r,a;return t=e,(r=[{key:"data",value:function(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}},{key:"on",value:function(e,t){var r=n(e.split(".")),i=r[0],a=r.slice(1),o=i;return"mousewheel"===o&&/Firefox/i.test(window.navigator.userAgent)&&(o="DOMMouseScroll"),this.el.addEventListener(o,(function(e){t(e);for(var r=0;r<a.length;r+=1){var n=a[r];if("left"===n&&0!==e.button)return;if("right"===n&&2!==e.button)return;"stop"===n&&e.stopPropagation()}})),this}},{key:"offset",value:function(e){var t=this;if(void 0!==e)return Object.keys(e).forEach((function(r){t.css(r,"".concat(e[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(e){var t=this.el;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"children",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(t){return e.child(t)})),this)}},{key:"child",value:function(t){var r=t;return"string"==typeof t?r=document.createTextNode(t):t instanceof e&&(r=t.el),this.el.appendChild(r),this}},{key:"contains",value:function(e){return this.el.contains(e)}},{key:"className",value:function(e){return void 0!==e?(this.el.className=e,this):this.el.className}},{key:"addClass",value:function(e){return this.el.classList.add(e),this}},{key:"hasClass",value:function(e){return this.el.classList.contains(e)}},{key:"removeClass",value:function(e){return this.el.classList.remove(e),this}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(e)}},{key:"toggleClass",value:function(e){return this.el.classList.toggle(e)}},{key:"active",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return e?this.addClass(t):this.removeClass(t),this}},{key:"checked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(e,"checked"),this}},{key:"disabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(e,t){var r=this;if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((function(t){r.el.setAttribute(t,e[t])}))}return this}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"html",value:function(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}},{key:"val",value:function(e){return void 0!==e?(this.el.value=e,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){return e.el.style.removeProperty(t)})),this}},{key:"css",value:function(e,t){var r=this;return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach((function(t){r.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}},{key:"removeEl",value:function(){this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"isShow",value:function(){return"block"===this.el.style.display}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";return this.css(e,t),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";return this.css(e,t),this}}])&&i(t.prototype,r),a&&i(t,a),e}(),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new a(e,t)},l="en",s={en:{toolbar:{undo:"Undo",redo:"Redo",paintformat:"Paint format",clearformat:"Clear format",format:"Format",font:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",textColor:"Text color",fillColor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",add:"display equation",autofilter:"Filter",formula:"Functions",more:"More",flexible:"Flexible",throwFormula:"Throw formulas",comeBack:"come back"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",recover:"recover"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},date_formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",concat:"Concat",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function u(e,t){if(t&&t[l])for(var r=t[l],n=e.split("."),i=0;i<n.length;i+=1){var a=r[n[i]];if(i===n.length-1)return a;if(!a)return;r=a}}function c(e){var t=u(e,s);return!t&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(t=u(e,window.x.spreadsheet.$messages)),t||""}function f(e){return function(){return c(e)}}function h(e,t){l=e,t&&(s[e]=t)}var p=r(18),v=r.n(p);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var g=r(31),m=[{key:"MD.WLAND",title:f("formula.wland"),render:function(e){return e.join("")}},{key:"MD.WFR",title:f("formula.wfr"),render:function(e){return e.join("")}},{key:"MD.RTD",title:f("formula.rtd"),render:function(e){return e.join("")}}],y=w(m),b=function(){v.a.import_functions(g);var e=v.a.xlsx_Fx;return y=w(m),Object.keys(e).forEach((function(t){var r={key:t,title:t,render:e[t]};y.push(r)})),v.a};function w(e){var t=Array.isArray(e)?[]:{};for(var r in e)e.hasOwnProperty(r)&&("object"===d(e[r])&&null!==e[r]?t[r]=w(e[r]):t[r]=e[r]);return t}var x={};m.forEach((function(e){x[e.key]=e}));var E=r(5);function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=new E.a(0,0,0,0),this.ri=0,this.ci=0}var t,r,n;return t=e,(r=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(e,t){this.ri=e,this.ci=t}},{key:"size",value:function(){return this.range.size()}}])&&O(t.prototype,r),n&&O(t,n),e}();var k=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.ri=0,this.ci=0};function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="clear"}var t,r,n;return t=e,(r=[{key:"copy",value:function(e){return this.range=e,this.state="copy",this}},{key:"cut",value:function(e){return this.range=e,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&N(t.prototype,r),n&&N(t,n),e}();function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t,r){return t&&I(e.prototype,t),r&&I(e,r),e}var j=function(){function e(t,r,n){A(this,e),this.ci=t,this.operator=r,this.value=n}return S(e,[{key:"set",value:function(e,t){this.operator=e,this.value=t}},{key:"includes",value:function(e){var t=this.operator,r=this.value;return"all"===t||"in"===t&&r.includes(e)}},{key:"vlength",value:function(){var e=this.operator,t=this.value;return"in"===e?t.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),e}(),M=function(){function e(t,r){A(this,e),this.ci=t,this.order=r}return S(e,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),e}(),R=function(){function e(){A(this,e),this.ref=null,this.filters=[],this.sort=null,this.flex=[]}return S(e,[{key:"setData",value:function(e){var t=e.ref,r=e.filters,n=e.sort;null!=t&&(this.ref=t,this.fitlers=r.map((function(e){return new j(e.ci,e.operator,e.value)})),n&&(this.sort=new M(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var e=this.ref,t=this.filters,r=this.sort;return{ref:e,filters:t.map((function(e){return e.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(e,t,r){var n=this.getFilter(e);null==n?this.filters.push(new j(e,t,r)):n.set(t,r)}},{key:"addFiexRows",value:function(e){this.flex=e}},{key:"setSort",value:function(e,t){this.sort=t?new M(e,t):null}},{key:"includes",value:function(e,t){return!!this.active()&&this.hrange().includes(e,t)}},{key:"getSet",value:function(e,t){for(var r=0;r<this.flex.length;r++)for(var n=this.flex[r],i=n.ri,a=(n.ci,n.set_total),o=n.state,l=i;l<a+i;l++)console.log(o,"114",t,i,o),!1===o&&t==i?(e.add(l+1),this.flex[r].state=!0):!0===o&&t==i&&(e.delete(l+1),this.flex[r].state=!1);return e}},{key:"includes2",value:function(e,t){for(var r=!1,n=0;n<this.flex.length;n++){var i=this.flex[n],a=i.ri,o=i.ci;e==a&&t==o&&(r=!0)}return r}},{key:"getSort",value:function(e){var t=this.sort;return t&&t.ci===e?t:null}},{key:"getFilter",value:function(e){for(var t=this.filters,r=0;r<t.length;r+=1)if(t[r].ci===e)return t[r];return null}},{key:"filteredRows",value:function(e){var t=new Set,r=new Set;if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=this.filters,l=i+1;l<=a;l+=1)for(var s=0;s<o.length;s+=1){var u=o[s],c=e(l,u.ci),f=c?c.text:"";if(!u.includes(f)){t.add(l);break}r.add(l)}return{rset:t,fset:r}}},{key:"items",value:function(e,t){var r={};if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=i+1;o<=a;o+=1){var l=t(o,e);if(null===l||/^\s*$/.test(l.text))r[""]=(r[""]||0)+1;else{var s=l.text,u=(r[s]||0)+1;r[s]=u}}return r}},{key:"range",value:function(){return E.a.valueOf(this.ref)}},{key:"hrange",value:function(){var e=this.range();return console.log(this.range(),"171"),e.eri=e.sri,e}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),e}();function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._=t}var t,r,n;return t=e,(r=[{key:"forEach",value:function(e){this._.forEach(e)}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"deleteWithin",value:function(e){this._=this._.filter((function(t){return!t.within(e)}))}},{key:"getFirstIncludes",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"filterIntersects",value:function(t){return new e(this._.filter((function(e){return e.intersects(t)})))}},{key:"intersects",value:function(e){for(var t=0;t<this._.length;t+=1)if(this._[t].intersects(e))return!0;return!1}},{key:"union",value:function(e){var t=e;return this._.forEach((function(e){e.intersects(t)&&(t=e.union(t))})),t}},{key:"add",value:function(e){this.deleteWithin(e),this._.push(e)}},{key:"shift",value:function(e,t,r,n){this._.forEach((function(i){var a=i.sri,o=i.sci,l=i.eri,s=i.eci,u=i;"row"===e?a>=t?(u.sri+=r,u.eri+=r):a<t&&t<=l&&(u.eri+=r,n(a,o,r,0)):"column"===e&&(o>=t?(u.sci+=r,u.eci+=r):o<t&&t<=s&&(u.eci+=r,n(a,o,0,r)))}))}},{key:"move",value:function(e,t,r){this._.forEach((function(n){var i=n;i.within(e)&&(i.eri+=t,i.sri+=t,i.sci+=r,i.eci+=r)}))}},{key:"setData",value:function(e){return this._=e.map((function(e){return E.a.valueOf(e)})),this}},{key:"getData",value:function(){return this._.map((function(e){return e.toString()}))}}])&&D(t.prototype,r),n&&D(t,n),e}(),P=r(3),L=r(1),F=r(4),H=r(12),B=r.n(H),V=r(6);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Y=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.srcCellRange="",this.dstCellRange="",this.srcOneDRange="",this.dstOneDRange=""}var t,r,n;return t=e,(r=[{key:"setSrcAndDstCellRange",value:function(e,t){this.srcCellRange=e,this.dstCellRange=t}},{key:"use",value:function(){var e=this.srcCellRange,t=this.dstCellRange,r=e.sri,n=e.sci,i=e.eri,a=e.eci,o=t.sri,l=t.sci,s=t.eri,u=t.eci,c=z(e.size(),2),f=c[0],h=c[1],p=z(t.size(),2);return{sri:r,sci:n,eri:i,eci:a,dsri:o,dsci:l,deri:s,deci:u,rn:f,cn:h,drn:p[0],dcn:p[1]}}},{key:"autoFilterDirection",value:function(){var e=this.use(),t=e.sri,r=e.dsri,n=e.deri,i=e.eri,a=!1;return t==r&&n==i&&(a=!0),a}},{key:"upOrDown",value:function(){var e=this.use(),t=e.deri,r=e.sri,n=e.deci,i=e.sci,a=!0;return(t<r||n<i)&&(a=!1),a}},{key:"leftOrRight",value:function(){var e=this.getRangeByWay(),t=e.srcOneDRange,r=e.dstOneDRange,n=1;return t.sri===t.eri&&r.eci>t.eci?n=2:t.sri===t.eri&&r.eci<t.eci&&(n=3),n}},{key:"getOneDRangeObj",value:function(e,t){var r=this.use(),n=r.sri,i=r.sci,a=r.eri,o=r.eci,l=r.dsri,s=r.dsci,u=r.deri,c=r.deci;return e?(this.srcOneDRange=new E.b(n+t,i,n+t,o),this.dstOneDRange=new E.b(l+t,s,l+t,c)):(this.srcOneDRange=new E.b(n,i+t,a,i+t),this.dstOneDRange=new E.b(l,s+t,u,s+t)),this.getRangeByWay()}},{key:"getRangeByWay",value:function(){return{srcOneDRange:this.srcOneDRange,dstOneDRange:this.dstOneDRange}}},{key:"isCopy",value:function(e,t){var r=this.use(),n=r.sri,i=r.sci,a=r.eri,o=!1;return e.length>1&&(o=!0),n==a&&i+t==i+t&&(o=!0),o}},{key:"calcDiff",value:function(e,t){var r=1;if(t||(r=1),t&&e.length>1){var n=e[e.length-2];r=1*e[e.length-1].text-1*n.text}else if(e.length>1){var i=e[1];r=1*e[0].text-1*i.text}return isNaN(r)&&(r=1),r}}])&&U(t.prototype,r),n&&U(t,n),e}();function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var X=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cell=t}var t,r,n;return t=e,(r=[{key:"renderFormat",value:function(e,t,r,n,i){if(!1===Object(P.isHave)(e)||!1===Object(P.isHave)(e.format))return{cellText:"",state:!1};var a=this.cell,o="";if(e.format){var l=n.tryParseToNum(a,t,r);return l.state?i?"date"===l.style||"datetime"===l.style?o=l.text:l.state=!1:o=l.text:(!1===Object(P.isHave)(a.text)&&(a.text=""),o=a.text),{cellText:o,state:l.state}}return{cellText:o,state:!1}}},{key:"getCellDataType",value:function(e,t){var r=t.isDate,n=t.isNumber,i=this.cell,a=!0;Object(P.isHave)(i.formulas)||(i.formulas=""),Object(P.isHave)(i.text)||(i.text="");var o=""!==i.formulas?i.formulas+"":i.text+"",l=1*(o=o.replace(/,/g,""));return!l&&0!=l||"number"!=typeof l||isNaN(l)||!0!==/^\d+$/.test(o)?o&&1==a&&ne(o)?(a=!0,n=!1,r=!1,i.type="na"):o&&-1!=o.search(Object(V.l)(V.d),"")?(1==r?(a=!1,n=!1,r=!0):(a=!1,n=!1,r=!1),i.type="date"):(a=!1,n=!1,r=!1,i.type="other"):(1==n?(n=!0,a=!1,r=!1):(a=!1,n=!1,r=!1),i.type="number"),i.tmp=o,e.push(i),{nA:a,isDate:r,isNumber:n}}}])&&W(t.prototype,r),n&&W(t,n),e}();function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var $=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ri=t,this.ci=r,this.cell=n,this.expr=i,this.empty=a}var t,r,n;return t=e,(r=[{key:"isInclude",value:function(){}},{key:"each",value:function(e){var t=this.cell;if(!1!==Object(P.isHave)(t.depend))for(var r=0;r<t.depend.length;r++){var n=t.depend[r],i=G(Object(L.expr2xy)(n),2),a=i[0];e(i[1],a)}}}])&&q(t.prototype,r),n&&q(t,n),e}();function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text="",this.depend=[],this.formulas="",this.style=null,this.merge=null,this.formatText=null,this.multivalueRefsCell=null,this.source_v=null}var t,r,n;return t=e,(r=[{key:"setCell",value:function(e){Object(P.isHave)(e)&&(Object(P.isHave)(e.text)&&(this.text=e.text),Object(P.isHave)(e.formulas)&&(this.formulas=e.formulas),Object(P.isHave)(e.formatText)&&(this.formatText=e.formatText),Object(P.isHave)(e.depend)&&(this.depend=e.depend),Object(P.isHave)(e.style)&&(this.style=e.style),Object(P.isHave)(e.multivalueRefsCell)&&(this.multivalueRefsCell=e.multivalueRefsCell),Object(P.isHave)(e.merge)&&(this.merge=e.merge),Object(P.isHave)(e.source_v)&&(this.source_v=e.source_v))}},{key:"setFormatText",value:function(e){e.state&&(this.formatText=e.text)}}])&&K(t.prototype,r),n&&K(t,n),e}();function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function J(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var re=r(189);function ne(e){return!(!e||"="!==e[0])}function ie(e,t,r,n,i,a,o,l){var s=this.getCellByTopCell(e,r,n,"other",l,0),u=s.text,c=s.formulas,f=""!=c?c:u;this.isFormula(f)?this.calcFormulaCellByTopCell(f,t,e,r,n,a):this.calcCellByTopCell(a,i,s,t,n,f,e,u)}function ae(e,t,r,n,i,a,o,l){var s="";n?i=Math.abs(i):i*=-1,l?s=this.getCellByTopCell(e,r,n):(s={text:e.v,formulas:e.v},i=0),this.calcNumberCellByTopCell(s,i,t,e,a,o)}function oe(e,t,r,n,i,a,o){var l=t,s="",u=r?1:-1;o?s=this.getCellByTopCell(e,l,r,"date"):(s={text:e.v,formulas:e.v},u=0),this.calcDateCellByTopCell(s,n,e,r,i,a,u)}var le=function(){function e(t){var r=t.len,n=t.height,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.height=n,this.data=i,this.pasteProxy=new Y,this.workbook=null}var t,r,n;return t=e,(r=[{key:"getHeight",value:function(e){var t=this.get(e);return t&&t.height?t.height:this.height}},{key:"setHeight",value:function(e,t){this.getOrNew(e).height=t}},{key:"setStyle",value:function(e,t){this.getOrNew(e).style=t}},{key:"sumHeight",value:function(e,t,r){var n=this;return P.default.rangeSum(e,t,(function(e){return r&&r.has(e)?0:n.getHeight(e)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(e){return this._[e]}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{cells:{}},this._[e]}},{key:"getCell",value:function(e,t){var r=this.get(e);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[t]&&(Object(P.isHave)(r.cells[t].text)||Object(P.isHave)(r.cells[t].formulas)||Object(P.isHave)(r.cells[t].style||"object"===ee(r.cells[t])))?r.cells[t]:null}},{key:"getCellMerge",value:function(e,t){var r=this.getCell(e,t);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(e,t){var r=this.getOrNew(e);return r.cells[t]=r.cells[t]||{},r.cells[t]}},{key:"toString",value:function(e){return!1===Object(P.isHave)(e)&&(e=""),e+""}},{key:"isBackEndFunc",value:function(e){return-1!=e.indexOf("MD.RTD")}},{key:"isReferOtherSheet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(!e.formulas||"="!=e.formulas[0]||!t&&!Object(F.isSheetVale)(e.formulas))}},{key:"isEmpty",value:function(e){return!e||!(e.text||e.formulas||e.depend)}},{key:"isFormula",value:function(e){return ne(e)}},{key:"setValue",value:function(e,t,r){r[e]=t}},{key:"setCell",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.data,a=this.getOrNew(e),o=new Z;if(o.setCell(r),"all"===n)a.cells[t]=o;else if("formulas"===n)a.cells[t]=a.cells[t]||{},a.cells[t].formulas=o.formulas;else if("text"===n)a.cells[t]=a.cells[t]||{},a.cells[t].text=o.text;else if("format"===n)a.cells[t]=a.cells[t]||{},a.cells[t].style=o.style,r.merge&&(a.cells[t].merge=o.merge);else if("date"===n||"datetime"===n)Object(P.isHave)(a.cells[t])||(a.cells[t]={}),this.isFormula(r.formulas)?a.cells[t].formulas=o.formulas:a.cells[t].formulas=o.text,a.cells[t].text=o.text,a.cells[t].style=o.style,a.cells[t].to_calc_num=o.to_calc_num;else if("normal"===n||"number"===n)Object(P.isHave)(a.cells[t])||(a.cells[t]={}),this.isFormula(r.formulas)?a.cells[t].formulas=o.formulas:a.cells[t].formulas=o.text,a.cells[t].text=o.text,a.cells[t].style=o.style;else if("rmb"===n||"percent"===n)Object(P.isHave)(a.cells[t])||(a.cells[t]={}),a.cells[t].text=o.text,a.cells[t].formulas=o.formulas,a.cells[t].style=o.style;else{if("all_with_no_workbook"===n)return void(a.cells[t]=o);if("style"===n)return Object(P.isHave)(a.cells[t])||(a.cells[t]={}),void(a.cells[t].style=o.style)}this.getDependCell(Object(L.xy2expr)(t,e),this.getCell(e,t)),o.setFormatText(i.tryParseToNum(o,e,t))}},{key:"getDependCell",value:function(e,t){var r=t.formulas;if(!1!==Object(P.isHave)(r)&&ne(r)){for(var n=Object(F.cutStr)(r,!0,!0),i=0;i<n.length;i++){var a,o=this.mergeCellExpr(n[i]);o.state&&(a=n).push.apply(a,J(o.mergeArr))}n=Object(F.distinct)(n),!1===Object(P.isHave)(t.depend)&&(t.depend=[]);for(var l=0;l<n.length;l++){var s=n[l],u=Q(Object(L.expr2xy)(s),2),c=u[0],f=u[1],h=this.getCell(f,c);!1===Object(P.isHave)(h)&&(h={}),!1===Object(P.isHave)(h.depend)&&(h.depend=[]),h.depend.push(e),h.depend=Object(F.distinct)(h.depend),this.setCell(f,c,h,"all_with_no_workbook")}}}},{key:"mergeCellExpr",value:function(e){if(!Object(F.isAbsoluteValue)(e,6))return{state:!1};e=(e=e.replace(/\$/g,"")).split(":");var t=Object(L.expr2xy)(e[0]),r=Object(L.expr2xy)(e[1]);if(t[0]>r[0]){var n=r[0];r[0]=t[0],t[0]=n}if(t[1]>r[1]){var i=r[1];r[1]=t[1],t[1]=i}var a=new E.b(t[1],t[0],r[1],r[0]),o=[];return a.each((function(e,t){o.push(Object(L.xy2expr)(t,e))})),{state:!0,mergeArr:o}}},{key:"useOne",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!1===Object(P.isHave)(e)?t:r&&this.isFormula(e)?t:e}},{key:"setCellText",value:function(e,t,r){var n=r.text,i=r.style,a=r.formulas,o=r.merge,l=void 0===o?"":o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all";if("all_with_no_workbook"!==s){var u=this.getCellOrNew(e,t),c=new Z;c.setCell(u),"style"===s?(c.style=i,c.formulas=n):"format"===s?(c.formulas=u.formulas,c.style=i):"cell"===s?(c.style=i,c.formulas=a,c.merge=void 0,""!==l&&(c.merge=l)):c.formulas=n,c.text=n,this.setCell(e,t,c),this.getDependCell(Object(L.xy2expr)(t,e),this.getCell(e,t))}else this.setCell(e,t,{},"all_with_no_workbook")}},{key:"setCellAll",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],this.getCellOrNew(e,t)),a=new Z;a.formulas=""==n?i.formulas:n,a.text=r,this.setCell(e,t,a,"formulas"),this.setCell(e,t,a,"text"),this.getDependCell(Object(L.xy2expr)(t,e),this.getCell(e,t))}},{key:"moveChange",value:function(e,t,r){var n=this;if(e.length==t.length||r.length==t.length)for(var i=function(i){var a=e[i].expr;e[i].each((function(e,o){var l=n.getCell(e,o);!1===Object(P.isHave)(l)&&(l={}),Object(P.isHave)(l.formulas)||(l.formulas="");var s=Object(F.changeFormula)(Object(F.cutStr)(l.formulas));if(-1!=s.indexOf(a)){var u=r[i].expr.replace(/\$/g,"\\$");n.setCellAll(e,o,l.text.replace(new RegExp(u,"g"),t[i].expr),l.formulas.replace(u,t[i].expr))}else{var c=Object(F.value2absolute)(a),f=Object(F.value2absolute)(t[i].expr);-1!=s.indexOf(c.s3)?((c=Object(F.value2absolute)(r[i].expr)).s3=c.s3.replace(/\$/g,"\\$"),n.setCellAll(e,o,l.text.replace(new RegExp(c.s3,"g"),f.s3),l.formulas.replace(new RegExp(c.s3,"g"),f.s3))):-1!=s.indexOf(c.s2)?((c=Object(F.value2absolute)(r[i].expr)).s2=c.s2.replace(/\$/g,"\\$"),n.setCellAll(e,o,l.text.replace(new RegExp(c.s2,"g"),f.s2),l.formulas.replace(new RegExp(c.s2,"g"),f.s2))):-1!=s.indexOf(c.s1)&&((c=Object(F.value2absolute)(r[i].expr)).s1=c.s1.replace(/\$/g,"\\$"),n.setCellAll(e,o,l.text.replace(new RegExp(c.s1,"g"),f.s1),l.formulas.replace(new RegExp(c.s1,"g"),f.s1)))}}))},a=0;a<e.length;a++)i(a)}},{key:"formatMoney",value:function(e,t){if(/[^0-9\.]/.test(e))return"0";if(null==e||""==e)return"0";e=(e=((e=e.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var r=/(\d)(\d{3},)/;r.test(e);)e=e.replace(r,"$1,$2");if(e=e.replace(/,(\d\d)$/,".$1"),0==t){var n=e.split(".");"00"==n[1]&&(e=n[0])}return e}},{key:"getCellStyleConvert",value:function(e,t){return e&&e.format&&"number"===e.format?"number":e&&e.format&&"rmb"===e.format?"rmb":e&&e.format&&"normal"===e.format?"normal":e&&e.format&&"percent"===e.format?"percent":e&&e.format&&"datetime"===e.format?"datetime":t&&!Object(P.isHave)(e)||t&&e&&"normal"!==e.format||e&&e.format&&"date"===e.format?"date":""}},{key:"getCellTextIsAdd",value:function(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7?arguments[7]:void 0,s=!1,u="";return e&&(t<=r[1]&&n&&l?(u=Object(L.xy2expr)(r[0]+i,r[1]+a,o),s=!0):t<=r[1]&&!n&&l?(u=Object(L.xy2expr)(r[0]+i,r[1]+a,o),s=!0):t<=r[0]&&n&&!1===l&&(u=Object(L.xy2expr)(r[0]+i,r[1]+a,o),s=!0)),{enter:s,data:u}}},{key:"eachRange",value:function(e){var t=this,r=[];return e.each((function(e,n){var i,a,o,l=t.getCell(e,n);if(Object(P.isHave)(l)){var s=(i=l,!(Object(P.isHave)(i)&&""!==i||Object(P.isHave)(a)&&""!==a||Object(P.isHave)(o)));l=Object(F.deepCopy)(l);var u=new $(e,n,l,Object(L.xy2expr)(e,n),s);r.push(u)}else{var c=new $(e,n,l={},Object(L.xy2expr)(e,n),!0);r.push(c)}})),r}},{key:"getCellTextByShift",value:function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=!1,s=!1,u="",c=0;c<e.length;c++){if("string"==typeof e[c]&&(e[c]=e[c].toUpperCase()),-1!=e[c].search(/^[A-Z]+\d+$/)){var f=Object(L.expr2xy)(e[c]);(f[0]+t<0||f[1]+r<0)&&(l=!0);var h=this.getCellTextIsAdd(n,a,f,i,t,r,0,o);h.enter?e[c]=h.data:!1===n&&(e[c]=Object(L.xy2expr)(f[0]+t,f[1]+r)),s=!0}else if(-1!=e[c].search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var p=e[c].split(":")[0],v=e[c].split(":")[1],d=Object(L.expr2xy)(p),g=Object(L.expr2xy)(v);(d[0]+t<0||d[1]+r<0)&&(l=!0),(g[0]+t<0||g[1]+r<0)&&(l=!0);var m="",y=this.getCellTextIsAdd(n,a,d,i,t,r,0,o);m=y.enter?y.data+":":0==n?Object(L.xy2expr)(d[0]+t,d[1]+r)+":":p+":",(y=this.getCellTextIsAdd(n,a,g,i,t,r,0,o)).enter?m+=y.data:m+=0==n?Object(L.xy2expr)(g[0]+t,g[1]+r):v,s=!0,e[c]=m}else{var b=Object(F.isAbsoluteValue)(e[c],5);if(2===b){var w=Object(L.expr2xy)(e[c].replace(/\$/g,""));(w[0]+t<0||w[1]+r<0)&&(l=!0);var x=this.getCellTextIsAdd(n,a,w,i,t,r,2,o);x.enter?e[c]=x.data:!1===n&&(e[c]=Object(L.xy2expr)(w[0]+t,w[1],2)),s=!0}else if(1===b){var E=Object(L.expr2xy)(e[c].replace(/\$/g,""));(E[0]+t<0||E[1]+r<0)&&(l=!0);var O=this.getCellTextIsAdd(n,a,E,i,t,r,1,o);O.enter?e[c]=O.data:!1===n&&(e[c]=Object(L.xy2expr)(E[0],E[1]+r,1)),s=!0}else if(4===b){var C=e[c].split(":");console.log(e[c],C);for(var k=0;k<C.length;k++){var N=Object(L.expr2xy)(C[k].replace(/\$/g,""));(N[0]+t<0||N[1]+r<0)&&(l=!0);var T=this.getCellTextIsAdd(n,a,N,i,t,r,2,o);T.enter?C[k]=T.data:!1===n&&(C[k]=Object(L.xy2expr)(N[0]+t,N[1],2))}e[c]=C.join(":"),s=!0}else if(5===b){for(var A=e[c].split(":"),I=0;I<A.length;I++){var S=Object(L.expr2xy)(A[I].replace(/\$/g,""));if((S[0]+t<0||S[1]+r<0)&&(l=!0),1===I){var j=this.getCellTextIsAdd(n,a,S,i,t,r,1,o);j.enter?A[I]=j.data:!1===n&&(A[I]=Object(L.xy2expr)(S[0],S[1]+r,1))}else{var M=this.getCellTextIsAdd(n,a,S,i,t,r,2,o);M.enter?A[I]=M.data:!1===n&&(A[I]=Object(L.xy2expr)(S[0],S[1]+r,2))}}e[c]=A.join(":"),s=!0}else if(7===b){for(var R=e[c].split(":"),D=0;D<R.length;D++){var _=Object(L.expr2xy)(R[D].replace(/\$/g,""));(_[0]+t<0||_[1]+r<0)&&(l=!0);var P=this.getCellTextIsAdd(n,a,_,i,t,r,1,o);P.enter?R[D]=P.data:!1===n&&(R[D]=Object(L.xy2expr)(_[0],_[1]+r,1))}e[c]=R.join(":"),s=!0}else if(6===b){for(var H=e[c].split(":"),B=0;B<H.length;B++){var V=Object(L.expr2xy)(H[B].replace(/\$/g,""));if((V[0]+t<0||V[1]+r<0)&&(l=!0),0===B){var z=this.getCellTextIsAdd(n,a,V,i,t,r,1,o);z.enter?H[B]=z.data:!1===n&&(H[B]=Object(L.xy2expr)(V[0],V[1]+r,1))}else{var U=this.getCellTextIsAdd(n,a,V,i,t,r,2,o);U.enter?H[B]=U.data:!1===n&&(H[B]=Object(L.xy2expr)(V[0]+t,V[1],2))}}e[c]=H.join(":"),s=!0}else if(8===b){for(var Y=e[c].split(":"),W=0;W<Y.length;W++){var X=Object(L.expr2xy)(Y[W].replace(/\$/g,""));if((X[0]+t<0||X[1]+r<0)&&(l=!0),0===W){var G=this.getCellTextIsAdd(n,a,X,i,t,r,0,o);G.enter?Y[W]=G.data:!1===n&&(Y[W]=Object(L.xy2expr)(X[0]+t,X[1]+r,0))}else{var q=this.getCellTextIsAdd(n,a,X,i,t,r,1,o);q.enter?Y[W]=q.data:!1===n&&(Y[W]=Object(L.xy2expr)(X[0]+t,X[1],1))}}e[c]=Y.join(":"),s=!0}else if(9===b){for(var $=e[c].split(":"),K=0;K<$.length;K++){var Z=Object(L.expr2xy)($[K].replace(/\$/g,""));if((Z[0]+t<0||Z[1]+r<0)&&(l=!0),0===K){var Q=this.getCellTextIsAdd(n,a,Z,i,t,r,1,o);Q.enter?$[K]=Q.data:!1===n&&($[K]=Object(L.xy2expr)(Z[0]+t,Z[1]+r,0))}else{var J=this.getCellTextIsAdd(n,a,Z,i,t,r,2,o);J.enter?$[K]=J.data:!1===n&&($[K]=Object(L.xy2expr)(Z[0]+t,Z[1],2))}}e[c]=$.join(":"),s=!0}else if(10===b){for(var ee=e[c].split(":"),te=0;te<ee.length;te++){var re=Object(L.expr2xy)(ee[te].replace(/\$/g,""));if((re[0]+t<0||re[1]+r<0)&&(l=!0),1===te){var ne=this.getCellTextIsAdd(n,a,re,i,t,r,0,o);ne.enter?ee[te]=ne.data:!1===n&&(ee[te]=Object(L.xy2expr)(re[0]+t,re[1]+r,0))}else{var ie=this.getCellTextIsAdd(n,a,re,i,t,r,2,o);ie.enter?ee[te]=ie.data:!1===n&&(ee[te]=Object(L.xy2expr)(re[0]+t,re[1],2))}}e[c]=ee.join(":"),s=!0}else if(11===b){for(var ae=e[c].split(":"),oe=0;oe<ae.length;oe++){var le=Object(L.expr2xy)(ae[oe].replace(/\$/g,""));if((le[0]+t<0||le[1]+r<0)&&(l=!0),1===oe){var se=this.getCellTextIsAdd(n,a,le,i,t,r,0,o);se.enter?ae[oe]=se.data:!1===n&&(ae[oe]=Object(L.xy2expr)(le[0]+t,le[1]+r,0))}else{var ue=this.getCellTextIsAdd(n,a,le,i,t,r,1,o);ue.enter?ae[oe]=ue.data:!1===n&&(ae[oe]=Object(L.xy2expr)(le[0]+t,le[1],1))}}e[c]=ae.join(":"),s=!0}}u+=e[c]}return{bad:l,enter:s,result:u}}},{key:"autoFilterRef",value:function(e,t){for(var r=Q(Object(L.expr2xy)(e),2),n=r[0],i=r[1],a=this.getCell(i,n);null!==a;)i+=1,a=this.getCell(i,n);return t.eri=i,t}},{key:"getAllDataType",value:function(e){var t=this,r=(this.pasteProxy,!0),n=!0,i=[];return e.each((function(e,a){var o=!1,l=t.getCell(e,a);if(l){l=Object(F.deepCopy)(l);var s=new X(l).getCellDataType(i,{isDate:n,isNumber:r});n=s.isDate,r=s.isNumber}else o=!0,r=!1,n=!1;o&&i.push({text:0,formulas:0,tmp:"",type:"other"})})),{isDate:n,isNumber:r,sarr:i}}},{key:"calcNumberCellByTopCell",value:function(e,t,r,n,i,a){var o=e.text,l=e.formulas;o=this.toString(o),l=this.toString(l);var s={};if(this.isFormula(l)){var u=1*o.replace("=","")+t;s={text:"="+u,formulas:"="+u}}else if(""!==o){var c=1*o;if(-1!=o.indexOf(",")){c=c.replace(/,/g,"");var f=parseFloat(c)+t;c=this.formatMoney(f,0)}else c+=t;s={text:c+"",formulas:c+""}}this.copyRender(r,n.ri,n.ci,s,i,a)}},{key:"calcFormulaCellByTopCell",value:function(e,t,r,n,i,a){var o=Object(F.splitStr)(e),l=this.getRangeByTopCell({ri:r.ri,ci:r.ci},n,i),s=r.ri-l.ri,u=r.ci-l.ci,c=this.getCellTextByShift(o,u,s),f=c.bad,h=c.result;this.updateCellReferenceByShift(f,h,r.ri,r.ci,a)}},{key:"calcCellByTopCell",value:function(e,t,r,n,i,a,o,l){if(Object(P.isHave)(a)||(a=""),isNaN(a)){var s=this.toString(a).split(/\d+/g);if(s){var u=0;r.text=i?a.replace(/\d+/g,(function(e){return u+=1,s.length-1===u?1*e+1:e})):a.replace(/\d+/g,(function(e){return u+=1,s.length-1===u?1*e-1:e})),r.formulas=r.text}}else r.text=a,r.formulas=r.text;this.copyRender(n,o.ri,o.ci,r,t,e)}},{key:"calcDateCellByTopCell",value:function(e,t,r,n,i,a,o){if(""!=e.text){var l=e.text,s="";s=B()(l).add(o,"day").format("YYYY-MM-DD"),e.text=this.toString(s),e.formulas=this.toString(s),this.copyRender(t,r.ri,r.ci,e,i,a)}}},{key:"getRangeByTopCell",value:function(e,t,r){var n=e.ri,i=e.ci;return r?(n=t?n:n-1,i=t?i-1:i):(n=t?n:n+1,i=t?i+1:i),{ri:n,ci:i}}},{key:"getCellByTopCell",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(arguments.length>5&&void 0!==arguments[5]&&arguments[5],"date"!==n){var a=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},t,r),o=a.ri,l=a.ci;return this.getCellByCell(o,l)}if(1===t){var s=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},!1,r),u=s.ri,c=s.ci;return this.getCellByCell(u,c)}return 2===t?this.getCellByCell(e.ri,e.ci-1):3===t?this.getCellByCell(e.ri,e.ci+1):void 0}},{key:"getCellByCell",value:function(e,t){var r=this.getCell(e,t);return r||(r={text:"",formulas:""}),P.default.cloneDeep(r)}},{key:"updateCellReferenceByShift",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a={};e?(a.text="#REF!",a.formulas="#REF!"):(a.text=""!=t?t:innerText,a.formulas=""!=t?t:innerText),this.setCell(r,n,a,"all"),i(r,n,a)}},{key:"copyPaste",value:function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},i=this.pasteProxy;i.setSrcAndDstCellRange(e,t);for(var a=i.use(),o=a.rn,l=a.cn,s=i.autoFilterDirection(),u=s?o:l,c=0;c<u;c++){for(var f=i.upOrDown(),h=i.getOneDRangeObj(s,c),p=h.srcOneDRange,v=h.dstOneDRange,d=this.getAllDataType(p),g=d.isNumber,m=d.isDate,y=d.sarr,b=v.getLocationArray(y),w=i.leftOrRight(),x=!1,E=0;E<b.length;E++){var O=b[E];(g||"number"===O.type||m||"date"===O.type)&&(x=!0)}if(f)for(var C=0;C<b.length;C++){var k=b[C];if(g||"number"===k.type){var N=i.calcDiff(y,f);ae.call(this,b[C],b,s,f,N,r,n,g)}else m||"date"===k.type?oe.call(this,b[C],w,f,b,r,n,m):ie.call(this,b[C],b,s,f,r,n,x,y.length-1)}else for(var T=b.length-1;T>=0;T--){var A=b[T];if(g||"number"===A.type){var I=i.calcDiff(y,f);ae.call(this,b[T],b,s,f,I,r,n,g)}else m||"date"===A.type?oe.call(this,b[T],w,f,b,r,n,m):ie.call(this,b[T],b,s,f,r,n,x,y.length-1)}}}},{key:"copyRender",value:function(e,t,r,n,i,a){for(var o=!1,l=0;0==o&&l<e.length;l++)e[l].ri==t&&e[l].ci==r&&(o=!0);o&&(this.setCell(t,r,n,i),a(t,r,n))}},{key:"cutPaste",value:function(e,t){var r=this,n=[];this.each((function(i){r.eachCells(i,(function(a){var o=parseInt(i,10),l=parseInt(a,10);e.includes(i,a)&&(o=t.sri+(o-e.sri),l=t.sci+(l-e.sci)),1*i===o&&1*a===l||""!=r._[i].cells[a].text&&""!=r._[i].cells[a].formulas&&n.push({nri:o,nci:l,ri:i,ci:a,cell:Object(F.deepCopy)(r._[i].cells[a])})}))}));for(var i=0;i<n.length;i++){var a=n[i],o=a.ri,l=a.ci;a.cell,this.setCell(o,l,{},"all")}for(var s=0;s<n.length;s++){var u=n[s],c=u.nri,f=u.nci,h=u.cell;this.setCell(c,f,h,"all")}}},{key:"insert",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={},i=[];this.each((function(a,o){var l=parseInt(a,10);l>=e&&(l+=r,t.eachCells(a,(function(n,a){if(Object(P.isHave)(a)&&Object(P.isHave)(a.formulas)&&t.isFormula(a.formulas)){var o=t.getCellTextByShift(Object(F.splitStr)(a.formulas),0,r,!0,!0,e,!0),s=o.bad,u=o.result;o.enter&&!s&&i.push({ri:l,ci:n,cell:{text:u,formulas:u}})}}))),n[l]=o})),this._=n;for(var a=0;a<i.length;a++){var o=i[a],l=o.ri,s=o.ci,u=o.cell;this.setCell(l,s,u,"all")}this.len+=r}},{key:"delete",value:function(e,t){var r=this,n=t-e+1,i={},a=[];this.each((function(o,l){var s=parseInt(o,10);s<e?i[s]=l:o>t&&(i[s-n]=l,r.eachCells(o,(function(t,i){if(Object(P.isHave)(i)&&Object(P.isHave)(i.formulas)&&r.isFormula(i.formulas)){var o=r.getCellTextByShift(Object(F.splitStr)(i.formulas),0,-1*n,!0,!1,e,!0),l=o.bad,u=o.result;o.enter&&!l&&a.push({ri:s-n,ci:t,cell:{text:u,formulas:u}})}})))})),this._=i;for(var o=0;o<a.length;o++){var l=a[o],s=l.ri,u=l.ci,c=l.cell;this.setCell(s,u,c,"all")}this.len-=n}},{key:"insertColumn",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];this.each((function(i,a){var o={};t.eachCells(i,(function(a,l){var s=parseInt(a,10);if(s>=e&&(s+=r,Object(P.isHave)(l)&&Object(P.isHave)(l.formulas)&&t.isFormula(l.formulas))){var u=t.getCellTextByShift(Object(F.splitStr)(l.formulas),r,0,!0,!0,e,!1),c=u.bad,f=u.result;u.enter&&!c&&n.push({ri:i,ci:s,cell:{text:f,formulas:f}})}o[s]=l})),a.cells=o}));for(var i=0;i<n.length;i++){var a=n[i],o=a.ri,l=a.ci,s=a.cell;this.setCell(o,l,s,"all")}}},{key:"deleteColumn",value:function(e,t){var r=this,n=t-e+1;this.each((function(i,a){var o={};r.eachCells(i,(function(r,i){var a=parseInt(r,10);a<e?o[a]=i:a>t&&(o[a-n]=i)})),a.cells=o}))}},{key:"deleteCells",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";e.each((function(e,n){t.deleteCell(e,n,r)}))}},{key:"deleteCell",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(e);if(null!==n){var i=this.getCell(e,t);null!==i&&("all"===r?delete n.cells[t]:"text"===r?(Object(P.isHave)(i.text)&&delete i.text,Object(P.isHave)(i.value)&&delete i.value,Object(P.isHave)(i.formulas)&&delete i.formulas):"format"===r?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===r&&i.merge&&delete i.merge)}}},{key:"each",value:function(e){Object.entries(this._).forEach((function(t){var r=Q(t,2),n=r[0],i=r[1];e(n,i)}))}},{key:"eachCells",value:function(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((function(e){var r=Q(e,2),n=r[0],i=r[1];t(n,i)}))}},{key:"recast",value:function(e){try{if(this.isReferOtherSheet(e,!0)){var t=new V.default(e.formulas);t.parse(),e.recast=t}else e.recast=null}catch(t){e.recast=null}}},{key:"init",value:function(){var e=this;this.each((function(t,r){e.eachCells(t,(function(r,n){e.getDependCell(Object(L.xy2expr)(r,t),e.getCell(t,r))}))}))}},{key:"setData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{e.len&&(this.len=e.len,delete e.len),this._=e,r||""!==t&&(console.time("setData"),n&&(this.init(),this.workbook=re.Rows2Workbook(this),t.toolbar.change("close","")),console.timeEnd("setData"))}catch(e){console.error(e)}}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}}])&&te(t.prototype,r),n&&te(t,n),e}();function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ue=function(){function e(t){var r=t.len,n=t.width,i=t.indexWidth,a=t.minWidth;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.width=n,this.indexWidth=i,this.minWidth=a}var t,r,n;return t=e,(r=[{key:"setData",value:function(e){e.len&&(this.len=e.len,delete e.len),this._=e}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}},{key:"getWidth",value:function(e){var t=this._[e];return t&&t.width?t.width:this.width}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{},this._[e]}},{key:"setWidth",value:function(e,t){this.getOrNew(e).width=t}},{key:"setStyle",value:function(e,t){this.getOrNew(e).style=t}},{key:"sumWidth",value:function(e,t){var r=this;return P.default.rangeSum(e,t,(function(e){return r.getWidth(e)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&se(t.prototype,r),n&&se(t,n),e}();function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var he={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function pe(e,t){var r="";if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];r=c.apply(void 0,["validation.".concat(t)].concat(i))}return[e,r]}var ve=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.required=r,this.value=n,this.type=t,this.operator=i,this.message=""}var t,r,n;return t=e,(r=[{key:"parseValue",value:function(e){var t=this.type;return"date"===t?new Date(e):"number"===t?Number(e):e}},{key:"equals",value:function(e){var t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?P.default.arrayEquals(this.value,e.value):this.value===e.value),t}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(e){var t=this.required,r=this.operator,n=this.value,i=this.type;if(t&&/^\s*$/.test(e))return pe(!1,"required");if(/^\s*$/.test(e))return[!0];if(he[i]&&!he[i].test(e))return pe(!1,"notMatch");if("list"===i)return pe(this.values().includes(e),"notIn");if(r){var a=this.parseValue(e);if("be"===r){var o=ce(n,2),l=o[0],s=o[1];return pe(a>=this.parseValue(l)&&a<=this.parseValue(s),"between",l,s)}if("nbe"===r){var u=ce(n,2),c=u[0],f=u[1];return pe(a<this.parseValue(c)||a>this.parseValue(f),"notBetween",c,f)}if("eq"===r)return pe(a===this.parseValue(n),"equal",n);if("neq"===r)return pe(a!==this.parseValue(n),"notEqual",n);if("lt"===r)return pe(a<this.parseValue(n),"lessThan",n);if("lte"===r)return pe(a<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return pe(a>this.parseValue(n),"greaterThan",n);if("gte"===r)return pe(a>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&fe(t.prototype,r),n&&fe(t,n),e}();function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e,t,r){return t&&me(e.prototype,t),r&&me(e,r),e}var be=function(){function e(t,r,n){ge(this,e),this.refs=r,this.mode=t,this.validator=n}return ye(e,[{key:"includes",value:function(e,t){for(var r=this.refs,n=0;n<r.length;n+=1){if(E.a.valueOf(r[n]).includes(e,t))return!0}return!1}},{key:"addRef",value:function(e){this.remove(E.a.valueOf(e)),this.refs.push(e)}},{key:"remove",value:function(e){var t=[];this.refs.forEach((function(r){var n=E.a.valueOf(r);n.intersects(e)?n.difference(e).forEach((function(e){return t.push(e.toString())})):t.push(r)})),this.refs=t}},{key:"getData",value:function(){var e=this.refs,t=this.mode,r=this.validator;return{refs:e,mode:t,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(t){var r=t.refs,n=t.mode,i=t.type,a=t.required,o=t.operator,l=t.value;return new e(n,r,new ve(i,a,l,o))}}]),e}(),we=function(){function e(){ge(this,e),this._=[],this.errors=new Map}return ye(e,[{key:"getError",value:function(e,t){return this.errors.get("".concat(e,"_").concat(t))}},{key:"validate",value:function(e,t,r){var n=this.get(e,t),i="".concat(e,"_").concat(t),a=this.errors;if(null!==n){var o=de(n.validator.validate(r),2),l=o[0],s=o[1];l?a.delete(i):a.set(i,s)}else a.delete(i);return!0}},{key:"add",value:function(e,t,r){var n=r.type,i=r.required,a=r.value,o=r.operator,l=new ve(n,i,a,o),s=this.getByValidator(l);null!==s?s.addRef(t):this._.push(new be(e,[t],l))}},{key:"getByValidator",value:function(e){for(var t=0;t<this._.length;t+=1){var r=this._[t];if(r.validator.equals(e))return r}return null}},{key:"get",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"remove",value:function(e){this.each((function(t){t.remove(e)}))}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"getData",value:function(){return this._.filter((function(e){return e.refs.length>0})).map((function(e){return e.getData()}))}},{key:"setData",value:function(e){this._=e.map((function(e){return be.valueOf(e)}))}}]),e}();function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="move"}var t,r,n;return t=e,(r=[{key:"move",value:function(e){return this.range=e,this.state="move",this}}])&&xe(t.prototype,r),n&&xe(t,n),e}(),Oe=[];function Ce(e,t,r){e.addEventListener(t,r),Oe.push({name:t,fn:r,target:e})}function ke(){for(var e=0;e<Oe.length;e++){var t=Oe[e];Ne(t.target,t.name,t.fn)}}function Ne(e,t,r){e.removeEventListener(t,r)}function Te(e){e.xclickoutside&&(Ne(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function Ae(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keydown",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=document.createEvent("HTMLEvents");i.initEvent(r,!0,!0),i.eventType="message",i.buttons=n,i.keyCode=e,i.metaKey=t,document.dispatchEvent(i)}function Ie(e,t){e.xclickoutside=function(r){2===r.detail||e.contains(r.target)||(t?t(e):(e.hide(),Te(e)))},Ce(window.document.body,"click",e.xclickoutside)}function Se(e,t,r){Ce(e,"mousemove",t),e.xEvtUp=function(n){Ne(e,"mousemove",t),Ne(e,"mouseup",e.xEvtUp),r(n)},Ce(e,"mouseup",e.xEvtUp)}function je(e,t,r,n){Math.abs(e)>Math.abs(t)?n(e>0?"right":"left",e,r):n(t>0?"down":"up",t,r)}var Me=r(0);function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var De=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.moving=!1,this.vertical=r,this.el=o("div","".concat(Me.a,"-resizer ").concat(r?"vertical":"horizontal")).children(this.hoverEl=o("div","".concat(Me.a,"-resizer-hover")).on("mousedown.stop",(function(e){return t.mousedownHandler(e)})),this.lineEl=o("div","".concat(Me.a,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n}var t,r,n;return t=e,(r=[{key:"show",value:function(e,t){var r=this.moving,n=this.vertical,i=this.hoverEl,a=this.lineEl,o=this.el;if(!r){this.cRect=e;var l=e.left,s=e.top,u=e.width,c=e.height;o.offset({left:n?l+u-5:l,top:n?s:s+c-5}).show(),i.offset({width:n?5:u,height:n?c:5}),a.offset({width:n?0:t.width,height:n?t.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(e){var t=this,r=e,n=this.el,i=this.lineEl,a=this.cRect,o=this.vertical,l=this.minDistance,s=o?a.width:a.height;i.show(),Se(window,(function(e){t.moving=!0,null!==r&&1===e.buttons&&(o?(s+=e.movementX)>l&&n.css("left","".concat(a.left+s,"px")):(s+=e.movementY)>l&&n.css("top","".concat(a.top+s,"px")),r=e)}),(function(){r=null,i.hide(),t.moving=!1,t.hide(),t.finishedFn&&(s<l&&(s=l),t.finishedFn(a,s))}))}}])&&Re(t.prototype,r),n&&Re(t,n),e}();function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pe=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertical=t,this.moveFn=null,this.el=o("div","".concat(Me.a,"-scrollbar ").concat(t?"vertical":"horizontal")).child(this.contentEl=o("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(e){var t=e.target,n=t.scrollTop,i=t.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:i,e)}))}var t,r,n;return t=e,(r=[{key:"move",value:function(e){return this.el.scroll(e),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(e,t){var r=e-1;if(t>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(t,"px"))}else this.el.hide();return this}}])&&_e(t.prototype,r),n&&_e(t,n),e}();function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=o("div","".concat(Me.a,"-selector-cell")),this.data=t,this._=new E.a(0,0,0,0)}var t,r,n;return t=e,(r=[{key:"resetSelectOffset",value:function(){var e=this.data.getRect(this._);this.setOffset(e)}},{key:"setData",value:function(e,t){var r=this;e=-1===e?0:e,t=-1===t?0:t;var n=this.data.merges;console.log(this._);var i=!1;n.each((function(n){n.includeByRiCi(e,t)&&(r._=n,i=!0)})),i||(this._=new E.a(e,t,e,t))}},{key:"toolbarChangeSelectorCell",value:function(){var e=this._.sri,t=this._.sci;this.setData(e,t)}},{key:"setOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.el.offset({width:n-ze+.8,height:i-ze+.8,left:t-.8,top:r-.8}).show()}}])&&Le(t.prototype,r),n&&Le(t,n),e}();function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ve(e,t,r){return t&&Be(e.prototype,t),r&&Be(e,r),e}var ze=3,Ue=10,Ye=function(){function e(t,r,n){var i=this;He(this,e),this.cornerEl=o("div","".concat(Me.a,"-selector-corner")),this.data=t,this.sheet=n,this._selector=r,this.l=o("div","".concat(Me.a,"-selector-box-l")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():i.moveEvent(1)})),this.r=o("div","".concat(Me.a,"-selector-box-r")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():i.moveEvent(2)})).on("click",(function(e){2===e.detail&&e.stopPropagation()})),this.t=o("div","".concat(Me.a,"-selector-box-t")).on("mousedown.stop",(function(e){e.detail,e.stopPropagation(),i.moveEvent(3)})),this.b=o("div","".concat(Me.a,"-selector-box-b")).on("mousedown.stop",(function(e){2===e.detail?e.stopPropagation():i.moveEvent(4)})),this.cornerEl.on("mousedown",(function(e){2===e.detail&&(n.clickCopyPaste(),e.stopPropagation())})),this.boxinner=o("div","".concat(Me.a,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.areaEl=o("div","".concat(Me.a,"-selector-area")).children(this.cornerEl,this.boxinner).hide(),this.clipboardEl=o("div","".concat(Me.a,"-selector-clipboard")).hide(),this.autofillEl=o("div","".concat(Me.a,"-selector-autofill")).hide(),this.el=o("div","".concat(Me.a,"-selector")).css("z-index","".concat(Ue)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),Ue+=1}return Ve(e,[{key:"border",value:function(e){this.areaEl.css("border",e)}},{key:"longTimeBefore",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.boxinner.hide(),setTimeout((function(){e.boxinner.show()}),t)}},{key:"moveEvent",value:function(e){console.log(60);var t=this.data,r=this._selector,n=this.sheet,i=t.selector,a=r.range,o=a.sri,l=a.sci,s=a.eri,u=a.eci,c=a.w,f=a.h,h=new E.a(o,l,s,u,c,f),p=new E.a(o,l,s,u,c,f),v=n.selectorMoveEl;v.set(-1,-1,!0),v.hide(),Se(window,(function(e){n.container.css("pointer-events","none"),r.setBoxinner("none");var i=t.getCellRectByXY(e.layerX,e.layerY),a=i.ri,h=i.ci;if(-1!==a&&-1!==h){(p=new E.a(o,l,s,u,c,f)).move(a,h);var d=t.getMoveRect(p);v.range=p,v.setMove(d),v.el.show()}}),(function(e){var a=t.rows,o=[],l=[],s=[];h.each((function(e,t){console.log(a.getCell(e,t),e,t);var r=a.getCell(e,t),n=new $(e,t,Object(F.deepCopy)(r||{}),"".concat(Object(L.xy2expr)(t,e),":").concat(Object(L.xy2expr)(t,e))),i=new $(e,t,Object(F.deepCopy)(r||{}),"".concat(Object(L.xy2expr)(t,e)));o.push(n),s.push(i)})),p.each((function(e,t){var r=new $(e,t,Object(F.deepCopy)(a.getCell(e,t)||{}),Object(L.xy2expr)(t,e));l.push(r)})),t.cutPaste(h,p,!1),n.container.css("pointer-events","auto"),r.setBoxinner("auto"),v.hide();var u=t.getMoveRect(p);i.range=p,i.ci=p.sci,i.ri=p.sri,r.indexes=[i.ri,i.ci],r.moveIndexes=[p.sri,p.sci],r.range=p,r.setMove(u),n.selector.selectCell.setData(p.sri,p.sci),console.time("move"),a.moveChange(o,l,s),console.timeEnd("move"),n.selectorMoveReset()}))}},{key:"setCss",value:function(e){this.areaEl.css("border","2px dashed ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.cornerEl.css("pointer-events",e)}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-ze+.8,height:i-ze+.8,left:t-.8,top:r-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-ze,height:i-ze,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function We(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,l=e.l,s=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>l&&(f-=o.x);var h=n-c;return c>s&&(h-=o.y),{left:f,top:h,width:i,height:a}}function Xe(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,l=e.scroll,s=t.freezeTotalWidth(),u=r-s;return s>a&&(u-=l.x),{left:u,top:o,width:n,height:i}}function Ge(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,l=e.scroll,s=t.freezeTotalHeight(),u=r-s;return s>o&&(u-=l.y),{left:a,top:u,width:n,height:i}}function qe(e){this.br.setAreaOffset(We.call(this,e))}function $e(e){this.tl.setAreaOffset(e)}function Ke(e){this.t.setAreaOffset(Xe.call(this,e))}function Ze(e){this.l.setAreaOffset(Ge.call(this,e))}function Qe(e){this.l.setClipboardOffset(Ge.call(this,e))}function Je(e){this.br.setClipboardOffset(We.call(this,e))}function et(e){this.tl.setClipboardOffset(e)}function tt(e){this.t.setClipboardOffset(Xe.call(this,e))}function rt(e){qe.call(this,e),$e.call(this,e),Ke.call(this,e),Ze.call(this,e)}function nt(e){Je.call(this,e),et.call(this,e),tt.call(this,e),Qe.call(this,e)}var it=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];He(this,e),this.data=t,this.br=new Ye(t,this,r),this.t=new Ye(t,this,r),this.l=new Ye(t,this,r),this.tl=new Ye(t,this,r),this.sheet=r,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=o("div","".concat(Me.a,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),n?(this.selectCell=new Fe(t,n),this.el.child(this.selectCell.el)):this.selectCell=new Fe(t,n),this.lastri=-1,this.lastci=-1,Ue+=1}return Ve(e,[{key:"longTimeBefore",value:function(){this.tl.longTimeBefore(),this.br.longTimeBefore(),this.t.longTimeBefore(),this.l.longTimeBefore()}},{key:"setCss",value:function(e){this.br.setCss(e),this.t.setCss(e),this.l.setCss(e),this.tl.setCss(e)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br;this.selectCell.resetSelectOffset();var a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();rt.call(this,e),nt.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();qe.call(this,e),Ke.call(this,e),Je.call(this,t),tt.call(this,t),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();qe.call(this,e),Ze.call(this,e),Je.call(this,t),Qe.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();qe.call(this,t),Ze.call(this,t),Je.call(this,r),Qe.call(this,r),this.resetOffset()}},{key:"isMergeCell",value:function(e,t){var r=this.data.isMergeCell(e,t),n=r.data;r.state?(this.selectCell.eri=n.eri,this.selectCell.eci=n.eci):(this.selectCell.eri=e,this.selectCell.eci=t)}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var l=e,s=t;e<0&&(l=0),t<0&&(s=0),n.selector.setIndexes(l,s),this.indexes=[l,s]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"autoFilterRef",value:function(){console.log(this.range)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this.data);this.lastri,this.lastci;r&&(this.lastri=e,this.lastci=t),this.range=n.calSelectedRangeByEnd(e,t),rt.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"reset",value:function(){var e=this.data.selector.range,t=e.eri,r=e.eci,n=e.sci,i=e.sri;this.set(i,n),this.setEnd(t,r,!0,!0)}},{key:"setMove",value:function(e){rt.call(this,e)}},{key:"showAutofill",value:function(e,t,r){if(-1!==e||-1!==t){var n=this.range,i=n.sri,a=n.sci,o=n.eri,l=n.eci,s=0,u=e,c=t;if(2==r)s=11,this.arange=new E.a(i,c,o,a-1);else if(4==r)s=22,this.arange=new E.a(u,a,i-1,l);else if(3==r)s=33,this.arange=new E.a(i,l+1,o,c);else{if(1!=r)return this.arange=null,s;s=44,this.arange=new E.a(o+1,a,u,l)}if(null!==this.arange){var f=this.data.getRect(this.arange);f.width+=2,f.height+=2;var h=this.br,p=this.l,v=this.t,d=this.tl;h.showAutofill(We.call(this,f)),p.showAutofill(Ge.call(this,f)),v.showAutofill(Xe.call(this,f)),d.showAutofill(f)}return s}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();nt.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"showClipboard2",value:function(e){var t=this;nt.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();function at(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lt(e){e.preventDefault(),e.stopPropagation();var t=this.filterItems;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1,this.el.el.scrollTop=this.el.el.scrollHeight),this.el.el.scrollTop=33*(this.itemIndex-9),t[this.itemIndex].toggle())}function st(e){e.stopPropagation();var t=this.filterItems;t.length<=0||t.length<this.itemIndex||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0,this.el.el.scrollTop=0),this.el.el.scrollTop=33*(this.itemIndex-9),console.log(t.length),t[this.itemIndex].toggle())}function ut(e){e.preventDefault();var t=this.filterItems;if(!(t.length<=0)){if(e.stopPropagation(),this.itemIndex<0)return this.itemIndex=0,this.hide(),void Ae.call(this,13,!1);t[this.itemIndex].el.click(),this.hide()}}function ct(e){var t=e.keyCode;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:e.stopPropagation();break;case 38:lt.call(this,e),e.stopPropagation();break;case 39:e.stopPropagation();break;case 40:st.call(this,e),e.stopPropagation();break;case 13:case 9:ut.call(this,e);break;default:e.stopPropagation()}}var ft=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"200px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterItems=[],this.items=t,this.data=n,this.editor=i,this.el=o("div","".concat(Me.a,"-suggest")).css("width",a).css("overflow-y","auto").css("max-height","306px").hide(),this.el.attr("tabindex",0),this.itemClick=r,this.itemIndex=-1,this.show=!1}var t,r,n;return t=e,(r=[{key:"setOffset",value:function(e){this.el.cssRemoveKeys("top","bottom").offset(e)}},{key:"hide",value:function(){var e=this.el;this.filterItems=[],this.itemIndex=-1,e.hide(),this.show=!1,Te(this.el.parent())}},{key:"setItems",value:function(e){this.items=e}},{key:"search",value:function(e){var t,r=this,n=this.items,i=this.data,a=this.editor;if(/^\s*$/.test(e)||(n=n.filter((function(t){return(t.key.toUpperCase()||t.toUpperCase()).startsWith(e.toUpperCase())}))),n=n.map((function(e){var t=e.title;t?"function"==typeof t&&(t=t()):t=e;var n=o("div","".concat(Me.a,"-item")).child(t).on("click.stop",(function(){r.itemClick(e)}));return e.label&&n.child(o("div","label").html(e.label)),n})),this.filterItems=n,n.length<=0)return this.hide(),void(this.show=!1);var l=this.el,s=i.getRect(new E.b(a.ri,a.ci,a.ri,a.ci)),u=s.left+55,c=s.top+50;n.length>=9&&s.top-306>=50&&(c-=306,c-=s.height),l.css("left","".concat(u,"px")),l.css("top","".concat(c,"px")),(t=l.html("")).children.apply(t,at(n)).show(),this.show=!0,Ie(l.parent(),(function(){r.hide(),r.show=!1}))}},{key:"bindInputEvents",value:function(e){var t=this;e.on("keydown",(function(e){return ct.call(t,e)}))}}])&&ot(t.prototype,r),n&&ot(t,n),e}();function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e,t){return!t||"object"!==ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mt=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=vt(this,dt(t).call(this,"div","".concat(Me.a,"-icon")))).iconNameEl=o("div","".concat(Me.a,"-icon-img ").concat(e)),r.child(r.iconNameEl),r}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,e),r=t,(n=[{key:"setName",value:function(e){this.iconNameEl.className("".concat(Me.a,"-icon-img ").concat(e))}}])&&pt(r.prototype,n),i&&pt(r,i),t}(a);function yt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wt(e,t){e.setMonth(e.getMonth()+t)}function xt(e,t){var r=new Date(e);return r.setDate(t-e.getDay()+1),r}var Et=function(){function e(t){var r,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.cvalue=new Date(t),this.headerLeftEl=o("div","calendar-header-left"),this.bodyEl=o("tbody",""),this.buildAll(),this.el=o("div","fin-cell-calendar").children(o("div","calendar-header").children(this.headerLeftEl,o("div","calendar-header-right").children(o("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new mt("chevron-left")),o("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new mt("chevron-right")))),o("table","calendar-body").children(o("thead","").child((r=o("tr","")).children.apply(r,yt(c("calendar.weeks").map((function(e){return o("th","cell").child(e)}))))),this.bodyEl)),this.selectChange=function(){}}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}},{key:"prev",value:function(){wt(this.value,-1),this.buildAll()}},{key:"next",value:function(){wt(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var e=this.value;this.headerLeftEl.html("".concat(c("calendar.months")[e.getMonth()]," ").concat(e.getFullYear()))}},{key:"buildBody",value:function(){var e,t=this,r=this.value,n=this.cvalue,i=this.bodyEl,a=function(e,t,r){for(var n=new Date(e,t,1,23,59,59),i=[[],[],[],[],[],[]],a=0;a<6;a+=1)for(var o=0;o<7;o+=1){var l=xt(n,7*a+o),s=l.getMonth()!==t,u=l.getMonth()===r.getMonth()&&l.getDate()===r.getDate();i[a][o]={d:l,disabled:s,active:u}}return i}(r.getFullYear(),r.getMonth(),n).map((function(e){var r,n=e.map((function(e){var r="cell";return e.disabled&&(r+=" disabled"),e.active&&(r+=" active"),o("td","").child(o("div",r).on("click.stop",(function(){t.selectChange(e.d)})).child(e.d.getDate().toString()))}));return(r=o("tr","")).children.apply(r,yt(n))}));(e=i.html("")).children.apply(e,yt(a))}}])&&bt(t.prototype,r),n&&bt(t,n),e}();function Ot(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.calendar=new Et(new Date),this.el=o("div","".concat(Me.a,"-datepicker")).child(this.calendar.el).hide()}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){var t=this.calendar;return"string"==typeof e?Object(V.l)(V.b).test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}},{key:"change",value:function(e){var t=this;this.calendar.selectChange=function(r){e(r),t.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&Ot(t.prototype,r),n&&Ot(t,n),e}();function kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nt(e,t,r,n){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",l=o("div",n),s=0;s<e[t].length;s++){var u=e[t][s],c=u.name,f=u.editor,h=u.index;r===s?l.child(o("span",i).child(c)):1==f&&r>=h?l.child(o("span",i).child(c)):l.child(o("span",a).child(c))}return l}var Tt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"300px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=o("div","".concat(Me.a,"-suggest-content")).css("width",t).css("z-index","10000").css("position","absolute").hide(),this.el.attr("tabindex",0),Ce(this.el.el,"paste",(function(e){e.stopPropagation()})),Ce(this.el.el,"copy",(function(e){e.stopPropagation()})),Ce(this.el.el,"keydown",(function(e){e.stopPropagation()})),Ce(this.el.el,"keyup",(function(e){e.stopPropagation()}))}var t,r,n;return t=e,(r=[{key:"hide",value:function(){this.el.hide()}},{key:"content",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=this.el;t=t.toUpperCase();var i={};if(Object.keys(F.helpFormula).forEach((function(e){e==t&&(i=F.helpFormula[e])})),i&&"{}"!==JSON.stringify(i)){var a=[],l=Nt.call(this,i,"title",r,"".concat(Me.a,"-help-title"),"".concat(Me.a,"-help-span-title"),"".concat(Me.a,"-help-span2-title")),s=o("div","".concat(Me.a,"-help-section-title")).child("示例"),u=Nt.call(this,i,"example",r,"".concat(Me.a,"-help-section-content"),"".concat(Me.a,"-help-span3-title"));a.push.apply(a,[l,s,u]),Object.keys(i.content).forEach((function(e){var t=i.content[e],r=o("div","".concat(Me.a,"-help-section-title")).child(e),n=o("div","".concat(Me.a,"-help-section-content")).child(t);a.push.apply(a,[r,n])})),(e=n.html("")).children.apply(e,a).show()}}}])&&kt(t.prototype,r),n&&kt(t,n),e}();function At(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var It=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.l=o("div","".concat(Me.a,"-selector-box-l-move-l")),this.r=o("div","".concat(Me.a,"-selector-box-l-move-r")),this.t=o("div","".concat(Me.a,"-selector-box-l-move-t")),this.b=o("div","".concat(Me.a,"-selector-box-l-move-b")),this.data=r,this.sheet=n,this._selector=i,this.event(this.l,1),this.event(this.r,2),this.event(this.t,3),this.event(this.b,4),this.boxinner=t,this.boxinner.children(this.l,this.r,this.t,this.b)}var t,r,n;return t=e,(r=[{key:"find",value:function(e,t,r){return e.lastIndexOf(t)}},{key:"event",value:function(e,t){var r=this,n=null;e.on("mousedown.stop",(function(e){var i=r.data,a=r.sheet,o=r._selector,l=-1,s=i.selector,u=null,c=s.range,f=c.sri,h=c.sci,p=c.eri,v=c.eci,d=c.w,g=c.h,m=new E.a(f,h,p,v,d,g),y=null,b=a.selectors,w=-1,x=-1,O=-1,C=-1;Se(window,(function(s){clearTimeout(n),n=setTimeout((function(){a.container.css("pointer-events","none");for(var n=0;n<b.length;n++)b[n].selector.setBoxinner("none");var c=i.getCellRectByXY(s.layerX,s.layerY),f=c.ri,h=c.ci;if(-1!=f&&-1!=h){var p=r.sheet.editor.pos,v=r.sheet.editor.editorText.getText(),k=Object(F.cuttingByPos)(v,p-1,!0);v.length>p-1&&(k+=Object(F.cuttingByPosEnd)(v,p-1));for(var N=0;N<b.length;N++){var T=b[N],A=T.className,I=T.erpx;if(I===k&&A===o.className+" clear_selector"){if(u=u||T,-1!=I.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var S=I.split(":"),j=Object(L.expr2xy)(S[0]),M=Object(L.expr2xy)(S[1]);(m=new E.a(j[1],j[0],M[1],M[0],d,g)).move(f,h);var R=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(R)}else u.selector.set(f,h,!0);break}if(I!==k&&A===o.className+" clear_selector"){if(l=-1!=l?l:r.find(v,T.erpx,T.index),r.sheet.editor.setCursorPos(l+T.erpx.length),u=u||T,-1!=T.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var D=I.split(":"),_=Object(L.expr2xy)(D[0]),P=Object(L.expr2xy)(D[1]);if(m=new E.a(_[1],_[0],P[1],P[0],d,g),null===y&&(y=m),4===t){var H=i.getCellRectByXY(s.layerX,s.layerY);m.move2(_[1],_[0],H.ri,H.ci);var B=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(B)}else if(1===t){var V=i.getCellRectByXY(s.layerX,s.layerY);m.move2(_[1],V.ci,V.ri,P[0]);var z=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(z)}else if(3===t){var U=i.getCellRectByXY(s.layerX,s.layerY);m.move2(U.ri,U.ci,P[1],P[0]);var Y=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(Y)}else if(2===t){var W=i.getCellRectByXY(s.layerX,s.layerY);m.move2(W.ri,_[0],P[1],W.ci);var X=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(X)}}else{var G=Object(L.expr2xy)(T.erpx),q=Object(L.expr2xy)(T.erpx),$=i.getCellRectByXY(s.layerX,s.layerY);if(4===t){m.move2(G[1],G[0],$.ri,$.ci);var K=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(K)}else if(1===t){m.move2(G[1],$.ci,$.ri,q[0]);var Z=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(Z)}else if(3===t){m.move2($.ri,$.ci,q[1],q[0]);var Q=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(Q)}else if(2===t){m.move2($.ri,G[0],q[1],$.ci);var J=i.getMoveRect(m);u.selector.range=m,u.selector.setMove(J)}}break}}!u||w===m.sri&&x===m.sci&&O===m.eri&&C===m.eci||(u.selector.setCss(u.color,!1),nr.call(r.sheet,e,u,Object(F.isAbsoluteValue)(u.erpx),l)),w=m.sri,x=m.sci,O=m.eri,C=m.eci}}),6)}),(function(e){clearTimeout(n);var t=r.sheet.selectors;a.container.css("pointer-events","auto");for(var i=0;i<t.length;i++)t[i].selector.setBoxinner("all");l=-1,u&&u.selector&&u.selector.setCss(u.color,!0),u=null}))}))}}])&&At(t.prototype,r),n&&At(t,n),e}();function St(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mt(e,t,r){return t&&jt(e.prototype,t),r&&jt(e,r),e}var Rt=10,Dt=function(){function e(t,r,n){var i=this;St(this,e),this.data=t,this._selector=r,this.sheet=n,this.l=o("div","".concat(Me.a,"-selector-box-l")).on("mousedown.stop",(function(e){i.moveEvent(e)})),this.r=o("div","".concat(Me.a,"-selector-box-r")).on("mousedown.stop",(function(e){i.moveEvent(e)})),this.t=o("div","".concat(Me.a,"-selector-box-t")).on("mousedown.stop",(function(e){i.moveEvent(e)})),this.b=o("div","".concat(Me.a,"-selector-box-b")).on("mousedown.stop",(function(e){i.moveEvent(e)})),this.boxinner=o("div","".concat(Me.a,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.selectorMove=new It(this.boxinner,t,n,r),this.areaEl=o("div","".concat(Me.a,"-selector-area")).child(this.boxinner).hide(),this.clipboardEl=o("div","".concat(Me.a,"-selector-clipboard")).hide(),this.autofillEl=o("div","".concat(Me.a,"-selector-autofill")).hide(),this.el=o("div","".concat(Me.a,"-selector")).css("z-index","".concat(Rt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),Rt+=1}return Mt(e,[{key:"find",value:function(e,t,r){return e.lastIndexOf(t)}},{key:"moveEvent",value:function(e){var t=this,r=this.data,n=this._selector,i=this.sheet,a=null,o=r.selector.range,l=o.sri,s=o.sci,u=o.eri,c=o.eci,f=o.w,h=o.h,p=new E.a(l,s,u,c,f,h),v=-1;Se(window,(function(o){var l=t.sheet.selectors;i.container.css("pointer-events","none");for(var s=0;s<l.length;s++){l[s].selector.setBoxinner("none")}var u=r.getCellRectByXY(o.layerX,o.layerY),c=u.ri,d=u.ci;if(-1!=c&&-1!=d){var g=t.sheet.editor.pos,m=t.sheet.editor.editorText.getText(),y=Object(F.cuttingByPos)(m,g-1,!0);if(m.length>g-1)y+=Object(F.cuttingByPosEnd)(m,g-1);for(var b=0;b<l.length;b++){var w=l[b],x=w.className,O=w.erpx;if(O===y&&x===n.className+" clear_selector"){if(a=a||w,-1!=O.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var C=O.split(":"),k=Object(L.expr2xy)(C[0]),N=Object(L.expr2xy)(C[1]);(p=new E.a(k[1],k[0],N[1],N[0],f,h)).move(c,d);var T=r.getMoveRect(p);a.selector.range=p,a.selector.setMove(T)}else a.selector.set(c,d,!0);break}if(O!==y&&x===n.className+" clear_selector"){if(v=-1!=v?v:t.find(m,w.erpx,w.index),t.sheet.editor.setCursorPos(v+w.erpx.length),a=a||w,-1!=w.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var A=O.split(":"),I=Object(L.expr2xy)(A[0]),S=Object(L.expr2xy)(A[1]);(p=new E.a(I[1],I[0],S[1],S[0],f,h)).move(c,d);var j=r.getMoveRect(p);a.selector.range=p,a.selector.setMove(j)}else a.selector.set(c,d,!0);break}}a&&(a.selector.setCss(a.color,!1),nr.call(t.sheet,e,a,Object(F.isAbsoluteValue)(a.erpx),v))}}),(function(e){var r=t.sheet.selectors;i.container.css("pointer-events","auto");for(var n=0;n<r.length;n++){r[n].selector.setBoxinner("all")}v=-1,a&&a.selector&&a.selector.setCss(a.color,!0),a=null}))}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.selectorMove.l.css("pointer-events",e),this.selectorMove.r.css("pointer-events",e),this.selectorMove.t.css("pointer-events",e),this.selectorMove.b.css("pointer-events",e)}},{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.areaEl.css("border","2px dashed ".concat(e)):this.areaEl.css("border","2px solid ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-3+.8,height:i-3+.8,left:t-.8,top:r-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-3,height:i-3,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function _t(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,l=e.l,s=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>l&&(f-=o.x);var h=n-c;return c>s&&(h-=o.y),{left:f,top:h,width:i,height:a}}function Pt(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,l=e.scroll,s=t.freezeTotalWidth(),u=r-s;return s>a&&(u-=l.x),{left:u,top:o,width:n,height:i}}function Lt(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,l=e.scroll,s=t.freezeTotalHeight(),u=r-s;return s>o&&(u-=l.y),{left:a,top:u,width:n,height:i}}function Ft(e){this.br.setAreaOffset(_t.call(this,e))}function Ht(e){this.tl.setAreaOffset(e)}function Bt(e){this.t.setAreaOffset(Pt.call(this,e))}function Vt(e){this.l.setAreaOffset(Lt.call(this,e))}function zt(e){this.l.setClipboardOffset(Lt.call(this,e))}function Ut(e){this.br.setClipboardOffset(_t.call(this,e))}function Yt(e){this.tl.setClipboardOffset(e)}function Wt(e){this.t.setClipboardOffset(Pt.call(this,e))}function Xt(e){Ft.call(this,e),Ht.call(this,e),Bt.call(this,e),Vt.call(this,e)}function Gt(e){Ut.call(this,e),Yt.call(this,e),Wt.call(this,e),zt.call(this,e)}var qt=function(){function e(t,r,n){St(this,e),this.data=t,this.className=n,this.br=new Dt(t,this,r),this.t=new Dt(t,this,r),this.l=new Dt(t,this,r),this.tl=new Dt(t,this,r),this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=o("div","".concat(Me.a,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Rt+=1}return Mt(e,[{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.br.setCss(e,t),this.t.setCss(e,t),this.l.setCss(e,t),this.tl.setCss(e,t)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br,a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();Xt.call(this,e),Gt.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();Ft.call(this,e),Bt.call(this,e),Ut.call(this,t),Wt.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();Ft.call(this,t),Vt.call(this,t),Ut.call(this,r),zt.call(this,r),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();Ft.call(this,e),Vt.call(this,e),Ut.call(this,t),zt.call(this,t),this.resetOffset()}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var l=e,s=t;e<0&&(l=0),t<0&&(s=0),n.selector.setIndexes(l,s),this.indexes=[l,s]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setMove",value:function(e){Xt.call(this,e)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=this.lastri,a=this.lastci;if(r){if(e===i&&t===a)return;this.lastri=e,this.lastci=t}this.range=n.calSelectedRangeByEnd(e,t),Xt.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"reset",value:function(){var e=this.data.selector.range,t=e.eri,r=e.eci;this.setEnd(t,r)}},{key:"showAutofill",value:function(e,t){if(-1!==e||-1!==t){var r=this.range,n=r.sri,i=r.sci,a=r.eri,o=r.eci,l=e,s=t,u=n-e,c=a-e,f=o-t;if(i-t>0)this.arange=new E.a(n,s,a,i-1);else if(u>0)this.arange=new E.a(l,i,n-1,o);else if(f<0)this.arange=new E.a(n,o+1,a,s);else{if(!(c<0))return void(this.arange=null);this.arange=new E.a(a+1,i,l,o)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,v=this.l,d=this.t,g=this.tl;p.showAutofill(_t.call(this,h)),v.showAutofill(Lt.call(this,h)),d.showAutofill(Pt.call(this,h)),g.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();Gt.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"showClipboard2",value:function(e){var t=this;Gt.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();function $t(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Kt=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Zt=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Qt=["#EE0000","#8A2BE2","#FF3E96","#8B4500","#3A5FCD","#FF7F24"];function Jt(e){return e%=Qt.length,{color:Qt[e],index:e}}var er=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function tr(e){var t=this,r=o("div","".concat(Me.a,"-color-palette-cell")).on("click.stop",(function(){return t.change(e)})).css("background-color",e);return this.items.push(r),o("td","").child(r)}var rr=function e(){var t,r,n,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=o("div","".concat(Me.a,"-color-palette")),this.change=function(){},this.items=[];var a=o("table","").children((t=o("tbody","")).children.apply(t,[(r=o("tr","".concat(Me.a,"-theme-color-placeholders"))).children.apply(r,$t(Kt.map((function(e){return tr.call(i,e)}))))].concat($t(Zt.map((function(e){var t;return(t=o("tr","".concat(Me.a,"-theme-colors"))).children.apply(t,$t(e.map((function(e){return tr.call(i,e)}))))}))),[(n=o("tr","".concat(Me.a,"-standard-colors"))).children.apply(n,$t(er.map((function(e){return tr.call(i,e)}))))])));this.el.child(a)};function nr(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=this.data,a=this.editor,o=e.offsetX,l=e.offsetY,s=i.getCellRectByXY(o,l),u=s.ri,c=s.ci,f=a.pos,h=a.editorText.getText(),p="";a.handler(h);var v=a.mousedownIndex;if(Object(F.isAbsoluteValue)(Object(F.cuttingByPos)(h,f),2)||t)if(t){var d=t.selector.range,g=d.sri,m=d.sci,y=d.eri,b=d.eci,w=Object(L.xy2expr)(m,g),x=Object(L.xy2expr)(b,y),E=w==x?w:"".concat(w,":").concat(x);if(2==r){var O=Object(F.value2absolute)(w),C=Object(F.value2absolute)(x);E=O.s1==C.s1?O.s1:"".concat(O.s1,":").concat(C.s1)}else if(1==r){var k=Object(F.value2absolute)(w),N=Object(F.value2absolute)(x);E=k.s2==N.s2?k.s2:"".concat(k.s2,":").concat(N.s2)}else if(3==r){var T=Object(F.value2absolute)(w),A=Object(F.value2absolute)(x);E=T.s3==A.s3?T.s3:"".concat(T.s3,":").concat(A.s3)}t.erpx=E,a.isCors&&(f=1);var I=-1!=n?n:f-Object(F.cuttingByPos)(h,f).length;p=h.substring(0,I)+E+h.substring(f,h.length),a.setText(p),a.setCursorPos(h.substring(0,I).length+E.length)}else for(var S=0,j=0;j<this.selectors.length&&0==S;j++){var M=this.selectors[j].erpx;if(M===Object(F.cuttingByPos)(h,f)){var R=s.ri,D=s.ci;this.selectors[j].ri=R,this.selectors[j].ci=D,this.selectors[j].erpx=Object(L.xy2expr)(D,R),this.selectors[j].selector.set(R,D),p="".concat(h.substring(0,f-M.length)).concat(Object(L.xy2expr)(D,R)).concat(h.substring(f,h.length)),a.setText(p),a.setCursorPos(h.substring(0,f-M.length).length+Object(L.xy2expr)(D,R).length),S=1}}else if(v.length>0){if(Object(F.operation)(v[1][0])&&Object(F.isAbsoluteValue)(Object(F.cuttingByPos)(v[1],v[1].length),2))return void a.setLock(!1);var _=ar.call(this,u,c);this.selectors.push(_);var P=(p="".concat(v[0]).concat(Object(L.xy2expr)(c,u)).concat(v[1])).substring(v[0].length+Object(L.xy2expr)(c,u).length,p.length),H=Object(F.cutFirst)(P.substring(1));if(Object(F.operation)(P[0])&&!Object(F.isAbsoluteValue)(H,2))return a.setText(p),void a.setMouseDownIndex([]);H=Object(F.cutFirst)(v[1]),console.log(Object(L.xy2expr)(c,u));var B=Object(F.cutStr)("".concat(v[0]).concat(Object(L.xy2expr)(c,u),"+4").concat(v[1])),V=ir.call(this,B),z=V.selectors_delete,U=V.selectors_new;Object.keys(z).forEach((function(e){z[e].removeEl()})),this.selectors=U,p=p.replace(H,""),a.setText(p);cr.call(this,f-1,Object(F.cutting)(h),h);a.setCursorPos(v[0].length+Object(L.xy2expr)(c,u).length)}else{var Y=a.pos,W=t||ar.call(this,u,c);if(-1!=Y){for(var X="",G=!1,q=Y,$="",K=Y;K<h.length;K++)$+=h[K];for(var Z=Object(F.cutFirst)($).length,Q=0;Q<h.length;Q++)Y==Q&&(G=!0,X+=Object(L.xy2expr)(c,u)),q==Q&&Z>0?(q+=1,Z-=1):X+=h[Q];if(t){var J=i.selector.range,ee=J.sri,te=J.sci,re=J.eri,ne=J.eci,ie=Object(L.xy2expr)(te,ee),ae=Object(L.xy2expr)(ne,re);p=ie===ae?ie:"".concat(ie,":").concat(ae),X=G?X:X+=p}else console.log("121push"),this.selectors.push(W),X=G?X:X+=Object(L.xy2expr)(c,u);a.setText(X),a.setCursorPos(X.length),a.parse()}else this.selectors.push(W),p="".concat(h).concat(Object(L.xy2expr)(c,u)),a.setText(p)}if(a.parse(a.pos),this.selectors.length>0||t){var oe=a.editorText.getText(),le=!1,se=this.data.merges;Object.keys(se._).forEach((function(e){for(var t=se._[e],r=Object(F.cutStr)(oe,!0),n=0;n<r.length;n++)if(-1!=r[n].indexOf(":")){var i=r[n].split(":")[0],a=r[n].split(":")[1],o=Object(L.expr2xy)(i),l=Object(L.expr2xy)(a);t.sci>=o[0]&&t.sri>=o[1]&&t.eci<=l[0]&&t.eri<=l[1]&&(oe=oe.replace(new RegExp(r[n],"g"),i),le=!0)}})),fr.call(this,Object(F.cutting)(oe),Object(F.cutting2)(oe,this.selectors)),le&&setTimeout((function(){a.setCursorPos(oe.length)}),10)}}function ir(e){var t=this,r=[],n=[];return Object.keys(this.selectors).forEach((function(i){for(var a=t.selectors[i],o=a.erpx,l=0,s=0;s<e.length&&0===l;s++)e[s].replace(/\$/g,"")===o&&(l=1,r.push(a));0==l&&n.push(a.selector.el)})),{selectors_delete:n,selectors_new:r}}function ar(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=this.data,l=null,s=this.editor.editorText.getText(),u=Jt(r.length),c=u.color,f=u.index;if(i)l=i;else{var h="selector".concat(parseInt(999999*Math.random()));(l=new qt(o,this,h)).el.attr("class","".concat(h," clear_selector")),l.setCss(c)}n?a?l.setEnd(e,t):l.set(e,t,!0):l.set(e,t,!1),l.el.css("z-index","100");var p=s.split(Object(L.xy2expr)(t,e)).length-2,v=Object(L.xy2expr)(t,e),d=o.merges;Object.keys(d._).forEach((function(e){for(var t=d._[e],r=Object(F.cutStr)(v,!0),n=0;n<r.length;n++)if(-1!=r[n].indexOf(":")){var i=r[n].split(":")[0],a=r[n].split(":")[1],o=Object(L.expr2xy)(i),l=Object(L.expr2xy)(a);t.sci>=o[0]&&t.sri>=o[1]&&t.eci<=l[0]&&t.eri<=l[1]&&(v=v.replace(new RegExp(r[n],"g"),i))}}));var g={ri:e,ci:t,index:p,color:c,index2:f,className:l.el.el.className,erpx:v,selector:l};return a||(l.el.show(),this.selectorsEl.child(l.el)),n?g:(this.selectorsEl.child(l.el),g)}function or(){this.selectorsEl.html(""),this.selectors=[];var e=this.editor,t=this.selector;e.setLock(!1),e.state=1,t.el.show()}function lr(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("number"!=typeof t){var r=Object(F.cutStr)(t,!0),n=ir.call(this,r).selectors_delete;Object.keys(n).forEach((function(e){n[e].removeEl()}));var i=[];Object.keys(r).forEach((function(t){var n=1;Object.keys(e.selectors).forEach((function(t){e.selectors[t].selector.el.removeEl()}));var a="",o=r[t].replace(/\$/g,"");if(Object(F.isAbsoluteValue)(r[t])){var l=r[t].replace(/\$/g,"");a=Object(L.expr2xy)(l)}else-1!=o.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)?n=2:a=Object(L.expr2xy)(r[t]);if(1==n){var s=a[1],u=a[0],c=ar.call(e,s,u,i);c.erpx=r[t],i.push(c)}else if(2==n){var f=r[t].replace(/\$/g,"").split(":")[0],h=r[t].replace(/\$/g,"").split(":")[1],p=Object(L.expr2xy)(f),v=Object(L.expr2xy)(h),d=ar.call(e,p[1],p[0],i,!0,null,!1);(d=ar.call(e,v[1],v[0],i,!0,d.selector,!0)).erpx=r[t],i.push(d)}})),this.selectors=i,(this.selectors.length>0||"="==t[0])&&fr.call(this,Object(F.cutting)(t),Object(F.cutting2)(t,this.selectors))}}function sr(e,t){for(var r=-1,n=0,i=!1,a=t-1;a>0&&0==i;a--)"("==e[a]&&(i=!0),")"==e[a]&&n++;for(var o=t;o>0&&-1==r;o--)"("==e[o]&&(0===n&&(r=o),n--);return r}function ur(e,t){for(var r=-1,n=0,i=!1,a=t+1;a<e.length&&0==i;a++)")"==e[a]&&(i=!0),"("==e[a]&&n++;for(var o=t;o<e.length&&-1==r;o++)")"==e[o]&&(0===n&&(r=o),n--);return r}function cr(e,t,r){var n={suggestContent:!1,cut:"",pos:1},i=e-1,a=sr.call(this,t,i),o=ur.call(this,t,a);a<=i&&-1!=a&&(o>=i||-1==o)&&(n.suggestContent=!0,n.cut=Object(F.cuttingByPos)(r,a));for(var l=a;l<i+1;l++)","==r[l]&&(n.pos+=2);return n}function fr(e,t){var r=this.editor,n=[],i=-1,a=-1;Object.keys(e).forEach((function(r){var i=o("span","formula_span".concat(r));Object.keys(t).forEach((function(n){if(t[r]&&-1!==t[r].code&&t[r].data==e[r]){var a=Jt(t[r].code).color;i.css("color",a)}})),i.css("display","inline-block"),i.css("cursor","text")," "==e[r]?i.html("&emsp;"):i.html(e[r]),n.push(i)}));var l=r.pos,s=r.editorText.getText(),u={suggestContent:!1,cut:""};if(")"==s[l-1]?(i=l-1,a=sr.call(this,e,i)):u=cr.call(this,l+1,e,s),""!=s&&n.length<=0){var c=o("span","formula_span");n.push(c)}r.mount2span(n,i,a,u)}var hr=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],pr=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function vr(e){for(var t=0;t<pr.length;t+=1){var r=pr[t];if(r.pt===e)return r.px}return e}function dr(e,t){return"string"==typeof e&&-1!=e.toUpperCase().indexOf(t.toUpperCase())}var gr=function(e,t,r,n,i,a,o){arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(void 0===i)return"";if("string"==typeof i&&-1!=Me.c.indexOf(i.split("!")[0])){var l=i.length;i.split(" ")[0]&&(l=i.split(" ")[0].length);var s=JSON.parse(i.substring(i.indexOf("!")+1,l)),u=Me.c.indexOf(i.split("!")[0]);if(1===u)return s.text;if(0===u&&s&&s[0]){var c=s[0],f=c.name,h=c.value;if(0===h&&s[1]&&0!==s[1].value)return f;if(0===h&&!s[1])return f}return Me.d}return"="===i[0]&&"="!==i[1]?dr(i.substring(1),"wland")||dr(i.substring(1),"wfr")||dr(i.substring(1),"rtd")||dr(i.substring(1),"city")?i.toUpperCase():i.substring(1)&&t&&t.Sheets&&t.Sheets[e.name]&&t.Sheets[e.name][Object(L.xy2expr)(n,r)]?t.Sheets[e.name][Object(L.xy2expr)(n,r)].f&&-1!=t.Sheets[e.name][Object(L.xy2expr)(n,r)].f.search(/\((\+|\-|\*|\/)/)||null==t.Sheets[e.name][Object(L.xy2expr)(n,r)].v||""===t.Sheets[e.name][Object(L.xy2expr)(n,r)].v?"#ERROR!":(t.Sheets[e.name][Object(L.xy2expr)(n,r)].v=t.Sheets[e.name][Object(L.xy2expr)(n,r)].v+"",t.Sheets[e.name][Object(L.xy2expr)(n,r)].w?t.Sheets[e.name][Object(L.xy2expr)(n,r)].w:t.Sheets[e.name][Object(L.xy2expr)(n,r)].v.replace(/'/g,'"')):i:i},mr=function(e){return!isNaN(e)&&(""!=e&&!(parseInt(e)>=0))};function yr(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function wr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Er(e,t,r){return t&&xr(e.prototype,t),r&&xr(e,r),e}function Or(){return window.devicePixelRatio||1}function Cr(){return Or()-.5}function kr(e){return parseInt(e*Or(),10)}function Nr(e){var t=kr(e);return t>0?t-.5:.5}var Tr=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;wr(this,e),this.x=t,this.y=r,this.width=n,this.height=i,this.padding=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return Er(e,[{key:"setBorders",value:function(e){var t=e.top,r=e.bottom,n=e.left,i=e.right;t&&(this.borderTop=t),i&&(this.borderRight=i),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(e){var t=this.width,r=this.padding,n=this.x;return"left"===e?n+=r:"center"===e?n+=t/2:"right"===e&&(n+=t-r),n}},{key:"texty",value:function(e,t,r){var n=this.height,i=this.padding,a=this.y;return"top"===e?a+=i:"middle"===e?a=a+n/2-r:"bottom"===e&&(a+=n-2*r-i),a}},{key:"topxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e+this.width,t]]}},{key:"rightxys",value:function(){var e=this.x,t=this.y,r=this.width;return[[e+r,t],[e+r,t+this.height]]}},{key:"bottomxys",value:function(){var e=this.x,t=this.y,r=this.width,n=this.height;return[[e,t+n],[e+r,t+n]]}},{key:"leftxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e,t+this.height]]}}]),e}();function Ar(e,t,r,n,i,a,o){var l={x:0,y:0};"underline"===e?l.y="bottom"===i?0:"top"===i?-(a+2):-a/2:"strike"===e&&("bottom"===i?l.y=a/2:"top"===i&&(l.y=-(a/2+2))),"center"===n?l.x=o/2:"right"===n&&(l.x=o),this.line([t-l.x,r-l.y],[t-l.x+o,r-l.y])}var Ir=function(){function e(t,r,n){wr(this,e),this.el=t,this.ctx=t.getContext("2d"),this.resize(r,n),this.ctx.scale(Or(),Or()),this.cxc={indent:250,vIndent:200,canvasContext:this.ctx}}return Er(e,[{key:"resize",value:function(e,t){this.el.style.width="".concat(e,"px"),this.el.style.height="".concat(t,"px"),this.el.width=kr(e),this.el.height=kr(t)}},{key:"clear",value:function(){var e=this.el,t=e.width,r=e.height;return this.ctx.clearRect(0,0,t,r),this}},{key:"attr",value:function(e){return Object.assign(this.ctx,e),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(e,t){return this.ctx.translate(kr(e),kr(t)),this}},{key:"clearRect",value:function(e,t,r,n){return this.ctx.clearRect(e,t,r,n),this}},{key:"fillRect",value:function(e,t,r,n){return this.ctx.fillRect(kr(e)-.5,kr(t)-.5,kr(r),kr(n)),this}},{key:"fillText",value:function(e,t,r){return this.ctx.fillText(e,kr(t),kr(r)),this}},{key:"selfAdaptionHeight",value:function(e,t,r){if(null!=r&&null!=t){for(var n=1,i={len:0,start:0},a=e.width-2*e.padding,o=0;o<t.length;o+=1)i.len+e.padding>=a&&(n+=1,i.len=0,i.start=o),i.len+=this.selfAdaptionOneTxtWidth(t[o],r,e);return n}}},{key:"selfAdaptionTxtWidth",value:function(e,t,r){if(!1===Object(P.isHave)(e)||0==Object(P.isHave)(t)||e.length<=0)return 0;var n=this.ctx;return n.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(kr(t.size),"px ").concat(t.name),n.measureText(e).width+2*r.padding}},{key:"selfAdaptionOneTxtWidth",value:function(e,t,r){if(!1===Object(P.isHave)(e)||0==Object(P.isHave)(t)||e.length<=0)return 0;var n=this.ctx;return n.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(kr(t.size),"px ").concat(t.name),n.measureText(e).width}},{key:"text",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,a=r.align,o=r.valign,l=r.font,s=r.color,u=r.strike,c=r.underline,f=(r.ignore,r.cindex,t.textx(a));i.save(),i.beginPath(),this.attr({textAlign:a,textBaseline:o,font:"".concat(l.italic?"italic":""," ").concat(l.bold?"bold":""," ").concat(kr(l.size),"px ").concat(l.name),fillStyle:s,strokeStyle:s});var h=this.selfAdaptionTxtWidth(e,l,t),p=0,v=t.innerWidth();if(n){v=t.width-2*t.padding;var d=this.selfAdaptionHeight(t,e,l);p=(d-1)*l.size/2}var g=t.texty(o,l.size,p);if(n&&h>v){for(var m={len:0,start:0},y=0;y<e.length;y+=1)m.len+t.padding>=v&&(this.fillText(e.substring(m.start,y),f,g),u&&Ar.call(this,"strike",f,g,a,o,l.size,m.len),c&&Ar.call(this,"underline",f,g,a,o,l.size,m.len),g+=l.size+2,m.len=0,m.start=y),m.len+=this.selfAdaptionOneTxtWidth(e[y],l,t);m.len>0&&(this.fillText(e.substring(m.start),f,g),u&&Ar.call(this,"strike",f,g,a,o,l.size,m.len),c&&Ar.call(this,"underline",f,g,a,o,l.size,m.len))}else this.fillText(e,f,g),u&&Ar.call(this,"striket",f,g,a,o,l.size,h),c&&Ar.call(this,"underline",f,g,a,o,l.size,h);return i.restore(),this}},{key:"border",value:function(e,t){var r=this.ctx;return r.lineWidth=Cr,r.strokeStyle=t,"medium"===e?r.lineWidth=kr(2)-.5:"thick"===e?r.lineWidth=kr(3):"dashed"===e?r.setLineDash([kr(3),kr(2)]):"dotted"===e?r.setLineDash([kr(1),kr(1)]):"double"===e&&r.setLineDash([kr(2),0]),this}},{key:"line",value:function(){var e=this.ctx;if(arguments.length>1){var t=arguments.length<=0?void 0:arguments[0],r=br(t,2),n=r[0],i=r[1];e.moveTo(Nr(n),Nr(i));for(var a=1;a<arguments.length;a+=1){var o=a<0||arguments.length<=a?void 0:arguments[a],l=br(o,2),s=l[0],u=l[1];e.lineTo(Nr(s),Nr(u))}e.stroke()}return this}},{key:"strokeBorders",value:function(e){var t=this.ctx;t.save(),t.beginPath();var r=e.borderTop,n=e.borderRight,i=e.borderBottom,a=e.borderLeft;r&&(this.border.apply(this,yr(r)),this.line.apply(this,yr(e.topxys()))),n&&(this.border.apply(this,yr(n)),this.line.apply(this,yr(e.rightxys()))),i&&(this.border.apply(this,yr(i)),this.line.apply(this,yr(e.bottomxys()))),a&&(this.border.apply(this,yr(a)),this.line.apply(this,yr(e.leftxys()))),t.restore()}},{key:"dropup",value:function(e,t,r){var n=this.ctx,i=e.x,a=e.y,o=(e.width,i+10),l=a+e.height-18-r;t?this.drawFlexTrue(n,kr(o),kr(l)):this.drawFlexFalse(n,kr(o),kr(l))}},{key:"drawFlexFalse",value:function(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}},{key:"drawFlexTrue",value:function(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t+6,r),e.lineTo(t+6,r+12),e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}},{key:"translatex",value:function(e,t){this.cxc.canvasContext.translate(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"lineTo",value:function(e,t){this.cxc.canvasContext.lineTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"moveTo",value:function(e,t){this.cxc.canvasContext.moveTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"bezierCurveTo",value:function(e,t,r,n,i,a){this.cxc.canvasContext.bezierCurveTo(e+this.cxc.indent,t+this.cxc.vIndent,r+this.cxc.indent,n+this.cxc.vIndent,i+this.cxc.indent,a+this.cxc.vIndent)}},{key:"dropdown",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-15,a=n+e.height-15;console.log("350",a,i),t.save(),t.beginPath(),t.moveTo(kr(i),kr(a)),t.lineTo(kr(i+8),kr(a)),t.lineTo(kr(i+4),kr(a+6)),t.closePath(),t.fillStyle="rgba(0, 0, 0, .45)",t.fill(),t.restore()}},{key:"error",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-1;t.save(),t.beginPath(),t.moveTo(kr(i-8),kr(n-1)),t.lineTo(kr(i),kr(n-1)),t.lineTo(kr(i),kr(n+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}},{key:"rect",value:function(e,t){var r=this.ctx,n=e.x,i=e.y,a=e.width,o=e.height,l=e.bgcolor;r.save(),r.beginPath(),r.fillStyle=l||"#fff",r.rect(Nr(n+1),Nr(i+1),kr(a-2),kr(o-2)),r.clip(),r.fill(),t(),r.restore()}},{key:"rect2",value:function(e,t,r,n){var i=this.ctx,a=e.x,o=e.y,l=e.width,s=e.bgcolor,u=e.height;i.save(),i.beginPath(),i.fillStyle="rgba(0, 0, 0, 0)"===s?"#fff":s||"#fff",i.rect(Nr(a+1),Nr(o+1),kr(l-2),kr(u-2)),i.clip(),i.fill(),t(),i.restore()}}]),e}();function Sr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.valid;Object(P.isHave)(e)&&e.assert()}function jr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Mr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Rr=5,Dr={fillStyle:"#f4f5f8"},_r={fillStyle:"#fff",lineWidth:Cr,strokeStyle:"#e6e6e6"};function Pr(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new Tr(n,i,a,o,Rr)}function Lr(){var e=this.data.changeDataForCalc;return Object(P.isHave)(e)?{state:!0,data:e}:{state:!1,data:null}}function Fr(){var e=this.data,t=Lr.call(this);e.calc(e.rows,t.data),t.state&&(e.changeDataForCalc=null)}function Hr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=this.data,i=n.calc,a=(n.rows,[]);a.Sheets={},a.Sheets[n.name]={},e.each2((function(e,t){var r=n.getCell(e,t),i=Object(L.xy2expr)(t,e);r&&r.text?(r.text=r.text+"",-1!=r.text.indexOf("MD.RTD")?a.Sheets[n.name][i]={v:"",f:""}:r.text&&0===r.text.lastIndexOf("=")?a.Sheets[n.name][i]={v:"",f:r.text.replace(/ /g,"").replace(/\"/g,'"').replace(/\"\"\"\"&/g,'"\'"&')}:a.Sheets[n.name][i]={v:r.text.replace(/ /g,"").toUpperCase().replace(/\"/g,'"'),f:""}):a.Sheets[n.name][i]={v:0,f:0}})),t&&(a.Sheets[n.name].A1={v:"",f:"".concat(r)});try{i(a)}catch(e){console.error(e)}return a}function Br(e,t){var r=this.draw,n=this.data,i=n.sortedRowMap,a=e;i.has(e)&&(a=i.get(e));var o=n.getCell(a,t);if(Object(P.isHave)(o)){var l=n.getCellStyleOrDefault(a,t),s=Pr.call(this,e,t);s.bgcolor=l.bgcolor,void 0!==l.border&&(s.setBorders(l.border),r.strokeBorders(s));var u="";n.showEquation?Object(P.isHave)(o.formulas)&&(u=o.formulas):Object(P.isHave)(o.text)&&(u=o.text),r.rect2(s,(function(){var i=n.renderFormat(l,o,a,t,!1);u=i.state?i.cellText:u;var c=Object.assign({},l.font);c.size=vr(c.size);var f=n.settings,h=f.ignore,p=f.minus,v=l.color;1==p&&mr(u)&&(v="red");var d=l.underline,g="www"==(u+="").substr(0,3).toLowerCase()?"http://"+u:u;(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?$/.test(g)||function(e){return!!(e+="")&&1===Me.c.indexOf(e.split("!")[0])}(o.text))&&(v="#4b89ff",d=!0),r.text(u,s,{align:l.align,valign:l.valign,font:c,color:v,strike:l.strike,underline:d,ignore:h,cindex:t},l.textwrap),n.validations.getError(e,t)&&r.error(s)}),l.textwrap,u)}}function Vr(){for(var e=this.draw,t=this.data.autoFilter.flex,r=0;r<t.length;r++){for(var n=t[r],i=n.ri,a=n.ci,o=n.state,l=0,s=0;s<r;s++){var u=t[s],c=u.set_total;1==u.state&&(l+=c)}var f=Pr.call(this,i,a);e.dropup(f,o,25*l)}}function zr(e){var t=this,r=this.data,n=this.draw;if(e){var i=r.autoFilter;if(!i.active())return;var a=i.hrange();e.intersects(a)&&a.each((function(e,r){console.log(e,r,108);var i=Pr.call(t,e,r);n.dropdown(i)}))}}function Ur(e,t,r,n,i){var a=this,o=this.draw,l=this.data;o.save(),o.translate(t,r).translate(n,i);var s=l.exceptRowSet;o.save(),e.each((function(e,t){Br.call(a,e,t)}),(function(e){return function(e){var t=s.has(e);if(t){var r=l.rows.getHeight(e);o.translate(0,-r)}return!t}(e)})),o.restore();var u=new Set;o.save(),l.eachMergesInView(e,(function(e){var t=e.sri,r=e.sci,n=e.eri;if(s.has(t)){if(!u.has(t)){u.add(t);var i=l.rows.sumHeight(t,n+1);o.translate(0,-i)}}else Br.call(a,t,r)})),o.restore(),zr.call(this,e),Vr.call(this),o.restore()}function Yr(e,t,r,n){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,r,n),i.restore()}function Wr(e,t,r,n,i,a){var o=this,l=this.draw,s=this.data,u=t.h,c=t.w,f=a+n,h=i+r;l.save(),l.attr(Dr),"all"!==e&&"left"!==e||l.fillRect(0,f,r,u),"all"!==e&&"top"!==e||l.fillRect(h,0,c,n);var p=s.selector.range,v=p.sri,d=p.sci,g=p.eri,m=p.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(kr(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Cr(),strokeStyle:"#e6e6e6"}),"all"!==e&&"left"!==e||(s.rowEach(t.sri,t.eri,(function(e,t,n){var i=f+t,a=e;l.line([0,i],[r,i]),v<=a&&a<g+1&&Yr.call(o,0,i,r,n),l.fillText(a+1,r/2,i+n/2)})),l.line([0,u+f],[r,u+f]),l.line([r,f],[r,u+f])),"all"!==e&&"top"!==e||(s.colEach(t.sci,t.eci,(function(e,t,r){var i=h+t,a=e;l.line([i,0],[i,n]),d<=a&&a<m+1&&Yr.call(o,i,0,r,n),l.fillText(Object(L.stringAt)(a),i+r/2,n/2)})),l.line([c+h,0],[c+h,n]),l.line([0,n],[c+h,n])),l.restore()}function Xr(e,t){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),r.restore()}function Gr(e,t,r,n,i){var a=e.sri,o=e.sci,l=e.eri,s=e.eci,u=e.w,c=e.h,f=this.draw,h=this.data,p=h.settings;f.save(),f.attr(_r).translate(t+n,r+i),f.clearRect(0,0,u,c),p.showGrid?(h.rowEach(a,l,(function(e,t,r){e!==a&&f.line([0,t],[u,t]),e===l&&f.line([0,t+r],[u,t+r])})),h.colEach(o,s,(function(e,t,r){e!==o&&f.line([t,0],[t,c]),e===s&&f.line([t+r,0],[t+r,c])})),f.restore()):f.restore()}function qr(e,t,r,n){var i=this.draw,a=this.data,o=a.viewWidth()-e,l=a.viewHeight()-t;i.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,n],[o,n]),i.line([r,0],[r,l]),i.restore()}var $r=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.draw=new Ir(t,r.viewWidth(),r.viewHeight()),this.editor=n,this.data=r,this.timer=null,this.autoAdaptList=[]}var t,r,n;return t=e,(r=[{key:"getCellTextContent",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;n.has(e)&&(i=n.get(e));var a=r.getCell(i,t);if(null!==a)return gr(a.text||"",x,(function(e,t){return r.getCellTextOrDefault(t,e)}))}},{key:"getDrawBox",value:function(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new Tr(n,i,a,o,Rr)}},{key:"getCellTextStyle",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;return n.has(e)&&(i=n.get(e)),r.getCellStyleOrDefault(i,t)}},{key:"render",value:function(){var e=this.data,t=e.rows,r=e.cols,n=e.viewRange();Fr.call(this),this.clear(),this.draw.resize(e.viewWidth(),e.viewHeight());var i=e.freezeTotalWidth(),a=e.freezeTotalHeight(),o=e.scroll,l=o.x,s=o.y,u=r.indexWidth,c=t.height;Gr.call(this,n,u,c,i,a),Ur.call(this,n,u,c,-l,-s),Wr.call(this,"all",n,u,c,i,a),Xr.call(this,u,c);var f=jr(e.freeze,2),h=f[0],p=f[1];if(h>0||p>0){if(h>0){var v=n.clone();v.sri=0,v.eri=h-1,v.h=a,Gr.call(this,v,u,c,i,0),Ur.call(this,v,u,c,-l,0),Wr.call(this,"top",v,u,c,i,0)}if(p>0){var d=n.clone();d.sci=0,d.eci=p-1,d.w=i,Gr.call(this,d,u,c,0,a),Wr.call(this,"left",d,u,c,0,a),Ur.call(this,d,u,c,0,-s)}var g=e.freezeViewRange();Gr.call(this,g,u,c,0,0),Wr.call(this,"all",g,u,c,0,0),Ur.call(this,g,u,c,0,0),qr.call(this,u,c,i,a)}Sr.call(this)}},{key:"clear",value:function(){this.draw.clear()}}])&&Mr(t.prototype,r),n&&Mr(t,n),e}();function Kr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Zr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputText="",this.oldCell="",this.ri=-1,this.ci=-1}var t,r,n;return t=e,(r=[{key:"setText",value:function(e){return this.inputText=e,this.getText()}},{key:"getText",value:function(){return this.inputText}},{key:"setOldCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.ri,n=void 0===r?-1:r,i=t.ci,a=void 0===i?-1:i;return this.oldCell=e,this.ri=n,this.ci=a,this.getOldCell()}},{key:"setRICI",value:function(e,t){this.ri=e,this.ci=t}},{key:"getOldCell",value:function(){return this.oldCell}},{key:"getRICI",value:function(){return{ri:this.ri,ci:this.ci}}},{key:"changeText",value:function(e){1===e&&this.setText(this.getText().replace(/，/g,","))}},{key:"isFormula",value:function(){return 0==this.getText().lastIndexOf("=")}},{key:"f4ShortcutKey",value:function(e){var t=this.setText(this.inputText.toString().toUpperCase()),r=Object(F.cuttingByPos)(t,e,!0),n=Object(F.cuttingByPosEnd2)(t,e+1);console.log(n);var i=Object(F.isAbsoluteValue)(r,5),a="",o="";if((o=r.split(":")[1])&&(i=2===(i=1===(i=12===(i=3===(i=Object(F.isAbsoluteValue)(o,5))?6:i)?9:i)?7:i)?8:i,console.log(i)),0!=i)switch(i){case 13:o=r.split(":")[1],a=Object(F.value2absolute)(o.replace(/\$/g,"")).s1;var l=t.substring(0,t.lastIndexOf(o));t=this.setText(l+a);break;case 12:o=r,a=Object(F.value2absolute)(o.replace(/\$/g,"")).s3,console.log(Object(F.value2absolute)(r)),t=this.setText(t.substring(0,t.lastIndexOf(o))+a),console.log(this.getText());break;case 11:case 10:o=r.split(":")[1],a=Object(F.value2absolute)(o.replace(/\$/g,"")).s3,t=this.setText(t.substring(0,t.lastIndexOf(o))+a);break;case 9:o=r.split(":")[1],a=Object(F.value2absolute)(o.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(o))+a);break;case 8:a=(o=r.split(":")[1]).replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(o))+a);break;case 7:o=r.split(":")[1],a=Object(F.value2absolute)(o.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(o))+a);break;case 6:o=r.split(":")[1],a=Object(F.value2absolute)(o.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(o))+a);break;case 5:a=Object(F.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+a);break;case 4:a=Object(F.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+a);break;case 3:a=Object(F.value2absolute)(r.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+a);break;case 2:a=r.replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(r))+a);break;case 1:a=Object(F.value2absolute)(r.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+a)}return{pos:t.length,inputText:t=this.setText(t+n)}}}])&&Kr(t.prototype,r),n&&Kr(t,n),e}();function Qr(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function en(){var e=this.textlineEl,t=this.textEl,r=this.areaOffset;if(r){var n=e.offset().width+9+15,i=this.viewFn().width-r.left-9;if(n>r.width&&0!=r.width){var a=n;if(n>i){a=i-15;var o=parseInt(n/(i-15),10);o+=n%i>0?1:0,(o*=this.rowHeight)>r.height&&t.css("height","".concat(o,"px"))}t.css("width","".concat(a,"px"))}}}var tn=function(e){var t=this;if(window.getSelection().rangeCount<=0)return 0;var r=window.getSelection().getRangeAt(0),n=r.cloneRange();n.selectNodeContents(this.textEl.el),n.setEnd(r.startContainer,r.startOffset);var i=n.toString().length,a=this.editorText.getText(),o=function(e,t,r){var n={left:0,right:0,exist:!1};if(")"!==r[e])return n;var i=e,a=sr.call(this,t,i);return-1!=a&&-1!=i&&(n={left:a,right:i,exist:!0}),n}(i-1,Object(F.cutting)(a),a),l=o.exist,s=o.left,u=o.right;Object.keys(this.spanArr).forEach((function(e){t.spanArr[e].css("background-color","rgba(255,255,255,0.1)")}));var c=this.spanArr[s],f=this.spanArr[u];if(this.suggestContent.hide(),l&&c&&f)c.css("background-color","rgb(229, 229, 229)"),f.css("background-color","rgb(229, 229, 229)");else{var h=this.suggest.show,p=cr.call(this,i,Object(F.cutting)(a),a);p.suggestContent&&!h&&this.suggestContent.content(p.cut,p.pos)}return i};function rn(e){if(this){var t=this.pos,r=this.pos,n=0,i=document.createRange();i.setStart(e,0),i.collapse(!0);for(var a,o=[e],l=!1,s=!1;!s&&(a=o.pop());)if(3==a.nodeType){var u=n+a.length;!l&&t>=n&&t<=u&&(i.setStart(a,t-n),l=!0),l&&r>=n&&r<=u&&(i.setEnd(a,r-n),s=!0),n=u}else for(var c=a.childNodes.length;c--;)o.push(a.childNodes[c]);var f=window.getSelection();f.removeAllRanges(),f.addRange(i)}}function nn(e){var t=this.editorText.getText();this.pos=tn.call(this,e),un.call(this,t,this.pos)}function an(){if(!1===dn.call(this)){var e=this.data.getCell(this.ri,this.ci);this.editorText.setOldCell(Object(F.deepCopy)(e),{ri:this.ri,ci:this.ci})}}function on(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";if(an.call(this),e){var a=e.inputType;if("insertFromPaste"===a&&"black"!=this.textEl.el.style["caret-color"])return void(this.copy=!0);if("historyUndo"===a)return}var o=this.editorText;o.getText();setTimeout((function(){if(0!=t.chinese){var a="";if(t.data.settings.showEditor){if(t.sheet.selector.hide(),""==r&&e&&e.target&&e.target.childNodes){for(var l="",s=0,u=e.target.childNodes.length;s<u;s++)1===e.target.childNodes[s].nodeType?a+=e.target.childNodes[s].innerText:3===e.target.childNodes[s].nodeType&&(l+=e.target.childNodes[s].nodeValue);a=""!==l?l:a}else a=""==r&&e&&Object(P.isHave)(e.data)?""!==e.data?e.data:a:r;t.copy&&(t.copy=!1,a=e&&e.data?e.data:"",t.textEl.html(a),t.pos=a.length,rn.call(t,t.textEl.el,-1)),t.changed=!0;var c=t.suggest,f=t.textlineEl,h=t.validator,p=t.textEl;t.save;if(o.setText("".concat(a)),o.changeText(1),t.pos=tn.call(t,e),h)"list"===h.type?c.search(a):c.hide();else{var v=(a+="").lastIndexOf("=");-1!=t.pos?un.call(t,a,t.pos):sn.call(t,a);var d=!1,g=Object(F.cuttingByPos2)(a,t.pos,!0);if(a.length>=t.pos){var m="".concat(a[t.pos]);if(-1!=m.search(/^[0-9]+.?[0-9]*$/))d=!0;else if(m){g+=Object(F.cuttingByPosEnd)(a,t.pos+1)}}0===v&&a.length>1&&""!=g&&!d&&g.trim().length>0?c.search(g):c.hide()}f.html(n||a),o.setText(n||a),t.suggest.itemIndex=-1,en.call(t),a&&"="!==a[0]&&rn.call(t,p.el,-1),n&&"="===n[0]&&(a=n),t.change(i,a),Sr.call(t,t.valid2),setTimeout((function(){t.show()}))}}}))}function ln(e){this.pos=tn.call(this,e),"ArrowRight"===e.code?this.pos=this.pos+1:"ArrowLeft"===e.code&&(this.pos=this.pos-1);var t=e.keyCode||e.which;27==t&&"black"==this.textEl.el.style["caret-color"]&&"1"==this.textEl.el.style.opacity&&this.change("input","@~esc")}function sn(e){var t=e.lastIndexOf("=");0===t&&e.length>=1&&Object(F.operation)(e[e.length-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==t?this.setLock(!1):0===t&&1==e.length&&this.setLock(!0),Object(F.isAbsoluteValue)(Object(F.cuttingByPos)(e,this.pos),2)&&this.setLock(!0),0!==t&&this.setLock(!1)}function un(e,t){var r=(e+="").lastIndexOf("=");0===r&&e.length>=1&&Object(F.operation)(e[t-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==r?this.setLock(!1):0===r&&1==e.length&&this.setLock(!0),Object(F.isAbsoluteValue)(Object(F.cuttingByPos)(e,t),2)&&this.setLock(!0),0!==r&&this.setLock(!1)}function cn(e){var t=this,r=this.textEl.el;setTimeout((function(){rn.call(t,r)}),0)}function fn(e,t){var r=this.textEl,n=this.textlineEl,i=this.tmp;r.el.blur(),i.html(e),n.html(e),cn.call(this,t)}function hn(e){var t=this.validator,r=this.editorText,n=r.getText();if(t&&"list"===t.type)(n=r.setText(e)).length;else{this.pos=tn.call(this);for(var i=this.pos-Object(F.cuttingByPos)(n,this.pos).length,a=Object(F.cuttingByPosEnd)(n,this.pos+1),o=["",""],l=this.pos+a.length,s=0;s<n.length;s++)s<i&&(o[0]+=n[s]),s>l-1&&(o[1]+=n[s]);n=r.setText("".concat(o[0]+e.key,"(")),this.pos=r.getText().length,n=r.setText(n+")".concat(o[1]))}this.textEl.html(n),this.textlineEl.html(n),this.suggest.hide(),un.call(this,n,this.pos),this.change("input",n),rn.call(this,this.textEl.el,-1),en.call(this)}function pn(){this.suggestContent.hide()}function vn(){this.suggest.setItems(this.formulas)}function dn(){return"black"==this.textEl.el.style["caret-color"]&&"1"==this.textEl.el.style.opacity}var gn=function(){function e(t,r,n,i,a,l){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewFn=r,this.rowHeight=n,this.formulas=t,this.sheet=l,this.display=!0,this.suggest=new ft(t,(function(e){hn.call(s,e)}),a,this),this.suggestContent=new Tt,this.lock=!1,this.state=1,this.data=a,this.datepicker=new Ct,this.isCors=!1,this.datepicker.change((function(e){s.setText(function(e){var t=e.getMonth()+1,r=e.getDate();return t<10&&(t="0".concat(t)),r<10&&(r="0".concat(r)),"".concat(e.getFullYear(),"-").concat(t,"-").concat(r)}(e)),s.clear()})),this.ri=-1,this.ci=-1,this.spanArr=[],this.mousedownIndex=[],this.changed=!1,this.chinese=!0,this.editorText=new Zr(""),this.areaEl=o("div","".concat(Me.a,"-editor-area")).children(this.textEl=o("div","".concat(Me.a,"-editor-textEl")).on("input",(function(e){return on.call(s,e)})).on("click",(function(e){return nn.call(s,e)})).on("keyup",(function(e){return ln.call(s,e)})).on("mousedown",(function(e){if(2==e.detail){if(dn.call(s))return;s.show(),setTimeout((function(){var e=s.ri,t=s.ci;console.log(e,t),s.setCellEnd(a.getSelectedCellRiCi(e,t))}))}})).on("compositionstart",(function(e){s.chinese=!1})).on("compositionend",(function(e){s.chinese=!0})).on("paste",(function(e){"black"==s.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("copy",(function(e){"black"==s.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("keydown",(function(e){en.call(s),s.textlineEl.html(e.currentTarget.innerText);var t=e.keyCode;if(38!==t&&40!==t||e.preventDefault(),115===t){var r=s.editorText.f4ShortcutKey(tn.call(s)),n=r.inputText,i=r.pos;return on.call(s,null,n,n),void setTimeout((function(){s.pos=i,rn.call(s,s.textEl.el,-1)}))}if("black"!=s.textEl.el.style["caret-color"]){var a=e.ctrlKey,o=e.metaKey;8===t||46===t?Ae.call(s,8,!1):40===t?(s.clear(),Ae.call(s,40,!1)):39===t?(s.clear(),Ae.call(s,39,!1)):37===t?(s.clear(),Ae.call(s,37,!1)):38===t?(s.clear(),Ae.call(s,38,!1)):(a||o)&&(67===t?Ae.call(s,67,!0):86===t?Ae.call(s,86,!0):88===t?Ae.call(s,88,!0):90===t?Ae.call(s,90,!0):66===t&&Ae.call(s,66,!0))}})),this.textlineEl=o("div","textline"),this.suggestContent.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),l.el.child(this.suggest.el),this.el=o("div","".concat(Me.a,"-editor")).children(this.areaEl),this.suggest.bindInputEvents(this.textEl),this.textEl.on("paste",(function(e){!1!==dn.call(s)&&function(e){var t;e.preventDefault();var r=(e.originalEvent||e).clipboardData;if(null==r){if(""!==(t=window.clipboardData.getData("text")||""))if(window.getSelection){var n=document.createElement("span");n.innerHTML=t,window.getSelection().getRangeAt(0).insertNode(n)}else document.selection.createRange().pasteHTML(t)}else""!==(t=r.getData("text/plain")||"")&&document.execCommand("insertText",!1,t)}(e)})),this.tmp=o("span","span_tmp").hide(),this.textEl.attr("contenteditable","true"),this.textEl.css("width","".concat(i-3,"px")),this.textEl.css("height","".concat(n-2,"px")),this.textEl.child(this.tmp),this.pos=0,this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,setTimeout((function(){s.show(!1)})),this.change=function(){}}var t,r,n;return t=e,(r=[{key:"setFreezeLengths",value:function(e,t){this.freeze.w=e,this.freeze.h=t}},{key:"setMouseDownIndex",value:function(e){this.mousedownIndex=e}},{key:"setRiCi",value:function(e,t){this.ri=e,this.ci=t,-1!==this.ri&&this.ci}},{key:"setLock",value:function(e){this.lock=e}},{key:"getLock",value:function(){return this.lock}},{key:"show",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.data.settings.showEditor?(this.textEl.css("caret-color","black"),this.textEl.css("cursor","text"),this.textEl.css("opacity","1"),this.textEl.el.focus(),this.areaEl.css("pointer-events","auto"),this.areaEl.css("border","2px solid #4b89ff"),this.areaEl.css("background","white")):(this.textEl.css("caret-color","white"),this.textEl.css("cursor","default"),this.textEl.css("opacity","0"),this.textEl.el.blur(),this.areaEl.css("pointer-events","none"),this.areaEl.css("background","rgba(75, 137, 255, 0)"),this.areaEl.css("border","none"))}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=this.editorText,r=t.getText();-1!=e?(this.pos=tn.call(this),un.call(this,r,this.pos)):sn.call(this,r)}},{key:"clear",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.editorText,n=r.getText();return this.display=dn.call(this),""!==n&&isNaN(n)&&0===n.replace(/\s/g,"").lastIndexOf("¥")?this.change("format",n):this.changed&&this.change("finish",n),this.changed=!1,this.cell=null,this.areaOffset=null,n=r.setText(""),this.show(!1),this.copy=!1,rn.call(this,this.textEl.el,-1),this.pos=0,this.tmp.hide(),this.textEl.html(""),this.textlineEl.html(""),pn.call(this),vn.call(this),this.datepicker.hide(),!t&&(setTimeout((function(){var t=e.data.selector,r=t.ri,n=t.ci;e.setRiCi(r,n)})),this.display)}},{key:"mount2span",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{suggestContent:!1,cut:"",pos:-1};if(this.spanArr!==e){var i,a=this.suggest.show;n.suggestContent&&!a?this.suggestContent.content(n.cut,n.pos):this.suggestContent.hide(),Object.keys(e).forEach((function(t){e[t].css("background-color","rgba(255,255,255,0.1)")})),"-1"!==t&&-1!=r&&e[t]&&(e[t].css("background-color","#e5e5e5"),e[r].css("background-color","#e5e5e5")),e.length>0&&(this.textEl.html(""),this.tmp=(i=o("span","span_tmp")).children.apply(i,Qr(e)).css("top","0px").css("color","black").css("font-size","14px").css("font-family","m-inconsolata,monospace,arial,sans,sans-serif"),this.textEl.el.insertBefore(this.tmp.el,this.textEl.el.childNodes[0]),rn.call(this,this.textEl.el,-1)),this.spanArr=e}}},{key:"handler",value:function(e){var t=this.editorText.getText(),r=this.pos;if(r>=t)this.setMouseDownIndex([]);else{var n=e.substring(0,r),i=e.substring(r,e.length);sn.call(this,n),""!==i?this.setMouseDownIndex([n,i]):this.setMouseDownIndex([])}}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.textEl,i=this.areaEl,a=this.suggest,o=this.freeze,l=this.el;if(e){this.areaOffset=e;var s=e.left,u=e.top,c=e.width,f=e.height,h=e.l,p=e.t,v={left:0,top:0};o.w>h&&o.h>p||(o.w<h&&o.h<p?(v.left=o.w,v.top=o.h):o.w>h?v.top=o.h:o.h>p&&(v.left=o.w)),l.offset(v),i.offset({left:s-v.left-.8,top:u-v.top-.8}),n.offset({width:c-2+.8,height:f-3+.8});var d={left:0};d[t]=f,a.hide(),en.call(this),r&&this.show(!1)}}},{key:"setCellEnd",value:function(e){var t=this,r="";Object(P.isHave)(e)&&Object(P.isHave)(e.text)&&(r=e.text),Object(P.isHave)(e)&&Object(P.isHave)(e.formulas)&&(r=e.formulas);var n=this.data,i=n.getCellStyleOrDefault(this.ri,this.ci),a=n.renderFormat(i,e,this.ri,this.ci,!0);r=a.state?a.cellText:r,this.textEl.child(r+""),this.pos=r.length,rn.call(this,this.textEl.el,-1),this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci}),Sr.call(this),on.call(this,null,r,e&&e.formulas||"","end"),setTimeout((function(){t.pos=n.rows.toString(r).length,rn.call(t,t.textEl.el,-1)}),20)}},{key:"setCell",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.cell=e,this.show();var i=e&&e.formulas||"";i=""==i?e&&e.text||"":i,this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci});var a=this.el,o=this.datepicker,l=this.suggest;if(a.show(),this.textEl.show(),rn.call(this,this.textEl.el,-1),setTimeout((function(){r.pos=i.length,rn.call(r,r.textEl.el)}),10),this.validator=t,t){var s=t.type;"date"===s&&(o.show(),/^\s*$/.test(i)||o.setValue(i)),"list"===s&&(l.setItems(t.values()),l.search(""))}2==n&&""!=i&&"="==i[0]?(on.call(this,null,i),this.pos=i.length,rn.call(this,this.textEl.el,i.length)):2==n&&"="!=i[0]&&this.textEl.child(i),setTimeout((function(){r.textlineEl.html(i),en.call(r)}))}},{key:"inputEventHandler",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&(this.areaEl.hide(),this.sheet.selector.hide(),this.isCors=!0),this.setCursorPos(t),on.call(this,null,e)}},{key:"isDisplay",value:function(){var e=this.editorText;return e.getText(),!(!dn.call(this)||!e.isFormula())}},{key:"isDisplay2",value:function(){return!!dn.call(this)}},{key:"setCursorPos",value:function(e){this.pos=e,rn.call(this,this.textEl.el)}},{key:"setText",value:function(e){this.editorText.setText(e),fn.call(this,e,e.length),en.call(this),this.textEl.child(this.tmp)}}])&&Jr(t.prototype,r),n&&Jr(t,n),e}();function mn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function yn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bn=[{key:"copy",title:f("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:f("contextmenu.cut"),label:"Ctrl+X"},{key:"divider"},{key:"insert-row",title:f("contextmenu.insertRow")},{key:"insert-column",title:f("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:f("contextmenu.deleteRow")},{key:"delete-column",title:f("contextmenu.deleteColumn")},{key:"delete-cell-text",title:f("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:f("contextmenu.validation")}];function wn(e){var t=this;return"divider"===e.key?o("div","".concat(Me.a,"-item divider")):o("div","".concat(Me.a,"-item")).on("click",(function(r){t.itemClick(e.key,r),t.hide()})).children(e.title(),o("div","label").child(e.label||""))}function xn(){var e=this;return bn.map((function(t){return wn.call(e,t)}))}var En=function(){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.menus=xn.call(this),this.el=(r=o("div","".concat(Me.a,"-contextmenu"))).children.apply(r,mn(this.menus)).hide(),this.viewFn=t,this.itemClick=function(){},this.isHide=n}var t,r,n;return t=e,(r=[{key:"hide",value:function(){var e=this.el;e.hide(),Te(e)}},{key:"setPosition",value:function(e,t){if(!this.isHide){var r=this.el,n=r.show().offset(),i=n.height,a=n.width,o=this.viewFn(),l=t,s=e;o.height-t<=i&&(l-=i),o.width-e<=a&&(s-=a),r.offset({left:s,top:l}),Ie(r)}}}])&&yn(t.prototype,r),n&&yn(t,n),e}();function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kn(e,t){return!t||"object"!==On(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nn(e){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var An=function(e){function t(e,r,n,i,a){var l,s,u=a.type,c=a.change,f=a.arrowChange,h=a.historyBorder;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(s=kn(this,Nn(t).call(this,"div","".concat(Me.a,"-dropdown ").concat(i)))).title=e,s.change=function(){},"string"==typeof e?s.title=o("div","".concat(Me.a,"-dropdown-title")).child(e):n&&s.title.addClass("arrow-left");for(var p=arguments.length,v=new Array(p>5?p-5:0),d=5;d<p;d++)v[d-5]=arguments[d];return s.contentEl=(l=o("div","".concat(Me.a,"-dropdown-content"))).children.apply(l,v).css("width",r).hide(),u?(s.headerEl=o("div","".concat(Me.a,"-dropdown-header")).on("click",c),s.headerEl.children(s.title,n?o("div","".concat(Me.a,"-icon arrow-right_d")).child(o("div","".concat(Me.a,"-icon-img arrow-down")).on("click.stop",(function(e){f(h),"block"!==s.contentEl.css("display")?s.show():s.hide()}))):""),s.children(s.headerEl,s.contentEl)):(s.headerEl=o("div","".concat(Me.a,"-dropdown-header")),s.headerEl.on("click",(function(){"block"!==s.contentEl.css("display")?s.show():s.hide()})).children(s.title,n?o("div","".concat(Me.a,"-icon arrow-right")).child(o("div","".concat(Me.a,"-icon-img arrow-down"))):""),s.children(s.headerEl,s.contentEl)),s}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tn(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.html(e),this.hide()}},{key:"show",value:function(){var e=this;this.contentEl.show(),this.parent().active(),Ie(this.parent(),(function(){e.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),Te(this.parent())}}])&&Cn(r.prototype,n),i&&Cn(r,i),t}(a);function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function jn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mn(e){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dn=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=hr.map((function(e){return o("div","".concat(Me.a,"-item")).on("click",(function(){r.setTitle(e.title),r.change(e)})).child(e.title)}));return r=jn(this,(e=Mn(t)).call.apply(e,[this,hr[0].title,"160px",!0,"bottom-left",{type:!1}].concat(Sn(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(t,e),t}(An);function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ln(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fn(e){return(Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bn=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=pr.map((function(e){return o("div","".concat(Me.a,"-item")).on("click",(function(){r.setTitle("".concat(e.pt)),r.change(e)})).child("".concat(e.pt))}));return r=Ln(this,(e=Fn(t)).call.apply(e,[this,"10","60px",!0,"bottom-left",{type:!1}].concat(Pn(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(t,e),t}(An);function Vn(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var zn=function(e){return e},Un=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!Object(P.isHave)(e)||!Object(P.isNumber)(e))return e;if(/^(-?\d*.?\d*)$/.test(e)){var r=-1===t?e.toString():Number(e).toFixed(t).toString(),n=r.split("\\."),i=Vn(n),a=i[0],o=(i.slice(1),a.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"));return"NaN"===o?e:o}return e},Yn=[{key:"normal",title:f("format.normal"),type:"string",render:zn},{key:"number",title:f("format.number"),type:"number",label:"1,000.12",render:Un},{key:"percent",title:f("format.percent"),type:"number",label:"10.12%",render:function(e){var t=function(e,t,r){return Xn(e,t,r,"multiply")}(e,100),r="".concat(t);return"".concat(r,"%")}},{key:"rmb",title:f("format.rmb"),type:"number",label:"￥10.00",render:function(e){return"￥".concat(Un(e))}},{key:"date",title:f("format.date"),type:"date",label:"2009-01-01",render:zn},{key:"datetime",title:f("format.datetime"),type:"datetime",label:"2009年01月01日",render:zn}];function Wn(e){var t,r={times:1,num:0},n=e<0;if(t=e,Math.floor(t)===t)return r.num=e,r;var i="".concat(e),a=i.indexOf("."),o=i.substr(a+1).length,l=Math.pow(10,o),s=parseInt(Math.abs(e)*l+.5,10);return r.times=l,n&&(s=-s),r.num=s,r}function Xn(e,t,r,n){var i=Wn(e),a=Wn(t),o=i.num,l=a.num,s=i.times,u=a.times,c=s>u?s:u;switch(n){case"add":return(s===u?o+l:s>u?o+l*(s/u):o*(u/s)+l)/c;case"subtract":return(s===u?o-l:s>u?o-l*(s/u):o*(u/s)-l)/c;case"multiply":return o*l/(s*u);case"divide":return o/l*(u/s)}}var Gn={};function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Yn.forEach((function(e){Gn[e.key]=e}));var ei=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=Yn.slice(0);return n.splice(1,0,{key:"divider"}),n.splice(5,0,{key:"divider"}),n=n.map((function(e){var t=o("div","".concat(Me.a,"-item"));return"divider"===e.key?t.addClass("divider"):(t.child(e.title()).on("click",(function(){r.setTitle(e.title()),r.change(e)})),e.label&&t.child(o("div","label").html(e.label))),t})),r=Zn(this,(e=Qn(t)).call.apply(e,[this,"Normal","220px",!0,"bottom-left",{type:!1}].concat($n(n))))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){for(var t=0;t<Yn.length;t+=1)Yn[t].key===e&&this.title.html(Yn[t].title);this.hide()}}])&&Kn(r.prototype,n),i&&Kn(r,i),t}(An);function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ri(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ni(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e,t){return(ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oi=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=m.map((function(e){return o("div","".concat(Me.a,"-item")).on("click",(function(){r.hide(),r.change(e)})).child(e.key)}));return r=ni(this,(e=ii(t)).call.apply(e,[this,new mt("formula"),"180px",!0,"bottom-left",{type:!1}].concat(ri(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}(t,e),t}(An);function li(e){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function si(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ui(e,t){return!t||"object"!==li(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ci(e){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fi(e,t){return(fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hi=function(e){function t(e,r){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=new mt(e).css("height","16px").css("border-bottom","3px solid ".concat(r)),a=new rr;return a.change=function(e){n.setTitle(e),n.change(e)},(n=ui(this,ci(t).call(this,i,"auto",!1,"bottom-left",{type:!1},a.el))).colorPalette=a,n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fi(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.css("border-color",e),this.hide()}}])&&si(r.prototype,n),i&&si(r,i),t}(An);function pi(e){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vi(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function di(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gi(e,t){return!t||"object"!==pi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mi(e){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bi=function(e){function t(e,r){var n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=new mt("align-".concat(r)),l=e.map((function(e){return(t="align-".concat(e),o("div","".concat(Me.a,"-item")).child(new mt(t))).on("click",(function(){i.setTitle(e),i.change(e)}));var t}));return i=gi(this,(n=mi(t)).call.apply(n,[this,a,"auto",!0,"bottom-left",{type:!1}].concat(vi(l))))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.setName("align-".concat(e)),this.hide()}}])&&di(r.prototype,n),i&&di(r,i),t}(An);function wi(e){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xi(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ei(e,t){return!t||"object"!==wi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ci(e,t){return(Ci=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ki=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Ni=function(e){function t(e){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=new mt("line-type"),a=0,l=ki.map((function(t,r){return o("div","".concat(Me.a,"-item state ").concat(e===t[0]?"checked":"")).on("click",(function(){l[a].toggle("checked"),l[r].toggle("checked"),a=r,n.hide(),n.change(t)})).child(o("div","".concat(Me.a,"-line-type")).html(t[1]))}));return n=Ei(this,(r=Oi(t)).call.apply(r,[this,i,"auto",!1,"bottom-left",{type:!1}].concat(xi(l))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ci(e,t)}(t,e),t}(An);function Ti(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ai(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ii(){var e;return o("table","").child((e=o("tbody","")).children.apply(e,arguments))}function Si(e){var t=this,r=o("div","".concat(Me.a,"-border-palette-cell"));return this.items.push(r),o("td","").child(r.child(new mt("border-".concat(e))).on("click",(function(){t.mode=e;var r=t.mode,n=t.style,i=t.color;t.change({mode:r,style:n,color:i})})))}var ji=function e(){var t,r,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new hi("line-color",this.color),this.ddColor.change=function(e){n.color=e},this.ddType=new Ni(this.style),this.ddType.change=function(e){var t=Ai(e,1)[0];n.style=t},this.el=o("div","".concat(Me.a,"-border-palette")),this.items=[];var i=Ii(o("tr","").children(o("td","".concat(Me.a,"-border-palette-left")).child(Ii((t=o("tr","")).children.apply(t,Ti(["all","inside","horizontal","vertical","outside"].map((function(e){return Si.call(n,e)})))),(r=o("tr","")).children.apply(r,Ti(["left","top","right","bottom","none"].map((function(e){return Si.call(n,e)})))))),o("td","".concat(Me.a,"-border-palette-right")).children(o("div","".concat(Me.a,"-toolbar-btn")).child(this.ddColor.el),o("div","".concat(Me.a,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ri(e,t){return!t||"object"!==Mi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Di(e){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pi=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new mt("border-all"),n=new ji;return n.change=function(t){e.change(t),e.hide()},(e=Ri(this,Di(t).call(this,r,"auto",!1,"bottom-left",{type:!1},n.el))).borderPalette=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(t,e),t}(An);function Li(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=o("div","".concat(Me.a,"-history-border")),this.history=o("div","".concat(Me.a,"-history-content")).html("暂无内容"),this.el.child(this.history)}var t,r,n;return t=e,(r=[{key:"setContent",value:function(e){var t;e=e.slice(e.length-100<0?0:e.length,e.length),this.el.html("");for(var r=[],n=e.length-1;n>=0;n--){var i=o("div",""),a=e[n].action;i.html(a),r.push(i)}console.log(this,this.el),(t=this.el).children.apply(t,r)}}])&&Li(t.prototype,r),n&&Li(t,n),e}();function Hi(e){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bi(e,t){return!t||"object"!==Hi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zi(e,t){return(zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ui=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=new mt(e).css("height","18px"),a=new Fi;return Bi(this,Vi(t).call(this,i,"auto",!0,"bottom-left",{type:!0,change:r,arrowChange:n,historyBorder:a},a.el))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zi(e,t)}(t,e),t}(An);function Yi(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Gi(e){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $i(e,t){return!t||"object"!==Gi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zi(e,t){return(Zi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qi(e){return o("div","".concat(Me.a,"-toolbar-btn")).on("mouseenter",(function(t){!function(e,t){if(!t.classList.contains("active")){var r=t.getBoundingClientRect(),n=r.left,i=r.top,a=r.width,l=r.height,s=o("div","".concat(Me.a,"-tooltip")).html(e).show();document.body.appendChild(s.el);var u=s.box();s.css("left","".concat(n+a/2-u.width/2,"px")).css("top","".concat(i+l+2,"px")),Ce(t,"mouseleave",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)})),Ce(t,"click",(function(){document.body.contains(s.el)&&document.body.removeChild(s.el)}))}}(e,t.target)})).attr("data-tooltip",e)}function Ji(){return o("div","".concat(Me.a,"-toolbar-divider"))}function ea(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return Qi(e).child((r=t,new mt(r))).on("click",(function(){return n()}))}function ta(){var e=this;this.ddFormat.change=function(t){return e.change("format",t.key)},this.ddFont.change=function(t){return e.change("font-name",t.key)},this.ddFormula.change=function(t){return e.change("formula",t.key)},this.ddFontSize.change=function(t){return e.change("font-size",t.pt)},this.ddTextColor.change=function(t){return e.change("color",t)},this.ddFillColor.change=function(t){return e.change("bgcolor",t)},this.ddAlign.change=function(t){return e.change("align",t)},this.ddVAlign.change=function(t){return e.change("valign",t)},this.ddBorder.change=function(t){return e.change("border",t)},this.undoEl.change=function(t){return e.change("undo",t)}}function ra(e){var t=e,r=e.split("-");r.length>1&&r.forEach((function(e,r){0===r?t=e:t+=e[0].toUpperCase()+e.substring(1)}));var n=this["".concat(t,"El")];n.toggle(),this.change(e,n.hasClass("active"))}var na=function(e){function t(){var e;qi(this,t);var r=new mt("ellipsis"),n=o("div","".concat(Me.a,"-toolbar-more"));return(e=$i(this,Ki(t).call(this,r,"auto",!1,"bottom-right",!1,n))).moreBtns=n,e.contentEl.css("max-width","420px"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zi(e,t)}(t,e),t}(An);function ia(){this.btns2=this.btnChildren.map((function(e){var t=e.box(),r=e.computedStyle(),n=r.marginLeft,i=r.marginRight;return[e,t.width+parseInt(n,10)+parseInt(i,10)]}))}function aa(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.widthFn,n=this.el,i=this.btns,a=this.moreEl,o=this.ddMore,l=this.btns2,s=o.moreBtns,u=o.contentEl;n.css("width","".concat(r()-60,"px"));var c=n.box(),f=160,h=12,p=[],v=[];l.forEach((function(e,t){var r=Xi(e,2),n=r[0],i=r[1];f+=i,t===l.length-1||f<c.width?p.push(n):(h+=i,v.push(n))})),(e=i.html("")).children.apply(e,p),(t=s.html("")).children.apply(t,v),u.css("width","".concat(h,"px")),v.length>0?a.show():a.hide()}var oa=function(){function e(t,r){var n,i=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];qi(this,e),this.data=t,this.change=function(){},this.widthFn=r;var l=t.defaultStyle();this.ddFormat=new ei,this.ddFont=new Dn,this.ddFormula=new oi,this.ddFontSize=new Bn,this.ddTextColor=new hi("text-color",l.color),this.ddFillColor=new hi("fill-color",l.bgcolor),this.ddAlign=new bi(["left","center","right"],l.align),this.ddVAlign=new bi(["top","middle","bottom"],l.valign),this.ddBorder=new Pi,this.ddMore=new na,this.undoEl=new Ui("undo",(function(){return i.change("undo")}),(function(e){return i.change("undoList",e)})),this.redoEl=new Ui("redo",(function(){return i.change("redo")}),(function(e){return i.change("redoList",e)})),this.btnChildren=[Qi("".concat(c("toolbar.undo"))).child(this.undoEl.el),Qi("".concat(c("toolbar.redo"))).child(this.redoEl.el),this.paintformatEl=ea("".concat(c("toolbar.paintformat")),"paintformat",(function(){return ra.call(i,"paintformat")})),this.clearformatEl=ea("".concat(c("toolbar.clearformat")),"clearformat",(function(){return i.change("clearformat")})),Ji(),Qi("".concat(c("toolbar.format"))).child(this.ddFormat.el),Ji(),Qi("".concat(c("toolbar.font"))).child(this.ddFont.el),Qi("".concat(c("toolbar.fontSize"))).child(this.ddFontSize.el),Ji(),this.fontBoldEl=ea("".concat(c("toolbar.fontBold")," (Ctrl+B)"),"bold",(function(){return ra.call(i,"font-bold")})),this.fontItalicEl=ea("".concat(c("toolbar.fontItalic")," (Ctrl+I)"),"italic",(function(){return ra.call(i,"font-italic")})),this.underlineEl=ea("".concat(c("toolbar.underline")," (Ctrl+U)"),"underline",(function(){return ra.call(i,"underline")})),this.strikeEl=ea("".concat(c("toolbar.strike")),"strike",(function(){return ra.call(i,"strike")})),Qi("".concat(c("toolbar.textColor"))).child(this.ddTextColor.el),Ji(),Qi("".concat(c("toolbar.fillColor"))).child(this.ddFillColor.el),Qi("".concat(c("toolbar.border"))).child(this.ddBorder.el),this.mergeEl=ea("".concat(c("toolbar.merge")),"merge",(function(){return ra.call(i,"merge")})),Ji(),Qi("".concat(c("toolbar.align"))).child(this.ddAlign.el),Qi("".concat(c("toolbar.valign"))).child(this.ddVAlign.el),this.textwrapEl=ea("".concat(c("toolbar.textwrap")),"textwrap",(function(){return ra.call(i,"textwrap")})),Ji(),this.freezeEl=ea("".concat(c("toolbar.freeze")),"freeze",(function(){return ra.call(i,"freeze")})),this.addEl=ea("".concat(c("toolbar.add")),"add",(function(){return ra.call(i,"add")})),this.closeEl=ea("".concat(c("toolbar.calc")),"close",(function(){return ra.call(i,"close")})),this.autofilterEl=ea("".concat(c("toolbar.autofilter")),"autofilter",(function(){return ra.call(i,"autofilter")})),this.throwFormulaEl=ea("".concat(c("toolbar.throwFormula")),"chevron-right",(function(){return ra.call(i,"throwFormula")})),this.moreEl=Qi("".concat(c("toolbar.more"))).child(this.ddMore.el).hide()],this.el=o("div","".concat(Me.a,"-toolbar")),this.btns=(n=o("div","".concat(Me.a,"-toolbar-btns"))).children.apply(n,Yi(this.btnChildren)),this.el.child(this.btns),a&&this.el.hide(),ta.call(this),this.reset(),setTimeout((function(){ia.call(i),aa.call(i)}),0),Ce(window,"resize",(function(){aa.call(i,t.settings.view.width)}))}var t,r,n;return t=e,(r=[{key:"paintformatActive",value:function(){return this.paintformatEl.hasClass("active")}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(e){ra.call(this,e)}},{key:"reset",value:function(){var e=this.data,t=e.getSelectedCellStyle(),r=e.getSelectedCell();this.undoEl.disabled(!e.canUndo()),this.redoEl.disabled(!e.canRedo()),this.mergeEl.active(e.canUnmerge()).disabled(!e.selector.multiple()),this.autofilterEl.active(!e.canAutofilter());var n=t.font;this.ddFont.setTitle(n.name),this.ddFontSize.setTitle(n.size),this.fontBoldEl.active(n.bold),this.fontItalicEl.active(n.italic),this.underlineEl.active(t.underline),this.strikeEl.active(t.strike),this.ddTextColor.setTitle(t.color),this.ddFillColor.setTitle(t.bgcolor),this.ddAlign.setTitle(t.align),this.ddVAlign.setTitle(t.valign),this.textwrapEl.active(t.textwrap),this.addEl.active(e.equationIsActive()),this.closeEl.active(!1),this.throwFormulaEl.active(!1),this.freezeEl.active(e.freezeIsActive()),r&&r.format&&this.ddFormat.setTitle(r.format)}}])&&Wi(t.prototype,r),n&&Wi(t,n),e}();function la(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function sa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ua=function(){function e(t,r){var n,i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title=t,this.el=o("div","".concat(Me.a,"-modal")).css("width",a).children(o("div","".concat(Me.a,"-modal-header")).children(new mt("close").on("click.stop",(function(){return i.hide()})),this.title),(n=o("div","".concat(Me.a,"-modal-content"))).children.apply(n,la(r))).hide(),this.open=!1}var t,r,n;return t=e,(r=[{key:"show",value:function(){var e=this;this.dimmer=o("div","".concat(Me.a,"-dimmer active")),document.body.appendChild(this.dimmer.el);var t=this.el.show().box(),r=t.width,n=t.height,i=document.documentElement,a=i.clientHeight,l=i.clientWidth;this.el.offset({left:(l-r)/2,top:(a-n)/3}),window.xkeydownEsc=function(t){27===t.keyCode&&e.hide()},this.open=!0,Ce(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),this.open=!1,document.body.removeChild(this.dimmer.el),Ne(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&sa(t.prototype,r),n&&sa(t,n),e}();function ca(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fa=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vchange=function(){},this.el=o("div","".concat(Me.a,"-form-input")),this.input=o("input","").css("width",t).on("input",(function(e){return n.vchange(e)})).attr("placeholder",r),this.el.child(this.input)}var t,r,n;return t=e,(r=[{key:"hint",value:function(e){this.input.attr("placeholder",e)}},{key:"val",value:function(e){return this.input.val(e)}}])&&ca(t.prototype,r),n&&ca(t,n),e}();function ha(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var pa=function(){function e(t,r,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t,this.getTitle=a,this.vchange=function(){},this.el=o("div","".concat(Me.a,"-form-select")),this.suggest=new ft(r.map((function(e){return{key:e,title:i.getTitle(e)}})),(function(e){i.itemClick(e.key),l(e.key),i.vchange(e.key)}),n,this.el),this.el.children(this.itemEl=o("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",(function(){return i.show()}))}var t,r,n;return t=e,(r=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(e){this.key=e,this.itemEl.html(this.getTitle(e))}},{key:"val",value:function(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}])&&ha(t.prototype,r),n&&ha(t,n),e}();function va(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var da={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},ga=function(){function e(t,r,n,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label="",this.rule=r,n&&(this.label=o("label","label").css("width","".concat(i,"px")).html(n)),this.tip=o("div","tip").child("tip").hide(),this.input=t,this.input.vchange=function(){return a.validate()},this.el=o("div","".concat(Me.a,"-form-field")).children(this.label,t.el,this.tip)}var t,r,n;return t=e,(r=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(e){return this.input.val(e)}},{key:"hint",value:function(e){this.input.hint(e)}},{key:"validate",value:function(){var e=this.input,t=this.rule,r=this.tip,n=this.el,i=e.val();return t.required&&/^\s*$/.test(i)?(r.html(c("validation.required")),n.addClass("error"),!1):!t.type&&!t.pattern||(t.pattern||da[t.type]).test(i)?(n.removeClass("error"),!0):(r.html(c("validation.notMatch")),n.addClass("error"),!1)}}])&&va(t.prototype,r),n&&va(t,n),e}();function ma(e){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ya(e,t){return!t||"object"!==ma(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ba(e){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e,t){return(wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xa=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ya(this,ba(t).call(this,"div","".concat(Me.a,"-button ").concat(n)))).child(c("button.".concat(e))),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wa(e,t)}(t,e),t}(a);function Ea(e){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ca(e,t){return!t||"object"!==Ea(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ka(e){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Na(e,t){return(Na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ta=100,Aa=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new ga(new pa("cell",["cell"],"100%",(function(e){return c("dataValidation.modeType.".concat(e))})),{required:!0},"".concat(c("dataValidation.range"),":"),Ta),n=new ga(new fa("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new ga(new pa("list",["list","number","date","phone","email"],"100%",(function(e){return c("dataValidation.type.".concat(e))}),(function(t){return e.criteriaSelected(t)})),{required:!0},"".concat(c("dataValidation.criteria"),":"),Ta),a=new ga(new pa("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(e){return c("dataValidation.operator.".concat(e))}),(function(t){return e.criteriaOperatorSelected(t)})),{required:!0}).hide(),l=new ga(new fa("70px","10"),{required:!0}).hide(),s=new ga(new fa("70px","100"),{required:!0,type:"number"}).hide(),u=new ga(new fa("120px","a,b,c"),{required:!0}),f=new ga(new fa("70px","10"),{required:!0,type:"number"}).hide();return(e=Ca(this,ka(t).call(this,c("contextmenu.validation"),[o("div","".concat(Me.a,"-form-fields")).children(r.el,n.el),o("div","".concat(Me.a,"-form-fields")).children(i.el,a.el,l.el,s.el,f.el,u.el),o("div","".concat(Me.a,"-buttons")).children(new xa("cancel").on("click",(function(){return e.btnClick("cancel")})),new xa("remove").on("click",(function(){return e.btnClick("remove")})),new xa("save","primary").on("click",(function(){return e.btnClick("save")})))]))).mf=r,e.rf=n,e.cf=i,e.of=a,e.minvf=l,e.maxvf=s,e.vf=f,e.svf=u,e.change=function(){},e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Na(e,t)}(t,e),r=t,(n=[{key:"showVf",value:function(e){var t="date"===e?"2018-11-12":"10",r=this.vf;r.input.hint(t),r.show()}},{key:"criteriaSelected",value:function(e){var t=this.of,r=this.minvf,n=this.maxvf,i=this.vf,a=this.svf;"date"===e||"number"===e?(t.show(),r.rule.type=e,n.rule.type=e,"date"===e?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),i.hide(),a.hide()):("list"===e?a.show():a.hide(),i.hide(),t.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(e){if(e){var t=this.minvf,r=this.maxvf,n=this.vf;if("be"===e||"nbe"===e)t.show(),r.show(),n.hide();else{var i=this.cf.val();n.rule.type=i,"date"===i?n.hint("2018-11-12"):n.hint("10"),n.show(),t.hide(),r.hide()}}}},{key:"btnClick",value:function(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){for(var t=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<t.length;r+=1){var n=this[t[r]];if(n.isShow()&&!n.validate())return}var i=this.mf.val(),a=this.rf.val(),o=this.cf.val(),l=this.of.val(),s=this.svf.val();"number"!==o&&"date"!==o||(s="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,a,{type:o,operator:l,required:!1,value:s}),this.hide()}}},{key:"setValue",value:function(e){if(e){var t=this.mf,r=this.rf,n=this.cf,i=this.of,a=this.svf,o=this.vf,l=this.minvf,s=this.maxvf,u=e.mode,c=e.ref,f=e.validator||{type:"list"},h=f.type,p=f.operator,v=f.value;t.val(u||"cell"),r.val(c),n.val(h),i.val(p),Array.isArray(v)?(l.val(v[0]),s.val(v[1])):(a.val(v||""),o.val(v||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&Oa(r.prototype,n),i&&Oa(r,i),t}(ua);function Ia(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Sa(e){return o("div","".concat(Me.a,"-item ").concat(e))}function ja(e){var t=this;return Sa("state").child(c("sort.".concat(e))).on("click.stop",(function(){return t.itemClick(e)}))}function Ma(e){var t=this,r=this.filterbEl,n=this.filterValues;r.html("");var i=Object.keys(e);console.log("20"),i.forEach((function(i,a){var l=e[i],s=n.includes(i)?"checked":"";r.child(o("div","".concat(Me.a,"-item state ").concat(s)).on("click.stop",(function(){return t.filterClick(a,i)})).children(""===i?c("filter.empty"):i,o("div","label").html("(".concat(l,")"))))}))}function Ra(){var e=this.filterhEl,t=this.filterValues,r=this.values;e.html("".concat(t.length," / ").concat(r.length)),e.checked(t.length===r.length)}var Da=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterbEl=o("div","".concat(Me.a,"-body")),this.filterhEl=o("div","".concat(Me.a,"-header state")).on("click.stop",(function(){return t.filterClick(0,"all")})),this.tindex=1,this.el=o("div","".concat(Me.a,"-sort-filter")).children(this.sortAscEl=ja.call(this,"asc"),this.sortDescEl=ja.call(this,"desc"),Sa("divider"),o("div","".concat(Me.a,"-filter")).children(this.filterhEl,this.filterbEl),o("div","".concat(Me.a,"-buttons")).children(new xa("cancel").on("click",(function(){return t.btnClick("cancel")})),new xa("ok","primary").on("click",(function(){return t.btnClick("ok")})))).hide(),this.el.on("mousedown.stop",(function(e){t.tindex=1})),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var t,r,n;return t=e,(r=[{key:"btnClick",value:function(e){if("ok"===e){var t=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(t,r,"in",n)}this.hide()}},{key:"itemClick",value:function(e){this.sort=e;var t=this.sortAscEl,r=this.sortDescEl;t.checked("asc"===e),r.checked("desc"===e)}},{key:"filterClick",value:function(e,t){var r=this.filterbEl,n=this.filterValues,i=this.values,a=r.children();"all"===t?a.length===n.length?(this.filterValues=[],a.forEach((function(e){return o(e).checked(!1)}))):(this.filterValues=Array.from(i),a.forEach((function(e){return o(e).checked(!0)}))):o(a[e]).toggle("checked")?n.push(t):n.splice(n.findIndex((function(e){return e===t})),1),Ra.call(this)}},{key:"set",value:function(e,t,r,n){this.ci=e;var i=this.sortAscEl,a=this.sortDescEl;null!==n?(this.sort=n.order,i.checked(n.asc()),a.checked(n.desc())):(this.sortDesc=null,i.checked(!1),a.checked(!1)),this.values=Object.keys(t),this.filterValues=r?Array.from(r.value):Object.keys(t),Ma.call(this,t,r),Ra.call(this)}},{key:"setOffset",value:function(e){var t=this;if(this.el.isShow())this.hide();else{this.el.offset(e).show();var r=1;console.log(this.el),Ie(this.el,(function(){0===r&&t.hide(),r=0}))}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),Te(this.el)}}])&&Ia(t.prototype,r),n&&Ia(t,n),e}();function _a(e,t){var r=o("div","".concat(Me.a,"-toast")),n=o("div","".concat(Me.a,"-dimmer active"));r.children(o("div","".concat(Me.a,"-toast-header")).children(new mt("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),e),o("div","".concat(Me.a,"-toast-content")).html(t)),document.body.appendChild(r.el),document.body.appendChild(n.el);var i=r.box(),a=i.width,l=i.height,s=document.documentElement,u=s.clientHeight,c=s.clientWidth;r.offset({left:(c-a)/2,top:(u-l)/3})}function Pa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var La=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=o("div","".concat(Me.a,"-advice")).children(this.save=o("div","".concat(Me.a,"-advice-style")).css("border-bottom","1px solid"),this.text=o("div","".concat(Me.a,"-advice-style"))).hide(),this.save.children(this.saveCheck=o("span","check").hide("visibility","hidden"),o("span","").html("保留样式")),this.text.children(this.textCheck=o("span","check").hide("visibility","hidden"),o("span","").html("仅文本")),this.data=t,this.sheet=r,this.old_rows="",this.new_rows="",this.left=0,this.top=0,this.save.on("mousedown.stop",(function(e){n.saveCheck.show("visibility","initial"),n.textCheck.hide("visibility","hidden"),n.sheet.setCellRange(n.reference,n.tableProxy,!0),mo.call(n.sheet)})),this.text.on("mousedown.stop",(function(e){n.sheet.setCellRange(n.reference,n.tableProxy,!1),n.saveCheck.show("visibility","hidden"),n.textCheck.hide("visibility","initial"),mo.call(n.sheet)}))}var t,r,n;return t=e,(r=[{key:"show",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.el.css("left","".concat(e,"px")),this.el.css("top","".concat(t,"px")),1==r&&(this.saveCheck.show("visibility","initial"),this.textCheck.hide("visibility","hidden")),this.left=parseInt(e),this.top=parseInt(t),this.tableProxy=i,this.reference=n,this.el.show()}}])&&Pa(t.prototype,r),n&&Pa(t,n),e}();function Fa(e){e.preventDefault();var t=Ha.call(this);if(t)e.clipboardData&&(e.clipboardData.setData("text/html",Va(t.img2)),e.clipboardData.setData("text/plain",""));else{var r=Ba.call(this);e.clipboardData&&(e.clipboardData.setData("text/html",Va(r.html.el)),e.clipboardData.setData("text/plain",r.plain))}}function Ha(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++)if(!0===e[t].state)return this.container.css("pointer-events","auto"),e[t];return null}function Ba(){for(var e={plain:"",html:o("table","")},t=this.data,r=t.selector,n=t.rows,i=t.styles,a=r.range,l=a.sri,s=a.eri,u=a.sci,c=a.eci,f=o("tbody",""),h=l;h<=s;h+=1){for(var p=o("tr",""),v=u;v<=c;v+=1){var d=o("td","");if(n._[h]&&n._[h].cells&&n._[h].cells[v]){if(n._[h].cells[v]&&i[n._[h].cells[v].style]){if(d.css("color",i[n._[h].cells[v].style].color),i[n._[h].cells[v].style]&&i[n._[h].cells[v].style].font&&i[n._[h].cells[v].style].font.bold){var g=i[n._[h].cells[v].style].font.bold?"900":"";d.css("font-weight",g)}d.css("background",i[n._[h].cells[v].style].bgcolor)}n._[h].cells[v].text||(n._[h].cells[v].text=""),n._[h].cells[v].formulas||(n._[h].cells[v].formulas="");var m=""!=n._[h].cells[v].formulas?n._[h].cells[v].formulas:n._[h].cells[v].text;if(n._[h].cells[v].formulas&&Object(F.cutStr)(n._[h].cells[v].formulas,!1,!0).length>0){var y=o("reference","");y.html(m),y.attr("ri",h),y.attr("ci",v),d.child(y.el)}else d.html(m);e.plain+=m,e.plain+="\t"}else e.plain+="\t";p.child(d)}f.child(p),e.plain+="\n"}return e.html.child(f),e}function Va(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function za(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ua=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.el=o("div","".concat(Me.a,"-hyperlink-tooltip")).hide(),this.tableEl=o("div","".concat(Me.a,"-hyperlink-tooltip")).hide(),this.editor=r,this.tableEl.attr("tabindex",0),this.tableEl.css("overflow-y","auto"),this.tableEl.css("max-height","400px"),Ce(this.tableEl.el,"paste",(function(e){e.stopPropagation()})),Ce(this.tableEl.el,"copy",(function(e){e.stopPropagation()})),Ce(this.tableEl.el,"keydown",(function(e){e.stopPropagation()})),Ce(this.tableEl.el,"keyup",(function(e){e.stopPropagation()})),this.timer=null,this.timer2=null}var t,r,n;return t=e,(r=[{key:"show",value:function(e,t){var r=this;if(this.editor.isDisplay2())return this.el.hide(),void this.tableEl.hide();var n=this.data,i=n.getCellTextOrDefault(e,t)+"";if(clearTimeout(this.timer),clearTimeout(this.timer2),0==Me.c.indexOf(i.split("!")[0])){var a=n.getRect(new E.b(e,t,e,t)),l=a.left+55,s=a.top+50,u=JSON.parse(i.substring(i.indexOf("!")+1,i.length));this.tableEl.css("left","".concat(l,"px")),this.tableEl.css("top","".concat(s,"px")),this.tableEl.css("user-select","text"),this.tableEl.html("");var c=o("table","");c.css("border-spacing","0px");var f=o("tr","");f.children(o("td","").css("border","1px solid black").html("序号"),o("td","").css("border","1px solid black").html("项目名称"),o("td","").css("border","1px solid black").html("城市"),o("td","").css("border","1px solid black").html("占地面积"),o("td","").css("border","1px solid black").html("差额")),c.children(f);for(var h=0;h<u.length;h++){var p=u[h],v=p.number,d=p.name,g=p.city,m=p.area,y=p.value,b=o("tr",""),w=o("td","");w.html(v),w.css("border","1px solid black");var x=o("td","");x.html(d),x.css("border","1px solid black");var O=o("td","");O.html(g),O.css("border","1px solid black");var C=o("td","");C.html(m),C.css("border","1px solid black");var k=o("td","");k.html(y),k.css("border","1px solid black"),b.children(w,x,O,C,k),c.children(b)}this.tableEl.children(c),this.timer=setTimeout((function(){r.tableEl.show(),r.el.hide()}),150)}else{var N=function(e){return 1===Me.c.indexOf(e.split("!")[0])?{state:!0,text:JSON.parse(e.split("!")[1]).url}:{state:!1,text:""}}(i);if(N.state&&(i=N.text),"http://"!==(i="www"==i.substr(0,3).toLowerCase()?"http://"+i:i).substr(0,7).toLowerCase()&&"https://"!==i.substr(0,8).toLowerCase())return this.el.hide(),void this.tableEl.hide();var T=n.getRect(new E.b(e,t,e,t)),A=T.left+55,I=T.top+5;this.el.html(""),this.el.css("color","blue"),this.el.children(o("div","aaa").css("border-bottom","1px solid blue").on("click",(function(e){console.log(e);var t=e.screenX,r=e.screenY;window.open(i,"","width=".concat(650,",height=").concat(500,",left=").concat(t+T.width,",top=").concat(r))})).html(i)),this.el.css("left","".concat(A,"px")),this.el.css("top","".concat(I,"px")),this.timer2=setTimeout((function(){r.el.show(),r.tableEl.hide()}),150)}}}])&&za(t.prototype,r),n&&za(t,n),e}();function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xa(e,t){return!t||"object"!==Ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ga(e,t,r){return(Ga="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qa(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function qa(e){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $a(e,t){return($a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ka=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=o("span","").html("您输入的公式好像至少缺少一个左括号");return(e=Xa(this,qa(t).call(this,c("contextmenu.errorPop"),[o("div","".concat(Me.a,"-form-fields")).children(r),o("div","".concat(Me.a,"-form-fields")),o("div","".concat(Me.a,"-buttons")).children(new xa("ok","primary").on("click",(function(){return e.btnClick("ok")})))]))).tip=r,e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$a(e,t)}(t,e),r=t,(n=[{key:"show",value:function(e){this.tip.html(e),Ga(qa(t.prototype),"show",this).call(this)}},{key:"btnClick",value:function(e){"ok"===e&&this.hide()}}])&&Wa(r.prototype,n),i&&Wa(r,i),t}(ua);function Za(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Qa=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rect=t}var t,r,n;return t=e,(r=[{key:"isLocInside",value:function(e,t){var r=this.rect;return e<r.width+r.left&&e>r.left&&t-Me.f>r.top&&t-Me.f<r.top+r.height}},{key:"getUpDownLeftRight",value:function(e,t,r,n){var i=this.rect,a=0;return e<i.width+i.left&&e>i.left?t>i.top+i.height+Me.f?a=1:t-Me.f<i.top&&(a=4):t-(i.top-i.height+Me.f)>0&&i.height+i.top+Me.f>t&&(e>i.width+i.left?a=3:e<i.left&&(a=2)),console.log(a),0===a&&(a=Object(F.positionAngle)(r,e,n,t)),1===a&&t<0?a=4:document.body.clientHeight<t&&4===a&&(a=1),3===a&&e<0?a=2:document.body.clientWidth<e&&2===a&&(a=3),a}}])&&Za(t.prototype,r),n&&Za(t,n),e}();function Ja(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var eo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timer=[]}var t,r,n;return t=e,(r=[{key:"push",value:function(e){this.timer.push(e)}},{key:"clear",value:function(){for(var e=0;e<this.timer.length;e++){var t=this.timer[e];clearTimeout(t),clearInterval(t)}}}])&&Ja(t.prototype,r),n&&Ja(t,n),e}();function to(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ro(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function no(e){for(var t=[],r=0;r<e.length;r++)Object(P.isHave)(e[r])&&Object(P.isHave)(e[r].expr)&&t.push(e[r].expr),Object(P.isHave)(e[r])&&Object(P.isHave)(e[r].cell)&&Object(P.isHave)(e[r].cell.depend)&&t.push.apply(t,ro(e[r].cell.depend)),Object(P.isHave)(e[r])&&Object(P.isHave)(e[r].cell)&&Object(P.isHave)(e[r].cell.multivalueRefsCell)&&t.push(e[r].cell.multivalueRefsCell);return t}var io=function(){function e(t,r){var n=t.type,i=void 0===n?-1:n,a=t.action,o=void 0===a?"":a,l=t.ri,s=void 0===l?-1:l,u=t.ci,c=void 0===u?-1:u,f=t.oldData,h=void 0===f?"":f,p=t.newData,v=void 0===p?"":p,d=t.expr,g=void 0===d?"":d,m=t.oldStep,y=void 0===m?"":m,b=t.cellRange,w=void 0===b?"":b,x=t.cells,E=void 0===x?{}:x,O=t.height,C=void 0===O?-1:O,k=t.width,N=void 0===k?-1:k,T=t.oldCell,A=void 0===T?{}:T,I=t.newCell,S=void 0===I?{}:I,j=t.newMergesData,M=void 0===j?"":j,R=t.oldMergesData,D=void 0===R?"":R,_=t.property,P=void 0===_?"":_,L=t.value,F=void 0===L?"":L;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=i,this.action=o,this.ri=s,this.ci=c,this.expr=g,this.cellRange=w,this.cells=E,this.height=C,this.width=N,this.oldCell=A,this.newCell=S,this.oldMergesData=D,this.newMergesData=M,this.property=P,this.value=F,this.oldStep=y,this.oldData=h,this.newData=v,this.data=r}var t,r,n;return t=e,(r=[{key:"findAllNeedCalcCell",value:function(){var e,t,r=[],n=this.oldCell,i=this.newCell,a=this.ri,o=this.ci;return(e=r).push.apply(e,ro(no(n))),(t=r).push.apply(t,ro(no(i))),-1!==a&&-1!==o&&r.push(Object(L.xy2expr)(o,a)),r=Object(F.distinct)(r)}},{key:"restore",value:function(e,t,r){var n=this.type;if(1===n){var i=this.oldCell,a=this.newCell,o="";o=1===r?Object(F.deepCopy)(i):Object(F.deepCopy)(a);for(var l=0;l<o.length;l++){var s=o[l],u=s.cell,c=s.ri,f=s.ci;e.rows.setCellText(c,f,u,"cell")}}else if(13===n){var h=this.oldData,p=this.newData,v="";v=1===r?Object(F.deepCopy)(p):Object(F.deepCopy)(h),e.setData(v)}else if(2===n||5===n||6===n||11===n||12===n){var d=this.newCell,g=this.oldCell,m=this.oldMergesData,y=this.newMergesData,b=(this.cellRange,this.property),w=(this.value,"");w=1===r?Object(F.deepCopy)(g):Object(F.deepCopy)(d),"merge"===b&&(1===r?this.data.merges.setData(m):this.data.merges.setData(y));for(var x=0;x<w.length;x++){var E=w[x],O=E.cell,C=E.ri,k=E.ci;e.rows.setCellText(C,k,O,"cell")}}else if(3===n){var N=this.ri,T=this.height,A=this.oldStep;1===r?e.rows.setHeight(N,A.height):e.rows.setHeight(N,T)}else if(4===n){var I=this.ci,S=this.width,j=this.oldStep;1===r?e.cols.setWidth(I,j.width):e.cols.setWidth(I,S)}}}])&&to(t.prototype,r),n&&to(t,n),e}();function ao(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function oo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lo(){var e=this.data,t=this.verticalScrollbar,r=this.horizontalScrollbar,n=e.getSelectedRect(),i=n.l,a=n.t,o=n.left,l=n.top,s=n.width,u=n.height,c=this.getTableOffset();if(Math.abs(o)+s>c.width)r.move({left:i+s-c.width});else{var f=e.freezeTotalWidth();o<f&&r.move({left:i-1-f})}if(Math.abs(l)+u>c.height)t.move({top:a+u-c.height-1});else{var h=e.freezeTotalHeight();l<h&&t.move({top:a-1-h})}}function so(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==t||-1!==r){var a=this.table,o=this.selector,l=this.toolbar;e?o.setEnd(t,r,i,!0):o.set(t,r,n),l.reset(),clearTimeout(this.render_timer),this.render_timer=setTimeout((function(){a.render()}),100)}}function uo(e,t){var r=this.selector,n=this.data,i=this.editor,a=n.rows,o=n.cols;i.isCors&&(r.indexes=[i.ri,i.ci]);var l=oo(r.indexes,2),s=l[0],u=l[1],c=r.range,f=(c.eri,c.eci);if(e){var h=oo(r.moveIndexes,2);s=h[0],u=h[1]}"left"===t?u>0&&(u-=1):"right"===t?(f!==u&&(u=f),u<o.len-1&&(u+=1)):"up"===t?s>0&&(s-=1):"down"===t?s<a.len-1&&(s+=1):"row-first"===t?u=0:"row-last"===t?u=o.len-1:"col-first"===t?s=0:"col-last"===t&&(s=a.len-1),e&&(r.moveIndexes=[s,u]),r.selectCell.setData(s,u),r.selectCell.resetSelectOffset(),so.call(this,e,s,u),Lo.call(this),lo.call(this)}function co(e){if(0===e.buttons&&e.target.className!=="".concat(Me.a,"-resizer-hover")){var t=e.offsetX,r=e.offsetY,n=this.rowResizer,i=this.colResizer,a=this.tableEl,o=this.data,l=this.website,s=o.getCellRectByXY(e.offsetX,e.offsetY);l.show(s.ri,s.ci);var u=o.rows,c=o.cols;if(t>c.indexWidth&&r>u.height)return n.hide(),void i.hide();var f=a.box();s.ri>=0&&-1===s.ci?(s.width=c.indexWidth,n.show(s,{width:f.width})):n.hide(),-1===s.ri&&s.ci>=0?(s.height=u.height,i.show(s,{height:f.height})):i.hide()}}function fo(e){var t=this.verticalScrollbar,r=this.data,n=r.settings.autoLoad,i=t.scroll().top,a=e.deltaY,o=r.rows;if(e.detail&&(a=40*e.detail),a>0&&1==n){var l=r.scroll.ri+1;l<o.len&&t.move({top:i+o.getHeight(l)-1})}else if(1==n){var s=r.scroll.ri-1;s>=0&&t.move({top:0===s?0:i-o.getHeight(s)})}}function ho(e,t){var r=this.verticalScrollbar,n=this.horizontalScrollbar,i=r.scroll().top,a=n.scroll().left;"left"===e||"right"===e?n.move({left:a-t}):"up"!==e&&"down"!==e||r.move({top:i-t})}function po(){var e=this.data,t=this.verticalScrollbar,r=this.getTableOffset().height;t.set(r,e.rows.totalHeight())}function vo(){var e=this.data,t=this.horizontalScrollbar,r=this.getTableOffset().width;e&&t.set(r,e.cols.totalWidth())}function go(){var e=this.selector,t=this.data,r=this.editor,n=oo(t.freeze,2),i=n[0],a=n[1];if(i>0||a>0){var o=t.freezeTotalWidth(),l=t.freezeTotalHeight();r.setFreezeLengths(o,l)}e.resetAreaOffset()}function mo(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=this.tableEl,t=this.overlayerEl,r=this.overlayerCEl,n=this.table,i=this.toolbar,a=this.selector,o=this.el,l=this.getTableOffset(),s=this.getRect();e.attr(s),t.offset(s),r.offset(l),o.css("width","".concat(s.width,"px")),Uo.call(this),Yo.call(this),po.call(this),vo.call(this),go.call(this),a.selectCell.toolbarChangeSelectorCell(),n.render(),i.reset(),a.reset()}function yo(){var e=this.data,t=this.selector;e.clearClipboard(),t.hideClipboard()}function bo(){var e=this.data,t=this.selector;e.copy(),t.showClipboard()}function wo(){var e=this.data,t=this.selector;e.cut(),t.showClipboard()}function xo(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e&&(yo.call(t),mo.call(t))},n=this.data.paste(e,(function(e){return _a("Tip",e)}));return r(n),n}function Eo(){this.data.autofilter(),mo.call(this)}function Oo(){var e=this,t=this.toolbar,r=this.data;t.paintformatActive()&&(r.paintFormatChange((function(t,r){so.call(e,!0,t,r,!0,!0)})),yo.call(this),t.paintformatToggle(),t.reset())}function Co(e,t,r,n,i,a,o){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0;this.selector.setBoxinner("none"),this.container.css("pointer-events","none");var f=n.getCellRectByXYWithNotTotalResult(e.layerX||e.clientX,e.layerY||e.clientY),h=f.ri,p=f.ci;if(t){var v=ko.call(this,n,r,i,u,s,e,a,c,h,p,l),d=v.rpos,g=v.ey,m=v.ex,y=r.showAutofill(h,p,d);Object(P.isOusideViewRange)(this.data.settings.view.height(),this.data.settings.view.width(),g,m,y)&&Ao.call(this,y,i,u,c,a,n)}else if(1===e.buttons&&!e.shiftKey){h=h<=0?0:h,p=p<=0?0:p;var b=n.viewRange().getMovePos(h,p);No.call(this,b,i,u,c,a,n),console.log("ri: ",h,"ci: ",p),so.call(this,!0,h,p,!0,!0)}}function ko(e,t,r,n,i,a,o,l,s,u,c){var f=e.getRect(t.range),h=new Qa(f),p=f.width+f.left,v=f.height+f.top+Me.f,d=a.clientX-i.l-Me.e,g=a.clientY;return h.isLocInside(d,g)?(c=-1,t.arange=null):c=h.getUpDownLeftRight(d,g,p,v),{rpos:c,ex:d,ey:g}}function No(e,t,r,n,i,a){2===e?To.call(this,1,t,r,i,a,n):6===e?To.call(this,2,t,r,i,a,n):3===e?To.call(this,4,t,r,i,a,n):5===e?To.call(this,3,t,r,i,a,n):1===e?(To.call(this,1,t,r,i,a,n),To.call(this,4,t,r,i,a,n)):7===e?(To.call(this,1,t,r,i,a,n),To.call(this,3,t,r,i,a,n)):8===e?(To.call(this,2,t,r,i,a,n),To.call(this,4,t,r,i,a,n)):4===e&&(To.call(this,2,t,r,i,a,n),To.call(this,3,t,r,i,a,n))}function To(e,t,r,n,i,a){if(1===Math.round(Math.random())){var o=0,l=0;if(1===e){var s=t.scroll().top;o=i.scroll.ri+1,t.move({top:s+n.getHeight(o)-1})}else if(2===e){var u=t.scroll().top;o=i.scroll.ri-1,t.move({top:0===o?0:u-n.getHeight(o)})}else if(4===e){var c=r.scroll().left;l=i.scroll.ci+1,r.move({left:c+a.getWidth(l)})}else if(3===e){var f=r.scroll().left;l=i.scroll.ci-1,r.move({left:f-a.getWidth(l)})}}}function Ao(e,t,r,n,i,a){var o=0,l=0;if(44===e){var s=t.scroll().top;o=a.scroll.ri+1,t.move({top:s+i.getHeight(o)-1})}else if(22===e){var u=t.scroll().top;(o=a.scroll.ri-1)>=0&&t.move({top:0===o?0:u-i.getHeight(o)})}else if(33===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var c=r.scroll().left;l=a.scroll.ci+1,r.move({left:c+n.getWidth(l)})}else if(11===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var f=r.scroll().left;l=a.scroll.ci-1,r.move({left:f-n.getWidth(l)})}}function Io(e){var t=this,r=this.selector,n=this.data,i=(this.table,this.sortFilter),a=this.editor,o=this.advice,l=e.offsetX,s=e.offsetY,u=!!Object(P.isHave)(e.corner)||e.target.className==="".concat(Me.a,"-selector-corner"),c=n.getCellRectByXY(l,s),f=c.left,h=c.top,p=c.width,v=c.height,d=c.ri,g=c.ci;a.setRiCi(d,g);var m=n.autoFilter;if(ml.call(this),o.el.hide(),m.includes2(d,g)&&m.getSet(n.exceptRowSet,d),m.includes(d,g)&&f+p-20<l&&h+v-20<s){var y=m.items(g,(function(e,t){return n.rows.getCell(e,t)}));return i.set(g,y,m.getFilter(g),m.getSort(g)),void i.setOffset({left:f,top:h+v+2})}if(!e.shiftKey){u?r.showAutofill(d,g):so.call(this,!1,d,g);var b=this.verticalScrollbar,w=this.horizontalScrollbar,x=n.rows,E=n.cols,O=b.scroll().top;d=n.scroll.ri+1;x.getHeight(d);var C=function(e){for(var t=e.offsetTop,r=e.offsetLeft;e=e.offsetParent;)t+=e.offsetTop,r+=e.offsetLeft;return{t:t,l:r}}(this.el.el);Se(window,(function(i){console.log("dropdown"),jo.call(t),So.call(t,i,u,r,n,b,x,e,C,w,E),Co.call(t,i,u,r,n,b,x,e,0,C,w,E)}),(function(e){jo.call(t),u&&n.autofill(r.arange,"all",(function(e){return _a("Tip",e)}))&&(Sr.call(t),Mo.call(t)),t.selector.setBoxinner("auto"),r.hideAutofill(),Oo.call(t),t.container.css("pointer-events","auto")}))}u||1!==e.buttons||e.shiftKey&&so.call(this,!0,d,g)}function So(e,t,r,n,i,a,o,l,s,u){var c=this,f=setTimeout((function(){var f=setInterval((function(){Co.call(c,e,t,r,n,i,a,o,0,l,s,u)}),50);c.stopTimer2.push(f)}),200);this.stopTimer.push(f)}function jo(){this.stopTimer.clear(),this.stopTimer2.clear()}function Mo(){this.data;var e=this.table;this.editor.display=!0;this.selector.arange=null,Ro.call(this),e.render()}function Ro(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}function Do(e){Go.call(this,{ri:-1,ci:0,left:60,top:0,width:100},e)}function _o(){var e=this.data.getSelectedRect(),t=e.left+e.width+60,r=e.top+e.height+31;this.advice.el.el.style.top="".concat(r,"px"),this.advice.el.el.style.left="".concat(t,"px")}function Po(){var e=this.data,t=this.pictureOffsetLeft,r=this.pictureOffsetTop;this.data.pasteDirectionsArr.forEach((function(n){var i=e.getMoveRect(n.range);n.img.el.style.top="".concat(i.top+r+15*n.number+n.offsetTop,"px"),n.img.el.style.left="".concat(i.left+t+15*n.number+n.offsetLeft,"px")}))}function Lo(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.selector,i=this.data,a=this.editor,o=oo(n.indexes,2),l=o[0],s=o[1];l=-1==t?l:t,s=-1==r?s:r;var u=i.getMoveRect(new E.b(l,s,n.range.eri,n.range.eci)),c=this.getTableOffset(),f="top";u.top>c.height/2&&(f="bottom"),a.setOffset(u,f,e),setTimeout((function(){a.setCursorPos(a.editorText.getText().length)}))}function Fo(){for(var e=0;e<this.selectors.length;e++){var t=this.selectors[e];t.selector.resetSelectorBRLAreaOffset(new E.b(t.ri,t.ci,t.ri,t.ci))}}function Ho(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.selector;return this.overlayerCEl=!0===e?o("div","".concat(Me.a,"-overlayer-content")).children(this.editor.el,this.selectorMoveEl.el,this.selector.el):o("div","".concat(Me.a,"-overlayer-content")).children(this.selectorMoveEl.el)}function Bo(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this.editor,t=this.data,r=this.selector;Lo.call(this),e.setCellEnd(t.getSelectedCell()),this.data.settings.showEditor&&r.el.hide(),yo.call(this),setTimeout((function(){e.setCursorPos(e.editorText.getText().length)}))}function Vo(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrolly(e,(function(){a.display=!1,i.resetBRLAreaOffset(),Po.call(t),_o.call(t),Fo.call(t),Lo.call(t,!1),n.render()}))}function zo(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrollx(e,(function(){a.display=!1,i.resetBRTAreaOffset(),Po.call(t),_o.call(t),Fo.call(t),Lo.call(t,!1),n.render()}))}function Uo(){var e=this.data,t=this.table,r=e.viewRange2(),n=e.settings.style.autoAdapt,i=e.settings.ignoreRi,a=0;if(n){if(r.each((function(e,r){var n=t.getCellTextContent(e,r),a=t.getDrawBox(e,r);if(null!=n){var o=t.getCellTextStyle(e,r),l=Object.assign({},o.font);l.size=vr(l.size);var s=null;null!=o.format||(s=t.draw.selfAdaptionTxtWidth(n,l,a)),(null==t.autoAdaptList[r]||t.autoAdaptList[r]<s)&&e>i-1&&(t.autoAdaptList[r]=s)}})),t.autoAdaptList.length<0)return;for(var o=e.settings.ignore,l=0;l<t.autoAdaptList.length;l++){for(var s=!1,u=0;u<o.length;u++)l==o[u]&&(s=!0);0==s&&(null==t.autoAdaptList[l]?(a+=50,e.cols.setWidth(l,50)):(t.autoAdaptList[l]<30&&(t.autoAdaptList[l]=30),e.cols.setWidth(l,t.autoAdaptList[l]))),a+=t.autoAdaptList[l]}a>0&&(e.settings.cellWidth=function(){return a})}}function Yo(){var e=this.data,t=this.table,r=e.viewRange2(),n=0,i=0,a=e.settings.row.height,o=e.settings.style.autoAdapt,l=0;if(o){r.each((function(r,o){var s=t.getCellTextContent(n,o),u=t.getCellTextStyle(r,o),c=Object.assign({},u.font);c.size=vr(c.size);var f=t.getDrawBox(n,o);if(n!=r&&null!=s){var h=e.rows.getHeight(n);if(a*i!=h){var p=c.size*i+2*f.padding+2*i;e.rows.setHeight(n,p),l+=p}else l+=h;i=0}else if(null!=s&&n==r&&null!=s){var v=t.draw.selfAdaptionHeight(f,s,c);(v>i||0==i)&&(i=v)}n=r}));var s=e.rows.getHeight(n),u=t.getCellTextStyle(s,0),c=Object.assign({},u.font);c.size=vr(c.size);var f=t.getDrawBox(n,0);if(a*i!=s&&l>0){var h=c.size*i+2*f.padding;l+=h,e.rows.setHeight(n,h)}else l>0&&(l+=s)}console.log(503,l),l>0&&(e.settings.view.height=function(){return l+40})}function Wo(e){if(e.target.className==="".concat(Me.a,"-overlayer")){var t=this.selector,r=this.data,n=e.offsetX,i=e.offsetY,a=r.getCellRectByXY(n,i);t.selectCell.setData(a.ri,a.ci),t.selectCell.resetSelectOffset()}}function Xo(e,t){var r=e.ri,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setRowHeight(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),po.call(this),Lo.call(this)}function Go(e,t){var r=e.ci,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setColWidth(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),vo.call(this),Lo.call(this)}function qo(e,t){var r=this.errorPopUp;return e&&!r.open?(r.show(t),{state:!0,msg:t}):r.open?(r.hide(),{state:!0,msg:t}):{state:!1,msg:t}}function $o(e,t,r,n){var i=r.text,a=r.style,o=(arguments.length>4&&void 0!==arguments[4]&&arguments[4],this.data),l=this.editor,s=o.selectorCellText(e,t,i+"",n);return!(!s.state||!(s=qo.call(this,!0,s.msg)).state)||(o.setCellText(e,t,{text:i,style:a}),l.setRiCi(-1,-1),!1)}function Ko(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table,i=this.editor,a=r.selector,o=a.ri,l=a.ci;i.ri!=o&&-1!=i.ri||i.ci!=l&&-1!=i.ci||(r.setSelectedCellText(e,t),"finished"===t&&n.render())}function Zo(){this.data.throwFormula()}function Qo(e){var t=this.data;"insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e&&t.deleteCell("text"),yo.call(this),mo.call(this)}function Jo(e,t){var r=this.data;if("undo"===e)this.undo();else if("undoList"===e)t.setContent(r.historyList(1));else if("redoList"===e)t.setContent(r.historyList(2));else if("redo"===e)this.redo();else if("print"===e);else if("paintformat"===e)!0===t?bo.call(this):yo.call(this);else if("clearformat"===e)Qo.call(this,"delete-cell-format");else if("link"===e);else if("chart"===e);else if("autofilter"===e)Eo.call(this);else if("throwFormula"===e)Zo.call(this);else if("close"===e){var n=r.getMax(),i=n.mri,a=n.mci;r.changeDataForCalc=new io({type:999,action:"重新计算",ri:-1,ci:-1,oldCell:{},newCell:r.rows.eachRange(new E.b(0,0,i,a))},this.data),mo.call(this)}else if("freeze"===e){var o=r.settings.showFreeze;if(t&&!0===o){var l=r.selector,s=l.ri,u=l.ci;this.freeze(s,u)}else this.freeze(0,0)}else"add"===e?(r.showEquation=!r.showEquation,mo.call(this,!0)):(r.setSelectedCellAttr(e,t),"border"===e&&el.call(this,"none"),"formula"===e&&Bo.call(this),mo.call(this))}function el(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1px solid rgb(75, 137, 255";this.selector.br.border(e)}function tl(e,t,r,n){this.data.setAutoFilter(e,t,r,n),mo.call(this)}function rl(e){if(e.getLock()||2===e.state){var t=e.ri,r=e.ci,n=e.editorText.getText();return this.selector.indexes=[t,r],$o.call(this,t,r,{text:n},"input",this.table.proxy)}return!1}function nl(e){var t=this;yo.call(this),vl.call(this,e,(function(){mo.call(t);var e=t.data;e.change(e.getData())}))}function il(){var e,t,r,n,i,a,o=this,l=this.overlayerEl,s=this.rowResizer,u=this.colResizer,c=this.verticalScrollbar,f=this.horizontalScrollbar,h=this.editor,p=(this.table,this.contextMenu),v=this.data,d=this.toolbar,g=this.modalValidation,m=(this.pasteOverlay,this.sortFilter);l.on("mousemove",(function(e){co.call(o,e)})).on("mousedown",(function(e){if(2===e.buttons)v.xyInSelectedRect(e.offsetX,e.offsetY)?(p.setPosition(e.offsetX,e.offsetY),e.stopPropagation()):(p.hide(),Io.call(o,e),setTimeout((function(){p.setPosition(e.offsetX,e.offsetY),e.stopPropagation()}),100)),Wo.call(o,e);else if(2===e.detail){if(clearTimeout(o.render_timer),h.setMouseDownIndex([]),h.getLock())return;Bo.call(o,2)}else{if(h.getLock()||h.isCors){var t=null,r=0;Se(window,(function(n){o.container.css("pointer-events","none"),t&&t.selector&&t.selector.setBoxinner("none");var i=!0,a=v.merges,l=h.editorText.getText();if(Object.keys(a._).forEach((function(e){for(var t=a._[e],r=Object(F.cutStr)(l,!0),n=0;n<r.length;n++)if(-1!=r[n].indexOf(":")){var o=r[n].split(":")[0],s=r[n].split(":")[1],u=Object(L.expr2xy)(o),c=Object(L.expr2xy)(s);t.sci>=u[0]&&t.sri>=u[1]&&t.eci<=c[0]&&t.eri<=c[1]&&(i=!1)}})),i&&1===n.buttons&&!n.shiftKey){var s=v.getCellRectByXY(n.offsetX,n.offsetY),u=s.ri,c=s.ci;if(t&&t.selector)t=ar.call(o,u,c,o.selectors,!0,t.selector,!0),nr.call(o,e,t),o.mergeSelector=!0;else{for(var f=h.pos,p=h.editorText.getText(),d=0;d<o.selectors.length;d++){var g=o.selectors[d];if(g.erpx===Object(F.cuttingByPos)(p,f)){r=1,(t=g).selector.set(u,c,!0);break}}t=t||ar.call(o,u,c,o.selectors,!0,null,!1)}}}),(function(){if(o.container.css("pointer-events","auto"),t&&t.selector&&t.selector.setBoxinner("auto"),!1===o.mergeSelector?(t&&!r&&o.selectors.push(t),nr.call(o,e,t)):t&&!r&&t.selector&&o.selectors.push(t),t)for(var n=0;n<o.selectors.length;n++){var i=o.selectors[n];if(i.className===t.className){i.erpx=t.erpx;break}}t=null,r=0,o.mergeSelector=!1}))}if(console.time("dbclick time1"),!h.getLock()&&!h.isCors){console.time("dbclick time2");var n=h.ri,i=h.ci,a=h.editorText.getText();if(-1!==n&&-1!==i&&"="===a[0])if($o.call(o,n,i,{text:a},"input",o.table.proxy))return;if(console.timeEnd("dbclick time2"),h.clear()){v.rows.getCell(n,i);Ro.call(o)}o.selector.longTimeBefore(),Io.call(o,e),Wo.call(o,e),el.call(o),or.call(o),Lo.call(o)}Sr.call(o),console.timeEnd("dbclick time1")}})).on("mousewheel.stop",(function(e){fo.call(o,e)})),e=l.el,r=(t={move:function(e,t){ho.call(o,e,t)}}).move,n=t.end,i=0,a=0,Ce(e,"touchstart",(function(e){var t=e.touches[0],r=t.pageX,n=t.pageY;i=r,a=n})),Ce(e,"touchmove",(function(e){if(r){var t=e.changedTouches[0],n=t.pageX,o=t.pageY,l=n-i,s=o-a;(Math.abs(l)>10||Math.abs(s)>10)&&(je(l,s,e,r),i=n,a=o),e.preventDefault()}})),Ce(e,"touchend",(function(e){if(n){var t=e.changedTouches[0],r=t.pageX,o=t.pageY;je(r-i,o-a,e,n)}})),d.change=function(e,t){return Jo.call(o,e,t)},m.ok=function(e,t,r,n){return tl.call(o,e,t,r,n)},s.finishedFn=function(e,t){Xo.call(o,e,t)},u.finishedFn=function(e,t){Go.call(o,e,t)},c.moveFn=function(e,t){Vo.call(o,e,t)},f.moveFn=function(e,t){zo.call(o,e,t)},h.change=function(e,t){if("finish"===e)return v.editorChangeToHistory(h.editorText.getOldCell(),h.editorText.getRICI(),1),void h.editorText.setOldCell({},{ri:-1,ci:-1});if("@~esc"==t){var r=h.editorText.getOldCell(),n=r.text,i=r.formulas;h.editorText.setOldCell({text:"",formulas:""});var a=h.ri,l=h.ci;return v.setSelectedCell(n,"input",i,a,l),h.setText(""),or.call(o),void h.clear(!0)}"format"==e&&v.setSelectedCellAttr(e,"rmb");var s=h.lock;h.setMouseDownIndex(v.rows,[]),lr.call(o,t),s&&"="!=t||"format"!=e&&Ko.call(o,t,e)},g.change=function(e){if("save"===e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];v.addValidation.apply(v,r)}else v.removeValidation()},p.itemClick=function(e,t){"validation"===e?g.setValue(v.getSelectedValidation()):"copy"===e?bo.call(o):"cut"===e?wo.call(o):"paste"===e||("paste-value"===e?xo.call(o,"text"):"paste-format"===e?xo.call(o,"format"):Qo.call(o,e))},Ce(window,"resize",(function(){o.reload()})),Ce(window,"click",(function(e){o.focusing=l.contains(e.target)})),Ce(window,"copy",(function(e){Fa.call(o,e)})),Ce(window,"cut",(function(e){console.log("cut",e),wo.call(o),Fa.call(o,e);var t=o.data;t.history.add(t.getData())})),Ce(window,"paste",(function(e){nl.call(o,e)})),Ce(window,"keydown",(function(e){var t=e.keyCode||e.which,r=e.key,n=e.ctrlKey,i=e.shiftKey,a=e.altKey,l=e.metaKey;if(Ha.call(o)){switch(console.log(t),t){case 8:v.history.addPic(v.getData().pictures,"add"),yl.call(o)}(n||l)&&90===t&&(o.undo(),e.preventDefault())}else if(n||l){switch(i&&"text",a&&"format",t){case 90:o.undo(),e.preventDefault();break;case 89:o.redo(),e.preventDefault();break;case 67:if(Ha.call(o))return;bo.call(o),e.preventDefault();break;case 88:wo.call(o),e.preventDefault();break;case 85:d.trigger("underline"),e.preventDefault();break;case 86:break;case 37:uo.call(o,i,"row-first"),e.preventDefault();break;case 38:uo.call(o,i,"col-first"),e.preventDefault();break;case 39:uo.call(o,i,"row-last"),e.preventDefault();break;case 40:uo.call(o,i,"col-last"),e.preventDefault();break;case 32:so.call(o,!1,-1,v.selector.ci,!1),e.preventDefault();break;case 66:d.trigger("font-bold");break;case 73:d.trigger("font-italic")}}else{switch(t){case 32:i&&so.call(o,!1,v.selector.ri,-1,!1);break;case 27:p.hide(),yo.call(o);break;case 37:uo.call(o,i,"left"),e.preventDefault();break;case 38:uo.call(o,i,"up"),e.preventDefault();break;case 39:uo.call(o,i,"right"),e.preventDefault();break;case 40:uo.call(o,i,"down"),e.preventDefault();break;case 9:if(rl.call(o,h))return;h.clear(),uo.call(o,!1,i?"left":"right"),e.preventDefault(),or.call(o);break;case 13:if(rl.call(o,h))return;h.clear(),Uo.call(o),Yo.call(o),uo.call(o,!1,i?"up":"down"),Ro.call(o),e.preventDefault(),Lo.call(o,!0),or.call(o);break;case 8:Qo.call(o,"delete-cell-text")}"Delete"===r?(Qo.call(o,"delete-cell-text"),e.preventDefault()):t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||"="===e.key||113===t&&Bo.call(o)}}))}var al=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=r.settings,a=i.view,l=i.showToolbar,s=i.showContextmenu,u=i.showEditor,c=i.rowWidth;this.el=o("div","".concat(Me.a,"-sheet")),this.toolbar=new oa(r,a.width,!l),t.children(this.toolbar.el,this.el),this.pictureOffsetLeft=10,this.pictureOffsetTop=10,this.data=r,this.tableEl=o("canvas","".concat(Me.a,"-table")),this.rowResizer=new De(!1,r.rows.height),this.colResizer=new De(!0,r.cols.minWidth),this.verticalScrollbar=new Pe(!0),this.horizontalScrollbar=new Pe(!1),this.editor=new gn(y,(function(){return n.getTableOffset()}),r.rows.height,r.cols.width,r,this),this.stopTimer=new eo,this.stopTimer2=new eo,this.website=new Ua(r,this.editor),this.modalValidation=new Aa,this.errorPopUp=new Ka,this.contextMenu=new En((function(){return n.getTableOffset()}),!s),this.selector=new it(r,this,!0),this.selectorMoveEl=new it(r,this,!1),this.advice=new La(r,this),this.overlayerCEl=Ho.call(this,u),this.selectors=[],this.container=o("div",""),this.selectorsEl=o("div","selector_clear").attr("id","selector_clear"),this.overlayerCEl.children(this.selectorsEl,this.container),this.mergeSelector=!1,this.overlayerEl=o("div","".concat(Me.a,"-overlayer")).children(this.overlayerCEl),this.sortFilter=new Da,this.direction=!1,this.el.children(this.tableEl,this.rowResizer.el,this.overlayerEl.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.errorPopUp.el,this.sortFilter.el,this.advice.el,this.website.el,this.website.tableEl),this.table=new $r(this.tableEl.el,r,this.editor),il.call(this),mo.call(this,!1),so.call(this,!1,0,0),c&&c.state&&Do.call(this,c.width)}var t,r,n;return t=e,(r=[{key:"selectorMoveReset",value:function(){Lo.call(this),this.editor.setRiCi(this.data.selector.ri,this.data.selector.ci),mo.call(this)}},{key:"getTable",value:function(){return{recalc:!1,table:this.table}}},{key:"clickCopyPaste",value:function(){var e=this.data,t=e.clickCopyPaste();t.enter&&(this.selector.arange=t.dstCellRange,e.clickAutofill(t.srcCellRange,t.dstCellRange,"all",(function(e){return _a("Tip",e)})),Mo.call(this))}},{key:"setCellRange",value:function(e,t,r,n){var i=this.table;this.data.paste(n);for(var a=0;a<e.length;a++){var o=e[a],l=o.ri,s=o.ci,u=Object(F.deepCopy)(t.rows.getCellOrNew(l,s));!1===r&&delete u.style,$o.call(this,l,s,u,"style",i.proxy),so.call(this,!0,l,s,!0,!0)}}},{key:"selectorEditorReset",value:function(e,t){var r=this.selector;Lo.call(this,!0,e,t),this.editor.setRiCi(e,t),r.hide(),mo.call(this)}},{key:"loadData",value:function(e){return this.data.setData(e,this),mo.call(this),this}},{key:"freeze",value:function(e,t){return this.data.setFreeze(e,t),mo.call(this),this}},{key:"undo",value:function(){this.data.undo(this),mo.call(this)}},{key:"redo",value:function(){this.data.redo(),mo.call(this)}},{key:"reload",value:function(){return mo.call(this),this}},{key:"removeEvent",value:function(){ke.call(this)}},{key:"getRect",value:function(){var e=this.data;return{width:e.viewWidth(),height:e.viewHeight()}}},{key:"getTableOffset",value:function(){var e=this.data,t=e.rows,r=e.cols,n=this.getRect(),i=n.width,a=n.height;return{width:i-r.indexWidth,height:a-t.height,left:r.indexWidth,top:t.height}}}])&&ao(t.prototype,r),n&&ao(t,n),e}();var ol=function(e,t){this.register=function(r){r.addEventListener("mousedown",(function(n){if(0==n.button){var i=n.clientX,a=n.clientY,o=r.offsetLeft,l=r.offsetTop;e&&e.onBegin&&e.onBegin.call(r,{left:i-o,top:a-l});var s=!0;r.style.cursor="move";var u=i,c=a;window.onmousemove=function(t){if(s){var n=t.clientX,f=t.clientY;c=f-(a-l);return(u=n-(i-o))>0?(!1,r.style.left=u+"px"):(!0,r.style.left="0px"),c>0?(!1,r.style.top=c+"px"):(!0,r.style.top="0px"),e&&e.onDrag&&e.onDrag.call(r,{left:u,top:c,x:n-i,y:f-a,isDown:s}),!1}},window.onmouseup=function(n){return s=!1,r.style.cursor="default",e&&e.onEnd&&e.onEnd.call(r,{left:parseInt(r.style.left),top:parseInt(r.style.top)},t),!1},n.stopPropagation?n.stopPropagation():n.preventDefault?n.preventDefault():window.event.returnValue}}))}};var ll=function(e,t){this.register=function(r){var n=[],i=["nw","w","ws","s","se","e","ne","n"];i.forEach((function(e){var t=document.createElement("div");t.style.display="block",t.className="direction "+e,n.push(t),r.appendChild(t)}));for(var a=0;a<4;a++){var o=document.createElement("div");o.style.display="block",o.className="line".concat(a+1),r.appendChild(o),n.push(o)}var l=document.createElement("div");function s(n){n<20&&(n=20),e.onResize({width:n},t),r.style.width=n+"px"}function u(n){n<20&&(n=20),e.onResize({height:n},t),r.style.height=n+"px"}l.className="border",r.appendChild(l),i.forEach((function(t){var n=r.querySelector("."+t);n.onmousedown=function(i){if(0==i.button){var a={ox:i.clientX,oy:i.clientY,ow:r.offsetWidth,oh:r.offsetHeight,ol:r.offsetLeft,ot:r.offsetTop};e&&e.onBegin&&e.onBegin.call(r,a);var o=!0;window.onmousemove=function(e){if(o){var r=e.clientX,i=e.clientY,l=r-a.ox,s=i-a.oy;a.width=l,a.height=s;var u=c[t];u&&u.call(n,a,e),e.stopPropagation()}},window.onmouseup=function(t){o=!1,t.stopPropagation(),e&&e.onEnd&&e.onEnd.call(r)},i.stopPropagation()}}})),e?e.onResize||(e.onResize=function(){}):e={onResize:function(){}};var c={s:function(e){u(e.oh+e.height)},e:function(e){s(e.ow+e.width)},w:function(n){var i=n.width,a=n.ol+i,o=n.ow+Math.abs(i);i>0&&(o=n.ow-i),o>20&&(!function(n){e.onResize({left:n},t),r.style.left=n+"px"}(a),s(o))},n:function(n){var i=n.height,a=n.ot+i,o=n.oh+Math.abs(i);i>0&&(o=n.oh-i),o>20&&(u(o),function(n){e.onResize({top:n},t),r.style.top=n+"px"}(a))},se:function(e){c.s(e),c.e(e)},nw:function(e){c.n(e),c.w(e)},ws:function(e){c.w(e),c.s(e)},ne:function(e){c.n(e),c.e(e)}};return n}};function sl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ul=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.rows=new le({len:0,height:0},t)}var t,r,n;return t=e,(r=[{key:"getComputedStyle",value:function(e){var t=!1;return e.fontWeight>400&&(t=!0),{color:e.color,bgcolor:e.background.substring(0,e.background.indexOf(")")+1),font:{bold:t}}}},{key:"extend",value:function(e,t){var r=t.ri,n=t.ci,i=this.data;if(e.rows.length>=i.rows.len-r){var a=e.rows.length-(i.rows.len-r);a>0&&i.insert("row",a)}if(!1!==Object(P.isHave)(e.rows[0])&&!1!==Object(P.isHave)(e.rows[0].cells)){var o=e.rows[0].cells.length;if(o>=i.cols.len){var l=o-(i.cols.len-n);l>0&&i.insert("column",l,i.cols.len)}}}},{key:"each",value:function(e,t){for(var r=0;r<e.rows.length;r++)for(var n=0;n<e.rows[r].cells.length;n++)t(r,n,e.rows[r].cells[n])}},{key:"dealColSpan",value:function(e){this.each(e,(function(t,r,n){var i=n.getAttribute("colspan");if(i&&i>1)for(var a=0;a<i-1;a++)e.rows[t].insertBefore(document.createElement("td"),e.rows[t].cells[r+1])}))}},{key:"dealStyle",value:function(e,t){var r=this,n=t.ri,i=t.ci,a=this.data,o=this.rows,l=a.styles;this.each(e,(function(e,t,a){var s=document.defaultView.getComputedStyle(a,!1),u=r.getComputedStyle(s),c=function(e,t){for(var r=0;r<e.length;r++)if(wl(e[r],t))return r;return-1}(l,u);-1===c&&l.push(u),o.setCell(n+e,i+t,{style:-1===c?l.length-1:c},"all")}))}},{key:"parseTableCellRange",value:function(e,t){var r=t.ri,n=t.ci,i=r,a=n;return this.each(e,(function(e,t,o){var l=r+e,s=n+t;i<l&&(i=l),a<s&&(a=s)})),new E.b(r,n,i,a)}},{key:"dealReference",value:function(e,t){var r=t.ri,n=t.ci,i=this.rows,a=[];return this.each(e,(function(e,t,o){var l=o.querySelector("reference"),s=o.innerText||"";if(l){var u=l.getAttribute("ri"),c=l.getAttribute("ci"),f=Object(F.splitStr)(s),h=e+r-u,p=t+n-c,v=i.getCellTextByShift(f,p,h),d=v.bad,g=v.result;i.updateCellReferenceByShift(d,g,r+e,n+t)}else{var m=i.getCell(r+e,n+t)||{};m.text=s,m.formulas=s,i.setCell(r+e,n+t,m,"all")}a.push({ri:r+e,ci:n+t})})),{reference:a}}}])&&sl(t.prototype,r),n&&sl(t,n),e}(),cl={onBegin:function(e){console.log("obegin",e)},onEnd:function(e){},onResize:function(e,t){var r=Ha.call(t);r&&(r.img2.style.width=r.img.el.style.width,r.img2.style.height=r.img.el.style.height)}},fl={onBegin:function(e){console.log("obegin",e)},onEnd:function(e,t){var r=e.left,n=e.top,i=Ha.call(t);if(i){n-31<0?n=0:r-60<0&&(r=0);var a=t.data.getCellRectByXY(r+60,n+31);a.sri=a.ri,a.sci=a.ci,a.eri=a.ri,a.eci=a.ci;var o=r-a.left+50,l=n-a.top+21;i.offsetLeft=o,i.offsetTop=l,i.range=a,void 0!==i.lastCi&&void 0!==i.lastRi&&(i.ri=i.lastRi,i.ci=i.lastCi),i.lastCi=a.ci,i.lastRi=a.ri,t.data.history.addPic(Object(F.deepCopy)(t.data.pasteDirectionsArr),"delete")}},onDrag:function(e){}};function hl(e,t){for(var r=o("table",""),n=o("tbody",""),i=e.innerText.split("\n"),a=0;a<i.length;a++){var l=i[a],s=o("tr",""),u=o("td","");u.html(l),u.css("background",e.style.background),u.css("font-weight",e.style["font-weight"]),u.css("color",e.style.color),s.child(u),n.child(s)}return r.child(n),r.el}function pl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.el,n=this.data;n.history.add(n.getData()),r.child(e),xl.call(this,e),e.parentNode.removeChild(e),t&&t.parentNode.removeChild(t),mo.call(this)}function vl(e,t){for(var r=this,n=e.clipboardData,i=!1,a=0;a<n.items.length;a++){var l=n.items[a];if("string"===l.kind)l.getAsString((function(e){var t=o("head",""),n=o("span","");-1==e.indexOf("<span")&&-1==e.indexOf("span>")&&-1==e.indexOf("<table")&&-1==e.indexOf("table>")?(n.html(e),t.child(n.el),t=t.el):(t.html(e),t=t.el);var a=t.getElementsByTagName("img")[0],l=t.getElementsByTagName("style")[0],s=t.getElementsByTagName("table")[0],u=t.getElementsByTagName("span")[0];if(a&&!l)gl.call(r,a),i=!0;else if(s){if(l)r.el.child(l);s&&0==i&&(pl.call(r,s,l),i=!0)}else setTimeout((function(){if(!i){if(u&&(s=hl.call(r,u,s)),l)r.el.child(l);if(s&&0==i)r.el.child(s),xl.call(r,s),s.parentNode.removeChild(s),l&&l.parentNode.removeChild(l),mo.call(r),i=!0}}),100)}));else if("file"===l.kind&&!i){var s=l.getAsFile(),u=new FileReader;if(u.onload=function(e){r.x,r.y,r.overlayerEl,r.data.pasteDirectionsArr;var t=o("img","paste-img");t.el.src=e.target.result,setTimeout((function(){i||(i=!0,gl.call(r,t.el))}),0)},!s)return;u.readAsDataURL(s)}}setTimeout((function(){if(i){var e=r.data;e.change(e.getData())}else t()}))}function dl(e,t){for(var r=0,n=0,i=this.data.pasteDirectionsArr,a=0,o=0;o<i.length;o++){var l=i[o];l.ri===e&&l.ci===t&&(n<l.nextLeft&&(n=l.nextLeft),r<l.nextTop&&(r=l.nextTop),a++)}return{top:r,left:n,number:a}}function gl(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=new Image;s.src=e.src,s.onload=function(){var u=s.width,c=s.height,f=e,h=t.container,p=t.data,v=p.pasteDirectionsArr;l&&p.history.addPic(Object.assign([],v),"delete");var d=p.selector,g=d.ri,m=d.ci;r&&(g=n,m=i);var y=t.pictureOffsetLeft,b=t.pictureOffsetTop,w=p.getMoveRect(new E.b(g,m,g,m)),x=w.left+y,O=w.top+b,C=0,k=Ha.call(t);if(k){var N=dl.call(t,k.ri,k.ci);x=N.left,O=N.top,g=k.ri,m=k.ci,C=N.number}var T=o("div","".concat(Me.a,"-object-container")).css("position","absolute").css("top","".concat(O,"px")).css("width","".concat(u,"px")).css("height","".concat(c,"px")).css("z-index","100000").css("left","".concat(x,"px")).child(f);h.child(T),new ol(fl,t).register(T.el),setTimeout((function(){var e=t.data,n=new ll(cl,t).register(T.el),i=v.length;v.push({src:f.src,state:!0,arr:n,img:T,index:i,img2:f,ri:g,ci:m,offsetLeft:0,offsetTop:0,number:C,range:r?a:e.selector.range,top:O,left:x,nextLeft:x+15,nextTop:O+15}),r||t.data.change(t.data.getData()),t.direction=!0,T.css("width","".concat(f.offsetWidth,"px")),T.css("height","".concat(f.offsetHeight,"px")),bl.call(t,n,i,v,r),T.on("mousedown",(function(e){return bl.call(t,n,i,v)}))}),0)}}function ml(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++){var r=e[t].arr;if(r.length>0)for(var n=0;n<r.length;n++)r[n].style.display="none";e[t].state=!1,e[t].img.css("z-index","10000"),e[t].img2.style.border="none"}}function yl(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data.pasteDirectionsArr,r=[],n=[];if(this.direction=!1,t.length>0)for(var i=0;i<t.length;i++)!0===t[i].state||1==e?n.push(t[i]):r.push(t[i]);Object.keys(n).forEach((function(e){n[e].img.removeEl()})),this.pasteDirectionsArr=r;var a=this.data;a.pasteDirectionsArr=r,a.change(a.getData())}function bl(e,t,r,n){ml.call(this),this.direction=!0,Object.keys(e).forEach((function(t){e[t].style.display="block"}));var i=this.selector,a=this.editor;n?ml.call(this):(i.hide(),a.clear(),r[t].img.css("z-index","99999999"),r[t].state=!0)}function wl(e,t){if(!(e instanceof Object)||!(t instanceof Object))return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;var r=Object.keys(e);for(var n in r){var i=e[n=r[n]]instanceof Object,a=t[n]instanceof Object;if(i&&a){var o=wl(e[n],t[n]);if(!o)return o}else if(e[n]!=t[n])return!1}return!0}function xl(e){var t=this.data,r=t.selector,n=r.ri,i=r.ci,a=t.styles;console.time("paste");var o=new ul(t);o.extend(e,{ri:n,ci:i}),o.dealColSpan(e),o.dealStyle(e,{ri:n,ci:i});var l=o.dealReference(e,{ri:n,ci:i}).reference;this.setCellRange(l,o,!0,o.parseTableCellRange(e,{ri:n,ci:i}));var s=t.getSelectedRect(),u=s.left+s.width+60,c=s.top+s.height+31,f=this.advice;return this.editor.clear(),f.show(u,c,1,l,o),console.timeEnd("paste"),{rows:t.rows._,styles:a}}function El(e){if(!Object(P.isHave)(e)||!Object(P.isNumber)(e))return{state:!1,date:o,date_formula:"",minute:!1};var t=Ol(e,(function(e){return 24*e*60}));t=Un(t,5);var r=B()("1900-01-01"),n=B()("1900-01-01"),i=!1;if(Object(P.isHave)(t)&&1*t>0){var a=Ol(t,(function(e){return 60*e}));i=!0,a=Un(a,5),n=B()("1900-01-01  00:00:00").set("minute",t).set("second",a)}var o="";return i?{state:"Invalid Date"!==(o=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD")),date:o,date_formula:n.add(e,"day").subtract(2,"day").format("YYYY-MM-DD  h:mm:ss"),minute:!0}:{state:"Invalid Date"!==(o=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD")),date:o,date_formula:"",minute:!1}}function Ol(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=e.toString().split(".");if(r.length>2)return e;for(var n=r[1]+"",i=n,a=0;a<n.length;a++)i*=.1;return t(i)}function Cl(e){for(var t=!1,r=0;!1===t&&r<V.c.length;r++)t=Object(V.l)(V.c[r]).test(e);return!1===t?{isValid:!1}:(e=(e=e.replace(/[年|月]/g,"-")).replace(/[日]/g,""),{diff:B()(e).diff(B()("1900-01-01"),"day")+2,isValid:!0})}function kl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Nl(e){this.undoItems.push(e),this.redoItems=[]}var Tl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.undoItems=[],this.redoItems=[],this.data=t}var t,r,n;return t=e,(r=[{key:"addStep",value:function(e,t){var r=e.type,n=e.action,i=e.ri,a=e.ci,o=e.expr,l=e.cellRange,s=e.cells,u=e.height,c=e.width,f=e.property,h=e.value,p=e.oldData,v=t.oldCell,d=t.newCell,g=t.oldMergesData,m=t.newMergesData,y=t.oldStep,b="";1===r?(b=new io({type:r,action:n,ri:i,ci:a,expr:o,oldCell:v,newCell:d},this.data),Nl.call(this,b)):2===r||5===r||11===r||12===r||6===r?(b=new io({type:r,oldMergesData:g,property:f,value:h,newMergesData:m,action:n,cellRange:l,oldCell:v,newCell:s},this.data),Nl.call(this,b)):13===r?(b=new io({type:r,oldData:p,newData:y.oldData,action:n},this.data),Nl.call(this,b)):3===r?(b=new io({type:r,action:n,height:u,ri:i,oldStep:y},this.data),Nl.call(this,b)):4===r&&(b=new io({type:r,action:n,width:c,ci:a,oldStep:y},this.data),Nl.call(this,b)),Sr.call(this)}},{key:"getStepType",value:function(e,t){var r=t.ri,n=t.ci,i=t.expr,a=t.text,o=t.range,l=t.cellRange,s=t.property,u=t.value,c=(t.merges,""),f=this.data,h=f.rows,p=f.cols;if(1===e)return{action:c="在".concat(i,'中键入"').concat(a,'"'),type:e,ri:r,ci:n,expr:i};if(2===e){var v=Object(L.xy2expr)(o.sci,o.sri),d=Object(L.xy2expr)(o.eci,o.eri);return i=v===d?v:"".concat(v,":").concat(d),{action:c="删除".concat(i,"的单元格内容"),type:e,cellRange:o,cells:this.eachRange(o)}}return 3===e?{action:c="行宽",type:e,height:h.getHeight(r),ri:r}:4===e?{action:c="列宽",type:e,width:p.getWidth(n),ci:n}:5===e?{action:c="自动填充",type:e,cellRange:o,cells:this.eachRange(l)}:12===e?{action:c="选择性粘贴",type:e,cellRange:o,property:s,value:u,cells:this.eachRange(l)}:13===e?{action:c="插入单元格",type:e,oldData:this.data.getData()}:11===e?("font-bold"===s||"font-italic"===s||"font-name"===s||"font-size"===s||"color"===s?c="字体":"underline"===s?c="下划线":"bgcolor"===s||"format"===s?c="单元格格式":"align"===s?"left"===u?c="左对齐":"center"===u?c="居中":"right"===u&&(c="右对齐"):"valign"===s?"top"===u?c="顶端对齐":"center"===u?c="居中":"bottom"===u&&(c="底端对齐"):"border"===s?c="边框":"strike"===s?c="删除线":"merge"===s&&(c="合并单元格"),{action:c,type:e,cellRange:o,property:s,value:u,cells:this.eachRange(l)}):6===e?{action:c="粘贴",type:e,cellRange:o,cells:this.eachRange(l)}:void 0}},{key:"undo",value:function(){var e=this.does(this.getItems(1),1);this.redoItems.push(e)}},{key:"redo",value:function(){var e=this.does(this.getItems(2),2);this.undoItems.push(e)}},{key:"eachRange",value:function(e){return this.data.rows.eachRange(e)}},{key:"does",value:function(e,t){if(this.data.settings.showEditor&&!(e.length<=0)){var r=this.data,n=r.sheet,i=e.pop();return i.restore(r,n,t),i}}},{key:"getItems",value:function(e){return 1===e?this.undoItems:this.redoItems}}])&&kl(t.prototype,r),n&&kl(t,n),e}();function Al(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Il=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectorRange=t,this.dstRange=r}var t,r,n;return t=e,(r=[{key:"getPaintType",value:function(){var e=this.dstRange,t=this.selectorRange;return function(e,t){return 1===e&&1===t?1:1===e&&2===t?2:1===e&&3===t?3:2===e&&1===t?4:3===e&&1===t?5:2===e&&2===t?6:2===e&&3===t?7:3===e&&2===t?8:3===e&&3===t?9:void 0}(e.getType(),t.getType())}},{key:"makePaintArr",value:function(e,t){var r=this.dstRange,n=this.selectorRange,i=[],a=n.eci-n.sci,o=0,l=r.sri,s=0,u=function(e,t){var r=t.sri,n=[],i=[],a=0;return t.each((function(t,o){r!==t&&(r=t,n.push(i),i=[]),i.push(e[a]),a+=1})),n.push(i),n}(t,n);return r.each((function(e,t){l!==e&&(o=0,(s+=1)===u.length&&(s=0));var r=u[s][o].cell,n=new $(e,t,r,Object(L.xy2expr)(e,t));i.push(n),o===a?o=0:o+=1,l=e})),i}}])&&Al(t.prototype,r),n&&Al(t,n),e}();function Sl(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function jl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ml(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Rl={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},formula:{},showGrid:!0,showToolbar:!0,showContextmenu:!0,showEditor:!0,autoLoad:!0,ignore:[],cellWidth:0,ignoreRi:0,minus:!1,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:10},rowsInit:!1,style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,flexible:!1,underline:!1,autoAdapt:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}};function Dl(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!t)return!1;var n=this.merges,i=t.clone(),a=Ml(e.size(),2),o=a[0],l=a[1],s=Ml(t.size(),2),u=s[0],f=s[1];return o>u&&(i.eri=t.sri+o-1),l>f&&(i.eci=t.sci+l-1),!n.intersects(i)||(r(c("error.pasteForMergedCell")),!1)}function _l(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,a=this.merges;"all"!==r&&"format"!==r||(i.deleteCells(t,r),a.deleteWithin(t)),i.copyPaste(e,t,r,n,(function(e,t,r){if(r&&r.merge){var n=Ml(r.merge,2),i=n[0],o=n[1];if(i<=0&&o<=0)return;a.add(new E.a(e,t,e+i,t+o))}}))}function Pl(e,t,r){var n=this.clipboard,i=this.rows,a=this.merges;i.cutPaste(e,t),a.move(e,t.sri-e.sri,t.sci-e.sci),r&&n.clear()}function Ll(e,t,r){var n=this.styles,i=this.rows.getCellOrNew(e,t),a={};Object(P.isHave)(i.style)&&(a=P.default.cloneDeep(n[i.style])),Object.assign(a,{border:r}),i.style=this.addStyle(a)}function Fl(e,t,r,n){if(-1==e||-1==t)return{state:!0,msg:"单元格坐标有误"};if("style"!==n&&(!r||"="!==r[0]))return{state:!1,msg:"正确"};var i=Hl.call(this,r);return"style"!==n&&!0===i.state?{msg:i.msg,state:!0}:{msg:i.msg,state:!1}}function Hl(e){var t=!1,r="";try{new V.default(e).parse()}catch(e){r="您输入的公式存在问题，请更正, 错误原因: "+e.description,t=!0}return 1==t&&0==Object(F.isLegal)(e)&&(r="缺少左括号或右括号",t=!0),t?{state:!0,msg:r}:{state:!1,msg:r}}function Bl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"to",r=arguments.length>2?arguments[2]:void 0;if("to"==t){for(var n=[],i=0;i<e.length;i++){var a=e[i];console.log(a);var l={src:a.img2.src,ri:a.ri,ci:a.ci,top:a.top,left:a.left,range:a.range,offsetLeft:a.offsetLeft,offsetTop:a.offsetTop,nextLeft:a.nextLeft,nextTop:a.nextTop,img:a.img,arr:a.arr,img2:a.img2};n.push(l)}return n}if("from"==t){if("string"==typeof r)return;for(var s=0;s<e.length;s++){var u=e[s],c=o("img","");c.el.src=u.src,gl.call(r,c.el,!0,u.ri,u.ci,u.range)}}}function Vl(e,t){for(var r=this.rows,n=e+1,i=!0;i;){var a=r.getCellOrNew(n,t);a&&a.text?n+=1:i=!1}return n}function zl(e){var t=this,r=e.mode,n=e.style,i=e.color,a=this.styles,o=this.selector,l=this.rows,s=o.range,u=s.sri,c=s.sci,f=s.eri,h=s.eci,p=!this.isSignleSelected();if(p||"inside"!==r&&"horizontal"!==r&&"vertical"!==r){for(var v=u;v<=f;v+=1)for(var d=c;d<=h;d+=1)Ll.call(this,v,d,{});if("outside"!==r||p){if("none"===r)o.range.each((function(e,r){var n=l.getCell(e,r);if(n&&void 0!==n.style){var i=P.default.cloneDeep(a[n.style]);delete i.border,n.style=t.addStyle(i)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)!function(){for(var e=[],a=u;a<=f;a+=1)for(var o=c;o<=h;o+=1){for(var s=[],v=0;v<e.length;v+=1){var d=Ml(e[v],4),g=d[0],m=d[1],y=d[2],b=d[3];if(a===g+y+1&&s.push(v),g<=a&&a<=g+y&&o===m){o+=b+1;break}}if(s.forEach((function(t){return e.splice(t,1)})),o>h)break;var w=l.getCell(a,o),x=0,E=0;if(w&&w.merge){var O=Ml(w.merge,2);x=O[0],E=O[1],e.push([a,o,x,E])}var C=x>0&&a+x===f,k=E>0&&o+E===h,N={};"all"===r?N={bottom:[n,i],top:[n,i],left:[n,i],right:[n,i]}:"inside"===r?(!k&&o<h&&(N.right=[n,i]),!C&&a<f&&(N.bottom=[n,i])):"horizontal"===r?!C&&a<f&&(N.bottom=[n,i]):"vertical"===r?!k&&o<=h&&(N.right=[n,i]):"outside"===r&&p&&(u===a&&(N.top=[n,i]),(C||f===a)&&(N.bottom=[n,i]),c===o&&(N.left=[n,i]),(k||h===o)&&(N.right=[n,i])),Object.keys(N).length>0&&Ll.call(t,a,o,N),o+=E}}();else if("top"===r||"bottom"===r)for(var g=c;g<=h;g+=1)"top"===r&&(Ll.call(this,u,g,{top:[n,i]}),g+=l.getCellMerge(u,g)[1]),"bottom"===r&&(Ll.call(this,f,g,{bottom:[n,i]}),g+=l.getCellMerge(f,g)[1]);else if("left"===r||"right"===r)for(var m=u;m<=f;m+=1)"left"===r&&(Ll.call(this,m,c,{left:[n,i]}),m+=l.getCellMerge(m,c)[0]),"right"===r&&(Ll.call(this,m,h,{right:[n,i]}),m+=l.getCellMerge(m,h)[0])}else Ll.call(this,u,c,{top:[n,i],bottom:[n,i],left:[n,i],right:[n,i]})}}function Ul(e,t){var r=this.rows,n=this.freezeTotalHeight(),i=r.height;n+r.height<e&&(i-=t);for(var a=this.exceptRowSet,o=0,l=i,s=r.height;o<r.len&&!(l>e);o+=1)a.has(o)||(l+=s=r.getHeight(o));return(l-=s)<=0?{ri:-1,top:0,height:s}:{ri:o-1,top:l,height:s}}function Yl(e,t){var r=this.cols,n=this.freezeTotalWidth(),i=r.indexWidth;n+r.indexWidth<=e&&(i-=t);var a=Ml(P.default.rangeReduceIf(0,r.len,i,r.indexWidth,e,(function(e){return r.getWidth(e)})),3),o=a[0],l=a[1],s=a[2];return l<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:o-1,left:l,width:s}}function Wl(e,t,r){var n=e.text,i=e.formula,a=t.symbol,o=t.position;if(!Object(P.isHave)(n)||!Object(P.isNumber)(n))return null;var l=r(Un(n,-1));return i=ne(i)?i:l,isNaN(l)?null:{text:"begin"===o?a+l:l+a,value:n,formulas:i}}function Xl(e,t,r){return Gl.call(this,t,r,e)}function Gl(e,t,r){var n=this.rows,i=this.getCellStyle(e,t),a=Cl(r.text),o=a.isValid,l=a.diff,s=n.getCellStyleConvert(i,o);if("number"===s){var u=r.text,c=r.formulas,f={};return f=o?{text:l.toFixed(2),formulas:c}:{text:u=Un(u,2),value:r.text,formulas:c},Object(P.isHave)(f.text)&&Object(P.isNumber)(f.text)?{state:!0,style:s,text:f.text,cell:f}:{state:!1,style:s,text:f.text,cell:f}}if("date"===s||"datetime"===s){var h=r.text,p=r.formulas;if(!o){var v=El(h),d=v.state,g=v.date;v.date_formula;v.minute,o=d,l=r.text,h=g}return o&&("datetime"===s&&(h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY年MM月DD日";return B()(e).format(t)}(El(Cl(h).diff).date)),{formulas:p,text:h}),{state:o,style:s,text:Object(P.isHave)(i)?h:l}}if("normal"===s){if(o){var m=l,y=r.formulas,b={formulas:n.toString(y),text:n.toString(m)};return{state:!0,text:b.text,style:s,cell:b}}var w=r.text,x={formulas:r.formulas,text:w};return{state:!0,style:s,text:x.text,cell:x}}if("rmb"===s){var E="",O="";o?(E=l,O=ne(r.formulas)?r.formulas:l):(E=Un(r.text,0),O=r.formulas);var C=Wl({text:E,formula:O},{symbol:"￥",position:"begin"},(function(e){return e}));if(C)return{state:!0,style:s,text:C.text,cell:C}}else if("percent"===s){var k="",N="";o?(k=l,N=ne(r.formulas)?r.formulas:l):(k=n.useOne(r.value,r.text),N=r.formulas);var T=Wl({text:k,formula:N},{symbol:"%",position:"end"},(function(e){return Number(100*e).toFixed(2)}));if(T)return{state:!0,style:s,text:T.text,cell:T}}return{state:!1,style:s,text:r.text,cell:{}}}var ql=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=P.default.merge(Rl,r||{}),this.name=t||"sheet",this.methods=n,this.freeze=[0,0],this.styles=[],this.merges=new _,this.rows=new le(this.settings.row,this),this.cols=new ue(this.settings.col),this.validations=new we,this.hyperlinks={},this.comments={},this.showEquation=!1,this.calc=b(),this.pasteDirectionsArr=[],this.changeDataForCalc=null,this.multiPreAction=new Tl(this),this.selector=new C,this.scroll=new k,this.clipboard=new T,this.moved=new Ee,this.autoFilter=new R,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var t,r,n;return t=e,(r=[{key:"addValidation",value:function(e,t,r){var n=this;this.changeData((function(){n.validations.add(e,t,r)}))}},{key:"removeValidation",value:function(){var e=this,t=this.selector.range;this.changeData((function(){e.validations.remove(t)}))}},{key:"tryParseToNum",value:function(e,t,r){return Xl.call(this,e,t,r)}},{key:"clickCopyPaste",value:function(){var e=this.selector.range.eri,t=this.selector.range.eci,r=this.rows,n=r.getCellOrNew(e,t),i=r.getCellOrNew(e+1,t);if(!n||!n.text||i&&i.text)return{enter:!1};for(var a=Vl.call(this,e,t-1),o=Vl.call(this,e,t+1),l=a<o?o:a,s=!1,u=1;u<l&&!1===s;u++){var c=r.getCellOrNew(e+u,t);c&&c.text&&(l=e+u,s=!0)}return{enter:!0,dstCellRange:new E.a(e+1,t,l-1,t),srcCellRange:new E.a(e,t,e,t)}}},{key:"getSelectedValidator",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=this.validations.get(t,r);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=e.range,i=this.validations.get(t,r),a={ref:n.toString()};return null!==i&&(a.mode=i.mode,a.validator=i.validator),a}},{key:"canUndo",value:function(){return this.multiPreAction.getItems(1).length>0}},{key:"canRedo",value:function(){return this.multiPreAction.getItems(2).length>0}},{key:"undo",value:function(e){this.multiPreAction.undo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"historyList",value:function(e){return this.multiPreAction.getItems(e)}},{key:"redo",value:function(){this.multiPreAction.redo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"copy",value:function(){document.execCommand("copy",!0),this.clipboard.copy(this.selector.range)}},{key:"makeCellPropArr",value:function(e,t,r){for(var n=[],i=this.rows.eachRange(e),a=0;a<i.length;a++){var o=i[a],l=o.ri,s=o.ci,u=o.cell;if(Object(P.isHave)(u)&&!1===Object(P.isHave)(u.style)){var c=this.defaultStyle();u.style=this.addStyle(c)}var f=new $(l+t,s+r,u,Object(L.xy2expr)(l+t,s+r));n.push(f)}return n}},{key:"setCellByCellProp",value:function(e,t){for(var r=this.rows,n=0;n<e.length;n++){var i=e[n],a=i.ri,o=i.ci,l=i.cell;Object(P.isHave)(l)&&Object(P.isHave)(l.style)&&r.setCell(a,o,l,"style"),t(a,o)}}},{key:"paintFormatChange",value:function(e){var t=this;this.changeData((function(){var r=t.clipboard,n=(t.rows,t.selector),i=r.range,a=n.ri,o=n.ci,l=a-i.sri,s=o-i.sci,u=t.makeCellPropArr(i,l,s);if(n.range.eri-n.range.sri==0&&n.range.eci-n.range.sci==0)t.setCellByCellProp(u,e);else{var c=new Il(i,n.range),f=c.getPaintType(),h=c.makePaintArr(f,u);t.setCellByCellProp(h,e)}}),{type:12,cellRange:this.selector.range})}},{key:"move",value:function(){this.moved.move()}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(e){this.changeData((function(){}),{type:6,cellRange:e})}},{key:"autofill",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!Dl.call(this,i,e,n)&&(this.changeData((function(){_l.call(r,i,e,t,!0)}),{type:5,cellRange:e}),!0)}},{key:"clickAutofill",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return!!Dl.call(this,e,t,i)&&(this.changeData((function(){_l.call(n,e,t,r,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges,o=r.range,l=o.sri,s=o.sci,u=o.eri,c=o.eci,f=r.ri,h=r.ci,p=e,v=t;return e<0&&(p=n.len-1),t<0&&(v=i.len-1),p<=f?(l=p,u=f):u=p,v<=h?(s=v,c=h):c=v,r.range=a.union(new E.a(l,s,u,c)),r.range}},{key:"calSelectedRangeByStart",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges.getFirstIncludes(e,t);return null===a&&(a=new E.a(e,t,e,t),-1===e&&(a.sri=0,a.eri=n.len-1),-1===t&&(a.sci=0,a.eci=i.len-1)),r.range=a,a}},{key:"initPercent",value:function(){}},{key:"setSelectedCellAttr",value:function(e,t){var r=this;this.changeData((function(){var n=r.selector,i=r.styles,a=r.rows;if("merge"===e)t?r.merge():r.unmerge();else if("border"===e)zl.call(r,t);else if("formula"===e){var o=a.getCellOrNew(n.ri,n.ci);o.text="=".concat(t,"()"),o.formulas="=".concat(t,"()")}else n.range.each((function(n,o){var l=a.getCellOrNew(n,o),s={};if(Object(P.isHave)(l.style)&&(s=P.default.cloneDeep(i[l.style])),"format"===e)s.format=t,a.setCellText(n,o,{text:l.text,style:r.addStyle(s)},"format");else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){var u={};u[e.split("-")[1]]=t,s.font=Object.assign(s.font||{},u),l.style=r.addStyle(s)}else"flexible"===e?(r.exceptRowSet.has(n+1)&&r.exceptRowSet.has(n+2)&&!r.exceptRowSet.has(n+3)?(r.exceptRowSet.delete(n),r.exceptRowSet.delete(n+1),r.exceptRowSet.delete(n+2)):(r.exceptRowSet.add(n),r.exceptRowSet.add(n+1),r.exceptRowSet.add(n+2)),s[e]=t,l.style=r.addStyle(s)):"strike"!==e&&"textwrap"!==e&&"underline"!==e&&"align"!==e&&"valign"!==e&&"color"!==e&&"bgcolor"!==e||(s[e]=t,l.style=r.addStyle(s))}))}),{type:11,cellRange:this.selector.range,property:e,value:t})}},{key:"setSelectedCellText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.selector,n=r.ri,i=r.ci,a=n;this.unsortedRowMap.has(n)&&(a=this.unsortedRowMap.get(n)),this.setCellText(a,i,{text:e},t),this.resetAutoFilter()}},{key:"setSelectedCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.setCellAll(n,i,e,r,t),this.resetAutoFilter()}},{key:"getSelectedCell",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=t;return this.unsortedRowMap.has(t)&&(n=this.unsortedRowMap.get(t)),this.rows.getCell(n,r)}},{key:"editorChangeToHistory",value:function(e,t,r){var n=t.ri,i=t.ci;if(-1===n||-1===i)return{state:!1};var a=this.rows.getCell(n,i),o=this.multiPreAction,l=Object(L.xy2expr)(i,n),s=o.getStepType(r,{ri:n,ci:i,expr:l,text:a.text}),u=new $(n,i,e,l),c=new $(n,i,a,l);return o.addStep(s,{oldCell:[u],newCell:[c]}),this.changeDataForCalc=this.getChangeDataToCalc(),{state:!0}}},{key:"changeToHistory",value:function(e,t){var r=e.ri,n=e.type,i=e.ci,a=e.cellRange,o=e.property,l=e.value,s=e.oldCell,u=e.oldMergesData;if(-1===n)return{state:!1};var c=this.multiPreAction,f=this.selector,h=c.getStepType(n,{expr:"",property:o,value:l,oldCell:s,range:f.range,ri:r,ci:i,cellRange:a});return c.addStep(h,{oldCell:s,oldMergesData:u,newMergesData:this.merges.getData(),oldStep:t}),{state:!0}}},{key:"getSelectedCellRiCi",value:function(e,t){var r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,t)}},{key:"xyInSelectedRect",value:function(e,t){var r=this.getSelectedRect(),n=r.left,i=r.top,a=r.width,o=r.height,l=e-this.cols.indexWidth,s=t-this.rows.height;return l>n&&l<n+a&&s>i&&s<i+o}},{key:"isMergeCell",value:function(e,t){var r=!1,n="";return this.merges.each((function(i){i.includeByRiCi(e,t)&&(r=!0,n=i)})),{state:r,data:n}}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var e=this.clipboard;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}},{key:"getMoveRect",value:function(e){return this.getRect(e)}},{key:"getRect",value:function(e){var t=this.scroll,r=this.rows,n=this.cols,i=this.exceptRowSet,a=e.sri,o=e.sci,l=e.eri,s=e.eci;if(a<0&&o<0)return{left:0,l:0,top:0,t:0,scroll:t};var u=n.sumWidth(0,o),c=r.sumHeight(0,a,i),f=r.sumHeight(a,l+1,i),h=n.sumWidth(o,s+1),p=u-t.x,v=c-t.y,d=this.freezeTotalHeight(),g=this.freezeTotalWidth();return g>0&&g>u&&(p=u),d>0&&d>c&&(v=c),{l:u,t:c,left:p,top:v,height:f,width:h,scroll:t}}},{key:"getCellRectByXY",value:function(e,t){var r=this.scroll,n=this.merges,i=this.rows,a=this.cols,o=Ul.call(this,t,r.y),l=o.ri,s=o.top,u=o.height,c=Yl.call(this,e,r.x),f=c.ci,h=c.left,p=c.width;if(-1===f&&(p=a.totalWidth()),-1===l&&(u=i.totalHeight()),l>=0||f>=0){var v=n.getFirstIncludes(l,f);if(v){l=v.sri,f=v.sci;var d=this.cellRect(l,f);h=d.left,s=d.top,p=d.width,u=d.height}}return{ri:l,ci:f,left:h,top:s,width:p,height:u}}},{key:"getCellRectByXYWithNotTotalResult",value:function(e,t){var r=this.scroll,n=this.merges,i=(this.rows,this.cols,Ul.call(this,t,r.y)),a=i.ri,o=i.top,l=i.height,s=Yl.call(this,e,r.x),u=s.ci,c=s.left,f=s.width;if(a>=0||u>=0){var h=n.getFirstIncludes(a,u);if(h){a=h.sri,u=h.sci;var p=this.cellRect(a,u);c=p.left,o=p.top,f=p.width,l=p.height}}return{ri:a,ci:u,left:c,top:o,width:f,height:l}}},{key:"isSignleSelected",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=Ml(a.merge,2),l=o[0],s=o[1];if(t+l===n&&r+s===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=Ml(a.merge,2),l=o[0],s=o[1];if(t+l===n&&r+s===i)return!0}return!1}},{key:"dateInput",value:function(e,t,r,n){}},{key:"merge",value:function(){var e=this.selector,t=this.rows;if(!this.isSignleSelected()){var r=Ml(e.size(),2),n=r[0],i=r[1];if(n>1||i>1){var a=e.range,o=a.sri,l=a.sci,s=t.getCellOrNew(o,l);s.merge=[n-1,i-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(o,l,s)}}}},{key:"unmerge",value:function(){var e=this,t=this.selector;if(this.isSignleSelected()){var r=t.range,n=r.sri,i=r.sci;this.changeData((function(){e.rows.deleteCell(n,i,"merge"),e.merges.deleteWithin(t.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var e=this,t=this.autoFilter,r=this.selector;this.changeData((function(){if(t.active())t.clear(),e.exceptRowSet=new Set,e.sortedRowMap=new Map,e.unsortedRowMap=new Map;else{for(var n=r.range.toString(),i=r.range.eri,a=e.rows,o=r.range.sci;o<=r.range.eci;o++){var l=new E.a(r.range.sri,o,r.range.sri,o);i<(l=a.autoFilterRef(n,l)).eri&&(i=l.eri)}var s=new E.a(r.range.sri,r.range.sci,i,r.range.eci);t.ref=s.toString()}}))}},{key:"throwFormula",value:function(){var e=this.selector,t=this.rows;this.changeData((function(){e.range.each((function(e,r){var n=t.getCellOrNew(e,r);n&&n.text&&n.formulas&&t.setCellAll(e,r,n.text,n.text)}))}))}},{key:"setAutoFilter",value:function(e,t,r,n){var i=this.autoFilter;i.addFilter(e,r,n),i.setSort(e,t),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var e=this,t=this.autoFilter,r=this.rows;if(t.active()){var n=t.sort,i=t.filteredRows((function(e,t){return r.getCell(e,t)})),a=i.rset,o=i.fset,l=Array.from(o),s=Array.from(o);n&&l.sort((function(e,t){return"asc"===n.order?e-t:"desc"===n.order?t-e:0})),this.exceptRowSet=a,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach((function(t,r){e.sortedRowMap.set(s[r],t),e.unsortedRowMap.set(t,s[r])}))}}},{key:"deleteCell",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){e.rows.deleteCells(r.range,t),"all"!==t&&"format"!==t||e.merges.deleteWithin(r.range)}),{type:2})}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.getMax(),i=(n.mri,n.mci,this.selector.range),a=i.sri,o=i.sci,l=this.rows,s=this.merges,u=this.cols;r="row"===e?-1!=r?r:a:-1!=r?r:o,this.changeData((function(){var n=r;"row"===e?l.insert(r,t):"column"===e&&(l.insertColumn(r,t),n=r,u.len+=t),s.shift(e,n,t,(function(e,t,r,n){var i=l.getCell(e,t);i.merge[0]+=r,i.merge[1]+=n}))}),{type:13,data:this.getData(),property:"insert"})}},{key:"delete",value:function(e){var t=this;this.changeData((function(){var r=t.rows,n=t.merges,i=t.selector,a=t.cols,o=i.range,l=i.range,s=l.sri,u=l.sci,c=l.eri,f=l.eci,h=Ml(i.range.size(),2),p=h[0],v=h[1],d=s,g=p;"row"===e?r.delete(s,c):"column"===e&&(r.deleteColumn(u,f),d=o.sci,g=v,a.len-=1),n.shift(e,d,-g,(function(e,t,n,i){var a=r.getCell(e,t);a.merge[0]+=n,a.merge[1]+=i,0===a.merge[0]&&0===a.merge[1]&&delete a.merge}))}))}},{key:"scrollx",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.cols,a=Ml(n,2)[1],o=Ml(P.default.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getWidth(e)})),3),l=o[0],s=o[1],u=o[2],c=s;e>0&&(c+=u),r.x!==c&&(r.ci=e>0?l:0,r.x=c,t())}},{key:"scrolly",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.rows,a=Ml(n,1)[0],o=Ml(P.default.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getHeight(e)})),3),l=o[0],s=o[1],u=o[2],c=s;e>0&&(c+=u),r.y!==c&&(r.ri=e>0?l:0,r.y=c,t())}},{key:"cellRect",value:function(e,t){var r=this.rows,n=this.cols,i=n.sumWidth(0,t),a=r.sumHeight(0,e),o=r.getCell(e,t),l=n.getWidth(t),s=r.getHeight(e);if(null!==o&&o.merge){var u=Ml(o.merge,2),c=u[0],f=u[1];if(c>0)for(var h=1;h<=c;h+=1)s+=r.getHeight(e+h);if(f>0)for(var p=1;p<=f;p+=1)l+=n.getWidth(t+p)}return{left:i,top:a,width:l,height:s,cell:o}}},{key:"getCell",value:function(e,t){return this.rows.getCell(e,t)}},{key:"getMax",value:function(){var e=this.cols.len;return{mri:this.rows.len,mci:e}}},{key:"isEmpty",value:function(e){return this.rows.isEmpty(e)}},{key:"renderFormat",value:function(e,t,r,n,i){return new X(t).renderFormat(e,r,n,this,i)}},{key:"isFormula",value:function(e){return this.rows.isFormula(e)}},{key:"toString",value:function(e){return this.rows.toString(e)}},{key:"isBackEndFunc",value:function(e){return this.rows.isBackEndFunc(e)}},{key:"isReferOtherSheet",value:function(e){return this.rows.isReferOtherSheet(e)}},{key:"getCellTextOrDefault",value:function(e,t){var r=this.getCell(e,t);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(e,t){var r=this.getCell(e,t);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleHandle",value:function(e,t,r,n,i){var a=this.styles[e];return!(!a||a.format!==t)}},{key:"getCellStyleOrDefault",value:function(e,t){var r=this.styles,n=this.rows.getCell(e,t),i=n&&void 0!==n.style?r[n.style]:{};return P.default.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var e=this.selector,t=e.ri,r=e.ci;return this.getCellStyleOrDefault(t,r)}},{key:"getCellByExpr",value:function(e,t,r,n,i){var a=n.substring(0,i),o=n.substring(i,n.length);n=a+e+o;var l=Hr.call(t,this.viewRange(),!0,n);return{text:l.Sheets[r].A1.w?l.Sheets[r].A1.w:l.Sheets[r].A1.v,formulas:a+"".concat(r,"!")+e+o}}},{key:"setCellText",value:function(e,t,r,n){var i=r.text,a=r.style,o=this.rows,l=this.history,s=this.validations;"finished"===n?(o.setCellText(e,t,{text:""}),l.add(this.getData()),o.setCellText(e,t,{text:i})):("end"===n?o.setCellAll(e,t,i):"formulas"===n?o.setCellAll(e,t,i,"-"):"style"===n?o.setCellText(e,t,{text:i,style:a},"style"):o.setCellText(e,t,{text:i}),this.change(this.getData())),s.validate(e,t,i)}},{key:"setCellWithFormulas",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"all",a=this.rows;a.setCellAll(e,t,r,n,i)}},{key:"setCellAll",value:function(e,t,r,n,i){var a=this.rows,o=this.history,l=this.validations;"finished"===i?(a.setCellAll(e,t,"",""),o.add(this.getData()),a.setCellAll(e,t,r,n)):a.setCellAll(e,t,r,n),l.validate(e,t,r,n)}},{key:"equationIsActive",value:function(){return this.showEquation}},{key:"freezeIsActive",value:function(){var e=Ml(this.freeze,2),t=e[0],r=e[1];return t>0||r>0}},{key:"setFreeze",value:function(e,t){var r=this;this.changeData((function(){r.freeze=[e,t]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(e,t){var r=this;this.changeData((function(){r.rows.setHeight(e,t)}),{type:3,ri:e})}},{key:"setColWidth",value:function(e,t){var r=this;this.changeData((function(){r.cols.setWidth(e,t)}),{type:4,ci:e})}},{key:"viewHeight",value:function(){var e=this.settings,t=e.view,r=e.showToolbar,n=t.height();return r&&(n-=41),n}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var e=Ml(this.freeze,2),t=e[0],r=e[1];return new E.a(0,0,t-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"viewRange",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=Ml(n,1)[0]),a<=0&&(a=Ml(n,2)[1]);for(var o=0,l=0,s=[t.len,r.len],u=s[0],c=s[1],f=i;f<t.len&&(u=f,!((l+=t.getHeight(f))>this.viewHeight()));f+=1);for(var h=a;h<r.len&&(c=h,!((o+=r.getWidth(h))>this.viewWidth()));h+=1);return new E.a(i,a,u,c,o,l)}},{key:"viewRange2",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=Ml(n,1)[0]),a<=0&&(a=Ml(n,2)[1]);for(var o=0,l=0,s=[t.len,r.len],u=s[0],c=s[1],f=i;f<t.len&&(u=f,!((l+=t.getHeight(f))>this.viewHeight()));f+=1);for(var h=a;h<r.len;h+=1)o+=r.getWidth(h),c=h;return new E.a(i,a,u,c,o,l)}},{key:"eachMergesInView",value:function(e,t){this.merges.filterIntersects(e).forEach((function(e){return t(e)}))}},{key:"rowEach",value:function(e,t,r){for(var n=0,i=this.rows,a=this.exceptRowSet,o=Sl(a),l=0,s=0;s<o.length;s+=1)o[s]<e&&(l+=1);for(var u=e+l;u<=t+l;u+=1)if(a.has(u))l+=1;else{var c=i.getHeight(u);if(r(u,n,c),(n+=c)>this.viewHeight())break}}},{key:"colEach",value:function(e,t,r){for(var n=0,i=this.cols,a=e;a<=t;a+=1){var o=i.getWidth(a);if(r(a,n,o),(n+=o)>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(e){for(var t=this.styles,r=0;r<t.length;r+=1){var n=t[r];if(P.default.equals(n,e))return r}return t.push(e),t.length-1}},{key:"getChangeDataToCalc",value:function(){var e=this.multiPreAction;if(e.undoItems.length<=0)return null;var t=e.undoItems[e.undoItems.length-1];return Object(P.isHave)(t)?t:null}},{key:"changeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.type,n=void 0===r?-1:r,i=t.ri,a=void 0===i?-1:i,o=t.ci,l=void 0===o?-1:o,s=t.cellRange,u=void 0===s?"":s,c=t.property,f=void 0===c?"":c,h=t.value,p=void 0===h?"":h;if(!1!==this.settings.showEditor){var v={},d=this.merges.getData(),g=this.multiPreAction,m=this.selector,y=g.getStepType(n,{expr:"",property:f,value:p,oldCell:v,range:m.range,ri:a,ci:l,cellRange:u});if(""!==u){var b=this.multiPreAction;v=b.eachRange(u)}e(),this.changeToHistory({type:n,ri:a,ci:l,cellRange:u,property:f,value:p,oldCell:v,oldMergesData:d,newData:this.getData()},y),this.changeDataForCalc=this.getChangeDataToCalc(),this.change(this.getData())}}},{key:"cutPaste",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Pl.call(this,e,t,r)}},{key:"setData",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.autoFilter;return Object.keys(e).forEach((function(a){if("merges"===a||"cols"===a||"validations"===a)t[a].setData(e[a]);else if("flex"===a)i.addFiexRows(e[a]);else if("rows"===a)t[a].setData(e[a],r,n,t.settings.rowsInit);else if("freeze"===a){var o=Ml(Object(L.expr2xy)(e[a]),2),l=o[0],s=o[1];t.freeze=[s,l]}else"pictures"===a?e[a]&&Bl.call(t,e[a],"from",r):"autofilter"===a?e[a]&&e[a].ref&&(i.ref=e[a].ref,i.filters=e[a].filters,i.sort=e[a].sort):void 0!==e[a]&&(t[a]=e[a])})),this}},{key:"selectorCellText",value:function(e,t,r,n){return Fl.call(this,e,t,r,n)}},{key:"getData",value:function(){var e=this.name,t=this.freeze,r=this.styles,n=this.merges,i=this.rows,a=this.cols,o=this.validations,l=this.autoFilter,s=this.pasteDirectionsArr;return{editor:this.settings.showEditor,name:e,freeze:Object(L.xy2expr)(t[1],t[0]),styles:r,pictures:Bl(s,"to"),merges:n.getData(),rows:i.getData(),cols:a.getData(),validations:o.getData(),autofilter:l.getData()}}}])&&jl(t.prototype,r),n&&jl(t,n),e}(),$l=(r(190),{toolbar:{undo:"撤销",redo:"恢复",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",font:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",textColor:"字体颜色",fillColor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",add:"显示公式",calc:"开始计算",formula:"函数",more:"更多",throwFormula:"清除公式",comeBack:"返回"},revision:{comeBack:"退出"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",insertRow:"插入行",insertColumn:"插入列",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",errorPop:"出现问题",recover:"恢复此版本"},format:{normal:"常规",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},date_formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}});function Kl(e){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Zl="";try{Zl=new function(){var e=this;if(e.realTimeLoggingOn=!0,e.useTimestamps=!1,e.useLocalStorage=!0,e.recordLogs=!0,e.autoTrim=!0,e.maxLines=2500,e.tailNumLines=100,e.logFilename="debugout.txt",e.depth=0,e.parentSizes=[0],e.currentResult="",e.startTime=new Date,e.output="",this.version=function(){return"0.5.0"},this.getLog=function(){var t=new Date;if(e.recordLogs||e.log("[debugout.js] log recording is off."),e.useLocalStorage){var r=window.localStorage.getItem("debugout.js");r&&(r=JSON.parse(r),e.startTime=new Date(r.startTime),e.output=r.log,t=new Date(r.lastLog))}return e.output+"\n---- Log retrieved: "+t+" ----\n"+e.formatSessionDuration(e.startTime,t)},this.tail=function(t){t=t||e.tailLines;return e.trimLog(e.getLog(),t)},this.search=function(t){for(var r=e.output.split("\n"),n=new RegExp(t),i=[],a=0;a<r.length;a++){var o="["+a+"] ";r[a].match(n)&&i.push(o+r[a])}var l=i.join("\n");return 0==l.length&&(l='Nothing found for "'+t+'".'),l},this.getSlice=function(t,r){return e.output.split("\n").slice(t,t+r).join("\n")},this.downloadLog=function(){var t="data:text/plain;charset=utf-8,",r=e.getLog();t+=encodeURIComponent(r);var n=document.createElement("a");n.href=t,n.target="_blank",n.download=e.logFilename,document.body.appendChild(n),n.click(),n.remove()},this.clear=function(){var t=new Date;if(e.output="---- Log cleared: "+t+" ----\n",e.useLocalStorage){var r={startTime:e.startTime,log:e.output,lastLog:t};r=JSON.stringify(r),window.localStorage.setItem("debugout.js",r)}e.realTimeLoggingOn&&console.log("[debugout.js] clear()")},this.log=function(t){if(e.realTimeLoggingOn&&console.log(t),null!=e.determineType(t)&&e.recordLogs){var r=t;if(e.useTimestamps){var n=new Date;e.output+=e.formatTimestamp(n)}if(e.output+=r+"\n",e.autoTrim&&(e.output=e.trimLog(e.output,e.maxLines)),e.useLocalStorage){var i=new Date,a={startTime:e.startTime,log:e.output,lastLog:i};a=JSON.stringify(a),window.localStorage.setItem("debugout.js",a)}}e.depth=0,e.parentSizes=[0],e.currentResult=""},this.determineType=function(e){if(null!=e){var t,r=Kl(e);if("object"==r)t=null==e.length?"function"==typeof e.getTime?"Date":"function"==typeof e.test?"RegExp":"Object":"Array";else t=r;return t}return null},this.formatType=function(t,r){switch(t){case"Object":e.currentResult+="{\n",e.depth++,e.parentSizes.push(e.objectSize(r));var n=0;for(var i in r){e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+=i+": ";var a=e.determineType(r[i]);(o=e.formatType(a,r[i]))?(e.currentResult+=o,n!=e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"):(n!=e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"),n++}if(e.depth--,e.parentSizes.pop(),e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+="}",0==e.depth)return e.currentResult;break;case"Array":e.currentResult+="[",e.depth++,e.parentSizes.push(r.length);for(n=0;n<r.length;n++){var o;"Object"!=(a=e.determineType(r[n]))&&"Array"!=a||(e.currentResult+="\n"+e.indentsForDepth(e.depth)),(o=e.formatType(a,r[n]))?(e.currentResult+=o,n!=e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Array"==a&&(e.currentResult+="\n")):(n!=e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Object"!=a?e.currentResult+="\n":n==e.parentSizes[e.depth]-1&&(e.currentResult+="\n"))}if(e.depth--,e.parentSizes.pop(),e.currentResult+="]",0==e.depth)return e.currentResult;break;case"function":var l=(r+="").split("\n");for(n=0;n<l.length;n++)l[n].match(/\}/)&&e.depth--,e.currentResult+=e.indentsForDepth(e.depth),l[n].match(/\{/)&&e.depth++,e.currentResult+=l[n]+"\n";return e.currentResult;case"RegExp":return"/"+r.source+"/";case"Date":case"string":return e.depth>0||0==r.length?'"'+r+'"':r;case"boolean":return r?"true":"false";case"number":return r+""}},this.indentsForDepth=function(e){for(var t="",r=0;r<e;r++)t+="\t";return t},this.trimLog=function(e,t){var r=e.split("\n");return r.length>t&&(r=r.slice(r.length-t)),r.join("\n")},this.lines=function(){return e.output.split("\n").length},this.formatSessionDuration=function(e,t){var r=t-e,n=Math.floor(r/1e3/60/60),i=("0"+n).slice(-2);r-=1e3*n*60*60;var a=Math.floor(r/1e3/60),o=("0"+a).slice(-2);r-=1e3*a*60;var l=Math.floor(r/1e3);return r-=1e3*l,"---- Session duration: "+i+":"+o+":"+("0"+l).slice(-2)+" ----"},this.formatTimestamp=function(e){var t=e.getFullYear(),r=e.getDate();return"["+t+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+r+" "+Number(e.getHours())+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)+"]: "},this.objectSize=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},e.useLocalStorage){var t=window.localStorage.getItem("debugout.js");if(t){t=JSON.parse(t),e.output=t.log;var r=new Date(t.startTime),n=new Date(t.lastLog);e.output+="\n---- Session end: "+t.lastLog+" ----\n",e.output+=e.formatSessionDuration(r,n),e.output+="\n\n"}}e.output+="---- Session started: "+e.startTime+" ----\n\n"}}catch(e){}function Ql(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,"spreadsheet",(function(){return es}));var Jl=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sheet1";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=t;"string"==typeof t&&(a=document.querySelector(t)),this.locale("zh-cn",$l),this.data=new ql(i,r,n);var l=o("div","".concat(Me.a)).on("contextmenu",(function(e){return e.preventDefault()}));a.appendChild(l.el),this.sheet=new al(l,this.data),this.data.sheet=this.sheet}var t,r,n;return t=e,n=[{key:"locale",value:function(e,t){h(e,t)}}],(r=[{key:"setDataSettings",value:function(e){this.data.settings.showEditor=e}},{key:"loadData",value:function(e){return this.sheet.loadData(e),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(e){return this.data.change=e,this}},{key:"locale",value:function(e,t){h(e,t)}},{key:"getEditorStatus",value:function(){var e=this.sheet.editor,t=e.ri,r=e.ci,n=e.pos,i=e.editorText.getText();return{status:e.isDisplay(),inputText:i,ri:t,ci:r,pos:n}}},{key:"setEditorText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.sheet.editor;e=""!=e?e:"=",r.inputEventHandler(e,t,!0)}},{key:"setTextEnd",value:function(e,t,r){var n=this.sheet,i=n.editor,a=n.data;i.setCellEnd({text:e.text,formulas:e.formulas}),a.setCellAll(t,r,e.formulas+"",e.formulas+"",""),this.sheet.selectorEditorReset(t,r),setTimeout((function(){i.setCursorPos(e.formulas.length)}),100)}},{key:"getText",value:function(e,t,r){for(var n=this.sheet,i=n.selectors,a=n.data,o=n.table,l="",s=0;s<i.length;s++)l+=i[s].erpx;return a.getCellByExpr(l,o,e,t,r)}},{key:"removeEvent",value:function(){this.sheet.removeEvent()}}])&&Ql(t.prototype,r),n&&Ql(t,n),e}(),es=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Jl(e,t)};window&&(window.jsSpreadsheet=r(191),window.drag=ol,window.x=window.x||{},window.bugout=Zl,window.x.spreadsheet=es,window.x.spreadsheet.locale=function(e,t){return h(e,t)});t.default=Jl},21:function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(20),a=r(19),o=r(28),l=function(){function e(t,r,n){var i,a;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start_pst=n-t.length,this.end_pst=n,-1!=t.indexOf("!")){var l=t.split("!");a=o(l[0]),i=l[1],this.range_start_pst=n-l[1].length}else a=r.sheet_name,i=t,this.range_start_pst=this.start_pst;this.sheet=r.wb.Sheets[a],this.range_expression=i,this.sheet_name=a,this.formula=r}var t,r,l;return t=e,(r=[{key:"calc",value:function(){var e,t=this.sheet_name,r=this.sheet,n=this.range_expression,o=this.formula,l=n.split(":"),s=parseInt(l[0].replace(/^[A-Z]+/,""),10)||0,u=l[1].replace(/^[A-Z]+/,"");""===u&&r["!ref"]&&(u=r["!ref"].split(":")[1].replace(/^[A-Z]+/,"")),e=parseInt(""==u?"500000":u,10);for(var c=i(l[0]),f=i(l[1]),h=[],p=s;p<=e;p++){var v=[];h.push(v);for(var d=c;d<=f;d++){var g=a(d)+p,m=t+"!"+g;if(o.formula_ref[m]){if("new"===o.formula_ref[m].status)o.exec_formula(o.formula_ref[m]);else if("working"===o.formula_ref[m].status)throw new Error("Circular ref");"e"===r[g].t?v.push(r[g]):v.push(r[g].v)}else r[g]?"e"===r[g].t?v.push(r[g]):v.push(r[g].v):v.push(null)}}return h}}])&&n(t.prototype,r),l&&n(t,l),e}();e.exports=l},22:function(module,exports,__webpack_require__){var utils=__webpack_require__(11),error=__webpack_require__(8),numeral=__webpack_require__(32);function num2e(e){var t=Math.floor(Math.log(e)/Math.LN10),r=e*Math.pow(10,-t);return t.toString().length<10&&(t="0"+t),r+"E+"+t}function allzero(e){e=e.toString();for(var t=0;t<e.length;t++)if("0"!=e[t])return!1;return!0}function decimalsToFractional(e){formatDecimals=e.toFixed(2);var t=3,r=3*formatDecimals;return function e(){for(var n=t>r?t:r;n>1;n--)Number.isInteger(r/n)&&Number.isInteger(t/n)&&(r/=n,t/=n,e())}(),r=parseInt(r),"".concat(r,"/").concat(t)}exports.ASC=function(e){for(var t="",r=0;r<e.length;r++)e.charCodeAt(r)>65248&&e.charCodeAt(r)<65375?t+=String.fromCharCode(e.charCodeAt(r)-65248):t+=String.fromCharCode(e.charCodeAt(r));return t},exports.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},exports.CHAR=function(e){return(e=utils.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},exports.CLEAN=function(e){return(e=e||"").replace(/[\0-\x1F]/g,"")},exports.CODE=function(e){return(e=e||"").charCodeAt(0)},exports.CONCATENATE=function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var r=0;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")},exports.DBCS=function(){throw new Error("DBCS is not implemented")},exports.DOLLAR=function(e,t){if(t=void 0===t?2:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var r="";return t<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),r="($0,0)"):t>0&&(r="($0,0."+new Array(t+1).join("0")+")"),numeral(e).format(r)},exports.EXACT=function(e,t){return e===t},exports.FIND=function(e,t,r){return r=void 0===r?0:r,t.indexOf(e),t?t.indexOf(e,r-1)+1:null},exports.FIXED=function(e,t,r){if(t=void 0===t?2:t,r=void 0!==r&&r,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=r?"0":"0,0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(n+="."+new Array(t+1).join("0")),numeral(e).format(n)},exports.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},exports.INDEX=function(e,t,r){return"string"==typeof e&&(e=utils.strToMatrix(e)),e[t][r-1]},exports.LEFT=function(e,t){return t=void 0===t?1:t,(t=utils.parseNumber(t))instanceof Error||"string"!=typeof e?error.value:e?e.substring(0,t):null},exports.LEN=function(e){return 0===arguments.length?error.error:"string"==typeof e?e?e.length:0:e.length?e.length:error.value},exports.LOWER=function(e){return"string"!=typeof e?error.value:e?e.toLowerCase():e},exports.MID=function(e,t,r){if(t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||"string"!=typeof e)return r;var n=t-1,i=n+r;return e.substring(n,i)},exports.NUMBERVALUE=function(e,t,r){return t=void 0===t?".":t,r=void 0===r?",":r,e.indexOf("%")>0?(e=e.replace("%",""),parseFloat(e)/100):Number(e.replace(t,".").replace(r,""))},exports.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},exports.PROPER=function(e){return void 0===e||0===e.length?error.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?error.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},exports.REGEXEXTRACT=function(e,t){var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null},exports.REGEXMATCH=function(e,t,r){var n=e.match(new RegExp(t));return r?n:!!n},exports.REGEXREPLACE=function(e,t,r){return e.replace(new RegExp(t),r)},exports.REPLACE=function(e,t,r,n){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||"string"!=typeof e||"string"!=typeof n?error.value:e.substr(0,t-1)+n+e.substr(t-1+r)},exports.REPT=function(e,t){return(t=utils.parseNumber(t))instanceof Error?t:new Array(t+1).join(e)},exports.RIGHT=function(e,t){return t=void 0===t?1:t,(t=utils.parseNumber(t))instanceof Error?t:e?e.substring(e.length-t):null},exports.SEARCH=function(e,t,r){var n;return"string"!=typeof e||"string"!=typeof t?error.value:(r=void 0===r?0:r,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1)?error.value:n)},exports.SPLIT=function(e,t){return e.split(t)},exports.SUBSTITUTE=function(e,t,r,n){if(!(e&&t&&r))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),r);for(var i=0,a=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++a===n)return e.substring(0,i)+r+e.substring(i+t.length)},exports.T=function(e){return"TRUE"==e||"FALSE"==e?"":"string"==typeof e?e:""},exports.TEXT=function(value,format){try{if(format.indexOf("%")>=0){var fixed=format.split(".")[1].length-1;return(100*parseFloat(value)).toFixed(fixed)+"%"}var Formulas=window.jsSpreadsheet.AllFormulas,result=Formulas.TEXT(value,format);console.log(result)}catch(e){var result=void 0}if(null==result){if(format.indexOf("#")>=0&&format.indexOf("?/?")>=0){var x=parseFloat(value)-parseInt(value);return 0!=parseInt(value)?parseInt(value)+" "+decimalsToFractional(x):decimalsToFractional(x)}if(format.indexOf("E+")>=0)return num2e(value);if(allzero(value)){for(var result="",i=0;i<format.length-value.length;i++)result+="0";return result+value}if(format.indexOf("#")>=0){var fmt=format;if(format.indexOf("[")>=0&&format.indexOf(";")>=0){var valid=format.split("#")[0];fmt=format.split("]")[1].split(";"),valid=valid.replace("[","").replace("]",""),fmt=eval(value+valid)?fmt[0]:fmt[1]}if(format.indexOf("#")>=0&&format.indexOf(!1)&&format.indexOf("0")>=0&&format.indexOf("°")<=0){value.toString().split(".")[1].length>format.split(".")[1].length&&(value=value.toFixed(format.split(".")[1].length)),value=value.toString();for(var result="",n=0,i=0;i<fmt.length;i++)"#"==fmt[i]||"0"==fmt[i]||"."==fmt[i]?(result+=value[n],n+=1):result+=fmt[i];return result}fmt=fmt.replace("##0","##"),value=value.toString();for(var result="",n=0,i=0;i<fmt.length;i++)"#"==fmt[i]||"0"==fmt[i]?(result+=value[n],n+=1):result+=fmt[i];return result}}return result},exports.TRIM=function(e){return"string"!=typeof e?error.value:e.replace(/ +/g," ").trim()},exports.UNICHAR=function(e){return 0==e?error.value:String.fromCharCode(e)},exports.UNICODE=function(e){return e.charCodeAt(0)},exports.UPPER=function(e){return"string"!=typeof e?error.value:e.toUpperCase()},exports.VALUE=function(e){return"string"!=typeof e?error.value:numeral().unformat(e)}},23:function(e,t,r){var n=r(8);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){switch(e){case n.nil.message:return 1;case n.div0.message:return 2;case n.value.message:return 3;case n.ref.message:return 4;case n.name.message:return 5;case n.num.message:return 6;case n.na.message:return 7;case n.data.message:return 8}return n.na},t.INFO=function(){throw new Error("INFO is not implemented")},t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return[n.value.message,n.ref.message,n.div0.message,n.num.message,n.name.message,n.nil.message].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===n.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=function(e){return"FALSE"!=e&&(1==e||0==e)},t.ISNA=function(e){return e===n.na||e===n.na.message},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=function(){return null!=arguments[0]},t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)?e:e instanceof Date?e.getTime():!0===e||"TRUE"==e.toString().toUpperCase()||"FALSE"==e.toString().toUpperCase()?1:!1===e||"string"==typeof e?0:ISERROR(e)?e:0},t.NA=function(){return n.na},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){if("number"==typeof e&&!isNaN(e)&&isFinite(e))return 1;if("string"==typeof e){if("{"!=e.slice(0,1))return 2;var r=utils.strToMatrix(e);if(Array.isArray(r))return 64}return"FALSE"!=e&&(1==e||0==e?4:t.ISERR(e)||e===n.na?16:Array.isArray(r)?64:void 0)}},24:function(e,t,r){var n=r(8),i=r(11),a=new Date(1900,0,1),o=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],l=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],s=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function u(e){return 1===new Date(e,1,29).getMonth()}function c(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function f(e){return(e-a)/864e5+(e>-22038912e5?2:1)}t.DATE=function(e,t,r){return window.jsSpreadsheet.AllFormulas.DATE(e,t,r)},t.DATEVALUE=function(e){if("string"!=typeof e)return n.value;var t=Date.parse(e);return isNaN(t)?n.value:t<=-22038912e5?(t-a)/864e5+1:(t-a)/864e5+2},t.DAY=function(e){var t=i.parseDate(e);return t instanceof Error?t:t.getDate()},t.DAYS=function(e,t){return e=i.parseDate(e),t=i.parseDate(t),e instanceof Error?e:t instanceof Error?t:f(e)-f(t)},t.DAYS360=function(e,t,r){if(r=i.parseBool(r),e=i.parseDate(e),t=i.parseDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;var n,a,o=e.getMonth(),l=t.getMonth();if(r)n=31===e.getDate()?30:e.getDate(),a=31===t.getDate()?30:t.getDate();else{var s=new Date(e.getFullYear(),o+1,0).getDate(),u=new Date(t.getFullYear(),l+1,0).getDate();n=e.getDate()===s?30:e.getDate(),t.getDate()===u?n<30?(l++,a=1):a=30:a=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(l-o)+(a-n)},t.EDATE=function(e,t){return(e=i.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),f(e))},t.EOMONTH=function(e,t){return(e=i.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),f(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},t.HOUR=function(e){return"number"!=typeof e||isNaN(e)?(e=i.parseDate(e))instanceof Error?e:e.getHours():parseInt(24*(parseFloat(e)-parseInt(e)))},t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return n.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var r=Math.floor(e/2592e3);e%=2592e3;var i=Math.floor(e/86400);e%=86400;var a=Math.floor(e/3600);e%=3600;var o=Math.floor(e/60),l=e%=60;return"P"+(t=t>0?t+"Y":"")+(r=r>0?r+"M":"")+(i=i>0?i+"D":"")+"T"+(a=a>0?a+"H":"")+(o=o>0?o+"M":"")+(l=l>0?l+"S":"")},t.ISOWEEKNUM=function(e){if((e=i.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return window.jsSpreadsheet.AllFormulas.MINUTE(e)},t.MONTH=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,r){return r instanceof Array&&(r=i.flatten(r)),window.jsSpreadsheet.AllFormulas.NETWORKDAYS(e,t,r)},t.NETWORKDAYSINTL=function(e,t,r,a){"string"==typeof a&&a.indexOf("{")>=0&&(a=i.parseDateArray(i.strToMatrix(a)[0]));try{return window.jsSpreadsheet.AllFormulas.NETWORKDAYS$INTL(e,t,r,a)}catch(m){if(e=i.ExcelDateToJSDate(i.parseDate(e)),t=i.ExcelDateToJSDate(i.parseDate(t)),e instanceof Error)return e;if(t instanceof Error)return t;if(void 0===r)r=s[1];else if("string"==typeof r&&7===r.length){for(var o=[],l=0;l<r.length;l++)"1"==r[l]&&o.push(l+1>6?0:l+1);r=o}else r=s[r];if(!(r instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(l=0;l<a.length;l++){var u=i.parseDate(a[l]);if(u instanceof Error)return u;a[l]=u}var c=(t-e)/864e5+1,f=c,h=e;for(l=0;l<c;l++){var p=(new Date).getTimezoneOffset()>0?h.getUTCDay():h.getDay(),v=!1;p!==r[0]&&p!==r[1]||(v=!0);for(var d=0;d<a.length;d++){var g=a[d];if(g.getDate()===h.getDate()&&g.getMonth()===h.getMonth()&&g.getFullYear()===h.getFullYear()){v=!0;break}}v&&f--,h.setDate(h.getDate()+1)}return f}},t.NETWORKDAYS.INTL=function(e,t,r,a){if("string"==typeof a&&a.indexOf("{")>=0&&(a=i.parseDateArray(i.strToMatrix(a))),e=i.ExcelDateToJSDate(e),t=i.ExcelDateToJSDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(!((r=void 0===r?s[1]:s[r])instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var l=i.parseDate(a[o]);if(l instanceof Error)return l;a[o]=l}var u=(t-e)/864e5+1,c=u,f=e;for(o=0;o<u;o++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),p=!1;h!==r[0]&&h!==r[1]||(p=!0);for(var v=0;v<a.length;v++){var d=a[v];if(d.getDate()===f.getDate()&&d.getMonth()===f.getMonth()&&d.getFullYear()===f.getFullYear()){p=!0;break}}p&&c--,f.setDate(f.getDate()+1)}return c},t.NOW=function(){return new Date},t.SECOND=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,r){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:e<0||t<0||r<0?n.num:(3600*e+60*t+r)/86400},t.TIMEVALUE=function(e){var t=window.jsSpreadsheet.AllFormulas;try{return t.TIMEVALUE(e)}catch(e){return n.value}},t.TODAY=function(){return window.jsSpreadsheet.AllFormulas.TODAY()},t.WEEKDAY=function(e,t){if((e=i.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var r=e.getDay();return l[t][r]},t.WEEKNUM=function(e,t){if((e=i.parseDate(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var r=o[t],n=new Date(e.getFullYear(),0,1),a=n.getDay()<r?1:0;return n-=24*Math.abs(n.getDay()-r)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+a},t.WORKDAY=function(e,t,r){return null!=r&&(r=i.flatten(r)),window.jsSpreadsheet.AllFormulas.WORKDAY(e,t,r)},t.WORKDAYINTL=function(e,t,r,a){if((e=i.parseDate(e))instanceof Error)return e;if(0==r)return n.num;if((t=i.parseNumber(t))instanceof Error)return t;if(t<0)return n.num;if(!((r=void 0===r?s[1]:s[r])instanceof Array))return n.value;void 0===a?a=[]:a instanceof Array||(a=[a]);for(var o=0;o<a.length;o++){var l=i.parseDate(a[o]);if(l instanceof Error)return l;a[o]=l}for(var u=0;u<t;){if(e.setDate(e.getDate()+1),(h=e.getDay())!==r[0]&&h!==r[1]){for(var c=0;c<a.length;c++){var f=a[c];if(f.getDate()===e.getDate()&&f.getMonth()===e.getMonth()&&f.getFullYear()===e.getFullYear()){u--;break}}u++}}var h;return e.getFullYear()+"/"+e.getMonth()+"/"+(h=e.getDay())},t.YEAR=function(e){return(e=i.parseDate(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,r){if((e=i.parseDate(e))instanceof Error)return e;if((t=i.parseDate(t))instanceof Error)return t;r=r||0;var n=e.getDate(),a=e.getMonth()+1,o=e.getFullYear(),l=t.getDate(),s=t.getMonth()+1,f=t.getFullYear();switch(r){case 0:return 31===n&&31===l?(n=30,l=30):31===n?n=30:30===n&&31===l&&(l=30),(l+30*s+360*f-(n+30*a+360*o))/360;case 1:var h=365;if(o===f||o+1===f&&(a>s||a===s&&n>=l))return(o===f&&u(o)||function(e,t){var r=e.getFullYear(),n=new Date(r,2,1);if(u(r)&&e<n&&t>=n)return!0;var i=t.getFullYear(),a=new Date(i,2,1);return u(i)&&t>=a&&e<a}(e,t)||1===s&&29===l)&&(h=366),c(e,t)/h;var p=f-o+1,v=(new Date(f+1,0,1)-new Date(o,0,1))/1e3/60/60/24/p;return c(e,t)/v;case 2:return c(e,t)/360;case 3:return c(e,t)/365;case 4:return(l+30*s+360*f-(n+30*a+360*o))/360}}},28:function(e,t,r){"use strict";e.exports=function(e){var t=e.match(/^'(.*)'$/);return t?t[1]:e}},29:function(e,t,r){var n=r(14),i=r(30),a=r(21);e.exports=function(e,t,r){var o;return isNaN(e)?"TRUE"===e?o=new n(1):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+:[A-Z]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+:[A-Z]+$/)?o=new a(e.trim().replace(/\$/g,""),t,r):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[A-Z]+[0-9]+$/)?((o=new i(e.trim().replace(/\$/g,""),t)).end_pst=r,o.buffer=e,o.start_pst=r-e.length):"string"==typeof e&&e.trim().replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+$/)?((o=new i(e.trim().replace(/\$/g,""),t)).end_pst=r,o.buffer=e,o.start_pst=r-e.length):"string"!=typeof e||isNaN(e.trim().replace(/%$/,""))?(o=e).end_pst=r:o=new n(+e.trim().replace(/%$/,"")/100):o=new n(+e),o}},30:function(e,t,r){"use strict";var n=r(28);e.exports=function(e,t){var r=this;this.name="RefValue",this.str_expression=e,this.formula=t,r.parseRef=function(){var r,i,a;if(-1!=e.indexOf("!")){var o=e.split("!");i=n(o[0]),r=t.wb.Sheets[i],a=o[1]}else r=t.sheet,i=t.sheet_name,a=e;if(!r)throw Error("Sheet "+i+" not found.");return{sheet:r,sheet_name:i,cell_name:a,cell_full_name:i+"!"+a}},this.calc=function(){var e=r.parseRef(),n=e.sheet,i=e.cell_name,a=e.cell_full_name,o=n[i];if(!o)return null;var l=t.formula_ref[a];if(!l){if("e"===o.t)throw console.log("ref is an error with no formula",i),new Error(o.w);return o.v}if("new"===l.status){if(t.exec_formula(l),"e"===o.t)throw console.log("ref is an error with new formula",a),new Error(o.w);return o.v}if("working"===l.status)throw new Error("Circular ref");if("done"===l.status){if("e"===o.t)throw console.log("ref is an error after formula eval"),new Error(o.w);return o.v}}}},31:function(e,t,r){var n=[r(175),r(180),r(35),r(181),r(15),r(22),r(24),r(182),r(23),r(183),r(16),r(34),r(184)];for(var i in n){var a=n[i];for(var o in a)t[o]=t[o]||a[o]}},34:function(e,t,r){var n=r(11),i=r(32);t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var r=!1,n=arguments[t],i=0;i<e.length&&!(r=e[i]===n);++i);r||e.push(n)}return e},t.FLATTEN=n.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){try{for(var r=t.split("."),n=e,i=0;i<r.length;++i){var a=r[i];if("]"===a[a.length-1]){var o=a.indexOf("["),l=a.substring(o+1,a.length-1);n=n[a.substring(0,o)][l]}else n=n[a]}return n}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){var e=n.flatten(arguments);return e.filter((function(e){return"number"==typeof e}))},t.NUMERAL=function(e,t){return i(e).format(t)}},35:function(e,t,r){var n=r(8),i=r(33).jStat,a=r(22),o=r(11),l=r(179);function s(e){return/^[01]{1,10}$/.test(e)}function u(e){return e=(e=e.toString()).replace("I","i").replace("J","j")}t.BESSELI=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:l.besseli(e,t)},t.BESSELJ=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:l.besselj(e,t)},t.BESSELK=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:l.besselk(e,t)},t.BESSELY=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:l.bessely(e,t)},t.BIN2DEC=function(e){if(!s(e))return n.num;var t=parseInt(e,2),r=e.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!s(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var i=parseInt(e,2).toString(16);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.BIN2OCT=function(e,t){if(!s(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var i=parseInt(e,2).toString(8);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.BITAND=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e&t},t.BITLSHIFT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0?n.num:Math.floor(e)!==e?n.num:e>0xffffffffffff?n.num:Math.abs(t)>53?n.num:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e|t},t.BITRSHIFT=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0?n.num:Math.floor(e)!==e?n.num:e>0xffffffffffff?n.num:Math.abs(t)>53?n.num:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e<0||t<0?n.num:Math.floor(e)!==e||Math.floor(t)!==t?n.num:e>0xffffffffffff||t>0xffffffffffff?n.num:e^t},t.COMPLEX=function(e,t,r){if(e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t))return n.value;if("i"!==(r=(r=void 0===r?"i":r).toLowerCase())&&"j"!==r)return n.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?r:t.toString()+r;if(0===t)return e.toString();var i=t>0?"+":"";return e.toString()+i+(1===t?r:t.toString()+r)},t.CONVERT=function(e,t,r){if((e=o.parseNumber(e))instanceof Error)return e;for(var i,a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],l={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=t.toLowerCase(),h=r.toLowerCase(),p=1,v=1,d=0;d<a.length;d++)i=null===a[d][2]?[]:a[d][2],(a[d][1].toLowerCase()===f||i.indexOf(t)>=0)&&(u=a[d]),(a[d][1].toLowerCase()===h||i.indexOf(r)>=0)&&(c=a[d]);if(null===u){var g=l[t.substring(0,2)],m=s[t.substring(0,1)];"da"===t.substring(0,2)&&(m=["dekao",10,"da"]),g?(p=g[2],f=t.substring(2)):m&&(p=m[1],f=t.substring(m[2].length));for(var y=0;y<a.length;y++)i=null===a[y][2]?[]:a[y][2],(a[y][1]===f||i.indexOf(f)>=0)&&(u=a[y])}if(null===c){var b=l[r.substring(0,2)],w=s[r.substring(0,1)];"da"===r.substring(0,2)&&(w=["dekao",10,"da"]),b?(v=b[2],h=r.substring(2)):w&&(v=w[1],h=r.substring(w[2].length));for(var x=0;x<a.length;x++)i=null===a[x][2]?[]:a[x][2],(a[x][1]===h||i.indexOf(h)>=0)&&(c=a[x])}return null===u||null===c?n.na:u[3]!==c[3]?"F"==t&&"C"==r?(e-32)/1.8:"C"==t&&"F"==r?1.8*e+32:n.na:e*u[6]*p/(c[6]*v)},t.DEC2BIN=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return n.num;if(e<0)return"1"+a.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var r=parseInt(e,10).toString(2);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DEC2HEX=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return n.num;if(e<0)return(1099511627776+e).toString(16);var r=parseInt(e,10).toString(16);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DEC2OCT=function(e,t){if((e=o.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return n.num;if(e<0)return(1073741824+e).toString(8);var r=parseInt(e,10).toString(8);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?a.REPT("0",t-r.length)+r:n.num},t.DELTA=function(e,t){return t=void 0===t?0:t,e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:e===t?1:0},t.ERF=function(e,t){return t=void 0===t?0:t,e=o.parseNumber(e),t=o.parseNumber(t),o.anyIsError(e,t)?n.value:i.erf(e)},t.ERF.PRECISE=function(e){return isNaN(e)?n.value:window.jsSpreadsheet.AllFormulas.ERF(e)},t.ERFC=function(e){return isNaN(e)?n.value:i.erfc(e)},t.ERFC.PRECISE=function(e){return isNaN(e)?n.value:window.jsSpreadsheet.AllFormulas.ERFC(e)},t.GESTEP=function(e,t){return t=t||0,e=o.parseNumber(e),o.anyIsError(t,e)?e:e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=10===e.length&&"f"===e.substring(0,1).toLowerCase(),i=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(i<-512||i>511)return n.num;if(r)return"1"+a.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);var o=i.toString(2);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?a.REPT("0",t-o.length)+o:n.num},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return n.num;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);var i=r.toString(8);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num},t.ROWS=function(e){return"string"==typeof e&&(e=o.strToMatrix(e)),e instanceof Array?0===e.length?0:i.rows(e):n.value},t.IMABS=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:Math.sqrt(Math.pow(r,2)+Math.pow(i,2))},t.IMAGINARY=function(e){if(void 0===(e=u(e))||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return t>=0||r>=0?a?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:-Number(e.substring(r+1,e.length-1)):n.num:a?isNaN(e.substring(0,e.length-1))?n.num:e.substring(0,e.length-1):isNaN(e)?n.num:0},t.IMARGUMENT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:0===r&&0===i?n.div0:0===r&&i>0?Math.PI/2:0===r&&i<0?-Math.PI/2:0===i&&r>0?0:0===i&&r<0?-Math.PI:r>0?Math.atan(i/r):r<0&&i>=0?Math.atan(i/r)+Math.PI:Math.atan(i/r)-Math.PI},t.IMCONJUGATE=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",0!==i?t.COMPLEX(r,-i,a):e},t.IMCOS=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(r)*(Math.exp(i)+Math.exp(-i))/2,-Math.sin(r)*(Math.exp(i)-Math.exp(-i))/2,a)},t.IMCOSH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(i)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(i)*(Math.exp(r)-Math.exp(-r))/2,a)},t.IMCOT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,r){var i=t.IMREAL(e),a=t.IMAGINARY(e),l=t.IMREAL(r),s=t.IMAGINARY(r);if(o.anyIsError(i,a,l,s))return n.value;var u=e.substring(e.length-1),c=r.substring(r.length-1),f="i";if("j"===u?f="j":"j"===c&&(f="j"),0===l&&0===s)return n.num;var h=l*l+s*s;return t.COMPLEX((i*l+a*s)/h,(a*l-i*s)/h,f)},t.IMEXP=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);a="i"===a||"j"===a?a:"i";var l=Math.exp(r);return t.COMPLEX(l*Math.cos(i),l*Math.sin(i),a)},t.IMLN=function(e){var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i)),Math.atan(i/r),a)},t.IMLOG10=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i))/Math.log(10),Math.atan(i/r)/Math.log(10),a)},t.IMLOG2=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+i*i))/Math.log(2),Math.atan(i/r)/Math.log(2),a)},t.IMPOWER=function(e,r){e=u(e),r=o.parseNumber(r);var i=t.IMREAL(e),a=t.IMAGINARY(e);if(o.anyIsError(r,i,a))return n.value;var l=e.substring(e.length-1);l="i"===l||"j"===l?l:"i";var s=Math.pow(t.IMABS(e),r),c=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(r*c),s*Math.sin(r*c),l)},t.IMPRODUCT=function(){for(var e=arguments[0],r=1;r<arguments.length;r++){var i=t.IMREAL(e),a=t.IMAGINARY(e),l=t.IMREAL(arguments[r]),s=t.IMAGINARY(arguments[r]);if(o.anyIsError(i,a,l,s))return n.value;e=t.COMPLEX(i*l-a*s,i*s+a*l)}return e},t.IMREAL=function(e){if(void 0===(e=u(e))||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var i=e.substring(e.length-1,e.length),a="i"===i||"j"===i;return t>=0||r>=0?a?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:Number(e.substring(0,r)):n.num:a?isNaN(e.substring(0,e.length-1))?n.num:0:isNaN(e)?n.num:e},t.IMSEC=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.sin(r)*(Math.exp(i)+Math.exp(-i))/2,Math.cos(r)*(Math.exp(i)-Math.exp(-i))/2,a)},t.IMSINH=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);return a="i"===a||"j"===a?a:"i",t.COMPLEX(Math.cos(i)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(i)*(Math.exp(r)+Math.exp(-r))/2,a)},t.IMSQRT=function(e){e=u(e);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(o.anyIsError(r,i))return n.value;var a=e.substring(e.length-1);a="i"===a||"j"===a?a:"i";var l=Math.sqrt(t.IMABS(e)),s=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(s/2),l*Math.sin(s/2),a)},t.IMCSC=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.num:t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.num:t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,r){e=u(e),r=u(r);var i=t.IMREAL(e),a=t.IMAGINARY(e),l=t.IMREAL(r),s=t.IMAGINARY(r);if(o.anyIsError(i,a,l,s))return n.value;var c=e.substring(e.length-1),f=r.substring(r.length-1),h="i";return"j"===c?h="j":"j"===f&&(h="j"),t.COMPLEX(i-l,a-s,h)},t.IMSUM=function(e){e=u(e);for(var r=o.flatten(arguments),i=r[0],a=1;a<r.length;a++){var l=t.IMREAL(i),s=t.IMAGINARY(i),c=t.IMREAL(r[a]),f=t.IMAGINARY(r[a]);if(o.anyIsError(l,s,c,f))return n.value;i=t.COMPLEX(l+c,s+f)}return i},t.IMTAN=function(e){if(!0===(e=u(e))||!1===e)return n.value;var r=t.IMREAL(e),i=t.IMAGINARY(e);return o.anyIsError(r,i)?n.value:t.IMDIV(t.IMSIN(e),t.IMCOS(e))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=10===e.length&&"7"===e.substring(0,1),i=r?parseInt(e,8)-1073741824:parseInt(e,8);if(r)return"1"+a.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);var o=i.toString(2);return o.length>=10?o.slice(o.length-10,o.length):void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?a.REPT("0",t-o.length)+o:n.num},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return n.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);var i=r.toString(16);return void 0===t?i:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=i.length?a.REPT("0",t-i.length)+i:n.num}},36:function(e,t,r){"use strict";e.exports=function(e,t,r){var n=t.findAllNeedCalcCell(),i={},a=[];for(var o in e.Sheets)for(var l=e.Sheets[o],s=0;s<n.length;s++){var u=n[s],c=i[o+"!"+u]={formula_ref:i,wb:e,sheet:l,sheet_name:o,cell:l[u],name:u,status:"new",exec_formula:r};a.push(c)}return a}},37:function(e,t,r){var n=r(3);t.trans_params=function(e){var t=new RegExp("{(.*?)}","g"),r=e.f.match(t);if(null!=r)for(var n=0;n<r.length;n++){var i=r[n],a="'"+i+"'";e.f=e.f.replace(i,a)}return e},t.trans_sheet=function(e){return Object.keys(e).forEach((function(t){0===e[t].v&&""===e[t].f&&(e[t].v="default_0")})),e},t.recover_sheet=function(e){return Object.keys(e).forEach((function(t){"default_0"===e[t].v&&(n.isHave(e[t].f)||(e[t].f=""),e[t].v=0)})),e},t.strim=function(e){return e.replace(/\s+$/,"").replace(/^\s+/,"")},t.trans_formula=function(e){var t={FLOOR:"FLOORMATH",VAR:"VARA","WORKDAY.INTL":"WORKDAYINTL"};for(var r in t){var n=t[r];e.indexOf(n)<0&&e.indexOf(r)>=0&&e.indexOf(r+".")<=0&&(e=e.replace(r,n))}e=e.replace("_XLFN.","");var i=new RegExp('"(.*?)"',"g"),a=e.match(i);if(0===e.indexOf("=")&&(e=e.toUpperCase(),null!=a))for(r=0;r<a.length;r++){var o=a[r].toUpperCase();e.indexOf(o)>=0&&(e=e.replace(o,a[r]))}return e}},8:function(e,t){t.nil=new Error("#NULL!"),t.div0=new Error("#DIV/0!"),t.value=new Error("#VALUE?"),t.ref=new Error("#REF!"),t.name=new Error("#NAME?"),t.num=new Error("#NUM!"),t.na=new Error("#N/A"),t.error=new Error("#ERROR!"),t.data=new Error("#GETTING_DATA")}});
//# sourceMappingURL=xspreadsheet.js.map