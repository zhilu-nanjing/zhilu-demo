!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=91)}([function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.Element=void 0;var a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t?(this.el=document.createElement(t),this.el.className=r):this.el=t,this.data={}}var t,r,a;return t=e,(r=[{key:"data",value:function(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}},{key:"on",value:function(e,t){var r=n(e.split(".")),i=r[0],a=r.slice(1),o=i;return"mousewheel"===o&&/Firefox/i.test(window.navigator.userAgent)&&(o="DOMMouseScroll"),this.el.addEventListener(o,(function(e){t(e);for(var r=0;r<a.length;r+=1){var n=a[r];if("left"===n&&0!==e.button)return;if("right"===n&&2!==e.button)return;"stop"===n&&e.stopPropagation()}})),this}},{key:"offset",value:function(e){var t=this;if(void 0!==e)return Object.keys(e).forEach((function(r){t.css(r,"".concat(e[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(e){var t=this.el;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new e(this.el.parentNode)}},{key:"children",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(t){return e.child(t)})),this)}},{key:"child",value:function(t){var r=t;return"string"==typeof t?r=document.createTextNode(t):t instanceof e&&(r=t.el),this.el.appendChild(r),this}},{key:"contains",value:function(e){return this.el.contains(e)}},{key:"className",value:function(e){return void 0!==e?(this.el.className=e,this):this.el.className}},{key:"addClass",value:function(e){return this.el.classList.add(e),this}},{key:"hasClass",value:function(e){return this.el.classList.contains(e)}},{key:"removeClass",value:function(e){return this.el.classList.remove(e),this}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(e)}},{key:"toggleClass",value:function(e){return this.el.classList.toggle(e)}},{key:"active",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return e?this.addClass(t):this.removeClass(t),this}},{key:"checked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(e,"checked"),this}},{key:"disabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(e,t){var r=this;if(void 0!==t)this.el.setAttribute(e,t);else{if("string"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach((function(t){r.el.setAttribute(t,e[t])}))}return this}},{key:"removeAttr",value:function(e){return this.el.removeAttribute(e),this}},{key:"html",value:function(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}},{key:"val",value:function(e){return void 0!==e?(this.el.value=e,this):this.el.value}},{key:"cssRemoveKeys",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach((function(t){return e.el.style.removeProperty(t)})),this}},{key:"css",value:function(e,t){var r=this;return void 0===t&&"string"!=typeof e?(Object.keys(e).forEach((function(t){r.el.style[t]=e[t]})),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}},{key:"removeEl",value:function(){this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"isShow",value:function(){return"block"===this.el.style.display}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";return this.css(e,t),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"display",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";return this.css(e,t),this}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Element=a;t.h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new a(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.offsetTop=t.offsetLeft=t.filterFormula=t.look2=t.look=t.cssPrefix=void 0;t.cssPrefix="fin-cell";t.look=["*悬浮查看*","*HYPERLINK*","*MULTIPLECELLS*"];t.look2="#CHECK！";t.filterFormula=["CITY"];t.offsetLeft=60;t.offsetTop=70},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportError=function(e){return console.log(new Error(e)),new Error(e)},t.reportConvertFail=function(e){return{msg:"CONVERT_FAIL",instance:e}},t.errorObj=t.errorMsgArr=t.PARSE_FAIL_OBJ=t.PARSE_FAIL=t.ERROR_NON_SOLVED=t.ERROR_SYNTAX=t.ERROR_ERROR=t.ERROR_CIRCULAR=t.ERROR_DATE_STR=t.ERROR_GETTING_DATA=t.ERROR_NA=t.ERROR_NUM=t.ERROR_NAME=t.ERROR_REF=t.ERROR_VALUE=t.ERROR_DIV0=t.ERROR_NULL=void 0;t.ERROR_NULL="#NULL!";t.ERROR_DIV0="#DIV/0!";t.ERROR_VALUE="#VALUE!";t.ERROR_REF="#REF!";t.ERROR_NAME="#NAME?";t.ERROR_NUM="#NUM!";t.ERROR_NA="#N/A";t.ERROR_GETTING_DATA="#GETTING_DATA!";t.ERROR_DATE_STR="#DATE!";t.ERROR_CIRCULAR="#CIRCULA!";t.ERROR_ERROR="#ERROR!";t.ERROR_SYNTAX="#SYNTAX";t.ERROR_NON_SOLVED="NON_SOLVED";t.PARSE_FAIL="PARSE_FAIL";t.PARSE_FAIL_OBJ={msg:"PARSE_FAIL"};var n=["#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA!","#DATE!","#CIRCULA!","#ERROR!","#SYNTAX"];t.errorMsgArr=n;var i={ERROR_NULL:new Error("#NULL!"),ERROR_DIV0:new Error("#DIV/0!"),ERROR_VALUE:new Error("#VALUE!"),ERROR_REF:new Error("#REF!"),ERROR_NAME:new Error("#NAME?"),ERROR_NUM:new Error("#NUM!"),ERROR_NA:new Error("#N/A"),ERROR_GETTING_DATA:new Error("#GETTING_DATA!"),ERROR_DATE_STR:new Error("#DATE!"),ERROR_CIRCULAR:new Error("#CIRCULA!"),ERROR_ERROR:new Error("#ERROR!"),ERROR_SYNTAX:new Error("#SYNTAX"),ERROR_NON_SOLVED:new Error("NON_SOLVED")};t.errorObj=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AA=t.SHEET1AA=t.SHEET1A1A2=t.A1A2=t.BOOL=t.A1=t.SHEET1A1=t.CellVTypeObj=t.ABSOLUTE_MARK=t.ROW_NAME=t.COL_NAME=t.SHEET_NAME=t.SOLVE_FAIL_OBJ=t.VALUE_NAME=t.EXP_FN=t.USELESS=t.RANG_REF=t.SINGLE_REF=t.RAW_ARRAY=t.RAW_VALUE=t.CONTAINER=t.SPLIT_MARK=t.OPERATOR=t.NOT_CONVERT=t.EmptyMultiSheetObj=t.NOT_SUPPORT=t.SHAPE_DIFF=t.NOT_NUMBER=t.INVALID_MATRIX=t.TO_PARA_TYPE=t.E_PATTERN=t.CLEAN_FLOAT_PATTERN=t.FLOAT_WITH_COMMA_PATTERN=t.INT_WITH_COMMA_PATTERN=t.ALL_DIGIT_PATTERN_STR=t.d18991230STR=t.d18991230MS=t.d18991230=t.FORCE_STR_MARK=t.MONEY_UNIT_OBJ=t.PRE_DEFINED_CONST=t.SINGLE_CHAR_OPERATOR=t.MULTI_CHAR_OPERATOR=t.MARK_OBJ=t.FORMULA_STATUS=t.common_operations=t.MS_PER_DAY=void 0;t.MS_PER_DAY=864e5;t.common_operations={"*":"multiply","+":"plus","-":"subtractDays","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};t.FORMULA_STATUS={created:"created",working:"working",solved:"solved"};t.MARK_OBJ={percent:"%",star:"*",plus:"+",dash:"-",slash:"/",caret:"^",ampersand:"&",lessThen:"<",greaterThen:">",equal:"=",exclamation:"!",leftParentheses:"(",rightParentheses:")",comma:",",leftBracket:"[",rightBracket:"]",leftBrace:"{",rightBrace:"}",colon:":",hash:"#",at:"@",space:" ",doubleQue:'"'};t.MULTI_CHAR_OPERATOR={notEqual:"<>",greaterEqual:">=",lessEqual:"<="};t.SINGLE_CHAR_OPERATOR={percent:"%",minus:"-",star:"*",plus:"+",slash:"/",caret:"^",ampersand:"&",lessThen:"<",greaterThen:">",equal:"="};t.PRE_DEFINED_CONST={true:"TRUE",false:"FALSE"};t.MONEY_UNIT_OBJ={dollar:"$"};t.FORCE_STR_MARK="'";var n=new Date(1899,11,30);t.d18991230=n;t.d18991230MS=-22091904e5;t.d18991230STR="1899/12/30";t.ALL_DIGIT_PATTERN_STR="^\\d+$";t.INT_WITH_COMMA_PATTERN=/^0*[1-9]\d*(,\d{3})+$/;t.FLOAT_WITH_COMMA_PATTERN=/^0*[1-9]\d*(,\d{3})+(\.\d+)?$/;t.CLEAN_FLOAT_PATTERN=/^\d*(\.\d+)?$/;t.E_PATTERN=/[eE]/;t.TO_PARA_TYPE={date:"date",string:"string",number:"number"};t.INVALID_MATRIX="INVALID_MATRIX";t.NOT_NUMBER="NOT_NUMBER";t.SHAPE_DIFF="SHARPE_DIFF";t.NOT_SUPPORT="NOT_SUPPORT";t.EmptyMultiSheetObj={Sheet1:{A1:{f:""}}};t.NOT_CONVERT="NOT_CONVERT";t.OPERATOR="operator_single_func.js";t.SPLIT_MARK="split_mark";t.CONTAINER="container";t.RAW_VALUE="raw_value";t.RAW_ARRAY="raw_array";t.SINGLE_REF="single_ref";t.RANG_REF="range_ref";t.USELESS="useless";t.EXP_FN="exp_fn";t.VALUE_NAME="value_name";t.SOLVE_FAIL_OBJ={msg:"solve_fail"};t.SHEET_NAME="sheet_name";t.COL_NAME="col_name";t.ROW_NAME="row_name";t.ABSOLUTE_MARK="absolute_mark";t.CellVTypeObj={CellVDateTime:"CellVDateTime",CellVError:"CellVError",CellVEmpty:"CellVEmpty",CellVNumber:"CellVNumber",CellVString:"CellVString",CellVHyperLink:"CellVHyperLink",CellVBool:"CellVBool",CellVArray:"CellVArray"};t.SHEET1A1="sheet1!A1";t.A1="A1";t.BOOL="bool";t.A1A2="A1:A2";t.SHEET1A1A2="sheet1!A1:A2";t.SHEET1AA="sheet1!A:A";t.AA="A:A"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringAt=i,t.indexAt=a,t.expr2xy=o,t.xy2expr=s,t.getColNumFromA1=function(e){return parseInt(e.replace(/^[A-Z]+/,""))},t.default=void 0;var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function i(e){for(var t="",r=e;r>=n.length;)r/=n.length,r-=1,t+=n[parseInt(r,10)%n.length];var i=e%n.length;return t+=n[i]}function a(e){for(var t=0,r=0;r<e.length-1;r+=1){var i=e.charCodeAt(r)-65,a=e.length-1-r;t+=Math.pow(n.length,a)+n.length*i}return t+=e.charCodeAt(e.length-1)-65}function o(e){for(var t="",r="",n=0;n<e.length;n+=1)e.charAt(n)>="0"&&e.charAt(n)<="9"?r+=e.charAt(n):t+=e.charAt(n);return[a(t),parseInt(r,10)-1]}function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e*=1,t*=1,2===r?"".concat(i(e),"$").concat(t+1):1===r?"$".concat(i(e)).concat(t+1):"".concat(i(e)).concat(t+1)}var l={expr2xy:o,xy2expr:s};t.default=l},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=Object.prototype,o=a.toString,s=a.hasOwnProperty,l=function(){function e(){}return e.prototype.assert=function(e,t){if(!this.check(e,t)){var r=v(e);throw new Error(r+" does not match type "+this)}return!0},e.prototype.arrayOf=function(){return new u(this)},e}(),u=function(e){function t(t){var r=e.call(this)||this;return r.elemType=t,r.kind="ArrayType",r}return i(t,e),t.prototype.toString=function(){return"["+this.elemType+"]"},t.prototype.check=function(e,t){var r=this;return Array.isArray(e)&&e.every((function(e){return r.elemType.check(e,t)}))},t}(l),c=function(e){function t(t){var r=e.call(this)||this;return r.value=t,r.kind="IdentityType",r}return i(t,e),t.prototype.toString=function(){return String(this.value)},t.prototype.check=function(e,t){var r=e===this.value;return r||"function"!=typeof t||t(this,e),r},t}(l),f=function(e){function t(t){var r=e.call(this)||this;return r.fields=t,r.kind="ObjectType",r}return i(t,e),t.prototype.toString=function(){return"{ "+this.fields.join(", ")+" }"},t.prototype.check=function(e,t){return o.call(e)===o.call({})&&this.fields.every((function(r){return r.type.check(e[r.name],t)}))},t}(l),d=function(e){function t(t){var r=e.call(this)||this;return r.types=t,r.kind="OrType",r}return i(t,e),t.prototype.toString=function(){return this.types.join(" | ")},t.prototype.check=function(e,t){return this.types.some((function(r){return r.check(e,t)}))},t}(l),h=function(e){function t(t,r){var n=e.call(this)||this;return n.name=t,n.predicate=r,n.kind="PredicateType",n}return i(t,e),t.prototype.toString=function(){return this.name},t.prototype.check=function(e,t){var r=this.predicate(e,t);return r||"function"!=typeof t||t(this,e),r},t}(l),p=function(){function e(e,t){this.type=e,this.typeName=t,this.baseNames=[],this.ownFields=Object.create(null),this.allSupertypes=Object.create(null),this.supertypeList=[],this.allFields=Object.create(null),this.fieldNames=[],this.finalized=!1,this.buildable=!1,this.buildParams=[]}return e.prototype.isSupertypeOf=function(t){if(t instanceof e){if(!0!==this.finalized||!0!==t.finalized)throw new Error("");return s.call(t.allSupertypes,this.typeName)}throw new Error(t+" is not a Def")},e.prototype.checkAllFields=function(e,t){var r=this.allFields;if(!0!==this.finalized)throw new Error(""+this.typeName);return null!==e&&"object"==typeof e&&Object.keys(r).every((function(n){var i=r[n],a=i.type,o=i.getValue(e);return a.check(o,t)}))},e.prototype.bases=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.baseNames;if(this.finalized){if(e.length!==r.length)throw new Error("");for(var n=0;n<e.length;n++)if(e[n]!==r[n])throw new Error("");return this}return e.forEach((function(e){r.indexOf(e)<0&&r.push(e)})),this},e}();t.Def=p;var m=function(){function e(e,t,r,n){this.name=e,this.type=t,this.defaultFn=r,this.hidden=!!n}return e.prototype.toString=function(){return JSON.stringify(this.name)+": "+this.type},e.prototype.getValue=function(e){var t=e[this.name];return void 0!==t?t:("function"==typeof this.defaultFn&&(t=this.defaultFn.call(e)),t)},e}();function v(e){return Array.isArray(e)?"["+e.map(v).join(", ")+"]":e&&"object"==typeof e?"{ "+Object.keys(e).map((function(t){return t+": "+e[t]})).join(", ")+" }":JSON.stringify(e)}t.default=function(e){var t={or:function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new d(e.map((function(e){return t.from(e)})))},from:function(e,i){if(e instanceof u||e instanceof c||e instanceof f||e instanceof d||e instanceof h)return e;if(e instanceof p)return e.type;if(g.check(e)){if(1!==e.length)throw new Error("only one element type is permitted for typed arrays");return new u(t.from(e[0]))}if(E.check(e))return new f(Object.keys(e).map((function(r){return new m(r,t.from(e[r],r))})));if("function"==typeof e){var a=r.indexOf(e);if(a>=0)return n[a];if("string"!=typeof i)throw new Error("missing name");return new h(i,e)}return new c(e)},def:function(e){return s.call(x,e)?x[e]:x[e]=new S(e)},hasDef:function(e){return s.call(x,e)}},r=[],n=[],a={};function l(e,t){var i=o.call(e),s=new h(t,(function(e){return o.call(e)===i}));return a[t]=s,e&&"function"==typeof e.constructor&&(r.push(e.constructor),n.push(s)),s}l("truthy","string");var y=l((function(){}),"function"),g=l([],"array"),E=l({},"object"),b=(l(/./,"RegExp"),l(new Date,"Date"),l(3,"number"),l(!0,"boolean"),l(null,"null"),l(void 0,"undefined")),x=Object.create(null);function A(e){if(e&&"object"==typeof e){var t=e.type;if("string"==typeof t&&s.call(x,t)){var r=x[t];if(r.finalized)return r}}return null}var S=function(e){function r(t){var r=e.call(this,new h(t,(function(e,t){return r.check(e,t)})),t)||this;return r}return i(r,e),r.prototype.check=function(e,t){if(!0!==this.finalized)throw new Error("prematurely checking unfinalized type "+this.typeName);if(null===e||"object"!=typeof e)return!1;var r=A(e);return r?t&&r===this?this.checkAllFields(e,t):!!this.isSupertypeOf(r)&&(!t||r.checkAllFields(e,t)&&this.checkAllFields(e,!1)):("SourceLocation"===this.typeName||"Position"===this.typeName)&&this.checkAllFields(e,t)},r.prototype.build=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.buildParams=t,this.buildable)return this;this.field("type",String,(function(){return e.typeName})),this.buildable=!0;var n=function(t,r,n,i){if(!s.call(t,r)){var a=e.allFields;if(!s.call(a,r))throw new Error(""+r);var o,l=a[r],u=l.type;if(i)o=n;else{if(!l.defaultFn){var c="no value or default function given for field "+JSON.stringify(r)+" of "+e.typeName+"("+e.buildParams.map((function(e){return a[e]})).join(", ")+")";throw new Error(c)}o=l.defaultFn.call(t)}if(!u.check(o))throw new Error(v(o)+" does not match field "+l+" of type "+e.typeName);t[r]=o}},i=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t.length;if(!e.finalized)throw new Error("attempting to instantiate unfinalized type "+e.typeName);var a=Object.create(R);if(e.buildParams.forEach((function(e,r){r<i?n(a,e,t[r],!0):n(a,e,null,!1)})),Object.keys(e.allFields).forEach((function(e){n(a,e,null,!1)})),a.type!==e.typeName)throw new Error("");return a};return i.from=function(t){if(!e.finalized)throw new Error("attempting to instantiate unfinalized type "+e.typeName);var r=Object.create(R);if(Object.keys(e.allFields).forEach((function(e){s.call(t,e)?n(r,e,t[e],!0):n(r,e,null,!1)})),r.type!==e.typeName)throw new Error("");return r},Object.defineProperty(w,C(this.typeName),{enumerable:!0,value:i}),this},r.prototype.field=function(e,r,n,i){return this.finalized?(console.error("Ignoring attempt to redefine field "+JSON.stringify(e)+" of finalized type "+JSON.stringify(this.typeName)),this):(this.ownFields[e]=new m(e,t.from(r),n,i),this)},r.prototype.finalize=function(){var e=this;if(!this.finalized){var t=this.allFields,r=this.allSupertypes;for(var n in this.baseNames.forEach((function(n){var i=x[n];if(!(i instanceof p)){var a="unknown supertype name "+JSON.stringify(n)+" for subtype "+JSON.stringify(e.typeName);throw new Error(a)}i.finalize(),N(t,i.allFields),N(r,i.allSupertypes)})),N(t,this.ownFields),r[this.typeName]=this,this.fieldNames.length=0,t)s.call(t,n)&&!t[n].hidden&&this.fieldNames.push(n);Object.defineProperty(O,this.typeName,{enumerable:!0,value:this.type}),this.finalized=!0,function(e,t){t.length=0,t.push(e);for(var r=Object.create(null),n=0;n<t.length;++n){e=t[n];var i=x[e];if(!0!==i.finalized)throw new Error("");s.call(r,e)&&delete t[r[e]],r[e]=n,t.push.apply(t,i.baseNames)}for(var a=0,o=a,l=t.length;o<l;++o)s.call(t,o)&&(t[a++]=t[o]);t.length=a}(this.typeName,this.supertypeList),this.buildable&&this.supertypeList.lastIndexOf("Expression")>=0&&function(e){var t=T(e);if(w[t])return;var r=w[C(e)];if(!r)return;var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return w.expressionStatement(r.apply(w,e))};n.from=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return w.expressionStatement(r.from.apply(w,e))},w[t]=n}(this.typeName)}},r}(p),w=Object.create(null),R={};function C(e){return e.replace(/^[A-Z]+/,(function(e){var t=e.length;switch(t){case 0:return"";case 1:return e.toLowerCase();default:return e.slice(0,t-1).toLowerCase()+e.charAt(t-1)}}))}function T(e){return(e=C(e)).replace(/(Expression)?$/,"Statement")}var O={};function _(e){var t=A(e);if(t)return t.fieldNames.slice(0);if("type"in e)throw new Error("did not recognize object of type "+JSON.stringify(e.type));return Object.keys(e)}function D(e,t){var r=A(e);if(r){var n=r.allFields[t];if(n)return n.getValue(e)}return e&&e[t]}function N(e,t){return Object.keys(t).forEach((function(r){e[r]=t[r]})),e}return{Type:t,builtInTypes:a,getSupertypeNames:function(e){if(!s.call(x,e))throw new Error("");var t=x[e];if(!0!==t.finalized)throw new Error("");return t.supertypeList.slice(1)},computeSupertypeLookupTable:function(e){for(var t={},r=Object.keys(x),n=r.length,i=0;i<n;++i){var a=r[i],o=x[a];if(!0!==o.finalized)throw new Error(""+a);for(var l=0;l<o.supertypeList.length;++l){var u=o.supertypeList[l];if(s.call(e,u)){t[a]=u;break}}}return t},builders:w,defineMethod:function(e,t){var r=R[e];return b.check(t)?delete R[e]:(y.assert(t),Object.defineProperty(R,e,{enumerable:!0,configurable:!0,value:t})),r},getBuilderName:C,getStatementBuilderName:T,namedTypes:O,getFieldNames:_,getFieldValue:D,eachField:function(e,t,r){_(e).forEach((function(r){t.call(this,r,D(e,r))}),r)},someField:function(e,t,r){return _(e).some((function(r){return t.call(this,r,D(e,r))}),r)},finalize:function(){Object.keys(x).forEach((function(e){x[e].finalize()}))}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellRange=t.default=void 0;var n=r(4);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sri=t,this.sci=r,this.eri=n,this.eci=i,this.w=a,this.h=o}var t,r,o;return t=e,o=[{key:"valueOf",value:function(t){var r=t.split(":"),a=i((0,n.expr2xy)(r[0]),2),o=a[0],s=a[1],l=s,u=o;if(r.length>1){var c=i((0,n.expr2xy)(r[1]),2);u=c[0],l=c[1]}return new e(s,o,l,u)}}],(r=[{key:"set",value:function(e,t,r,n){this.sri=e,this.sci=t,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var e=0,t=0,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];if(1===a.length){var s=(0,n.expr2xy)(a[0]),l=i(s,2);t=l[0],e=l[1]}else 2===a.length&&(e=a[0],t=a[1]);var u=this.sri,c=this.sci,f=this.eri,d=this.eci;return u<=e&&e<=f&&c<=t&&t<=d}},{key:"each",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,i=this.eri,a=this.eci,o=r;o<=i;o+=1)if(t(o))for(var s=n;s<=a;s+=1)e(o,s)}},{key:"getType",value:function(){var e=this.sri,t=this.sci,r=this.eri,n=this.eci;return e===r&&t!==n?1:e!==r&&t===n?2:e!==r&&t!==n?3:e===r&&t===n?1:(console.error("未知情况"),4)}},{key:"move",value:function(e,t){var r=this.eri-this.sri,n=this.eci-this.sci;this.sri=e,this.sci=t,this.eri=this.sri+r,this.eci=this.sci+n}},{key:"move2",value:function(e,t,r,n){this.sri=e,this.sci=t,this.eri=r,this.eci=n}},{key:"contains",value:function(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}},{key:"within",value:function(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}},{key:"disjoint",value:function(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}},{key:"intersects",value:function(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}},{key:"getMovePos",value:function(e,t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci,o=0;return e>i&&t>a?o=1:e>i&&t<n?o=7:e<r&&t>a?o=8:t<n&&e<r?o=4:e>i?o=2:t>a?o=3:t<n?o=5:e<r&&(o=6),o}},{key:"union",value:function(t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci;return new e(t.sri<r?t.sri:r,t.sci<n?t.sci:n,t.eri>i?t.eri:i,t.eci>a?t.eci:a)}},{key:"difference",value:function(t){var r=[],n=function(t,n,i,a){r.push(new e(t,n,i,a))},i=this.sri,a=this.sci,o=this.eri,s=this.eci,l=t.sri-i,u=t.sci-a,c=o-t.eri,f=s-t.eci;return l>0?(n(i,a,t.sri-1,s),c>0?(n(t.eri+1,a,o,s),u>0&&n(t.sri,a,t.eri,t.sci-1),f>0&&n(t.sri,t.eci+1,t.eri,s)):(u>0&&n(t.sri,a,o,t.sci-1),f>0&&n(t.sri,t.eci+1,o,s))):c>0&&(n(t.eri+1,a,o,s),u>0&&n(i,a,t.eri,t.sci-1),f>0&&n(i,t.eci+1,t.eri,s)),u>0?(n(i,a,o,t.sci-1),f>0?(n(i,t.eri+1,o,s),l>0&&n(i,t.sci,t.sri-1,t.eci),c>0&&n(t.sri+1,t.sci,o,t.eci)):(l>0&&n(i,t.sci,t.sri-1,s),c>0&&n(t.sri+1,t.sci,o,s))):f>0&&(n(o,t.eci+1,o,s),l>0&&n(i,a,t.sri-1,t.eci),c>0&&n(t.eri+1,a,o,t.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var e=this.sri,t=this.sci,r=this.eri,i=this.eci,a=(0,n.xy2expr)(t,e);return this.multiple()&&(a="".concat(a,":").concat((0,n.xy2expr)(i,r))),a}},{key:"includeByRiCi",value:function(e,t){var r=this.sri,n=this.sci,i=this.eri,a=this.eci;return r<=e&&i>=e&&n<=t&&a>=t}},{key:"clone",value:function(){return new e(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"getLocationArray",value:function(e){var t=[],r=0;return this.each((function(n,i){t.push({ri:n,ci:i,v:e[r%e.length].tmp,type:e[r%e.length].type}),r+=1})),t}},{key:"equals",value:function(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}}])&&a(t.prototype,r),o&&a(t,o),e}();t.CellRange=t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLegal=function(e){var t=function(e){return"("===e||"["===e||"{"===e||"/*"===e?0:")"===e||"]"===e||"}"===e||"*/"===e?1:2},r=[];if(null!==e||""!==e||void 0!==e){for(var n=0;n<e.length;n++){var i=e.charAt(n);if(0===t(i))r.push(i);else if(!(1!==t(i)||0!==r.length&&(a=r.pop(),o=i,"("===a&&")"===o||"{"===a&&"}"===o||"["===a&&"]"===o||"/*"===a&&"*/"===o)))return!1}return 0===r.length}var a,o},t.distinct=function(e){return function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(new Set(e))},t.changeFormula=function(e){for(var t=0;t<e.length;t++){var r=e[t];-1===r.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)&&(e[t]="".concat(r,":").concat(r))}return e},t.deepCopy=function e(t){var r=Array.isArray(t)?[]:{};for(var n in t)t.hasOwnProperty(n)&&("object"===i(t[n])&&null!==t[n]?r[n]=e(t[n]):r[n]=t[n]);return r},t.positionAngle=t.cuttingByPos2=t.cuttingByPosEnd2=t.isSheetVale=t.splitStr=t.value2absolute=t.cuttingByPosEnd=t.operation3=t.cutFirst=t.cuttingByPos=t.isAbsoluteValue=t.cutting2=t.cutting=t.cutStr=t.operation=t.operator=void 0;var n=r(22);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=["+","-","*","/","&","^","(",",","="," "," ","，"];t.operator=a;var o=["+","-","*","/","&","^","(",",","="," ","，"],s=["+","-","*","/","&","^","(",",","=",")","，"],l=function(e){for(var t=0;t<a.length;t++)if(a[t]===e)return 1;return 0};t.operation=l;var u=function(e){for(var t=0;t<a.length;t++)if(o[t]===e)return 1;return 0};t.operation3=u;var c=function(e){for(var t=0;t<s.length;t++)if(s[t]===e)return 1;return 0};t.value2absolute=function(e){for(var t="",r=!1,n=0;n<e.length;n++)!1===r&&1*e[n]>=0&&1*e[n]<=9&&(t+="$",r=!0),t+=e[n];return{s1:t,s2:"$"+e,s3:"$"+t}};t.cutStr=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("="!==(e=(e+="").toUpperCase())[0])return[];for(var i=e.split((0,n.str2Re)(n.logicOperator)),a=0;a<i.length;a++)i[a]=i[a].replace((0,n.str2Re)(n.blankOperator),"");var o=[],s=0;return i.filter((function(e){var a=!0;i.length>s+1&&(-1!==i[s+1].indexOf("(")&&(a=!1));if(r&&a)-1===(e=e.replace(/\$/g,"")).search((0,n.str2Re)(n.letterOperator))&&-1===e.search((0,n.str2Re)(n.letterAndLetterOperator))||-1===o.indexOf(e)&&o.push(e);else if(a){if(-1!==e.search((0,n.str2Re)(n.letterOperator))||-1!==e.search((0,n.str2Re)(n.letterOperatorWithDollor))||-1!==e.search((0,n.str2Re)(n.letterOperatorWithDollorEnd))||-1!==e.search((0,n.str2Re)(n.letterOperatorWithDollorPrex)))-1!==o.indexOf(e)&&!0!==t||o.push(e);else-1!==e.replace(/\$/g,"").search((0,n.str2Re)(n.letterAndLetterOperator))&&o.push(e)}s+=1})),o};t.cutFirst=function(e){for(var t="",r=0;r<e.length;r++){if(c(e[r]))return t;t+=e[r]}return t};t.cuttingByPos=function(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="",i=!1,a=t-1;a>0&&!1===i;a--)!1===(i=!1===r?1===u(e[a]):1===l(e[a]))&&(n+=e[a]);return r&&(n=n.replace(/\s/g,"")),(n=n.split("").reverse().join("")).toUpperCase()};t.cuttingByPos2=function(e,t){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n="",i=!1,a=t-1;a>0&&!1===i;a--)!1===(i=!1===r?1===u(e[a]):1===l(e[a]))&&(n+=e[a]);return r&&(n=n.replace(/\s/g,"")),n=n.split("").reverse().join("")};t.cuttingByPosEnd=function(e,t){for(var r="",n=!1,i=t-1;i<e.length&&!1===n;i++)!1===(n=1===l(e[i]))&&")"!==e[i]&&(r+=e[i]);return r.toUpperCase()};t.cuttingByPosEnd2=function(e,t){for(var r="",n=t-1;n<e.length;n++)r+=e[n];return r};t.cutting=function(e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t};t.isSheetVale=function(e){return-1!==(e=e.toUpperCase()).search(/[\u4E00-\u9FA50-9a-zA-Z]+![A-Za-z]+\$\d+/)||(-1!==e.search(/[\u4E00-\u9FA50-9a-zA-Z]+!\$[A-Za-z]+\d+/)||(-1!==e.search(/[\u4E00-\u9FA50-9a-zA-Z]+!\$[A-Za-z]+\$\d+/)||-1!==e.search(/[\u4E00-\u9FA50-9a-zA-Z]+![A-Za-z]+\d+/)))};t.positionAngle=function(e,t,r,n){var i,a,o,s,l=0,u=Math.abs((o=(a={x:t,y:n}).x-(i={x:e,y:r}).x,s=a.y-i.y,360*Math.atan(s/o)/(2*Math.PI)));return e<t&&r<n?l=1:e>t&&r<n?l=2:e<t&&r>n?l=3:e>t&&r>n&&(l=4),1===l&&u<45?l=3:2===l&&u>30?l=1:3===l&&u>30?l=4:4===l&&u<45?l=2:l};t.isAbsoluteValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.toUpperCase(),1===t?-1!==e.search(/^\$[A-Z]+\$\d+$/)?3:-1!==e.search(/^\$[A-Z]+\d+$/)?1:-1!==e.search(/^[A-Z]+\$\d+$/)&&2:3===t?-1!==e.search(/^\$[A-Z]+\$\d+$/)||(-1!==e.search(/^[A-Z]+\d+$/)||(-1!==e.search(/^\$[A-Z]+\d+$/)||-1!==e.search(/^[A-Z]+\$\d+$/))):4!==t?5===t?-1!==e.search(/^[A-Z]+\d+:\$[A-Z]+\d+$/)?8:-1!==e.search(/^[A-Z]+\d+:[A-Z]+\$\d+$/)?9:-1!==e.search(/^[A-Z]+\$\d+:[A-Z]+\d+$/)?10:-1!==e.search(/^\$[A-Z]+\d+:[A-Z]+\d+$/)?11:-1!==e.search(/^\$[A-Z]+\$\d+$/)?3:-1!==e.search(/^[A-Z]+\d+$/)?12:-1!==e.search(/^[A-Z]+\d+:[A-Z]+\d+$/)?13:-1!==e.search(/^\$[A-Z]+\d+$/)?1:-1!==e.search(/^[A-Z]+\$\d+$/)?2:-1!==e.search(/^[A-Z]+\$\d+:[A-Z]+\$\d+$/)?4:-1!==e.search(/^[A-Z]+\$\d+:\$[A-Z]+\d+$/)?5:-1!==e.search(/^\$[A-Z]+\d+:[A-Z]+\$\d+$/)?6:-1!==e.search(/^\$[A-Z]+\d+:\$[A-Z]+\d+$/)&&7:6===t?-1!==(e=e.replace(/\$/g,"")).search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/):-1!==e.search(/^[A-Za-z]+\d+$/)||-1!==e.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/):-1!==e.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)||void 0};t.splitStr=function(e){for(var t=e.split(/([(-\/,+，*\s=^&])/),r=[],n=0;n<t.length;n++){var i=1;if(t.length>n+1){var a=t[n+1];"("===t[n]?i=3:-1!==a.indexOf("(")&&(i=2)}3!==i&&(2===i?r.push(t[n]+"("):r.push(t[n]))}return r};t.cutting2=function(e){for(var t=e.split(/([(-\/,+，*\s=^&])/),r=0,n=[],i=0;i<t.length;i++)t[i]&&n.push(t[i]);for(var a=[],o=0;o<n.length;o++){var s=n[o].toUpperCase(),l=!0;if(n.length>o+1)-1!==n[o+1].indexOf("(")&&(l=!1);if(-1===s.search(/^[A-Z]+\d+$/)&&-1===s.search(/^\$[A-Z]+\$\d+$/)&&-1===s.search(/^[A-Z]+\$\d+$/)&&-1===s.search(/^\$[A-Z]+\d+$/)&&-1===s.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)||!l){if(-1!==s.replace(/\$/g,"").search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)&&l){for(var u=0;u<n[o].length;u++)a.push({code:r,data:n[o][u]});r+=1}else for(var c=0;c<n[o].length;c++)a.push({code:-1,data:n[o][c]})}else{for(var f=0;f<n[o].length;f++)a.push({code:r,data:n[o][f]});r+=1}}return a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bind=i,t.remove=function(){for(var e=0;e<n.length;e++){var t=n[e];a(t.target,t.name,t.fn)}},t.unbind=a,t.unbindClickoutside=o,t.createEvent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keydown",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=document.createEvent("HTMLEvents");i.initEvent(r,!0,!0),i.eventType="message",i.buttons=n,i.keyCode=e,i.metaKey=t,document.dispatchEvent(i)},t.bindClickoutside=function(e,t){e.xclickoutside=function(r){2===r.detail||e.contains(r.target)||(t?t(e):(e.hide(),o(e)))},i(window.document.body,"click",e.xclickoutside)},t.mouseMoveUp=function(e,t,r){i(e,"mousemove",t),e.xEvtUp=function(n){a(e,"mousemove",t),a(e,"mouseup",e.xEvtUp),r(n)},i(e,"mouseup",e.xEvtUp)},t.bindTouch=function(e,t){var r=t.move,n=t.end,a=0,o=0;i(e,"touchstart",(function(e){var t=e.touches[0],r=t.pageX,n=t.pageY;a=r,o=n})),i(e,"touchmove",(function(e){if(r){var t=e.changedTouches[0],n=t.pageX,i=t.pageY,l=n-a,u=i-o;(Math.abs(l)>10||Math.abs(u)>10)&&(s(l,u,e,r),a=n,o=i),e.preventDefault()}})),i(e,"touchend",(function(e){if(n){var t=e.changedTouches[0],r=t.pageX,i=t.pageY;s(r-a,i-o,e,n)}}))};var n=[];function i(e,t,r){e.addEventListener(t,r),n.push({name:t,fn:r,target:e})}function a(e,t,r){e.removeEventListener(t,r)}function o(e){e.xclickoutside&&(a(window.document.body,"click",e.xclickoutside),delete e.xclickoutside)}function s(e,t,r,n){Math.abs(e)>Math.abs(t)?n(e>0?"right":"left",e,r):n(t>0?"down":"up",t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHave=function(e){if(void 0===e)return!1;if(null===e)return!1;return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locale=function(e,t){a=e,t&&(o[e]=t)},t.t=l,t.tf=function(e){return function(){return l(e)}},t.default=void 0;var n,i=(n=r(153))&&n.__esModule?n:{default:n};var a="en",o={en:i.default};function s(e,t){if(t&&t[a])for(var r=t[a],n=e.split("."),i=0;i<n.length;i+=1){var o=r[n[i]];if(i===n.length-1)return o;if(!o)return;r=o}}function l(e){var t=s(e,o);return!t&&window&&window.x&&window.x.spreadsheet&&window.x.spreadsheet.$messages&&(t=s(e,window.x.spreadsheet.$messages)),t||""}var u={t:l};t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flatten=s,t.argsToArray=l,t.numbers=function(){return s.apply(null,arguments).filter((function(e){return"number"==typeof e}))},t.flattenNum=function(e){try{if(1===e.length&&"default_0"===e[0][0])return n.errorObj.ERROR_DIV0;for(var t=[],r=0;r<e.length;r++){var i=e[r];if(void 0===i)return n.errorObj.ERROR_NAME;if(i instanceof Error)return i;if("pass"!==i)if(i instanceof Array)for(var a=0;a<i.length;a++)t.push(i[a]);else t.push(i)}return t}catch(e){return n.errorObj.ERROR_NAME}},t.to1DArray=function(e){for(var t=[],r=[],n=0;n<e.length;n++)r.push(e[n]);return t=u(r),t=u(t)},t.cleanFloat=function(e){return Math.round(1e14*e)/1e14},t.Copy=function e(t){if(null==t||"object"!==a(t))return t;if(t instanceof Date){var r=new Date;return r.setTime(t.getTime()),r}if(t instanceof Array){for(var n=[],i=0;i<t.length;++i)n[i]=e(t[i]);return n}if(t instanceof Object){var o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=e(t[s]));return o}throw new Error("Unable to copy obj! Its type isn't supported.")},t.strToMatrix=function(e){for(var t=e.slice(2,e.length-2).split(","),r=[],n=[],a=0;a<t.length;a++){var o=t[a].toString();o.indexOf(";")>0?(n.push((0,i.str2int)(o.split(";")[0])),r.push(n),n=[(0,i.str2int)(o.split(";")[1])]):n.push((0,i.str2int)(o))}return r.push(n),r},t.anyIsError=function(){var e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){var t,r=e.length;for(;r--;)if("number"!=typeof(t=e[r]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=(0,i.parseNumber)(t);n instanceof Error?e[r]=0:e[r]=n}}else e[r]=0;else e[r]=1;return e},t.rest=function(e,t){if(t=t||1,!e||"function"!=typeof e.slice)return e;return e.slice(t)},t.initial=function(e,t){if(t=t||1,!e||"function"!=typeof e.slice)return e;return e.slice(0,e.length-t)},t.compareFloat=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;return Math.abs(e-t)<r},t.isArrayBeginWithOther=function(e,t){return t.every((function(t,r){return t===e[r]}))};var n=r(2),i=r(17);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function s(){for(var e,t=l.apply(null,arguments);!o(t);)t=(e=t)&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?e.concat(t):r?(e.push(t),e):n?[e].concat(t):[e,t]})):e;return t}function l(e){return Array.prototype.slice.call(e,0)}function u(e){var t=[];return e.map((function(e){e instanceof Array?e.map((function(e){return t.push(e)})):t.push(e)})),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=s(this,l(t).call(this,"div","".concat(i.cssPrefix,"-icon")))).iconNameEl=(0,n.h)("div","".concat(i.cssPrefix,"-icon-img ").concat(e)),r.child(r.iconNameEl),r}var r,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(a=[{key:"setName",value:function(e){this.iconNameEl.className("".concat(i.cssPrefix,"-icon-img ").concat(e))}}])&&o(r.prototype,a),c&&o(r,c),t}(n.Element);t.default=c},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5));t.default=function(e){var t=e.use(i.default),r=t.Type,n=t.builtInTypes,a=n.number,o=r.or(n.string,n.number,n.boolean,n.null,n.undefined);return{geq:function(e){return r.from((function(t){return a.check(t)&&t>=e}),a+" >= "+e)},defaults:{null:function(){return null},emptyArray:function(){return[]},false:function(){return!1},true:function(){return!0},undefined:function(){},"use strict":function(){return"use strict"}},isPrimitive:r.from((function(e){if(null===e)return!0;var t=typeof e;return"object"!==t&&"function"!==t}),o.toString())}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(8),a=r(1);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e,r,i,o,s){var c,f,d=s.type,h=s.change,p=s.arrowChange,m=s.historyBorder;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(f=l(this,u(t).call(this,"div","".concat(a.cssPrefix,"-dropdown ").concat(o)))).title=e,f.change=function(){},"string"==typeof e?f.title=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-title")).child(e):i&&f.title.addClass("arrow-left");for(var v=arguments.length,y=new Array(v>5?v-5:0),g=5;g<v;g++)y[g-5]=arguments[g];return f.contentEl=(c=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-content"))).children.apply(c,y).css("width",r).hide(),d?(f.headerEl=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-header")).on("click",h),f.headerEl.children(f.title,i?(0,n.h)("div","".concat(a.cssPrefix,"-icon arrow-right_d")).child((0,n.h)("div","".concat(a.cssPrefix,"-icon-img arrow-down")).on("click.stop",(function(e){p(m),"block"!==f.contentEl.css("display")?f.show():f.hide()}))):""),f.children(f.headerEl,f.contentEl)):(f.headerEl=(0,n.h)("div","".concat(a.cssPrefix,"-dropdown-header")),f.headerEl.on("click",(function(){"block"!==f.contentEl.css("display")?f.show():f.hide()})).children(f.title,i?(0,n.h)("div","".concat(a.cssPrefix,"-icon arrow-right")).child((0,n.h)("div","".concat(a.cssPrefix,"-icon-img arrow-down"))):""),f.children(f.headerEl,f.contentEl)),f}var r,o,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),r=t,(o=[{key:"setTitle",value:function(e){this.title.html(e),this.hide()}},{key:"show",value:function(){var e=this;this.contentEl.show(),this.parent().active(),(0,i.bindClickoutside)(this.parent(),(function(){e.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),(0,i.unbindClickoutside)(this.parent())}}])&&s(r.prototype,o),f&&s(r,f),t}(n.Element);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OnlyNumberExpFunction=t.NotConvertEmptyExpFunction=t.StringExpFunction=t.NotConvertExpFunction=t.AllowErrorExpFunction=t.BaseExpFunction=void 0;var n=r(3),i=r(2);function a(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}var p=function(){function e(t){f(this,e),this.isAllowErrorArg=this.getIsAllowErrorArg(),this.expFnArgConfig=this.getExpFnArgConfig(),this.user_function=t}return h(e,[{key:"getIsAllowErrorArg",value:function(){return!1}},{key:"getExpFnArgConfig",value:function(){}},{key:"expresionFunc",value:function(e){return this.user_function.apply(this,c(e))}},{key:"updateArgArray",value:function(e){var t,r,n=this,i=[],a=e.map((function(e){return"function"==typeof e.solveExpression?e.solveExpression():e})),o=this.errorArg;if(void 0===this.expFnArgConfig)i=a.map((function(e){return e instanceof Error==!0?(o=e,e):((r=n.defaultConvert(e))instanceof Error==!0&&(o=r),r)}));else{if(!(this.expFnArgConfig instanceof Array))throw new Error("expFnArgConfig");for(var s,l=0;l++;l<this.expFnArgConfig.length)t=a[l],s=this.expFnArgConfig[l],(r=this.convertCellValueType(s,t.cellVTypeName,t))instanceof Error==!0&&(o=r),i.push(r);for(;l++;l<e.length)i.push(e[l])}return this.errorArg=o,i}},{key:"convertCellValueType",value:function(e,t,r){var i;if(e===n.NOT_CONVERT)return r;if("object"===u(e))i=e[r.cellVTypeName];else{if("string"!=typeof e)throw Error("arg_config has wrong type!");i=e}return i===n.TO_PARA_TYPE.date?r.toDate():i===n.TO_PARA_TYPE.number?r.toNumber():i===n.TO_PARA_TYPE.string?r.toString():r}},{key:"defaultConvert",value:function(e){return this.convertToStringAndNumber(e)}},{key:"convertToStringAndNumber",value:function(e){var t=this;return["string","number"].includes(u(e))?e:e instanceof Array?e.map((function(e){return t.convertToStringAndNumber(e)})):e.toNumberOrString()}},{key:"checkFuncArg",value:function(e){return null}},{key:"isError",value:function(){return void 0!==this.errorArg&&(this.errorArg instanceof Error||this.errorArg.cellVTypeName===n.CellVTypeObj.CellVError)}},{key:"solveExpression",value:function(e){var t=this.updateArgArray(e);return this.checkFuncArg(t),!1===this.isError(this.errorArg)||this.isAllowErrorArg?this.expresionFunc(t):this.errorArg}}]),e}();t.BaseExpFunction=p;var m=function(e){function t(){return f(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),h(t,[{key:"getIsAllowErrorArg",value:function(){return!0}}]),t}(p);t.AllowErrorExpFunction=m;var v=function(e){function t(){return f(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),h(t,[{key:"defaultConvert",value:function(e){return e}},{key:"getIsAllowErrorArg",value:function(){return!0}}]),t}(p);t.NotConvertExpFunction=v;var y=function(e){function t(){return f(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),h(t,[{key:"defaultConvert",value:function(e){return"number"==typeof e?String(e):"string"==typeof e?e:e.cellVTypeName===n.CellVTypeObj.CellVError?e:e.toString()}}]),t}(p);t.StringExpFunction=y;var g=function(e){function t(){return f(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),h(t,[{key:"defaultConvert",value:function(e){return e.cellVTypeName===n.CellVTypeObj.CellVEmpty?e:e.cellVTypeName===n.CellVTypeObj.CellVArray?e.convertToStringAndNumberExceptEmptyBool():this.convertToStringAndNumber(e)}}]),t}(p);t.NotConvertEmptyExpFunction=g;var E=function(e){function t(){return f(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),h(t,[{key:"checkFuncArg",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){"number"!=typeof a.value&&(this.errorArg=new Error(i.ERROR_VALUE))}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}}]),t}(p);t.OnlyNumberExpFunction=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneDeep=function(e){return JSON.parse(JSON.stringify(e))},t.find=function(e,t){for(var r=0;r<e.length;r++)if(-1!==t.indexOf(e[r]))return!0;return!1},t.isOusideViewRange=function(e,t,r,n,i){if(44===i&&r-e+100>0)return!0;if(11===i&&n-100<0)return!0;if(33===i&&n-t+100>0)return!0;if(22===i&&r-100<0)return!0;return!1},t.equals=function e(t,r){var n=Object.keys(t);if(n.length!==Object.keys(r).length)return!1;for(var i=0;i<n.length;i+=1){var a=n[i],o=t[a],s=r[a];if(void 0===s)return!1;if("string"==typeof o||"number"==typeof o||"boolean"==typeof o){if(o!==s)return!1}else if(Array.isArray(o)){if(o.length!==s.length)return!1;for(var l=0;l<o.length;l+=1)if(!e(o[l],s[l]))return!1}else if("function"!=typeof o&&!Array.isArray(o)&&o instanceof Object&&!e(o,s))return!1}return!0},t.isValueValid=function(e){if(void 0===e)return!1;if(null===e)return!1;return null!==e},t.rangeReduceIf=function(e,t,r,n,i,a){for(var o=r,s=n,l=e;l<t&&!(o>i);l+=1)s=a(l),o+=s;return[l,o-s,s]},t.rangeSum=function(e,t,r){for(var n=0,i=e;i<t;i+=1)n+=r(i);return n},t.isNumber=function(e){return"NaN"!==parseFloat(e).toString()},t.arrayEquals=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(e[r]!==t[r])return!1;return!0},t.merge=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,[{}].concat(t))},t.sum=t.mergeDeep=void 0;var n=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((function(r){null!=r&&Object.keys(r).forEach((function(n){var i=r[n];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?t[n]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(t[n]=t[n]||{},e(t[n],i)):t[n]=i}))})),t};t.mergeDeep=n;t.sum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},r=0,n=0;return Object.keys(e).forEach((function(i){r+=t(e[i],i),n+=1})),[r,n]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dayNum2Date=function(e){return new Date(i.d18991230MS+e*i.MS_PER_DAY)},t.days_str2date=a,t.parseBool=function(e){if(void 0===e)return!0;if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}if(e instanceof Date&&!isNaN(e))return!0;return n.errorObj.ERROR_VALUE},t.parseNumber=o,t.parseNumberArray=s,t.parseMatrix=function(e){var t;if(!e||0===e.length)return n.errorObj.ERROR_VALUE;for(var r=0;r<e.length;r++)if(t=s(e[r]),e[r]=t,t instanceof Error)return t;return e},t.parseDateArray=function(e){var t,r=e.length;for(;r--;){if((t=a(e[r]))===n.errorObj.ERROR_VALUE)return t;e[r]=t}return e},t.str2int=function(e){if(!isNaN(parseInt(e)))return parseInt(e);return e.replace('"',"").replace('"',"")},t.parse=function(e){if(e instanceof Error)return e;if(e instanceof Array){for(var t=[],r=0;r<e.length;r++)for(var i=0;i<e[0].length;i++){if("string"==typeof e[r][i]&&"default_0"!==e[r][i])return n.errorObj.ERROR_NAME;if("number"==typeof e[r][i]&&t.push(e[r][i]),e[r][i]instanceof Object)return n.errorObj.ERROR_NAME}return t}if("string"==typeof e)return"default_0"===e?"pass":n.errorObj.ERROR_NAME;if("number"==typeof e)return e};var n=r(2),i=r(3);function a(e){var t;if(!isNaN(e)){e instanceof Date&&(t=e);var r=parseInt(e,10);if(r<0)return n.errorObj.ERROR_NUM;t=new Date(i.d18991230MS+r*i.MS_PER_DAY)}return"string"==typeof e&&(t=new Date(e),isNaN(e)||(t=e)),t instanceof Date?t:n.errorObj.ERROR_VALUE}function o(e){return void 0===e||""===e?n.errorObj.ERROR_VALUE:isNaN(e)?n.errorObj.ERROR_VALUE:parseFloat(e)}function s(e){var t,r;if(!e||0===(t=e.length))return n.errorObj.ERROR_VALUE;for(;t--;){if((r=o(e[t]))===n.errorObj.ERROR_VALUE)return r;e[t]=r}return e}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(121)),a=n(r(44)),o=n(r(69)),s=n(r(23)),l=n(r(125)),u=n(r(70)),c=n(r(126)),f=n(r(127)),d=n(r(128)),h=n(r(129)),p=r(130);t.namedTypes=p.namedTypes;var m=i.default([a.default,o.default,s.default,l.default,u.default,c.default,f.default,d.default,h.default]),v=m.astNodesAreEquivalent,y=m.builders,g=m.builtInTypes,E=m.defineMethod,b=m.eachField,x=m.finalize,A=m.getBuilderName,S=m.getFieldNames,w=m.getFieldValue,R=m.getSupertypeNames,C=m.namedTypes,T=m.NodePath,O=m.Path,_=m.PathVisitor,D=m.someField,N=m.Type,k=m.use,M=m.visit;t.astNodesAreEquivalent=v,t.builders=y,t.builtInTypes=g,t.defineMethod=E,t.eachField=b,t.finalize=x,t.getBuilderName=A,t.getFieldNames=S,t.getFieldValue=w,t.getSupertypeNames=R,t.NodePath=T,t.Path=O,t.PathVisitor=_,t.someField=D,t.Type=N,t.use=k,t.visit=M,Object.assign(p.namedTypes,C)},function(e,t,r){"use strict";(function(t){var n=r(132);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}function a(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=r(133),s=Object.prototype.hasOwnProperty,l=Array.prototype.slice,u="foo"===function(){}.name;function c(e){return Object.prototype.toString.call(e)}function f(e){return!a(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var d=e.exports=g,h=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(o.isFunction(e)){if(u)return e.name;var t=e.toString().match(h);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function v(e){if(u||!o.isFunction(e))return o.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function y(e,t,r,n,i){throw new d.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function g(e,t){e||y(e,!0,t,"==",d.ok)}function E(e,t,r,n){if(e===t)return!0;if(a(e)&&a(t))return 0===i(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(f(e)&&f(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var s=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,r,n){if(null==e||null==t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=b(e),a=b(t);if(i&&!a||!i&&a)return!1;if(i)return e=l.call(e),t=l.call(t),E(e,t,r);var s,u,c=S(e),f=S(t);if(c.length!==f.length)return!1;for(c.sort(),f.sort(),u=c.length-1;u>=0;u--)if(c[u]!==f[u])return!1;for(u=c.length-1;u>=0;u--)if(s=c[u],!E(e[s],t[s],r,n))return!1;return!0}(e,t,r,n))}return r?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function x(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function A(e,t,r,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&y(i,r,"Missing expected exception"+n);var a="string"==typeof n,s=!e&&i&&!r;if((!e&&o.isError(i)&&a&&x(i,r)||s)&&y(i,r,"Got unwanted exception"+n),e&&i&&r&&!x(i,r)||!e&&i)throw i}d.AssertionError=function(e){var t;this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=m(v((t=this).actual),128)+" "+t.operator+" "+m(v(t.expected),128),this.generatedMessage=!0);var r=e.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var n=new Error;if(n.stack){var i=n.stack,a=p(r),o=i.indexOf("\n"+a);if(o>=0){var s=i.indexOf("\n",o+1);i=i.substring(s+1)}this.stack=i}}},o.inherits(d.AssertionError,Error),d.fail=y,d.ok=g,d.equal=function(e,t,r){e!=t&&y(e,t,r,"==",d.equal)},d.notEqual=function(e,t,r){e==t&&y(e,t,r,"!=",d.notEqual)},d.deepEqual=function(e,t,r){E(e,t,!1)||y(e,t,r,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(e,t,r){E(e,t,!0)||y(e,t,r,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(e,t,r){E(e,t,!1)&&y(e,t,r,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function e(t,r,n){E(t,r,!0)&&y(t,r,n,"notDeepStrictEqual",e)},d.strictEqual=function(e,t,r){e!==t&&y(e,t,r,"===",d.strictEqual)},d.notStrictEqual=function(e,t,r){e===t&&y(e,t,r,"!==",d.notStrictEqual)},d.throws=function(e,t,r){A(!0,e,t,r)},d.doesNotThrow=function(e,t,r){A(!1,e,t,r)},d.ifError=function(e){if(e)throw e},d.strict=n((function e(t,r){t||y(t,!0,r,"==",e)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var S=Object.keys||function(e){var t=[];for(var r in e)s.call(e,r)&&t.push(r);return t}}).call(this,r(56))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=i(r(18)).namedTypes,s=n(r(73)),l=s.default.SourceMapConsumer,u=s.default.SourceMapGenerator,c=Object.prototype.hasOwnProperty;function f(e,t){return e.line-t.line||e.column-t.column}function d(e){return{line:e.line,column:e.column}}function h(e,t){e&&t&&(f(t.start,e.start)<0&&(e.start=t.start),f(e.end,t.end)<0&&(e.end=t.end))}function p(e){if(e)switch(e.type){case"ExportDeclaration":case"ExportDefaultDeclaration":case"ExportDefaultSpecifier":case"DeclareExportDeclaration":case"ExportNamedDeclaration":case"ExportAllDeclaration":return!0}return!1}t.getOption=function(e,t,r){return e&&c.call(e,t)?e[t]:r},t.getUnionOfKeys=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=e.length,i=0;i<n;++i)for(var a=Object.keys(e[i]),o=a.length,s=0;s<o;++s)r[a[s]]=!0;return r},t.comparePos=f,t.copyPos=d,t.composeSourceMaps=function(e,t){if(!e)return t||null;if(!t)return e;var r=new l(e),n=new l(t),i=new u({file:t.file,sourceRoot:t.sourceRoot}),a={};return n.eachMapping((function(e){var t=r.originalPositionFor({line:e.originalLine,column:e.originalColumn}),n=t.source;if(null!==n){i.addMapping({source:n,original:d(t),generated:{line:e.generatedLine,column:e.generatedColumn},name:e.name});var o=r.sourceContentFor(n);o&&!c.call(a,n)&&(a[n]=o,i.setSourceContent(n,o))}})),i.toJSON()},t.getTrueLoc=function(e,t){if(!e.loc)return null;var r={start:e.loc.start,end:e.loc.end};function n(e){h(r,e.loc)}return e.declaration&&e.declaration.decorators&&p(e)&&e.declaration.decorators.forEach(n),f(r.start,r.end)<0&&(r.start=d(r.start),t.skipSpaces(r.start,!1,!0),f(r.start,r.end)<0&&(r.end=d(r.end),t.skipSpaces(r.end,!0,!0))),e.comments&&e.comments.forEach(n),r},t.fixFaultyLocations=function(e,t){if((n=e.loc)&&(n.start.line<1&&(n.start.line=1),n.end.line<1&&(n.end.line=1)),"File"===e.type&&(n.start=t.firstPos(),n.end=t.lastPos()),function(e,t){if("ForStatement"!==e.type)return;function r(e){for(var r=e&&e.loc,n=r&&r.start,i=r&&d(r.end);n&&i&&f(n,i)<0&&(t.prevPos(i),";"===t.charAt(i));)r.end.line=i.line,r.end.column=i.column}r(e.init),r(e.test),r(e.update)}(e,t),function(e,t){if("TemplateLiteral"!==e.type)return;if(0===e.quasis.length)return;if(e.loc){var r=d(e.loc.start);a.default.strictEqual(t.charAt(r),"`"),a.default.ok(t.nextPos(r));var n=e.quasis[0];f(n.loc.start,r)<0&&(n.loc.start=r);var i=d(e.loc.end);a.default.ok(t.prevPos(i)),a.default.strictEqual(t.charAt(i),"`");var o=e.quasis[e.quasis.length-1];f(i,o.loc.end)<0&&(o.loc.end=i)}e.expressions.forEach((function(r,n){var i=t.skipSpaces(r.loc.start,!0,!1);if(t.prevPos(i)&&"{"===t.charAt(i)&&t.prevPos(i)&&"$"===t.charAt(i)){var o=e.quasis[n];f(i,o.loc.end)<0&&(o.loc.end=i)}var s=t.skipSpaces(r.loc.end,!1,!1);if("}"===t.charAt(s)){a.default.ok(t.nextPos(s));var l=e.quasis[n+1];f(l.loc.start,s)<0&&(l.loc.start=s)}}))}(e,t),n&&e.decorators)e.decorators.forEach((function(e){h(n,e.loc)}));else if(e.declaration&&p(e)){e.declaration.loc=null;var r=e.declaration.decorators;r&&r.forEach((function(e){h(n,e.loc)}))}else if(o.MethodDefinition&&o.MethodDefinition.check(e)||o.Property.check(e)&&(e.method||e.shorthand))e.value.loc=null,o.FunctionExpression.check(e.value)&&(e.value.id=null);else if("ObjectTypeProperty"===e.type){var n,i=(n=e.loc)&&n.end;i&&(i=d(i),t.prevPos(i)&&","===t.charAt(i)&&(i=t.skipSpaces(i,!0,!0))&&(n.end=i))}},t.isExportDeclaration=p,t.getParentExportDeclaration=function(e){var t=e.getParentNode();return"declaration"===e.getName()&&p(t)?t:null},t.isTrailingCommaEnabled=function(e,t){var r=e.trailingComma;return"object"==typeof r?!!r[t]:!!r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToCellV=function(e){if(e instanceof Date)return new d(e);if("string"==typeof e)return new v(e);if(e instanceof Array)return new E(e);if("number"==typeof e&&!isNaN(e))return new m(e);if("boolean"==typeof e)return new g(e);if(e instanceof Error)return new h(e);if(e.cellVTypeName===n.CellVTypeObj.CellVEmpty)return new m(0);if(!0===e.isCellV)return e;(0,i.reportError)(i.ERROR_VALUE)},t.CellVArray=t.CellVBool=t.CellVHyperLink=t.CellVString=t.CellVNumber=t.CellVEmpty=t.CellVError=t.CellVDateTime=void 0;var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(r(3)),i=r(2),a=r(17),o=r(38);function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}var d=function(){function e(t){u(this,e),this.dateInstance=t,this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVDateTime}return f(e,[{key:"subtractOther",value:function(t){return console.assert(t instanceof e),this.toNumber()-t.toNumber()}},{key:"toString",value:function(){var e=this.dateInstance.getHours(),t=this.dateInstance.getMinutes(),r=this.dateInstance.getSeconds();if(this.toTotalSeconds(e,t,r)>5){var n=this.dateInstance.toLocaleDateString("Chinese")+" ".concat(e,":").concat(t);return r>.01&&(n+=":".concat(r)),n}return this.dateInstance.toLocaleDateString("Chinese")}},{key:"toNumber",value:function(){return(this.dateInstance.getTime()-n.d18991230MS)/n.MS_PER_DAY}},{key:"toDate",value:function(){return this.dateInstance}},{key:"toTotalSeconds",value:function(e,t,r){return 3600*e+60*t+r}},{key:"toNumberOrString",value:function(){return this.toNumber()}},{key:"getACopy",value:function(){return new p(this.dateInstance)}}]),e}();t.CellVDateTime=d;var h=function(){function e(t){u(this,e),this.err=t,this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVError}return f(e,[{key:"toNumber",value:function(){return this.err}},{key:"toString",value:function(){return this.err.message}},{key:"toDate",value:function(){return this.err}},{key:"toObject",value:function(){return{msg:this.err.message,isError:!0}}},{key:"toNumberOrString",value:function(){return this.toString()}}]),e}();t.CellVError=h;var p=function(){function e(){u(this,e),this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVEmpty}return f(e,[{key:"toString",value:function(){return""}},{key:"toNumber",value:function(){return 0}},{key:"toDate",value:function(){return new Date(n.d18991230STR)}},{key:"toNumberOrString",value:function(){return this.toNumber()}}]),e}();t.CellVEmpty=p;var m=function(){function e(t){u(this,e),this.number=t,this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVNumber}return f(e,[{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){return String(parseFloat(this.number.toPrecision(6)))}},{key:"toStringWithDecimal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this.number.toFixed(e)}},{key:"toDate",value:function(){return(0,a.dayNum2Date)(this.number)}},{key:"toNumberOrString",value:function(){return this.toNumber()}}]),e}();t.CellVNumber=m;var v=function(){function e(t){u(this,e),this.theString=t,this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVString}return f(e,[{key:"toNumber",value:function(){var e=parseFloat(this.theString);return isNaN(e)?i.PARSE_FAIL_OBJ:e}},{key:"toString",value:function(){return this.theString}},{key:"toDate",value:function(){var e=Date(this.theString);return isNaN(e.getTime())?i.PARSE_FAIL_OBJ:e}},{key:"toNumberOrString",value:function(){return this.toString()}}]),e}();t.CellVString=v;var y=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";u(this,e),this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVHyperLink,this.linkStr=t,this.showStr=""===r?t:r}return f(e,[{key:"toString",value:function(){return this.showStr}},{key:"toNumber",value:function(){var e=parseInt(this.showStr);return isNaN(e)?i.PARSE_FAIL_OBJ:e}},{key:"toDate",value:function(){var e=(0,a.dayNum2Date)(this.toNumber());return isNaN(e)?i.PARSE_FAIL_OBJ:e}},{key:"joinWithStr",value:function(e){this.showStr=this.showStr+e,this.linkStr=this.linkStr+e}},{key:"toNumberOrString",value:function(){return this.toString()}}]),e}();t.CellVHyperLink=y;var g=function(){function e(t){u(this,e),this.aBool=t,this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVBool}return f(e,[{key:"toNumber",value:function(){return this.aBool?1:0}},{key:"toString",value:function(){return this.aBool.toString().toUpperCase()}},{key:"toDate",value:function(){return(0,a.dayNum2Date)(this.toNumber())}},{key:"toNumberOrString",value:function(){return this.toNumber()}}]),e}();t.CellVBool=g;var E=function(){function e(t){if(u(this,e),t instanceof Array)this.aArray=this.to2DArray(t);else if(t instanceof o.MatrixValue||t instanceof e)this.aArray=t.aArray;else{if(!["number","string"].includes(l(t)))throw new Error(i.ERROR_VALUE);this.aArray=[[t]]}this.matrixValue=new o.MatrixValue(this.aArray),this.isCellV=!0,this.cellVTypeName=n.CellVTypeObj.CellVArray}return f(e,[{key:"to2DArray",value:function(e){if(void 0===e[0][0]){var t=[];return t.push(e),t}return e}},{key:"applyToAll",value:function(e){return this.aArray.map((function(t){return t instanceof Array?t.map(e):e(t)}))}},{key:"toNumber",value:function(){var e=this;return this.applyToAll((function(t){try{return t.toNumber()}catch(t){return(0,i.reportConvertFail)(e)}}))}},{key:"toString",value:function(){return this.applyToAll((function(e){return e.toString()}))}},{key:"toDate",value:function(){return this.applyToAll((function(e){return e.toDate()}))}},{key:"convertAValueToNumberOrString",value:function(e){return e.isCellV?e.toNumberOrString():"number"==typeof e||"string"==typeof e?e:new Error(i.ERROR_NA)}},{key:"toNumberOrString",value:function(){var e=this;return this.applyToAll((function(t){return e.convertAValueToNumberOrString(t)}))}},{key:"convertToStringAndNumberExceptEmpty",value:function(){var e=this;return this.applyToAll((function(t){return t.cellVTypeName===n.CellVTypeObj.CellVEmpty?t:e.convertAValueToNumberOrString(t)}))}},{key:"convertToStringAndNumberExceptEmptyBool",value:function(){var e=this;return this.applyToAll((function(t){return t.cellVTypeName===n.CellVTypeObj.CellVEmpty||t.cellVTypeName===n.CellVTypeObj.CellVBool?t:e.convertAValueToNumberOrString(t)}))}},{key:"exeElementOperator",value:function(e,t){return this.matrixValue.exeElementWiseOperator(e.matrixValue,t)}}]),e}();t.CellVArray=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.str2Re=function(e){return new RegExp(e,"g")},t.calendarPattern=t.datePattern2=t.datePattern=t.letterOperatorWithDollorPrex=t.letterOperatorWithDollorEnd=t.letterAndLetterOperator=t.letterOperatorWithDollor=t.letterOperatorIgnoreBracket=t.letterOperator=t.blankOperator=t.logicOperator=void 0;t.logicOperator="([(-\\/,+*，=^&])";t.blankOperator="(^\\s*)|(\\s*$)";t.letterOperator="^[A-Z]+\\d+$";t.letterOperatorIgnoreBracket="^[A-Z]+\\d+$";t.letterOperatorWithDollor="^\\$[A-Z]+\\$\\d+$";t.letterAndLetterOperator="^[A-Za-z]+\\d+:[A-Za-z]+\\d+$";t.letterOperatorWithDollorEnd="^[A-Z]+\\$\\d+$";t.letterOperatorWithDollorPrex="^\\$[A-Z]+\\d+$";t.datePattern=["^(\\d{4})[-/](\\d{1,2})[-/](\\d{1,2})$","^(\\d{4})年(\\d{1,2})月(\\d{1,2})日$"];t.datePattern2="((^((1[8-9]\\d{2})|([2-9]\\d{3}))([-\\/\\._])(10|12|0?[13578])([-\\/\\._])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\\d{2})|([2-9]\\d{3}))([-\\/\\._])(11|0?[469])([-\\/\\._])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\\d{2})|([2-9]\\d{3}))([-\\/\\._])(0?2)([-\\/\\._])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([3579][26]00)([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([1][89][0][48])([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([2-9][0-9][0][48])([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([1][89][2468][048])([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([2-9][0-9][2468][048])([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([1][89][13579][26])([-\\/\\._])(0?2)([-\\/\\._])(29)$)|(^([2-9][0-9][13579][26])([-\\/\\._])(0?2)([-\\/\\._])(29)$))";t.calendarPattern="^\\d{4}-\\d{1,2}-\\d{1,2}$"},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(69)),a=n(r(5)),o=n(r(13));t.default=function(e){e.use(i.default);var t=e.use(a.default),r=t.Type.def,n=t.Type.or,s=e.use(o.default).defaults;r("Function").field("async",Boolean,s.false),r("SpreadProperty").bases("Node").build("argument").field("argument",r("Expression")),r("ObjectExpression").field("properties",[n(r("Property"),r("SpreadProperty"),r("SpreadElement"))]),r("SpreadPropertyPattern").bases("Pattern").build("argument").field("argument",r("Pattern")),r("ObjectPattern").field("properties",[n(r("Property"),r("PropertyPattern"),r("SpreadPropertyPattern"))]),r("AwaitExpression").bases("Expression").build("argument","all").field("argument",n(r("Expression"),null)).field("all",Boolean,s.false)},e.exports=t.default},function(e,t){t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function i(e){var t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function a(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function o(e){var r=e,n=i(e);if(n){if(!n.path)return e;r=n.path}for(var o,s=t.isAbsolute(r),l=r.split(/\/+/),u=0,c=l.length-1;c>=0;c--)"."===(o=l[c])?l.splice(c,1):".."===o?u++:u>0&&(""===o?(l.splice(c+1,u),u=0):(l.splice(c,2),u--));return""===(r=l.join("/"))&&(r=s?"/":"."),n?(n.path=r,a(n)):r}function s(e,t){""===e&&(e="."),""===t&&(t=".");var r=i(t),s=i(e);if(s&&(e=s.path||"/"),r&&!r.scheme)return s&&(r.scheme=s.scheme),a(r);if(r||t.match(n))return t;if(s&&!s.host&&!s.path)return s.host=t,a(s);var l="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return s?(s.path=l,a(s)):l}t.urlParse=i,t.urlGenerate=a,t.normalize=o,t.join=s,t.isAbsolute=function(e){return"/"===e.charAt(0)||r.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var n=e.lastIndexOf("/");if(n<0)return t;if((e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var l=!("__proto__"in Object.create(null));function u(e){return e}function c(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function f(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=l?u:function(e){return c(e)?"$"+e:e},t.fromSetString=l?u:function(e){return c(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){var n=f(e.source,t.source);return 0!==n?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)||r?n:0!==(n=e.generatedColumn-t.generatedColumn)?n:0!==(n=e.generatedLine-t.generatedLine)?n:f(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,r){var n=e.generatedLine-t.generatedLine;return 0!==n?n:0!==(n=e.generatedColumn-t.generatedColumn)||r?n:0!==(n=f(e.source,t.source))?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)?n:f(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r?r:0!==(r=e.generatedColumn-t.generatedColumn)?r:0!==(r=f(e.source,t.source))?r:0!==(r=e.originalLine-t.originalLine)?r:0!==(r=e.originalColumn-t.originalColumn)?r:f(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){var n=i(r);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var l=n.path.lastIndexOf("/");l>=0&&(n.path=n.path.substring(0,l+1))}t=s(a(n),t)}return o(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyntaxStructureBuilder=t.BaseSyntaxUnitProxy=t.MultiSyntaxUnitProxy=t.TypeArray=void 0;var n=r(3),i=r(11);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}var u=function(){function e(t){o(this,e),this.aArray=t}return l(e,[{key:"isIncludeType",value:function(e){return this.aArray.includes(e)}},{key:"isMarchTypeArray",value:function(e){return(0,i.isArrayBeginWithOther)(this.aArray,e)}}]),e}();t.TypeArray=u;var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];o(this,e),this.typeArray=[],this.childrenSynUnit=this.sortChildren(t),this.parentSynUnit=null}return l(e,[{key:"sortChildren",value:function(e){return e.sort((function(e,t){return e.pstID-t.pstID})),e}},{key:"addChild",value:function(e){e.parentSynUnit=this,this.childrenSynUnit.push(e),this.sortChildren(this.childrenSynUnit)}},{key:"getWholeString",value:function(){var e="";return this.childrenSynUnit.map((function(t){return e+=t.getWholeString()})),e}},{key:"updateByNewLoc",value:function(e,t){this.childrenSynUnit.map((function(r){return r.updateByNewLoc(e,t)}))}},{key:"getAllBaseSyntaxUnit",value:function(){var t=[];return this.childrenSynUnit.map((function(r){r instanceof e?t=t.concat(r.getAllBaseSyntaxUnit()):t.push(r)})),t}},{key:"getRefSyntaxUnit",value:function(){}}]),e}();t.MultiSyntaxUnitProxy=c;var f=function(){function e(t,r,n){o(this,e),this.pstID=t,this.wholeStr=r,this.typeArray=new u(n),this.pairUnit=null,this.parentSynUnit=null,this.assciatedValue=null,this.syntaxParser=this.getParser()}return l(e,[{key:"getParser",value:function(){return null}},{key:"addPair",value:function(e){this.pairUnit=e,e.pairUnit=this}},{key:"getLength",value:function(){return this.wholeStr.length}},{key:"isEmpty",value:function(){return""===this.wholeStr}},{key:"getSolvedValue",value:function(){return"function"==typeof this.assciatedValue.solveExpression?this.assciatedValue.solveExpression():n.SOLVE_FAIL_OBJ}},{key:"getWholeString",value:function(){return this.wholeStr}},{key:"updateByNewLoc",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(t=this.syntaxParser).updateStrByNewLoc.apply(t,a(e).concat([r]));return this.wholeStr=r?n:this.wholeStr,n}},{key:"updateByUserMove",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(t=this.syntaxParser).updateStrByUserMove.apply(t,a(e).concat([r]));return this.wholeStr=r?n:this.wholeStr,n}}]),e}();t.BaseSyntaxUnitProxy=f;var d=function(){function e(t){o(this,e),this.rootUnit=new c,this.curUnit=this.rootUnit,this.curExpID=-1,this.containerStack=[],this.curUnitStack=[this.rootUnit],void 0===t&&(t=f),this.SyntaxUnitCls=t}return l(e,[{key:"getAndAddExpId",value:function(){return this.curExpID+=1,this.curExpID}},{key:"getLastUnit",value:function(){return this.curUnitStack[this.curUnitStack.length-1]}},{key:"createNewChild",value:function(){var e=new c;e.parentSynUnit=this.getLastUnit(),this.getLastUnit().addChild(e),this.curUnit=e,this.curUnitStack.push(e)}},{key:"returnToPreStack",value:function(){this.curUnitStack.pop(),this.curUnit=this.getLastUnit()}},{key:"addStringToCurUnit",value:function(e,t){var r=new this.SyntaxUnitCls(this.getAndAddExpId(),e,t);return this.curUnit.addChild(r),r}},{key:"addContainerUnit",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.addStringToCurUnit(e,t);!0===r?n.addPair(this.containerStack.pop()):this.containerStack.push(n)}},{key:"addValueToCurUnit",value:function(e,t,r){var n=this.addStringToCurUnit(t,r);return n.assciatedValue=e,n}},{key:"addParserToCurUnit",value:function(e,t,r){var n=this.addStringToCurUnit(t,r);return n.syntaxParser=e,e.associateWithSyntaxUnit(n),n}},{key:"addUseLessUnit",value:function(e){if(""!==e)this.addStringToCurUnit(e,[n.USELESS])}}]),e}();t.SyntaxStructureBuilder=d},function(module,exports,__webpack_require__){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ACOS=ACOS,exports.ACOSH=ACOSH,exports.ACOT=ACOT,exports.ACOTH=ACOTH,exports.ADD=ADD,exports.ARABIC=ARABIC,exports.ASIN=ASIN,exports.ASINH=ASINH,exports.ATAN=ATAN,exports.ATAN2=ATAN2,exports.ATANH=ATANH,exports.BASE=BASE,exports.CEILING_=CEILING_,exports.COMBIN=COMBIN,exports.DECIMAL=DECIMAL,exports.DEGREES=DEGREES,exports.EVEN=EVEN,exports.FACT=FACT,exports.FACTDOUBLE=FACTDOUBLE,exports.FLOORMATH=FLOORMATH,exports.FLOORPRACE=FLOORPRACE,exports.GCD=GCD,exports.LCM=LCM,exports.LN=LN,exports.LOG=LOG,exports.LOG10=LOG10,exports.MINVERSE=MINVERSE,exports.MOD=MOD,exports.MROUND=MROUND,exports.MULTINOMIAL=MULTINOMIAL,exports.MUNIT=MUNIT,exports.isoCEILING_=isoCEILING_,exports.isoCEILING=exports.CSCH=exports.CSC=exports.COTH=exports.COT=exports.COSH=exports.COS=exports.COMBINA=exports.CEILING=exports.ABS=void 0;var numeric=_interopRequireWildcard(__webpack_require__(55)),utils=_interopRequireWildcard(__webpack_require__(11)),_error_config=__webpack_require__(2),statistical=_interopRequireWildcard(__webpack_require__(27)),information=_interopRequireWildcard(__webpack_require__(28)),_exp_function_warp=__webpack_require__(15),_parse_helper=__webpack_require__(17);function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function ABS_(e){return Math.abs(e)}var ABS=new _exp_function_warp.OnlyNumberExpFunction(ABS_);function ACOS(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.acos(e)}function ACOSH(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.log(e+Math.sqrt(e*e-1))}function ACOT(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.atan(1/e)}function ACOTH(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):.5*Math.log((e+1)/(e-1))}function ADD(e,t){return"number"!=typeof e||"number"!=typeof t?Error(_error_config.ERROR_VALUE):e+t}function ARABIC(e){if(e=e.toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return Error(_error_config.ERROR_VALUE);var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t}function ASIN(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.asin(e)}function ASINH(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.log(e+Math.sqrt(e*e+1))}function ATAN(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.atan(e)}function ATAN2(e,t){return"number"!=typeof e||"number"!=typeof t?Error(_error_config.ERROR_VALUE):Math.atan2(e,t)}function ATANH(e){return"number"!=typeof e?Error(_error_config.ERROR_VALUE):Math.log((1+e)/(1-e))/2}function BASE(e,t,r){if(r=r||0,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),(0,utils.anyIsError)(e,t,r))return new Error(_error_config.ERROR_VALUE);r=void 0===r?0:r;var n=e.toString(t);return new Array(Math.max(r+1-n.length,0)).join("0")+n}function CEILING_(e,t,r){var n=t;if(t=void 0===t?1:Math.abs(t),r=r||0,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),0===t)return 0;var i=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,i):0===r?n<0?-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,i):-exports.ROUND(Math.floor(Math.abs(e)/t)*t,i):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,i)}exports.ABS=ABS,exports.AGGREGATE=function(e,t,r,n){if(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),"string"==typeof r)return Error(_error_config.ERROR_VALUE);if((0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);switch(e){case 1:return statistical.AVERAGE(r);case 2:return statistical.COUNT(r);case 3:return statistical.COUNTA(r);case 4:return statistical.MAX(r);case 5:return statistical.MIN(r);case 6:return exports.PRODUCT(r);case 7:return statistical.STDEV.S(r);case 8:return statistical.STDEV.P(r);case 9:return exports.SUM(r);case 10:return statistical.VAR.S(r);case 11:return statistical.VAR.P(r);case 12:return statistical.MEDIAN(r,n);case 13:return statistical.MODE.SNGL(r);case 14:return statistical.LARGE(r,n);case 15:return null==n?Error(_error_config.ERROR_VALUE):statistical.SMALL(r,n);case 16:return statistical.PERCENTILE.INC(r,n);case 17:return statistical.QUARTILE.INC(r,n);case 18:return statistical.PERCENTILE.EXC(r,n);case 19:return statistical.QUARTILE.EXC(r,n)}};var CEILING=new _exp_function_warp.OnlyNumberExpFunction(CEILING_);function COMBIN(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))}function COMBINA_(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)}exports.CEILING=CEILING,exports.CEILING.MATH=CEILING,exports.CEILING.PRECISE=CEILING;var COMBINA=new _exp_function_warp.OnlyNumberExpFunction(COMBINA_);function COS_(e){return e=(0,_parse_helper.parseNumber)(e),Math.cos(e)}exports.COMBINA=COMBINA;var COS=new _exp_function_warp.OnlyNumberExpFunction(COS_);function COSH_(e){return e=(0,_parse_helper.parseNumber)(e),(Math.exp(e)+Math.exp(-e))/2}exports.COS=COS;var COSH=new _exp_function_warp.OnlyNumberExpFunction(COSH_);function COT_(e){return e=(0,_parse_helper.parseNumber)(e),1/Math.tan(e)}exports.COSH=COSH;var COT=new _exp_function_warp.OnlyNumberExpFunction(COT_);function COTH_(e){e=(0,_parse_helper.parseNumber)(e);var t=Math.exp(2*e);return(t+1)/(t-1)}exports.COT=COT;var COTH=new _exp_function_warp.OnlyNumberExpFunction(COTH_);function CSC_(e){return e=(0,_parse_helper.parseNumber)(e),1/Math.sin(e)}exports.COTH=COTH;var CSC=new _exp_function_warp.OnlyNumberExpFunction(CSC_);function CSCH_(e){return e=(0,_parse_helper.parseNumber)(e),2/(Math.exp(e)-Math.exp(-e))}exports.CSC=CSC;var CSCH=new _exp_function_warp.OnlyNumberExpFunction(CSCH_);function DECIMAL(e,t){return arguments.length<1?Error(_error_config.ERROR_VALUE):parseInt(e,t)}function DEGREES(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:180*e/Math.PI}function EVEN(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:exports.CEILING_(e,-2,-1)}function FACT(e){var t=[];if((e=(0,_parse_helper.parseNumber)(e))<0)return Error(_error_config.ERROR_NUM);if(e instanceof Error)return e;var r=Math.floor(e);return 0===r||1===r?1:t[r]>0?t[r]:(t[r]=exports.FACT(r-1)*r,t[r])}function FACTDOUBLE(e){if((e=(0,_parse_helper.parseNumber)(e))instanceof Error)return e;if(e<0)return Error(_error_config.ERROR_NUM);var t=Math.floor(e);return t<=1?1:t*exports.FACTDOUBLE(t-2)}exports.CSCH=CSCH,exports.EXP=Math.exp,exports.FLOOR={};var ROUND=function(e,t){var r=e,n=t;return Math.round(r*Math.pow(10,n))/Math.pow(10,n)};function FLOORMATH(e,t,r){if("number"!=typeof e)return Error(_error_config.ERROR_VALUE);if(e>0&&t<0)return Error(_error_config.ERROR_VALUE);if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;var i=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,i):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,i):-ROUND(Math.floor(Math.abs(e)/t)*t,i)}function FLOORPRACE(e,t,r){if("number"!=typeof e)return Error(_error_config.ERROR_VALUE);if(e<0&&t<0){e=-e,t=-t;var n=-Math.floor(Math.log(t)/Math.log(10));return-ROUND(Math.floor(e/t)*t,n)}if(r=void 0===r?0:r,0===(t=void 0===t?1:t))return 0;t=t?Math.abs(t):1;var i=-Math.floor(Math.log(t)/Math.log(10));return e>=0?ROUND(Math.floor(e/t)*t,i):0===r||void 0===r?-ROUND(Math.ceil(Math.abs(e)/t)*t,i):-ROUND(Math.floor(Math.abs(e)/t)*t,i)}function GCD(){var e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(arguments));if(e instanceof Error)return e;var t=e.length,r=e[0];if(r<0)return Error(_error_config.ERROR_NUM);for(var n=r<0?-r:r,i=1;i<t;i++){var a=e[i];if(a<0)return Error(_error_config.ERROR_NUM);for(var o=a<0?-a:a;n&&o;)n>o?n%=o:o%=n;n+=o}return n}function LCM(){var e,t=1,r=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(arguments));if(r instanceof Error)return r;for(e=0;e<=r.length;e++)if(r[e]<0)return Error(_error_config.ERROR_NUM);for(var n,i,a,o=1;void 0!==(a=r.pop());)for(;a>1;){if(a%2){for(n=3,i=Math.floor(Math.sqrt(a));n<=i&&a%n;n+=2);o=n<=i?n:a}else o=2;for(a/=o,t*=o,n=r.length;n;r[--n]%o==0&&1==(r[n]/=o)&&r.splice(n,1));}return t}function LN(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:e<=0?Error(_error_config.ERROR_NUM):Math.log(e)}function LOG(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(t)&&(t=10),e<=0||t<=1?Error(_error_config.ERROR_NUM):(t=void 0===t?10:t,Math.log(e)/Math.log(t))}function LOG10(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:e<=0?Error(_error_config.ERROR_NUM):Math.log(e)/Math.log(10)}function MINVERSE(e){return(e=(0,_parse_helper.parseMatrix)(e))instanceof Error?e:numeric.inv(e)}function MOD(e,t){if(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);if(0===t)return Error(_error_config.ERROR_DIV0);var r=Math.abs(e%t);return t>0?r:-r}function MROUND(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):e*t<0?Error(_error_config.ERROR_NUM):Math.round(e/t)*t}function MULTINOMIAL(){var e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(arguments));if(e instanceof Error)return e;for(var t=0,r=1,n=0;n<e.length;n++){if(e[n]<0)return Error(_error_config.ERROR_NUM);t+=e[n],r*=FACT(e[n])}return FACT(t)/r}function MUNIT(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:numeric.identity(e)}function isoCEILING_(e,t,r){if(t=void 0===t?1:Math.abs(t),r=r||0,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),0===t)return 0;var n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,n):0===r?-exports.ROUND(Math.floor(Math.abs(e)/t)*t,n):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,n)}exports.FLOOR.MATH=exports.FLOORMATH,exports.FLOOR.PRECISE=exports.FLOORPRACE,exports.INT=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.MDETERM=function(e){"string"==typeof e&&(e=utils.strToMatrix(e));try{return numeric.det(e)}catch(e){return Error(_error_config.ERROR_VALUE)}},exports.MMULT=function(e,t){return e=(0,_parse_helper.parseMatrix)(e),t=(0,_parse_helper.parseMatrix)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):(console.log(numeric.dot(e,t)),numeric.dot(e,t))},exports.ODD=function(e){if((e=(0,_parse_helper.parseNumber)(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.POWER=function(e,t){if(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var r=Math.pow(e,t);return isNaN(r)?Error(_error_config.ERROR_VALUE):r},exports.PRODUCT=function(){var e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(arguments));if(e instanceof Error)return e;for(var t=1,r=0;r<e.length;r++)t*=e[r];return t},exports.QUOTIENT=function(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):parseInt(e/t,10)},exports.RADIANS=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return arguments.length>0&&void 0!==arguments[0]?Error(_error_config.ERROR_VALUE):Math.random()},exports.RANDBETWEEN=function(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=function(e){if((e=(0,_parse_helper.parseNumber)(e))instanceof Error)return e;for(var t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],n="",i=3;i--;)n=(r[+t.pop()+10*i]||"")+n;return new Array(+t.join("")+1).join("M")+n},exports.ROUND=function(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):e<0?(e=0-e,0-Math.round(e*Math.pow(10,t))/Math.pow(10,t)):Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){return e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,r,n){if(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),n=(0,_parse_helper.parseNumberArray)(n),(0,utils.anyIsError)(e,t,r,n))return Error(_error_config.ERROR_VALUE);for(var i=n[0]*Math.pow(e,t),a=1;a<n.length;a++)i+=n[a]*Math.pow(e,t+a*r);return i},exports.SIGN=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:e<0?Error(_error_config.ERROR_VALUE):Math.sqrt(e)},exports.SQRTPI=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=function(e,t){if((e=(0,_parse_helper.parseNumber)(e))instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}},exports.MINUS=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):0===t?_error_config.errorObj.ERROR_DIV0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):e*t)},exports.GTE=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?_error_config.errorObj.ERROR_ERROR:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?_error_config.errorObj.ERROR_ERROR:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?_error_config.errorObj.ERROR_ERROR:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:e===t},exports.NE=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:e!==t},exports.POW=function(e,t){return 2!==arguments.length?_error_config.errorObj.ERROR_NA:(e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?_error_config.errorObj.ERROR_ERROR:exports.POWER(e,t))},exports.SUM=function(){for(var e=0,t=Object.keys(arguments),r=0;r<t.length;++r){var n=arguments[t[r]];if("number"==typeof n)e+=n;else if("string"==typeof n){var i=parseFloat(n);!isNaN(i)&&(e+=i)}else Array.isArray(n)&&(e+=exports.SUM.apply(null,n))}return e},exports.SUMIF=function(range,criteria){if(range=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var e=utils.argsToArray(arguments),t=(0,utils.flatten)(e.shift());if(t instanceof Error)return t;if(e.length%2!=0)return Error(_error_config.ERROR_VALUE);for(var r=0;r<e.length;r+=2)if(e[r].length!==t.length||!e[r+1])return Error(_error_config.ERROR_VALUE);for(var n=[],i=0,a=0;a<e.length;a+=2){for(var o=[],s=0;s<e[a].length;s++){var l=e[a+1]+"";if(0==l.lastIndexOf(">=")?(l=l.replace(/>=/,""),isNaN(l)&&(str=!0),1*l<=e[a][s][0]&&o.push(s)):0==l.lastIndexOf("<=")&&(l=l.replace(/<=/,""),isNaN(l)&&(str=!0),1*l>=e[a][s][0]&&o.push(s)),0==(l=l.replace("=","")).lastIndexOf("<>"))(l=l.replace(/<>/,""))!==e[a][s][0]&&o.push(s);else{var u=!1;if(0==l.lastIndexOf("<"))l=l.replace(/</,""),isNaN(l)&&(u=!0),1*l>e[a][s][0]&&o.push(s);else if(0==l.lastIndexOf(">"))l=l.replace(/>/,""),isNaN(l)&&(u=!0),1*l<e[a][s][0]&&o.push(s);else{if(l.indexOf("*")>0){var c=l;c=c.replace("*",""),"string"==typeof e[a][s][0]&&e[a][s][0].indexOf(c)>=0&&o.push(s)}isNaN(l)?l===e[a][s][0]&&o.push(s):1*l===e[a][s][0]&&o.push(s)}if(u)return Error(_error_config.ERROR_VALUE)}}n.push(o)}for(var f=[],d=0;d<n.length;d++)for(var h=0;h<n[d].length;h++){for(var p=n[d][h],m=1,v=0;3!==m&&v<n.length;v++)v!==d&&-1!==n[v].indexOf(p)?m=2:v!==d&&(m=3);1==m&&n.length>1?m=3:1==m&&1===n.length&&(m=2),2==m&&-1==f.indexOf(p)&&f.push(p)}if(n.length<=0)return Error(_error_config.ERROR_VALUE);for(var y=0;y<f.length;y++){var g=t[f[y]];if(!g||isNaN(g))return 0;i+=g}return i},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return Error(_error_config.ERROR_VALUE);for(var e,t,r,n,i=arguments.length+1,a=0,o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var s=0;s<arguments[0][o].length;s++){for(e=1,t=1;t<i;t++){if((n=(0,_parse_helper.parseNumber)(arguments[t-1][o][s]))instanceof Error)return n;e*=n}a+=e}else{for(e=1,t=1;t<i;t++){if((r=(0,_parse_helper.parseNumber)(arguments[t-1][o]))instanceof Error)return r;e*=r}a+=e}return a},exports.SUMSQ=function(){var e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(arguments));if(e instanceof Error)return e;for(var t=0,r=e.length,n=0;n<r;n++)t+=information.ISNUMBER(e[n])?e[n]*e[n]:0;return t},exports.SUMX2MY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var r=0;e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(e)),t=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]-t[n]*t[n];return r},exports.SUMX2PY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var r=0;e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(e)),t=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(t));for(var n=0;n<e.length;n++)r+=e[n]*e[n]+t[n]*t[n];return r},exports.SUMXMY2=function(e,t){if("string"==typeof e&&(e=utils.strToMatrix(e)),"string"==typeof t&&(t=utils.strToMatrix(t)),e=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(e)),t=(0,_parse_helper.parseNumberArray)((0,utils.flatten)(t)),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var r=0;e=(0,utils.flatten)(e),t=(0,utils.flatten)(t);for(var n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},exports.TAN=function(e){return(e=(0,_parse_helper.parseNumber)(e))instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if((e=(0,_parse_helper.parseNumber)(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){return t=void 0===t?0:t,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t)?Error(_error_config.ERROR_VALUE):(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)};var isoCEILING=new _exp_function_warp.OnlyNumberExpFunction(isoCEILING_);exports.isoCEILING=isoCEILING},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AVEDEV=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;return s.meandev(e)},t.AVERAGEA=E,t.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return Error(c.ERROR_NA);if(r=r||e,e=(0,l.flatten)(e),(r=(0,h.parseNumberArray)((0,l.flatten)(r)))instanceof Error)return r;for(var n=0,i=0,a=void 0===t||"*"===t,o=a?null:d.parse(t+""),s=t.replace("=","").replace("*","").replace("<>",""),u=0;u<e.length;u++){var f=e[u];if(a)i+=r[u],n++;else{var p=[d.createToken(f,d.TOKEN_TYPE_LITERAL)].concat(o);t.indexOf("<>")>=0?f.indexOf(s)<0&&(i+=r[u],n++):(d.compute(p)||f.toString().indexOf(s)>=0)&&(i+=r[u],n++)}}if(0===n)return new Error(c.ERROR_DIV0);return i/n},t.AVERAGEIFS=function(){for(var e=l.argsToArray(arguments),t=(e.length-1)/2,r=(0,l.flatten)(e[0]),n=0,i=0,a=0;a<r.length;a++){for(var o=!1,s=0;s<t;s++){var u=e[2*s+1][a],f=e[2*s+2],h=!1;if(void 0===f||"*"===f)h=!0;else{var p=d.parse(f+""),m=[d.createToken(u,d.TOKEN_TYPE_LITERAL)].concat(p);h=d.compute(m)}if(!h){o=!1;break}o=!0}o&&(i+=r[a],n++)}var v=i/n;return isNaN(v)?new Error(c.ERROR_DIV0):v},t.BETADIST_=b,t.BETAINV_=A,t.CHISQ__DIST=function(e,t,r){if(r=(0,h.parseBool)(r),e<0)return Error(c.ERROR_NUM);if(e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t))return Error(c.ERROR_NUM);return r?s.chisquare.cdf(e,t):s.chisquare.pdf(e,t)},t.CHISQ__DIST__RT=function(e,t){if(!e||!t)return Error(c.ERROR_VALUE);if(e<1||t>Math.pow(10,10))return Error(c.ERROR_NUM);if("number"!=typeof e||"number"!=typeof t)return Error(c.ERROR_VALUE);return 1-s.chisquare.cdf(e,t)},t.CHISQ__INV=function(e,t){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),s.chisquare.inv(e,t)},t.CHISQ__INV__RT=function(e,t){if(!e|!t)return Error(c.ERROR_VALUE);if(e<0||e>1||t<1||t>Math.pow(10,10))return Error(c.ERROR_NUM);if("number"!=typeof e||"number"!=typeof t)return Error(c.ERROR_VALUE);return s.chisquare.inv(1-e,t)},t.COLUMN=function(){var e=this.args[0].cellFormulaProxy.name;return e=e.replace(/\d+/g,""),["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"].indexOf(e)+1},t.COLUMNS=function(e){"string"==typeof e&&(e=l.strToMatrix(e));if(!(e instanceof Array))return Error(c.ERROR_VALUE);if(0===e.length)return 0;return s.cols(e)},t.CONFIDENCE__T=function(e,t,r){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),s.tci(1,e,t,r)[1]-1},t.IFS_=O,t.CORREL=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);return s.corrcoeff(e,t)},t.COUNT=function(){return u.numbers(u.flatten(arguments)).length},t.COUNTA=function(){var e=u.flatten(arguments);return e.length-t.COUNTBLANK(e)},t.COUNTBLANK=function(){for(var e,t=(0,l.flatten)(arguments),r=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||r++;return r},t.COUNTIF=function(e,t){if(e=u.flatten(e),void 0===t)return Error(c.ERROR_VALUE);if(void 0===t||"*"===t)return e.length;for(var r=0,n=d.parse(t+""),i=0;i<e.length;i++){var a=e[i],o=[d.createToken(a,d.TOKEN_TYPE_LITERAL)].concat(n);d.compute(o)&&r++}return r},t.COVARIANCE__P=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=s.mean(e),n=s.mean(t),i=0,a=e.length,o=0;o<a;o++)i+=(e[o]-r)*(t[o]-n);return i/a},t.COVARIANCE__S=function(e,t){"string"==typeof e&&(e=l.strToMatrix(e));"string"==typeof t&&(t=l.strToMatrix(t));if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);return s.covariance(e,t)},t.DEVSQ=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t=s.mean(e),r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},t.FISHER=function(e){if((e=(0,h.parseNumber)(e))instanceof Error)return e;if(e<=-1||e>=1)return Error(c.ERROR_NUM);return Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=(0,h.parseNumber)(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},t.FORECAST=function(e,t,r){if(e=(0,h.parseNumber)(e),t=(0,h.parseNumberArray)((0,l.flatten)(t)),r=(0,h.parseNumberArray)((0,l.flatten)(r)),(0,l.anyIsError)(e,t,r))return Error(c.ERROR_VALUE);for(var n=s.mean(r),i=s.mean(t),a=r.length,o=0,u=0,f=0;f<a;f++)o+=(r[f]-n)*(t[f]-i),u+=Math.pow(r[f]-n,2);var d=o/u;return i-d*n+d*e},t.GAMMA=function(e){if((e=(0,h.parseNumber)(e))instanceof Error)return e;if(0===e)return Error(c.ERROR_NUM);if(parseInt(e,10)===e&&e<0)return Error(c.ERROR_NUM);return s.gammafn(e)},t.GAMMALN=function(e){if((e=(0,h.parseNumber)(e))instanceof Error)return e;if(e<=0)return Error(c.ERROR_NUM);return s.gammaln(e)},t.GAUSS=function(e){if((e=(0,h.parseNumber)(e))instanceof Error)return e;return s.normal.cdf(e,0,1)-.5},t.GEOMEAN=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t=e.length,r=0;r<t;r++)if(e[r]<=0)return Error(c.ERROR_NUM);return s.geomean(e)},t.HARMEAN=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t=e.length,r=0,n=0;n<t;n++){if(e[n]<=0)return Error(c.ERROR_NUM);r+=1/e[n]}return t/r},t.INTERCEPT=function(e,r){if(e=(0,h.parseNumberArray)(e),r=(0,h.parseNumberArray)(r),(0,l.anyIsError)(e,r))return Error(c.ERROR_VALUE);if(e.length!==r.length)return Error(c.ERROR_NA);return t.FORECAST(0,e,r)},t.KURT=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;if(e.length<4)return Error(c.ERROR_DIV0);for(var t=s.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,4);return n/=Math.pow(s.stdev(e,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*n-3*(r-1)*(r-1)/((r-2)*(r-3))},t.LARGE=function(e,t){if(void 0===(e=(0,l.flatten)(e))||t<=0||t>e.length)return Error(c.ERROR_NUM);for(var r=[],n=0;n<e.length;n++)parseFloat(e[n])&&r.push(parseFloat(e[n]));if(e=r,t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t))return e;return e.sort((function(e,t){return t-e}))[t-1]},t.LINEST=D,t.LOGEST=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=0;r<e.length;r++)e[r]=Math.log(e[r]);var n=D(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[0]},t.MAX=function(){var e,t=(0,l.arrayValuesToNumbers)((0,l.flatten)(arguments));for(e=0;e<t.length;e++)if("string"===t[e])return Error(c.ERROR_NAME);return 0===t.length?0:Math.max.apply(Math,t)},t.MAXA=function(){var e=(0,l.arrayValuesToNumbers)((0,l.flatten)(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MEDIAN=function(){for(var e=(0,l.arrayValuesToNumbers)((0,l.flatten)(arguments)),t=[],r=0;r<e.length;r++)"number"==typeof e[r]&&t.push(e[r]);var n=(0,l.arrayValuesToNumbers)((0,l.flatten)(t));return s.median(n)},t.MIN=function(){var e=(0,l.arrayValuesToNumbers)((0,l.flatten)(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.MINA=function(){var e=(0,l.arrayValuesToNumbers)((0,l.flatten)(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.STDEVA=function(){var e=t.VARA.apply(this,arguments);return Math.sqrt(e)},t.IFS=t.CONFIDENCE__NORM=t.CHISQ__TEST=t.BINOM__INV=t.BINOM__DIST=t.BETA__INV=t.BETA__DIST=t.AVERAGE=void 0;var a=y(r(26)),o=y(r(36)),s=y(r(37)),l=y(r(11)),u=l,c=r(2),f=y(r(58)),d=y(r(100)),h=r(17),p=r(15),m=r(3);r(28),r(21);function v(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return v=function(){return e},e}function y(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=v();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var g=new p.NotConvertEmptyExpFunction((function(){var e=(0,l.to1DArray)(arguments).filter((function(e){return e.cellVTypeName===m.CellVTypeObj.CellVNumber||"number"==typeof e}));if(e instanceof Error)return e;if(0===e.length)return new Error(c.ERROR_DIV0);for(var t=e.length,r=0,n=0,i=0;i<t;i++)r+=e[i],n+=1;return r/n}));function E(){var e=arguments;if(1===e.length&&isNaN(e[0]))return Error(c.ERROR_VALUE);for(var t=e.length,r=0,n=0,i=0;i<t;i++){var a=e[i];"number"==typeof a&&(r+=a),null!==a&&n++}return r/n}function b(e,t,r,n,i,a){return arguments.length<4?Error(c.ERROR_NUM):(i=void 0===i?0:i,a=void 0===a?1:a,e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),e=(e-(i=(0,h.parseNumber)(i)))/((a=(0,h.parseNumber)(a))-i),(n=(0,h.parseBool)(n))?s.beta.cdf(e,t,r):s.beta.pdf(e,t,r)/2)}t.AVERAGE=g,t.BETA={};var x=new p.OnlyNumberExpFunction(b);function A(e,t,r,n,i){return n=void 0===n?0:n,i=void 0===i?1:i,e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),n=(0,h.parseNumber)(n),i=(0,h.parseNumber)(i),e<=0||e>1||t<=0||r<=0?Error(c.ERROR_NUM):s.beta.inv(e,t,r)*(i-n)+n}t.BETA__DIST=x;var S=new p.OnlyNumberExpFunction(A);t.BETA__INV=S,t.BINOM={};var w=new p.OnlyNumberExpFunction((function(e,t,r,n){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),n=(0,h.parseBool)(n),n=(0,h.parseNumber)(n),e<0||e>t||r<0||r>1?Error(c.ERROR_NUM):n?s.binomial.cdf(e,t,r):s.binomial.pdf(e,t,r)}));t.BINOM__DIST=w;var R=new p.OnlyNumberExpFunction((function(e,t,r){if(e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),e<0||t<0||t>1||r<0||r>1)return Error(c.ERROR_NUM);for(var n=0;n<=e;){if(s.binomial.cdf(n,e,t)>=r)return n;n++}}));t.BINOM__INV=R;var C=new p.OnlyNumberExpFunction((function(e,t){if(2!==arguments.length)return Error(c.ERROR_NA);if(!(e instanceof Array&&t instanceof Array))return Error(c.ERROR_VALUE);if(e.length!==t.length)return Error(c.ERROR_VALUE);if(e[0]&&t[0]&&e[0].length!==t[0].length)return Error(c.ERROR_VALUE);var r,n,i,a=e.length;for(n=0;n<a;n++)e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r)),t[n]instanceof Array||(r=t[n],t[n]=[],t[n].push(r));var o=e[0].length,s=1===o?a-1:(a-1)*(o-1),l=0,u=Math.PI;for(n=0;n<a;n++)for(i=0;i<o;i++)l+=Math.pow(e[n][i]-t[n][i],2)/t[n][i];return Math.round(1e6*function(e,t){var r=Math.exp(-.5*e);t%2==1&&(r*=Math.sqrt(2*e/u));for(var n=t;n>=2;)r=r*e/n,n-=2;for(var i=r,a=t;i>1e-10*r;)r+=i=i*e/(a+=2);return 1-r}(l,s))/1e6}));t.CHISQ__TEST=C,t.CONFIDENCE={};var T=new p.OnlyNumberExpFunction((function(e,t,r){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),s.normalci(1,e,t,r)[1]-1}));function O(){for(var e=0;e+1<arguments.length;e+=2){var t=arguments[e],r=arguments[e+1];if(t)return r}return Error(c.ERROR_NA)}t.CONFIDENCE__NORM=T;var _=new p.NotConvertExpFunction(O);function D(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=s.mean(e),n=s.mean(t),i=t.length,a=0,o=0,u=0;u<i;u++)a+=(t[u]-n)*(e[u]-r),o+=Math.pow(t[u]-n,2);var f=a/o;return[f,r-f*n]}t.IFS=_,t.COUNTIN=function(e,t){for(var r=0,n=0;n<e.length;n++)e[n]===t&&r++;return r},t.COUNTIFS=function(){for(var e=l.argsToArray(arguments),t=new Array((0,l.flatten)(e[0]).length),r=0;r<t.length;r++)t[r]=!0;for(i=0;i<e.length;i+=2){var n=(0,l.flatten)(e[i]),a=e[i+1],o=void 0===a||"*"===a;if(!o)for(var s=d.parse(a+""),u=0;u<n.length;u++){var c=n[u],f=[d.createToken(c,d.TOKEN_TYPE_LITERAL)].concat(s);t[u]=t[u]&&d.compute(f)}}var h=0;for(i=0;i<t.length;i++)t[i]&&h++;return h},t.COUNTUNIQUE=function(){return f.UNIQUE.apply(null,(0,l.flatten)(arguments)).length},t.COVARIANCE={},t.EXPON={},t.EXPON.DIST=function(e,t,r){return r=(0,h.parseBool)(r),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):e<0||t<0?Error(c.ERROR_NUM):r?s.exponential.cdf(e,t):s.exponential.pdf(e,t)},t.F={},t.F.DIST=function(e,t,r,n){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):(void 0===n&&(n=!0),"FALSE"===n&&(n=!1),n?s.centralF.cdf(e,t,r):s.centralF.pdf(e,t,r))},t.F.DIST.RT=function(e,t,r){return 3!==arguments.length?Error(c.ERROR_NA):e<0||t<1||r<1?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?Error(c.ERROR_VALUE):1-s.centralF.cdf(e,t,r)},t.F.INV=function(e,t,r){return 3!==arguments.length?Error(c.ERROR_NA):e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?Error(c.ERROR_VALUE):s.centralF.inv(e,t,r)},t.F.INV.RT=function(e,t,r){return 3!==arguments.length?Error(c.ERROR_NA):e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?Error(c.ERROR_VALUE):s.centralF.inv(1-e,t,r)},t.F.TEST=function(e,t){if(!e||!t)return Error(c.ERROR_NA);if(!(e instanceof Array&&t instanceof Array))return Error(c.ERROR_NA);if(e.length<2||t.length<2)return Error(c.ERROR_DIV0);var r=s.variance(e),n=s.variance(t);return r>=n?2*s.ftest(r/n,e.length-1,t.length-1):n>r?2*s.ftest(n/r,t.length-1,e.length-1):void 0},t.FREQUENCY=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=e.length,n=t.length,i=[],a=0;a<=n;a++){i[a]=0;for(var o=0;o<r;o++)0===a?e[o]<=t[0]&&(i[0]+=1):a<n?e[o]>t[a-1]&&e[o]<=t[a]&&(i[a]+=1):a===n&&e[o]>t[n-1]&&(i[n]+=1)}return i},t.GAMMA.DIST=function(e,t,r,n){return n=(0,h.parseBool)(n),4!==arguments.length?Error(c.ERROR_NA):e<0||t<=0||r<=0?Error(c.ERROR_VALUE):"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?Error(c.ERROR_VALUE):n?s.gamma.cdf(e,t,r,!0):s.gamma.pdf(e,t,r,!1)},t.GAMMA.INV=function(e,t,r){return 3!==arguments.length?Error(c.ERROR_NA):e<0||e>1||t<=0||r<=0?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?Error(c.ERROR_VALUE):s.gamma.inv(e,t,r)},t.GAMMALN.PRECISE=function(e){return 1!==arguments.length?Error(c.ERROR_NA):e<=0?Error(c.ERROR_NUM):"number"!=typeof e?Error(c.ERROR_VALUE):s.gammaln(e)},t.GROWTH=function(e,t,r,n){if((e=(0,h.parseNumberArray)(e))instanceof Error)return e;var i;if(void 0===t)for(t=[],i=1;i<=e.length;i++)t.push(i);if(void 0===r)for(r=[],i=1;i<=e.length;i++)r.push(i);if(t=(0,h.parseNumberArray)(t),r=(0,h.parseNumberArray)(r),(0,l.anyIsError)(t,r))return Error(c.ERROR_VALUE);void 0===n&&(n=!0);var a,o,s=e.length,u=0,f=0,d=0,p=0;for(i=0;i<s;i++){var m=t[i],v=Math.log(e[i]);u+=m,f+=v,d+=m*v,p+=m*m}u/=s,f/=s,d/=s,p/=s,n?o=f-(a=(d-u*f)/(p-u*u))*u:(a=d/p,o=0);var y=[];for(i=0;i<r.length;i++)y.push(Math.exp(o+a*r[i]));return y},t.HYPGEOM={},t.HYPGEOM.DIST=function(e,t,r,n,i){if(i=(0,h.parseBool)(i),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),n=(0,h.parseNumber)(n),(0,l.anyIsError)(e,t,r,n))return Error(c.ERROR_VALUE);if(e<0||e>Math.min(t,r)||e<Math.max(0,t-n+r)||t<=0||t>n||r<=0||r>n||n<=0)return Error(c.ERROR_NUM);function o(e,t,r,n){return a.COMBIN(r,e)*a.COMBIN(n-r,t-e)/a.COMBIN(n,t)}return i?function(e,t,r,n){for(var i=0,a=0;a<=e;a++)i+=o(a,t,r,n);return i}(e,t,r,n):o(e,t,r,n)},t.LOGNORM={},t.LOGNORM.DIST=function(e,t,r,n){return n=(0,h.parseBool)(n),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):e<=0||r<=0?Error(c.ERROR_NUM):n?s.lognormal.cdf(e,t,r):s.lognormal.pdf(e,t,r)},t.LOGNORM.INV=function(e,t,r){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):e<=0||e>=1||r<=0?Error(c.ERROR_NUM):s.lognormal.inv(e,t,r)},t.MODE={},t.MODE.MULT=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t,r=e.length,n={},i=[],a=0,o=0;o<r;o++)n[t=e[o]]=n[t]?n[t]+1:1,n[t]>a&&(a=n[t],i=[]),n[t]===a&&(i[i.length]=t);return i},t.MODE.SNGL=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.NEGBINOM={},t.NEGBINOM.DIST=function(e,t,r,n){return n=(0,h.parseBool)(n),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):n?s.negbin.cdf(e,t,r):s.negbin.pdf(e,t,r)},t.NORM={},t.NORM.DIST=function(e,t,r,n){return n=(0,h.parseBool)(n),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):r<=0?Error(c.ERROR_NUM):n?s.normal.cdf(e,t,r):s.normal.pdf(e,t,r)},t.NORM.INV=function(e,t,r){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):s.normal.inv(e,t,r)},t.NORM.S={},t.NORM.S.DIST=function(e,t){return t=(0,h.parseBool)(t),(e=(0,h.parseNumber)(e))instanceof Error?Error(c.ERROR_VALUE):t?s.normal.cdf(e,0,1):s.normal.pdf(e,0,1)},t.NORM.S.INV=function(e){return(e=(0,h.parseNumber)(e))instanceof Error?Error(c.ERROR_VALUE):s.normal.inv(e,0,1)},t.PEARSON=function(e,t){if(t=(0,h.parseNumberArray)((0,l.flatten)(t)),e=(0,h.parseNumberArray)((0,l.flatten)(e)),(0,l.anyIsError)(t,e))return Error(c.ERROR_VALUE);for(var r=s.mean(e),n=s.mean(t),i=e.length,a=0,o=0,u=0,f=0;f<i;f++)a+=(e[f]-r)*(t[f]-n),o+=Math.pow(e[f]-r,2),u+=Math.pow(t[f]-n,2);return a/Math.sqrt(o*u)},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);var r=(e=e.sort((function(e,t){return e-t}))).length;if(t<1/(r+1)||t>1-1/(r+1))return Error(c.ERROR_NUM);var n=t*(r+1)-1,i=Math.floor(n);return l.cleanFloat(n===i?e[n]:e[i]+(n-i)*(e[i+1]-e[i]))},t.PERCENTILE.INC=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);var r=t*((e=e.sort((function(e,t){return e-t}))).length-1),n=Math.floor(r);return l.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,r){if(r=void 0===r?3:r,e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r))return Error(c.ERROR_VALUE);e=e.sort((function(e,t){return e-t}));for(var n=f.UNIQUE.apply(null,e),i=e.length,a=n.length,o=Math.pow(10,r),s=0,u=!1,d=0;!u&&d<a;)t===n[d]?(s=(e.indexOf(n[d])+1)/(i+1),u=!0):t>=n[d]&&(t<n[d+1]||d===a-1)&&(s=(e.indexOf(n[d])+1+(t-n[d])/(n[d+1]-n[d]))/(i+1),u=!0),d++;return Math.floor(s*o)/o},t.PERCENTRANK.INC=function(e,t,r){if(r=void 0===r?3:r,e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r))return Error(c.ERROR_VALUE);e=e.sort((function(e,t){return e-t}));for(var n=f.UNIQUE.apply(null,e),i=e.length,a=n.length,o=Math.pow(10,r),s=0,u=!1,d=0;!u&&d<a;)t===n[d]?(s=e.indexOf(n[d])/(i-1),u=!0):t>=n[d]&&(t<n[d+1]||d===a-1)&&(s=(e.indexOf(n[d])+(t-n[d])/(n[d+1]-n[d]))/(i-1),u=!0),d++;return Math.floor(s*o)/o},t.PERMUT=function(e,t){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):a.FACT(e)/a.FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):Math.pow(e,t)},t.PHI=function(e){return(e=(0,h.parseNumber)(e))instanceof Error?Error(c.ERROR_VALUE):Math.exp(-.5*e*e)/2.5066282746310002},t.POISSON={},t.POISSON.DIST=function(e,t,r){return r=(0,h.parseBool)(r),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):r?s.poisson.cdf(e,t):s.poisson.pdf(e,t)},t.PROB=function(e,t,r,n){if(void 0===r)return 0;if(n=void 0===n?r:n,e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),r=(0,h.parseNumber)(r),n=(0,h.parseNumber)(n),(0,l.anyIsError)(e,t,r,n))return Error(c.ERROR_VALUE);if(r===n)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;for(var i=e.sort((function(e,t){return e-t})),a=i.length,o=0,s=0;s<a;s++)i[s]>=r&&i[s]<=n&&(o+=t[e.indexOf(i[s])]);return o},t.QUARTILE={},t.QUARTILE.EXC=function(e,r){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,r))return Error(c.ERROR_VALUE);switch(r){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return Error(c.ERROR_NUM)}},t.QUARTILE.INC=function(e,r){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,r))return Error(c.ERROR_VALUE);switch(r){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return Error(c.ERROR_NUM)}},t.RANK={},t.RANK.AVG=function(e,t,r){if(e=(0,h.parseNumber)(e),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e},i=(t=(t=(0,l.flatten)(t)).sort(n)).length,a=0,o=0;o<i;o++)t[o]===e&&a++;return a>1?(2*t.indexOf(e)+a+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,r){if(e=(0,h.parseNumber)(e),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e};return(t=t.sort(n)).indexOf(e)+1},t.ROW=function(e,t){return 2!==arguments.length?Error(c.ERROR_NA):t<0?Error(c.ERROR_NUM):e instanceof Array&&"number"==typeof t?0!==e.length?s.row(e,t):void 0:Error(c.ERROR_VALUE)},t.ROWS=function(e){return 1!==arguments.length?Error(c.ERROR_NA):e instanceof Array?0===e.length?0:s.rows(e):Error(c.ERROR_VALUE)},t.RSQ=function(e,r){return e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumberArray)((0,l.flatten)(r)),(0,l.anyIsError)(e,r)?Error(c.ERROR_VALUE):Math.pow(t.PEARSON(e,r),2)},t.SKEW=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t=s.mean(e),r=e.length,n=0,i=0;i<r;i++)n+=Math.pow(e[i]-t,3);return r*n/((r-1)*(r-2)*Math.pow(s.stdev(e,!0),3))},t.SKEW.P=function(){var e=(0,h.parseNumberArray)((0,l.flatten)(arguments));if(e instanceof Error)return e;for(var t=s.mean(e),r=e.length,n=0,i=0,a=0;a<r;a++)i+=Math.pow(e[a]-t,3),n+=Math.pow(e[a]-t,2);return n/=r,(i/=r)/Math.pow(n,1.5)},t.SLOPE=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=s.mean(t),n=s.mean(e),i=t.length,a=0,o=0,u=0;u<i;u++)a+=(t[u]-r)*(e[u]-n),o+=Math.pow(t[u]-r,2);return a/o},t.SMALL=function(e,t){return e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,r){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):(e-t)/r},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments);return Math.sqrt(e)},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments);return Math.sqrt(e)},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments);return Math.sqrt(e)},t.STEYX=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumberArray)((0,l.flatten)(t)),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);for(var r=s.mean(t),n=s.mean(e),i=t.length,a=0,o=0,u=0,f=0;f<i;f++)a+=Math.pow(e[f]-n,2),o+=(t[f]-r)*(e[f]-n),u+=Math.pow(t[f]-r,2);return Math.sqrt((a-o*o/u)/(i-2))},t.TRANSPOSE=function(e){return e?s.transpose(e):Error(c.ERROR_NA)},t.T=o.T,t.T.DIST=function(e,t,r){return r=(0,h.parseBool)(r),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):r?s.studentt.cdf(e,t):s.studentt.pdf(e,t)},t.T.DIST["2T"]=function(e,t){return 2!==arguments.length?Error(c.ERROR_NA):e<0||t<1?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t?Error(c.ERROR_VALUE):2*(1-s.studentt.cdf(e,t))},t.T.DIST.RT=function(e,t){return 2!==arguments.length?Error(c.ERROR_NA):e<0||t<1?Error(c.ERROR_NUM):"number"!=typeof e||"number"!=typeof t?Error(c.ERROR_VALUE):1-s.studentt.cdf(e,t)},t.T.INV=function(e,t){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),e<=0||e>1||t<1?Error(c.ERROR_NUM):(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):Math.abs(s.studentt.inv(e/2,t))},t.T.INV["2T"]=function(e,t){return e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),e<=0||e>1||t<1?Error(c.ERROR_NUM):(0,l.anyIsError)(e,t)?Error(c.ERROR_VALUE):Math.abs(s.studentt.inv(e/2,t))},t.T.TEST=function(e,r){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumberArray)((0,l.flatten)(r)),(0,l.anyIsError)(e,r))return Error(c.ERROR_VALUE);var n,i=s.mean(e),a=s.mean(r),o=0,u=0;for(n=0;n<e.length;n++)o+=Math.pow(e[n]-i,2);for(n=0;n<r.length;n++)u+=Math.pow(r[n]-a,2);o/=e.length-1,u/=r.length-1;var f=Math.abs(i-a)/Math.sqrt(o/e.length+u/r.length);return t.T.DIST["2T"](f,e.length+r.length-2)},t.TREND=function(e,r,n){e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumberArray)((0,l.flatten)(r));var i=t.LINEST(e,r);return i[0]*n+i[1]},t.TRIMMEAN=function(e,t){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),t=(0,h.parseNumber)(t),(0,l.anyIsError)(e,t))return Error(c.ERROR_VALUE);var r=a.FLOORMATH(e.length*t,2)/2;return s.mean(l.initial(l.rest(e.sort((function(e,t){return e-t})),r),r))},t.VAR={},t.VAR.P=function(){var e=l.numbers((0,l.flatten)(arguments));if(0===e.length)return Error(c.ERROR_VALUE);for(var r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return isNaN(n/r)?Error(c.ERROR_VALUE):n/r},t.VAR.S=function(){for(var e=l.numbers((0,l.flatten)(arguments)),r=e.length,n=0,i=t.AVERAGE(e),a=0;a<r;a++)n+=Math.pow(e[a]-i,2);return n/(r-1)},t.VARA=function(){for(var e=(0,l.flatten)(arguments),t=e.length,r=0,n=0,i=E(e),a=0;a<t;a++){var o=e[a];r+="number"==typeof o?Math.pow(o-i,2):!0===o?Math.pow(1-i,2):Math.pow(0-i,2),null!==o&&n++}return r/(n-1)},t.VARPA=function(){for(var e=(0,l.flatten)(arguments),r=e.length,n=0,i=0,a=t.AVERAGEA(e),o=0;o<r;o++){var s=e[o];n+="number"==typeof s?Math.pow(s-a,2):!0===s?Math.pow(1-a,2):Math.pow(0-a,2),null!==s&&i++}return n/i},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,r,n){return n=(0,h.parseBool)(n),e=(0,h.parseNumber)(e),t=(0,h.parseNumber)(t),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,t,r)?Error(c.ERROR_VALUE):n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},t.Z={},t.Z.TEST=function(e,r,n){if(e=(0,h.parseNumberArray)((0,l.flatten)(e)),r=(0,h.parseNumber)(r),(0,l.anyIsError)(e,r))return Error(c.ERROR_VALUE);n=n||t.STDEV.S(e);var i=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-r)/(n/Math.sqrt(i)),!0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ISERROR_=l,t.ISEVEN_=c,t.ISLOGICAL_=d,t.ISNA_=p,t.ISNONTEXT_=v,t.ISNUMBER_=g,t.ISODD_=b,t.ISREF_=A,t.ISTEXT_=w,t.N_=C,t.N=t.ISTEXT=t.ISREF=t.ISODD=t.ISNUMBER=t.ISNONTEXT=t.ISNA=t.ISLOGICAL=t.ISEVEN=t.ISERROR=t.ISERR=t.ISBLANK=void 0;var n=r(2),i=r(15);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){var t=n.errorMsgArr.indexOf(e)+1;return t>-1?t:Error(n.ERROR_NA)},t.INFO=function(){throw new Error("INFO is not implemented")};var a=new i.NotConvertExpFunction((function(e){return!!e.hasOwnProperty("cellVTypeName")&&["CellVEmpty","CellVError"].includes(e.cellVTypeName)}));function o(e){return n.errorMsgArr.indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}t.ISBLANK=a;var s=new i.NotConvertExpFunction(o);function l(e){return o(e)||e===Error(n.ERROR_NA)}t.ISERR=s;var u=new i.NotConvertExpFunction(l);function c(e){return!(1&Math.floor(Math.abs(e)))}t.ISERROR=u,t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)};var f=new i.NotConvertExpFunction(c);function d(e){return!0===e||"TRUE"===e||!1===e||"FALSE"===e}t.ISEVEN=f,t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")};var h=new i.NotConvertExpFunction(d);function p(e){return e===Error(n.ERROR_NA)||e===Error(n.ERROR_NA).message}t.ISLOGICAL=h;var m=new i.NotConvertExpFunction(p);function v(e){return"string"!=typeof e}t.ISNA=m;var y=new i.NotConvertExpFunction(v);function g(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}t.ISNONTEXT=y;var E=new i.NotConvertExpFunction(g);function b(e){return!!(1&Math.floor(Math.abs(e)))}t.ISNUMBER=E;var x=new i.NotConvertExpFunction(b);function A(e){return void 0!==e&&null!==arguments[0]}t.ISODD=x;var S=new i.NotConvertExpFunction(A);function w(e){return"string"==typeof e}t.ISREF=S;var R=new i.NotConvertExpFunction(w);function C(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)?e:e instanceof Date?e.getTime():!0===e||"TRUE"===e.toString().toUpperCase()||"FALSE"==e.toString().toUpperCase()?1:!1===e||"string"==typeof e?0:u(e)?e:0}t.ISTEXT=R;var T=new i.NotConvertExpFunction(C);t.N=T,t.NA=function(){return Error(n.ERROR_NA)},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){if("number"==typeof e&&!isNaN(e)&&isFinite(e))return 1;if("string"==typeof e){if("{"!=e.slice(0,1))return 2;var r=helper.strToMatrix(e);if(Array.isArray(r))return 64}return"FALSE"!=e&&(1==e||0==e?4:t.ISERR(e)||e===Error(n.ERROR_NA)?16:Array.isArray(arr)?64:void 0)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(19)),o=i(r(73)),s=r(45),l=r(20),u=i(r(144)),c=function(){function e(e,t){void 0===t&&(t=null),this.infos=e,this.mappings=[],this.cachedSourceMap=null,this.cachedTabWidth=void 0,a.default.ok(e.length>0),this.length=e.length,this.name=t||null,this.name&&this.mappings.push(new u.default(this,{start:this.firstPos(),end:this.lastPos()}))}return e.prototype.toString=function(e){return this.sliceString(this.firstPos(),this.lastPos(),e)},e.prototype.getSourceMap=function(e,t){if(!e)return null;var r=this;function n(r){return(r=r||{}).file=e,t&&(r.sourceRoot=t),r}if(r.cachedSourceMap)return n(r.cachedSourceMap.toJSON());var i=new o.default.SourceMapGenerator(n()),s={};return r.mappings.forEach((function(e){for(var t=e.sourceLines.skipSpaces(e.sourceLoc.start)||e.sourceLines.lastPos(),n=r.skipSpaces(e.targetLoc.start)||r.lastPos();l.comparePos(t,e.sourceLoc.end)<0&&l.comparePos(n,e.targetLoc.end)<0;){var o=e.sourceLines.charAt(t),u=r.charAt(n);a.default.strictEqual(o,u);var c=e.sourceLines.name;if(i.addMapping({source:c,original:{line:t.line,column:t.column},generated:{line:n.line,column:n.column}}),!d.call(s,c)){var f=e.sourceLines.toString();i.setSourceContent(c,f),s[c]=f}r.nextPos(n,!0),e.sourceLines.nextPos(t,!0)}})),r.cachedSourceMap=i,i.toJSON()},e.prototype.bootstrapCharAt=function(e){a.default.strictEqual(typeof e,"object"),a.default.strictEqual(typeof e.line,"number"),a.default.strictEqual(typeof e.column,"number");var t=e.line,r=e.column,n=this.toString().split(v),i=n[t-1];return void 0===i?"":r===i.length&&t<n.length?"\n":r>=i.length?"":i.charAt(r)},e.prototype.charAt=function(e){a.default.strictEqual(typeof e,"object"),a.default.strictEqual(typeof e.line,"number"),a.default.strictEqual(typeof e.column,"number");var t=e.line,r=e.column,n=this.infos[t-1],i=r;if(void 0===n||i<0)return"";var o=this.getIndentAt(t);return i<o?" ":(i+=n.sliceStart-o)===n.sliceEnd&&t<this.length?"\n":i>=n.sliceEnd?"":n.line.charAt(i)},e.prototype.stripMargin=function(t,r){if(0===t)return this;if(a.default.ok(t>0,"negative margin: "+t),r&&1===this.length)return this;var i=new e(this.infos.map((function(e,i){return e.line&&(i>0||!r)&&(e=n({},e,{indent:Math.max(0,e.indent-t)})),e})));if(this.mappings.length>0){var o=i.mappings;a.default.strictEqual(o.length,0),this.mappings.forEach((function(e){o.push(e.indent(t,r,!0))}))}return i},e.prototype.indent=function(t){if(0===t)return this;var r=new e(this.infos.map((function(e){return e.line&&!e.locked&&(e=n({},e,{indent:e.indent+t})),e})));if(this.mappings.length>0){var i=r.mappings;a.default.strictEqual(i.length,0),this.mappings.forEach((function(e){i.push(e.indent(t))}))}return r},e.prototype.indentTail=function(t){if(0===t)return this;if(this.length<2)return this;var r=new e(this.infos.map((function(e,r){return r>0&&e.line&&!e.locked&&(e=n({},e,{indent:e.indent+t})),e})));if(this.mappings.length>0){var i=r.mappings;a.default.strictEqual(i.length,0),this.mappings.forEach((function(e){i.push(e.indent(t,!0))}))}return r},e.prototype.lockIndentTail=function(){return this.length<2?this:new e(this.infos.map((function(e,t){return n({},e,{locked:t>0})})))},e.prototype.getIndentAt=function(e){return a.default.ok(e>=1,"no line "+e+" (line numbers start from 1)"),Math.max(this.infos[e-1].indent,0)},e.prototype.guessTabWidth=function(){if("number"==typeof this.cachedTabWidth)return this.cachedTabWidth;for(var e=[],t=0,r=1,n=this.length;r<=n;++r){var i=this.infos[r-1];if(!g(i.line.slice(i.sliceStart,i.sliceEnd))){var a=Math.abs(i.indent-t);e[a]=1+~~e[a],t=i.indent}}for(var o=-1,s=2,l=1;l<e.length;l+=1)d.call(e,l)&&e[l]>o&&(o=e[l],s=l);return this.cachedTabWidth=s},e.prototype.startsWithComment=function(){if(0===this.infos.length)return!1;var e=this.infos[0],t=e.sliceStart,r=e.sliceEnd,n=e.line.slice(t,r).trim();return 0===n.length||"//"===n.slice(0,2)||"/*"===n.slice(0,2)},e.prototype.isOnlyWhitespace=function(){return g(this.toString())},e.prototype.isPrecededOnlyByWhitespace=function(e){var t=this.infos[e.line-1],r=Math.max(t.indent,0),n=e.column-r;if(n<=0)return!0;var i=t.sliceStart,a=Math.min(i+n,t.sliceEnd);return g(t.line.slice(i,a))},e.prototype.getLineLength=function(e){var t=this.infos[e-1];return this.getIndentAt(e)+t.sliceEnd-t.sliceStart},e.prototype.nextPos=function(e,t){void 0===t&&(t=!1);var r=Math.max(e.line,0);return Math.max(e.column,0)<this.getLineLength(r)?(e.column+=1,!t||!!this.skipSpaces(e,!1,!0)):r<this.length&&(e.line+=1,e.column=0,!t||!!this.skipSpaces(e,!1,!0))},e.prototype.prevPos=function(e,t){void 0===t&&(t=!1);var r=e.line,n=e.column;if(n<1){if((r-=1)<1)return!1;n=this.getLineLength(r)}else n=Math.min(n-1,this.getLineLength(r));return e.line=r,e.column=n,!t||!!this.skipSpaces(e,!0,!0)},e.prototype.firstPos=function(){return{line:1,column:0}},e.prototype.lastPos=function(){return{line:this.length,column:this.getLineLength(this.length)}},e.prototype.skipSpaces=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=!1),e=e?r?e:{line:e.line,column:e.column}:t?this.lastPos():this.firstPos(),t){for(;this.prevPos(e);)if(!g(this.charAt(e))&&this.nextPos(e))return e;return null}for(;g(this.charAt(e));)if(!this.nextPos(e))return null;return e},e.prototype.trimLeft=function(){var e=this.skipSpaces(this.firstPos(),!1,!0);return e?this.slice(e):b},e.prototype.trimRight=function(){var e=this.skipSpaces(this.lastPos(),!0,!0);return e?this.slice(this.firstPos(),e):b},e.prototype.trim=function(){var e=this.skipSpaces(this.firstPos(),!1,!0);if(null===e)return b;var t=this.skipSpaces(this.lastPos(),!0,!0);return null===t?b:this.slice(e,t)},e.prototype.eachPos=function(e,t,r){void 0===t&&(t=this.firstPos()),void 0===r&&(r=!1);var n=this.firstPos();if(t&&(n.line=t.line,n.column=t.column),!r||this.skipSpaces(n,!1,!0))do{e.call(this,n)}while(this.nextPos(n,r))},e.prototype.bootstrapSlice=function(e,t){var r=this.toString().split(v).slice(e.line-1,t.line);return r.length>0&&(r.push(r.pop().slice(0,t.column)),r[0]=r[0].slice(e.column)),y(r.join("\n"))},e.prototype.slice=function(t,r){if(!r){if(!t)return this;r=this.lastPos()}if(!t)throw new Error("cannot slice with end but not start");var n=this.infos.slice(t.line-1,r.line);t.line===r.line?n[0]=E(n[0],t.column,r.column):(a.default.ok(t.line<r.line),n[0]=E(n[0],t.column),n.push(E(n.pop(),0,r.column)));var i=new e(n);if(this.mappings.length>0){var o=i.mappings;a.default.strictEqual(o.length,0),this.mappings.forEach((function(e){var n=e.slice(this,t,r);n&&o.push(n)}),this)}return i},e.prototype.bootstrapSliceString=function(e,t,r){return this.slice(e,t).toString(r)},e.prototype.sliceString=function(e,t,r){void 0===e&&(e=this.firstPos()),void 0===t&&(t=this.lastPos());for(var n=[],i=(r=s.normalize(r)).tabWidth,a=void 0===i?2:i,o=e.line;o<=t.line;++o){var l=this.infos[o-1];o===e.line?l=o===t.line?E(l,e.column,t.column):E(l,e.column):o===t.line&&(l=E(l,0,t.column));var u=Math.max(l.indent,0),c=l.line.slice(0,l.sliceStart);if(r.reuseWhitespace&&g(c)&&p(c,r.tabWidth)===u)n.push(l.line.slice(0,l.sliceEnd));else{var f=0,d=u;r.useTabs&&(d-=(f=Math.floor(u/a))*a);var h="";f>0&&(h+=new Array(f+1).join("\t")),d>0&&(h+=new Array(d+1).join(" ")),h+=l.line.slice(l.sliceStart,l.sliceEnd),n.push(h)}}return n.join(r.lineTerminator)},e.prototype.isEmpty=function(){return this.length<2&&this.getLineLength(1)<1},e.prototype.join=function(t){var r,i=this,a=[],o=[];function s(e){if(null!==e){if(r){var t=e.infos[0],i=new Array(t.indent+1).join(" "),s=a.length,l=Math.max(r.indent,0)+r.sliceEnd-r.sliceStart;r.line=r.line.slice(0,r.sliceEnd)+i+t.line.slice(t.sliceStart,t.sliceEnd),r.locked=r.locked||t.locked,r.sliceEnd=r.line.length,e.mappings.length>0&&e.mappings.forEach((function(e){o.push(e.add(s,l))}))}else e.mappings.length>0&&o.push.apply(o,e.mappings);e.infos.forEach((function(e,t){(!r||t>0)&&(r=n({},e),a.push(r))}))}}if(t.map((function(e){var t=y(e);return t.isEmpty()?null:t})).forEach((function(e,t){i.isEmpty()?s(e):function(e,t){t>0&&s(i),s(e)}(e,t)})),a.length<1)return b;var l=new e(a);return l.mappings=o,l},e.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=[this];return r.push.apply(r,e),a.default.strictEqual(r.length,e.length+1),b.join(r)},e}();t.Lines=c;var f={},d=f.hasOwnProperty,h=10;function p(e,t){for(var r=0,n=e.length,i=0;i<n;++i)switch(e.charCodeAt(i)){case 9:a.default.strictEqual(typeof t,"number"),a.default.ok(t>0);var o=Math.ceil(r/t)*t;o===r?r+=t:r=o;break;case 11:case 12:case 13:case 65279:break;case 32:default:r+=1}return r}t.countSpaces=p;var m=/^\s*/,v=/\u000D\u000A|\u000D(?!\u000A)|\u000A|\u2028|\u2029/;function y(e,t){if(e instanceof c)return e;e+="";var r=t&&t.tabWidth,n=e.indexOf("\t")<0,i=!t&&n&&e.length<=h;if(a.default.ok(r||n,"No tab width specified but encountered tabs in string\n"+e),i&&d.call(f,e))return f[e];var o=new c(e.split(v).map((function(e){var t=m.exec(e)[0];return{line:e,indent:p(t,r),locked:!1,sliceStart:t.length,sliceEnd:e.length}})),s.normalize(t).sourceFileName);return i&&(f[e]=o),o}function g(e){return!/\S/.test(e)}function E(e,t,r){var n=e.sliceStart,i=e.sliceEnd,o=Math.max(e.indent,0),s=o+i-n;return void 0===r&&(r=s),t=Math.max(t,0),r=Math.min(r,s),(r=Math.max(r,t))<o?(o=r,i=n):i-=s-r,s=r,s-=t,t<o?o-=t:(t-=o,o=0,n+=t),a.default.ok(o>=0),a.default.ok(n<=i),a.default.strictEqual(s,o+i-n),e.indent===o&&e.sliceStart===n&&e.sliceEnd===i?e:{line:e.line,indent:o,locked:!1,sliceStart:n,sliceEnd:i}}t.fromString=y,t.concat=function(e){return b.join(e)};var b=y("")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9),i=r(4);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ri=t,this.ci=r,this.cell=n,this.expr=i,this.empty=a}var t,r,s;return t=e,(r=[{key:"isInclude",value:function(){}},{key:"each",value:function(e){var t=this.cell;if(!1!==(0,n.isHave)(t.depend))for(var r=0;r<t.depend.length;r++){var o=t.depend[r],s=a((0,i.expr2xy)(o),2),l=s[0];e(s[1],l)}}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lockCells=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=this.data,s=this.editor,l=e.offsetX,f=e.offsetY,d=i.getCellRectByXY(l,f),h=d.ri,m=d.ci,v=s.pos,y=s.editorText.getText(),g="";s.handler(y);var E=s.mousedownIndex;if((0,a.isAbsoluteValue)((0,a.cuttingByPos)(y,v),2)||t)if(t){var b=t.selector.range,x=b.sri,A=b.sci,S=b.eri,w=b.eci,R=(0,o.xy2expr)(A,x),C=(0,o.xy2expr)(w,S),T=R===C?R:"".concat(R,":").concat(C);if(2===r){var O=(0,a.value2absolute)(R),_=(0,a.value2absolute)(C);T=O.s1===_.s1?O.s1:"".concat(O.s1,":").concat(_.s1)}else if(1===r){var D=(0,a.value2absolute)(R),N=(0,a.value2absolute)(C);T=D.s2===N.s2?D.s2:"".concat(D.s2,":").concat(N.s2)}else if(3===r){var k=(0,a.value2absolute)(R),M=(0,a.value2absolute)(C);T=k.s3===M.s3?k.s3:"".concat(k.s3,":").concat(M.s3)}t.erpx=T,s.isCors&&(v=1);var I=-1!==n?n:v-(0,a.cuttingByPos)(y,v).length;g=y.substring(0,I)+T+y.substring(v,y.length),s.setText(g),s.setCursorPos(y.substring(0,I).length+T.length)}else for(var P=0,F=0;F<this.selectors.length&&0===P;F++){var L=this.selectors[F].erpx;if(L===(0,a.cuttingByPos)(y,v)){var j=d.ri,B=d.ci;this.selectors[F].ri=j,this.selectors[F].ci=B,this.selectors[F].erpx=(0,o.xy2expr)(B,j),this.selectors[F].selector.set(j,B),g="".concat(y.substring(0,v-L.length)).concat((0,o.xy2expr)(B,j)).concat(y.substring(v,y.length)),s.setText(g),s.setCursorPos(y.substring(0,v-L.length).length+(0,o.xy2expr)(B,j).length),P=1}}else if(E.length>0){if((0,a.operation)(E[1][0])&&(0,a.isAbsoluteValue)((0,a.cuttingByPos)(E[1],E[1].length),2))return void s.setLock(!1);var U=c.call(this,h,m);this.selectors.push(U);var V=(g="".concat(E[0]).concat((0,o.xy2expr)(m,h)).concat(E[1])).substring(E[0].length+(0,o.xy2expr)(m,h).length,g.length),H=(0,a.cutFirst)(V.substring(1));if((0,a.operation)(V[0])&&!(0,a.isAbsoluteValue)(H,2))return s.setText(g),void s.setMouseDownIndex([]);H=(0,a.cutFirst)(E[1]),console.log((0,o.xy2expr)(m,h));var z=(0,a.cutStr)("".concat(E[0]).concat((0,o.xy2expr)(m,h),"+4").concat(E[1])),X=u.call(this,z),q=X.selectors_delete,W=X.selectors_new;Object.keys(q).forEach((function(e){q[e].removeEl()})),this.selectors=W,g=g.replace(H,""),s.setText(g),s.setCursorPos(E[0].length+(0,o.xy2expr)(m,h).length)}else{var G=s.pos,Y=t||c.call(this,h,m);if(-1!==G){for(var J="",$=!1,K=G,Q="",Z=G;Z<y.length;Z++)Q+=y[Z];for(var ee=(0,a.cutFirst)(Q).length,te=0;te<y.length;te++)G===te&&($=!0,J+=(0,o.xy2expr)(m,h)),K===te&&ee>0?(K+=1,ee-=1):J+=y[te];if(t){var re=i.selector.range,ne=re.sri,ie=re.sci,ae=re.eri,oe=re.eci,se=(0,o.xy2expr)(ie,ne),le=(0,o.xy2expr)(oe,ae);g=se===le?se:"".concat(se,":").concat(le),J=$?J:J+g}else this.selectors.push(Y),J=$?J:J+(0,o.xy2expr)(m,h);s.setText(J),s.setCursorPos(J.length),s.parse()}else this.selectors.push(Y),g="".concat(y).concat((0,o.xy2expr)(m,h)),s.setText(g)}if(s.parse(s.pos),this.selectors.length>0||t){var ue=s.editorText.getText(),ce=!1,fe=this.data.merges;Object.keys(fe._).forEach((function(e){for(var t=fe._[e],r=(0,a.cutStr)(ue,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],l=(0,o.expr2xy)(i),u=(0,o.expr2xy)(s);t.sci>=l[0]&&t.sri>=l[1]&&t.eci<=u[0]&&t.eri<=u[1]&&(ue=ue.replace(new RegExp(r[n],"g"),i),ce=!0)}})),p.call(this,(0,a.cutting)(ue),(0,a.cutting2)(ue)),ce&&setTimeout((function(){s.setCursorPos(ue.length)}),10)}},t.clearSelectors=function(){this.selectorsEl.html(""),this.selectors=[];var e=this.editor,t=this.selector;e.setLock(!1),e.state=1,t.el.show()},t.editingSelectors=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("number"==typeof t)return;var r=(0,a.cutStr)(t,!0),n=u.call(this,r).selectors_delete;Object.keys(n).forEach((function(e){n[e].removeEl()}));var i=[];Object.keys(r).forEach((function(t){var n=1;Object.keys(e.selectors).forEach((function(t){e.selectors[t].selector.el.removeEl()}));var s="",l=r[t].replace(/\$/g,"");if((0,a.isAbsoluteValue)(r[t])){var u=r[t].replace(/\$/g,"");s=(0,o.expr2xy)(u)}else-1!==l.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)?n=2:s=(0,o.expr2xy)(r[t]);if(1===n){var f=s[1],d=s[0],h=c.call(e,f,d,i);h.erpx=r[t],i.push(h)}else if(2===n){var p=r[t].replace(/\$/g,"").split(":")[0],m=r[t].replace(/\$/g,"").split(":")[1],v=(0,o.expr2xy)(p),y=(0,o.expr2xy)(m),g=c.call(e,v[1],v[0],i,!0,null,!1);(g=c.call(e,y[1],y[0],i,!0,g.selector,!0)).erpx=r[t],i.push(g)}})),this.selectors=i,(this.selectors.length>0||"="===t[0])&&p.call(this,(0,a.cutting)(t),(0,a.cutting2)(t))},t.findBracket=function(e,t,r){var n={left:0,right:0,exist:!1};if(")"!==r[e])return n;var i=e,a=f.call(this,t,i);-1!==a&&-1!==i&&(n={left:a,right:i,exist:!0});return n},t.suggestContent=h,t.makeSelector=c;var n,i=(n=r(162))&&n.__esModule?n:{default:n},a=r(7),o=r(4),s=r(84),l=r(0);function u(e){var t=this,r=[],n=[];return Object.keys(this.selectors).forEach((function(i){for(var a=t.selectors[i],o=a.erpx,s=0,l=0;l<e.length&&0===s;l++)e[l].replace(/\$/g,"")===o&&(s=1,r.push(a));0===s&&n.push(a.selector.el)})),{selectors_delete:n,selectors_new:r}}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=this.data,f=null,d=this.editor.editorText.getText(),h=(0,s.selectorColor)(r.length),p=h.color,m=h.index;if(l)f=l;else{var v="selector".concat(999999*Math.random());(f=new i.default(c,this,v)).el.attr("class","".concat(v," clear_selector")),f.setCss(p)}n?u?f.setEnd(e,t):f.set(e,t,!0):f.set(e,t,!1),f.el.css("z-index","100");var y=d.split((0,o.xy2expr)(t,e)).length-2,g=(0,o.xy2expr)(t,e),E=c.merges;Object.keys(E._).forEach((function(e){for(var t=E._[e],r=(0,a.cutStr)(g,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],l=(0,o.expr2xy)(i),u=(0,o.expr2xy)(s);t.sci>=l[0]&&t.sri>=l[1]&&t.eci<=u[0]&&t.eri<=u[1]&&(g=g.replace(new RegExp(r[n],"g"),i))}}));var b={ri:e,ci:t,index:y,color:p,index2:m,className:f.el.el.className,erpx:g,selector:f};return u||(f.el.show(),this.selectorsEl.child(f.el)),n?b:(this.selectorsEl.child(f.el),b)}function f(e,t){for(var r=-1,n=0,i=!1,a=t-1;a>0&&!1===i;a--)"("===e[a]&&(i=!0),")"===e[a]&&n++;for(var o=t;o>0&&-1===r;o--)"("===e[o]&&(0===n&&(r=o),n--);return r}function d(e,t){for(var r=-1,n=0,i=!1,a=t+1;a<e.length&&!1===i;a++)")"===e[a]&&(i=!0),"("===e[a]&&n++;for(var o=t;o<e.length&&-1===r;o++)")"===e[o]&&(0===n&&(r=o),n--);return r}function h(e,t,r){var n={suggestContent:!1,cut:"",pos:1},i=e-1,o=f.call(this,t,i),s=d.call(this,t,o);o<=i&&-1!==o&&(s>=i||-1===s)&&(n.suggestContent=!0,n.cut=(0,a.cuttingByPos)(r,o));for(var l=o;l<i+1;l++)","===r[l]&&(n.pos+=2);return n}function p(e,t){var r=this.editor,n=[],i=-1,a=-1;Object.keys(e).forEach((function(r){var i=(0,l.h)("span","formula_span".concat(r));Object.keys(t).forEach((function(){if(t[r]&&-1!==t[r].code&&t[r].data===e[r]){var n=(0,s.selectorColor)(t[r].code).color;i.css("color",n)}})),i.css("display","inline-block"),i.css("cursor","text")," "===e[r]?i.html("&emsp;"):i.html(e[r]),n.push(i)}));var o=r.pos,u=r.editorText.getText(),c={suggestContent:!1,cut:""};if(")"===u[o-1]?(i=o-1,a=f.call(this,e,i)):c=h.call(this,o+1,e,u),""!==u&&n.length<=0){var d=(0,l.h)("span","formula_span");n.push(d)}r.mount2span(n,i,a,c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontSizePxByPt=function(e){for(var t=0;t<n.length;t+=1){var r=n[t];if(r.pt===e)return r.px}return e},t.baseFonts=t.fontSizes=void 0;t.baseFonts=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}];var n=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];t.fontSizes=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testValid=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.valid;(0,n.isHave)(e)&&e.assert()};var n=r(9)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewLocRefactorBhv=t.UserMoveRefactorBhv=t.calc=void 0;var n=r(93),i=r(113);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}var d={};t.calc=d,d.Calc=n.Calc,d.allFnObj=i.allFnObj,d.fnNameArrayWithKey=i.fnNameArrayWithKey;var h=function(){function e(t,r,n){u(this,e),this.argsForAA=t,this.argsForA1=r,this.argsForA1B2=n}return f(e,[{key:"getArgsForAAUnit",value:function(e){return this.argsForAA}},{key:"getArgsForA1Unit",value:function(e){return this.argsForA1}},{key:"getArgsForA1B1Unit",value:function(e){return this.argsForA1B2}},{key:"dealAA",value:function(e){e.updateByUserMove(this.getArgsForAAUnit(e),!0)}},{key:"dealA1",value:function(e){e.updateByUserMove(this.getArgsForA1Unit(e),!0)}},{key:"dealA1B2",value:function(e){e.updateByUserMove(this.getArgsForA1B1Unit(e),!0)}}]),e}();t.UserMoveRefactorBhv=h;var p=function(e){function t(){return u(this,t),o(this,s(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),f(t,[{key:"dealAA",value:function(e){e.updateByNewLoc(this.getArgsForAAUnit(e),!0)}},{key:"dealA1",value:function(e){e.updateByNewLoc(this.getArgsForA1Unit(e),!0)}},{key:"dealA1B2",value:function(e){e.updateByNewLoc(this.getArgsForA1B1Unit(e),!0)}}]),t}(h);t.NewLocRefactorBhv=p},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ColIndexProxy=void 0;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"number"==typeof t?(this.colNum=t,this.colStr=this.colNum2Str()):(this.colStr=t,this.colNum=this.colStr2Num())}var t,r,i;return t=e,(r=[{key:"colNum2Str",value:function(){for(var e,t=this.colNum+1,r="",n=10;t>0&&n--;)e=(t-1)%26,r=String.fromCharCode(e+65)+r,t=(t-e-1)/26;return r}},{key:"colStr2Num",value:function(){for(var e=0,t=this.colStr.replace(/[0-9]+$/,""),r=t.length;r--;)e+=Math.pow(26,t.length-r-1)*(t.charCodeAt(r)-64);return e-1}}])&&n(t.prototype,r),i&&n(t,i),e}();t.ColIndexProxy=i},function(module,exports,__webpack_require__){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ASC=ASC,exports.CLEAN=CLEAN,exports.CODE=CODE,exports.DOLLAR=DOLLAR,exports.EXACT=EXACT,exports.FIND=FIND,exports.INDEX=INDEX,exports.LEFT=LEFT,exports.LEN=LEN,exports.LOWER=LOWER,exports.MID=MID,exports.CHAR=void 0;var utils=_interopRequireWildcard(__webpack_require__(11)),_error_config=__webpack_require__(2),_numeral=_interopRequireDefault(__webpack_require__(57)),_parse_helper=__webpack_require__(17),_exp_function_warp=__webpack_require__(15);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function ASC(e){var t="";e=e.toString();for(var r=0;r<e.length;r++)e.charCodeAt(r)>65248&&e.charCodeAt(r)<65375?t+=String.fromCharCode(e.charCodeAt(r)-65248):t+=String.fromCharCode(e.charCodeAt(r));return t}function CHAR_(e){return e=(0,_parse_helper.parseNumber)(e),String.fromCharCode(e)}exports.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")};var CHAR=new _exp_function_warp.OnlyNumberExpFunction(CHAR_);function CLEAN(e){return(e=e||"").replace(/[\0-\x1F]/g,"")}function CODE(e){return(e=e||"").charCodeAt(0)}function DOLLAR(e,t){if(t=void 0===t?2:t,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var r="";return t<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),r="($0,0)"):t>0&&(r="($0,0."+new Array(t+1).join("0")+")"),(0,_numeral.default)(e).format(r)}function EXACT(e,t){return e===t}function FIND(e,t,r){return r=void 0===r?0:r,t.indexOf(e),t?t.indexOf(e,r-1)+1:null}function INDEX(e,t,r){return"string"==typeof e&&(e=(0,utils.strToMatrix)(e)),e[t][r-1]}function LEFT(e,t){return t=void 0===t?1:t,(t=(0,_parse_helper.parseNumber)(t))instanceof Error||"string"!=typeof e?Error(_error_config.ERROR_VALUE):e?e.substring(0,t):null}function LEN(e){return 0===arguments.length?Error:"string"==typeof e?e?e.length:0:e.length?e.length:Error(_error_config.ERROR_VALUE)}function LOWER(e){return"string"!=typeof e?Error(_error_config.ERROR_VALUE):e?e.toLowerCase():e}function MID(e,t,r){if(t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),(0,utils.anyIsError)(t,r)||"string"!=typeof e)return r;if(t<1||r<0)return Error(_error_config.ERROR_VALUE);var n=t-1,i=n+r;return e.substring(n,i)}function num2e(e){var t=Math.floor(Math.log(e)/Math.LN10),r=e*Math.pow(10,-t);return t.toString().length<10&&(t="0"+t),r+"E+"+t}function allzero(e){e=e.toString();for(var t=0;t<e.length;t++)if("0"!==e[t])return!1;return!0}function decimalsToFractional(e){formatDecimals=e.toFixed(2);var t=3,r=3*formatDecimals;return function e(){for(var n=t>r?t:r;n>1;n--)Number.isInteger(r/n)&&Number.isInteger(t/n)&&(r/=n,t/=n,e())}(),r=parseInt(r),"".concat(r,"/").concat(t)}exports.CHAR=CHAR,exports.CONCATE=function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var r=0;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")},exports.CONCATENATE=function(){for(var e=utils.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var r=0;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")},exports.DBCS=function(){throw new Error("DBCS is not implemented")},exports.FIXED=function(e,t,r){if(t=void 0===t?2:t,r=void 0!==r&&r,e=(0,_parse_helper.parseNumber)(e),t=(0,_parse_helper.parseNumber)(t),(0,utils.anyIsError)(e,t))return Error(_error_config.ERROR_VALUE);var n=r?"0":"0,0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(n+="."+new Array(t+1).join("0")),(0,_numeral.default)(e).format(n)},exports.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},exports.NUMBERVALUE=function(e,t,r){return t=void 0===t?".":t,r=void 0===r?",":r,e.indexOf("%")>0?(e=e.replace("%",""),parseFloat(e)/100):Number(e.replace(t,".").replace(r,""))},exports.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},exports.PROPER=function(e){return void 0===e||0===e.length?Error(_error_config.ERROR_VALUE):(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?Error(_error_config.ERROR_VALUE):("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},exports.REGEXEXTRACT=function(e,t){var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null},exports.REGEXMATCH=function(e,t,r){var n=e.match(new RegExp(t));return r?n:!!n},exports.REGEXREPLACE=function(e,t,r){return e.replace(new RegExp(t),r)},exports.REPLACE=function(e,t,r,n){return t=(0,_parse_helper.parseNumber)(t),r=(0,_parse_helper.parseNumber)(r),(0,utils.anyIsError)(t,r)||"string"!=typeof e||"string"!=typeof n?Error(_error_config.ERROR_VALUE):e.substr(0,t-1)+n+e.substr(t-1+r)},exports.REPT=function(e,t){return t=(0,_parse_helper.parseNumber)(t),new Array(t+1).join(e)},exports.RIGHT=function(e,t){return t=void 0===t?1:t,(t=(0,_parse_helper.parseNumber)(t))instanceof Error?t:e?e.substring(e.length-t):null},exports.SEARCH=function(e,t,r){var n;return"string"!=typeof e||"string"!=typeof t?Error(_error_config.ERROR_VALUE):(r=void 0===r?0:r,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1)?Error(_error_config.ERROR_VALUE):n)},exports.SPLIT=function(e,t){return e.split(t)},exports.SUBSTITUTE=function(e,t,r,n){if(!(e&&t&&r))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),r);for(var i=0,a=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++a===n)return e.substring(0,i)+r+e.substring(i+t.length)},exports.T=function(e){return"TRUE"==e||"FALSE"==e?"":"string"==typeof e?e:""},exports.TEXT=function(value,format){try{if(format.indexOf("%")>=0){var fixed=format.split(".")[1].length-1;return(100*parseFloat(value)).toFixed(fixed)+"%"}var Formulas=window.jsSpreadsheet.AllFormulas,_result=Formulas.TEXT(value,format);console.log(_result)}catch(e){var _result2=void 0}if(null==result){if(format.indexOf("#")>=0&&format.indexOf("?/?")>=0){var x=parseFloat(value)-parseInt(value);return 0!==parseInt(value)?parseInt(value)+" "+decimalsToFractional(x):decimalsToFractional(x)}if(format.indexOf("E+")>=0)return num2e(value);if(allzero(value)){for(var _result3="",i=0;i<format.length-value.length;i++)_result3+="0";return _result3+value}if(format.indexOf("#")>=0){var fmt=format;if(format.indexOf("[")>=0&&format.indexOf(";")>=0){var valid=format.split("#")[0];fmt=format.split("]")[1].split(";"),valid=valid.replace("[","").replace("]",""),fmt=eval(value+valid)?fmt[0]:fmt[1]}if(format.indexOf("#")>=0&&format.indexOf(!1)&&format.indexOf("0")>=0&&format.indexOf("°")<=0){value.toString().split(".")[1].length>format.split(".")[1].length&&(value=value.toFixed(format.split(".")[1].length)),value=value.toString();for(var _result5="",_n=0,_i=0;_i<fmt.length;_i++)"#"==fmt[_i]||"0"==fmt[_i]||"."==fmt[_i]?(_result5+=value[_n],_n+=1):_result5+=fmt[_i];return _result5}fmt=fmt.replace("##0","##"),value=value.toString();for(var _result4="",n=0,_i2=0;_i2<fmt.length;_i2++)"#"==fmt[_i2]||"0"==fmt[_i2]?(_result4+=value[n],n+=1):_result4+=fmt[_i2];return _result4}}return result},exports.TRIM=function(e){return"string"!=typeof e?Error(_error_config.ERROR_VALUE):e.replace(/ +/g," ").trim()},exports.UNICHAR=function(e){return 0==e?Error(_error_config.ERROR_VALUE):String.fromCharCode(e)},exports.UNICODE=function(e){return e.charCodeAt(0)},exports.UPPER=function(e){return"string"!=typeof e?Error(_error_config.ERROR_VALUE):e.toUpperCase()},exports.VALUE=function(e){return"string"!=typeof e?Error(_error_config.ERROR_VALUE):(0,_numeral.default)().unformat(e)}},function(e,t,r){var n;e.exports=(function(e,t){var r=e.utils.isFunction;function n(e,t){return e-t}function i(e,r,n){return t.max(r,t.min(e,n))}e.sum=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.sumsqrd=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r]*e[r];return t},e.sumsqerr=function(t){for(var r,n=e.mean(t),i=0,a=t.length;--a>=0;)i+=(r=t[a]-n)*r;return i},e.sumrow=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.product=function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t},e.min=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]<t&&(t=e[r]);return t},e.max=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]>t&&(t=e[r]);return t},e.unique=function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(r){return t.pow(e.product(r),1/r.length)},e.median=function(e){var t=e.length,r=e.slice().sort(n);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,r=[],n=e.length;for(t=1;t<n;t++)r.push(e[t]-e[t-1]);return r},e.rank=function(e){for(var t,r=e.length,i=e.slice().sort(n),a=new Array(r),o=0;o<r;o++){var s=i.indexOf(e[o]),l=i.lastIndexOf(e[o]);t=s===l?s:(s+l)/2,a[o]=t+1}return a},e.mode=function(e){var t,r=e.length,i=e.slice().sort(n),a=1,o=0,s=0,l=[];for(t=0;t<r;t++)i[t]===i[t+1]?a++:(a>o?(l=[i[t]],o=a,s=0):a===o&&(l.push(i[t]),s++),a=1);return 0===s?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,r){return e.sumsqerr(t)/(t.length-(r?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,r){return t+e.sumsqerr(r)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var r=e.mean(t),n=t.length,i=new Array(n),a=0;a<n;a++)i[a]=t[a]-r;return i},e.stdev=function(r,n){return t.sqrt(e.variance(r,n))},e.pooledstdev=function(r){return t.sqrt(e.pooledvariance(r))},e.meandev=function(r){for(var n=e.mean(r),i=[],a=r.length-1;a>=0;a--)i.push(t.abs(r[a]-n));return e.mean(i)},e.meddev=function(r){for(var n=e.median(r),i=[],a=r.length-1;a>=0;a--)i.push(t.abs(r[a]-n));return e.median(i)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var r=e.length,i=e.slice().sort(n);return[i[t.round(r/4)-1],i[t.round(r/2)-1],i[t.round(3*r/4)-1]]},e.quantiles=function(e,r,a,o){var s,l,u,c,f,d=e.slice().sort(n),h=[r.length],p=e.length;for(void 0===a&&(a=3/8),void 0===o&&(o=3/8),s=0;s<r.length;s++)u=p*(l=r[s])+(a+l*(1-a-o)),c=t.floor(i(u,1,p-1)),f=i(u-c,0,1),h[s]=(1-f)*d[c-1]+f*d[c];return h},e.percentile=function(e,t,r){var i=e.slice().sort(n),a=t*(i.length+(r?1:-1))+(r?0:1),o=parseInt(a),s=a-o;return o+1<i.length?i[o-1]+s*(i[o]-i[o-1]):i[o-1]},e.percentileOfScore=function(e,t,r){var n,i,a=0,o=e.length,s=!1;for("strict"===r&&(s=!0),i=0;i<o;i++)n=e[i],(s&&n<t||!s&&n<=t)&&a++;return a/o},e.histogram=function(r,n){n=n||4;var i,a=e.min(r),o=(e.max(r)-a)/n,s=r.length,l=[];for(i=0;i<n;i++)l[i]=0;for(i=0;i<s;i++)l[t.min(t.floor((r[i]-a)/o),n-1)]+=1;return l},e.covariance=function(t,r){var n,i=e.mean(t),a=e.mean(r),o=t.length,s=new Array(o);for(n=0;n<o;n++)s[n]=(t[n]-i)*(r[n]-a);return e.sum(s)/(o-1)},e.corrcoeff=function(t,r){return e.covariance(t,r)/e.stdev(t,1)/e.stdev(r,1)},e.spearmancoeff=function(t,r){return t=e.rank(t),r=e.rank(r),e.corrcoeff(t,r)},e.stanMoment=function(r,n){for(var i=e.mean(r),a=e.stdev(r),o=r.length,s=0,l=0;l<o;l++)s+=t.pow((r[l]-i)/a,n);return s/r.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var a=e.prototype;!function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(n,i){var o=[],s=0,l=this;if(r(n)&&(i=n,n=!1),i)return setTimeout((function(){i.call(l,a[t].call(l,n))})),this;if(this.length>1){for(l=!0===n?this:this.transpose();s<l.length;s++)o[s]=e[t](l[s]);return o}return e[t](this[0],n)}}(t[n])}("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(n,i){var o=[],s=0,l=this;if(r(n)&&(i=n,n=!1),i)return setTimeout((function(){i.call(l,a[t].call(l,n))})),this;if(this.length>1){for("sumrow"!==t&&(l=!0===n?this:this.transpose());s<l.length;s++)o[s]=e[t](l[s]);return!0===n?e[t](e.utils.toVector(o)):o}return e[t](this[0],n)}}(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){a[t]=function(){var n,i=[],o=0,s=this,l=Array.prototype.slice.call(arguments);if(r(l[l.length-1])){n=l[l.length-1];var u=l.slice(0,l.length-1);return setTimeout((function(){n.call(s,a[t].apply(s,u))})),this}n=void 0;var c=function(r){return e[t].apply(s,[r].concat(l))};if(this.length>1){for(s=s.transpose();o<s.length;o++)i[o]=c(s[o]);return i}return c(this[0])}}(t[n])}("quantiles percentileOfScore".split(" "))}(n=function(e,t){var r=Array.prototype.concat,n=Array.prototype.slice,i=Object.prototype.toString;function a(t,r){var n=t>r?t:r;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}var o=Array.isArray||function(e){return"[object Array]"===i.call(e)};function s(e){return"[object Function]"===i.call(e)}function l(e){return"number"==typeof e&&e-e==0}function u(){return new u._init(arguments)}function c(){return 0}function f(){return 1}function d(e,t){return e===t?1:0}u.fn=u.prototype,u._init=function(e){if(o(e[0]))if(o(e[0][0])){s(e[1])&&(e[0]=u.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=s(e[1])?u.map(e[0],e[1]):e[0],this.length=1;else if(l(e[0]))this[0]=u.seq.apply(null,e),this.length=1;else{if(e[0]instanceof u)return u(e[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:a,isArray:o,isFunction:s,isNumber:l,toVector:function(e){return r.apply([],e)}},u._random_fn=e.random,u.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");u._random_fn=e},u.extend=function(e){var t,r;if(1===arguments.length){for(r in e)u[r]=e[r];return this}for(t=1;t<arguments.length;t++)for(r in arguments[t])e[r]=arguments[t][r];return e},u.rows=function(e){return e.length||1},u.cols=function(e){return e[0].length||1},u.dimensions=function(e){return{rows:u.rows(e),cols:u.cols(e)}},u.row=function(e,t){return o(t)?t.map((function(t){return u.row(e,t)})):e[t]},u.rowa=function(e,t){return u.row(e,t)},u.col=function(e,t){if(o(t)){var r=u.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,n){u.arange(e.length).forEach((function(i){r[i][n]=e[i][t]}))})),r}for(var n=new Array(e.length),i=0;i<e.length;i++)n[i]=[e[i][t]];return n},u.cola=function(e,t){return u.col(e,t).map((function(e){return e[0]}))},u.diag=function(e){for(var t=u.rows(e),r=new Array(t),n=0;n<t;n++)r[n]=[e[n][n]];return r},u.antidiag=function(e){for(var t=u.rows(e)-1,r=new Array(t),n=0;t>=0;t--,n++)r[n]=[e[n][t]];return r},u.transpose=function(e){var t,r,n,i,a,s=[];for(o(e[0])||(e=[e]),r=e.length,n=e[0].length,a=0;a<n;a++){for(t=new Array(r),i=0;i<r;i++)t[i]=e[i][a];s.push(t)}return 1===s.length?s[0]:s},u.map=function(e,t,r){var n,i,a,s,l;for(o(e[0])||(e=[e]),i=e.length,a=e[0].length,s=r?e:new Array(i),n=0;n<i;n++)for(s[n]||(s[n]=new Array(a)),l=0;l<a;l++)s[n][l]=t(e[n][l],n,l);return 1===s.length?s[0]:s},u.cumreduce=function(e,t,r){var n,i,a,s,l;for(o(e[0])||(e=[e]),i=e.length,a=e[0].length,s=r?e:new Array(i),n=0;n<i;n++)for(s[n]||(s[n]=new Array(a)),a>0&&(s[n][0]=e[n][0]),l=1;l<a;l++)s[n][l]=t(s[n][l-1],e[n][l]);return 1===s.length?s[0]:s},u.alter=function(e,t){return u.map(e,t,!0)},u.create=function(e,t,r){var n,i,a=new Array(e);for(s(t)&&(r=t,t=e),n=0;n<e;n++)for(a[n]=new Array(t),i=0;i<t;i++)a[n][i]=r(n,i);return a},u.zeros=function(e,t){return l(t)||(t=e),u.create(e,t,c)},u.ones=function(e,t){return l(t)||(t=e),u.create(e,t,f)},u.rand=function(e,t){return l(t)||(t=e),u.create(e,t,u._random_fn)},u.identity=function(e,t){return l(t)||(t=e),u.create(e,t,d)},u.symmetric=function(e){var t,r,n=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<n;t++)for(r=0;r<n;r++)if(e[r][t]!==e[t][r])return!1;return!0},u.clear=function(e){return u.alter(e,c)},u.seq=function(e,t,r,n){s(n)||(n=!1);var i,o=[],l=a(e,t),u=(t*l-e*l)/((r-1)*l),c=e;for(i=0;c<=t&&i<r;c=(e*l+u*l*++i)/l)o.push(n?n(c,i):c);return o},u.arange=function(e,r,n){var i,a=[];if(n=n||1,r===t&&(r=e,e=0),e===r||0===n)return[];if(e<r&&n<0)return[];if(e>r&&n>0)return[];if(n>0)for(i=e;i<r;i+=n)a.push(i);else for(i=e;i>r;i+=n)a.push(i);return a},u.slice=function(){function e(e,r,n,i){var a,o=[],s=e.length;if(r===t&&n===t&&i===t)return u.copy(e);if(i=i||1,(r=(r=r||0)>=0?r:s+r)===(n=(n=n||e.length)>=0?n:s+n)||0===i)return[];if(r<n&&i<0)return[];if(r>n&&i>0)return[];if(i>0)for(a=r;a<n;a+=i)o.push(e[a]);else for(a=r;a>n;a+=i)o.push(e[a]);return o}return function(t,r){var n,i;return l((r=r||{}).row)?l(r.col)?t[r.row][r.col]:e(u.rowa(t,r.row),(n=r.col||{}).start,n.end,n.step):l(r.col)?e(u.cola(t,r.col),(i=r.row||{}).start,i.end,i.step):(i=r.row||{},n=r.col||{},e(t,i.start,i.end,i.step).map((function(t){return e(t,n.start,n.end,n.step)})))}}(),u.sliceAssign=function(r,n,i){var a,o;if(l(n.row)){if(l(n.col))return r[n.row][n.col]=i;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=u.arange(n.col.start,e.min(r.length,n.col.end),n.col.step);var s=n.row;return a.forEach((function(e,t){r[s][e]=i[t]})),r}if(l(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,o=u.arange(n.row.start,e.min(r[0].length,n.row.end),n.row.step);var c=n.col;return o.forEach((function(e,t){r[e][c]=i[t]})),r}return i[0].length===t&&(i=[i]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,o=u.arange(n.row.start,e.min(r.length,n.row.end),n.row.step),a=u.arange(n.col.start,e.min(r[0].length,n.col.end),n.col.step),o.forEach((function(e,t){a.forEach((function(n,a){r[e][n]=i[t][a]}))})),r},u.diagonal=function(e){var t=u.zeros(e.length,e.length);return e.forEach((function(e,r){t[r][r]=e})),t},u.copy=function(e){return e.map((function(e){return l(e)?e:e.map((function(e){return e}))}))};var h=u.prototype;return h.length=0,h.push=Array.prototype.push,h.sort=Array.prototype.sort,h.splice=Array.prototype.splice,h.slice=Array.prototype.slice,h.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},h.map=function(e,t){return u(u.map(this,e,t))},h.cumreduce=function(e,t){return u(u.cumreduce(this,e,t))},h.alter=function(e){return u.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){h[e]=function(t){var r,n=this;return t?(setTimeout((function(){t.call(n,h[e].call(n))})),this):(r=u[e](this),o(r)?u(r):r)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){h[e]=function(t,r){var n=this;return r?(setTimeout((function(){r.call(n,h[e].call(n,t))})),this):u(u[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){h[e]=function(){return u(u[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),u}(Math),Math),function(e,t){e.gammaln=function(e){var r,n,i,a=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(i=(n=r=e)+5.5,i-=(r+.5)*t.log(i);a<6;a++)s+=o[a]/++n;return t.log(2.5066282746310007*s/r)-i},e.loggam=function(e){var r,n,i,a,o,s,l,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=e,l=0,1==e||2==e)return 0;for(e<=7&&(r=e+(l=t.floor(7-e))),n=1/(r*r),i=2*t.PI,o=u[9],s=8;s>=0;s--)o*=n,o+=u[s];if(a=o/r+.5*t.log(i)+(r-.5)*t.log(r)-r,e<=7)for(s=1;s<=l;s++)a-=t.log(r-1),r-=1;return a},e.gammafn=function(e){var r,n,i,a,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,f=0,d=e;if(d<=0){if(!(a=d%1+36e-17))return 1/0;l=(1&d?-1:1)*t.PI/t.sin(t.PI*a),d=1-d}for(i=d,n=d<1?d++:(d-=u=(0|d)-1)-1,r=0;r<8;++r)f=(f+o[r])*n,c=c*n+s[r];if(a=f/c+1,i<d)a/=i;else if(i>d)for(r=0;r<u;++r)a*=d,d++;return l&&(a=l/a),a},e.gammap=function(t,r){return e.lowRegGamma(t,r)*e.gammafn(t)},e.lowRegGamma=function(r,n){var i,a=e.gammaln(r),o=r,s=1/r,l=s,u=n+1-r,c=1/1e-30,f=1/u,d=f,h=1,p=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;h<=p;h++)s+=l*=n/++o;return s*t.exp(-n+r*t.log(n)-a)}for(;h<=p;h++)d*=(f=1/(f=(i=-h*(h-r))*f+(u+=2)))*(c=u+i/c);return 1-d*t.exp(-n+r*t.log(n)-a)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(r,n){return r>170||n>170?t.exp(e.combinationln(r,n)):e.factorial(r)/e.factorial(n)/e.factorial(r-n)},e.combinationln=function(t,r){return e.factorialln(t)-e.factorialln(r)-e.factorialln(t-r)},e.permutation=function(t,r){return e.factorial(t)/e.factorial(t-r)},e.betafn=function(r,n){if(!(r<=0||n<=0))return r+n>170?t.exp(e.betaln(r,n)):e.gammafn(r)*e.gammafn(n)/e.gammafn(r+n)},e.betaln=function(t,r){return e.gammaln(t)+e.gammaln(r)-e.gammaln(t+r)},e.betacf=function(e,r,n){var i,a,o,s,l=1,u=r+n,c=r+1,f=r-1,d=1,h=1-u*e/c;for(t.abs(h)<1e-30&&(h=1e-30),s=h=1/h;l<=100&&(h=1+(a=l*(n-l)*e/((f+(i=2*l))*(r+i)))*h,t.abs(h)<1e-30&&(h=1e-30),d=1+a/d,t.abs(d)<1e-30&&(d=1e-30),s*=(h=1/h)*d,h=1+(a=-(r+l)*(u+l)*e/((r+i)*(c+i)))*h,t.abs(h)<1e-30&&(h=1e-30),d=1+a/d,t.abs(d)<1e-30&&(d=1e-30),s*=o=(h=1/h)*d,!(t.abs(o-1)<3e-7));l++);return s},e.gammapinv=function(r,n){var i,a,o,s,l,u,c=0,f=n-1,d=e.gammaln(n);if(r>=1)return t.max(100,n+100*t.sqrt(n));if(r<=0)return 0;for(n>1?(l=t.log(f),u=t.exp(f*(l-1)-d),s=r<.5?r:1-r,i=(2.30753+.27061*(a=t.sqrt(-2*t.log(s))))/(1+a*(.99229+.04481*a))-a,r<.5&&(i=-i),i=t.max(.001,n*t.pow(1-1/(9*n)-i/(3*t.sqrt(n)),3))):i=r<(a=1-n*(.253+.12*n))?t.pow(r/a,1/n):1-t.log(1-(r-a)/(1-a));c<12;c++){if(i<=0)return 0;if((i-=a=(o=(e.lowRegGamma(n,i)-r)/(a=n>1?u*t.exp(-(i-f)+f*(t.log(i)-l)):t.exp(-i+f*t.log(i)-d)))/(1-.5*t.min(1,o*((n-1)/i-1))))<=0&&(i=.5*(i+a)),t.abs(a)<1e-8*i)break}return i},e.erf=function(e){var r,n,i,a,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=o.length-1,l=!1,u=0,c=0;for(e<0&&(e=-e,l=!0),n=4*(r=2/(2+e))-2;s>0;s--)i=u,u=n*u-c+o[s],c=i;return a=r*t.exp(-e*e+.5*(o[0]+n*u)-c),l?a-1:1-a},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(r){var n,i,a,o,s=0;if(r>=2)return-100;if(r<=0)return 100;for(o=r<1?r:2-r,n=-.70711*((2.30753+.27061*(a=t.sqrt(-2*t.log(o/2))))/(1+a*(.99229+.04481*a))-a);s<2;s++)n+=(i=e.erfc(n)-o)/(1.1283791670955126*t.exp(-n*n)-n*i);return r<1?n:-n},e.ibetainv=function(r,n,i){var a,o,s,l,u,c,f,d,h,p,m=n-1,v=i-1,y=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&i>=1?(s=r<.5?r:1-r,c=(2.30753+.27061*(l=t.sqrt(-2*t.log(s))))/(1+l*(.99229+.04481*l))-l,r<.5&&(c=-c),f=(c*c-3)/6,d=2/(1/(2*n-1)+1/(2*i-1)),h=c*t.sqrt(f+d)/d-(1/(2*i-1)-1/(2*n-1))*(f+5/6-2/(3*d)),c=n/(n+i*t.exp(2*h))):(a=t.log(n/(n+i)),o=t.log(i/(n+i)),c=r<(l=t.exp(n*a)/n)/(h=l+(u=t.exp(i*o)/i))?t.pow(n*h*r,1/n):1-t.pow(i*h*(1-r),1/i)),p=-e.gammaln(n)-e.gammaln(i)+e.gammaln(n+i);y<10;y++){if(0===c||1===c)return c;if((c-=l=(u=(e.ibeta(c,n,i)-r)/(l=t.exp(m*t.log(c)+v*t.log(1-c)+p)))/(1-.5*t.min(1,u*(m/c-v/(1-c)))))<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),t.abs(l)<1e-8*c&&y>0)break}return c},e.ibeta=function(r,n,i){var a=0===r||1===r?0:t.exp(e.gammaln(n+i)-e.gammaln(n)-e.gammaln(i)+n*t.log(r)+i*t.log(1-r));return!(r<0||r>1)&&(r<(n+1)/(n+i+2)?a*e.betacf(r,n,i)/n:1-a*e.betacf(1-r,i,n)/i)},e.randn=function(r,n){var i,a,o,s,l;if(n||(n=r),r)return e.create(r,n,(function(){return e.randn()}));do{i=e._random_fn(),a=1.7156*(e._random_fn()-.5),l=(o=i-.449871)*o+(s=t.abs(a)+.386595)*(.196*s-.25472*o)}while(l>.27597&&(l>.27846||a*a>-4*t.log(i)*i*i));return a/i},e.randg=function(r,n,i){var a,o,s,l,u,c,f=r;if(i||(i=n),r||(r=1),n)return(c=e.zeros(n,i)).alter((function(){return e.randg(r)})),c;r<1&&(r+=1),a=r-1/3,o=1/t.sqrt(9*a);do{do{l=1+o*(u=e.randn())}while(l<=0);l*=l*l,s=e._random_fn()}while(s>1-.331*t.pow(u,4)&&t.log(s)>.5*u*u+a*(1-l+t.log(l)));if(r==f)return a*l;do{s=e._random_fn()}while(0===s);return t.pow(s,1/f)*a*l},function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(r){return e[t](r)})))}}(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[r])}("randn".split(" "))}(n,Math),function(e,t){function r(e,r,n,i){for(var a,o=0,s=1,l=1,u=1,c=0,f=0;t.abs((l-f)/l)>i;)f=l,s=u+(a=-(r+c)*(r+n+c)*e/(r+2*c)/(r+2*c+1))*s,l=(o=l+a*o)+(a=(c+=1)*(n-c)*e/(r+2*c-1)/(r+2*c))*l,o/=u=s+a*u,s/=u,l/=u,u=1;return l/r}function n(r,n,i){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*r;if(s>=8)return 1;var l,u=2*e.normal.cdf(s,0,1,1,0)-1;u=u>=t.exp(-50/i)?t.pow(u,i):0;for(var c=s,f=(8-s)/(l=r>3?2:3),d=c+f,h=0,p=i-1,m=1;m<=l;m++){for(var v=0,y=.5*(d+c),g=.5*(d-c),E=1;E<=12;E++){var b,x=y+g*(6<E?a[(b=12-E+1)-1]:-a[(b=E)-1]),A=x*x;if(A>60)break;var S=2*e.normal.cdf(x,0,1,1,0)*.5-2*e.normal.cdf(x,r,1,1,0)*.5;S>=t.exp(-30/p)&&(v+=S=o[b-1]*t.exp(-.5*A)*t.pow(S,p))}h+=v*=2*g*i/t.sqrt(2*t.PI),c=d,d+=f}return(u+=h)<=t.exp(-30/n)?0:(u=t.pow(u,n))>=1?1:u}!function(t){for(var r=0;r<t.length;r++)!function(t){e[t]=function(e,t,r){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=r,this):new arguments.callee(e,t,r)},e.fn[t]=function(r,n,i){var a=e[t](r,n,i);return a.data=this,a},e[t].prototype.sample=function(r){var n=this._a,i=this._b,a=this._c;return r?e.alter(r,(function(){return e[t].sample(n,i,a)})):e[t].sample(n,i,a)},function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(n){var i=this._a,a=this._b,o=this._c;return n||0===n||(n=this.data),"number"!=typeof n?e.fn.map.call(n,(function(n){return e[t][r](n,i,a,o)})):e[t][r](n,i,a,o)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(){return e[t][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(t[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(r,n,i){return r>1||r<0?0:1==n&&1==i?1:n<512&&i<512?t.pow(r,n-1)*t.pow(1-r,i-1)/e.betafn(n,i):t.exp((n-1)*t.log(r)+(i-1)*t.log(1-r)-e.betaln(n,i))},cdf:function(t,r,n){return t>1||t<0?1*(t>1):e.ibeta(t,r,n)},inv:function(t,r,n){return e.ibetainv(t,r,n)},mean:function(e,t){return e/(e+t)},median:function(t,r){return e.ibetainv(.5,t,r)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,r){var n=e.randg(t);return n/(n+e.randg(r))},variance:function(e,r){return e*r/(t.pow(e+r,2)*(e+r+1))}}),e.extend(e.centralF,{pdf:function(r,n,i){var a;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/e.betafn(n/2,i/2)*t.pow(n/i,n/2)*t.pow(r,n/2-1)*t.pow(1+n/i*r,-(n+i)/2):(a=n*r/(i+r*n),n*(i/(i+r*n))/2*e.binomial.pdf((n-2)/2,(n+i-2)/2,a))},cdf:function(t,r,n){return t<0?0:e.ibeta(r*t/(r*t+n),r/2,n/2)},inv:function(t,r,n){return n/(r*(1/e.ibetainv(t,r/2,n/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,r){return 2*e.randg(t/2)/t/(2*e.randg(r/2)/r)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,r,n){return n<0?0:n/(t.pow(e-r,2)+t.pow(n,2))/t.PI},cdf:function(e,r,n){return t.atan((e-r)/n)/t.PI+.5},inv:function(e,r,n){return r+n*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(r,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+r}}),e.extend(e.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:t.exp((n/2-1)*t.log(r)-r/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function(t,r){return t<0?0:e.lowRegGamma(r/2,t/2)},inv:function(t,r){return 2*e.gammapinv(t,.5*r)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,r){return e<0?0:r*t.exp(-r*e)},cdf:function(e,r){return e<0?0:1-t.exp(-r*e)},inv:function(e,r){return-t.log(1-e)/r},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(r){return-1/r*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(r,n,i){return r<0?0:0===r&&1===n?1/i:t.exp((n-1)*t.log(r)-r/i-e.gammaln(n)-n*t.log(i))},cdf:function(t,r,n){return t<0?0:e.lowRegGamma(r,t/n)},inv:function(t,r,n){return e.gammapinv(t,r)*n},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,r){return e.randg(t)*r},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(r,n,i){return r<=0?0:t.exp(-(n+1)*t.log(r)-i/r-e.gammaln(n)+n*t.log(i))},cdf:function(t,r,n){return t<=0?0:1-e.lowRegGamma(r,n/t)},inv:function(t,r,n){return n/e.gammapinv(1-t,r)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,r){return r/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,r,n){return 0===e&&1===r?n:1===e&&1===n?r:t.exp(t.log(r)+t.log(n)+(r-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,r)))},cdf:function(e,r,n){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,r),n)},inv:function(e,r,n){return t.pow(1-t.pow(1-e,1/n),1/r)},mean:function(t,r){return r*e.gammafn(1+1/t)*e.gammafn(r)/e.gammafn(1+1/t+r)},median:function(e,r){return t.pow(1-t.pow(2,-1/r),1/e)},mode:function(e,r){if(e>=1&&r>=1&&1!==e&&1!==r)return t.pow((e-1)/(e*r-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,r,n){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-r,2)/(2*n*n))},cdf:function(r,n,i){return r<0?0:.5+.5*e.erf((t.log(r)-n)/t.sqrt(2*i*i))},inv:function(r,n,i){return t.exp(-1.4142135623730951*i*e.erfcinv(2*r)+n)},mean:function(e,r){return t.exp(e+r*r/2)},median:function(e){return t.exp(e)},mode:function(e,r){return t.exp(e-r*r)},sample:function(r,n){return t.exp(e.randn()*n+r)},variance:function(e,r){return(t.exp(r*r)-1)*t.exp(2*e+r*r)}}),e.extend(e.noncentralt,{pdf:function(r,n,i){return t.abs(i)<1e-14?e.studentt.pdf(r,n):t.abs(r)<1e-14?t.exp(e.gammaln((n+1)/2)-i*i/2-.5*t.log(t.PI*n)-e.gammaln(n/2)):n/r*(e.noncentralt.cdf(r*t.sqrt(1+2/n),n+2,i)-e.noncentralt.cdf(r,n,i))},cdf:function(r,n,i){if(t.abs(i)<1e-14)return e.studentt.cdf(r,n);var a=!1;r<0&&(a=!0,i=-i);for(var o=e.normal.cdf(-i,0,1),s=1e-14+1,l=s,u=r*r/(r*r+n),c=0,f=t.exp(-i*i/2),d=t.exp(-i*i/2-.5*t.log(2)-e.gammaln(1.5))*i;c<200||l>1e-14||s>1e-14;)l=s,c>0&&(f*=i*i/(2*c),d*=i*i/(2*(c+.5))),o+=.5*(s=f*e.beta.cdf(u,c+.5,n/2)+d*e.beta.cdf(u,c+1,n/2)),c++;return a?1-o:o}}),e.extend(e.normal,{pdf:function(e,r,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-r,2)/(2*n*n))},cdf:function(r,n,i){return.5*(1+e.erf((r-n)/t.sqrt(2*i*i)))},inv:function(t,r,n){return-1.4142135623730951*n*e.erfcinv(2*t)+r},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,r){return e.randn()*r+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,r,n){return e<r?0:n*t.pow(r,n)/t.pow(e,n+1)},cdf:function(e,r,n){return e<r?0:1-t.pow(r/e,n)},inv:function(e,r,n){return r/t.pow(1-e,1/n)},mean:function(e,r){if(!(r<=1))return r*t.pow(e,r)/(r-1)},median:function(e,r){return e*(r*t.SQRT2)},mode:function(e){return e},variance:function(e,r){if(!(r<=2))return e*e*r/(t.pow(r-1,2)*(r-2))}}),e.extend(e.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(t.sqrt(n)*e.betafn(.5,n/2))*t.pow(1+r*r/n,-(n+1)/2)},cdf:function(r,n){var i=n/2;return e.ibeta((r+t.sqrt(r*r+n))/(2*t.sqrt(r*r+n)),i,i)},inv:function(r,n){var i=e.ibetainv(2*t.min(r,1-r),.5*n,.5);return i=t.sqrt(n*(1-i)/i),r>.5?i:-i},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return e.randn()*t.sqrt(r/(2*e.randg(r/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*t.pow(e/r,n-1)*t.exp(-t.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-t.exp(-t.pow(e/r,n))},inv:function(e,r,n){return r*t.pow(-t.log(1-e),1/n)},mean:function(t,r){return t*e.gammafn(1+1/r)},median:function(e,r){return e*t.pow(t.log(2),1/r)},mode:function(e,r){return r<=1?0:e*t.pow((r-1)/r,1/r)},sample:function(r,n){return r*t.pow(-t.log(e._random_fn()),1/n)},variance:function(r,n){return r*r*e.gammafn(1+2/n)-t.pow(e.weibull.mean(r,n),2)}}),e.extend(e.uniform,{pdf:function(e,t,r){return e<t||e>r?0:1/(r-t)},cdf:function(e,t,r){return e<t?0:e<r?(e-t)/(r-t):1},inv:function(e,t,r){return t+e*(r-t)},mean:function(e,t){return.5*(e+t)},median:function(t,r){return e.mean(t,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,r){return t/2+r/2+(r/2-t/2)*(2*e._random_fn()-1)},variance:function(e,r){return t.pow(r-e,2)/12}}),e.extend(e.binomial,{pdf:function(r,n,i){return 0===i||1===i?n*i===r?1:0:e.combination(n,r)*t.pow(i,r)*t.pow(1-i,n-r)},cdf:function(n,i,a){var o;if(n<0)return 0;if(n>=i)return 1;if(a<0||a>1||i<=0)return NaN;var s=a,l=(n=t.floor(n))+1,u=i-n,c=l+u,f=t.exp(e.gammaln(c)-e.gammaln(u)-e.gammaln(l)+l*t.log(s)+u*t.log(1-s));return o=s<(l+1)/(c+2)?f*r(s,l,u,1e-10):1-f*r(1-s,u,l,1e-10),t.round(1e10*(1-o))/1e10}}),e.extend(e.negbin,{pdf:function(r,n,i){return r===r>>>0&&(r<0?0:e.combination(r+n-1,n-1)*t.pow(1-i,r)*t.pow(i,n))},cdf:function(t,r,n){var i=0,a=0;if(t<0)return 0;for(;a<=t;a++)i+=e.negbin.pdf(a,r,n);return i}}),e.extend(e.hypgeom,{pdf:function(r,n,i,a){if(r!=r|0)return!1;if(r<0||r<i-(n-a))return 0;if(r>a||r>i)return 0;if(2*i>n)return 2*a>n?e.hypgeom.pdf(n-i-a+r,n,n-i,n-a):e.hypgeom.pdf(a-r,n,n-i,a);if(2*a>n)return e.hypgeom.pdf(i-r,n,i,n-a);if(i<a)return e.hypgeom.pdf(r,n,a,i);for(var o=1,s=0,l=0;l<r;l++){for(;o>1&&s<a;)o*=1-i/(n-s),s++;o*=(a-l)*(i-l)/((l+1)*(n-i-a+l+1))}for(;s<a;s++)o*=1-i/(n-s);return t.min(1,t.max(0,o))},cdf:function(r,n,i,a){if(r<0||r<i-(n-a))return 0;if(r>=a||r>=i)return 1;if(2*i>n)return 2*a>n?e.hypgeom.cdf(n-i-a+r,n,n-i,n-a):1-e.hypgeom.cdf(a-r-1,n,n-i,a);if(2*a>n)return 1-e.hypgeom.cdf(i-r-1,n,i,n-a);if(i<a)return e.hypgeom.cdf(r,n,a,i);for(var o=1,s=1,l=0,u=0;u<r;u++){for(;o>1&&l<a;){var c=1-i/(n-l);s*=c,o*=c,l++}o+=s*=(a-u)*(i-u)/((u+1)*(n-i-a+u+1))}for(;l<a;l++)o*=1-i/(n-l);return t.min(1,t.max(0,o))}}),e.extend(e.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:t.pow(n,r)*t.exp(-n)/e.factorial(r)},cdf:function(t,r){var n=[],i=0;if(t<0)return 0;for(;i<=t;i++)n.push(e.poisson.pdf(i,r));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(r){var n=1,i=0,a=t.exp(-r);do{i++,n*=e._random_fn()}while(n>a);return i-1},sampleLarge:function(r){var n,i,a,o,s,l,u,c,f,d,h=r;for(o=t.sqrt(h),s=t.log(h),l=.02483*(u=.931+2.53*o)-.059,c=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(i=t.random()-.5,a=t.random(),d=.5-t.abs(i),n=t.floor((2*l/d+u)*i+h+.43),d>=.07&&a<=f)return n;if(!(n<0||d<.013&&a>d)&&t.log(a)+t.log(c)-t.log(l/(d*d)+u)<=n*s-h-e.loggam(n+1))return n}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,r,n){return r<=t||n<t||n>r?NaN:e<t||e>r?0:e<n?2*(e-t)/((r-t)*(n-t)):e===n?2/(r-t):2*(r-e)/((r-t)*(r-n))},cdf:function(e,r,n,i){return n<=r||i<r||i>n?NaN:e<=r?0:e>=n?1:e<=i?t.pow(e-r,2)/((n-r)*(i-r)):1-t.pow(n-e,2)/((n-r)*(n-i))},inv:function(e,r,n,i){return n<=r||i<r||i>n?NaN:e<=(i-r)/(n-r)?r+(n-r)*t.sqrt(e*((i-r)/(n-r))):r+(n-r)*(1-t.sqrt((1-e)*(1-(i-r)/(n-r))))},mean:function(e,t,r){return(e+t+r)/3},median:function(e,r,n){return n<=(e+r)/2?r-t.sqrt((r-e)*(r-n))/t.sqrt(2):n>(e+r)/2?e+t.sqrt((r-e)*(n-e))/t.sqrt(2):void 0},mode:function(e,t,r){return r},sample:function(r,n,i){var a=e._random_fn();return a<(i-r)/(n-r)?r+t.sqrt(a*(n-r)*(i-r)):n-t.sqrt((1-a)*(n-r)*(n-i))},variance:function(e,t,r){return(e*e+t*t+r*r-e*t-e*r-t*r)/18}}),e.extend(e.arcsine,{pdf:function(e,r,n){return n<=r?NaN:e<=r||e>=n?0:2/t.PI*t.pow(t.pow(n-r,2)-t.pow(2*e-r-n,2),-.5)},cdf:function(e,r,n){return e<r?0:e<n?2/t.PI*t.asin(t.sqrt((e-r)/(n-r))):1},inv:function(e,r,n){return r+(.5-.5*t.cos(t.PI*e))*(n-r)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,r){return r<=e?NaN:t.pow(r-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,r,n){return n<=0?0:t.exp(-t.abs(e-r)/n)/(2*n)},cdf:function(e,r,n){return n<=0?0:e<r?.5*t.exp((e-r)/n):1-.5*t.exp(-(e-r)/n)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(r,n){var i,a=e._random_fn()-.5;return r-n*((i=a)/t.abs(i))*t.log(1-2*t.abs(a))}}),e.extend(e.tukey,{cdf:function(r,i,a){var o=i,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(r))return 1;if(a>25e3)return n(r,1,o);var u,c=.5*a,f=c*t.log(a)-a*t.log(2)-e.gammaln(c),d=c-1,h=.25*a;u=a<=100?1:a<=800?.5:a<=5e3?.25:.125,f+=t.log(u);for(var p=0,m=1;m<=50;m++){for(var v=0,y=(2*m-1)*u,g=1;g<=16;g++){var E,b;8<g?(E=g-8-1,b=f+d*t.log(y+s[E]*u)-(s[E]*u+y)*h):(E=g-1,b=f+d*t.log(y-s[E]*u)+(s[E]*u-y)*h),b>=-30&&(v+=n(8<g?r*t.sqrt(.5*(s[E]*u+y)):r*t.sqrt(.5*(-s[E]*u+y)),1,o)*l[E]*t.exp(b))}if(m*u>=1&&v<=1e-14)break;p+=v}if(v>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(r,n,i){if(i<2||n<2)return NaN;if(r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var a,o=function(e,r,n){var i=.5-.5*e,a=t.sqrt(t.log(1/(i*i))),o=a+((((-453642210148e-16*a-.204231210125)*a-.342242088547)*a-1)*a+.322232421088)/((((.0038560700634*a+.10353775285)*a+.531103462366)*a+.588581570495)*a+.099348462606);n<120&&(o+=(o*o*o+o)/n/4);var s=.8832-.2368*o;return n<120&&(s+=-1.214/n+1.208*o/n),o*(s*t.log(r-1)+1.4142)}(r,n,i),s=e.tukey.cdf(o,n,i)-r;a=s>0?t.max(0,o-1):o+1;for(var l,u=e.tukey.cdf(a,n,i)-r,c=1;c<50;c++)if(l=a-u*(a-o)/(u-s),s=u,o=a,l<0&&(l=0,u=-r),u=e.tukey.cdf(l,n,i)-r,a=l,t.abs(a-o)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(e,t){var r,n,i=Array.prototype.push,a=e.utils.isArray;function o(t){return a(t)||t instanceof e}e.extend({add:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.map(t,(function(e,t,n){return e+r[t][n]}))):e.map(t,(function(e){return e+r}))},subtract:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.map(t,(function(e,t,n){return e-r[t][n]||0}))):e.map(t,(function(e){return e-r}))},divide:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.multiply(t,e.inv(r))):e.map(t,(function(e){return e/r}))},multiply:function(t,r){var n,i,a,s,l,u,c,f;if(void 0===t.length&&void 0===r.length)return t*r;if(l=t.length,u=t[0].length,c=e.zeros(l,a=o(r)?r[0].length:u),f=0,o(r)){for(;f<a;f++)for(n=0;n<l;n++){for(s=0,i=0;i<u;i++)s+=t[n][i]*r[i][f];c[n][f]=s}return 1===l&&1===f?c[0][0]:c}return e.map(t,(function(e){return e*r}))},outer:function(t,r){return e.multiply(t.map((function(e){return[e]})),[r])},dot:function(t,r){o(t[0])||(t=[t]),o(r[0])||(r=[r]);for(var n,i,a=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===r[0].length&&1!==r.length?e.transpose(r):r,l=[],u=0,c=a.length,f=a[0].length;u<c;u++){for(l[u]=[],n=0,i=0;i<f;i++)n+=a[u][i]*s[u][i];l[u]=n}return 1===l.length?l[0]:l},pow:function(r,n){return e.map(r,(function(e){return t.pow(e,n)}))},exp:function(r){return e.map(r,(function(e){return t.exp(e)}))},log:function(r){return e.map(r,(function(e){return t.log(e)}))},abs:function(r){return e.map(r,(function(e){return t.abs(e)}))},norm:function(e,r){var n=0,i=0;for(isNaN(r)&&(r=2),o(e[0])&&(e=e[0]);i<e.length;i++)n+=t.pow(t.abs(e[i]),r);return t.pow(n,1/r)},angle:function(r,n){return t.acos(e.dot(r,n)/(e.norm(r)*e.norm(n)))},aug:function(e,t){var r,n=[];for(r=0;r<e.length;r++)n.push(e[r].slice());for(r=0;r<n.length;r++)i.apply(n[r],t[r]);return n},inv:function(t){for(var r,n=t.length,i=t[0].length,a=e.identity(n,i),o=e.gauss_jordan(t,a),s=[],l=0;l<n;l++)for(s[l]=[],r=i;r<o[0].length;r++)s[l][r-i]=o[l][r];return s},det:function(e){var t,r=e.length,n=2*r,i=new Array(n),a=r-1,o=n-1,s=a-r+1,l=o,u=0,c=0;if(2===r)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;u<n;u++)i[u]=1;for(u=0;u<r;u++){for(t=0;t<r;t++)i[s<0?s+r:s]*=e[u][t],i[l<r?l+r:l]*=e[u][t],s++,l--;s=--a-r+1,l=--o}for(u=0;u<r;u++)c+=i[u];for(;u<n;u++)c-=i[u];return c},gauss_elimination:function(r,n){var i,a,o,s,l=0,u=0,c=r.length,f=r[0].length,d=1,h=0,p=[];for(i=(r=e.aug(r,n))[0].length,l=0;l<c;l++){for(a=r[l][l],u=l,s=l+1;s<f;s++)a<t.abs(r[s][l])&&(a=r[s][l],u=s);if(u!=l)for(s=0;s<i;s++)o=r[l][s],r[l][s]=r[u][s],r[u][s]=o;for(u=l+1;u<c;u++)for(d=r[u][l]/r[l][l],s=l;s<i;s++)r[u][s]=r[u][s]-d*r[l][s]}for(l=c-1;l>=0;l--){for(h=0,u=l+1;u<=c-1;u++)h+=p[u]*r[l][u];p[l]=(r[l][i-1]-h)/r[l][l]}return p},gauss_jordan:function(r,n){var i,a,o,s=e.aug(r,n),l=s.length,u=s[0].length,c=0;for(a=0;a<l;a++){var f=a;for(o=a+1;o<l;o++)t.abs(s[o][a])>t.abs(s[f][a])&&(f=o);var d=s[a];for(s[a]=s[f],s[f]=d,o=a+1;o<l;o++)for(c=s[o][a]/s[a][a],i=a;i<u;i++)s[o][i]-=s[a][i]*c}for(a=l-1;a>=0;a--){for(c=s[a][a],o=0;o<a;o++)for(i=u-1;i>a-1;i--)s[o][i]-=s[a][i]*s[o][a]/c;for(s[a][a]/=c,i=l;i<u;i++)s[a][i]/=c}return s},triaUpSolve:function(t,r){var n,i=t[0].length,a=e.zeros(1,i)[0],o=!1;return null!=r[0].length&&(r=r.map((function(e){return e[0]})),o=!0),e.arange(i-1,-1,-1).forEach((function(o){n=e.arange(o+1,i).map((function(e){return a[e]*t[o][e]})),a[o]=(r[o]-e.sum(n))/t[o][o]})),o?a.map((function(e){return[e]})):a},triaLowSolve:function(t,r){var n,i=t[0].length,a=e.zeros(1,i)[0],o=!1;return null!=r[0].length&&(r=r.map((function(e){return e[0]})),o=!0),e.arange(i).forEach((function(i){n=e.arange(i).map((function(e){return t[i][e]*a[e]})),a[i]=(r[i]-e.sum(n))/t[i][i]})),o?a.map((function(e){return[e]})):a},lu:function(t){var r,n=t.length,i=e.identity(n),a=e.zeros(t.length,t[0].length);return e.arange(n).forEach((function(e){a[0][e]=t[0][e]})),e.arange(1,n).forEach((function(o){e.arange(o).forEach((function(n){r=e.arange(n).map((function(e){return i[o][e]*a[e][n]})),i[o][n]=(t[o][n]-e.sum(r))/a[n][n]})),e.arange(o,n).forEach((function(n){r=e.arange(o).map((function(e){return i[o][e]*a[e][n]})),a[o][n]=t[r.length][n]-e.sum(r)}))})),[i,a]},cholesky:function(r){var n,i=r.length,a=e.zeros(r.length,r[0].length);return e.arange(i).forEach((function(o){n=e.arange(o).map((function(e){return t.pow(a[o][e],2)})),a[o][o]=t.sqrt(r[o][o]-e.sum(n)),e.arange(o+1,i).forEach((function(t){n=e.arange(o).map((function(e){return a[o][e]*a[t][e]})),a[t][o]=(r[o][t]-e.sum(n))/a[o][o]}))})),a},gauss_jacobi:function(r,n,i,a){for(var o,s,l,u,c=0,f=0,d=r.length,h=[],p=[],m=[];c<d;c++)for(h[c]=[],p[c]=[],m[c]=[],f=0;f<d;f++)c>f?(h[c][f]=r[c][f],p[c][f]=m[c][f]=0):c<f?(p[c][f]=r[c][f],h[c][f]=m[c][f]=0):(m[c][f]=r[c][f],h[c][f]=p[c][f]=0);for(l=e.multiply(e.multiply(e.inv(m),e.add(h,p)),-1),s=e.multiply(e.inv(m),n),o=i,u=e.add(e.multiply(l,i),s),c=2;t.abs(e.norm(e.subtract(u,o)))>a;)o=u,u=e.add(e.multiply(l,o),s),c++;return u},gauss_seidel:function(r,n,i,a){for(var o,s,l,u,c,f=0,d=r.length,h=[],p=[],m=[];f<d;f++)for(h[f]=[],p[f]=[],m[f]=[],o=0;o<d;o++)f>o?(h[f][o]=r[f][o],p[f][o]=m[f][o]=0):f<o?(p[f][o]=r[f][o],h[f][o]=m[f][o]=0):(m[f][o]=r[f][o],h[f][o]=p[f][o]=0);for(u=e.multiply(e.multiply(e.inv(e.add(m,h)),p),-1),l=e.multiply(e.inv(e.add(m,h)),n),s=i,c=e.add(e.multiply(u,i),l),f=2;t.abs(e.norm(e.subtract(c,s)))>a;)s=c,c=e.add(e.multiply(u,s),l),f+=1;return c},SOR:function(r,n,i,a,o){for(var s,l,u,c,f,d=0,h=r.length,p=[],m=[],v=[];d<h;d++)for(p[d]=[],m[d]=[],v[d]=[],s=0;s<h;s++)d>s?(p[d][s]=r[d][s],m[d][s]=v[d][s]=0):d<s?(m[d][s]=r[d][s],p[d][s]=v[d][s]=0):(v[d][s]=r[d][s],p[d][s]=m[d][s]=0);for(c=e.multiply(e.inv(e.add(v,e.multiply(p,o))),e.subtract(e.multiply(v,1-o),e.multiply(m,o))),u=e.multiply(e.multiply(e.inv(e.add(v,e.multiply(p,o))),n),o),l=i,f=e.add(e.multiply(c,i),u),d=2;t.abs(e.norm(e.subtract(f,l)))>a;)l=f,f=e.add(e.multiply(c,l),u),d++;return f},householder:function(r){for(var n,i,a,o,s=r.length,l=r[0].length,u=0,c=[],f=[];u<s-1;u++){for(n=0,o=u+1;o<l;o++)n+=r[o][u]*r[o][u];for(n=(r[u+1][u]>0?-1:1)*t.sqrt(n),i=t.sqrt((n*n-r[u+1][u]*n)/2),(c=e.zeros(s,1))[u+1][0]=(r[u+1][u]-n)/(2*i),a=u+2;a<s;a++)c[a][0]=r[a][u]/(2*i);f=e.subtract(e.identity(s,l),e.multiply(e.multiply(c,e.transpose(c)),2)),r=e.multiply(f,e.multiply(r,f))}return r},QR:(r=e.sum,n=e.arange,function(i){var a,o,s,l=i.length,u=i[0].length,c=e.zeros(u,u);for(i=e.copy(i),o=0;o<u;o++){for(c[o][o]=t.sqrt(r(n(l).map((function(e){return i[e][o]*i[e][o]})))),a=0;a<l;a++)i[a][o]=i[a][o]/c[o][o];for(s=o+1;s<u;s++)for(c[o][s]=r(n(l).map((function(e){return i[e][o]*i[e][s]}))),a=0;a<l;a++)i[a][s]=i[a][s]-i[a][o]*c[o][s]}return[i,c]}),lstsq:function(t,r){var n=!1;void 0===r[0].length&&(r=r.map((function(e){return[e]})),n=!0);var i=e.QR(t),a=i[0],o=i[1],s=t[0].length,l=e.slice(a,{col:{end:s}}),u=function(t){var r=(t=e.copy(t)).length,n=e.identity(r);return e.arange(r-1,-1,-1).forEach((function(r){e.sliceAssign(n,{row:r},e.divide(e.slice(n,{row:r}),t[r][r])),e.sliceAssign(t,{row:r},e.divide(e.slice(t,{row:r}),t[r][r])),e.arange(r).forEach((function(i){var a=e.multiply(t[i][r],-1),o=e.slice(t,{row:i}),s=e.multiply(e.slice(t,{row:r}),a);e.sliceAssign(t,{row:i},e.add(o,s));var l=e.slice(n,{row:i}),u=e.multiply(e.slice(n,{row:r}),a);e.sliceAssign(n,{row:i},e.add(l,u))}))})),n}(e.slice(o,{row:{end:s}})),c=e.transpose(l);void 0===c[0].length&&(c=[c]);var f=e.multiply(e.multiply(u,c),r);return void 0===f.length&&(f=[[f]]),n?f.map((function(e){return e[0]})):f},jacobi:function(r){for(var n,i,a,o,s,l,u,c=1,f=r.length,d=e.identity(f,f),h=[];1===c;){for(s=r[0][1],a=0,o=1,n=0;n<f;n++)for(i=0;i<f;i++)n!=i&&s<t.abs(r[n][i])&&(s=t.abs(r[n][i]),a=n,o=i);for(l=r[a][a]===r[o][o]?r[a][o]>0?t.PI/4:-t.PI/4:t.atan(2*r[a][o]/(r[a][a]-r[o][o]))/2,(u=e.identity(f,f))[a][a]=t.cos(l),u[a][o]=-t.sin(l),u[o][a]=t.sin(l),u[o][o]=t.cos(l),d=e.multiply(d,u),r=e.multiply(e.multiply(e.inv(u),r),u),c=0,n=1;n<f;n++)for(i=1;i<f;i++)n!=i&&t.abs(r[n][i])>.001&&(c=1)}for(n=0;n<f;n++)h.push(r[n][n]);return[d,h]},rungekutta:function(e,t,r,n,i,a){var o,s,l;if(2===a)for(;n<=r;)i+=((o=t*e(n,i))+(s=t*e(n+t,i+o)))/2,n+=t;if(4===a)for(;n<=r;)i+=((o=t*e(n,i))+2*(s=t*e(n+t/2,i+o/2))+2*(l=t*e(n+t/2,i+s/2))+t*e(n+t,i+l))/6,n+=t;return i},romberg:function(e,r,n,i){for(var a,o,s,l,u,c=0,f=(n-r)/2,d=[],h=[],p=[];c<i/2;){for(u=e(r),s=r,l=0;s<=n;s+=f,l++)d[l]=s;for(a=d.length,s=1;s<a-1;s++)u+=(s%2!=0?4:2)*e(d[s]);u=f/3*(u+e(n)),p[c]=u,f/=2,c++}for(o=p.length,a=1;1!==o;){for(s=0;s<o-1;s++)h[s]=(t.pow(4,a)*p[s+1]-p[s])/(t.pow(4,a)-1);o=h.length,p=h,h=[],a++}return p},richardson:function(e,r,n,i){function a(e,t){for(var r,n=0,i=e.length;n<i;n++)e[n]===t&&(r=n);return r}for(var o,s,l,u,c,f=t.abs(n-e[a(e,n)+1]),d=0,h=[],p=[];i>=f;)o=a(e,n+i),s=a(e,n),h[d]=(r[o]-2*r[s]+r[2*s-o])/(i*i),i/=2,d++;for(u=h.length,l=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(t.pow(4,l)*h[c+1]-h[c])/(t.pow(4,l)-1);u=p.length,h=p,p=[],l++}return h},simpson:function(e,t,r,n){for(var i,a=(r-t)/n,o=e(t),s=[],l=t,u=0,c=1;l<=r;l+=a,u++)s[u]=l;for(i=s.length;c<i-1;c++)o+=(c%2!=0?4:2)*e(s[c]);return a/3*(o+e(r))},hermite:function(e,t,r,n){for(var i,a=e.length,o=0,s=0,l=[],u=[],c=[],f=[];s<a;s++){for(l[s]=1,i=0;i<a;i++)s!=i&&(l[s]*=(n-e[i])/(e[s]-e[i]));for(u[s]=0,i=0;i<a;i++)s!=i&&(u[s]+=1/(e[s]-e[i]));c[s]=(1-2*(n-e[s])*u[s])*(l[s]*l[s]),f[s]=(n-e[s])*(l[s]*l[s]),o+=c[s]*t[s]+f[s]*r[s]}return o},lagrange:function(e,t,r){for(var n,i,a=0,o=0,s=e.length;o<s;o++){for(i=t[o],n=0;n<s;n++)o!=n&&(i*=(r-e[n])/(e[o]-e[n]));a+=i}return a},cubic_spline:function(t,r,n){for(var i,a,o=t.length,s=0,l=[],u=[],c=[],f=[],d=[],h=[];s<o-1;s++)f[s]=t[s+1]-t[s];for(c[0]=0,s=1;s<o-1;s++)c[s]=3/f[s]*(r[s+1]-r[s])-3/f[s-1]*(r[s]-r[s-1]);for(s=1;s<o-1;s++)l[s]=[],u[s]=[],l[s][s-1]=f[s-1],l[s][s]=2*(f[s-1]+f[s]),l[s][s+1]=f[s],u[s][0]=c[s];for(a=e.multiply(e.inv(l),u),i=0;i<o-1;i++)d[i]=(r[i+1]-r[i])/f[i]-f[i]*(a[i+1][0]+2*a[i][0])/3,h[i]=(a[i+1][0]-a[i][0])/(3*f[i]);for(i=0;i<o&&!(t[i]>n);i++);return r[i-=1]+(n-t[i])*d[i]+e.sq(n-t[i])*a[i]+(n-t[i])*e.sq(n-t[i])*h[i]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var r,n,i,a,o,s=t.length,l=t[0].length,u=0,c=[],f=[],d=[],h=[],p=[],m=[],v=[];for(u=0;u<s;u++)c[u]=e.sum(t[u])/l;for(u=0;u<l;u++)for(p[u]=[],r=0;r<s;r++)p[u][r]=t[r][u]-c[r];for(p=e.transpose(p),u=0;u<s;u++)for(m[u]=[],r=0;r<s;r++)m[u][r]=e.dot([p[u]],[p[r]])/(l-1);for(o=(i=e.jacobi(m))[0],f=i[1],v=e.transpose(o),u=0;u<f.length;u++)for(r=u;r<f.length;r++)f[u]<f[r]&&(n=f[u],f[u]=f[r],f[r]=n,d=v[u],v[u]=v[r],v[r]=d);for(a=e.transpose(p),u=0;u<s;u++)for(h[u]=[],r=0;r<a.length;r++)h[u][r]=e.dot([v[u]],[a[r]]);return[t,f,v,h]}}),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(r,n){var i=this;return n?(setTimeout((function(){n.call(i,e.fn[t].call(i,r))}),15),this):"number"==typeof e[t](this,r)?e[t](this,r):e(e[t](this,r))}}(t[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(e,t){var r=[].slice,n=e.utils.isNumber,i=e.utils.isArray;function a(e,r,n,i){if(e>1||n>1||e<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(e*r+n*i)/(r+i);return(e-n)/t.sqrt(a*(1-a)*(1/r+1/i))}e.extend({zscore:function(){var t=r.call(arguments);return n(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,a=r.call(arguments);return i(a[1])?(n=e.zscore(a[0],a[1],a[3]),1===a[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):a.length>2?(n=e.zscore(a[0],a[1],a[2]),1===a[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=a[0],1===a[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(r,n,i){var a=t.abs(this.zscore(r,i));return 1===n?e.normal.cdf(-a,0,1):2*e.normal.cdf(-a,0,1)}}),e.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var i,a=r.call(arguments);return 5===a.length?(i=t.abs(e.tscore(a[0],a[1],a[2],a[3])),1===a[4]?e.studentt.cdf(-i,a[3]-1):2*e.studentt.cdf(-i,a[3]-1)):n(a[1])?(i=t.abs(a[0]),1==a[2]?e.studentt.cdf(-i,a[1]-1):2*e.studentt.cdf(-i,a[1]-1)):(i=t.abs(e.tscore(a[0],a[1])),1==a[2]?e.studentt.cdf(-i,a[1].length-1):2*e.studentt.cdf(-i,a[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-e.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,i,a,o,s,l,u,c,f=r.call(arguments);if(1===f.length){for(s=new Array(f[0].length),u=0;u<f[0].length;u++)s[u]=f[0][u];f=s}for(i=new Array,u=0;u<f.length;u++)i=i.concat(f[u]);for(a=e.mean(i),n=0,u=0;u<f.length;u++)n+=f[u].length*t.pow(e.mean(f[u])-a,2);for(n/=f.length-1,l=0,u=0;u<f.length;u++)for(o=e.mean(f[u]),c=0;c<f[u].length;c++)l+=t.pow(f[u][c]-o,2);return n/(l/=i.length-f.length)},anovaftest:function(){var t,i,a,o,s=r.call(arguments);if(n(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);var l=e.anovafscore(s);for(t=s.length-1,a=0,o=0;o<s.length;o++)a+=s[o].length;return i=a-t-1,1-e.centralF.cdf(l,t,i)},ftest:function(t,r,n){return 1-e.centralF.cdf(t,r,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,r-this.length)}}),e.extend({qscore:function(){var i,a,o,s,l,u=r.call(arguments);return n(u[0])?(i=u[0],a=u[1],o=u[2],s=u[3],l=u[4]):(i=e.mean(u[0]),a=e.mean(u[1]),o=u[0].length,s=u[1].length,l=u[2]),t.abs(i-a)/(l*t.sqrt((1/o+1/s)/2))},qtest:function(){var t,n=r.call(arguments);3===n.length?(t=n[0],n=n.slice(1)):7===n.length?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var i=n[0],a=n[1];return 1-e.tukey.cdf(t,a,i-a)},tukeyhsd:function(t){for(var r=e.pooledstdev(t),n=t.map((function(t){return e.mean(t)})),i=t.reduce((function(e,t){return e+t.length}),0),a=[],o=0;o<t.length;++o)for(var s=o+1;s<t.length;++s){var l=e.qtest(n[o],n[s],t[o].length,t[s].length,r,i,t.length);a.push([[o,s],l])}return a}}),e.extend({normalci:function(){var n,i=r.call(arguments),a=new Array(2);return n=4===i.length?t.abs(e.normal.inv(i[1]/2,0,1)*i[2]/t.sqrt(i[3])):t.abs(e.normal.inv(i[1]/2,0,1)*e.stdev(i[2])/t.sqrt(i[2].length)),a[0]=i[0]-n,a[1]=i[0]+n,a},tci:function(){var n,i=r.call(arguments),a=new Array(2);return n=4===i.length?t.abs(e.studentt.inv(i[1]/2,i[3]-1)*i[2]/t.sqrt(i[3])):t.abs(e.studentt.inv(i[1]/2,i[2].length-1)*e.stdev(i[2],!0)/t.sqrt(i[2].length)),a[0]=i[0]-n,a[1]=i[0]+n,a},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,r){return e.normalci(t,r,this.toArray())},tci:function(t,r){return e.tci(t,r,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,r,n,i){var o=a(t,r,n,i);return e.ztest(o,1)},twoSidedDifferenceOfProportions:function(t,r,n,i){var o=a(t,r,n,i);return e.ztest(o,2)}})}(n,Math),n.models=function(){function e(e,t){var r=e.length,i=t[0].length-1,a=r-i-1,o=n.lstsq(t,e),s=n.multiply(t,o.map((function(e){return[e]}))).map((function(e){return e[0]})),l=n.subtract(e,s),u=n.mean(e),c=n.sum(s.map((function(e){return Math.pow(e-u,2)}))),f=n.sum(e.map((function(e,t){return Math.pow(e-s[t],2)}))),d=c+f;return{exog:t,endog:e,nobs:r,df_model:i,df_resid:a,coef:o,predict:s,resid:l,ybar:u,SST:d,SSE:c,SSR:f,R2:c/d}}function t(t){var r,i,a=(r=t.exog,i=r[0].length,n.arange(i).map((function(t){var a=n.arange(i).filter((function(e){return e!==t}));return e(n.col(r,t).map((function(e){return e[0]})),n.col(r,a))}))),o=Math.sqrt(t.SSR/t.df_resid),s=a.map((function(e){var t=e.SST,r=e.R2;return o/Math.sqrt(t*(1-r))})),l=t.coef.map((function(e,t){return(e-0)/s[t]})),u=l.map((function(e){var r=n.studentt.cdf(e,t.df_resid);return 2*(r>.5?1-r:r)})),c=n.studentt.inv(.975,t.df_resid),f=t.coef.map((function(e,t){var r=c*s[t];return[e-r,e+r]}));return{se:s,t:l,p:u,sigmaHat:o,interval95:f}}return{ols:function(r,i){var a=e(r,i),o=t(a),s=function(e){var t,r,i,a=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:a,pvalue:1-(t=a,r=e.df_model,i=e.df_resid,n.beta.cdf(t/(i/r+t),r/2,i/2))}}(a),l=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=o,a.f=s,a.adjust_R2=l,a}}}(),n.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;t++){var r=[1];e[t]=r.concat(arguments[t])}return n(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var r=[1];e[t]=r.concat(arguments[0][t])}return n(e)},buildjxmatrix:function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return n.builddxmatrix(t)},buildymatrix:function(e){return n(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,t){var r,i,a,o,s;if(e.cols()==t.rows()){if(t.rows()>1){for(o=[],r=0;r<e.rows();r++)for(o[r]=[],i=0;i<t.cols();i++){for(s=0,a=0;a<e.cols();a++)s+=e.toArray()[r][a]*t.toArray()[a][i];o[r][i]=s}return n(o)}for(o=[],r=0;r<e.rows();r++)for(o[r]=[],i=0;i<t.cols();i++){for(s=0,a=0;a<e.cols();a++)s+=e.toArray()[r][a]*t.toArray()[i];o[r][i]=s}return n(o)}},regress:function(e,t){var r=n.xtranspxinv(e),i=e.transpose(),a=n.matrixmult(n(r),i);return n.matrixmult(a,t)},regresst:function(e,t,r){var i=n.regress(e,t),a={anova:{}},o=n.jMatYBar(e,i);a.yBar=o;var s=t.mean();a.anova.residuals=n.residuals(t,o),a.anova.ssr=n.ssr(o,s),a.anova.msr=a.anova.ssr/(e[0].length-1),a.anova.sse=n.sse(t,o),a.anova.mse=a.anova.sse/(t.length-(e[0].length-1)-1),a.anova.sst=n.sst(t,s),a.anova.mst=a.anova.sst/(t.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=n.anovaftest(a.anova.fratio,e[0].length-1,t.length-(e[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(e[0].length);for(var l,u,c,f=n.xtranspxinv(e),d=0;d<i.length;d++)l=Math.sqrt(a.anova.mse*Math.abs(f[d][d])),u=Math.abs(i[d]/l),c=n.ttest(u,t.length-e[0].length-1,r),a.stats[d]=[i[d],l,u,c];return a.regress=i,a},xtranspx:function(e){return n.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var t=n.matrixmult(e.transpose(),e);return n.inv(t)},jMatYBar:function(e,t){var r=n.matrixmult(e,t);return new n(r)},residuals:function(e,t){return n.matrixsubtract(e,t)},ssr:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},sse:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},sst:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},matrixsubtract:function(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++){r[i]=new Array(e[i].length);for(var a=0;a<e[i].length;a++)r[i][a]=e[i][a]-t[i][a]}return n(r)}}),n.jStat=n,n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawArray=t.MatrixValue=void 0;var n=r(3),i=r(2),a=r(59),o=r(21),s=r(60);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t&&u(e.prototype,t),r&&u(e,r),e}var f=function(){function e(t){l(this,e),this.aArray=t,this.shape=this.getShape(t),this.twoArgOperator=new s.TwoArgOperatorColl}return c(e,[{key:"applyEachElement",value:function(e){return this.aArray.map((function(t){return t.map(e)}))}},{key:"convertNumberToMatrix",value:function(e){return this.applyEachElement((function(t){return e}))}},{key:"getACopy",value:function(){return new e(this.aArray.slice())}},{key:"repeatCol",value:function(e){1===this.shape[1]&&e>1&&(this.aArray=this.aArray.map((function(t){return Array(e).fill(t[0])})),this.shape[1]=e)}},{key:"repeatRow",value:function(e){1===this.shape[0]&&e>1&&(this.aArray=Array(e).fill(this.aArray[0]),this.shape[0]=e)}},{key:"repeatRowOrCol",value:function(e,t){0===t?this.repeatRow(e):this.repeatCol(e)}},{key:"getShape",value:function(e){var t=!0,r=e[0].length;e.map((function(e){t=e.length===r&&r}));return t?[e.length,r]:new Error(n.INVALID_MATRIX)}},{key:"checkAllNumber",value:function(e){e.forEach((function(e){e.forEach((function(e){if("number"!=typeof e)return new Error(n.NOT_NUMBER)}))}))}},{key:"checkSameShape",value:function(e){if(e.shape!==this.shape)return new Error(n.SHAPE_DIFF)}},{key:"convertArgToMatrix",value:function(t){return"number"==typeof t?this.convertNumberToMatrix(t):t instanceof Array?e(t):t instanceof e?t:new Error(n.INVALID_MATRIX)}},{key:"getElement",value:function(e,t){return this.aArray[e][t]}},{key:"growToLargeShape",value:function(e){for(var t=0,r=[0,1];t<r.length;t++){var n=r[t];e.shape[n]>this.shape[n]?this.repeatRowOrCol(e.shape[n],n):this.shape[n]>e.shape[n]&&e.repeatRowOrCol(this.shape[n],n)}}},{key:"exeElementWiseFunc",value:function(e,t){var r=this.convertArgToMatrix(e),n=this.getACopy();n.growToLargeShape(r);for(var i=Math.min(n.shape[0],r.shape[0]),a=Math.min(n.shape[1],r.shape[1]),o=Array(i),s=0;s<i;s++){o[s]=Array(0);for(var l=0;l<a;l++)o[s].push(t(n.getElement(s,l),r.getElement(s,l)))}return o}},{key:"exeElementWiseOperator",value:function(e,t){var r=this.twoArgOperator.getFunc(t);return r instanceof Error?r:this.exeElementWiseFunc(e,r)}}]),e}();t.MatrixValue=f;var d=function(){function e(t){l(this,e),this.rawStr=t,this.cellVError=null,this.solution=null,this.unitType=n.RAW_ARRAY}return c(e,[{key:"parse2Array",value:function(){var e=this;return this.rawStr.split(";").map((function(t){return t.split(",").map((function(t){var r=new a.RawValueParser(t).parse2NumberOrString();return e.cellVError=r===i.PARSE_FAIL?new o.CellVError(new Error(i.ERROR_SYNTAX)):e.cellVError,r}))}))}},{key:"solveExpression",value:function(){var e=this.parse2Array();return this.cellVError instanceof o.CellVError?this.cellVError:(this.solution=e,e)}}]),e}();t.RawArray=d},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DATE=function(e,t,r){if(e=(0,l.parseNumber)(e),t=(0,l.parseNumber)(t),r=(0,l.parseNumber)(r),(0,s.anyIsError)(e,t,r))return Error(a.ERROR_VALUE);if(e<0||t<0||r<0)return Error(a.ERROR_NUM);return new Date(e,t-1,r)},t.stamp2DayNum=p,t.DATEVALUE=function(e){if("string"!=typeof e)return Error(a.ERROR_VALUE);var t=Date.parse(e);if(isNaN(t))return Error(a.ERROR_VALUE);return p(t)},t.DAY=function(e){return(0,l.days_str2date)(e).getDate()},t.DAYS=function(e,t){return e=(0,l.days_str2date)(e),t=(0,l.days_str2date)(t),parseInt(p(e)-p(t))},t.DAYS360=function(e,t,r){if(r=(0,l.parseBool)(r),e=(0,l.days_str2date)(e),t=(0,l.days_str2date)(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;var n,i,a=e.getMonth(),o=t.getMonth();if(r)n=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{var s=new Date(e.getFullYear(),a+1,0).getDate(),u=new Date(t.getFullYear(),o+1,0).getDate();n=e.getDate()===s?30:e.getDate(),t.getDate()===u?n<30?(o++,i=1):i=30:i=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(o-a)+(i-n)},t.EDATE=function(e,t){if((e=(0,l.days_str2date)(e))instanceof Error)return e;if(isNaN(t))return Error(a.ERROR_VALUE);return t=parseInt(t,10),e.setMonth(e.getMonth()+t),e.toLocaleString()},t.EOMONTH=function(e,t){if((e=(0,l.days_str2date)(e))instanceof Error)return e;if(isNaN(t))return Error(a.ERROR_VALUE);return t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0).toLocaleString()},t.HOUR=function(e){if("number"==typeof e&&!isNaN(e))return parseInt(24*(parseFloat(e)-parseInt(e)));if((e=(0,l.days_str2date)(e))instanceof Error)return e;return e.getHours()},t.ISOWEEKNUM=function(e){if((e=(0,l.days_str2date)(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/o.MS_PER_DAY+1)/7)},t.MINUTE=function(e){return window.jsSpreadsheet.AllFormulas.MINUTE(e)},t.MONTH=function(e){if((e=(0,l.days_str2date)(e))instanceof Error)return e;return e.getMonth()+1};var a=r(2),o=c(r(3)),s=c(r(11)),l=r(17);r(55);function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var f=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],d=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],h=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function p(e){return(e-o.d18991230MS)/o.MS_PER_DAY}function m(e){return 1===new Date(e,1,29).getMonth()}function v(e,t){return Math.ceil((t-e)/o.MS_PER_DAY)}t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return Error(a.ERROR_VALUE);e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var r=Math.floor(e/2592e3);e%=2592e3;var n=Math.floor(e/86400);e%=86400;var i=Math.floor(e/3600);e%=3600;var o=Math.floor(e/60),s=e%=60;return"P"+(t=t>0?t+"Y":"")+(r=r>0?r+"M":"")+(n=n>0?n+"D":"")+"T"+(i=i>0?i+"H":"")+(o=o>0?o+"M":"")+(s=s>0?s+"S":"")},t.NETWORKDAYS=function(e,t,r){return r instanceof Array&&(r=s.flatten(r)),window.jsSpreadsheet.AllFormulas.NETWORKDAYS(e,t,r)},t.NETWORKDAYSINTL=function(e,t,r,n){"string"==typeof n&&n.indexOf("{")>=0&&(n=days_str2dateArray(s.strToMatrix(n)[0]));try{return window.jsSpreadsheet.AllFormulas.NETWORKDAYS$INTL(e,t,r,n)}catch(x){if(e=s.ExcelDateToJSDate((0,l.days_str2date)(e)),t=s.ExcelDateToJSDate((0,l.days_str2date)(t)),e instanceof Error)return e;if(t instanceof Error)return t;if(void 0===r)r=h[1];else if("string"==typeof r&&7===r.length){for(var u=[],c=0;c<r.length;c++)"1"==r[c]&&u.push(c+1>6?0:c+1);r=u}else r=h[r];if(!(r instanceof Array))return Error(a.ERROR_VALUE);void 0===n?n=[]:n instanceof Array||(n=[n]);for(var f=0;f<n.length;f++){var d=(0,l.days_str2date)(n[f]);if(d instanceof Error)return d;n[f]=d}var p=(t-e)/o.MS_PER_DAY+1,m=p,v=e;for(i=0;i<p;i++){var y=(new Date).getTimezoneOffset()>0?v.getUTCDay():v.getDay(),g=!1;y!==r[0]&&y!==r[1]||(g=!0);for(var E=0;E<n.length;E++){var b=n[E];if(b.getDate()===v.getDate()&&b.getMonth()===v.getMonth()&&b.getFullYear()===v.getFullYear()){g=!0;break}}g&&m--,v.setDate(v.getDate()+1)}return m}},t.NETWORKDAYS.INTL=function(e,t,r,n){if("string"==typeof n&&n.indexOf("{")>=0&&(n=days_str2dateArray(s.strToMatrix(n))),e=s.ExcelDateToJSDate(e),t=s.ExcelDateToJSDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(!((r=void 0===r?h[1]:h[r])instanceof Array))return Error(a.ERROR_VALUE);void 0===n?n=[]:n instanceof Array||(n=[n]);for(var u=0;u<n.length;u++){var c=(0,l.days_str2date)(n[u]);if(c instanceof Error)return c;n[u]=c}var f=(t-e)/o.MS_PER_DAY+1,d=f,p=e;for(i=0;i<f;i++){var m=(new Date).getTimezoneOffset()>0?p.getUTCDay():p.getDay(),v=!1;m!==r[0]&&m!==r[1]||(v=!0);for(var y=0;y<n.length;y++){var g=n[y];if(g.getDate()===p.getDate()&&g.getMonth()===p.getMonth()&&g.getFullYear()===p.getFullYear()){v=!0;break}}v&&d--,p.setDate(p.getDate()+1)}return d},t.NOW=function(){return new Date},t.SECOND=function(e){return(e=(0,l.days_str2date)(e))instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,r){return e=(0,l.parseNumber)(e),t=(0,l.parseNumber)(t),r=(0,l.parseNumber)(r),(0,s.anyIsError)(e,t,r)?Error(a.ERROR_VALUE):e<0||t<0||r<0?Error(a.ERROR_NUM):(3600*e+60*t+r)/86400},t.TIMEVALUE=function(e){var t=window.jsSpreadsheet.AllFormulas;try{return t.TIMEVALUE(e)}catch(e){return Error(a.ERROR_VALUE)}},t.TODAY=function(){return window.jsSpreadsheet.AllFormulas.TODAY()},t.WEEKDAY=function(e,t){if((e=(0,l.days_str2date)(e))instanceof Error)return e;void 0===t&&(t=1);var r=e.getDay();return d[t][r]},t.WEEKNUM=function(e,t){if((e=(0,l.days_str2date)(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var r=f[t],n=new Date(e.getFullYear(),0,1),i=n.getDay()<r?1:0;return n-=Math.abs(n.getDay()-r)*o.MS_PER_DAY,Math.floor((e-n)/o.MS_PER_DAY/7+1)+i},t.WORKDAY=function(e,t,r){return void 0!==r&&(r=s.flatten(r)),window.jsSpreadsheet.AllFormulas.WORKDAY(e,t,r)},t.WORKDAYINTL=function(e,t,r,n){if((e=(0,l.days_str2date)(e))instanceof Error)return e;if(0==r)return Error(a.ERROR_NUM);if((t=(0,l.parseNumber)(t))instanceof Error)return t;if(t<0)return Error(a.ERROR_NUM);if(!((r=void 0===r?h[1]:h[r])instanceof Array))return Error(a.ERROR_VALUE);void 0===n?n=[]:n instanceof Array||(n=[n]);for(var i=0;i<n.length;i++){var o=(0,l.days_str2date)(n[i]);if(o instanceof Error)return o;n[i]=o}for(var s=0;s<t;){e.setDate(e.getDate()+1);var u=e.getDay();if(u!==r[0]&&u!==r[1]){for(var c=0;c<n.length;c++){var f=n[c];if(f.getDate()===e.getDate()&&f.getMonth()===e.getMonth()&&f.getFullYear()===e.getFullYear()){s--;break}}s++}}return e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()},t.YEAR=function(e){return(e=(0,l.days_str2date)(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,r){if((e=(0,l.days_str2date)(e))instanceof Error)return e;if((t=(0,l.days_str2date)(t))instanceof Error)return t;r=r||0;var n=e.getDate(),i=e.getMonth(),a=e.getFullYear(),s=t.getDate(),u=t.getMonth(),c=t.getFullYear();switch(r){case 0:return 31===n&&31===s?(n=30,s=30):31===n?n=30:30===n&&31===s&&(s=30),(s+30*u+360*c-(n+30*i+360*a))/360;case 1:var f=365;if(a===c||a+1===c&&(i>u||i===u&&n>=s))return(a===c&&m(a)||function(e,t){var r=e.getFullYear(),n=new Date(r,2,1);if(m(r)&&e<n&&t>=n)return!0;var i=t.getFullYear(),a=new Date(i,2,1);return m(i)&&t>=a&&e<a}(e,t)||1===u&&29===s)&&(f=366),v(e,t)/f;var d=c-a+1,h=(new Date(c+1,0,1)-new Date(a,0,1))/o.MS_PER_DAY/d;return v(e,t)/h;case 2:return v(e,t)/360;case 3:return v(e,t)/365;case 4:return 31===n&&31===s?(n=30,s=30):31===n?n=30:30===n&&31===s&&(s=30),(s+30*u+360*c-(n+30*i+360*a))/360}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawValue=void 0;var n=r(3);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.unitType=n.RAW_VALUE}var t,r,a;return t=e,(r=[{key:"setValue",value:function(e){this.value=e}},{key:"solveExpression",value:function(){return this.value}}])&&i(t.prototype,r),a&&i(t,a),e}();t.RawValue=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUnitRangeRef=void 0;var n=r(62),i=r(2),a=r(3),o=r(35),s=r(21);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,r,i){var o,s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.calcCell=r,this.start_pst=i-t.length,this.unitType=a.RANG_REF,-1!==t.indexOf("!")){var l=t.split("!");s=(0,n.getSanitizedSheetName)(l[0]),o=l[1],this.range_start_pst=i-l[1].length}else s=this.calcCell.calcSheet.name,o=t,this.range_start_pst=this.start_pst;this.calcSheet=this.calcCell.workbookProxy.getSheetByName(s),this.range_expression=o,this.sheet_name=s}var t,r,u;return t=e,(r=[{key:"solveExpression",value:function(){var e,t=this.sheet_name,r=this.range_expression.split(":"),n=parseInt(r[0].replace(/^[A-Z]+/,""),10)||0,l=r[1].replace(/^[A-Z]+/,"");e=""===l?this.calcCell.calcSheet.getMaxRowNum():parseInt(l);for(var u=new o.ColIndexProxy(r[0]).colNum,c=new o.ColIndexProxy(r[0]).colNum,f=[],d=n;d<=e;d++){var h=[];f.push(h);for(var p=u;p<=c;p++){var m=new o.ColIndexProxy(p).colStr+d,v=this.calcCell.workbookProxy.getCellByName(t,m);if(v){if(v.cellStatus===a.FORMULA_STATUS.created)v.execFormula();else if(v.cellStatus===a.FORMULA_STATUS.working)throw new Error(i.ERROR_CIRCULAR);"e"===v.cellObj.t?h.push(v.cellObj):h.push(v.cellObj.v)}else h.push(new s.CellVEmpty)}}return f}}])&&l(t.prototype,r),u&&l(t,u),e}();t.SUnitRangeRef=u},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SUnitRefValue=void 0;var i=r(62),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,t&&t.set(e,r);return r}(r(2)),o=r(3),s=r(25);function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="SUnitRefValue",this.str_expression=t,this.calcCell=r,this.unitType=o.SINGLE_REF,this.subSyntaxBuilder=new s.SyntaxStructureBuilder(s.BaseSyntaxUnitProxy)}var t,r,n;return t=e,(r=[{key:"getRefCalcCell",value:function(){var e,t,r,n=this.calcCell,a=this.str_expression;if(-1!==a.indexOf("!")){var s=a.split("!");t=(0,i.getSanitizedSheetName)(s[0]),this.subSyntaxBuilder.addStringToCurUnit(s[0],[o.SINGLE_REF]),this.subSyntaxBuilder.addStringToCurUnit("!",[o.SPLIT_MARK]),e=n.workbookProxy.getSheetByName(t),r=s[1]}else e=n.calcSheet,t=n.calcSheet.name,r=a;if(this.subSyntaxBuilder.addStringToCurUnit(r,[o.SINGLE_REF]),!e)throw Error("Sheet "+t+" not found.");return this.calcCell.workbookProxy.getCellByName(t,r)}},{key:"solveExpression",value:function(){this.calcCell;var e=this.getRefCalcCell();if(!e.cellObj)return null;if(e.cellStatus===o.FORMULA_STATUS.created){if(e.execFormula(),"e"===e.cellObj.t)throw console.log("ref is an error at",e),new Error(e.cellObj.w);return e.cellObj.v}if(e.cellStatus===o.FORMULA_STATUS.working)throw new Error(a.ERROR_CIRCULAR);if(e.cellStatus===o.FORMULA_STATUS.solved){if("e"===e.cellObj.t)throw console.log("ref is an error after cellFormulaProxy eval"),new Error(e.cellObj.w);return e.cellObj.v}}}])&&u(t.prototype,r),n&&u(t,n),e}();t.SUnitRefValue=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFormula=b,t.Rows=void 0;var n=r(16),i=r(9),a=r(4),o=r(7),s=m(r(64)),l=r(7),u=m(r(65)),c=m(r(148)),f=m(r(80)),d=m(r(6)),h=m(r(30)),p=m(r(149));function m(e){return e&&e.__esModule?e:{default:e}}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e){return e&&"="===e[0]}function x(e,t,r,n,i,a,o,s){var l=this.getCellByTopCell(e,r,n,"other",s,0),u=l.text,c=l.formulas,f=""!==c?c:u;this.isFormula(f)?this.calcFormulaCellByTopCell(f,t,e,r,n,a):this.calcCellByTopCell(a,i,l,t,n,f,e,u)}function A(e,t,r,n,i,a,o,s){var l="";n?i=Math.abs(i):i*=-1,s?l=this.getCellByTopCell(e,r,n):(l={text:e.v,formulas:e.v},i=0),this.calcNumberCellByTopCell(l,i,t,e,a,o)}function S(e,t,r,n,i,a,o){var s=t,l="",u=r?1:-1;o?l=this.getCellByTopCell(e,s,r,"date"):(l={text:e.v,formulas:e.v},u=0),this.calcDateCellByTopCell(l,n,e,r,i,a,u)}var w=function(){function e(t){var r=t.len,n=t.height,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.height=n,this.data=i,this.pasteProxy=new c.default,this.workbook=null}var t,r,m;return t=e,(r=[{key:"getHeight",value:function(e){var t=this.get(e);return t&&t.height?t.height:this.height}},{key:"setHeight",value:function(e,t){this.getOrNew(e).height=t}},{key:"setStyle",value:function(e,t){this.getOrNew(e).style=t}},{key:"sumHeight",value:function(e,t,r){var i=this;return(0,n.rangeSum)(e,t,(function(e){return r&&r.has(e)?0:i.getHeight(e)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(e){return this._[e]}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{cells:{}},this._[e]}},{key:"getCell",value:function(e,t){var r=this.get(e);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[t]&&((0,i.isHave)(r.cells[t].text)||(0,i.isHave)(r.cells[t].formulas)||(0,i.isHave)(r.cells[t].style||"object"===g(r.cells[t])))?r.cells[t]:null}},{key:"getCellMerge",value:function(e,t){var r=this.getCell(e,t);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(e,t){var r=this.getOrNew(e);return r.cells[t]=r.cells[t]||{},r.cells[t]}},{key:"toString",value:function(e){return!1===(0,i.isHave)(e)&&(e=""),e+""}},{key:"isBackEndFunc",value:function(e){return-1!==e.indexOf("MD.RTD")}},{key:"isReferOtherSheet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.formulas&&"="===e.formulas[0]&&(t||(0,l.isSheetVale)(e.formulas))}},{key:"isEmpty",value:function(e){return e&&(e.text||e.formulas||e.depend)}},{key:"isFormula",value:function(e){return b(e)}},{key:"setValue",value:function(e,t,r){r[e]=t}},{key:"setCell",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.data,s=this.getOrNew(e),l=new p.default;if(l.setCell(r),"all"===n)s.cells[t]=l;else if("formulas"===n)s.cells[t]=s.cells[t]||{},s.cells[t].formulas=l.formulas;else if("text"===n)s.cells[t]=s.cells[t]||{},s.cells[t].text=l.text;else if("format"===n)s.cells[t]=s.cells[t]||{},s.cells[t].style=l.style,r.merge&&(s.cells[t].merge=l.merge);else if("date"===n||"datetime"===n)(0,i.isHave)(s.cells[t])||(s.cells[t]={}),this.isFormula(r.formulas)?s.cells[t].formulas=l.formulas:s.cells[t].formulas=l.text,s.cells[t].text=l.text,s.cells[t].style=l.style,s.cells[t].to_calc_num=l.to_calc_num;else if("normal"===n||"number"===n)(0,i.isHave)(s.cells[t])||(s.cells[t]={}),this.isFormula(r.formulas)?s.cells[t].formulas=l.formulas:s.cells[t].formulas=l.text,s.cells[t].text=l.text,s.cells[t].style=l.style;else if("rmb"===n||"percent"===n)(0,i.isHave)(s.cells[t])||(s.cells[t]={}),s.cells[t].text=l.text,s.cells[t].formulas=l.formulas,s.cells[t].style=l.style;else{if("all_with_no_workbook"===n)return void(s.cells[t]=l);if("style"===n)return(0,i.isHave)(s.cells[t])||(s.cells[t]={}),void(s.cells[t].style=l.style);"assign"===n&&Object.assign(s.cells[t],r)}this.getDependCell((0,a.xy2expr)(t,e),this.getCell(e,t)),l.setFormatText(o.tryParseToNum(l,e,t))}},{key:"getDependCell",value:function(e,t){var r=t.formulas;if(!1!==(0,i.isHave)(r)&&b(r)){for(var n=(0,o.cutStr)(r,!0,!0),s=0;s<n.length;s++){var u,c=this.mergeCellExpr(n[s]);c.state&&(u=n).push.apply(u,y(c.mergeArr))}n=(0,l.distinct)(n),!1===(0,i.isHave)(t.depend)&&(t.depend=[]);for(var f=0;f<n.length;f++){var d=n[f],h=v((0,a.expr2xy)(d),2),p=h[0],m=h[1],g=this.getCell(m,p);!1===(0,i.isHave)(g)&&(g={}),!1===(0,i.isHave)(g.depend)&&(g.depend=[]),g.depend.push(e),g.depend=(0,l.distinct)(g.depend),this.setCell(m,p,g,"all_with_no_workbook")}}}},{key:"mergeCellExpr",value:function(e){if(!(0,o.isAbsoluteValue)(e,6))return{state:!1};e=(e=e.replace(/\$/g,"")).split(":");var t=(0,a.expr2xy)(e[0]),r=(0,a.expr2xy)(e[1]);if(t[0]>r[0]){var n=r[0];r[0]=t[0],t[0]=n}if(t[1]>r[1]){var i=r[1];r[1]=t[1],t[1]=i}var s=new d.default(t[1],t[0],r[1],r[0]),l=[];return s.each((function(e,t){l.push((0,a.xy2expr)(t,e))})),{state:!0,mergeArr:l}}},{key:"useOne",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!1===(0,i.isHave)(e)?t:r&&this.isFormula(e)?t:e}},{key:"setCellText",value:function(e,t,r){var n=r.text,i=r.style,o=r.formulas,s=r.merge,l=void 0===s?"":s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all";if("all_with_no_workbook"!==u){var c=this.getCellOrNew(e,t),f=new p.default;f.setCell(c),"style"===u?(f.style=i,f.formulas=n):"format"===u?(f.formulas=c.formulas,f.style=i):"cell"===u?(f.style=i,f.formulas=o,f.merge=void 0,""!==l&&(f.merge=l)):f.formulas=n,f.text=n,this.setCell(e,t,f),this.getDependCell((0,a.xy2expr)(t,e),this.getCell(e,t))}else this.setCell(e,t,{},"all_with_no_workbook")}},{key:"setCellAll",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=this.getCellOrNew(e,t),o=new p.default;o.formulas=""===n?i.formulas:n,o.text=r,this.setCell(e,t,o,"formulas"),this.setCell(e,t,o,"text"),this.getDependCell((0,a.xy2expr)(t,e),this.getCell(e,t))}},{key:"moveChange",value:function(e,t,r){var n=this;if(e.length===t.length||r.length===t.length)for(var a=function(a){var s=e[a].expr;e[a].each((function(e,l){var u=n.getCell(e,l);!1===(0,i.isHave)(u)&&(u={}),(0,i.isHave)(u.formulas)||(u.formulas="");var c=(0,o.changeFormula)((0,o.cutStr)(u.formulas));if(-1!==c.indexOf(s)){var f=r[a].expr.replace(/\$/g,"\\$");n.setCellAll(e,l,u.text.replace(new RegExp(f,"g"),t[a].expr),u.formulas.replace(f,t[a].expr))}else{var d=(0,o.value2absolute)(s),h=(0,o.value2absolute)(t[a].expr);-1!==c.indexOf(d.s3)?((d=(0,o.value2absolute)(r[a].expr)).s3=d.s3.replace(/\$/g,"\\$"),n.setCellAll(e,l,u.text.replace(new RegExp(d.s3,"g"),h.s3),u.formulas.replace(new RegExp(d.s3,"g"),h.s3))):-1!==c.indexOf(d.s2)?((d=(0,o.value2absolute)(r[a].expr)).s2=d.s2.replace(/\$/g,"\\$"),n.setCellAll(e,l,u.text.replace(new RegExp(d.s2,"g"),h.s2),u.formulas.replace(new RegExp(d.s2,"g"),h.s2))):-1!==c.indexOf(d.s1)&&((d=(0,o.value2absolute)(r[a].expr)).s1=d.s1.replace(/\$/g,"\\$"),n.setCellAll(e,l,u.text.replace(new RegExp(d.s1,"g"),h.s1),u.formulas.replace(new RegExp(d.s1,"g"),h.s1)))}}))},s=0;s<e.length;s++)a(s)}},{key:"formatMoney",value:function(e,t){if(/[^0-9\.]/.test(e))return"0";if(null==e||""===e)return"0";e=(e=((e=e.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var r=/(\d)(\d{3},)/;r.test(e);)e=e.replace(r,"$1,$2");if(e=e.replace(/,(\d\d)$/,".$1"),0===t){var n=e.split(".");"00"===n[1]&&(e=n[0])}return e}},{key:"getCellStyleConvert",value:function(e,t){return e&&e.format&&"number"===e.format?"number":e&&e.format&&"rmb"===e.format?"rmb":e&&e.format&&"normal"===e.format?"normal":e&&e.format&&"percent"===e.format?"percent":e&&e.format&&"datetime"===e.format?"datetime":t&&!(0,i.isHave)(e)||t&&e&&"normal"!==e.format||e&&e.format&&"date"===e.format?"date":""}},{key:"getCellTextIsAdd",value:function(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7?arguments[7]:void 0,u=!1,c="";return e&&(t<=r[1]&&n&&l?(c=(0,a.xy2expr)(r[0]+i,r[1]+o,s),u=!0):t<=r[1]&&!n&&l?(c=(0,a.xy2expr)(r[0]+i,r[1]+o,s),u=!0):t<=r[0]&&n&&!1===l&&(c=(0,a.xy2expr)(r[0]+i,r[1]+o,s),u=!0)),{enter:u,data:c}}},{key:"eachRange",value:function(e){var t=this,r=[];return e.each((function(e,n){var o,s,u,c=t.getCell(e,n);if((0,i.isHave)(c)){var f=(o=c,!((0,i.isHave)(o)&&""!==o||(0,i.isHave)(s)&&""!==s||(0,i.isHave)(u)));c=(0,l.deepCopy)(c);var d=new h.default(e,n,c,(0,a.xy2expr)(n,e),f);r.push(d)}else{c={};var p=new h.default(e,n,c,(0,a.xy2expr)(n,e),!0);r.push(p)}})),r}},{key:"getCellTextByShift",value:function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=!1,c=!1,f="",d=0;d<e.length;d++){if("string"==typeof e[d]&&(e[d]=e[d].toUpperCase()),-1!==e[d].search(/^[A-Z]+\d+$/)){var h=(0,a.expr2xy)(e[d]);(h[0]+t<0||h[1]+r<0)&&(u=!0);var p=this.getCellTextIsAdd(n,s,h,i,t,r,0,l);p.enter?e[d]=p.data:!1===n&&(e[d]=(0,a.xy2expr)(h[0]+t,h[1]+r)),c=!0}else if(-1!==e[d].search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var m=e[d].split(":")[0],v=e[d].split(":")[1],y=(0,a.expr2xy)(m),g=(0,a.expr2xy)(v);(y[0]+t<0||y[1]+r<0)&&(u=!0),(g[0]+t<0||g[1]+r<0)&&(u=!0);var E="",b=this.getCellTextIsAdd(n,s,y,i,t,r,0,l);E=b.enter?b.data+":":!1===n?(0,a.xy2expr)(y[0]+t,y[1]+r)+":":m+":",(b=this.getCellTextIsAdd(n,s,g,i,t,r,0,l)).enter?E+=b.data:E+=!1===n?(0,a.xy2expr)(g[0]+t,g[1]+r):v,c=!0,e[d]=E}else{var x=(0,o.isAbsoluteValue)(e[d],5);if(2===x){var A=(0,a.expr2xy)(e[d].replace(/\$/g,""));(A[0]+t<0||A[1]+r<0)&&(u=!0);var S=this.getCellTextIsAdd(n,s,A,i,t,r,2,l);S.enter?e[d]=S.data:!1===n&&(e[d]=(0,a.xy2expr)(A[0]+t,A[1],2)),c=!0}else if(1===x){var w=(0,a.expr2xy)(e[d].replace(/\$/g,""));(w[0]+t<0||w[1]+r<0)&&(u=!0);var R=this.getCellTextIsAdd(n,s,w,i,t,r,1,l);R.enter?e[d]=R.data:!1===n&&(e[d]=(0,a.xy2expr)(w[0],w[1]+r,1)),c=!0}else if(4===x){var C=e[d].split(":");console.log(e[d],C);for(var T=0;T<C.length;T++){var O=(0,a.expr2xy)(C[T].replace(/\$/g,""));(O[0]+t<0||O[1]+r<0)&&(u=!0);var _=this.getCellTextIsAdd(n,s,O,i,t,r,2,l);_.enter?C[T]=_.data:!1===n&&(C[T]=(0,a.xy2expr)(O[0]+t,O[1],2))}e[d]=C.join(":"),c=!0}else if(5===x){for(var D=e[d].split(":"),N=0;N<D.length;N++){var k=(0,a.expr2xy)(D[N].replace(/\$/g,""));if((k[0]+t<0||k[1]+r<0)&&(u=!0),1===N){var M=this.getCellTextIsAdd(n,s,k,i,t,r,1,l);M.enter?D[N]=M.data:!1===n&&(D[N]=(0,a.xy2expr)(k[0],k[1]+r,1))}else{var I=this.getCellTextIsAdd(n,s,k,i,t,r,2,l);I.enter?D[N]=I.data:!1===n&&(D[N]=(0,a.xy2expr)(k[0],k[1]+r,2))}}e[d]=D.join(":"),c=!0}else if(7===x){for(var P=e[d].split(":"),F=0;F<P.length;F++){var L=(0,a.expr2xy)(P[F].replace(/\$/g,""));(L[0]+t<0||L[1]+r<0)&&(u=!0);var j=this.getCellTextIsAdd(n,s,L,i,t,r,1,l);j.enter?P[F]=j.data:!1===n&&(P[F]=(0,a.xy2expr)(L[0],L[1]+r,1))}e[d]=P.join(":"),c=!0}else if(6===x){for(var B=e[d].split(":"),U=0;U<B.length;U++){var V=(0,a.expr2xy)(B[U].replace(/\$/g,""));if((V[0]+t<0||V[1]+r<0)&&(u=!0),0===U){var H=this.getCellTextIsAdd(n,s,V,i,t,r,1,l);H.enter?B[U]=H.data:!1===n&&(B[U]=(0,a.xy2expr)(V[0],V[1]+r,1))}else{var z=this.getCellTextIsAdd(n,s,V,i,t,r,2,l);z.enter?B[U]=z.data:!1===n&&(B[U]=(0,a.xy2expr)(V[0]+t,V[1],2))}}e[d]=B.join(":"),c=!0}else if(8===x){for(var X=e[d].split(":"),q=0;q<X.length;q++){var W=(0,a.expr2xy)(X[q].replace(/\$/g,""));if((W[0]+t<0||W[1]+r<0)&&(u=!0),0===q){var G=this.getCellTextIsAdd(n,s,W,i,t,r,0,l);G.enter?X[q]=G.data:!1===n&&(X[q]=(0,a.xy2expr)(W[0]+t,W[1]+r,0))}else{var Y=this.getCellTextIsAdd(n,s,W,i,t,r,1,l);Y.enter?X[q]=Y.data:!1===n&&(X[q]=(0,a.xy2expr)(W[0]+t,W[1],1))}}e[d]=X.join(":"),c=!0}else if(9===x){for(var J=e[d].split(":"),$=0;$<J.length;$++){var K=(0,a.expr2xy)(J[$].replace(/\$/g,""));if((K[0]+t<0||K[1]+r<0)&&(u=!0),0===$){var Q=this.getCellTextIsAdd(n,s,K,i,t,r,1,l);Q.enter?J[$]=Q.data:!1===n&&(J[$]=(0,a.xy2expr)(K[0]+t,K[1]+r,0))}else{var Z=this.getCellTextIsAdd(n,s,K,i,t,r,2,l);Z.enter?J[$]=Z.data:!1===n&&(J[$]=(0,a.xy2expr)(K[0]+t,K[1],2))}}e[d]=J.join(":"),c=!0}else if(10===x){for(var ee=e[d].split(":"),te=0;te<ee.length;te++){var re=(0,a.expr2xy)(ee[te].replace(/\$/g,""));if((re[0]+t<0||re[1]+r<0)&&(u=!0),1===te){var ne=this.getCellTextIsAdd(n,s,re,i,t,r,0,l);ne.enter?ee[te]=ne.data:!1===n&&(ee[te]=(0,a.xy2expr)(re[0]+t,re[1]+r,0))}else{var ie=this.getCellTextIsAdd(n,s,re,i,t,r,2,l);ie.enter?ee[te]=ie.data:!1===n&&(ee[te]=(0,a.xy2expr)(re[0]+t,re[1],2))}}e[d]=ee.join(":"),c=!0}else if(11===x){for(var ae=e[d].split(":"),oe=0;oe<ae.length;oe++){var se=(0,a.expr2xy)(ae[oe].replace(/\$/g,""));if((se[0]+t<0||se[1]+r<0)&&(u=!0),1===oe){var le=this.getCellTextIsAdd(n,s,se,i,t,r,0,l);le.enter?ae[oe]=le.data:!1===n&&(ae[oe]=(0,a.xy2expr)(se[0]+t,se[1]+r,0))}else{var ue=this.getCellTextIsAdd(n,s,se,i,t,r,1,l);ue.enter?ae[oe]=ue.data:!1===n&&(ae[oe]=(0,a.xy2expr)(se[0]+t,se[1],1))}}e[d]=ae.join(":"),c=!0}}f+=e[d]}return{bad:u,enter:c,result:f}}},{key:"autoFilterRef",value:function(e,t){for(var r=v((0,a.expr2xy)(e),2),n=r[0],i=r[1],o=this.getCell(i,n);null!==o;)i+=1,o=this.getCell(i,n);return t.eri=i,t}},{key:"getAllDataType",value:function(e){var t=this,r=!0,n=!0,i=[];return e.each((function(e,a){var o=!1,s=t.getCell(e,a);if(s){s=(0,l.deepCopy)(s);var u=new f.default(s).getCellDataType(i,{isDate:n,isNumber:r});n=u.isDate,r=u.isNumber}else o=!0,r=!1,n=!1;o&&i.push({text:0,formulas:0,tmp:"",type:"other"})})),{isDate:n,isNumber:r,sarr:i}}},{key:"calcNumberCellByTopCell",value:function(e,t,r,n,i,a){var o=e.text,s=e.formulas;o=this.toString(o),s=this.toString(s);var l={};if(this.isFormula(s)){var u=1*o.replace("=","")+t;l={text:"="+u,formulas:"="+u}}else if(""!==o){var c=1*o;if(-1!==o.indexOf(",")){c=c.replace(/,/g,"");var f=parseFloat(c)+t;c=this.formatMoney(f,0)}else c+=t;l={text:c+"",formulas:c+""}}this.copyRender(r,n.ri,n.ci,l,i,a)}},{key:"calcFormulaCellByTopCell",value:function(e,t,r,n,i,a){var o=(0,l.splitStr)(e),s=this.getRangeByTopCell({ri:r.ri,ci:r.ci},n,i),u=r.ri-s.ri,c=r.ci-s.ci,f=this.getCellTextByShift(o,c,u),d=f.bad,h=f.result;this.updateCellReferenceByShift(d,h,r.ri,r.ci,a)}},{key:"calcCellByTopCell",value:function(e,t,r,n,a,o,s,l){if((0,i.isHave)(o)||(o=""),isNaN(o)){var u=this.toString(o).split(/\d+/g);if(u){var c=0;r.text=a?o.replace(/\d+/g,(function(e){return c+=1,u.length-1===c?1*e+1:e})):o.replace(/\d+/g,(function(e){return c+=1,u.length-1===c?1*e-1:e})),r.formulas=r.text}}else r.text=o,r.formulas=r.text;this.copyRender(n,s.ri,s.ci,r,t,e)}},{key:"calcDateCellByTopCell",value:function(e,t,r,n,i,a,o){if(""!==e.text){var l=e.text,u="";u=(0,s.default)(l).add(o,"day").format("YYYY-MM-DD"),e.text=this.toString(u),e.formulas=this.toString(u),this.copyRender(t,r.ri,r.ci,e,i,a)}}},{key:"getRangeByTopCell",value:function(e,t,r){var n=e.ri,i=e.ci;return r?(n=t?n:n-1,i=t?i-1:i):(n=t?n:n+1,i=t?i+1:i),{ri:n,ci:i}}},{key:"getCellByTopCell",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(arguments.length>5&&void 0!==arguments[5]&&arguments[5],"date"!==n){var a=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},t,r),o=a.ri,s=a.ci;return this.getCellByCell(o,s)}if(1===t){var l=this.getRangeByTopCell({ri:r?e.ri-i:e.ri+i,ci:e.ci},!1,r),u=l.ri,c=l.ci;return this.getCellByCell(u,c)}return 2===t?this.getCellByCell(e.ri,e.ci-1):3===t?this.getCellByCell(e.ri,e.ci+1):void 0}},{key:"getCellByCell",value:function(e,t){var r=this.getCell(e,t);return r||(r={text:"",formulas:""}),(0,n.cloneDeep)(r)}},{key:"updateCellReferenceByShift",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a={};e?(a.text="#REF!",a.formulas="#REF!"):(a.text=""!==t?t:"",a.formulas=""!==t?t:""),this.setCell(r,n,a,"all"),i(r,n,a)}},{key:"copyPaste",value:function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},i=this.pasteProxy;i.setSrcAndDstCellRange(e,t);for(var a=i.use(),o=a.rn,s=a.cn,l=i.autoFilterDirection(),u=l?o:s,c=0;c<u;c++){for(var f=i.upOrDown(),d=i.getOneDRangeObj(l,c),h=d.srcOneDRange,p=d.dstOneDRange,m=this.getAllDataType(h),v=m.isNumber,y=m.isDate,g=m.sarr,E=p.getLocationArray(g),b=i.leftOrRight(),w=!1,R=0;R<E.length;R++){var C=E[R];(v||"number"===C.type||y||"date"===C.type)&&(w=!0)}if(f)for(var T=0;T<E.length;T++){var O=E[T];if(v||"number"===O.type){var _=i.calcDiff(g,f);A.call(this,E[T],E,l,f,_,r,n,v)}else y||"date"===O.type?S.call(this,E[T],b,f,E,r,n,y):x.call(this,E[T],E,l,f,r,n,w,g.length-1)}else for(var D=E.length-1;D>=0;D--){var N=E[D];if(v||"number"===N.type){var k=i.calcDiff(g,f);A.call(this,E[D],E,l,f,k,r,n,v)}else y||"date"===N.type?S.call(this,E[D],b,f,E,r,n,y):x.call(this,E[D],E,l,f,r,n,w,g.length-1)}}}},{key:"copyRender",value:function(e,t,r,n,i,a){for(var o=!1,s=0;!1===o&&s<e.length;s++)e[s].ri===t&&e[s].ci===r&&(o=!0);o&&(this.setCell(t,r,n,i),a(t,r,n))}},{key:"cutPaste",value:function(e,t){var r=this,n=[];this.each((function(i){r.eachCells(i,(function(a){var o=parseInt(i,10),s=parseInt(a,10);e.includes(i,a)&&(o=t.sri+(o-e.sri),s=t.sci+(s-e.sci)),1*i===o&&1*a===s||""!==r._[i].cells[a].text&&""!==r._[i].cells[a].formulas&&n.push({nri:o,nci:s,ri:i,ci:a,cell:(0,l.deepCopy)(r._[i].cells[a])})}))}));for(var i=0;i<n.length;i++){var a=n[i],o=a.ri,s=a.ci;this.setCell(o,s,{},"all")}for(var u=0;u<n.length;u++){var c=n[u],f=c.nri,d=c.nci,h=c.cell;this.setCell(f,d,h,"all")}}},{key:"insert",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={},a=[];this.each((function(o,s){var u=parseInt(o,10);u>=e&&(u+=r,t.eachCells(o,(function(n,o){if((0,i.isHave)(o)&&(0,i.isHave)(o.formulas)&&t.isFormula(o.formulas)){var s=t.getCellTextByShift((0,l.splitStr)(o.formulas),0,r,!0,!0,e,!0),c=s.bad,f=s.result;s.enter&&!c&&a.push({ri:u,ci:n,cell:{text:f,formulas:f}})}}))),n[u]=s})),this._=n;for(var o=0;o<a.length;o++){var s=a[o],u=s.ri,c=s.ci,f=s.cell;this.setCell(u,c,f,"all")}this.len+=r}},{key:"delete",value:function(e,t){var r=this,n=t-e+1,a={},o=[];this.each((function(s,u){var c=parseInt(s,10);c<e?a[c]=u:s>t&&(a[c-n]=u,r.eachCells(s,(function(t,a){if((0,i.isHave)(a)&&(0,i.isHave)(a.formulas)&&r.isFormula(a.formulas)){var s=r.getCellTextByShift((0,l.splitStr)(a.formulas),0,-1*n,!0,!1,e,!0),u=s.bad,f=s.result;s.enter&&!u&&o.push({ri:c-n,ci:t,cell:{text:f,formulas:f}})}})))})),this._=a;for(var s=0;s<o.length;s++){var u=o[s],c=u.ri,f=u.ci,d=u.cell;this.setCell(c,f,d,"all")}this.len-=n}},{key:"insertColumn",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];this.each((function(a,o){var s={};t.eachCells(a,(function(o,u){var c=parseInt(o,10);if(c>=e&&(c+=r,(0,i.isHave)(u)&&(0,i.isHave)(u.formulas)&&t.isFormula(u.formulas))){var f=t.getCellTextByShift((0,l.splitStr)(u.formulas),r,0,!0,!0,e,!1),d=f.bad,h=f.result;f.enter&&!d&&n.push({ri:a,ci:c,cell:{text:h,formulas:h}})}s[c]=u})),o.cells=s}));for(var a=0;a<n.length;a++){var o=n[a],s=o.ri,u=o.ci,c=o.cell;this.setCell(s,u,c,"all")}}},{key:"deleteColumn",value:function(e,t){var r=this,n=t-e+1;this.each((function(i,a){var o={};r.eachCells(i,(function(r,i){var a=parseInt(r,10);a<e?o[a]=i:a>t&&(o[a-n]=i)})),a.cells=o}))}},{key:"deleteCells",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";e.each((function(e,n){t.deleteCell(e,n,r)}))}},{key:"deleteCell",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(e);if(null!==n){var a=this.getCell(e,t);null!==a&&("all"===r?delete n.cells[t]:"text"===r?((0,i.isHave)(a.text)&&delete a.text,(0,i.isHave)(a.value)&&delete a.value,(0,i.isHave)(a.formulas)&&delete a.formulas):"format"===r?(void 0!==a.style&&delete a.style,a.merge&&delete a.merge):"merge"===r&&a.merge&&delete a.merge)}}},{key:"each",value:function(e){Object.entries(this._).forEach((function(t){var r=v(t,2),n=r[0],i=r[1];e(n,i)}))}},{key:"eachCells",value:function(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach((function(e){var r=v(e,2),n=r[0],i=r[1];t(n,i)}))}},{key:"recast",value:function(e){try{if(this.isReferOtherSheet(e,!0)){var t=new u.default(e.formulas);t.parse(),e.recast=t}else e.recast=null}catch(t){e.recast=null}}},{key:"init",value:function(){var e=this;this.each((function(t){e.eachCells(t,(function(r){e.getDependCell((0,a.xy2expr)(r,t),e.getCell(t,r))}))}))}},{key:"setData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{e.len&&(this.len=e.len,delete e.len),this._=e,r||""!==t&&(console.time("setData"),n&&(this.init(),t.toolbar.change("close","")),console.timeEnd("setData"))}catch(e){console.error(e)}}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}}])&&E(t.prototype,r),m&&E(t,m),e}();t.Rows=w},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(13));t.default=function(e){var t=e.use(i.default).Type,r=t.def,n=t.or,o=e.use(a.default),s=o.defaults,l=o.geq;r("Printable").field("loc",n(r("SourceLocation"),null),s.null,!0),r("Node").bases("Printable").field("type",String).field("comments",n([r("Comment")],null),s.null,!0),r("SourceLocation").field("start",r("Position")).field("end",r("Position")).field("source",n(String,null),s.null),r("Position").field("line",l(1)).field("column",l(0)),r("File").bases("Node").build("program","name").field("program",r("Program")).field("name",n(String,null),s.null),r("Program").bases("Node").build("body").field("body",[r("Statement")]),r("Function").bases("Node").field("id",n(r("Identifier"),null),s.null).field("params",[r("Pattern")]).field("body",r("BlockStatement")).field("generator",Boolean,s.false).field("async",Boolean,s.false),r("Statement").bases("Node"),r("EmptyStatement").bases("Statement").build(),r("BlockStatement").bases("Statement").build("body").field("body",[r("Statement")]),r("ExpressionStatement").bases("Statement").build("expression").field("expression",r("Expression")),r("IfStatement").bases("Statement").build("test","consequent","alternate").field("test",r("Expression")).field("consequent",r("Statement")).field("alternate",n(r("Statement"),null),s.null),r("LabeledStatement").bases("Statement").build("label","body").field("label",r("Identifier")).field("body",r("Statement")),r("BreakStatement").bases("Statement").build("label").field("label",n(r("Identifier"),null),s.null),r("ContinueStatement").bases("Statement").build("label").field("label",n(r("Identifier"),null),s.null),r("WithStatement").bases("Statement").build("object","body").field("object",r("Expression")).field("body",r("Statement")),r("SwitchStatement").bases("Statement").build("discriminant","cases","lexical").field("discriminant",r("Expression")).field("cases",[r("SwitchCase")]).field("lexical",Boolean,s.false),r("ReturnStatement").bases("Statement").build("argument").field("argument",n(r("Expression"),null)),r("ThrowStatement").bases("Statement").build("argument").field("argument",r("Expression")),r("TryStatement").bases("Statement").build("block","handler","finalizer").field("block",r("BlockStatement")).field("handler",n(r("CatchClause"),null),(function(){return this.handlers&&this.handlers[0]||null})).field("handlers",[r("CatchClause")],(function(){return this.handler?[this.handler]:[]}),!0).field("guardedHandlers",[r("CatchClause")],s.emptyArray).field("finalizer",n(r("BlockStatement"),null),s.null),r("CatchClause").bases("Node").build("param","guard","body").field("param",n(r("Pattern"),null),s.null).field("guard",n(r("Expression"),null),s.null).field("body",r("BlockStatement")),r("WhileStatement").bases("Statement").build("test","body").field("test",r("Expression")).field("body",r("Statement")),r("DoWhileStatement").bases("Statement").build("body","test").field("body",r("Statement")).field("test",r("Expression")),r("ForStatement").bases("Statement").build("init","test","update","body").field("init",n(r("VariableDeclaration"),r("Expression"),null)).field("test",n(r("Expression"),null)).field("update",n(r("Expression"),null)).field("body",r("Statement")),r("ForInStatement").bases("Statement").build("left","right","body").field("left",n(r("VariableDeclaration"),r("Expression"))).field("right",r("Expression")).field("body",r("Statement")),r("DebuggerStatement").bases("Statement").build(),r("Declaration").bases("Statement"),r("FunctionDeclaration").bases("Function","Declaration").build("id","params","body").field("id",r("Identifier")),r("FunctionExpression").bases("Function","Expression").build("id","params","body"),r("VariableDeclaration").bases("Declaration").build("kind","declarations").field("kind",n("var","let","const")).field("declarations",[r("VariableDeclarator")]),r("VariableDeclarator").bases("Node").build("id","init").field("id",r("Pattern")).field("init",n(r("Expression"),null),s.null),r("Expression").bases("Node"),r("ThisExpression").bases("Expression").build(),r("ArrayExpression").bases("Expression").build("elements").field("elements",[n(r("Expression"),null)]),r("ObjectExpression").bases("Expression").build("properties").field("properties",[r("Property")]),r("Property").bases("Node").build("kind","key","value").field("kind",n("init","get","set")).field("key",n(r("Literal"),r("Identifier"))).field("value",r("Expression")),r("SequenceExpression").bases("Expression").build("expressions").field("expressions",[r("Expression")]);var u=n("-","+","!","~","typeof","void","delete");r("UnaryExpression").bases("Expression").build("operator","argument","prefix").field("operator",u).field("argument",r("Expression")).field("prefix",Boolean,s.true);var c=n("==","!=","===","!==","<","<=",">",">=","<<",">>",">>>","+","-","*","/","%","**","&","|","^","in","instanceof");r("BinaryExpression").bases("Expression").build("operator","left","right").field("operator",c).field("left",r("Expression")).field("right",r("Expression"));var f=n("=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","|=","^=","&=");r("AssignmentExpression").bases("Expression").build("operator","left","right").field("operator",f).field("left",n(r("Pattern"),r("MemberExpression"))).field("right",r("Expression"));var d=n("++","--");r("UpdateExpression").bases("Expression").build("operator","argument","prefix").field("operator",d).field("argument",r("Expression")).field("prefix",Boolean);var h=n("||","&&");r("LogicalExpression").bases("Expression").build("operator","left","right").field("operator",h).field("left",r("Expression")).field("right",r("Expression")),r("ConditionalExpression").bases("Expression").build("test","consequent","alternate").field("test",r("Expression")).field("consequent",r("Expression")).field("alternate",r("Expression")),r("NewExpression").bases("Expression").build("callee","arguments").field("callee",r("Expression")).field("arguments",[r("Expression")]),r("CallExpression").bases("Expression").build("callee","arguments").field("callee",r("Expression")).field("arguments",[r("Expression")]),r("MemberExpression").bases("Expression").build("object","property","computed").field("object",r("Expression")).field("property",n(r("Identifier"),r("Expression"))).field("computed",Boolean,(function(){var e=this.property.type;return"Literal"===e||"MemberExpression"===e||"BinaryExpression"===e})),r("Pattern").bases("Node"),r("SwitchCase").bases("Node").build("test","consequent").field("test",n(r("Expression"),null)).field("consequent",[r("Statement")]),r("Identifier").bases("Expression","Pattern").build("name").field("name",String).field("optional",Boolean,s.false),r("Literal").bases("Expression").build("value").field("value",n(String,Boolean,null,Number,RegExp)).field("regex",n({pattern:String,flags:String},null),(function(){if(this.value instanceof RegExp){var e="";return this.value.ignoreCase&&(e+="i"),this.value.multiline&&(e+="m"),this.value.global&&(e+="g"),{pattern:this.value.source,flags:e}}return null})),r("Comment").bases("Printable").field("value",String).field("leading",Boolean,s.true).field("trailing",Boolean,s.false)},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={parser:r(136),tabWidth:4,useTabs:!1,reuseWhitespace:!0,lineTerminator:r(143).EOL||"\n",wrapColumn:74,sourceFileName:null,sourceMapName:null,sourceRoot:null,inputSourceMap:null,range:!1,tolerant:!0,quote:null,trailingComma:!1,arrayBracketSpacing:!1,objectCurlySpacing:!0,arrowParensAlways:!1,flowObjectCommas:!0,tokens:!0},i=n.hasOwnProperty;t.normalize=function(e){var t=e||n;function r(e){return i.call(t,e)?t[e]:n[e]}return{tabWidth:+r("tabWidth"),useTabs:!!r("useTabs"),reuseWhitespace:!!r("reuseWhitespace"),lineTerminator:r("lineTerminator"),wrapColumn:Math.max(r("wrapColumn"),0),sourceFileName:r("sourceFileName"),sourceMapName:r("sourceMapName"),sourceRoot:r("sourceRoot"),inputSourceMap:r("inputSourceMap"),parser:r("esprima")||r("parser"),range:r("range"),tolerant:r("tolerant"),quote:r("quote"),trailingComma:r("trailingComma"),arrayBracketSpacing:r("arrayBracketSpacing"),objectCurlySpacing:r("objectCurlySpacing"),arrowParensAlways:r("arrowParensAlways"),flowObjectCommas:r("flowObjectCommas"),tokens:!!r("tokens")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.process=m,t.mountImg=y,t.isHaveStyle=function(e,t){for(var r=0;r<e.length;r++)if(b(e[r],t))return r;return-1},t.mountPaste=function(e,t){for(var r=this,a=e.clipboardData,o=!1,s=0;s<a.items.length;s++){var l=a.items[s];if("string"===l.kind)l.getAsString((function(e){var t=(0,i.h)("head",""),a=(0,i.h)("span","");-1===e.indexOf("<span")&&-1===e.indexOf("span>")&&-1===e.indexOf("<table")&&-1===e.indexOf("table>")?(a.html(e),t.child(a.el),t=t.el):(t.html(e),t=t.el);var s=t.getElementsByTagName("img")[0],l=t.getElementsByTagName("style")[0],u=t.getElementsByTagName("table")[0],c=t.getElementsByTagName("span")[0];if(s&&!l)y.call(r,s),o=!0;else if(u){if(l)r.el.child(l);u&&!1===o&&(m.call(r,u,l),o=!0)}else setTimeout((function(){if(!o){if(c&&(u=p.call(r,c,u)),l)r.el.child(l);if(u&&!1===o)r.el.child(u),x.call(r,u),u.parentNode.removeChild(u),l&&l.parentNode.removeChild(l),n.sheetReset.call(r),o=!0}}),100)}));else if("file"===l.kind&&!o){var u=l.getAsFile(),c=new FileReader;if(c.onload=function(e){var t=(0,i.h)("img","paste-img");t.el.src=e.target.result,setTimeout((function(){o||(o=!0,y.call(r,t.el))}),0)},!u)return;c.readAsDataURL(u)}}setTimeout((function(){if(o){var e=r.data;e.change(e.getData())}else t()}))},t.hideDirectionArr=g,t.deleteImg=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data.pasteDirectionsArr,r=[],n=[];if(this.direction=!1,t.length>0)for(var i=0;i<t.length;i++)!0===t[i].state||!0===e?n.push(t[i]):r.push(t[i]);Object.keys(n).forEach((function(e){n[e].img.removeEl()})),this.pasteDirectionsArr=r;var a=this.data;a.pasteDirectionsArr=r,a.change(a.getData())},t.GetInfoFromTable=x,t.dragOption=t.resizeOption=void 0;var n=r(47),i=r(0),a=f(r(90)),o=f(r(194)),s=r(1),l=r(88),u=f(r(6)),c=f(r(195));function f(e){return e&&e.__esModule?e:{default:e}}var d={onBegin:function(e){console.log("obegin",e)},onEnd:function(e){},onResize:function(e,t){var r=l.getChooseImg.call(t);r&&(r.img2.style.width=r.img.el.style.width,r.img2.style.height=r.img.el.style.height)}};t.resizeOption=d;var h={onBegin:function(e){console.log("obegin",e)},onEnd:function(e,t){var r=e.left,n=e.top,i=l.getChooseImg.call(t);if(i){n-31<0?n=0:r-60<0&&(r=0);var a=t.data.getCellRectByXY(r+60,n+31);a.sri=a.ri,a.sci=a.ci,a.eri=a.ri,a.eci=a.ci;var o=r-a.left+50,s=n-a.top+21;i.offsetLeft=o,i.offsetTop=s,i.range=a,void 0!==i.lastCi&&void 0!==i.lastRi&&(i.ri=i.lastRi,i.ci=i.lastCi),i.lastCi=a.ci,i.lastRi=a.ri}},onDrag:function(e){}};function p(e,t){for(var r=(0,i.h)("table",""),n=(0,i.h)("tbody",""),a=e.innerText.split("\n"),o=0;o<a.length;o++){var s=a[o],l=(0,i.h)("tr",""),u=(0,i.h)("td","");u.html(s),u.css("background",e.style.background),u.css("font-weight",e.style["font-weight"]),u.css("color",e.style.color),l.child(u),n.child(l)}return r.child(n),r.el}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.el;this.data;r.child(e),x.call(this,e),e.parentNode.removeChild(e),t&&t.parentNode.removeChild(t),n.sheetReset.call(this)}function v(e,t){for(var r=0,n=0,i=this.data.pasteDirectionsArr,a=0,o=0;o<i.length;o++){var s=i[o];s.ri===e&&s.ci===t&&(n<s.nextLeft&&(n=s.nextLeft),r<s.nextTop&&(r=s.nextTop),a++)}return{top:r,left:n,number:a}}function y(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0,p=new Image;p.src=e.src,p.onload=function(){var m=p.width,y=p.height,g=e,b=t.container,x=t.data,A=x.pasteDirectionsArr,S=x.selector,w=S.ri,R=S.ci;r&&(w=n,R=c);var C=t.pictureOffsetLeft,T=t.pictureOffsetTop,O=x.getMoveRect(new u.default(w,R,w,R)),_=O.left+C,D=O.top+T,N=0,k=l.getChooseImg.call(t);if(k){var M=v.call(t,k.ri,k.ci);_=M.left,D=M.top,w=k.ri,R=k.ci,N=M.number}var I=(0,i.h)("div","".concat(s.cssPrefix,"-object-container")).css("position","absolute").css("top","".concat(D,"px")).css("width","".concat(m,"px")).css("height","".concat(y,"px")).css("z-index","100000").css("left","".concat(_,"px")).child(g);b.child(I),new a.default(h,t).register(I.el),setTimeout((function(){var e=t.data,n=new o.default(d,t).register(I.el),i=A.length;A.push({src:g.src,state:!0,arr:n,img:I,index:i,img2:g,ri:w,ci:R,offsetLeft:0,offsetTop:0,number:N,range:r?f:e.selector.range,top:D,left:_,nextLeft:_+15,nextTop:D+15}),r||t.data.change(t.data.getData()),t.direction=!0,I.css("width","".concat(g.offsetWidth,"px")),I.css("height","".concat(g.offsetHeight,"px")),E.call(t,n,i,A,r),I.on("mousedown",(function(){return E.call(t,n,i,A)}))}),0)}}function g(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++){var r=e[t].arr;if(r.length>0)for(var n=0;n<r.length;n++)r[n].style.display="none";e[t].state=!1,e[t].img.css("z-index","10000"),e[t].img2.style.border="none"}}function E(e,t,r,n){g.call(this),this.direction=!0,Object.keys(e).forEach((function(t){e[t].style.display="block"}));var i=this.selector,a=this.editor;n?g.call(this):(i.hide(),a.clear(),r[t].img.css("z-index","99999999"),r[t].state=!0)}function b(e,t){if(!(e instanceof Object)||!(t instanceof Object))return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;var r=Object.keys(e);for(var n in r){var i=e[n=r[n]]instanceof Object,a=t[n]instanceof Object;if(i&&a){var o=b(e[n],t[n]);if(!o)return o}else if(e[n]!==t[n])return!1}return!0}function x(e){var t=this.data,r=t.selector,n=r.ri,i=r.ci,a=t.styles;console.time("paste");var o=new c.default(t);o.extend(e,{ri:n,ci:i}),o.dealColSpan(e),o.dealStyle(e,{ri:n,ci:i});var s=o.dealReference(e,{ri:n,ci:i}).reference;this.setCellRange(s,o,!0,o.parseTableCellRange(e,{ri:n,ci:i})),this.footerContainerReset();var l=t.getSelectedRect(),u=l.left+l.width+60,f=l.top+l.height+31,d=this.advice;return this.editor.clear(),d.show(u,f,1,s,o),console.timeEnd("paste"),{rows:t.rows._,styles:a}}t.dragOption=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectorCellText=we,t.insertDeleteRowColumn=Oe,t.sheetReset=q,t.selectorSet=L,t.default=void 0;var n=r(0),i=r(8),a=M(r(154)),o=M(r(155)),s=M(r(82)),l=M(r(157)),u=M(r(168)),c=M(r(48)),f=M(r(169)),d=M(r(181)),h=M(r(185)),p=r(186),m=r(1),v=r(34),y=r(32),g=M(r(187)),E=r(31),b=r(46),x=r(88),A=M(r(188)),S=r(7),w=(r(81),M(r(6))),R=r(16),C=r(4),T=M(r(190)),O=M(r(191)),_=r(33),D=M(r(192)),N=M(r(89)),k=M(r(193));function M(e){return e&&e.__esModule?e:{default:e}}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function F(){var e=this.data,t=this.verticalScrollbar,r=this.horizontalScrollbar,n=e.getSelectedRect(),i=n.l,a=n.t,o=n.left,s=n.top,l=n.width,u=n.height,c=this.getTableOffset();if(Math.abs(o)+l>c.width)r.move({left:i+l-c.width});else{var f=e.freezeTotalWidth();o<f&&r.move({left:i-1-f})}if(Math.abs(1*s)+u>c.height)t.move({top:a+u-c.height-1});else{var d=e.freezeTotalHeight();s<d&&t.move({top:a-1-d})}}function L(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.table,o=this.selector,s=this.toolbar;e?o.setEnd(t,r,i,!0):o.set(t,r,n),s.reset(),clearTimeout(this.render_timer),this.render_timer=setTimeout((function(){a.render()}),100)}function j(e,t){var r=this.selector,n=this.data,i=this.editor,a=n.rows,o=n.cols;i.isCors&&(r.indexes=[i.ri,i.ci]);var s=P(r.indexes,2),l=s[0],u=s[1],c=r.range.eci;if(e){var f=P(r.moveIndexes,2);l=f[0],u=f[1]}"left"===t?u>0&&(u-=1):"right"===t?(c!==u&&(u=c),u<o.len-1&&(u+=1)):"up"===t?l>0&&(l-=1):"down"===t?l<a.len-1&&(l+=1):"row-first"===t?u=0:"row-last"===t?u=o.len-1:"col-first"===t?l=0:"col-last"===t&&(l=a.len-1),e&&(r.moveIndexes=[l,u]),r.selectCell.setData(l,u),r.selectCell.resetSelectOffset(),L.call(this,e,l,u),fe.call(this),F.call(this)}function B(e){if(0===e.buttons&&e.target.className!=="".concat(m.cssPrefix,"-resizer-hover")){var t=e.offsetX,r=e.offsetY,n=this.rowResizer,i=this.colResizer,a=this.tableEl,o=this.data,s=this.website,l=o.getCellRectByXY(e.offsetX,e.offsetY);s.show(l.ri,l.ci);var u=o.rows,c=o.cols;if(t>c.indexWidth&&r>u.height)return n.hide(),void i.hide();var f=a.box();l.ri>=0&&-1===l.ci?(l.width=c.indexWidth,n.show(l,{width:f.width})):n.hide(),-1===l.ri&&l.ci>=0?(l.height=u.height,i.show(l,{height:f.height})):i.hide()}}function U(e){var t=this.verticalScrollbar,r=this.data,n=r.settings.autoLoad,i=t.scroll().top,a=e.deltaY,o=r.rows;if(e.detail&&(a=40*e.detail),a>0&&!0===n){var s=r.scroll.ri+1;s<o.len&&t.move({top:i+o.getHeight(s)-1})}else if(!0===n){var l=r.scroll.ri-1;l>=0&&t.move({top:0===l?0:i-o.getHeight(l)})}}function V(e,t){var r=this.verticalScrollbar,n=this.horizontalScrollbar,i=r.scroll().top,a=n.scroll().left;"left"===e||"right"===e?n.move({left:a-t}):"up"!==e&&"down"!==e||r.move({top:i-t})}function H(){var e=this.data,t=this.verticalScrollbar,r=this.data.settings.footerContainerHeight,n=this.getTableOffset().height;t.set(n,e.rows.totalHeight()+r)}function z(){var e=this.data,t=this.horizontalScrollbar,r=this.getTableOffset().width;e&&t.set(r,e.cols.totalWidth())}function X(){var e=this.selector,t=this.data,r=this.editor,n=P(t.freeze,2),i=n[0],a=n[1];if(i>0||a>0){var o=t.freezeTotalWidth(),s=t.freezeTotalHeight();r.setFreezeLengths(o,s)}e.resetAreaOffset()}function q(){var e=this.tableEl,t=this.overlayerEl,r=this.overlayerCEl,n=this.table,i=this.toolbar,a=this.selector,o=this.el,s=this.getTableOffset(),l=this.getRect();e.attr(l),t.offset(l),r.offset(s),o.css("width","".concat(l.width,"px")),ge.call(this),Ee.call(this),H.call(this),z.call(this),X.call(this),a.selectCell.toolbarChangeSelectorCell(),n.render(),i.reset(),a.reset()}function W(){var e=this.data,t=this.selector;e.clearClipboard(),t.hideClipboard()}function G(){var e=this.data,t=this.selector;e.copy(),t.showClipboard()}function Y(){var e=this.data,t=this.selector;e.cut(),t.showClipboard()}function J(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e&&(W.call(t),q.call(t))},n=this.data.paste(e,(function(e){return(0,p.xtoast)("Tip",e)}));return r(n),n}function $(){this.data.autofilter(),q.call(this)}function K(){var e=this,t=this.toolbar,r=this.data;t.paintformatActive()&&(r.paintFormatChange((function(t,r){L.call(e,!0,t,r,!0,!0)})),W.call(this),t.paintformatToggle(),t.reset())}function Q(e,t,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0;this.selector.setBoxinner("none"),this.container.css("pointer-events","none");var f=n.getCellRectByXYWithNotTotalResult(e.layerX||e.clientX,e.layerY||e.clientY),d=f.ri,h=f.ci;if(t){var p=Z.call(this,n,r,i,u,l,e,a,c,d,h,s),m=p.rpos,v=p.ey,y=p.ex,g=r.showAutofill(d,h,m);(0,R.isOusideViewRange)(this.data.settings.view.height(),this.data.settings.view.width(),v,y,g)&&re.call(this,g,i,u,c,a,n)}else if(1===e.buttons&&!e.shiftKey){var E=n.viewRange().getMovePos(d,h);ee.call(this,E,i,u,c,a,n),console.log("ri: ",d,"ci: ",h),L.call(this,!0,d,h,!0,!0)}}function Z(e,t,r,n,i,a,o,s,l,u,c){var f=e.getRect(t.range),d=new O.default(f),h=f.width+f.left,p=f.height+f.top+m.offsetTop,v=a.clientX-i.l-m.offsetLeft,y=a.clientY;return d.isLocInside(v,y)?(c=-1,t.arange=null):c=d.getUpDownLeftRight(v,y,h,p),{rpos:c,ex:v,ey:y}}function ee(e,t,r,n,i,a){2===e?te.call(this,1,t,r,i,a,n):6===e?te.call(this,2,t,r,i,a,n):3===e?te.call(this,4,t,r,i,a,n):5===e?te.call(this,3,t,r,i,a,n):1===e?(te.call(this,1,t,r,i,a,n),te.call(this,4,t,r,i,a,n)):7===e?(te.call(this,1,t,r,i,a,n),te.call(this,3,t,r,i,a,n)):8===e?(te.call(this,2,t,r,i,a,n),te.call(this,4,t,r,i,a,n)):4===e&&(te.call(this,2,t,r,i,a,n),te.call(this,3,t,r,i,a,n))}function te(e,t,r,n,i,a){if(1===Math.round(Math.random())){var o=0,s=0;if(1===e){var l=t.scroll().top;o=i.scroll.ri+1,t.move({top:l+n.getHeight(o)-1})}else if(2===e){var u=t.scroll().top;o=i.scroll.ri-1,t.move({top:0===o?0:u-n.getHeight(o)})}else if(4===e){var c=r.scroll().left;s=i.scroll.ci+1,r.move({left:c+a.getWidth(s)})}else if(3===e){var f=r.scroll().left;s=i.scroll.ci-1,r.move({left:f-a.getWidth(s)})}}}function re(e,t,r,n,i,a){var o=0,s=0;if(44===e){var l=t.scroll().top;o=a.scroll.ri+1,t.move({top:l+i.getHeight(o)-1})}else if(22===e){var u=t.scroll().top;(o=a.scroll.ri-1)>=0&&t.move({top:0===o?0:u-i.getHeight(o)})}else if(33===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var c=r.scroll().left;s=a.scroll.ci+1,r.move({left:c+n.getWidth(s)})}else if(11===e&&1===Math.round(Math.random())&&1===Math.round(Math.random())){var f=r.scroll().left;s=a.scroll.ci-1,r.move({left:f-n.getWidth(s)})}}function ne(e){var t=this,r=this.selector,n=this.data,a=this.sortFilter,o=this.editor,s=this.advice,l=e.offsetX,u=e.offsetY,c=e.target.className==="".concat(m.cssPrefix,"-selector-corner"),f=n.getCellRectByXY(l,u),d=f.left,h=f.top,v=f.width,y=f.height,g=f.ri,E=f.ci;o.setRiCi(g,E);var x=n.autoFilter;if(b.hideDirectionArr.call(this),s.el.hide(),x.includes2(g,E)&&x.getSet(n.exceptRowSet,g),x.includes(g,E)&&d+v-20<l&&h+y-20<u){var A=x.items(E,(function(e,t){return n.rows.getCell(e,t)}));return a.set(E,A,x.getFilter(E),x.getSort(E)),void a.setOffset({left:d,top:h+y+2})}if(!e.shiftKey){c?r.showAutofill(g,E):L.call(this,!1,g,E);var S=this.verticalScrollbar,w=this.horizontalScrollbar,R=n.rows,C=n.cols;g=n.scroll.ri+1;var T=function(e){for(var t=e.offsetTop,r=e.offsetLeft;e=e.offsetParent;)t+=e.offsetTop,r+=e.offsetLeft;return{t:t,l:r}}(this.el.el);(0,i.mouseMoveUp)(window,(function(i){console.log("dropdown"),ae.call(t),ie.call(t,i,c,r,n,S,R,e,T,w,C),Q.call(t,i,c,r,n,S,R,e,0,T,w,C)}),(function(){ae.call(t),c&&n.autofill(r.arange,"all",(function(e){return(0,p.xtoast)("Tip",e)}))&&(_.testValid.call(t),oe.call(t)),t.selector.setBoxinner("auto"),r.hideAutofill(),K.call(t),t.container.css("pointer-events","auto")}))}c||1!==e.buttons||e.shiftKey&&L.call(this,!0,g,E)}function ie(e,t,r,n,i,a,o,s,l,u){var c=this,f=setTimeout((function(){var f=setInterval((function(){Q.call(c,e,t,r,n,i,a,o,0,s,l,u)}),50);c.stopTimer2.push(f)}),200);this.stopTimer.push(f)}function ae(){this.stopTimer.clear(),this.stopTimer2.clear()}function oe(){this.data;var e=this.table;this.editor.display=!0;this.selector.arange=null,se.call(this),e.render()}function se(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}function le(e){Ae.call(this,{ri:-1,ci:0,left:60,top:0,width:100},e)}function ue(){var e=this.data.getSelectedRect(),t=e.left+e.width+60,r=e.top+e.height+31;this.advice.el.el.style.top="".concat(r,"px"),this.advice.el.el.style.left="".concat(t,"px")}function ce(){var e=this.data,t=this.pictureOffsetLeft,r=this.pictureOffsetTop;this.data.pasteDirectionsArr.forEach((function(n){var i=e.getMoveRect(n.range);n.img.el.style.top="".concat(i.top+r+15*n.number+n.offsetTop,"px"),n.img.el.style.left="".concat(i.left+t+15*n.number+n.offsetLeft,"px")}))}function fe(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.selector,i=this.data,a=this.editor,o=P(n.indexes,2),s=o[0],l=o[1];s=-1===t?s:t,l=-1===r?l:r;var u=i.getMoveRect(new w.default(s,l,n.range.eri,n.range.eci)),c=this.getTableOffset(),f="top";u.top>c.height/2&&(f="bottom"),a.setOffset(u,f,e),setTimeout((function(){a.setCursorPos(a.editorText.getText().length)}))}function de(){for(var e=0;e<this.selectors.length;e++){var t=this.selectors[e];t.selector.resetSelectorBRLAreaOffset(new w.default(t.ri,t.ci,t.ri,t.ci))}}function he(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.overlayerCEl=!0===e?(0,n.h)("div","".concat(m.cssPrefix,"-overlayer-content")).children(this.editor.el,this.selectorMoveEl.el,this.selector.el,this.chartView.el):(0,n.h)("div","".concat(m.cssPrefix,"-overlayer-content")).children(this.selectorMoveEl.el,this.chartView.el)}function pe(){var e=this.editor,t=this.data,r=this.selector,n=t.getMax(),i=n.mri,a=n.mci;i!==r.range.eri-r.range.sri+1&&a!==r.range.eci-r.range.sci+1&&(fe.call(this),e.setCellEnd(t.getSelectedCell()),this.data.settings.showEditor&&r.el.hide(),W.call(this),setTimeout((function(){e.setCursorPos(e.editorText.getText().length)})))}function me(e){var t=this.data,r=this.footEl;if(r){var n=t.settings.footerContainerHeight,i=n-20;t.viewHeight()+e-n>=t.rows.totalHeight()-i?(r.style.display="block",r.style.top=t.viewHeight()-(t.viewHeight()+e-n-t.rows.totalHeight()+i)+"px"):r.style.display="none"}}function ve(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrolly(e,(function(){a.display=!1,i.resetBRLAreaOffset(),me.call(t,e),ce.call(t),ue.call(t),de.call(t),fe.call(t,!1),n.render()}))}function ye(e){var t=this,r=this.data,n=this.table,i=this.selector,a=this.editor;r.scrollx(e,(function(){a.display=!1,i.resetBRTAreaOffset(),ce.call(t),ue.call(t),de.call(t),fe.call(t,!1),n.render()}))}function ge(){var e=this.data,t=this.table,r=e.viewRange2(),n=e.settings.style.autoAdapt,i=e.settings.ignoreRi,a=0;if(n){if(r.each((function(e,r){var n=t.getCellTextContent(e,r),a=t.getDrawBox(e,r);if(void 0!==n){var o=t.getCellTextStyle(e,r),s=Object.assign({},o.font);s.size=(0,y.getFontSizePxByPt)(s.size);var l=null;void 0!==o.format||(l=t.draw.selfAdaptionTxtWidth(n,s,a)),(void 0===t.autoAdaptList[r]||t.autoAdaptList[r]<l)&&e>i-1&&(t.autoAdaptList[r]=l)}})),t.autoAdaptList.length<0)return;for(var o=e.settings.ignore,s=0;s<t.autoAdaptList.length;s++){for(var l=!1,u=0;u<o.length;u++)s===o[u]&&(l=!0);!1===l&&(void 0===t.autoAdaptList[s]?(a+=50,e.cols.setWidth(s,50)):(t.autoAdaptList[s]<30&&(t.autoAdaptList[s]=30),e.cols.setWidth(s,t.autoAdaptList[s]))),a+=t.autoAdaptList[s]}a>0&&(e.settings.cellWidth=function(){return a})}}function Ee(){var e=this.data,t=this.table,r=e.viewRange2(),n=0,i=0,a=e.settings.row.height,o=e.settings.style.autoAdapt,s=0;if(o){r.each((function(r,o){var l=t.getCellTextContent(n,o),u=t.getCellTextStyle(r,o),c=Object.assign({},u.font);c.size=(0,y.getFontSizePxByPt)(c.size);var f=t.getDrawBox(n,o);if(n!==r&&void 0!==l){var d=e.rows.getHeight(n);if(a*i!==d){var h=c.size*i+2*f.padding+2*i;e.rows.setHeight(n,h),s+=h}else s+=d;i=0}else if(void 0!==l&&n===r&&void 0!==l){var p=t.draw.selfAdaptionHeight(f,l,c);(p>i||0===i)&&(i=p)}n=r}));var l=e.rows.getHeight(n),u=t.getCellTextStyle(l,0),c=Object.assign({},u.font);c.size=(0,y.getFontSizePxByPt)(c.size);var f=t.getDrawBox(n,0);if(a*i!==l&&s>0){var d=c.size*i+2*f.padding;s+=d,e.rows.setHeight(n,d)}else s>0&&(s+=l)}console.log(503,s),s>0&&(e.settings.view.height=function(){return s+40})}function be(e){if(e.target.className==="".concat(m.cssPrefix,"-overlayer")){var t=this.selector,r=this.data,n=e.offsetX,i=e.offsetY,a=r.getCellRectByXY(n,i);t.selectCell.setData(a.ri,a.ci),t.selectCell.resetSelectOffset()}}function xe(e,t){var r=e.ri,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setRowHeight(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),H.call(this),fe.call(this)}function Ae(e,t){var r=e.ci,n=this.table,i=this.selector,a=this.data,o=this.toolbar;a.setColWidth(r,t),a.change(a.getData()),o.reset(),n.render(),i.resetAreaOffset(),z.call(this),fe.call(this)}function Se(e,t){var r=this.errorPopUp;return e&&!r.open?(r.show(t),{state:!0,msg:t}):r.open?(r.hide(),{state:!0,msg:t}):{state:!1,msg:t}}function we(e,t,r,n){var i=r.text,a=r.style,o=this.data,s=this.editor,l=o.selectorCellText(e,t,i+"",n);return!(!l.state||!(l=Se.call(this,!0,l.msg)).state)||(o.setCellText(e,t,{text:i,style:a}),s.setRiCi(-1,-1),!1)}function Re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table,i=this.editor,a=r.selector,o=a.ri,s=a.ci;i.ri!==o&&-1!==i.ri||i.ci!==s&&-1!==i.ci||(r.setSelectedCellText(e,t),"finished"===t&&n.render())}function Ce(){this.data.throwFormula()}function Te(){}function Oe(e){var t=this.data;"insert-row"===e?t.insert("row"):"delete-row"===e?t.delete("row"):"insert-column"===e?t.insert("column"):"delete-column"===e?t.delete("column"):"delete-cell"===e?t.deleteCell():"delete-cell-format"===e?t.deleteCell("format"):"delete-cell-text"===e&&t.deleteCell("text"),W.call(this),_e.call(this),q.call(this)}function _e(){var e=this.verticalScrollbar,t=this.data,r=e.scroll().top,n=t.rows,i=t.scroll.ri+1;me.call(this,r+n.getHeight(i)-t.settings.footerContainerHeight)}function De(e,t){var r=this.data;if("undo"===e)this.undo();else if("undoList"===e)t.setContent(r.historyList(1));else if("redoList"===e)t.setContent(r.historyList(2));else if("redo"===e)this.redo();else if("print"===e);else if("paintformat"===e)!0===t?G.call(this):W.call(this);else if("chart"===e)Te.call(this),this.toolbar.reset();else if("clearformat"===e)Oe.call(this,"delete-cell-format");else if("link"===e);else if("autofilter"===e)$.call(this);else if("throwFormula"===e)Ce.call(this);else if("close"===e){var n=r.getMax(),i=n.mri,a=n.mci;r.changeDataForCalc=new N.default({type:999,action:"重新计算",ri:-1,ci:-1,oldCell:{},newCell:r.rows.eachRange(new w.default(0,0,i,a))},this.data),q.call(this)}else if("freeze"===e){var o=r.settings.showFreeze;if(t&&!0===o){var s=r.selector,l=s.ri,u=s.ci;this.freeze(l,u)}else this.freeze(0,0)}else"add"===e?(r.showEquation=!r.showEquation,q.call(this,!0)):(r.setSelectedCellAttr(e,t),"border"===e&&Ne.call(this,"none"),"cellFormulaProxy"===e&&pe.call(this),q.call(this))}function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1px solid rgb(75, 137, 255";this.selector.br.border(e)}function ke(e,t,r,n){this.data.setAutoFilter(e,t,r,n),q.call(this)}function Me(e){if(e.getLock()||2===e.state){var t=e.ri,r=e.ci,n=e.editorText.getText();return this.selector.indexes=[t,r],we.call(this,t,r,{text:n},"input")}return!1}function Ie(e){var t=this;W.call(this),b.mountPaste.call(this,e,(function(){q.call(t);var e=t.data;e.change(e.getData())}))}function Pe(){var e=this,t=this.overlayerEl,r=this.rowResizer,n=this.colResizer,a=this.verticalScrollbar,o=this.horizontalScrollbar,s=this.editor,l=this.contextMenu,u=this.data,c=this.toolbar,f=this.modalValidation,d=this.sortFilter;t.on("mousemove",(function(t){B.call(e,t)})).on("mousedown",(function(t){if(2===t.buttons)u.xyInSelectedRect(t.offsetX,t.offsetY)?(l.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):(l.hide(),ne.call(e,t),setTimeout((function(){l.setPosition(t.offsetX,t.offsetY),t.stopPropagation()}),100)),be.call(e,t);else if(2===t.detail){if(clearTimeout(e.render_timer),s.setMouseDownIndex([]),s.getLock())return;pe.call(e)}else{if(s.getLock()||s.isCors){var r=null,n=0;(0,i.mouseMoveUp)(window,(function(i){e.container.css("pointer-events","none"),r&&r.selector&&r.selector.setBoxinner("none");var a=!0,o=u.merges,l=s.editorText.getText();if(Object.keys(o._).forEach((function(e){for(var t=o._[e],r=(0,S.cutStr)(l,!0),n=0;n<r.length;n++)if(-1!==r[n].indexOf(":")){var i=r[n].split(":")[0],s=r[n].split(":")[1],u=(0,C.expr2xy)(i),c=(0,C.expr2xy)(s);t.sci>=u[0]&&t.sri>=u[1]&&t.eci<=c[0]&&t.eri<=c[1]&&(a=!1)}})),a&&1===i.buttons&&!i.shiftKey){var c=u.getCellRectByXY(i.offsetX,i.offsetY),f=c.ri,d=c.ci;if(r&&r.selector)r=E.makeSelector.call(e,f,d,e.selectors,!0,r.selector,!0),E.lockCells.call(e,t,r),e.mergeSelector=!0;else{for(var h=s.pos,p=s.editorText.getText(),m=0;m<e.selectors.length;m++){var v=e.selectors[m];if(v.erpx===(0,S.cuttingByPos)(p,h)){n=1,(r=v).selector.set(f,d,!0);break}}r=r||E.makeSelector.call(e,f,d,e.selectors,!0,null,!1)}}}),(function(){if(e.container.css("pointer-events","auto"),r&&r.selector&&r.selector.setBoxinner("auto"),!1===e.mergeSelector?(r&&!n&&e.selectors.push(r),E.lockCells.call(e,t,r)):r&&!n&&r.selector&&e.selectors.push(r),r)for(var i=0;i<e.selectors.length;i++){var a=e.selectors[i];if(a.className===r.className){a.erpx=r.erpx;break}}r=null,n=0,e.mergeSelector=!1}))}if(console.time("dbclick time1"),!s.getLock()&&!s.isCors){console.time("dbclick time2");var a=s.ri,o=s.ci,c=s.editorText.getText();if(-1!==a&&-1!==o&&"="===c[0])if(we.call(e,a,o,{text:c},"input"))return;console.timeEnd("dbclick time2"),s.clear()&&se.call(e),e.selector.longTimeBefore(),ne.call(e,t),be.call(e,t),Ne.call(e),E.clearSelectors.call(e),fe.call(e)}_.testValid.call(e),console.timeEnd("dbclick time1")}})).on("mousewheel.stop",(function(t){U.call(e,t)})),(0,i.bindTouch)(t.el,{move:function(t,r){V.call(e,t,r)}}),c.change=function(t,r){return De.call(e,t,r)},d.ok=function(t,r,n,i){return ke.call(e,t,r,n,i)},r.finishedFn=function(t,r){xe.call(e,t,r)},n.finishedFn=function(t,r){Ae.call(e,t,r)},a.moveFn=function(t,r){ve.call(e,t,r)},o.moveFn=function(t,r){ye.call(e,t,r)},s.change=function(t,r){if("finish"===t)return u.editorChangeToHistory(s.editorText.getOldCell(),s.editorText.getRICI(),1),void s.editorText.setOldCell({},{ri:-1,ci:-1});if("@~esc"===r){var n=s.editorText.getOldCell(),i=n.text,a=n.formulas;s.editorText.setOldCell({text:"",formulas:""});var o=s.ri,l=s.ci;return u.setSelectedCell(i,"input",a,o,l),s.setText(""),E.clearSelectors.call(e),void s.clear(!0)}"format"===t&&u.setSelectedCellAttr(t,"rmb");var c=s.lock;s.setMouseDownIndex(u.rows,[]),E.editingSelectors.call(e,r),c&&"="!==r||"format"!==t&&Re.call(e,r,t)},f.change=function(e){if("save"===e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];u.addValidation.apply(u,r)}else u.removeValidation()},l.itemClick=function(t){"validation"===t?f.setValue(u.getSelectedValidation()):"copy"===t?G.call(e):"cut"===t?Y.call(e):"paste"===t||("paste-value"===t?J.call(e,"text"):"paste-format"===t?J.call(e,"format"):Oe.call(e,t))},(0,i.bind)(window,"resize",(function(){e.reload()})),(0,i.bind)(window,"click",(function(e){t.contains(e.target)})),(0,i.bind)(this.el.el,"copy",(function(t){x.mountCopy.call(e,t)})),(0,i.bind)(this.el.el,"cut",(function(t){console.log("cut",t),Y.call(e),x.mountCopy.call(e,t);var r=e.data;r.history.add(r.getData())})),(0,i.bind)(this.el.el,"paste",(function(t){Ie.call(e,t)})),(0,i.bind)(window,"keydown",(function(t){var r=t.keyCode||t.which,n=t.key,i=t.ctrlKey,a=t.shiftKey,o=t.metaKey;if(x.getChooseImg.call(e)){switch(console.log(r),r){case 8:u.history.addPic(u.getData().pictures,"add"),b.deleteImg.call(e)}(i||o)&&90===r&&(e.undo(),t.preventDefault())}else if(i||o)switch(r){case 90:e.undo(),t.preventDefault();break;case 89:e.redo(),t.preventDefault();break;case 67:if(x.getChooseImg.call(e))return;G.call(e),t.preventDefault();break;case 88:Y.call(e),t.preventDefault();break;case 85:c.trigger("underline"),t.preventDefault();break;case 86:break;case 37:j.call(e,a,"row-first"),t.preventDefault();break;case 38:j.call(e,a,"col-first"),t.preventDefault();break;case 39:j.call(e,a,"row-last"),t.preventDefault();break;case 40:j.call(e,a,"col-last"),t.preventDefault();break;case 32:L.call(e,!1,-1,u.selector.ci,!1),t.preventDefault();break;case 66:c.trigger("font-bold");break;case 73:c.trigger("font-italic")}else{switch(r){case 32:a&&L.call(e,!1,u.selector.ri,-1,!1);break;case 27:l.hide(),c.trigger("paintformat");break;case 37:j.call(e,a,"left"),t.preventDefault();break;case 38:j.call(e,a,"up"),t.preventDefault();break;case 39:j.call(e,a,"right"),t.preventDefault();break;case 40:j.call(e,a,"down"),t.preventDefault();break;case 9:if(Me.call(e,s))return;s.clear(),j.call(e,!1,a?"left":"right"),t.preventDefault(),E.clearSelectors.call(e);break;case 13:if(Me.call(e,s))return;s.clear(),ge.call(e),Ee.call(e),j.call(e,!1,a?"up":"down"),se.call(e),t.preventDefault(),fe.call(e,!0),E.clearSelectors.call(e);break;case 8:Oe.call(e,"delete-cell-text")}"Delete"===n?(Oe.call(e,"delete-cell-text"),t.preventDefault()):r>=65&&r<=90||r>=48&&r<=57||r>=96&&r<=105||"="===t.key||113===r&&pe.call(e)}}))}var Fe=function(){function e(t,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var p=r.settings,y=p.view,E=p.showToolbar,b=p.showContextmenu,x=p.showEditor,S=p.rowWidth;this.el=(0,n.h)("div","".concat(m.cssPrefix,"-sheet")),this.toolbar=new f.default(r,y.width,!E),t.children(this.toolbar.el,this.el),this.pictureOffsetLeft=10,this.pictureOffsetTop=10,this.data=r,this.tableEl=(0,n.h)("canvas","".concat(m.cssPrefix,"-table")),this.rowResizer=new a.default(!1,r.rows.height),this.colResizer=new a.default(!0,r.cols.minWidth),this.verticalScrollbar=new o.default(!0),this.horizontalScrollbar=new o.default(!1),this.editor=new l.default(v.calc.fnNameArrayWithKey,(function(){return i.getTableOffset()}),r.rows.height,r.cols.width,r,this),this.stopTimer=new D.default,this.stopTimer2=new D.default,this.website=new A.default(r,this.editor),this.modalValidation=new d.default,this.errorPopUp=new T.default,this.contextMenu=new u.default((function(){return i.getTableOffset()}),!b),this.selector=new s.default(r,this,!0),this.selectorMoveEl=new s.default(r,this,!1),this.advice=new g.default(r,this),this.chartView=new k.default,this.overlayerCEl=he.call(this,x),this.selectors=[],this.container=(0,n.h)("div",""),this.selectorsEl=(0,n.h)("div","selector_clear").attr("id","selector_clear"),this.overlayerCEl.children(this.selectorsEl,this.container),this.mergeSelector=!1,this.overlayerEl=(0,n.h)("div","".concat(m.cssPrefix,"-overlayer")).children(this.overlayerCEl),this.sortFilter=new h.default,this.direction=!1,this.el.children(this.tableEl,this.rowResizer.el,this.overlayerEl.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.errorPopUp.el,this.sortFilter.el,this.advice.el,this.website.el,this.website.tableEl),this.table=new c.default(this.tableEl.el,r),Pe.call(this),q.call(this,!1),L.call(this,!1,0,0),S&&S.state&&le.call(this,S.width)}var t,r,y;return t=e,(r=[{key:"selectorMoveReset",value:function(){fe.call(this),this.editor.setRiCi(this.data.selector.ri,this.data.selector.ci),q.call(this)}},{key:"getTable",value:function(){return{recalc:!1,table:this.table}}},{key:"clickCopyPaste",value:function(){var e=this.data,t=e.clickCopyPaste();t.enter&&(this.selector.arange=t.dstCellRange,e.clickAutofill(t.srcCellRange,t.dstCellRange,"all",(function(e){return(0,p.xtoast)("Tip",e)})),oe.call(this))}},{key:"setCellRange",value:function(e,t,r,n){this.data.paste(n);for(var i=0;i<e.length;i++){var a=e[i],o=a.ri,s=a.ci,l=(0,S.deepCopy)(t.rows.getCellOrNew(o,s));!1===r&&delete l.style,we.call(this,o,s,l,"style"),L.call(this,!0,o,s,!0,!0)}}},{key:"selectorEditorReset",value:function(e,t){var r=this.selector;fe.call(this,!0,e,t),this.editor.setRiCi(e,t),r.hide(),q.call(this)}},{key:"loadData",value:function(e){return this.data.setData(e,this),q.call(this),this}},{key:"freeze",value:function(e,t){return this.data.setFreeze(e,t),q.call(this),this}},{key:"undo",value:function(){this.data.undo(this),q.call(this)}},{key:"redo",value:function(){this.data.redo(),q.call(this)}},{key:"reload",value:function(){return q.call(this),this}},{key:"removeEvent",value:function(){i.remove.call(this)}},{key:"getRect",value:function(){var e=this.data;return{width:e.viewWidth(),height:e.viewHeight()}}},{key:"footerContainerReset",value:function(){_e.call(this)}},{key:"insertRows",value:function(e){var t=this.data,r=this.verticalScrollbar,n=t.rows;t.insert("row",1*e),q.call(this),r.move({top:n.totalHeight()})}},{key:"getTableOffset",value:function(){var e=this.data,t=e.rows,r=e.cols,n=this.getRect(),i=n.width,a=n.height;return{width:i-r.indexWidth,height:a-t.height,left:r.indexWidth,top:t.height}}}])&&I(t.prototype,r),y&&I(t,y),e}();t.default=Fe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUpperCase=function(e){return e=e.toString().toUpperCase()},t.default=void 0;var n=r(4),i=r(32),a=f(r(165)),o=r(166),s=r(167),l=r(1),u=r(33),c=r(9);f(r(85));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=5,m={fillStyle:"#f4f5f8"},v={fillStyle:"#fff",lineWidth:s.thinLineWidth,strokeStyle:"#e6e6e6"};function y(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new s.DrawBox(n,i,a,o,p)}function g(){var e=this.data.changeDataForCalc;return(0,c.isHave)(e)?{state:!0,data:e}:{state:!1,data:null}}function E(){}function b(){var e=this.data,t=g.call(this);if((0,c.isHave)(t.data)){try{e.calc.calculateRows(e.rows,t.data)}catch(e){console.log("公式模块报错："+e)}t.state&&(e.changeDataForCalc=null)}}function x(e,t){var r=this.draw,n=this.data,a=n.sortedRowMap,s=e;a.has(e)&&(s=a.get(e));var u=n.getCell(s,t),f=n.getCellStyleOrDefault(s,t),d=y.call(this,e,t);if((0,c.isHave)(u)){d.bgcolor=f.bgcolor,void 0!==f.border&&(d.setBorders(f.border),r.strokeBorders(d));var h="";n.showEquation?(0,c.isHave)(u.formulas)&&(h=u.formulas):(0,c.isHave)(u.text)&&(h=u.text),r.rect2(d,(function(){var a=n.renderFormat(f,u,s,t,!1);h=a.state?a.cellText:h;var c=Object.assign({},f.font);c.size=(0,i.getFontSizePxByPt)(c.size);var p=n.settings,m=p.ignore,v=p.minus,y=f.color;!0===v&&(0,o.isMinus)(h)&&(y="red");var g=f.underline,E="www"===(h+="").substr(0,3).toLowerCase()?"http://"+h:h;(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?$/.test(E)||function(e){return!!(e+="")&&1===l.look.indexOf(e.split("!")[0])}(u.text))&&(y="#4b89ff",g=!0),r.text(h,d,{align:f.align,valign:f.valign,font:c,color:y,strike:f.strike,underline:g,ignore:m,cindex:t},f.textwrap),n.validations.getError(e,t)&&r.error(d)}))}else r.rectWhite(d)}function A(){for(var e=this.draw,t=this.data.autoFilter.flex,r=0;r<t.length;r++){for(var n=t[r],i=n.ri,a=n.ci,o=n.state,s=0,l=0;l<r;l++){var u=t[l],c=u.set_total;!0===u.state&&(s+=c)}var f=y.call(this,i,a);e.dropUp(f,o,25*s)}}function S(e){var t=this,r=this.data,n=this.draw;if(e){var i=r.autoFilter;if(!i.active())return;var a=i.hrange();e.intersects(a)&&a.each((function(e,r){var i=y.call(t,e,r);n.dropdown(i)}))}}function w(e,t,r,n,i){var a=this,o=this.draw,s=this.data;o.save(),o.translate(t,r).translate(n,i);var l=s.exceptRowSet;o.save(),e.each((function(e,t){x.call(a,e,t)}),(function(e){return function(e){var t=l.has(e);if(t){var r=s.rows.getHeight(e);o.translate(0,-r)}return!t}(e)})),o.restore();var u=new Set;o.save(),s.eachMergesInView(e,(function(e){var t=e.sri,r=e.sci,n=e.eri;if(l.has(t)){if(!u.has(t)){u.add(t);var i=s.rows.sumHeight(t,n+1);o.translate(0,-i)}}else x.call(a,t,r)})),o.restore(),S.call(this,e),A.call(this),o.restore()}function R(e,t,r,n){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(e,t,r,n),i.restore()}function C(e,t,r,i,a,o){var l=this,u=this.draw,c=this.data,f=t.h,d=t.w,h=o+i,p=a+r;u.save(),u.attr(m),"all"!==e&&"left"!==e||u.fillRect(0,h,r,f),"all"!==e&&"top"!==e||u.fillRect(p,0,d,i);var v=c.selector.range,y=v.sri,g=v.sci,E=v.eri,b=v.eci;u.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat((0,s.npx)(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:(0,s.thinLineWidth)(),strokeStyle:"#e6e6e6"}),"all"!==e&&"left"!==e||(c.rowEach(t.sri,t.eri,(function(e,t,n){var i=h+t,a=e;u.line([0,i],[r,i]),y<=a&&a<E+1&&R.call(l,0,i,r,n),u.fillText(a+1,r/2,i+n/2)})),u.line([0,f+h],[r,f+h]),u.line([r,h],[r,f+h])),"all"!==e&&"top"!==e||(c.colEach(t.sci,t.eci,(function(e,t,r){var a=p+t,o=e;u.line([a,0],[a,i]),g<=o&&o<b+1&&R.call(l,a,0,r,i),u.fillText((0,n.stringAt)(o),a+r/2,i/2)})),u.line([d+p,0],[d+p,i]),u.line([0,i],[d+p,i])),u.restore()}function T(e,t){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,e,t),r.restore()}function O(e,t,r,n,i){var a=e.sri,o=e.sci,s=e.eri,l=e.eci,u=e.w,c=e.h,f=this.draw,d=this.data,h=d.settings;f.save(),f.attr(v).translate(t+n,r+i),f.clearRect(0,0,u,c),h.showGrid?(d.rowEach(a,s,(function(e,t,r){e!==a&&f.line([0,t],[u,t]),e===s&&f.line([0,t+r],[u,t+r])})),d.colEach(o,l,(function(e,t,r){e!==o&&f.line([t,0],[t,c]),e===l&&f.line([t+r,0],[t+r,c])})),f.restore()):f.restore()}function _(e,t,r,n){var i=this.draw,a=this.data,o=a.viewWidth()-e,s=a.viewHeight()-t;i.save().translate(e,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,n],[o,n]),i.line([r,0],[r,s]),i.restore()}var D=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.draw=new s.Draw(t,r.viewWidth(),r.viewHeight()),this.data=r}var t,r,n;return t=e,(r=[{key:"getCellTextContent",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;n.has(e)&&(i=n.get(e));var o=r.getCell(i,t);if(null!==o)return a.default.render(o.text||"",r,(function(e,t){return r.getCellTextOrDefault(t,e)}))}},{key:"getDrawBox",value:function(e,t){var r=this.data.cellRect(e,t),n=r.left,i=r.top,a=r.width,o=r.height;return new s.DrawBox(n,i,a,o,p)}},{key:"getCellTextStyle",value:function(e,t){var r=this.data,n=r.sortedRowMap,i=e;return n.has(e)&&(i=n.get(e)),r.getCellStyleOrDefault(i,t)}},{key:"render",value:function(){var e=this.data,t=e.rows,r=e.cols,n=e.viewRange();b.call(this),E.call(this),this.clear(),this.draw.resize(e.viewWidth(),e.viewHeight());var i=e.freezeTotalWidth(),a=e.freezeTotalHeight(),o=e.scroll,s=o.x,l=o.y,c=r.indexWidth,f=t.height;O.call(this,n,c,f,i,a),w.call(this,n,c,f,-s,-l),C.call(this,"all",n,c,f,i,a),T.call(this,c,f);var h=d(e.freeze,2),p=h[0],m=h[1];if(p>0||m>0){if(p>0){var v=n.clone();v.sri=0,v.eri=p-1,v.h=a,O.call(this,v,c,f,i,0),w.call(this,v,c,f,-s,0),C.call(this,"top",v,c,f,i,0)}if(m>0){var y=n.clone();y.sci=0,y.eci=m-1,y.w=i,O.call(this,y,c,f,0,a),C.call(this,"left",y,c,f,0,a),w.call(this,y,c,f,0,-l)}var g=e.freezeViewRange();O.call(this,g,c,f,0,0),C.call(this,"all",g,c,f,0,0),w.call(this,g,c,f,0,0),_.call(this,c,f,i,a)}u.testValid.call(this)}},{key:"clear",value:function(){this.draw.clear()}}])&&h(t.prototype,r),n&&h(t,n),e}();t.default=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiply=c,t.formatNumberRender=t.baseFormats=t.formatm=void 0;var n=r(10),i=r(16),a=r(9);function o(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=function(e){return e},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!(0,a.isHave)(e)||!(0,i.isNumber)(e))return e;if(/^(-?\d*.?\d*)$/.test(e)){var r=-1===t?e.toString():Number(e).toFixed(t).toString(),n=r.split("\\."),s=o(n),l=s[0],u=(s.slice(1),l.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"));return"NaN"===u?e:u}return e};t.formatNumberRender=l;var u=[{key:"normal",title:(0,n.tf)("format.normal"),type:"string",render:s},{key:"number",title:(0,n.tf)("format.number"),type:"number",label:"1,000.12",render:l},{key:"percent",title:(0,n.tf)("format.percent"),type:"number",label:"10.12%",render:function(e){var t=c(e,100),r="".concat(t);return"".concat(r,"%")}},{key:"rmb",title:(0,n.tf)("format.rmb"),type:"number",label:"￥10.00",render:function(e){return"￥".concat(l(e))}},{key:"date",title:(0,n.tf)("format.date"),type:"date",label:"2009-01-01",render:s},{key:"datetime",title:(0,n.tf)("format.datetime"),type:"datetime",label:"2009年01月01日",render:s}];function c(e,t,r){return d(e,t,r,"multiply")}function f(e){var t,r={times:1,num:0},n=e<0;if(t=e,Math.floor(t)===t)return r.num=e,r;var i="".concat(e),a=i.indexOf("."),o=i.substr(a+1).length,s=Math.pow(10,o),l=parseInt(Math.abs(e)*s+.5,10);return r.times=s,n&&(l=-l),r.num=l,r}function d(e,t,r,n){var i=f(e),a=f(t),o=i.num,s=a.num,l=i.times,u=a.times,c=l>u?l:u;switch(n){case"add":return(l===u?o+s:l>u?o+s*(l/u):o*(u/l)+s)/c;case"subtract":return(l===u?o-s:l>u?o-s*(l/u):o*(u/l)-s)/c;case"multiply":return o*s/(l*u);case"divide":return o/s*(u/l)}}t.baseFormats=u;var h={};t.formatm=h,u.forEach((function(e){h[e.key]=e}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1),a=r(10);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=s(this,l(t).call(this,"div","".concat(i.cssPrefix,"-button ").concat(n)))).child((0,a.t)("button.".concat(e))),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),t}(n.Element);t.default=c},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDefaultFnCollection=E,t.CalcWorkbookProxy=t.CalcSheet=void 0;var i=r(52),a=r(96),o=r(98),s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,t&&t.set(e,r);return r}(r(108)),l=r(109),u=r(110),c=r(3),f=r(21),d=r(4);function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),e}var y=function(){function e(t,r,n){p(this,e),this.name=t,this.workbookProxy=r,this.name2CellProxy=this.createName2CellProxy(n)}return v(e,[{key:"createName2CellProxy",value:function(e){var t,r,n={},a=!0,o=!1,s=void 0;try{for(var l,u=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=e[t=l.value];void 0===d.v?r=c.FORMULA_STATUS.created:(d.v=(0,f.convertToCellV)(d.v),r=c.FORMULA_STATUS.solved),n[t]=new i.CalcCell(this.workbookProxy,this,d,t,r)}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}return n}},{key:"getCellNames",value:function(){return Object.getOwnPropertyNames(this.name2CellProxy)}},{key:"getCellByName",value:function(e){return this.name2CellProxy[e]}},{key:"getMaxRowNum",value:function(){var e=this.getCellNames(),t=0;return e.map((function(e){var r=(0,d.getColNumFromA1)(e);t=r>t?r:t})),t}},{key:"getMaxRowColNum",value:function(){var e=this.getCellNames(),t=0,r=0;return e.map((function(e){var n=(0,d.expr2xy)(e);t=n[0]>t?n[0]:t,r=n[1]>r?n[1]:r})),[t,r]}},{key:"addCalcCell",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.FORMULA_STATUS.created;this.name2CellProxy[e]=new i.CalcCell(this.workbookProxy,this,t,e,r)}},{key:"updateACell",value:function(e,t){var r=this.getCellByName(e);void 0===r?this.addCalcCell(e,t):r.updateByCellObj(t)}}]),e}();t.CalcSheet=y;var g=function(){function e(t){p(this,e),this.name2SheetProxy=this.createName2SheetProxy(t),this.multiCollExpFn=E()}return v(e,[{key:"getFirstSheet",value:function(){return Object.values(this.name2SheetProxy)[0]}},{key:"updateACell",value:function(e,t,r){this.ensureGetSheet(r).updateACell(e,t)}},{key:"updateByName2CellObj",value:function(e,t){var r=this.ensureGetSheet(t),n=!0,i=!1,a=void 0;try{for(var o,s=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;r.updateACell(l,e[l])}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}var u=this.getCalcCellArrayByNames(Object.getOwnPropertyNames(e));return this.calculateFormulas(u),u}},{key:"updateByMultiSheetObj",value:function(e){var t={},r=!0,n=!1,i=void 0;try{for(var a,o=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value,l=e[s];t[s]=this.updateByName2CellObj(l,s)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"getMultiSheetObjFromSheet2CalcArray",value:function(e){var t,r={},n=!0,i=!1,a=void 0;try{for(var o,s=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;t={},e[l].map((function(e){t[e.celName]=e.cellObj})),r[l]=t}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}},{key:"ensureGetSheet",value:function(e){return void 0===e?this.getFirstSheet():this.getSheetByName(e)}},{key:"convertPreAction2name2CellObj",value:function(e){var t={},r=e.oldCell;r.hasOwnProperty("map")&&r.map((function(e){t[e.expr]={f:e.cell.formulas}}));var n={},i=e.newCell;e.isDelete()?i.map((function(e){n[e.expr]={f:""}})):i.map((function(e){n[e.expr]={f:e.cell.formulas}})),Object.assign(t,n);var a={};return e.findAllNeedCalcCell().map((function(e){a[e]={}})),Object.assign(a,t),a}},{key:"getCalcCellArrayByNames",value:function(e,t){var r=this.ensureGetSheet(t);return e.map((function(e){return r.getCellByName(e)}))}},{key:"updateByPreAction",value:function(e){var t=this.convertPreAction2name2CellObj(e);return this.updateByName2CellObj(t)}},{key:"updateByWorkbookObj",value:function(e){this.name2SheetProxy=this.createName2SheetProxy(e)}},{key:"createName2SheetProxy",value:function(e){void 0===e.Sheets&&(e.Sheets=c.EmptyMultiSheetObj);var t={},r=!0,n=!1,i=void 0;try{for(var a,o=Object.getOwnPropertyNames(e.Sheets)[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value,l=e.Sheets[s];t[s]=new y(s,this,l)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"getSheetNames",value:function(){return Object.getOwnPropertyNames(this.name2SheetProxy)}},{key:"getSheetByName",value:function(e){return this.name2SheetProxy[e]}},{key:"getCellByName",value:function(e,t){return this.getSheetByName(e).getCellByName(t)}},{key:"getCellPropertyByName",value:function(e,t,r){return this.getCellByName(e,t).getCellProperty(r)}},{key:"parseCalcCell",value:function(e){return e.isStructuralFormula()?new u.StructuralExpressionBuilder(e,this.multiCollExpFn).parseFormula():new l.SimpleExpressionBuilder(e).parseFormula()}},{key:"calculateFormulas",value:function(e){for(var t=e.length-1;t>=0;t--)try{var r=e[t];if(!0!==r.check_valid())throw Error("not a valid formula");r.execFormula()}catch(e){console.log(e)}}},{key:"applyToAllCells",value:function(e){this.name2SheetProxy;var t,r=[],n=!0,i=!1,a=void 0;try{for(var o,s=this.getSheetNames()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value,u=this.getSheetByName(l),c=!0,f=!1,d=void 0;try{for(var h,p=u.getCellNames()[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var m=h.value;t=e(u.getCellByName(m)),r.push(t)}}catch(e){f=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}},{key:"applyToAllCellsFilterEmpty",value:function(e){this.name2SheetProxy;var t,r=[],n=!0,i=!1,a=void 0;try{for(var o,s=this.getSheetNames()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value,u=this.getSheetByName(l),c=!0,f=!1,d=void 0;try{for(var h,p=u.getCellNames()[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var m=h.value;void 0!==(t=e(u.getCellByName(m)))&&r.push(t)}}catch(e){f=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}},{key:"find_all_cells_with_formulas",value:function(){return this.applyToAllCellsFilterEmpty((function(e){if(e.isFormulaValid()&&e.cellStatus!==c.FORMULA_STATUS.solved)return e}))}},{key:"find_all_need_calc_cell",value:function(e){console.log("find_all_need_calc_cell");for(var t=this.name2SheetProxy,r=e.findAllNeedCalcCell(),n={},a=[],o=Object.getOwnPropertyNames(t.Sheets)[0],s=t.Sheets[o],l=0;l<r.length;l++){var u=r[l];if(u in s!=!1){s[u];var c=n[o+"!"+u]=new i.CalcCell(this,s,o,s[u],n,u,"created");a.push(c)}}return a}}]),e}();function E(){var e=new a.FnCollection;e.addFnObjArray(o.fnObjArray);e.fnObj;var t=new a.FnCollection;t.addFnObj(s);t.fnObj;return new a.MultiCollExpFn(e,t)}t.CalcWorkbookProxy=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcCell=void 0;var n=r(4),i=r(3),a=r(95);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workbookProxy=t,this.calcSheet=r,this.cellObj=n,this.celName=i,this.cellStatus=a,this.formulaString=this.getFormulaString(),this.rootSyntaxUnit=null,this.rootExp=null}var t,r,s;return t=e,(r=[{key:"getFormulaString",value:function(){return this.cellObj.f||""}},{key:"getRiCi",value:function(){return(0,n.expr2xy)(this.celName).reverse()}},{key:"getCellObjForRendering",value:function(){return{v:this.cellObj.v,formulas:this.cellObj.f,text:this.cellObj.v.toString()}}},{key:"updateByCellObj",value:function(e){Object.assign(this.cellObj,e),this.formulaString=this.getFormulaString(),this.cellStatus=i.FORMULA_STATUS.created}},{key:"getCellProperty",value:function(e){return this.cellObj[e]}},{key:"isStructuralFormula",value:function(){return this.formulaString.startsWith("=")}},{key:"isFormulaValid",value:function(){return void 0!==this.formulaString}},{key:"isEmpty",value:function(){return void 0===this.cellObj||null===this.cellObj}},{key:"check_valid",value:function(){return"string"==typeof this.formulaString}},{key:"execFormula",value:function(){if(this.cellStatus===i.FORMULA_STATUS.solved)return this.cellObj.v;this.cellStatus=i.FORMULA_STATUS.working,this.rootExp=this.workbookProxy.parseCalcCell(this),this.rootExp.update_cell_value(),this.cellStatus=i.FORMULA_STATUS.solved}},{key:"getRefSyntaxUnitArray",value:function(){return this.rootSyntaxUnit.getAllBaseSyntaxUnit().filter((function(e){return e.isReferUnit()}))}},{key:"getFormulaStringByRefactor",value:function(e){var t=this.rootSyntaxUnit.getAllBaseSyntaxUnit(),r=new a.BaseRefactorProxy(e).getTheFunc();return t.map(r),this.rootSyntaxUnit.getWholeString()}}])&&o(t.prototype,r),s&&o(t,s),e}();t.CalcCell=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AARangeRefer=t.RangeRefer=t.SingleCellRefer=void 0;var n=r(3),i=r(4),a=r(25);r(35);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){return t&&d(e.prototype,t),r&&d(e,r),e}var p=function(){function e(t,r){f(this,e),this.aName=t,this.isAbsoluteRef=r,this.syntaxUnit=null}return h(e,[{key:"getNumber",value:function(){return 0}},{key:"dealInplace",value:function(e,t){return t&&(this.syntaxUnit.wholeStr=e),e}},{key:"getNameByNumber",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return""}},{key:"associateWithSyntaxUnit",value:function(e){this.syntaxUnit=e}},{key:"updateByShift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!0===this.isAbsoluteRef)return this.aName;var r=this.getNameByNumber(this.getNumber()+e,t);return this.dealInplace(r,t)}}]),e}(),m=function(e){function t(){return f(this,t),s(this,l(t).apply(this,arguments))}return u(t,e),h(t,[{key:"getNumber",value:function(){return(0,i.indexAt)(this.aName)}},{key:"getNameByNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,i.stringAt)(e);return!0===t&&(this.aName=r),this.dealInplace(r,t)}}],[{key:"fromStrMayWith$",value:function(e){return"$"===e[0]?new t(e.slice(1),!0):new t(e,!1)}}]),t}(p),v=function(e){function t(){return f(this,t),s(this,l(t).apply(this,arguments))}return u(t,e),h(t,[{key:"getNumber",value:function(){return parseInt(this.aName)-1}},{key:"getNameByNumber",value:function(e,t){var r=String(e+1);return!0===t&&(this.aName=r),this.dealInplace(r,t)}}],[{key:"fromStrMayWith$",value:function(e){return"$"===e[0]?new t(e.slice(1),!0):new t(e,!1)}}]),t}(p),y=function(){function e(t,r){f(this,e),this.aStr=t,this.typeArray=r,this.syntaxUnitBuilder=new a.SyntaxStructureBuilder(a.BaseSyntaxUnitProxy),this.buff="",this.char="",this.state=this.normalState,this.isAbosulte=!1,this.cellRowNameParser=null,this.cellColNameParser=null}return h(e,[{key:"isLeftTopToOther",value:function(e){return this.cellRowNameParser.getNumber()<e.cellRowNameParser.getNumber()&&this.cellColNameParser.getNumber()<e.cellColNameParser.getNumber()}},{key:"getRootUnit",value:function(){return this.syntaxUnitBuilder.rootUnit}},{key:"isBuffEmptyAfterTrim",value:function(){return""===this.buff.trim()}},{key:"normalState",value:function(e){"!"===e?(this.syntaxUnitBuilder.addStringToCurUnit(this.buff,[n.SHEET_NAME]),this.syntaxUnitBuilder.addStringToCurUnit(e,[n.SPLIT_MARK]),this.buff=""):"$"===e?(!1===this.isBuffEmptyAfterTrim()&&this.addColNameProxy(),this.isAbosulte=!0,this.syntaxUnitBuilder.addStringToCurUnit(e,[n.ABSOLUTE_MARK])):/[0-9]/.test(e)?(!1===this.isBuffEmptyAfterTrim()&&this.addColNameProxy(),this.state=this.insideRowName,this.buff+=e):this.buff+=e}},{key:"insideRowName",value:function(e){this.buff+=e}},{key:"addRowNameProxy",value:function(){this.cellRowNameParser=new v(this.buff,this.isAbosulte),this.syntaxUnitBuilder.addParserToCurUnit(this.cellRowNameParser,this.buff,[n.ROW_NAME]),this.buff=""}},{key:"addColNameProxy",value:function(){this.cellColNameParser=new m(this.buff,this.isAbosulte),this.syntaxUnitBuilder.addParserToCurUnit(this.cellColNameParser,this.buff,[n.COL_NAME]),this.buff="",this.isAbosulte=!1}},{key:"parseRefString",value:function(){for(var e=0;e<this.aStr.length;e++)this.state(this.aStr[e]);this.addRowNameProxy()}},{key:"dealInplace",value:function(e){var t=this.syntaxUnitBuilder.rootUnit.getWholeString();return this.aStr=e?t:this.aStr,t}},{key:"updateStrByNewLoc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.cellColNameParser.getNameByNumber(e,r),this.cellRowNameParser.getNameByNumber(t,r),this.dealInplace(r)}},{key:"updateStrByUserMove",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.cellColNameParser.updateByShift(e,r),this.cellRowNameParser.updateByShift(t,r),this.dealInplace(r)}}]),e}();t.SingleCellRefer=y;var g=function(){function e(t,r){f(this,e),this.aStr=t,this.typeArray=r,this.firstRef=null,this.secondRef=null}return h(e,[{key:"parseRefString",value:function(){var e=this.aStr.split(":"),t=new y(e[0]),r=new y(e[1]);if(t.parseRefString(),r.parseRefString(),t.cellColNameParser.getNumber()>r.cellColNameParser.getNumber()){var n=r.cellColNameParser.aName;r.cellColNameParser.aName=t.cellColNameParser.aName,t.cellColNameParser.aName=n}if(t.cellRowNameParser.getNumber()>r.cellRowNameParser.getNumber()){var i=r.cellRowNameParser.aName;r.cellRowNameParser.aName=t.cellRowNameParser.aName,t.cellRowNameParser.aName=i}this.firstRef=t,this.secondRef=r}},{key:"getRefWholeString",value:function(){return this.firstRef.getRootUnit().getWholeString()+":"+this.secondRef.getRootUnit().getWholeString()}},{key:"dealInplace",value:function(e){var t=this.getRefWholeString();return this.aStr=e?t:this.aStr,t}},{key:"updateStrByNewLoc",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.firstRef.updateStrByNewLoc(e[0],t[0],r),this.secondRef.updateStrByNewLoc(e[1],t[1],r),this.dealInplace(r)}},{key:"updateStrByUserMove",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.firstRef.updateStrByUserMove(e[0],t[0],r),this.secondRef.updateStrByUserMove(e[1],t[1],r),this.dealInplace(r)}}]),e}();t.RangeRefer=g;var E=function(){function e(t,r){f(this,e),this.aStr=t,this.typeArray=r,this.syntaxUnitBuilder=new a.SyntaxStructureBuilder(a.BaseSyntaxUnitProxy),this.firstRef=null,this.secondRef=null}return h(e,[{key:"parseRefString",value:function(){var e,t=this.aStr.split("!");t.length>1?(this.syntaxUnitBuilder.addStringToCurUnit(t[0],[n.SHEET_NAME]),this.syntaxUnitBuilder.addStringToCurUnit("!",[n.SPLIT_MARK]),e=t[1].split(":")):e=this.aStr.split(":");var r=e.map((function(e){return m.fromStrMayWith$(e)}));r[0].getNumber()>r[1].getNumber()&&r.reverse(),this.firstRef=r[0],this.secondRef=r[1],this.dealColRefStr(r[0]),this.syntaxUnitBuilder.addStringToCurUnit(":",[n.SPLIT_MARK]),this.dealColRefStr(r[1])}},{key:"dealColRefStr",value:function(e){!0===e.isAbsoluteRef&&this.syntaxUnitBuilder.addStringToCurUnit("$"),this.syntaxUnitBuilder.addParserToCurUnit(e,e.aName,[n.COL_NAME])}},{key:"dealInplace",value:function(e){var t=this.syntaxUnitBuilder.rootUnit.getWholeString();return this.aStr=e?t:this.aStr,t}},{key:"updateStrByNewLoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return 2!==e.length?new Error("newColArray should have two elements."):(this.firstRef.getNameByNumber(e[0],t),this.secondRef.getNameByNumber(e[1],t),this.dealInplace(t))}},{key:"updateStrByUserMove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return 2!==e.length?new Error("newColArray should have two elements."):(this.firstRef.updateByShift(e[0],t),this.secondRef.updateByShift(e[1],t),this.dealInplace(t))}}]),e}();t.AARangeRefer=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easySolve=function(e,t){return new a(e,t).solveExpression()},t.UserFnExecutor=void 0;var n=r(15);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="UserFn",this.args=r,this.exp_fn="function"==typeof t?new n.BaseExpFunction(t):t}var t,r,a;return t=e,(r=[{key:"push",value:function(e){this.args.push(e)}},{key:"solveExpression",value:function(){return this.exp_fn.solveExpression(this.args)}}])&&i(t.prototype,r),a&&i(t,a),e}();t.UserFnExecutor=a},function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var r,n,i;for(void 0===t&&(t=15),n=.5,r=new Date;;){for(i=n*=2;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(new Date-r>t)break}for(i=n;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return 1e3*(3*n-1)/(new Date-r)},numeric._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){var t=[];return function e(r){var n;if(void 0===r)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return t.push('"'+r+'"'),!1;if("boolean"==typeof r)return t.push(r.toString()),!1;if("number"==typeof r){var i=function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var r=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,r),i=n.toPrecision(numeric.precision);return 10===parseFloat(i)&&(r++,i=(n=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+r.toString()}return"Infinity"}(r),a=r.toPrecision(numeric.precision),o=parseFloat(r.toString()).toString(),s=[i,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(n=1;n<s.length;n++)s[n].length<i.length&&(i=s[n]);return t.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===r)return t.push("null"),!1;if("function"==typeof r){t.push(r.toString());var l=!1;for(n in r)r.hasOwnProperty(n)&&(l?t.push(",\n"):t.push("\n{"),l=!0,t.push(n),t.push(": \n"),e(r[n]));return l&&t.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return t.push("...Large Array..."),!0;l=!1;for(t.push("["),n=0;n<r.length;n++)n>0&&(t.push(","),l&&t.push("\n ")),l=e(r[n]);return t.push("]"),!0}for(n in t.push("{"),l=!1,r)r.hasOwnProperty(n)&&(l&&t.push(",\n"),l=!0,t.push(n),t.push(": \n"),e(r[n]));return t.push("}"),!0}(e),t.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseCSV=function(e){var t,r,n,i=e.split("\n"),a=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(r=0;r<i.length;r++){var u,c=(i[r]+",").match(o);if(c.length>0){for(a[l]=[],t=0;t<c.length;t++)u=(n=c[t]).substr(0,n.length-1),s.test(u)?a[l][t]=parseFloat(u):a[l][t]=u;l++}}return a},numeric.toCSV=function(e){var t,r,n,i,a,o=numeric.dim(e);for(n=o[0],o[1],a=[],t=0;t<n;t++){for(i=[],r=0;r<n;r++)i[r]=e[t][r].toString();a[t]=i.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var n,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],a=-1;e.length;for(n=t;n<r;n++)a=a>>>8^i[255&(a^e[n])];return-1^a}var r,n,i,a,o,s,l,u,c,f,d=e[0].length,h=e[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(f=t(p,12,29),p[29]=f>>24&255,p[30]=f>>16&255,p[31]=f>>8&255,p[32]=255&f,r=1,n=0,l=0;l<d;l++){for(l<d-1?p.push(0):p.push(1),o=3*h+1+(0===l)&255,s=3*h+1+(0===l)>>8&255,p.push(o),p.push(s),p.push(255&~o),p.push(255&~s),0===l&&p.push(0),u=0;u<h;u++)for(i=0;i<3;i++)n=(n+(r=(r+(o=(o=e[i][l][u])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return c=(n<<16)+r,p.push(c>>24&255),p.push(c>>16&255),p.push(c>>8&255),p.push(255&c),a=p.length-41,p[33]=a>>24&255,p[34]=a>>16&255,p[35]=a>>8&255,p[36]=255&a,f=t(p,37),p.push(f>>24&255),p.push(f>>16&255),p.push(f>>8&255),p.push(255&f),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(e){var t,r,n,i,a,o,s,l=e.length,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;t<l;t+=3)a=((3&(r=e[t]))<<4)+((n=e[t+1])>>4),o=((15&n)<<2)+((i=e[t+2])>>6),s=63&i,t+1>=l?o=s=64:t+2>=l&&(s=64),c+=u.charAt(r>>2)+u.charAt(a)+u.charAt(o)+u.charAt(s);return c}(p)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,r){var n,i;if(!(t instanceof Array&&r instanceof Array))return!1;if((i=t.length)!==r.length)return!1;for(n=0;n<i;n++)if(t[n]!==r[n]){if("object"!=typeof t[n])return!1;if(!e(t[n],r[n]))return!1}return!0},numeric.rep=function(e,t,r){void 0===r&&(r=0);var n,i=e[r],a=Array(i);if(r===e.length-1){for(n=i-2;n>=0;n-=2)a[n+1]=t,a[n]=t;return-1===n&&(a[0]=t),a}for(n=i-1;n>=0;n--)a[n]=numeric.rep(e,t,r+1);return a},numeric.dotMMsmall=function(e,t){var r,n,i,a,o,s,l,u,c,f,d;for(a=e.length,o=t.length,s=t[0].length,l=Array(a),r=a-1;r>=0;r--){for(u=Array(s),c=e[r],i=s-1;i>=0;i--){for(f=c[o-1]*t[o-1][i],n=o-2;n>=1;n-=2)d=n-1,f+=c[n]*t[n][i]+c[d]*t[d][i];0===n&&(f+=c[0]*t[0][i]),u[i]=f}l[r]=u}return l},numeric._getCol=function(e,t,r){var n;for(n=e.length-1;n>0;--n)r[n]=e[n][t],r[--n]=e[n][t];0===n&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r,n,i,a=numeric._getCol,o=t.length,s=Array(o),l=e.length,u=t[0].length,c=new Array(l),f=numeric.dotVV;for(--o,n=--l;-1!==n;--n)c[n]=Array(u);for(n=--u;-1!==n;--n)for(a(t,n,s),i=l;-1!==i;--i)0,r=e[i],c[i][n]=f(r,s);return c},numeric.dotMV=function(e,t){var r,n=e.length,i=(t.length,Array(n)),a=numeric.dotVV;for(r=n-1;r>=0;r--)i[r]=a(e[r],t);return i},numeric.dotVM=function(e,t){var r,n,i,a,o,s,l;for(i=e.length,a=t[0].length,o=Array(a),n=a-1;n>=0;n--){for(s=e[i-1]*t[i-1][n],r=i-2;r>=1;r-=2)l=r-1,s+=e[r]*t[r][n]+e[l]*t[l][n];0===r&&(s+=e[0]*t[0][n]),o[n]=s}return o},numeric.dotVV=function(e,t){var r,n,i=e.length,a=e[i-1]*t[i-1];for(r=i-2;r>=1;r-=2)n=r-1,a+=e[r]*t[r]+e[n]*t[n];return 0===r&&(a+=e[0]*t[0]),a},numeric.dot=function(e,t){var r=numeric.dim;switch(1e3*r(e).length+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,n,i,a=e.length,o=Array(a);for(t=a-1;t>=0;t--){for(i=Array(a),r=t+2,n=a-1;n>=r;n-=2)i[n]=0,i[n-1]=0;for(n>t&&(i[n]=0),i[t]=e[t],n=t-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),o[t]=i}return o},numeric.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;t>=1;--t)n[t]=e[t][t],n[--t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){void 0===r&&(r="");var n,i,a=[],o=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)o.test(e[n])?s=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),a.push(i);return a[e.length]="_s",a[e.length+1]="_k",a[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric.pointwise2=function(e,t,r){void 0===r&&(r="");var n,i,a=[],o=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)o.test(e[n])?s=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),a.push(i);return a[e.length]="var _n = "+s+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric._biforeach=function e(t,r,n,i,a){var o;if(i!==n.length-1)for(o=n[i]-1;o>=0;o--)e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,i+1,a);else a(t,r)},numeric._biforeach2=function e(t,r,n,i,a){if(i===n.length-1)return a(t,r);var o,s=n[i],l=Array(s);for(o=s-1;o>=0;--o)l[o]=e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,i+1,a);return l},numeric._foreach=function e(t,r,n,i){var a;if(n!==r.length-1)for(a=r[n]-1;a>=0;a--)e(t[a],r,n+1,i);else i(t)},numeric._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var a,o=r[n],s=Array(o);for(a=o-1;a>=0;a--)s[a]=e(t[a],r,n+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var r,n,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(i="var "+t+" = Math."+t+";\n",r=function(e,r,n){return e+" = "+t+"("+r+","+n+")"},n=function(e,r){return e+" = "+t+"("+e+","+r+")"}):(r=function(e,r,n){return e+" = "+r+" "+t+" "+n},n=numeric.opseq.hasOwnProperty(e+"eq")?function(e,r){return e+" "+t+"= "+r}:function(e,r){return e+" = "+e+" "+t+" "+r}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,r,n,i,a,o,s,l=numeric.dim(e),u=Math.abs,c=l[0],f=l[1],d=numeric.clone(e),h=numeric.identity(c);for(o=0;o<f;++o){var p=-1,m=-1;for(a=o;a!==c;++a)(s=u(d[a][o]))>m&&(p=a,m=s);for(r=d[p],d[p]=d[o],d[o]=r,i=h[p],h[p]=h[o],h[o]=i,e=r[o],s=o;s!==f;++s)r[s]/=e;for(s=f-1;-1!==s;--s)i[s]/=e;for(a=c-1;-1!==a;--a)if(a!==o){for(t=d[a],n=h[a],e=t[o],s=o+1;s!==f;++s)t[s]-=r[s]*e;for(s=f-1;s>0;--s)n[s]-=i[s]*e,n[--s]-=i[s]*e;0===s&&(n[0]-=i[0]*e)}}return h},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r,n,i,a,o,s,l,u,c=t[0],f=1,d=numeric.clone(e);for(n=0;n<c-1;n++){for(i=n,r=n+1;r<c;r++)Math.abs(d[r][n])>Math.abs(d[i][n])&&(i=r);for(i!==n&&(l=d[i],d[i]=d[n],d[n]=l,f*=-1),a=d[n],r=n+1;r<c;r++){for(s=(o=d[r])[n]/a[n],i=n+1;i<c-1;i+=2)u=i+1,o[i]-=a[i]*s,o[u]-=a[u]*s;i!==c&&(o[i]-=a[i]*s)}if(0===a[n])return 0;f*=a[n]}return f*d[n][n]},numeric.transpose=function(e){var t,r,n,i,a,o=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=s-1;r>=1;--r)(a=l[r])[t]=i[r],a[t-1]=n[r],(a=l[--r])[t]=i[r],a[t-1]=n[r];0===r&&((a=l[0])[t]=i[0],a[t-1]=n[0])}if(0===t){for(n=e[0],r=s-1;r>=1;--r)l[r][0]=n[r],l[--r][0]=n[r];0===r&&(l[0][0]=n[0])}return l},numeric.negtranspose=function(e){var t,r,n,i,a,o=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=s-1;r>=1;--r)(a=l[r])[t]=-i[r],a[t-1]=-n[r],(a=l[--r])[t]=-i[r],a[t-1]=-n[r];0===r&&((a=l[0])[t]=-i[0],a[t-1]=-n[0])}if(0===t){for(n=e[0],r=s-1;r>=1;--r)l[r][0]=-n[r],l[--r][0]=-n[r];0===r&&(l[0][0]=-n[0])}return l},numeric._random=function e(t,r){var n,i,a=t[r],o=Array(a);if(r===t.length-1){for(i=Math.random,n=a-1;n>=1;n-=2)o[n]=i(),o[n-1]=i();return 0===n&&(o[0]=i()),o}for(n=a-1;n>=0;n--)o[n]=e(t,r+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if(void 0===r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,i=Array(r);for(n=--r;n>=0;n--)i[n]=(n*t+(r-n)*e)/r;return i},numeric.getBlock=function(e,t,r){var n=numeric.dim(e);return function e(i,a){var o,s=t[a],l=r[a]-s,u=Array(l);if(a===n.length-1){for(o=l;o>=0;o--)u[o]=i[o+s];return u}for(o=l;o>=0;o--)u[o]=e(i[o+s],a+1);return u}(e,0)},numeric.setBlock=function(e,t,r,n){var i=numeric.dim(e);return function e(n,a,o){var s,l=t[o],u=r[o]-l;if(o===i.length-1)for(s=u;s>=0;s--)n[s+l]=a[s];for(s=u;s>=0;s--)e(n[s+l],a[s],o+1)}(e,n,0),e},numeric.getRange=function(e,t,r){var n,i,a,o,s=t.length,l=r.length,u=Array(s);for(n=s-1;-1!==n;--n)for(u[n]=Array(l),a=u[n],o=e[t[n]],i=l-1;-1!==i;--i)a[i]=o[r[i]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r,n,i,a,o,s=t[0],l=t[1];for(r=0,n=0,i=0;i<s;++i)r+=e[i][0].length;for(a=0;a<l;++a)n+=e[0][a][0].length;var u=Array(r);for(i=0;i<r;++i)u[i]=Array(n);var c,f,d,h,p,m=0;for(i=0;i<s;++i){for(c=n,a=l-1;-1!==a;--a)for(c-=(o=e[i][a])[0].length,d=o.length-1;-1!==d;--d)for(p=o[d],f=u[m+d],h=p.length-1;-1!==h;--h)f[c+h]=p[h];m+=e[i][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var r=numeric.dim(e),n=numeric.dim(t);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,a,o,s,l=r[0],u=n[0],c=Array(l);for(a=l-1;a>=0;a--){for(i=Array(u),s=e[a],o=u-1;o>=3;--o)i[o]=s*t[o],i[--o]=s*t[o],i[--o]=s*t[o],i[--o]=s*t[o];for(;o>=0;)i[o]=s*t[o],--o;c[a]=i}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,n,i){var a;numeric.indexOf;if("string"!=typeof i)for(a in i="",numeric)numeric.hasOwnProperty(a)&&(e.indexOf(a)>=0||t.indexOf(a)>=0||r.indexOf(a)>=0||n.indexOf(a)>=0)&&a.length>1&&(i+="var "+a+" = numeric."+a+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,r,n,i,a,o,s,l,u,c,f,d,h,p,m,v,y,g,E=e.x.length,b=numeric.identity(E),x=numeric.rep([E,E],0),A=numeric.clone(e.x),S=numeric.clone(e.y);for(u=0;u<E;u++){for(d=(p=A[u][u])*p+(m=S[u][u])*m,f=u,c=u+1;c<E;c++)(h=(p=A[c][u])*p+(m=S[c][u])*m)>d&&(f=c,d=h);for(f!==u&&(g=A[u],A[u]=A[f],A[f]=g,g=S[u],S[u]=S[f],S[f]=g,g=b[u],b[u]=b[f],b[f]=g,g=x[u],x[u]=x[f],x[f]=g),t=A[u],r=S[u],a=b[u],o=x[u],p=t[u],m=r[u],c=u+1;c<E;c++)v=t[c],y=r[c],t[c]=(v*p+y*m)/d,r[c]=(y*p-v*m)/d;for(c=0;c<E;c++)v=a[c],y=o[c],a[c]=(v*p+y*m)/d,o[c]=(y*p-v*m)/d;for(c=u+1;c<E;c++){for(n=A[c],i=S[c],s=b[c],l=x[c],p=n[u],m=i[u],f=u+1;f<E;f++)v=t[f],y=r[f],n[f]-=v*p-y*m,i[f]-=y*p+v*m;for(f=0;f<E;f++)v=a[f],y=o[f],s[f]-=v*p-y*m,l[f]-=y*p+v*m}}for(u=E-1;u>0;u--)for(a=b[u],o=x[u],c=u-1;c>=0;c--)for(s=b[c],l=x[c],p=A[c][u],m=S[c][u],f=E-1;f>=0;f--)v=a[f],y=o[f],s[f]-=p*v-m*y,l[f]-=p*y+m*v;return new numeric.T(b,x)},numeric.T.prototype.get=function(e){var t,r=this.x,n=this.y,i=0,a=e.length;if(n){for(;i<a;)r=r[t=e[i]],n=n[t],i++;return new numeric.T(r,n)}for(;i<a;)r=r[t=e[i]],i++;return new numeric.T(r)},numeric.T.prototype.set=function(e,t){var r,n=this.x,i=this.y,a=0,o=e.length,s=t.x,l=t.y;if(0===o)return l?this.y=l:i&&(this.y=void 0),this.x=n,this;if(l){for(i||(i=numeric.rep(numeric.dim(n),0),this.y=i);a<o-1;)n=n[r=e[a]],i=i[r],a++;return n[r=e[a]]=s,i[r]=l,this}if(i){for(;a<o-1;)n=n[r=e[a]],i=i[r],a++;return n[r=e[a]]=s,i[r]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;a<o-1;)n=n[r=e[a]],a++;return n[r=e[a]]=s,this},numeric.T.prototype.getRows=function(e,t){var r,n,i=t-e+1,a=Array(i),o=this.x,s=this.y;for(r=e;r<=t;r++)a[r-e]=o[r];if(s){for(n=Array(i),r=e;r<=t;r++)n[r-e]=s[r];return new numeric.T(a,n)}return new numeric.T(a)},numeric.T.prototype.setRows=function(e,t,r){var n,i=this.x,a=this.y,o=r.x,s=r.y;for(n=e;n<=t;n++)i[n]=o[n-e];if(s)for(a||(a=numeric.rep(numeric.dim(i),0),this.y=a),n=e;n<=t;n++)a[n]=s[n-e];else if(a)for(n=e;n<=t;n++)a[n]=numeric.rep([o[n-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,n=this.y,i=t.x,a=t.y;return r[e]=i,a?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[e]=a):n&&(n=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,n=this.y,i=numeric.getBlock;return n?new numeric.T(i(r,e,t),i(n,e,t)):new numeric.T(i(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,i=this.y,a=numeric.setBlock,o=r.x,s=r.y;if(s)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),a(n,e,t,o),a(i,e,t,s),this;a(n,e,t,o),i&&a(i,e,t,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var n=t.x,i=t.y,a=numeric.rep;return i?new r(a(e,n),a(e,i)):new r(a(e,n))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,r=e.y,n=numeric.diag;return r?new numeric.T(n(t),n(r)):new numeric.T(n(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=(e[0]>=0?1:-1)*numeric.norm2(e);t[0]+=r;var n=numeric.norm2(t);if(0===n)throw new Error("eig: internal error");return numeric.div(t,n)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,i,a,o,s,l,u,c,f,d=t[0],h=numeric.clone(e),p=numeric.identity(d);for(n=0;n<d-2;n++){for(a=Array(d-n-1),r=n+1;r<d;r++)a[r-n-1]=h[r][n];if(numeric.norm2(a)>0){for(o=numeric.house(a),s=numeric.getBlock(h,[n+1,n],[d-1,d-1]),l=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<d;r++)for(u=h[r],c=l[r-n-1],i=n;i<d;i++)u[i]-=2*c[i-n];for(s=numeric.getBlock(h,[0,n+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(s,o),o),r=0;r<d;r++)for(u=h[r],c=l[r],i=n+1;i<d;i++)u[i]-=2*c[i-n-1];for(s=Array(d-n-1),r=n+1;r<d;r++)s[r-n-1]=p[r];for(l=numeric.tensor(o,numeric.dot(o,s)),r=n+1;r<d;r++)for(f=p[r],c=l[r-n-1],i=0;i<d;i++)f[i]-=2*c[i]}}return{H:h,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var r,n,i,a,o,s,l,u,c,f,d,h,p,m,v,y,g,E,b=numeric.dim(e)[0],x=numeric.identity(b);if(b<3)return{Q:x,B:[[0,b-1]]};var A=numeric.epsilon;for(E=0;E<t;E++){for(y=0;y<b-1;y++)if(Math.abs(e[y+1][y])<A*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){var S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),w=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[b-1,b-1]),t);for(h=Array(y+1),v=0;v<=y;v++)h[v]=x[v];for(p=numeric.dot(S.Q,h),v=0;v<=y;v++)x[v]=p[v];for(h=Array(b-y-1),v=y+1;v<b;v++)h[v-y-1]=x[v];for(p=numeric.dot(w.Q,h),v=y+1;v<b;v++)x[v]=p[v-y-1];return{Q:x,B:S.B.concat(numeric.add(w.B,y+1))}}var R,C,T;if(i=e[b-2][b-2],a=e[b-2][b-1],o=e[b-1][b-2],u=i+(s=e[b-1][b-1]),l=i*s-a*o,c=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*l)R=.5*(u+Math.sqrt(u*u-4*l)),C=.5*(u-Math.sqrt(u*u-4*l)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,R+C)),numeric.diag(numeric.rep([3],R*C)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],l)));for(r=[c[0][0],c[1][0],c[2][0]],n=numeric.house(r),h=[e[0],e[1],e[2]],p=numeric.tensor(n,numeric.dot(n,h)),v=0;v<3;v++)for(d=e[v],m=p[v],g=0;g<b;g++)d[g]-=2*m[g];for(h=numeric.getBlock(e,[0,0],[b-1,2]),p=numeric.tensor(numeric.dot(h,n),n),v=0;v<b;v++)for(d=e[v],m=p[v],g=0;g<3;g++)d[g]-=2*m[g];for(h=[x[0],x[1],x[2]],p=numeric.tensor(n,numeric.dot(n,h)),v=0;v<3;v++)for(f=x[v],m=p[v],g=0;g<b;g++)f[g]-=2*m[g];for(y=0;y<b-2;y++){for(g=y;g<=y+1;g++)if(Math.abs(e[g+1][g])<A*(Math.abs(e[g][g])+Math.abs(e[g+1][g+1]))){S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[g,g]),t),w=numeric.QRFrancis(numeric.getBlock(e,[g+1,g+1],[b-1,b-1]),t);for(h=Array(g+1),v=0;v<=g;v++)h[v]=x[v];for(p=numeric.dot(S.Q,h),v=0;v<=g;v++)x[v]=p[v];for(h=Array(b-g-1),v=g+1;v<b;v++)h[v-g-1]=x[v];for(p=numeric.dot(w.Q,h),v=g+1;v<b;v++)x[v]=p[v-g-1];return{Q:x,B:S.B.concat(numeric.add(w.B,g+1))}}for(T=Math.min(b-1,y+3),r=Array(T-y),v=y+1;v<=T;v++)r[v-y-1]=e[v][y];for(n=numeric.house(r),h=numeric.getBlock(e,[y+1,y],[T,b-1]),p=numeric.tensor(n,numeric.dot(n,h)),v=y+1;v<=T;v++)for(d=e[v],m=p[v-y-1],g=y;g<b;g++)d[g]-=2*m[g-y];for(h=numeric.getBlock(e,[0,y+1],[b-1,T]),p=numeric.tensor(numeric.dot(h,n),n),v=0;v<b;v++)for(d=e[v],m=p[v],g=y+1;g<=T;g++)d[g]-=2*m[g-y-1];for(h=Array(T-y),v=y+1;v<=T;v++)h[v-y-1]=x[v];for(p=numeric.tensor(n,numeric.dot(n,h)),v=y+1;v<=T;v++)for(f=x[v],m=p[v-y-1],g=0;g<b;g++)f[g]-=2*m[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r,n,i,a,o,s,l,u,c,f,d,h,p,m,v,y,g=numeric.toUpperHessenberg(e),E=numeric.QRFrancis(g.H,t),b=numeric.T,x=e.length,A=E.B,S=numeric.dot(E.Q,numeric.dot(g.H,numeric.transpose(E.Q))),w=new b(numeric.dot(E.Q,g.Q)),R=A.length,C=Math.sqrt;for(n=0;n<R;n++)if((r=A[n][0])===A[n][1]);else{if(a=r+1,o=S[r][r],s=S[r][a],l=S[a][r],u=S[a][a],0===s&&0===l)continue;(f=(c=-o-u)*c-4*(o*u-s*l))>=0?((v=(o-(d=c<0?-.5*(c-C(f)):-.5*(c+C(f))))*(o-d)+s*s)>(y=l*l+(u-d)*(u-d))?(p=(o-d)/(v=C(v)),m=s/v):(p=l/(y=C(y)),m=(u-d)/y),i=new b([[m,-p],[p,m]]),w.setRows(r,a,i.dot(w.getRows(r,a)))):(d=-.5*c,h=.5*C(-f),(v=(o-d)*(o-d)+s*s)>(y=l*l+(u-d)*(u-d))?(p=(o-d)/(v=C(v+h*h)),m=s/v,d=0,h/=v):(p=l/(y=C(y+h*h)),m=(u-d)/y,d=h/y,h=0),i=new b([[m,-p],[p,m]],[[d,h],[h,-d]]),w.setRows(r,a,i.dot(w.getRows(r,a))))}var T=w.dot(e).dot(w.transjugate()),O=(x=e.length,numeric.T.identity(x));for(a=0;a<x;a++)if(a>0)for(n=a-1;n>=0;n--){var _=T.get([n,n]),D=T.get([a,a]);numeric.neq(_.x,D.x)||numeric.neq(_.y,D.y)?(d=T.getRow(n).getBlock([n],[a-1]),h=O.getRow(a).getBlock([n],[a-1]),O.set([a,n],T.get([n,a]).neg().sub(d.dot(h)).div(_.sub(D)))):O.setRow(a,O.getRow(n))}for(a=0;a<x;a++)d=O.getRow(a),O.setRow(a,d.div(d.norm2()));return O=O.transpose(),O=w.transjugate().dot(O),{lambda:T.getDiag(),E:O}},numeric.ccsSparse=function(e){var t,r,n,i=e.length,a=[];for(r=i-1;-1!==r;--r)for(n in t=e[r]){for(n=parseInt(n);n>=a.length;)a[a.length]=0;0!==t[n]&&a[n]++}var o=a.length,s=Array(o+1);for(s[0]=0,r=0;r<o;++r)s[r+1]=s[r]+a[r];var l=Array(s[o]),u=Array(s[o]);for(r=i-1;-1!==r;--r)for(n in t=e[r])0!==t[n]&&(a[n]--,l[s[n]+a[n]]=r,u[s[n]+a[n]]=t[n]);return[s,l,u]},numeric.ccsFull=function(e){var t,r,n,i,a=e[0],o=e[1],s=e[2],l=numeric.ccsDim(e),u=l[0],c=l[1],f=numeric.rep([u,c],0);for(t=0;t<c;t++)for(n=a[t],i=a[t+1],r=n;r<i;++r)f[o[r]][t]=s[r];return f},numeric.ccsTSolve=function(e,t,r,n,i){var a,o,s,l,u,c,f,d=e[0],h=e[1],p=e[2],m=d.length-1,v=Math.max,y=0;function g(e){var t;if(0===r[e]){for(r[e]=1,t=d[e];t<d[e+1];++t)g(h[t]);i[y]=e,++y}}for(void 0===n&&(r=numeric.rep([m],0)),void 0===n&&(n=numeric.linspace(0,r.length-1)),void 0===i&&(i=[]),a=n.length-1;-1!==a;--a)g(n[a]);for(i.length=y,a=i.length-1;-1!==a;--a)r[i[a]]=0;for(a=n.length-1;-1!==a;--a)o=n[a],r[o]=t[o];for(a=i.length-1;-1!==a;--a){for(o=i[a],s=d[o],l=v(d[o+1],s),u=s;u!==l;++u)if(h[u]===o){r[o]/=p[u];break}for(f=r[o],u=s;u!==l;++u)(c=h[u])!==o&&(r[c]-=f*p[u])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,n,i,a){var o,s,l,u=0,c=i.length,f=this.k,d=this.k1,h=this.j;if(0===n[e])for(n[e]=1,h[0]=e,f[0]=s=t[e],d[0]=l=t[e+1];;)if(s>=l){if(i[c]=h[u],0===u)return;++c,s=f[--u],l=d[u]}else 0===n[o=a[r[s]]]?(n[o]=1,f[u]=s,h[++u]=o,s=t[o],d[u]=l=t[o+1]):++s},numeric.ccsLPSolve=function(e,t,r,n,i,a,o){var s,l,u,c,f,d,h,p,m,v=e[0],y=e[1],g=e[2],E=(v.length,t[0]),b=t[1],x=t[2];for(l=E[i],u=E[i+1],n.length=0,s=l;s<u;++s)o.dfs(a[b[s]],v,y,r,n,a);for(s=n.length-1;-1!==s;--s)r[n[s]]=0;for(s=l;s!==u;++s)r[c=a[b[s]]]=x[s];for(s=n.length-1;-1!==s;--s){for(f=v[c=n[s]],d=v[c+1],h=f;h<d;++h)if(a[y[h]]===c){r[c]/=g[h];break}for(m=r[c],h=f;h<d;++h)(p=a[y[h]])!==c&&(r[p]-=m*g[h])}return r},numeric.ccsLUP1=function(e,t){var r,n,i,a,o,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],f=[numeric.rep([u+1],0),[],[]],d=c[0],h=c[1],p=c[2],m=f[0],v=f[1],y=f[2],g=numeric.rep([u],0),E=numeric.rep([u],0),b=numeric.ccsLPSolve,x=(Math.max,Math.abs),A=numeric.linspace(0,u-1),S=numeric.linspace(0,u-1),w=new numeric.ccsDFS(u);for(void 0===t&&(t=1),r=0;r<u;++r){for(b(c,e,g,E,r,S,w),a=-1,o=-1,n=E.length-1;-1!==n;--n)(i=E[n])<=r||(s=x(g[i]))>a&&(o=i,a=s);for(x(g[r])<t*a&&(n=A[r],a=A[o],A[r]=a,S[a]=r,A[o]=n,S[n]=o,a=g[r],g[r]=g[o],g[o]=a),a=d[r],o=m[r],l=g[r],h[a]=A[r],p[a]=1,++a,n=E.length-1;-1!==n;--n)s=g[i=E[n]],E[n]=0,g[i]=0,i<=r?(v[o]=i,y[o]=s,++o):(h[a]=A[i],p[a]=s/l,++a);d[r+1]=a,m[r+1]=o}for(n=h.length-1;-1!==n;--n)h[n]=S[h[n]];return{L:c,U:f,P:A,Pinv:S}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,n,i,a,o){var s,l,u,c=0,f=i.length,d=this.k,h=this.k1,p=this.j;if(0===n[e])for(n[e]=1,p[0]=e,d[0]=l=t[a[e]],h[0]=u=t[a[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=u){if(i[f]=a[p[c]],0===c)return;++f,l=d[--c],u=h[c]}else 0===n[s=r[l]]?(n[s]=1,d[c]=l,p[++c]=s,l=t[s=a[s]],h[c]=u=t[s+1]):++l}},numeric.ccsLPSolve0=function(e,t,r,n,i,a,o,s){var l,u,c,f,d,h,p,m,v,y=e[0],g=e[1],E=e[2],b=(y.length,t[0]),x=t[1],A=t[2];for(u=b[i],c=b[i+1],n.length=0,l=u;l<c;++l)s.dfs(x[l],y,g,r,n,a,o);for(l=n.length-1;-1!==l;--l)r[o[f=n[l]]]=0;for(l=u;l!==c;++l)r[f=x[l]]=A[l];for(l=n.length-1;-1!==l;--l){for(m=o[f=n[l]],d=y[f],h=y[f+1],p=d;p<h;++p)if(g[p]===m){r[m]/=E[p];break}for(v=r[m],p=d;p<h;++p)r[g[p]]-=v*E[p];r[m]=v}},numeric.ccsLUP0=function(e,t){var r,n,i,a,o,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],f=[numeric.rep([u+1],0),[],[]],d=c[0],h=c[1],p=c[2],m=f[0],v=f[1],y=f[2],g=numeric.rep([u],0),E=numeric.rep([u],0),b=numeric.ccsLPSolve0,x=(Math.max,Math.abs),A=numeric.linspace(0,u-1),S=numeric.linspace(0,u-1),w=new numeric.ccsDFS0(u);for(void 0===t&&(t=1),r=0;r<u;++r){for(b(c,e,g,E,r,S,A,w),a=-1,o=-1,n=E.length-1;-1!==n;--n)(i=E[n])<=r||(s=x(g[A[i]]))>a&&(o=i,a=s);for(x(g[A[r]])<t*a&&(n=A[r],a=A[o],A[r]=a,S[a]=r,A[o]=n,S[n]=o),a=d[r],o=m[r],l=g[A[r]],h[a]=A[r],p[a]=1,++a,n=E.length-1;-1!==n;--n)s=g[A[i=E[n]]],E[n]=0,g[A[i]]=0,i<=r?(v[o]=i,y[o]=s,++o):(h[a]=A[i],p[a]=s/l,++a);d[r+1]=a,m[r+1]=o}for(n=h.length-1;-1!==n;--n)h[n]=S[h[n]];return{L:c,U:f,P:A,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var n=numeric.ccsDim(e),i=n[0],a=n[1];void 0===t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),void 0===r?r=numeric.linspace(0,a-1):"number"==typeof r&&(r=[r]);var o,s,l,u,c=t.length,f=r.length,d=numeric.rep([a],0),h=[],p=[],m=[d,h,p],v=e[0],y=e[1],g=e[2],E=numeric.rep([i],0),b=0,x=numeric.rep([i],0);for(s=0;s<f;++s){var A=v[u=r[s]],S=v[u+1];for(o=A;o<S;++o)x[l=y[o]]=1,E[l]=g[o];for(o=0;o<c;++o)x[t[o]]&&(h[b]=o,p[b]=E[t[o]],++b);for(o=A;o<S;++o)x[l=y[o]]=0;d[s+1]=b}return m},numeric.ccsDot=function(e,t){var r,n,i,a,o,s,l,u,c,f,d,h=e[0],p=e[1],m=e[2],v=t[0],y=t[1],g=t[2],E=numeric.ccsDim(e),b=numeric.ccsDim(t),x=E[0],A=(E[1],b[1]),S=numeric.rep([x],0),w=numeric.rep([x],0),R=Array(x),C=numeric.rep([A],0),T=[],O=[],_=[C,T,O];for(i=0;i!==A;++i){for(a=v[i],o=v[i+1],c=0,n=a;n<o;++n)for(f=y[n],d=g[n],s=h[f],l=h[f+1],r=s;r<l;++r)0===w[u=p[r]]&&(R[c]=u,w[u]=1,c+=1),S[u]=S[u]+m[r]*d;for(o=(a=C[i])+c,C[i+1]=o,n=c-1;-1!==n;--n)d=a+n,r=R[n],T[d]=r,O[d]=S[r],w[r]=0,S[r]=0;C[i+1]=C[i]+c}return _},numeric.ccsLUPSolve=function(e,t){var r=e.L,n=e.U,i=(e.P,t[0]),a=!1;"object"!=typeof i&&(i=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],a=!0);var o,s,l,u,c,f,d=t[1],h=t[2],p=r[0].length-1,m=i.length-1,v=numeric.rep([p],0),y=Array(p),g=numeric.rep([p],0),E=Array(p),b=numeric.rep([m+1],0),x=[],A=[],S=numeric.ccsTSolve,w=0;for(o=0;o<m;++o){for(c=0,l=i[o],u=i[o+1],s=l;s<u;++s)f=e.Pinv[d[s]],E[c]=f,g[f]=h[s],++c;for(E.length=c,S(r,g,v,E,y),s=E.length-1;-1!==s;--s)g[E[s]]=0;if(S(n,v,g,y,E),a)return g;for(s=y.length-1;-1!==s;--s)v[y[s]]=0;for(s=E.length-1;-1!==s;--s)f=E[s],x[w]=f,A[w]=g[f],g[f]=0,++w;b[o+1]=w}return[b,x,A]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,r=e[0],n=e[1],i=e[2],a=numeric.sup(n)+1,o=r.length,s=numeric.rep([a],0),l=Array(o),u=Array(o),c=numeric.rep([a],0);for(t=0;t<o;++t)c[n[t]]++;for(t=0;t<a;++t)s[t+1]=s[t]+c[t];var f,d,h=s.slice(0);for(t=0;t<o;++t)l[f=h[d=n[t]]]=r[t],u[f]=i[t],h[d]=h[d]+1;return[s,l,u]},numeric.ccsGather=function(e){var t,r,n,i,a,o=e[0],s=e[1],l=e[2],u=o.length-1,c=s.length,f=Array(c),d=Array(c),h=Array(c);for(a=0,t=0;t<u;++t)for(n=o[t],i=o[t+1],r=n;r!==i;++r)d[a]=t,f[a]=s[r],h[a]=l[r],++a;return[f,d,h]},numeric.sdim=function e(t,r,n){if(void 0===r&&(r=[]),"object"!=typeof t)return r;var i;for(i in void 0===n&&(n=0),n in r||(r[n]=0),t.length>r[n]&&(r[n]=t.length),t)t.hasOwnProperty(i)&&e(t[i],r,n+1);return r},numeric.sclone=function e(t,r,n){void 0===r&&(r=0),void 0===n&&(n=numeric.sdim(t).length);var i,a=Array(t.length);if(r===n-1){for(i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);return a}for(i in t)t.hasOwnProperty(i)&&(a[i]=e(t[i],r+1,n));return a},numeric.sdiag=function(e){var t,r,n=e.length,i=Array(n);for(t=n-1;t>=1;t-=2)r=t-1,i[t]=[],i[t][t]=e[t],i[r]=[],i[r][r]=e[r];return 0===t&&(i[0]=[],i[0][0]=e[t]),i},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,r,n,i=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(r in n=e[t])n.hasOwnProperty(r)&&("object"!=typeof i[r]&&(i[r]=[]),i[r][t]=n[r]);return i},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r,n,i,a,o,s,l,u=e.length,c=(t.length,numeric.stranspose(t)),f=c.length,d=Array(u);for(i=u-1;i>=0;i--){for(l=[],r=e[i],o=f-1;o>=0;o--){for(a in s=0,n=c[o],r)r.hasOwnProperty(a)&&a in n&&(s+=r[a]*n[a]);s&&(l[o]=s)}d[i]=l}return d},numeric.sdotMV=function(e,t){var r,n,i,a,o=e.length,s=Array(o);for(n=o-1;n>=0;n--){for(i in a=0,r=e[n])r.hasOwnProperty(i)&&t[i]&&(a+=r[i]*t[i]);a&&(s[n]=a)}return s},numeric.sdotVM=function(e,t){var r,n,i,a,o=[];for(r in e)if(e.hasOwnProperty(r))for(n in i=t[r],a=e[r],i)i.hasOwnProperty(n)&&(o[n]||(o[n]=0),o[n]+=a*i[n]);return o},numeric.sdotVV=function(e,t){var r,n=0;for(r in e)e[r]&&t[r]&&(n+=e[r]*t[r]);return n},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,n=numeric.sdim(t).length;switch(1e3*r+n){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(e){var t,r,n,i,a=e[0].length,o=e.length,s=[];for(r=a-1;r>=0;--r)if(e[o-1][r]){for(i=s,n=0;n<o-2;n++)i[t=e[n][r]]||(i[t]=[]),i=i[t];i[e[n][r]]=e[n+1][r]}return s},numeric.sgather=function e(t,r,n){var i,a,o;for(a in void 0===r&&(r=[]),void 0===n&&(n=[]),i=n.length,t)if(t.hasOwnProperty(a))if(n[i]=parseInt(a),"number"==typeof(o=t[a])){if(o){if(0===r.length)for(a=i+1;a>=0;--a)r[a]=[];for(a=i;a>=0;--a)r[a].push(n[a]);r[i+1].push(o)}}else e(o,r,n);return n.length>i&&n.pop(),r},numeric.cLU=function(e){var t,r,n,i,a,o,s=e[0],l=e[1],u=e[2],c=s.length,f=0;for(t=0;t<c;t++)s[t]>f&&(f=s[t]);f++;var d,h=Array(f),p=Array(f),m=numeric.rep([f],1/0),v=numeric.rep([f],-1/0);for(n=0;n<c;n++)t=s[n],(r=l[n])<m[t]&&(m[t]=r),r>v[t]&&(v[t]=r);for(t=0;t<f-1;t++)v[t]>v[t+1]&&(v[t+1]=v[t]);for(t=f-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);for(t=0;t<f;t++)p[t]=numeric.rep([v[t]-m[t]+1],0),h[t]=numeric.rep([t-m[t]],0),t-m[t]+1,v[t]-t+1;for(n=0;n<c;n++)p[t=s[n]][l[n]-m[t]]=u[n];for(t=0;t<f-1;t++)for(i=t-m[t],E=p[t],r=t+1;m[r]<=t&&r<f;r++)if(a=t-m[r],o=v[t]-t,d=(b=p[r])[a]/E[i]){for(n=1;n<=o;n++)b[n+a]-=d*E[n+i];h[r][t-m[r]]=d}var y,g,E=[],b=[],x=[],A=[],S=[],w=[];for(c=0,y=0,t=0;t<f;t++){for(i=m[t],a=v[t],g=p[t],r=t;r<=a;r++)g[r-i]&&(E[c]=t,b[c]=r,x[c]=g[r-i],c++);for(g=h[t],r=i;r<t;r++)g[r-i]&&(A[y]=t,S[y]=r,w[y]=g[r-i],y++);A[y]=t,S[y]=t,w[y]=1,y++}return{U:[E,b,x],L:[A,S,w]}},numeric.cLUsolve=function(e,t){var r,n,i=e.L,a=e.U,o=numeric.clone(t),s=i[0],l=i[1],u=i[2],c=a[0],f=a[1],d=a[2],h=c.length,p=(s.length,o.length);for(n=0,r=0;r<p;r++){for(;l[n]<r;)o[r]-=u[n]*o[l[n]],n++;n++}for(n=h-1,r=p-1;r>=0;r--){for(;f[n]>r;)o[r]-=d[n]*o[f[n]],n--;o[r]/=d[n],n--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var r,n,i,a=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,r){return t>=e[0]/2||r<e[1]/2};break;default:t=function(e,t){return!0}}for(i=0,r=1;r<e[0]-1;r++)for(n=1;n<e[1]-1;n++)t(r,n)&&(a[r][n]=i,i++);return a},numeric.cdelsq=function(e){var t,r,n,i,a,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),l=s[0],u=s[1],c=[],f=[],d=[];for(t=1;t<l-1;t++)for(r=1;r<u-1;r++)if(!(e[t][r]<0)){for(n=0;n<4;n++)i=t+o[n][0],a=r+o[n][1],e[i][a]<0||(c.push(e[t][r]),f.push(e[i][a]),d.push(-1));c.push(e[t][r]),f.push(e[t][r]),d.push(4)}return[c,f,d]},numeric.cdotMV=function(e,t){var r,n,i,a=e[0],o=e[1],s=e[2],l=a.length;for(i=0,n=0;n<l;n++)a[n]>i&&(i=a[n]);for(i++,r=numeric.rep([i],0),n=0;n<l;n++)r[a[n]]+=s[n]*t[o[n]];return r},numeric.Spline=function(e,t,r,n,i){this.x=e,this.yl=t,this.yr=r,this.kl=n,this.kr=i},numeric.Spline.prototype._at=function(e,t){var r,n,i,a=this.x,o=this.yl,s=this.yr,l=this.kl,u=this.kr,c=numeric.add,f=numeric.sub,d=numeric.mul;r=f(d(l[t],a[t+1]-a[t]),f(s[t+1],o[t])),n=c(d(u[t+1],a[t]-a[t+1]),f(s[t+1],o[t]));var h=(i=(e-a[t])/(a[t+1]-a[t]))*(1-i);return c(c(c(d(1-i,o[t]),d(i,s[t+1])),d(r,h*(1-i))),d(n,h*i))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,r,n,i=this.x,a=i.length,o=Math.floor;for(t=0,r=a-1;r-t>1;)i[n=o((t+r)/2)]<=e?t=n:r=n;return this._at(e,t)}a=e.length;var s,l=Array(a);for(s=a-1;-1!==s;--s)l[s]=this.at(e[s]);return l},numeric.Spline.prototype.diff=function(){var e,t,r,n=this.x,i=this.yl,a=this.yr,o=this.kl,s=this.kr,l=i.length,u=o,c=s,f=Array(l),d=Array(l),h=numeric.add,p=numeric.mul,m=numeric.div,v=numeric.sub;for(e=l-1;-1!==e;--e)t=n[e+1]-n[e],r=v(a[e+1],i[e]),f[e]=m(h(p(r,6),p(o[e],-4*t),p(s[e+1],-2*t)),t*t),d[e+1]=m(h(p(r,-6),p(o[e],2*t),p(s[e+1],4*t)),t*t);return new numeric.Spline(n,u,c,f,d)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],r=this.x,n=this.yl,i=this.yr,a=this.kl,o=this.kr;"number"==typeof n[0]&&(n=[n],i=[i],a=[a],o=[o]);var s,l,u,c,f,d,h,p,m,v,y,g,E,b,x,A,S,w,R,C,T,O,_,D=n.length,N=r.length-1,k=(t=Array(D),Math.sqrt);for(s=0;s!==D;++s){for(c=n[s],f=i[s],d=a[s],h=o[s],p=[],l=0;l!==N;l++){for(l>0&&f[l]*c[l]<0&&p.push(r[l]),A=r[l+1]-r[l],r[l],y=c[l],g=f[l+1],m=d[l]/A,E=(v=h[l+1]/A)+3*y+2*m-3*g,b=3*(v+m+2*(y-g)),(x=e(m-v+3*(y-g))+12*v*y)<=0?S=(w=E/b)>r[l]&&w<r[l+1]?[r[l],w,r[l+1]]:[r[l],r[l+1]]:(w=(E-k(x))/b,R=(E+k(x))/b,S=[r[l]],w>r[l]&&w<r[l+1]&&S.push(w),R>r[l]&&R<r[l+1]&&S.push(R),S.push(r[l+1])),T=S[0],w=this._at(T,l),u=0;u<S.length-1;u++)if(O=S[u+1],R=this._at(O,l),0!==w)if(0===R||w*R>0)T=O,w=R;else{for(var M=0;!((_=(w*O-R*T)/(w-R))<=T||_>=O);)if((C=this._at(_,l))*R>0)O=_,R=C,-1===M&&(w*=.5),M=-1;else{if(!(C*w>0))break;T=_,w=C,1===M&&(R*=.5),M=1}p.push(_),T=S[u+1],w=this._at(T,l)}else p.push(T),T=O,w=R;0===R&&p.push(O)}t[s]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,r,n){var i,a=e.length,o=[],s=[],l=[],u=numeric.sub,c=numeric.mul,f=numeric.add;for(i=a-2;i>=0;i--)s[i]=e[i+1]-e[i],l[i]=u(t[i+1],t[i]);"string"!=typeof r&&"string"!=typeof n||(r=n="periodic");var d=[[],[],[]];switch(typeof r){case"undefined":o[0]=c(3/(s[0]*s[0]),l[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/s[0],1/s[0]);break;case"string":o[0]=f(c(3/(s[a-2]*s[a-2]),l[a-2]),c(3/(s[0]*s[0]),l[0])),d[0].push(0,0,0),d[1].push(a-2,0,1),d[2].push(1/s[a-2],2/s[a-2]+2/s[0],1/s[0]);break;default:o[0]=r,d[0].push(0),d[1].push(0),d[2].push(1)}for(i=1;i<a-1;i++)o[i]=f(c(3/(s[i-1]*s[i-1]),l[i-1]),c(3/(s[i]*s[i]),l[i])),d[0].push(i,i,i),d[1].push(i-1,i,i+1),d[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof n){case"undefined":o[a-1]=c(3/(s[a-2]*s[a-2]),l[a-2]),d[0].push(a-1,a-1),d[1].push(a-2,a-1),d[2].push(1/s[a-2],2/s[a-2]);break;case"string":d[1][d[1].length-1]=0;break;default:o[a-1]=n,d[0].push(a-1),d[1].push(a-1),d[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var h=Array(o.length);if("string"==typeof r)for(i=h.length-1;-1!==i;--i)h[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),o[i]),h[i][a-1]=h[i][0];else for(i=h.length-1;-1!==i;--i)h[i]=numeric.cLUsolve(numeric.cLU(d),o[i]);return h="number"==typeof t[0]?h[0]:numeric.transpose(h),new numeric.Spline(e,t,t,h,h)},numeric.fftpow2=function e(t,r){var n=t.length;if(1!==n){var i,a,o=Math.cos,s=Math.sin,l=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(a=n/2,i=n-1;-1!==i;--i)c[--a]=t[i],f[a]=r[i],--i,l[a]=t[i],u[a]=r[i];e(l,u),e(c,f),a=n/2;var d,h,p,m=-6.283185307179586/n;for(i=n-1;-1!==i;--i)-1===--a&&(a=n/2-1),h=o(d=m*i),p=s(d),t[i]=l[a]+h*c[a]-p*f[a],r[i]=u[a]+h*f[a]+p*c[a]}},numeric._ifftpow2=function e(t,r){var n=t.length;if(1!==n){var i,a,o=Math.cos,s=Math.sin,l=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(a=n/2,i=n-1;-1!==i;--i)c[--a]=t[i],f[a]=r[i],--i,l[a]=t[i],u[a]=r[i];e(l,u),e(c,f),a=n/2;var d,h,p,m=6.283185307179586/n;for(i=n-1;-1!==i;--i)-1===--a&&(a=n/2-1),h=o(d=m*i),p=s(d),t[i]=l[a]+h*c[a]-p*f[a],r[i]=u[a]+h*f[a]+p*c[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,n){var i,a,o,s,l;for(numeric.fftpow2(e,t),numeric.fftpow2(r,n),i=e.length-1;-1!==i;--i)a=e[i],s=t[i],o=r[i],l=n[i],e[i]=a*o-s*l,t[i]=a*l+s*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,r=this.x,n=this.y,i=r.length,a=Math.log,o=a(2),s=Math.ceil(a(2*i-1)/o),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),f=Math.cos,d=Math.sin,h=-3.141592653589793/i,p=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(i/2);for(e=0;e<i;e++)p[e]=r[e];if(void 0!==n)for(e=0;e<i;e++)m[e]=n[e];for(u[0]=1,e=1;e<=l/2;e++)t=h*e*e,u[e]=f(t),c[e]=d(t),u[l-e]=f(t),c[l-e]=d(t);var v=new numeric.T(p,m),y=new numeric.T(u,c);return v=v.mul(y),numeric.convpow2(v.x,v.y,numeric.clone(y.x),numeric.neg(y.y)),(v=v.mul(y)).x.length=i,v.y.length=i,v},numeric.T.prototype.ifft=function(){var e,t,r=this.x,n=this.y,i=r.length,a=Math.log,o=a(2),s=Math.ceil(a(2*i-1)/o),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),f=Math.cos,d=Math.sin,h=3.141592653589793/i,p=numeric.rep([l],0),m=numeric.rep([l],0);Math.floor(i/2);for(e=0;e<i;e++)p[e]=r[e];if(void 0!==n)for(e=0;e<i;e++)m[e]=n[e];for(u[0]=1,e=1;e<=l/2;e++)t=h*e*e,u[e]=f(t),c[e]=d(t),u[l-e]=f(t),c[l-e]=d(t);var v=new numeric.T(p,m),y=new numeric.T(u,c);return v=v.mul(y),numeric.convpow2(v.x,v.y,numeric.clone(y.x),numeric.neg(y.y)),(v=v.mul(y)).x.length=i,v.y.length=i,v.div(i)},numeric.gradient=function(e,t){var r=t.length,n=e(t);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var i,a,o,s,l,u,c,f,d,h=Math.max,p=numeric.clone(t),m=Array(r),v=(numeric.div,numeric.sub,h=Math.max,Math.abs),y=Math.min,g=0;for(i=0;i<r;i++)for(var E=h(1e-6*n,1e-8);;){if(++g>20)throw new Error("Numerical gradient fails");if(p[i]=t[i]+E,a=e(p),p[i]=t[i]-E,o=e(p),p[i]=t[i],isNaN(a)||isNaN(o))E/=16;else{if(m[i]=(a-o)/(2*E),s=t[i]-E,l=t[i],u=t[i]+E,c=(a-n)/E,f=(n-o)/E,d=h(v(m[i]),v(n),v(a),v(o),v(s),v(l),v(u),1e-8),!(y(h(v(c-m[i]),v(f-m[i]),v(c-f))/d,E/d)>.001))break;E/=16}}return m},numeric.uncmin=function(e,t,r,n,i,a,o){var s=numeric.gradient;void 0===o&&(o={}),void 0===r&&(r=1e-8),void 0===n&&(n=function(t){return s(e,t)}),void 0===i&&(i=1e3);var l,u,c=(t=numeric.clone(t)).length,f=e(t);if(isNaN(f))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,h=numeric.norm2;r=d(r,numeric.epsilon);var p,m,v,y,g,E,b,x,A,S,w=o.Hinv||numeric.identity(c),R=numeric.dot,C=(numeric.inv,numeric.sub),T=numeric.add,O=numeric.tensor,_=numeric.div,D=numeric.mul,N=numeric.all,k=numeric.isFinite,M=numeric.neg,I=0,P="";for(m=n(t);I<i;){if("function"==typeof a&&a(I,t,f,m,w)){P="Callback returned true";break}if(!N(k(m))){P="Gradient has Infinity or NaN";break}if(!N(k(p=M(R(w,m))))){P="Search direction has Infinity or NaN";break}if((S=h(p))<r){P="Newton step smaller than tol";break}for(A=1,u=R(m,p),g=t;I<i&&!(A*S<r)&&(g=T(t,y=D(p,A)),(l=e(g))-f>=.1*A*u||isNaN(l));)A*=.5,++I;if(A*S<r){P="Line search step size smaller than tol";break}if(I===i){P="maxit reached during line search";break}x=R(E=C(v=n(g),m),y),b=R(w,E),w=C(T(w,D((x+R(E,b))/(x*x),O(y,y))),_(T(O(b,y),O(y,b)),x)),t=g,f=l,m=v,++I}return{solution:t,f:f,gradient:m,invHessian:w,iterations:I,message:P}},numeric.Dopri=function(e,t,r,n,i,a,o){this.x=e,this.y=t,this.f=r,this.ymid=n,this.iterations=i,this.events=o,this.message=a},numeric.Dopri.prototype._at=function(e,t){function r(e){return e*e}var n,i,a,o,s,l,u,c,f,d=this.x,h=this.y,p=this.f,m=this.ymid,v=(d.length,Math.floor,numeric.add),y=numeric.mul,g=numeric.sub;return n=d[t],i=d[t+1],o=h[t],s=h[t+1],a=n+.5*(i-n),l=m[t],u=g(p[t],y(o,1/(n-a)+2/(n-i))),c=g(p[t+1],y(s,1/(i-a)+2/(i-n))),v(v(v(v(y(o,(f=[r(e-i)*(e-a)/r(n-i)/(n-a),r(e-n)*r(e-i)/r(n-a)/r(i-a),r(e-n)*(e-a)/r(i-n)/(i-a),(e-n)*r(e-i)*(e-a)/r(n-i)/(n-a),(e-i)*r(e-n)*(e-a)/r(n-i)/(i-a)])[0]),y(l,f[1])),y(s,f[2])),y(u,f[3])),y(c,f[4]))},numeric.Dopri.prototype.at=function(e){var t,r,n,i=Math.floor;if("number"!=typeof e){var a=e.length,o=Array(a);for(t=a-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var s=this.x;for(t=0,r=s.length-1;r-t>1;)s[n=i(.5*(t+r))]<=e?t=n:r=n;return this._at(e,t)},numeric.dopri=function(e,t,r,n,i,a,o){void 0===i&&(i=1e-6),void 0===a&&(a=1e3);var s,l,u,c,f,d,h,p,m,v,y,g,E,b=[e],x=[r],A=[n(e,r)],S=[],w=[.075,.225],R=[44/45,-56/15,32/9],C=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],_=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],D=[.2,.3,.8,8/9,1,1],N=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],k=0,M=(t-e)/10,I=0,P=numeric.add,F=numeric.mul,L=(Math.max,Math.min),j=Math.abs,B=numeric.norminf,U=Math.pow,V=numeric.any,H=numeric.lt,z=numeric.and,X=(numeric.sub,new numeric.Dopri(b,x,A,S,-1,""));for("function"==typeof o&&(y=o(e,r));e<t&&I<a;)if(++I,e+M>t&&(M=t-e),s=n(e+D[0]*M,P(r,F(.2*M,A[k]))),l=n(e+D[1]*M,P(P(r,F(w[0]*M,A[k])),F(w[1]*M,s))),u=n(e+D[2]*M,P(P(P(r,F(R[0]*M,A[k])),F(R[1]*M,s)),F(R[2]*M,l))),c=n(e+D[3]*M,P(P(P(P(r,F(C[0]*M,A[k])),F(C[1]*M,s)),F(C[2]*M,l)),F(C[3]*M,u))),f=n(e+D[4]*M,P(P(P(P(P(r,F(T[0]*M,A[k])),F(T[1]*M,s)),F(T[2]*M,l)),F(T[3]*M,u)),F(T[4]*M,c))),d=n(e+M,m=P(P(P(P(P(r,F(A[k],M*O[0])),F(l,M*O[2])),F(u,M*O[3])),F(c,M*O[4])),F(f,M*O[5]))),(v="number"==typeof(h=P(P(P(P(P(F(A[k],M*N[0]),F(l,M*N[2])),F(u,M*N[3])),F(c,M*N[4])),F(f,M*N[5])),F(d,M*N[6])))?j(h):B(h))>i){if(e+(M=.2*M*U(i/v,.25))===e){X.msg="Step size became too small";break}}else{if(S[k]=P(P(P(P(P(P(r,F(A[k],M*_[0])),F(l,M*_[2])),F(u,M*_[3])),F(c,M*_[4])),F(f,M*_[5])),F(d,M*_[6])),b[++k]=e+M,x[k]=m,A[k]=d,"function"==typeof o){var q,W,G=e,Y=e+.5*M;if(g=o(Y,S[k-1]),V(E=z(H(y,0),H(0,g)))||(G=Y,y=g,g=o(Y=e+M,m),E=z(H(y,0),H(0,g))),V(E)){for(var J,$,K=0,Q=1,Z=1;;){if("number"==typeof y)W=(Z*g*G-Q*y*Y)/(Z*g-Q*y);else for(W=Y,p=y.length-1;-1!==p;--p)y[p]<0&&g[p]>0&&(W=L(W,(Z*g[p]*G-Q*y[p]*Y)/(Z*g[p]-Q*y[p])));if(W<=G||W>=Y)break;$=o(W,q=X._at(W,k-1)),V(J=z(H(y,0),H(0,$)))?(Y=W,g=$,E=J,Z=1,-1===K?Q*=.5:Q=1,K=-1):(G=W,y=$,Q=1,1===K?Z*=.5:Z=1,K=1)}return m=X._at(.5*(e+W),k-1),X.f[k]=n(W,q),X.x[k]=W,X.y[k]=q,X.ymid[k-1]=m,X.events=E,X.iterations=I,X}}e+=M,r=m,y=g,M=L(.8*M*U(i/v,.25),4*M)}return X.iterations=I,X},numeric.LU=function(e,t){t=t||!1;var r,n,i,a,o,s,l,u,c,f=Math.abs,d=e.length,h=d-1,p=new Array(d);for(t||(e=numeric.clone(e)),i=0;i<d;++i){for(l=i,c=f((s=e[i])[i]),n=i+1;n<d;++n)c<(a=f(e[n][i]))&&(c=a,l=n);for(p[i]=l,l!=i&&(e[i]=e[l],e[l]=s,s=e[i]),o=s[i],r=i+1;r<d;++r)e[r][i]/=o;for(r=i+1;r<d;++r){for(u=e[r],n=i+1;n<h;++n)u[n]-=u[i]*s[n],u[++n]-=u[i]*s[n];n===h&&(u[n]-=u[i]*s[n])}}return{LU:e,P:p}},numeric.LUsolve=function(e,t){var r,n,i,a,o,s=e.LU,l=s.length,u=numeric.clone(t),c=e.P;for(r=l-1;-1!==r;--r)u[r]=t[r];for(r=0;r<l;++r)for(i=c[r],c[r]!==r&&(o=u[r],u[r]=u[i],u[i]=o),a=s[r],n=0;n<r;++n)u[r]-=u[n]*a[n];for(r=l-1;r>=0;--r){for(a=s[r],n=r+1;n<l;++n)u[r]-=u[n]*a[n];u[r]/=a[r]}return u},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t,r,n,i,a,o,s,l,u=numeric.dim(e),c=u[0],f=u[1],d=numeric.identity(c),h=Array(c),p=Math.abs,m=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(n=0,a=e[t],o=d[t],r=1;r<f;++r)p(a[n])<p(a[r])&&(n=r);for(h[t]=n,m(o,a[n]),m(a,a[n]),r=0;r<c;++r)if(r!==t){for(l=(s=e[r])[n],i=f-1;-1!==i;--i)s[i]-=a[i]*l;for(s=d[r],i=c-1;-1!==i;--i)s[i]-=o[i]*l}}return{I:d,A:e,P:h}},numeric.__solveLP=function(e,t,r,n,i,a,o){var s,l,u,c,f=numeric.sum,d=(numeric.log,numeric.mul),h=numeric.sub,p=numeric.dot,m=numeric.div,v=numeric.add,y=e.length,g=r.length,E=!1,b=1,x=(numeric.transpose(t),numeric.svd,numeric.transpose),A=(numeric.leq,Math.sqrt),S=Math.abs,w=(numeric.muleq,numeric.norminf,numeric.any,Math.min),R=numeric.all,C=numeric.gt,T=Array(y),O=Array(g),_=(numeric.rep([g],1),numeric.solve),D=h(r,p(t,a)),N=p(e,e);for(u=0;u<i;++u){var k,M;for(k=g-1;-1!==k;--k)O[k]=m(t[k],D[k]);var I=x(O);for(k=y-1;-1!==k;--k)T[k]=f(I[k]);b=.25*S(N/p(e,T));var P=100*A(N/p(T,T));for((!isFinite(b)||b>P)&&(b=P),c=v(e,d(b,T)),l=p(I,O),k=y-1;-1!==k;--k)l[k][k]+=1;M=_(l,m(c,b),!0);var F=m(D,p(t,M)),L=1;for(k=g-1;-1!==k;--k)F[k]<0&&(L=w(L,-.999*F[k]));if(s=h(a,d(M,L)),!R(C(D=h(r,p(t,s)),0)))return{solution:a,message:"",iterations:u};if(a=s,b<n)return{solution:s,message:"",iterations:u};if(o){var j=p(e,c),B=p(t,c);for(E=!0,k=g-1;-1!==k;--k)if(j*B[k]<0){E=!1;break}}else E=!(a[y-1]>=0);if(E)return{solution:s,message:"Unbounded",iterations:u}}return{solution:a,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,r,n,i){var a=e.length,o=r.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),c=numeric.rep([o,1],-1),f=numeric.blockMatrix([[t,c]]),d=r,h=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),p=numeric.__solveLP(u,f,d,n,i,h,!1),m=numeric.clone(p.solution);if(m.length=a,numeric.inf(s(r,l(t,m)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var v=numeric.__solveLP(e,t,r,n,i-p.iterations,m,!0);return v.iterations+=p.iterations,v},numeric.solveLP=function(e,t,r,n,i,a,o){if(void 0===o&&(o=1e3),void 0===a&&(a=numeric.epsilon),void 0===n)return numeric._solveLP(e,t,r,a,o);var s,l=n.length,u=n[0].length,c=t.length,f=numeric.echelonize(n),d=numeric.rep([u],0),h=f.P,p=[];for(s=h.length-1;-1!==s;--s)d[h[s]]=1;for(s=u-1;-1!==s;--s)0===d[s]&&p.push(s);var m=numeric.getRange,v=numeric.linspace(0,l-1),y=numeric.linspace(0,c-1),g=m(n,v,p),E=m(t,y,h),b=m(t,y,p),x=numeric.dot,A=numeric.sub,S=x(E,f.I),w=A(b,x(S,g)),R=A(r,x(S,i)),C=Array(h.length),T=Array(p.length);for(s=h.length-1;-1!==s;--s)C[s]=e[h[s]];for(s=p.length-1;-1!==s;--s)T[s]=e[p[s]];var O=A(T,x(C,x(f.I,g))),_=numeric._solveLP(O,w,R,a,o),D=_.solution;if(D!=D)return _;var N=x(f.I,A(i,x(g,D))),k=Array(e.length);for(s=h.length-1;-1!==s;--s)k[h[s]]=N[s];for(s=p.length-1;-1!==s;--s)k[p[s]]=D[s];return{solution:k,message:_.message,iterations:_.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,r,n,i,a=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,l=0,u={},c=[],f=0,d={},h=0,p=[],m=[],v=[];function y(r){throw new Error("MPStoLP: "+r+"\nLine "+t+": "+e[t]+"\nCurrent state: "+o[a]+"\n")}for(t=0;t<s;++t){var g=(n=e[t]).match(/\S*/g),E=[];for(r=0;r<g.length;++r)""!==g[r]&&E.push(g[r]);if(0!==E.length){for(r=0;r<o.length&&n.substr(0,o[r].length)!==o[r];++r);if(r<o.length){if(a=r,1===r&&(i=E[1]),6===r)return{name:i,c:p,A:numeric.transpose(m),b:v,rows:u,vars:d}}else switch(a){case 0:case 1:y("Unexpected line");case 2:switch(E[0]){case"N":0===l?l=E[1]:y("Two or more N rows");break;case"L":u[E[1]]=f,c[f]=1,v[f]=0,++f;break;case"G":u[E[1]]=f,c[f]=-1,v[f]=0,++f;break;case"E":u[E[1]]=f,c[f]=0,v[f]=0,++f;break;default:y("Parse error "+numeric.prettyPrint(E))}break;case 3:d.hasOwnProperty(E[0])||(d[E[0]]=h,p[h]=0,m[h]=numeric.rep([f],0),++h);var b=d[E[0]];for(r=1;r<E.length;r+=2)if(E[r]!==l){var x=u[E[r]];m[b][x]=(c[x]<0?-1:1)*parseFloat(E[r+1])}else p[b]=parseFloat(E[r+1]);break;case 4:for(r=1;r<E.length;r+=2)v[u[E[r]]]=(c[u[E[r]]]<0?-1:1)*parseFloat(E[r+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,r,n,i,a,o){function s(e){var t,n,i=this,a=e.length,o=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],a||(e=[a++]);o<r;)i.S[o]=o++;for(o=0;o<r;o++)s=c(s+(t=i.S[o])+e[o%a]),n=i.S[s],i.S[o]=n,i.S[s]=t;i.g=function(e){var t=i.S,n=c(i.i+1),a=t[n],o=c(i.j+a),s=t[o];t[n]=s,t[o]=a;for(var l=t[c(a+s)];--e;)n=c(n+1),s=t[o=c(o+(a=t[n]))],t[n]=s,t[o]=a,l=l*r+t[c(a+s)];return i.i=n,i.j=o,l},i.g(r)}function l(e,t,r,n,i){if(r=[],i=typeof e,t&&"object"==i)for(n in e)if(n.indexOf("S")<5)try{r.push(l(e[n],t-1))}catch(e){}return r.length?r:e+("string"!=i?"\0":"")}function u(e,t,r,n){for(e+="",r=0,n=0;n<e.length;n++)t[c(n)]=c((r^=19*t[c(n)])+e.charCodeAt(n));for(n in e="",t)e+=String.fromCharCode(t[n]);return e}function c(e){return e&r-1}t.seedrandom=function(n,c){var f,d=[];return n=u(l(c?[n,e]:arguments.length?n:[(new Date).getTime(),e,window],3),d),u((f=new s(d)).S,e),t.random=function(){for(var e=f.g(6),t=o,n=0;e<i;)e=(e+n)*r,t*=r,n=f.g(1);for(;e>=a;)e/=2,t/=2,n>>>=1;return(e+n)/t},n},o=t.pow(r,6),i=t.pow(2,i),a=2*i,u(t.random(),e)}([],numeric.seedrandom,256,0,52),function(e){function t(e){if("object"!=typeof e)return e;var r,n=[],i=e.length;for(r=0;r<i;r++)n[r+1]=t(e[r]);return n}function r(e){if("object"!=typeof e)return e;var t,n=[],i=e.length;for(t=1;t<i;t++)n[t-1]=r(e[t]);return n}function n(e,t,r,n,i,a,o,s,l,u,c,f,d,h,p,m){var v,y,g,E,b,x,A,S,w,R,C,T,O,_,D,N,k,M,I,P,F,L,j,B,U,V,H;O=Math.min(n,u),g=2*n+O*(O+5)/2+2*u+1,B=1e-60;do{U=1+.1*(B+=B),V=1+.2*B}while(U<=1||V<=1);for(v=1;v<=n;v+=1)p[v]=t[v];for(v=n+1;v<=g;v+=1)p[v]=0;for(v=1;v<=u;v+=1)f[v]=0;if(b=[],0===m[1]){if(function(e,t,r,n){var i,a,o,s,l,u;for(a=1;a<=r;a+=1){if(n[1]=a,u=0,(o=a-1)<1){if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}else{for(s=1;s<=o;s+=1){for(l=e[s][a],i=1;i<s;i+=1)l-=e[i][a]*e[i][s];l/=e[s][s],e[s][a]=l,u+=l*l}if((u=e[a][a]-u)<=0)break;e[a][a]=Math.sqrt(u)}n[1]=0}}(e,0,n,b),0!==b[1])return void(m[1]=2);!function(e,t,r,n){var i,a,o,s;for(a=1;a<=r;a+=1){for(s=0,i=1;i<a;i+=1)s+=e[i][a]*n[i];n[a]=(n[a]-s)/e[a][a]}for(o=1;o<=r;o+=1)for(n[a=r+1-o]=n[a]/e[a][a],s=-n[a],i=1;i<a;i+=1)n[i]=n[i]+s*e[i][a]}(e,0,n,t),function(e,t,r){var n,i,a,o,s;for(a=1;a<=r;a+=1){for(e[a][a]=1/e[a][a],s=-e[a][a],n=1;n<a;n+=1)e[n][a]=s*e[n][a];if(r<(o=a+1))break;for(i=o;i<=r;i+=1)for(s=e[a][i],e[a][i]=0,n=1;n<=a;n+=1)e[n][i]=e[n][i]+s*e[n][a]}}(e,0,n)}else{for(y=1;y<=n;y+=1)for(i[y]=0,v=1;v<=y;v+=1)i[y]=i[y]+e[v][y]*t[v];for(y=1;y<=n;y+=1)for(t[y]=0,v=y;v<=n;v+=1)t[y]=t[y]+e[y][v]*i[v]}for(a[1]=0,y=1;y<=n;y+=1)for(i[y]=t[y],a[1]=a[1]+p[y]*i[y],p[y]=0,v=y+1;v<=n;v+=1)e[v][y]=0;for(a[1]=-a[1]/2,m[1]=0,_=(R=(w=(C=(S=(A=n)+n)+O)+O+1)+O*(O+1)/2)+u,v=1;v<=u;v+=1){for(N=0,y=1;y<=n;y+=1)N+=o[y][v]*o[y][v];p[_+v]=Math.sqrt(N)}function z(){for(h[1]=h[1]+1,g=R,v=1;v<=u;v+=1){for(g+=1,N=-s[v],y=1;y<=n;y+=1)N+=o[y][v]*i[y];if(Math.abs(N)<B&&(N=0),v>c)p[g]=N;else if(p[g]=-Math.abs(N),N>0){for(y=1;y<=n;y+=1)o[y][v]=-o[y][v];s[v]=-s[v]}}for(v=1;v<=d;v+=1)p[R+f[v]]=0;for(T=0,D=0,v=1;v<=u;v+=1)p[R+v]<D*p[_+v]&&(T=v,D=p[R+v]/p[_+v]);return 0===T?999:0}function X(){for(v=1;v<=n;v+=1){for(N=0,y=1;y<=n;y+=1)N+=e[y][v]*o[y][T];p[v]=N}for(E=A,v=1;v<=n;v+=1)p[E+v]=0;for(y=d+1;y<=n;y+=1)for(v=1;v<=n;v+=1)p[E+v]=p[E+v]+e[v][y]*p[y];for(L=!0,v=d;v>=1;v-=1){for(N=p[v],E=(g=w+v*(v+3)/2)-v,y=v+1;y<=d;y+=1)N-=p[g]*p[S+y],g+=y;if(N/=p[E],p[S+v]=N,f[v]<c)break;if(N<0)break;L=!1,x=v}if(!L)for(k=p[C+x]/p[S+x],v=1;v<=d&&!(f[v]<c)&&!(p[S+v]<0);v+=1)(D=p[C+v]/p[S+v])<k&&(k=D,x=v);for(N=0,v=A+1;v<=A+n;v+=1)N+=p[v]*p[v];if(Math.abs(N)<=B){if(L)return m[1]=1,999;for(v=1;v<=d;v+=1)p[C+v]=p[C+v]-k*p[S+v];return p[C+d+1]=p[C+d+1]+k,700}for(N=0,v=1;v<=n;v+=1)N+=p[A+v]*o[v][T];for(M=-p[R+T]/N,j=!0,L||k<M&&(M=k,j=!1),v=1;v<=n;v+=1)i[v]=i[v]+M*p[A+v],Math.abs(i[v])<B&&(i[v]=0);for(a[1]=a[1]+M*N*(M/2+p[C+d+1]),v=1;v<=d;v+=1)p[C+v]=p[C+v]-M*p[S+v];if(p[C+d+1]=p[C+d+1]+M,!j){for(N=-s[T],y=1;y<=n;y+=1)N+=i[y]*o[y][T];if(T>c)p[R+T]=N;else if(p[R+T]=-Math.abs(N),N>0){for(y=1;y<=n;y+=1)o[y][T]=-o[y][T];s[T]=-s[T]}return 700}for(f[d+=1]=T,g=w+(d-1)*d/2+1,v=1;v<=d-1;v+=1)p[g]=p[v],g+=1;if(d===n)p[g]=p[n];else{for(v=n;v>=d+1&&0!==p[v]&&(I=Math.max(Math.abs(p[v-1]),Math.abs(p[v])),P=Math.min(Math.abs(p[v-1]),Math.abs(p[v])),D=p[v-1]>=0?Math.abs(I*Math.sqrt(1+P*P/(I*I))):-Math.abs(I*Math.sqrt(1+P*P/(I*I))),I=p[v-1]/D,P=p[v]/D,1!==I);v-=1)if(0===I)for(p[v-1]=P*D,y=1;y<=n;y+=1)D=e[y][v-1],e[y][v-1]=e[y][v],e[y][v]=D;else for(p[v-1]=D,F=P/(1+I),y=1;y<=n;y+=1)D=I*e[y][v-1]+P*e[y][v],e[y][v]=F*(e[y][v-1]+D)-e[y][v],e[y][v-1]=D;p[g]=p[d]}return 0}function q(){if(0===p[E=(g=w+x*(x+1)/2+1)+x])return 798;if(I=Math.max(Math.abs(p[E-1]),Math.abs(p[E])),P=Math.min(Math.abs(p[E-1]),Math.abs(p[E])),D=p[E-1]>=0?Math.abs(I*Math.sqrt(1+P*P/(I*I))):-Math.abs(I*Math.sqrt(1+P*P/(I*I))),I=p[E-1]/D,P=p[E]/D,1===I)return 798;if(0===I){for(v=x+1;v<=d;v+=1)D=p[E-1],p[E-1]=p[E],p[E]=D,E+=v;for(v=1;v<=n;v+=1)D=e[v][x],e[v][x]=e[v][x+1],e[v][x+1]=D}else{for(F=P/(1+I),v=x+1;v<=d;v+=1)D=I*p[E-1]+P*p[E],p[E]=F*(p[E-1]+D)-p[E],p[E-1]=D,E+=v;for(v=1;v<=n;v+=1)D=I*e[v][x]+P*e[v][x+1],e[v][x+1]=F*(e[v][x]+D)-e[v][x+1],e[v][x]=D}return 0}function W(){for(E=g-x,v=1;v<=x;v+=1)p[E]=p[g],g+=1,E+=1;return p[C+x]=p[C+x+1],f[x]=f[x+1],(x+=1)<d?797:0}function G(){return p[C+d]=p[C+d+1],p[C+d+1]=0,f[d]=0,d-=1,h[2]=h[2]+1,0}for(d=0,h[1]=0,h[2]=0,H=0;;){if(999===(H=z()))return;for(;0!==(H=X());){if(999===H)return;if(700===H)if(x===d)G();else{for(;q(),797===(H=W()););G()}}}}e.solveQP=function(e,i,a,o,s,l){e=t(e),i=t(i),a=t(a);var u,c,f,d,h,p=[],m=[],v=[],y=[],g=[];if(s=s||0,l=l?t(l):[void 0,0],o=o?t(o):[],c=e.length-1,f=a[1].length-1,!o)for(u=1;u<=f;u+=1)o[u]=0;for(u=1;u<=f;u+=1)m[u]=0;for(0,d=Math.min(c,f),u=1;u<=c;u+=1)v[u]=0;for(p[1]=0,u=1;u<=2*c+d*(d+5)/2+2*f+1;u+=1)y[u]=0;for(u=1;u<=2;u+=1)g[u]=0;return n(e,i,0,c,v,p,a,o,0,f,s,m,0,g,y,l),h="",1===l[1]&&(h="constraints are inconsistent, no solution!"),2===l[1]&&(h="matrix D in quadratic function is not positive definite!"),{solution:r(v),value:r(p),unconstrained_solution:r(i),iterations:r(g),iact:r(m),message:h}}}(numeric),numeric.svd=function(e){var t,r=numeric.epsilon,n=1e-64/r,i=0,a=0,o=0,s=0,l=0,u=numeric.clone(e),c=u.length,f=u[0].length;if(c<f)throw"Need more rows than columns";var d=new Array(f),h=new Array(f);for(a=0;a<f;a++)d[a]=h[a]=0;var p=numeric.rep([f,f],0);function m(e,t){return(e=Math.abs(e))>(t=Math.abs(t))?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var v=0,y=0,g=0,E=0,b=0,x=0,A=0;for(a=0;a<f;a++){for(d[a]=y,A=0,l=a+1,o=a;o<c;o++)A+=u[o][a]*u[o][a];if(A<=n)y=0;else for(v=u[a][a],y=Math.sqrt(A),v>=0&&(y=-y),g=v*y-A,u[a][a]=v-y,o=l;o<f;o++){for(A=0,s=a;s<c;s++)A+=u[s][a]*u[s][o];for(v=A/g,s=a;s<c;s++)u[s][o]+=v*u[s][a]}for(h[a]=y,A=0,o=l;o<f;o++)A+=u[a][o]*u[a][o];if(A<=n)y=0;else{for(v=u[a][a+1],y=Math.sqrt(A),v>=0&&(y=-y),g=v*y-A,u[a][a+1]=v-y,o=l;o<f;o++)d[o]=u[a][o]/g;for(o=l;o<c;o++){for(A=0,s=l;s<f;s++)A+=u[o][s]*u[a][s];for(s=l;s<f;s++)u[o][s]+=A*d[s]}}(b=Math.abs(h[a])+Math.abs(d[a]))>E&&(E=b)}for(a=f-1;-1!=a;a+=-1){if(0!=y){for(g=y*u[a][a+1],o=l;o<f;o++)p[o][a]=u[a][o]/g;for(o=l;o<f;o++){for(A=0,s=l;s<f;s++)A+=u[a][s]*p[s][o];for(s=l;s<f;s++)p[s][o]+=A*p[s][a]}}for(o=l;o<f;o++)p[a][o]=0,p[o][a]=0;p[a][a]=1,y=d[a],l=a}for(a=f-1;-1!=a;a+=-1){for(l=a+1,y=h[a],o=l;o<f;o++)u[a][o]=0;if(0!=y){for(g=u[a][a]*y,o=l;o<f;o++){for(A=0,s=l;s<c;s++)A+=u[s][a]*u[s][o];for(v=A/g,s=a;s<c;s++)u[s][o]+=v*u[s][a]}for(o=a;o<c;o++)u[o][a]=u[o][a]/y}else for(o=a;o<c;o++)u[o][a]=0;u[a][a]+=1}for(r*=E,s=f-1;-1!=s;s+=-1)for(var S=0;S<50;S++){var w=!1;for(l=s;-1!=l;l+=-1){if(Math.abs(d[l])<=r){w=!0;break}if(Math.abs(h[l-1])<=r)break}if(!w){i=0,A=1;var R=l-1;for(a=l;a<s+1&&(v=A*d[a],d[a]=i*d[a],!(Math.abs(v)<=r));a++)for(g=m(v,y=h[a]),h[a]=g,i=y/g,A=-v/g,o=0;o<c;o++)b=u[o][R],x=u[o][a],u[o][R]=b*i+x*A,u[o][a]=-b*A+x*i}if(x=h[s],l==s){if(x<0)for(h[s]=-x,o=0;o<f;o++)p[o][s]=-p[o][s];break}if(S>=49)throw"Error: no convergence.";for(E=h[l],y=m(v=(((b=h[s-1])-x)*(b+x)+((y=d[s-1])-(g=d[s]))*(y+g))/(2*g*b),1),v=v<0?((E-x)*(E+x)+g*(b/(v-y)-g))/E:((E-x)*(E+x)+g*(b/(v+y)-g))/E,i=1,A=1,a=l+1;a<s+1;a++){for(y=d[a],b=h[a],g=A*y,y*=i,x=m(v,g),d[a-1]=x,v=E*(i=v/x)+y*(A=g/x),y=-E*A+y*i,g=b*A,b*=i,o=0;o<f;o++)E=p[o][a-1],x=p[o][a],p[o][a-1]=E*i+x*A,p[o][a]=-E*A+x*i;for(x=m(v,g),h[a-1]=x,v=(i=v/x)*y+(A=g/x)*b,E=-A*y+i*b,o=0;o<c;o++)b=u[o][a-1],x=u[o][a],u[o][a-1]=b*i+x*A,u[o][a]=-b*A+x*i}d[l]=0,d[s]=v,h[s]=E}for(a=0;a<h.length;a++)h[a]<r&&(h[a]=0);for(a=0;a<f;a++)for(o=a-1;o>=0;o--)if(h[o]<h[a]){for(i=h[o],h[o]=h[a],h[a]=i,s=0;s<u.length;s++)t=u[s][a],u[s][a]=u[s][o],u[s][o]=t;for(s=0;s<p.length;s++)t=p[s][a],p[s][a]=p[s][o],p[s][o]=t;a=o}return{U:u,S:h,V:p}}}).call(this,__webpack_require__(56))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n,i;
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */void 0===(i="function"==typeof(n=function(){var e,t,r,n,i,a={},o={},s={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},l={currentLocale:s.currentLocale,zeroFormat:s.zeroFormat,nullFormat:s.nullFormat,defaultFormat:s.defaultFormat,scalePercentBy100:s.scalePercentBy100};function u(e,t){this._input=e,this._value=t}return(e=function(r){var n,i,o,s;if(e.isNumeral(r))n=r.value();else if(0===r||void 0===r)n=0;else if(null===r||t.isNaN(r))n=null;else if("string"==typeof r)if(l.zeroFormat&&r===l.zeroFormat)n=0;else if(l.nullFormat&&r===l.nullFormat||!r.replace(/[^0-9]+/g,"").length)n=null;else{for(i in a)if((s="function"==typeof a[i].regexps.unformat?a[i].regexps.unformat():a[i].regexps.unformat)&&r.match(s)){o=a[i].unformat;break}n=(o=o||e._.stringToNumber)(r)}else n=Number(r)||null;return new u(r,n)}).version="2.0.6",e.isNumeral=function(e){return e instanceof u},e._=t={numberToFormat:function(t,r,n){var i,a,s,l,u,c,f,d,h=o[e.options.currentLocale],p=!1,m=!1,v="",y="",g=!1;if(t=t||0,s=Math.abs(t),e._.includes(r,"(")?(p=!0,r=r.replace(/[\(|\)]/g,"")):(e._.includes(r,"+")||e._.includes(r,"-"))&&(c=e._.includes(r,"+")?r.indexOf("+"):t<0?r.indexOf("-"):-1,r=r.replace(/[\+|\-]/g,"")),e._.includes(r,"a")&&(a=!!(a=r.match(/a(k|m|b|t)?/))&&a[1],e._.includes(r," a")&&(v=" "),r=r.replace(new RegExp(v+"a[kmbt]?"),""),s>=1e12&&!a||"t"===a?(v+=h.abbreviations.trillion,t/=1e12):s<1e12&&s>=1e9&&!a||"b"===a?(v+=h.abbreviations.billion,t/=1e9):s<1e9&&s>=1e6&&!a||"m"===a?(v+=h.abbreviations.million,t/=1e6):(s<1e6&&s>=1e3&&!a||"k"===a)&&(v+=h.abbreviations.thousand,t/=1e3)),e._.includes(r,"[.]")&&(m=!0,r=r.replace("[.]",".")),l=t.toString().split(".")[0],u=r.split(".")[1],f=r.indexOf(","),i=(r.split(".")[0].split(",")[0].match(/0/g)||[]).length,u?(e._.includes(u,"[")?(u=(u=u.replace("]","")).split("["),y=e._.toFixed(t,u[0].length+u[1].length,n,u[1].length)):y=e._.toFixed(t,u.length,n),l=y.split(".")[0],y=e._.includes(y,".")?h.delimiters.decimal+y.split(".")[1]:"",m&&0===Number(y.slice(1))&&(y="")):l=e._.toFixed(t,0,n),v&&!a&&Number(l)>=1e3&&v!==h.abbreviations.trillion)switch(l=String(Number(l)/1e3),v){case h.abbreviations.thousand:v=h.abbreviations.million;break;case h.abbreviations.million:v=h.abbreviations.billion;break;case h.abbreviations.billion:v=h.abbreviations.trillion}if(e._.includes(l,"-")&&(l=l.slice(1),g=!0),l.length<i)for(var E=i-l.length;E>0;E--)l="0"+l;return f>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h.delimiters.thousands)),0===r.indexOf(".")&&(l=""),d=l+y+(v||""),p?d=(p&&g?"(":"")+d+(p&&g?")":""):c>=0?d=0===c?(g?"-":"+")+d:d+(g?"-":"+"):g&&(d="-"+d),d},stringToNumber:function(e){var t,r,n,i=o[l.currentLocale],a=e,s={thousand:3,million:6,billion:9,trillion:12};if(l.zeroFormat&&e===l.zeroFormat)r=0;else if(l.nullFormat&&e===l.nullFormat||!e.replace(/[^0-9]+/g,"").length)r=null;else{for(t in r=1,"."!==i.delimiters.decimal&&(e=e.replace(/\./g,"").replace(i.delimiters.decimal,".")),s)if(n=new RegExp("[^a-zA-Z]"+i.abbreviations[t]+"(?:\\)|(\\"+i.currency.symbol+")?(?:\\))?)?$"),a.match(n)){r*=Math.pow(10,s[t]);break}r*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,e=e.replace(/[^0-9\.]+/g,""),r*=Number(e)}return r},isNaN:function(e){return"number"==typeof e&&isNaN(e)},includes:function(e,t){return-1!==e.indexOf(t)},insert:function(e,t,r){return e.slice(0,r)+t+e.slice(r)},reduce:function(e,t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var r,n=Object(e),i=n.length>>>0,a=0;if(3===arguments.length)r=arguments[2];else{for(;a<i&&!(a in n);)a++;if(a>=i)throw new TypeError("Reduce of empty array with no initial value");r=n[a++]}for(;a<i;a++)a in n&&(r=t(r,n[a],a,n));return r},multiplier:function(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,r){var n=t.multiplier(r);return e>n?e:n}),1)},toFixed:function(e,t,r,n){var i,a,o,s,l=e.toString().split("."),u=t-(n||0);return i=2===l.length?Math.min(Math.max(l[1].length,u),t):u,o=Math.pow(10,i),s=(r(e+"e+"+i)/o).toFixed(i),n>t-i&&(a=new RegExp("\\.?0{1,"+(n-(t-i))+"}$"),s=s.replace(a,"")),s}},e.options=l,e.formats=a,e.locales=o,e.locale=function(e){return e&&(l.currentLocale=e.toLowerCase()),l.currentLocale},e.localeData=function(e){if(!e)return o[l.currentLocale];if(e=e.toLowerCase(),!o[e])throw new Error("Unknown locale : "+e);return o[e]},e.reset=function(){for(var e in s)l[e]=s[e]},e.zeroFormat=function(e){l.zeroFormat="string"==typeof e?e:null},e.nullFormat=function(e){l.nullFormat="string"==typeof e?e:null},e.defaultFormat=function(e){l.defaultFormat="string"==typeof e?e:"0.0"},e.register=function(e,t,r){if(t=t.toLowerCase(),this[e+"s"][t])throw new TypeError(t+" "+e+" already registered.");return this[e+"s"][t]=r,r},e.validate=function(t,r){var n,i,a,o,s,l,u,c;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{u=e.localeData(r)}catch(t){u=e.localeData(e.locale())}return a=u.currency.symbol,s=u.abbreviations,n=u.delimiters.decimal,i="."===u.delimiters.thousands?"\\.":u.delimiters.thousands,!(null!==(c=t.match(/^[^\d]+/))&&(t=t.substr(1),c[0]!==a)||null!==(c=t.match(/[^\d]+$/))&&(t=t.slice(0,-1),c[0]!==s.thousand&&c[0]!==s.million&&c[0]!==s.billion&&c[0]!==s.trillion)||(l=new RegExp(i+"{2}"),t.match(/[^\d.,]/g)||(o=t.split(n)).length>2||(o.length<2?!o[0].match(/^\d+.*\d$/)||o[0].match(l):1===o[0].length?!o[0].match(/^\d+$/)||o[0].match(l)||!o[1].match(/^\d+$/):!o[0].match(/^\d+.*\d$/)||o[0].match(l)||!o[1].match(/^\d+$/))))},e.fn=u.prototype={clone:function(){return e(this)},format:function(t,r){var n,i,o,s=this._value,u=t||l.defaultFormat;if(r=r||Math.round,0===s&&null!==l.zeroFormat)i=l.zeroFormat;else if(null===s&&null!==l.nullFormat)i=l.nullFormat;else{for(n in a)if(u.match(a[n].regexps.format)){o=a[n].format;break}i=(o=o||e._.numberToFormat)(s,u,r)}return i},value:function(){return this._value},input:function(){return this._input},set:function(e){return this._value=Number(e),this},add:function(e){var r=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([this._value,e],(function(e,t,n,i){return e+Math.round(r*t)}),0)/r,this},subtract:function(e){var r=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([e],(function(e,t,n,i){return e-Math.round(r*t)}),Math.round(this._value*r))/r,this},multiply:function(e){return this._value=t.reduce([this._value,e],(function(e,r,n,i){var a=t.correctionFactor(e,r);return Math.round(e*a)*Math.round(r*a)/Math.round(a*a)}),1),this},divide:function(e){return this._value=t.reduce([this._value,e],(function(e,r,n,i){var a=t.correctionFactor(e,r);return Math.round(e*a)/Math.round(r*a)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(t,r,n){var i,a=e._.includes(r," BPS")?" ":"";return t*=1e4,r=r.replace(/\s?BPS/,""),i=e._.numberToFormat(t,r,n),e._.includes(i,")")?((i=i.split("")).splice(-1,0,a+"BPS"),i=i.join("")):i=i+a+"BPS",i},unformat:function(t){return+(1e-4*e._.stringToNumber(t)).toFixed(15)}}),n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},i="("+(i=(r={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(n.suffixes.filter((function(e){return r.suffixes.indexOf(e)<0}))).join("|")).replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(i)},format:function(t,i,a){var o,s,l,u=e._.includes(i,"ib")?n:r,c=e._.includes(i," b")||e._.includes(i," ib")?" ":"";for(i=i.replace(/\s?i?b/,""),o=0;o<=u.suffixes.length;o++)if(s=Math.pow(u.base,o),l=Math.pow(u.base,o+1),null===t||0===t||t>=s&&t<l){c+=u.suffixes[o],s>0&&(t/=s);break}return e._.numberToFormat(t,i,a)+c},unformat:function(t){var i,a,o=e._.stringToNumber(t);if(o){for(i=r.suffixes.length-1;i>=0;i--){if(e._.includes(t,r.suffixes[i])){a=Math.pow(r.base,i);break}if(e._.includes(t,n.suffixes[i])){a=Math.pow(n.base,i);break}}o*=a||1}return o}}),e.register("format","currency",{regexps:{format:/(\$)/},format:function(t,r,n){var i,a,o=e.locales[e.options.currentLocale],s={before:r.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:r.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(r=r.replace(/\s?\$\s?/,""),i=e._.numberToFormat(t,r,n),t>=0?(s.before=s.before.replace(/[\-\(]/,""),s.after=s.after.replace(/[\-\)]/,"")):t<0&&!e._.includes(s.before,"-")&&!e._.includes(s.before,"(")&&(s.before="-"+s.before),a=0;a<s.before.length;a++)switch(s.before[a]){case"$":i=e._.insert(i,o.currency.symbol,a);break;case" ":i=e._.insert(i," ",a+o.currency.symbol.length-1)}for(a=s.after.length-1;a>=0;a--)switch(s.after[a]){case"$":i=a===s.after.length-1?i+o.currency.symbol:e._.insert(i,o.currency.symbol,-(s.after.length-(1+a)));break;case" ":i=a===s.after.length-1?i+" ":e._.insert(i," ",-(s.after.length-(1+a)+o.currency.symbol.length-1))}return i}}),e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(t,r,n){var i=("number"!=typeof t||e._.isNaN(t)?"0e+0":t.toExponential()).split("e");return r=r.replace(/e[\+|\-]{1}0/,""),e._.numberToFormat(Number(i[0]),r,n)+"e"+i[1]},unformat:function(t){var r=e._.includes(t,"e+")?t.split("e+"):t.split("e-"),n=Number(r[0]),i=Number(r[1]);return i=e._.includes(t,"e-")?i*=-1:i,e._.reduce([n,Math.pow(10,i)],(function(t,r,n,i){var a=e._.correctionFactor(t,r);return t*a*(r*a)/(a*a)}),1)}}),e.register("format","ordinal",{regexps:{format:/(o)/},format:function(t,r,n){var i=e.locales[e.options.currentLocale],a=e._.includes(r," o")?" ":"";return r=r.replace(/\s?o/,""),a+=i.ordinal(t),e._.numberToFormat(t,r,n)+a}}),e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(t,r,n){var i,a=e._.includes(r," %")?" ":"";return e.options.scalePercentBy100&&(t*=100),r=r.replace(/\s?\%/,""),i=e._.numberToFormat(t,r,n),e._.includes(i,")")?((i=i.split("")).splice(-1,0,a+"%"),i=i.join("")):i=i+a+"%",i},unformat:function(t){var r=e._.stringToNumber(t);return e.options.scalePercentBy100?.01*r:r}}),e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(e,t,r){var n=Math.floor(e/60/60),i=Math.floor((e-60*n*60)/60),a=Math.round(e-60*n*60-60*i);return n+":"+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)},unformat:function(e){var t=e.split(":"),r=0;return 3===t.length?(r+=60*Number(t[0])*60,r+=60*Number(t[1]),r+=Number(t[2])):2===t.length&&(r+=60*Number(t[0]),r+=Number(t[1])),Number(r)}}),e})?n.call(t,r,t,e):n)||(e.exports=i)},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,t&&t.set(e,r);return r}(r(11)),o=(i=r(57))&&i.__esModule?i:{default:i};function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var r=!1,n=arguments[t],i=0;i<e.length&&!(r=e[i]===n);++i);r||e.push(n)}return e},t.FLATTEN=a.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){try{for(var r=t.split("."),n=e,i=0;i<r.length;++i){var a=r[i];if("]"===a[a.length-1]){var o=a.indexOf("["),s=a.substring(o+1,a.length-1);n=n[a.substring(0,o)][s]}else n=n[a]}return n}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){var e=a.flatten(arguments);return e.filter((function(e){return"number"==typeof e}))},t.NUMERAL=function(e,t){return(0,o.default)(e).format(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawValueParser=t.Str2NumberParser=void 0;var n=r(3),i=r(2);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var l=function(){function e(t){a(this,e),this.toParseStr=t}return s(e,[{key:"getIntPattern",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return console.assert(Number.isInteger(t)),e=t>=0?"^0{0,".concat(t,"}[1-9]\\d*$"):n.ALL_DIGIT_PATTERN_STR,new RegExp(e)}},{key:"isIntWithCommaPattern",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toParseStr;return n.INT_WITH_COMMA_PATTERN.test(e)}},{key:"isFloatWithCommaPattern",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toParseStr;return n.FLOAT_WITH_COMMA_PATTERN.test(e)}},{key:"isIntPattern",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toParseStr;return this.getIntPattern(e).test(t)}},{key:"isDecimalPart",value:function(e){return""!==e&&this.isIntPattern(-1,e)}},{key:"isFloatPattern",value:function(e){return n.CLEAN_FLOAT_PATTERN.test(e)}},{key:"parseAllDigitStr2Int",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toParseStr;return"0"===t?0:this.isIntWithCommaPattern(t)?parseInt(t.replace(",","")):this.isIntPattern(e)?parseInt(t):i.PARSE_FAIL_OBJ}},{key:"parseScientificNotion2Float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toParseStr,t=e.split(n.E_PATTERN);if(2!==t.length)return i.PARSE_FAIL_OBJ;if(this.isFloatWithCommaPattern(t[0]))e=e.replace(/,/g,"");else if(!1===this.isFloatPattern(t[0]))return i.PARSE_FAIL_OBJ;var r=t[1];return["+","-"].indexOf(r[0])>-1&&(r=r.slice(1)),!1===this.isIntPattern(-1,r)?i.PARSE_FAIL_OBJ:parseFloat(e)}},{key:"parseStr2Float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toParseStr,r=t.split(".");if(r.length>2)return i.PARSE_FAIL_OBJ;if(this.isFloatWithCommaPattern(r[0]))r[0]=r[0].replace(/,/g,"");else if(!1===this.isIntPattern(e,r[0]))return i.PARSE_FAIL_OBJ;return 2===r.length&&!1===this.isDecimalPart(r[1])?i.PARSE_FAIL_OBJ:parseFloat(t)}},{key:"easyParse2Number",value:function(){var e=this.parseScientificNotion2Float();return e.msg!==i.PARSE_FAIL?e:(e=this.parseAllDigitStr2Int()).msg!==i.PARSE_FAIL?e:e=this.parseStr2Float()}}]),e}();t.Str2NumberParser=l;var u=function(){function e(t){a(this,e),this.toParseStr=t.trim()}return s(e,[{key:"parse2String",value:function(){var e=this.toParseStr.slice(1,-1).replace('""','"');return e.includes('"')?i.PARSE_FAIL:e}},{key:"parse2NumberOrString",value:function(){return'"'===this.toParseStr[0]&&'"'===this.toParseStr[this.toParseStr.length-1]?this.parse2String:new l(this.toParseStr).easyParse2Number()}}]),e}();t.RawValueParser=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TwoArgOperatorColl=void 0;var n=r(2),i=r(101);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operatorObj=i.OPERATOR_OBJ,this.operatorFunOBj={"+":i.opAdd,"-":i.opSubtract,"*":i.opMultiply,"/":i.opDivide,"^":i.opPower,"&":i.opJoinString,"<":i.opIsLessThan,"=":i.opIsEqual,">":i.opIsGreaterThan,"<=":i.opIsLessOrEqual,">=":i.opIsGreaterOrEqual,"<>":i.opIsNotEqual}}var t,r,o;return t=e,(r=[{key:"isTwoArgOperator",value:function(e){return Object.values(this.operatorObj).includes(e)}},{key:"getFunc",value:function(e){return!1===this.isTwoArgOperator(e)?new Error(n.ERROR_SYNTAX):this.operatorFunOBj[e]}}])&&a(t.prototype,r),o&&a(t,o),e}();t.TwoArgOperatorColl=o},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.COMPLEX=function(e,t,r){if(e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),"i"!==(r=(r=void 0===r?"i":r).toLowerCase())&&"j"!==r)return Error(a.ERROR_VALUE);if(0===e&&0===t)return 0;if(0===e)return 1===t?r:t.toString()+r;if(0===t)return e.toString();var n=t>0?"+":"";return e.toString()+n+(1===t?r:t.toString()+r)},t.CONVER=function(e,t,r){for(var n,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},l=null,u=null,c=t.toLowerCase(),f=r.toLowerCase(),d=1,h=1,p=0;p<i.length;p++)n=null===i[p][2]?[]:i[p][2],(i[p][1].toLowerCase()===c||n.indexOf(t)>=0)&&(l=i[p]),(i[p][1].toLowerCase()===f||n.indexOf(r)>=0)&&(u=i[p]);if(null===l){var m=o[t.substring(0,2)],v=s[t.substring(0,1)];"da"===t.substring(0,2)&&(v=["dekao",10,"da"]),m?(d=m[2],c=t.substring(2)):v&&(d=v[1],c=t.substring(v[2].length));for(var y=0;y<i.length;y++)n=null===i[y][2]?[]:i[y][2],(i[y][1]===c||n.indexOf(c)>=0)&&(l=i[y])}if(null===u){var g=o[r.substring(0,2)],E=s[r.substring(0,1)];"da"===r.substring(0,2)&&(E=["dekao",10,"da"]),g?(h=g[2],f=r.substring(2)):E&&(h=E[1],f=r.substring(E[2].length));for(var b=0;b<i.length;b++)n=null===i[b][2]?[]:i[b][2],(i[b][1]===f||n.indexOf(f)>=0)&&(u=i[b])}if(null===l||null===u)return Error(a.ERROR_NA);if(l[3]!==u[3])return"F"==t&&"C"==r?(e-32)/1.8:"C"==t&&"F"==r?1.8*e+32:Error(a.ERROR_NA);return e*l[6]*d/(u[6]*h)},t.DEC2BIN=function(e,t){if((e=(0,c.parseNumber)(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return Error(a.ERROR_NUM);if(e<0)return"1"+s.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var r=parseInt(e,10).toString(2);return void 0===t?r:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=r.length?s.REPT("0",t-r.length)+r:Error(a.ERROR_NUM)},t.DEC2HEX=function(e,t){if((e=(0,c.parseNumber)(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return Error(a.ERROR_NUM);if(e<0)return(1099511627776+e).toString(16);var r=parseInt(e,10).toString(16);return void 0===t?r:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=r.length?s.REPT("0",t-r.length)+r:Error(a.ERROR_NUM)},t.DEC2OCT=function(e,t){if((e=(0,c.parseNumber)(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return Error(a.ERROR_NUM);if(e<0)return(1073741824+e).toString(8);var r=parseInt(e,10).toString(8);return void 0===t?r:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=r.length?s.REPT("0",t-r.length)+r:Error(a.ERROR_NUM)},t.DELTA=function(e,t){if(t=void 0===t?0:t,e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),(0,l.anyIsError)(e,t))return Error(a.ERROR_VALUE);return e===t?1:0},t.ERF=function(e,t){if(e=(0,c.parseNumber)(e),(0,l.anyIsError)(e,t))return Error(a.ERROR_VALUE);return void 0===t?o.jStat.erf(e):o.jStat.erf(t)-o.jStat.erf(e)},t.ERFC=function(e){if(isNaN(e))return Error(a.ERROR_VALUE);return o.jStat.erfc(e)},t.GESTEP=function(e,t){if(t=t||0,e=(0,c.parseNumber)(e),(0,l.anyIsError)(t,e))return e;return e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return Error(a.ERROR_NUM);var r=10===e.length&&"f"===e.substring(0,1).toLowerCase(),n=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(n<-512||n>511)return Error(a.ERROR_NUM);if(t<0)return Error(a.ERROR_NUM);if(r)return"1"+s.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=n.toString(2);return void 0===t?i:isNaN(t)?Error(a.ERROR_VALUE):(t=Math.floor(t))>=i.length?s.REPT("0",t-i.length)+i:Error(a.ERROR_NUM)},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return Error(a.ERROR_NUM);var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return Error(a.ERROR_NUM);var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return Error(a.ERROR_NUM);if(t<0)return Error(a.ERROR_NUM);if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);var n=r.toString(8);return void 0===t?n:isNaN(t)?Error(a.ERROR_VALUE):(t=Math.floor(t))>=n.length?s.REPT("0",t-n.length)+n:Error(a.ERROR_NUM)},t.IMABS=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);return Math.sqrt(Math.pow(r,2)+Math.pow(n,2))},t.IMAGINARY=function(e){if(void 0===(e=C(e))||!0===e||!1===e)return Error(a.ERROR_VALUE);if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1));0===r&&(r=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),i="i"===n||"j"===n;return t>=0||r>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?Error(a.ERROR_NUM):Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?Error(a.ERROR_NUM):-Number(e.substring(r+1,e.length-1)):Error(a.ERROR_NUM):i?isNaN(e.substring(0,e.length-1))?Error(a.ERROR_NUM):e.substring(0,e.length-1):isNaN(e)?Error(a.ERROR_NUM):0},t.IMARGUMENT=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);if(0===r&&0===n)return a.errorObj.ERROR_DIV0;if(0===r&&n>0)return Math.PI/2;if(0===r&&n<0)return-Math.PI/2;if(0===n&&r>0)return 0;if(0===n&&r<0)return-Math.PI;return r>0?Math.atan(n/r):r<0&&n>=0?Math.atan(n/r)+Math.PI:Math.atan(n/r)-Math.PI},t.IMCONJUGATE=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",0!==n?t.COMPLEX(r,-n,i):e},t.IMCOS=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(r)*(Math.exp(n)-Math.exp(-n))/2,i)},t.IMCOSH=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(n)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(n)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMCOT=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);return t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,r){var n=t.IMREAL(e),i=t.IMAGINARY(e),o=t.IMREAL(r),s=t.IMAGINARY(r);if((0,l.anyIsError)(n,i,o,s))return Error(a.ERROR_VALUE);var u=e.substring(e.length-1),c=r.substring(r.length-1),f="i";"j"===u?f="j":"j"===c&&(f="j");if(0===o&&0===s)return Error(a.ERROR_NUM);var d=o*o+s*s;return t.COMPLEX((n*o+i*s)/d,(i*o-n*s)/d,f)},t.IMEXP=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var o=Math.exp(r);return t.COMPLEX(o*Math.cos(n),o*Math.sin(n),i)},t.IMLN=function(e){var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+n*n)),Math.atan(n/r),i)},t.IMLOG10=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+n*n))/Math.log(10),Math.atan(n/r)/Math.log(10),i)},t.IMLOG2=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+n*n))/Math.log(2),Math.atan(n/r)/Math.log(2),i)},t.IMPOWER=function(e,r){e=C(e),r=(0,c.parseNumber)(r);var n=t.IMREAL(e),i=t.IMAGINARY(e);if((0,l.anyIsError)(r,n,i))return Error(a.ERROR_VALUE);var o=e.substring(e.length-1);o="i"===o||"j"===o?o:"i";var s=Math.pow(t.IMABS(e),r),u=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(r*u),s*Math.sin(r*u),o)},t.IMPRODUCT=function(){for(var e=arguments[0],r=1;r<arguments.length;r++){var n=t.IMREAL(e),i=t.IMAGINARY(e),o=t.IMREAL(arguments[r]),s=t.IMAGINARY(arguments[r]);if((0,l.anyIsError)(n,i,o,s))return Error(a.ERROR_VALUE);e=t.COMPLEX(n*o-i*s,n*s+i*o)}return e},t.IMREAL=function(e){if(void 0===(e=C(e))||!0===e||!1===e)return Error(a.ERROR_VALUE);if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1));0===r&&(r=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),i="i"===n||"j"===n;return t>=0||r>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?Error(a.ERROR_NUM):Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?Error(a.ERROR_NUM):Number(e.substring(0,r)):Error(a.ERROR_NUM):i?isNaN(e.substring(0,e.length-1))?Error(a.ERROR_NUM):0:isNaN(e)?Error(a.ERROR_NUM):e},t.IMSEC=function(e){if(!0===(e=C(e))||!1===e)return Error(a.ERROR_VALUE);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);return t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);return t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.sin(r)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(r)*(Math.exp(n)-Math.exp(-n))/2,i)},t.IMSINH=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(n)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(n)*(Math.exp(r)+Math.exp(-r))/2,i)},t.IMSQRT=function(e){e=C(e);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var o=Math.sqrt(t.IMABS(e)),s=t.IMARGUMENT(e);return t.COMPLEX(o*Math.cos(s/2),o*Math.sin(s/2),i)},t.IMCSC=function(e){if(!0===(e=C(e))||!1===e)return Error(a.ERROR_VALUE);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_NUM);return t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(!0===(e=C(e))||!1===e)return Error(a.ERROR_VALUE);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_NUM);return t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,r){e=C(e),r=C(r);var n=t.IMREAL(e),i=t.IMAGINARY(e),o=t.IMREAL(r),s=t.IMAGINARY(r);if((0,l.anyIsError)(n,i,o,s))return Error(a.ERROR_VALUE);var u=e.substring(e.length-1),c=r.substring(r.length-1),f="i";"j"===u?f="j":"j"===c&&(f="j");return t.COMPLEX(n-o,i-s,f)},t.IMSUM=function(e){e=C(e);for(var r=l.flatten(arguments),n=r[0],i=1;i<r.length;i++){var o=t.IMREAL(n),s=t.IMAGINARY(n),u=t.IMREAL(r[i]),c=t.IMAGINARY(r[i]);if((0,l.anyIsError)(o,s,u,c))return Error(a.ERROR_VALUE);n=t.COMPLEX(o+u,s+c)}return n},t.IMTAN=function(e){if(!0===(e=C(e))||!1===e)return Error(a.ERROR_VALUE);var r=t.IMREAL(e),n=t.IMAGINARY(e);if((0,l.anyIsError)(r,n))return Error(a.ERROR_VALUE);return t.IMDIV(t.IMSIN(e),t.IMCOS(e))},t.BITXOR=t.BITRSHIFT=t.BITOR=t.BITLSHIFT=t.BITAND=t.BIN2OCT=t.BIN2HEX=t.BIN2DEC=t.BESSELY=t.BESSELK=t.BESSELJ=t.BESSELI=void 0;var i,a=r(2),o=r(37),s=h(r(36)),l=h(r(11)),u=(i=r(102))&&i.__esModule?i:{default:i},c=r(17),f=r(15);function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var p=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),u.default.besseli(e,t)}));t.BESSELI=p;var m=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),u.default.besselj(e,t)}));t.BESSELJ=m;var v=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),u.default.besselk(e,t)}));t.BESSELK=v;var y=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),u.default.bessely(e,t)}));t.BESSELY=y;var g=new f.OnlyNumberExpFunction((function(e){var t=parseInt(e,2),r=e.toString();return r.length>10?Error(a.ERROR_NUM):10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:t}));t.BIN2DEC=g;var E=new f.OnlyNumberExpFunction((function(e,t){var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var n=parseInt(e,2).toString(16);return void 0===t?n:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=n.length?s.REPT("0",t-n.length)+n:Error(a.ERROR_NUM)}));t.BIN2HEX=E;var b=new f.OnlyNumberExpFunction((function(e,t){var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var n=parseInt(e,2).toString(8);return void 0===t?n:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=n.length?s.REPT("0",t-n.length)+n:Error(a.ERROR_NUM)}));t.BIN2OCT=b;var x=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),e<0||t<0?Error(a.ERROR_NUM):Math.floor(e)!==e||Math.floor(t)!==t?Error(a.ERROR_NUM):e>0xffffffffffff||t>0xffffffffffff?Error(a.ERROR_NUM):e&t}));t.BITAND=x;var A=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),e<0?Error(a.ERROR_NUM):Math.floor(e)!==e?Error(a.ERROR_NUM):e>0xffffffffffff?Error(a.ERROR_NUM):Math.abs(t)>53?Error(a.ERROR_NUM):t>=0?e<<t:e>>-t}));t.BITLSHIFT=A;var S=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),e<0||t<0?Error(a.ERROR_NUM):Math.floor(e)!==e||Math.floor(t)!==t?Error(a.ERROR_NUM):e>0xffffffffffff||t>0xffffffffffff?Error(a.ERROR_NUM):e|t}));t.BITOR=S;var w=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),e<0?Error(a.ERROR_NUM):Math.floor(e)!==e?Error(a.ERROR_NUM):e>0xffffffffffff?Error(a.ERROR_NUM):Math.abs(t)>53?Error(a.ERROR_NUM):t>=0?e>>t:e<<-t}));t.BITRSHIFT=w;var R=new f.OnlyNumberExpFunction((function(e,t){return e=(0,c.parseNumber)(e),t=(0,c.parseNumber)(t),e<0||t<0?Error(a.ERROR_NUM):Math.floor(e)!==e||Math.floor(t)!==t?Error(a.ERROR_NUM):e>0xffffffffffff||t>0xffffffffffff?Error(a.ERROR_NUM):e^t}));function C(e){return e=(e=e.toString()).replace("I","i").replace("J","j")}t.BITXOR=R,t.ERF.PRECISE=function(e){return isNaN(e)?Error(a.ERROR_VALUE):window.jsSpreadsheet.AllFormulas.ERF(e)},t.ERFC.PRECISE=function(e){return isNaN(e)?Error(a.ERROR_VALUE):window.jsSpreadsheet.AllFormulas.ERFC(e)},t.ROWS=function(e){return"string"==typeof e&&(e=l.strToMatrix(e)),e instanceof Array?0===e.length?0:o.jStat.rows(e):Error(a.ERROR_VALUE)},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return Error(a.ERROR_NUM);var r=10===e.length&&"7"===e.substring(0,1),n=r?parseInt(e,8)-1073741824:parseInt(e,8);if(r)return"1"+s.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=n.toString(2);return i.length>=10?i.slice(i.length-10,i.length):void 0===t?i:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=i.length?s.REPT("0",t-i.length)+i:Error(a.ERROR_NUM)},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return Error(a.ERROR_NUM);var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return Error(a.ERROR_NUM);var r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);var n=r.toString(16);return void 0===t?n:isNaN(t)?Error(a.ERROR_VALUE):t<0?Error(a.ERROR_NUM):(t=Math.floor(t))>=n.length?s.REPT("0",t-n.length)+n:Error(a.ERROR_NUM)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSanitizedSheetName=function(e){var t=e.match(/^'(.*)'$/);return t?t[1]:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberParser=t.MoneyParser=t.DateTimeParser=t.BoolParser=t.ForceString=void 0;var n=r(3),i=r(2),a=r(59);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}var u=function(){function e(t,r){o(this,e),this.strToParse=r,this.calcCell=t}return l(e,[{key:"parseString",value:function(){return this.strToParse.startsWith(n.FORCE_STR_MARK)?this.strToParse.slice(1):i.PARSE_FAIL_OBJ}}]),e}();t.ForceString=u;var c=function(){function e(t,r){o(this,e),this.strToParse=r,this.calcCell=t}return l(e,[{key:"parseString",value:function(){var e=this.strToParse.toUpperCase();return"TRUE"===e||"FALSE"!==e&&i.PARSE_FAIL_OBJ}}]),e}();t.BoolParser=c;var f=function(){function e(t,r){o(this,e),this.strToParse=r,this.calcCell=t}return l(e,[{key:"convertStrToDate",value:function(){var e,t=this.strToParse.indexOf(n.MARK_OBJ.colon);if(t>0){var r=this.strToParse.slice(0,t).lastIndexOf(n.MARK_OBJ.space);if(r>0){if((e=this.convertDateStrToDate(this.strToParse.slice(0,r))).msg===i.PARSE_FAIL)return i.PARSE_FAIL_OBJ;var a=this.dealTimeString(e.toLocaleDateString(),this.strToParse.slice(r+1));return a.msg===i.PARSE_FAIL?i.PARSE_FAIL_OBJ:a}var o=this.dealTimeString(n.d18991230STR,this.strToParse.slice(r+1));return o.msg===i.PARSE_FAIL?i.PARSE_FAIL_OBJ:o}return(e=this.convertDateStrToDate(this.strToParse.slice(0,void 0))).msg===i.PARSE_FAIL?i.PARSE_FAIL_OBJ:e}},{key:"isValidTime",value:function(e){return/^\d+:\d+(:\d+(.\d+)?)?$/.test(e)}},{key:"isSimpleForm",value:function(e){return/^\d+[-/]\d+([-/]\d+)?$/.test(e)}},{key:"isNianYueRi",value:function(e){return/^\d+年\d+月(\d+日)?$/.test(e)}},{key:"yearStr2Int",value:function(e){var t=parseInt(e);return t>=100&&t<1900||t>=1e4?i.PARSE_FAIL_OBJ:t}},{key:"monthStr2Int",value:function(e){var t=parseInt(e);return t>=1&&t<=12?t:i.PARSE_FAIL_OBJ}},{key:"convertDateStrToDate",value:function(e){var t,r=e.replace(/\s+/g,""),n=0;if(this.isSimpleForm(r))t=r.split(/[-/]/);else{if(!1===this.isNianYueRi(r))return i.PARSE_FAIL_OBJ;t=r.split(/[年月日]/),n=1}var a=this.yearStr2Int(t[0]);if(a.msg===i.PARSE_FAIL)return i.PARSE_FAIL_OBJ;var o,s=this.monthStr2Int(t[1]);if(s.msg===i.PARSE_FAIL)return i.PARSE_FAIL_OBJ;o=t.length-n==3?parseInt(t[2]):1;var l=new Date(a,s-1,o);return isNaN(l)?i.PARSE_FAIL_OBJ:l}},{key:"dealTimeString",value:function(e,t){var r=t.replace(/\s+/g,"");if(!1===this.isValidTime(r))return i.PARSE_FAIL_OBJ;var n=new Date(e+" "+t);return isNaN(n)?i.PARSE_FAIL_OBJ:n}},{key:"parseString",value:function(){return this.convertStrToDate()}}]),e}();t.DateTimeParser=f;var d=function(){function e(t,r){o(this,e),this.strToParse=r,this.calcCell=t}return l(e,[{key:"isStartWithMoneyMark",value:function(){return this.strToParse.startsWith(n.MONEY_UNIT_OBJ.dollar)}},{key:"getStrToParseAsNum",value:function(){return this.strToParse.slice(1).trim()}},{key:"parseString",value:function(){if(!1===this.isStartWithMoneyMark())return i.PARSE_FAIL_OBJ;var e=this.getStrToParseAsNum();return 0===e.length?i.PARSE_FAIL_OBJ:new a.Str2NumberParser(e).easyParse2Number()}}]),e}();t.MoneyParser=d;var h=function(){function e(t,r){o(this,e),this.strToParse=r,this.calcCell=t}return l(e,[{key:"parseString",value:function(){var e=this.strToParse.trim(),t=1;e.endsWith("%")&&(e=e.slice(0,-1).trim(),t=.01);var r=new a.Str2NumberParser(e).easyParse2Number();return r.msg!==i.PARSE_FAIL?r*t:i.PARSE_FAIL_OBJ}}]),e}();t.NumberParser=h},function(e,t,r){e.exports=function(){"use strict";var e="millisecond",t="second",r="minute",n="hour",i="day",a="week",o="month",s="quarter",l="year",u=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},d={s:f,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+f(n,2,"0")+":"+f(i,2,"0")},m:function(e,t){var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,o),i=t-n<0,a=e.clone().add(r+(i?-1:1),o);return Number(-(r+(t-n)/(i?n-a:a-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return{M:o,y:l,w:a,d:i,h:n,m:r,s:t,ms:e,Q:s}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",m={};m[p]=h;var v=function(e){return e instanceof b},y=function(e,t,r){var n;if(!e)return p;if("string"==typeof e)m[e]&&(n=e),t&&(m[e]=t,n=e);else{var i=e.name;m[i]=e,n=i}return r||(p=n),n},g=function(e,t,r){if(v(e))return e.clone();var n=t?"string"==typeof t?{format:t,pl:r}:t:{};return n.date=e,new b(n)},E=d;E.l=y,E.i=v,E.w=function(e,t){return g(e,{locale:t.$L,utc:t.$u,$offset:t.$offset})};var b=function(){function f(e){this.$L=this.$L||y(e.locale,null,!0),this.parse(e)}var d=f.prototype;return d.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(E.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(u);if(n)return r?new Date(Date.UTC(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)):new Date(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)}return new Date(t)}(e),this.init()},d.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},d.$utils=function(){return E},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(e,t){var r=g(e);return this.startOf(t)<=r&&r<=this.endOf(t)},d.isAfter=function(e,t){return g(e)<this.startOf(t)},d.isBefore=function(e,t){return this.endOf(t)<g(e)},d.$g=function(e,t,r){return E.u(e)?this[t]:this.set(r,e)},d.year=function(e){return this.$g(e,"$y",l)},d.month=function(e){return this.$g(e,"$M",o)},d.day=function(e){return this.$g(e,"$W",i)},d.date=function(e){return this.$g(e,"$D","date")},d.hour=function(e){return this.$g(e,"$H",n)},d.minute=function(e){return this.$g(e,"$m",r)},d.second=function(e){return this.$g(e,"$s",t)},d.millisecond=function(t){return this.$g(t,"$ms",e)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(e,s){var u=this,c=!!E.u(s)||s,f=E.p(e),d=function(e,t){var r=E.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return c?r:r.endOf(i)},h=function(e,t){return E.w(u.toDate()[e].apply(u.toDate(),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},p=this.$W,m=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(f){case l:return c?d(1,0):d(31,11);case o:return c?d(1,m):d(0,m+1);case a:var g=this.$locale().weekStart||0,b=(p<g?p+7:p)-g;return d(c?v-b:v+(6-b),m);case i:case"date":return h(y+"Hours",0);case n:return h(y+"Minutes",1);case r:return h(y+"Seconds",2);case t:return h(y+"Milliseconds",3);default:return this.clone()}},d.endOf=function(e){return this.startOf(e,!1)},d.$set=function(a,s){var u,c=E.p(a),f="set"+(this.$u?"UTC":""),d=(u={},u[i]=f+"Date",u.date=f+"Date",u[o]=f+"Month",u[l]=f+"FullYear",u[n]=f+"Hours",u[r]=f+"Minutes",u[t]=f+"Seconds",u[e]=f+"Milliseconds",u)[c],h=c===i?this.$D+(s-this.$W):s;if(c===o||c===l){var p=this.clone().set("date",1);p.$d[d](h),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).toDate()}else d&&this.$d[d](h);return this.init(),this},d.set=function(e,t){return this.clone().$set(e,t)},d.get=function(e){return this[E.p(e)]()},d.add=function(e,s){var u,c=this;e=Number(e);var f=E.p(s),d=function(t){var r=g(c);return E.w(r.date(r.date()+Math.round(t*e)),c)};if(f===o)return this.set(o,this.$M+e);if(f===l)return this.set(l,this.$y+e);if(f===i)return d(1);if(f===a)return d(7);var h=(u={},u[r]=6e4,u[n]=36e5,u[t]=1e3,u)[f]||1,p=this.$d.getTime()+e*h;return E.w(p,this)},d.subtract=function(e,t){return this.add(-1*e,t)},d.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=E.z(this),i=this.$locale(),a=this.$H,o=this.$m,s=this.$M,l=i.weekdays,u=i.months,f=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].substr(0,a)},d=function(e){return E.s(a%12||12,e,"0")},h=i.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:E.s(s+1,2,"0"),MMM:f(i.monthsShort,s,u,3),MMMM:u[s]||u(this,r),D:this.$D,DD:E.s(this.$D,2,"0"),d:String(this.$W),dd:f(i.weekdaysMin,this.$W,l,2),ddd:f(i.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(a),HH:E.s(a,2,"0"),h:d(1),hh:d(2),a:h(a,o,!0),A:h(a,o,!1),m:String(o),mm:E.s(o,2,"0"),s:String(this.$s),ss:E.s(this.$s,2,"0"),SSS:E.s(this.$ms,3,"0"),Z:n};return r.replace(c,(function(e,t){return t||p[e]||n.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(e,u,c){var f,d=E.p(u),h=g(e),p=6e4*(h.utcOffset()-this.utcOffset()),m=this-h,v=E.m(this,h);return v=(f={},f[l]=v/12,f[o]=v,f[s]=v/3,f[a]=(m-p)/6048e5,f[i]=(m-p)/864e5,f[n]=m/36e5,f[r]=m/6e4,f[t]=m/1e3,f)[d]||m,c?v:E.a(v)},d.daysInMonth=function(){return this.endOf(o).$D},d.$locale=function(){return m[this.$L]},d.locale=function(e,t){if(!e)return this.$L;var r=this.clone();return r.$L=y(e,t,!0),r},d.clone=function(){return E.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},f}();return g.prototype=b.prototype,g.extend=function(e,t){return e(t,b,g),g},g.locale=y,g.isDayjs=v,g.unix=function(e){return g(1e3*e)},g.en=m[p],g.Ls=m,g}()},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(119),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formula=t,this.ast=""}var t,r,a;return t=e,(r=[{key:"preProcess",value:function(){this.formula=this.formula.replace(/=/g,""),this.formula=this.formula.replace(/:/g,"$$$"),this.formula=this.formula.replace(/""""/g,""),this.formula=this.formula.replace(/!/g,""),this.formula=this.formula.replace(/{/g,""),this.formula=this.formula.replace(/}/g,""),this.formula=this.formula.replace(/#/g,""),this.formula=this.formula.replace(/\./g,"a"),this.formula=this.formula.replace(/[0-9][0-9]*/g,"a"),this.formula=this.formula.replace(/\“/g,'"'),this.formula=this.formula.replace(/\（/g,"("),this.formula=this.formula.replace(/\）/g,")"),this.formula=this.formula.replace(/\”/g,'"'),this.formula=this.formula.replace(/\%/g,""),this.formula=this.formula.replace(/\,/g,""),this.formula=this.formula.replace(/\，/g,""),this.formula=this.formula.replace(/"([\s\S]+)"""/g,""),this.formula=this.formula.replace(/""/,"")}},{key:"parse",value:function(){this.preProcess();var e=this.formula;this.ast=i.parse(e)}},{key:"ignoreSpace",value:function(){}}])&&n(t.prototype,r),a&&n(t,a),e}();t.default=a},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,u=[],c=!1,f=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(68)),o=n(r(123));t.default=function(e){var t=e.use(i.default),r=t.namedTypes,n=t.builders,s=t.builtInTypes.number,l=t.builtInTypes.array,u=e.use(a.default),c=e.use(o.default),f=function e(t,r,n){if(!(this instanceof e))throw new Error("NodePath constructor cannot be invoked without 'new'");u.call(this,t,r,n)},d=f.prototype=Object.create(u.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}});function h(e){return r.BinaryExpression.check(e)||r.LogicalExpression.check(e)}Object.defineProperties(d,{node:{get:function(){return Object.defineProperty(this,"node",{configurable:!0,value:this._computeNode()}),this.node}},parent:{get:function(){return Object.defineProperty(this,"parent",{configurable:!0,value:this._computeParent()}),this.parent}},scope:{get:function(){return Object.defineProperty(this,"scope",{configurable:!0,value:this._computeScope()}),this.scope}}}),d.replace=function(){return delete this.node,delete this.parent,delete this.scope,u.prototype.replace.apply(this,arguments)},d.prune=function(){var e=this.parent;return this.replace(),function(e){if(r.VariableDeclaration.check(e.node)){var t=e.get("declarations").value;if(!t||0===t.length)return e.prune()}else if(r.ExpressionStatement.check(e.node)){if(!e.get("expression").value)return e.prune()}else r.IfStatement.check(e.node)&&function(e){var t=e.get("test").value,i=e.get("alternate").value,a=e.get("consequent").value;if(a||i){if(!a&&i){var o=n.unaryExpression("!",t,!0);r.UnaryExpression.check(t)&&"!"===t.operator&&(o=t.argument),e.get("test").replace(o),e.get("consequent").replace(i),e.get("alternate").replace()}}else{var s=n.expressionStatement(t);e.replace(s)}}(e);return e}(e)},d._computeNode=function(){var e=this.value;if(r.Node.check(e))return e;var t=this.parentPath;return t&&t.node||null},d._computeParent=function(){var e=this.value,t=this.parentPath;if(!r.Node.check(e)){for(;t&&!r.Node.check(t.value);)t=t.parentPath;t&&(t=t.parentPath)}for(;t&&!r.Node.check(t.value);)t=t.parentPath;return t||null},d._computeScope=function(){var e=this.value,t=this.parentPath,n=t&&t.scope;return r.Node.check(e)&&c.isEstablishedBy(e)&&(n=new c(this,n)),n||null},d.getValueProperty=function(e){return t.getFieldValue(this.value,e)},d.needsParens=function(e){var t=this.parentPath;if(!t)return!1;var n=this.value;if(!r.Expression.check(n))return!1;if("Identifier"===n.type)return!1;for(;!r.Node.check(t.value);)if(!(t=t.parentPath))return!1;var i=t.value;switch(n.type){case"UnaryExpression":case"SpreadElement":case"SpreadProperty":return"MemberExpression"===i.type&&"object"===this.name&&i.object===n;case"BinaryExpression":case"LogicalExpression":switch(i.type){case"CallExpression":return"callee"===this.name&&i.callee===n;case"UnaryExpression":case"SpreadElement":case"SpreadProperty":return!0;case"MemberExpression":return"object"===this.name&&i.object===n;case"BinaryExpression":case"LogicalExpression":var a=n,o=i.operator,l=p[o],u=a.operator,c=p[u];if(l>c)return!0;if(l===c&&"right"===this.name){if(i.right!==a)throw new Error("Nodes must be equal");return!0}default:return!1}case"SequenceExpression":switch(i.type){case"ForStatement":return!1;case"ExpressionStatement":return"expression"!==this.name;default:return!0}case"YieldExpression":switch(i.type){case"BinaryExpression":case"LogicalExpression":case"UnaryExpression":case"SpreadElement":case"SpreadProperty":case"CallExpression":case"MemberExpression":case"NewExpression":case"ConditionalExpression":case"YieldExpression":return!0;default:return!1}case"Literal":return"MemberExpression"===i.type&&s.check(n.value)&&"object"===this.name&&i.object===n;case"AssignmentExpression":case"ConditionalExpression":switch(i.type){case"UnaryExpression":case"SpreadElement":case"SpreadProperty":case"BinaryExpression":case"LogicalExpression":return!0;case"CallExpression":return"callee"===this.name&&i.callee===n;case"ConditionalExpression":return"test"===this.name&&i.test===n;case"MemberExpression":return"object"===this.name&&i.object===n;default:return!1}default:if("NewExpression"===i.type&&"callee"===this.name&&i.callee===n)return m(n)}return!(!0===e||this.canBeFirstInStatement()||!this.firstInStatement())};var p={};function m(e){return!!r.CallExpression.check(e)||(l.check(e)?e.some(m):!!r.Node.check(e)&&t.someField(e,(function(e,t){return m(t)})))}return[["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"]].forEach((function(e,t){e.forEach((function(e){p[e]=t}))})),d.canBeFirstInStatement=function(){var e=this.node;return!r.FunctionExpression.check(e)&&!r.ObjectExpression.check(e)},d.firstInStatement=function(){return function(e){for(var t,n;e.parent;e=e.parent){if(t=e.node,n=e.parent.node,r.BlockStatement.check(n)&&"body"===e.parent.name&&0===e.name){if(n.body[0]!==t)throw new Error("Nodes must be equal");return!0}if(r.ExpressionStatement.check(n)&&"expression"===e.name){if(n.expression!==t)throw new Error("Nodes must be equal");return!0}if(r.SequenceExpression.check(n)&&"expressions"===e.parent.name&&0===e.name){if(n.expressions[0]!==t)throw new Error("Nodes must be equal")}else if(r.CallExpression.check(n)&&"callee"===e.name){if(n.callee!==t)throw new Error("Nodes must be equal")}else if(r.MemberExpression.check(n)&&"object"===e.name){if(n.object!==t)throw new Error("Nodes must be equal")}else if(r.ConditionalExpression.check(n)&&"test"===e.name){if(n.test!==t)throw new Error("Nodes must be equal")}else if(h(n)&&"left"===e.name){if(n.left!==t)throw new Error("Nodes must be equal")}else{if(!r.UnaryExpression.check(n)||n.prefix||"argument"!==e.name)return!1;if(n.argument!==t)throw new Error("Nodes must be equal")}}return!0}(this)},f},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=Object.prototype.hasOwnProperty;t.default=function(e){var t=e.use(i.default),r=t.builtInTypes.array,n=t.builtInTypes.number,o=function e(t,r,n){if(!(this instanceof e))throw new Error("Path constructor cannot be invoked without 'new'");if(r){if(!(r instanceof e))throw new Error("")}else r=null,n=null;this.value=t,this.parentPath=r,this.name=n,this.__childCache=null},s=o.prototype;function l(e){return e.__childCache||(e.__childCache=Object.create(null))}function u(e,t){var r=l(e),n=e.getValueProperty(t),i=r[t];return a.call(r,t)&&i.value===n||(i=r[t]=new e.constructor(n,e,t)),i}function c(){}function f(e,t,i,o){if(r.assert(e.value),0===t)return c;var s=e.value.length;if(s<1)return c;var u=arguments.length;2===u?(i=0,o=s):3===u?(i=Math.max(i,0),o=s):(i=Math.max(i,0),o=Math.min(o,s)),n.assert(i),n.assert(o);for(var f=Object.create(null),d=l(e),h=i;h<o;++h)if(a.call(e.value,h)){var p=e.get(h);if(p.name!==h)throw new Error("");var m=h+t;p.name=m,f[m]=p,delete d[h]}return delete d.length,function(){for(var t in f){var r=f[t];if(r.name!==+t)throw new Error("");d[t]=r,e.value[t]=r.value}}}function d(e){if(!(e instanceof o))throw new Error("");var t=e.parentPath;if(!t)return e;var n=t.value,i=l(t);if(n[e.name]===e.value)i[e.name]=e;else if(r.check(n)){var a=n.indexOf(e.value);a>=0&&(i[e.name=a]=e)}else n[e.name]=e.value,i[e.name]=e;if(n[e.name]!==e.value)throw new Error("");if(e.parentPath.get(e.name)!==e)throw new Error("");return e}return s.getValueProperty=function(e){return this.value[e]},s.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this,n=e.length,i=0;i<n;++i)r=u(r,e[i]);return r},s.each=function(e,t){var r=[],n=this.value.length,i=0;for(i=0;i<n;++i)a.call(this.value,i)&&(r[i]=this.get(i));for(t=t||this,i=0;i<n;++i)a.call(r,i)&&e.call(t,r[i])},s.map=function(e,t){var r=[];return this.each((function(t){r.push(e.call(this,t))}),t),r},s.filter=function(e,t){var r=[];return this.each((function(t){e.call(this,t)&&r.push(t)}),t),r},s.shift=function(){var e=f(this,-1),t=this.value.shift();return e(),t},s.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=f(this,e.length),n=this.value.unshift.apply(this.value,e);return r(),n},s.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.assert(this.value),delete l(this).length,this.value.push.apply(this.value,e)},s.pop=function(){r.assert(this.value);var e=l(this);return delete e[this.value.length-1],delete e.length,this.value.pop()},s.insertAt=function(e){var t=arguments.length,r=f(this,t-1,e);if(r===c&&t<=1)return this;e=Math.max(e,0);for(var n=1;n<t;++n)this.value[e+n-1]=arguments[n];return r(),this},s.insertBefore=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this.parentPath,n=e.length,i=[this.name],a=0;a<n;++a)i.push(e[a]);return r.insertAt.apply(r,i)},s.insertAfter=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this.parentPath,n=e.length,i=[this.name+1],a=0;a<n;++a)i.push(e[a]);return r.insertAt.apply(r,i)},s.replace=function(e){var t=[],n=this.parentPath.value,i=l(this.parentPath),a=arguments.length;if(d(this),r.check(n)){for(var o=n.length,s=f(this.parentPath,a-1,this.name+1),u=[this.name,1],c=0;c<a;++c)u.push(arguments[c]);var h=n.splice.apply(n,u);if(h[0]!==this.value)throw new Error("");if(n.length!==o-1+a)throw new Error("");if(s(),0===a)delete this.value,delete i[this.name],this.__childCache=null;else{if(n[this.name]!==e)throw new Error("");for(this.value!==e&&(this.value=e,this.__childCache=null),c=0;c<a;++c)t.push(this.parentPath.get(this.name+c));if(t[0]!==this)throw new Error("")}}else if(1===a)this.value!==e&&(this.__childCache=null),this.value=n[this.name]=e,t.push(this);else{if(0!==a)throw new Error("Could not replace path");delete n[this.name],delete this.value,this.__childCache=null}return t},o},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(44)),a=n(r(5)),o=n(r(13));t.default=function(e){e.use(i.default);var t=e.use(a.default),r=t.Type.def,n=t.Type.or,s=e.use(o.default).defaults;r("Function").field("generator",Boolean,s.false).field("expression",Boolean,s.false).field("defaults",[n(r("Expression"),null)],s.emptyArray).field("rest",n(r("Identifier"),null),s.null),r("RestElement").bases("Pattern").build("argument").field("argument",r("Pattern")).field("typeAnnotation",n(r("TypeAnnotation"),r("TSTypeAnnotation"),null),s.null),r("SpreadElementPattern").bases("Pattern").build("argument").field("argument",r("Pattern")),r("FunctionDeclaration").build("id","params","body","generator","expression"),r("FunctionExpression").build("id","params","body","generator","expression"),r("ArrowFunctionExpression").bases("Function","Expression").build("params","body","expression").field("id",null,s.null).field("body",n(r("BlockStatement"),r("Expression"))).field("generator",!1,s.false),r("ForOfStatement").bases("Statement").build("left","right","body").field("left",n(r("VariableDeclaration"),r("Pattern"))).field("right",r("Expression")).field("body",r("Statement")),r("YieldExpression").bases("Expression").build("argument","delegate").field("argument",n(r("Expression"),null)).field("delegate",Boolean,s.false),r("GeneratorExpression").bases("Expression").build("body","blocks","filter").field("body",r("Expression")).field("blocks",[r("ComprehensionBlock")]).field("filter",n(r("Expression"),null)),r("ComprehensionExpression").bases("Expression").build("body","blocks","filter").field("body",r("Expression")).field("blocks",[r("ComprehensionBlock")]).field("filter",n(r("Expression"),null)),r("ComprehensionBlock").bases("Node").build("left","right","each").field("left",r("Pattern")).field("right",r("Expression")).field("each",Boolean),r("Property").field("key",n(r("Literal"),r("Identifier"),r("Expression"))).field("value",n(r("Expression"),r("Pattern"))).field("method",Boolean,s.false).field("shorthand",Boolean,s.false).field("computed",Boolean,s.false),r("ObjectProperty").field("shorthand",Boolean,s.false),r("PropertyPattern").bases("Pattern").build("key","pattern").field("key",n(r("Literal"),r("Identifier"),r("Expression"))).field("pattern",r("Pattern")).field("computed",Boolean,s.false),r("ObjectPattern").bases("Pattern").build("properties").field("properties",[n(r("PropertyPattern"),r("Property"))]),r("ArrayPattern").bases("Pattern").build("elements").field("elements",[n(r("Pattern"),null)]),r("MethodDefinition").bases("Declaration").build("kind","key","value","static").field("kind",n("constructor","method","get","set")).field("key",r("Expression")).field("value",r("Function")).field("computed",Boolean,s.false).field("static",Boolean,s.false),r("SpreadElement").bases("Node").build("argument").field("argument",r("Expression")),r("ArrayExpression").field("elements",[n(r("Expression"),r("SpreadElement"),r("RestElement"),null)]),r("NewExpression").field("arguments",[n(r("Expression"),r("SpreadElement"))]),r("CallExpression").field("arguments",[n(r("Expression"),r("SpreadElement"))]),r("AssignmentPattern").bases("Pattern").build("left","right").field("left",r("Pattern")).field("right",r("Expression"));var l=n(r("MethodDefinition"),r("VariableDeclarator"),r("ClassPropertyDefinition"),r("ClassProperty"));r("ClassProperty").bases("Declaration").build("key").field("key",n(r("Literal"),r("Identifier"),r("Expression"))).field("computed",Boolean,s.false),r("ClassPropertyDefinition").bases("Declaration").build("definition").field("definition",l),r("ClassBody").bases("Declaration").build("body").field("body",[l]),r("ClassDeclaration").bases("Declaration").build("id","body","superClass").field("id",n(r("Identifier"),null)).field("body",r("ClassBody")).field("superClass",n(r("Expression"),null),s.null),r("ClassExpression").bases("Expression").build("id","body","superClass").field("id",n(r("Identifier"),null),s.null).field("body",r("ClassBody")).field("superClass",n(r("Expression"),null),s.null),r("Specifier").bases("Node"),r("ModuleSpecifier").bases("Specifier").field("local",n(r("Identifier"),null),s.null).field("id",n(r("Identifier"),null),s.null).field("name",n(r("Identifier"),null),s.null),r("ImportSpecifier").bases("ModuleSpecifier").build("id","name"),r("ImportNamespaceSpecifier").bases("ModuleSpecifier").build("id"),r("ImportDefaultSpecifier").bases("ModuleSpecifier").build("id"),r("ImportDeclaration").bases("Declaration").build("specifiers","source","importKind").field("specifiers",[n(r("ImportSpecifier"),r("ImportNamespaceSpecifier"),r("ImportDefaultSpecifier"))],s.emptyArray).field("source",r("Literal")).field("importKind",n("value","type"),(function(){return"value"})),r("TaggedTemplateExpression").bases("Expression").build("tag","quasi").field("tag",r("Expression")).field("quasi",r("TemplateLiteral")),r("TemplateLiteral").bases("Expression").build("quasis","expressions").field("quasis",[r("TemplateElement")]).field("expressions",[r("Expression")]),r("TemplateElement").bases("Node").build("value","tail").field("value",{cooked:String,raw:String}).field("tail",Boolean)},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(23)),a=n(r(71)),o=n(r(5)),s=n(r(13));t.default=function(e){e.use(i.default),e.use(a.default);var t=e.use(o.default),r=t.Type.def,n=t.Type.or,l=e.use(s.default).defaults;r("Flow").bases("Node"),r("FlowType").bases("Flow"),r("AnyTypeAnnotation").bases("FlowType").build(),r("EmptyTypeAnnotation").bases("FlowType").build(),r("MixedTypeAnnotation").bases("FlowType").build(),r("VoidTypeAnnotation").bases("FlowType").build(),r("NumberTypeAnnotation").bases("FlowType").build(),r("NumberLiteralTypeAnnotation").bases("FlowType").build("value","raw").field("value",Number).field("raw",String),r("NumericLiteralTypeAnnotation").bases("FlowType").build("value","raw").field("value",Number).field("raw",String),r("StringTypeAnnotation").bases("FlowType").build(),r("StringLiteralTypeAnnotation").bases("FlowType").build("value","raw").field("value",String).field("raw",String),r("BooleanTypeAnnotation").bases("FlowType").build(),r("BooleanLiteralTypeAnnotation").bases("FlowType").build("value","raw").field("value",Boolean).field("raw",String),r("TypeAnnotation").bases("Node").build("typeAnnotation").field("typeAnnotation",r("FlowType")),r("NullableTypeAnnotation").bases("FlowType").build("typeAnnotation").field("typeAnnotation",r("FlowType")),r("NullLiteralTypeAnnotation").bases("FlowType").build(),r("NullTypeAnnotation").bases("FlowType").build(),r("ThisTypeAnnotation").bases("FlowType").build(),r("ExistsTypeAnnotation").bases("FlowType").build(),r("ExistentialTypeParam").bases("FlowType").build(),r("FunctionTypeAnnotation").bases("FlowType").build("params","returnType","rest","typeParameters").field("params",[r("FunctionTypeParam")]).field("returnType",r("FlowType")).field("rest",n(r("FunctionTypeParam"),null)).field("typeParameters",n(r("TypeParameterDeclaration"),null)),r("FunctionTypeParam").bases("Node").build("name","typeAnnotation","optional").field("name",r("Identifier")).field("typeAnnotation",r("FlowType")).field("optional",Boolean),r("ArrayTypeAnnotation").bases("FlowType").build("elementType").field("elementType",r("FlowType")),r("ObjectTypeAnnotation").bases("FlowType").build("properties","indexers","callProperties").field("properties",[n(r("ObjectTypeProperty"),r("ObjectTypeSpreadProperty"))]).field("indexers",[r("ObjectTypeIndexer")],l.emptyArray).field("callProperties",[r("ObjectTypeCallProperty")],l.emptyArray).field("inexact",n(Boolean,void 0),l[void 0]).field("exact",Boolean,l.false).field("internalSlots",[r("ObjectTypeInternalSlot")],l.emptyArray),r("Variance").bases("Node").build("kind").field("kind",n("plus","minus"));var u=n(r("Variance"),"plus","minus",null);r("ObjectTypeProperty").bases("Node").build("key","value","optional").field("key",n(r("Literal"),r("Identifier"))).field("value",r("FlowType")).field("optional",Boolean).field("variance",u,l.null),r("ObjectTypeIndexer").bases("Node").build("id","key","value").field("id",r("Identifier")).field("key",r("FlowType")).field("value",r("FlowType")).field("variance",u,l.null),r("ObjectTypeCallProperty").bases("Node").build("value").field("value",r("FunctionTypeAnnotation")).field("static",Boolean,l.false),r("QualifiedTypeIdentifier").bases("Node").build("qualification","id").field("qualification",n(r("Identifier"),r("QualifiedTypeIdentifier"))).field("id",r("Identifier")),r("GenericTypeAnnotation").bases("FlowType").build("id","typeParameters").field("id",n(r("Identifier"),r("QualifiedTypeIdentifier"))).field("typeParameters",n(r("TypeParameterInstantiation"),null)),r("MemberTypeAnnotation").bases("FlowType").build("object","property").field("object",r("Identifier")).field("property",n(r("MemberTypeAnnotation"),r("GenericTypeAnnotation"))),r("UnionTypeAnnotation").bases("FlowType").build("types").field("types",[r("FlowType")]),r("IntersectionTypeAnnotation").bases("FlowType").build("types").field("types",[r("FlowType")]),r("TypeofTypeAnnotation").bases("FlowType").build("argument").field("argument",r("FlowType")),r("ObjectTypeSpreadProperty").bases("Node").build("argument").field("argument",r("FlowType")),r("ObjectTypeInternalSlot").bases("Node").build("id","value","optional","static","method").field("id",r("Identifier")).field("value",r("FlowType")).field("optional",Boolean).field("static",Boolean).field("method",Boolean),r("TypeParameterDeclaration").bases("Node").build("params").field("params",[r("TypeParameter")]),r("TypeParameterInstantiation").bases("Node").build("params").field("params",[r("FlowType")]),r("TypeParameter").bases("FlowType").build("name","variance","bound").field("name",String).field("variance",u,l.null).field("bound",n(r("TypeAnnotation"),null),l.null),r("ClassProperty").field("variance",u,l.null),r("ClassImplements").bases("Node").build("id").field("id",r("Identifier")).field("superClass",n(r("Expression"),null),l.null).field("typeParameters",n(r("TypeParameterInstantiation"),null),l.null),r("InterfaceTypeAnnotation").bases("FlowType").build("body","extends").field("body",r("ObjectTypeAnnotation")).field("extends",n([r("InterfaceExtends")],null),l.null),r("InterfaceDeclaration").bases("Declaration").build("id","body","extends").field("id",r("Identifier")).field("typeParameters",n(r("TypeParameterDeclaration"),null),l.null).field("body",r("ObjectTypeAnnotation")).field("extends",[r("InterfaceExtends")]),r("DeclareInterface").bases("InterfaceDeclaration").build("id","body","extends"),r("InterfaceExtends").bases("Node").build("id").field("id",r("Identifier")).field("typeParameters",n(r("TypeParameterInstantiation"),null),l.null),r("TypeAlias").bases("Declaration").build("id","typeParameters","right").field("id",r("Identifier")).field("typeParameters",n(r("TypeParameterDeclaration"),null)).field("right",r("FlowType")),r("OpaqueType").bases("Declaration").build("id","typeParameters","impltype","supertype").field("id",r("Identifier")).field("typeParameters",n(r("TypeParameterDeclaration"),null)).field("impltype",r("FlowType")).field("supertype",r("FlowType")),r("DeclareTypeAlias").bases("TypeAlias").build("id","typeParameters","right"),r("DeclareOpaqueType").bases("TypeAlias").build("id","typeParameters","supertype"),r("TypeCastExpression").bases("Expression").build("expression","typeAnnotation").field("expression",r("Expression")).field("typeAnnotation",r("TypeAnnotation")),r("TupleTypeAnnotation").bases("FlowType").build("types").field("types",[r("FlowType")]),r("DeclareVariable").bases("Statement").build("id").field("id",r("Identifier")),r("DeclareFunction").bases("Statement").build("id").field("id",r("Identifier")),r("DeclareClass").bases("InterfaceDeclaration").build("id"),r("DeclareModule").bases("Statement").build("id","body").field("id",n(r("Identifier"),r("Literal"))).field("body",r("BlockStatement")),r("DeclareModuleExports").bases("Statement").build("typeAnnotation").field("typeAnnotation",r("TypeAnnotation")),r("DeclareExportDeclaration").bases("Declaration").build("default","declaration","specifiers","source").field("default",Boolean).field("declaration",n(r("DeclareVariable"),r("DeclareFunction"),r("DeclareClass"),r("FlowType"),null)).field("specifiers",[n(r("ExportSpecifier"),r("ExportBatchSpecifier"))],l.emptyArray).field("source",n(r("Literal"),null),l.null),r("DeclareExportAllDeclaration").bases("Declaration").build("source").field("source",n(r("Literal"),null),l.null),r("FlowPredicate").bases("Flow"),r("InferredPredicate").bases("FlowPredicate").build(),r("DeclaredPredicate").bases("FlowPredicate").build("value").field("value",r("Expression")),r("CallExpression").field("typeArguments",n(null,r("TypeParameterInstantiation")),l.null),r("NewExpression").field("typeArguments",n(null,r("TypeParameterInstantiation")),l.null)},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(13));t.default=function(e){var t=e.use(i.default),r=t.Type.def,n=t.Type.or,o=e.use(a.default).defaults,s=n(r("TypeAnnotation"),r("TSTypeAnnotation"),null),l=n(r("TypeParameterDeclaration"),r("TSTypeParameterDeclaration"),null);r("Identifier").field("typeAnnotation",s,o.null),r("ObjectPattern").field("typeAnnotation",s,o.null),r("Function").field("returnType",s,o.null).field("typeParameters",l,o.null),r("ClassProperty").build("key","value","typeAnnotation","static").field("value",n(r("Expression"),null)).field("static",Boolean,o.false).field("typeAnnotation",s,o.null),["ClassDeclaration","ClassExpression"].forEach((function(e){r(e).field("typeParameters",l,o.null).field("superTypeParameters",n(r("TypeParameterInstantiation"),r("TSTypeParameterInstantiation"),null),o.null).field("implements",n([r("ClassImplements")],[r("TSExpressionWithTypeArguments")]),o.emptyArray)}))},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(13)),o=n(r(23));t.default=function(e){e.use(o.default);var t=e.use(i.default),r=e.use(a.default).defaults,n=t.Type.def,s=t.Type.or;n("Noop").bases("Statement").build(),n("DoExpression").bases("Expression").build("body").field("body",[n("Statement")]),n("Super").bases("Expression").build(),n("BindExpression").bases("Expression").build("object","callee").field("object",s(n("Expression"),null)).field("callee",n("Expression")),n("Decorator").bases("Node").build("expression").field("expression",n("Expression")),n("Property").field("decorators",s([n("Decorator")],null),r.null),n("MethodDefinition").field("decorators",s([n("Decorator")],null),r.null),n("MetaProperty").bases("Expression").build("meta","property").field("meta",n("Identifier")).field("property",n("Identifier")),n("ParenthesizedExpression").bases("Expression").build("expression").field("expression",n("Expression")),n("ImportSpecifier").bases("ModuleSpecifier").build("imported","local").field("imported",n("Identifier")),n("ImportDefaultSpecifier").bases("ModuleSpecifier").build("local"),n("ImportNamespaceSpecifier").bases("ModuleSpecifier").build("local"),n("ExportDefaultDeclaration").bases("Declaration").build("declaration").field("declaration",s(n("Declaration"),n("Expression"))),n("ExportNamedDeclaration").bases("Declaration").build("declaration","specifiers","source").field("declaration",s(n("Declaration"),null)).field("specifiers",[n("ExportSpecifier")],r.emptyArray).field("source",s(n("Literal"),null),r.null),n("ExportSpecifier").bases("ModuleSpecifier").build("local","exported").field("exported",n("Identifier")),n("ExportNamespaceSpecifier").bases("Specifier").build("exported").field("exported",n("Identifier")),n("ExportDefaultSpecifier").bases("Specifier").build("exported").field("exported",n("Identifier")),n("ExportAllDeclaration").bases("Declaration").build("exported","source").field("exported",s(n("Identifier"),null)).field("source",n("Literal")),n("CommentBlock").bases("Comment").build("value","leading","trailing"),n("CommentLine").bases("Comment").build("value","leading","trailing"),n("Directive").bases("Node").build("value").field("value",n("DirectiveLiteral")),n("DirectiveLiteral").bases("Node","Expression").build("value").field("value",String,r["use strict"]),n("InterpreterDirective").bases("Node").build("value").field("value",String),n("BlockStatement").bases("Statement").build("body").field("body",[n("Statement")]).field("directives",[n("Directive")],r.emptyArray),n("Program").bases("Node").build("body").field("body",[n("Statement")]).field("directives",[n("Directive")],r.emptyArray).field("interpreter",s(n("InterpreterDirective"),null),r.null),n("StringLiteral").bases("Literal").build("value").field("value",String),n("NumericLiteral").bases("Literal").build("value").field("value",Number).field("raw",s(String,null),r.null).field("extra",{rawValue:Number,raw:String},(function(){return{rawValue:this.value,raw:this.value+""}})),n("BigIntLiteral").bases("Literal").build("value").field("value",s(String,Number)).field("extra",{rawValue:String,raw:String},(function(){return{rawValue:String(this.value),raw:this.value+"n"}})),n("NullLiteral").bases("Literal").build().field("value",null,r.null),n("BooleanLiteral").bases("Literal").build("value").field("value",Boolean),n("RegExpLiteral").bases("Literal").build("pattern","flags").field("pattern",String).field("flags",String).field("value",RegExp,(function(){return new RegExp(this.pattern,this.flags)}));var l=s(n("Property"),n("ObjectMethod"),n("ObjectProperty"),n("SpreadProperty"),n("SpreadElement"));n("ObjectExpression").bases("Expression").build("properties").field("properties",[l]),n("ObjectMethod").bases("Node","Function").build("kind","key","params","body","computed").field("kind",s("method","get","set")).field("key",s(n("Literal"),n("Identifier"),n("Expression"))).field("params",[n("Pattern")]).field("body",n("BlockStatement")).field("computed",Boolean,r.false).field("generator",Boolean,r.false).field("async",Boolean,r.false).field("accessibility",s(n("Literal"),null),r.null).field("decorators",s([n("Decorator")],null),r.null),n("ObjectProperty").bases("Node").build("key","value").field("key",s(n("Literal"),n("Identifier"),n("Expression"))).field("value",s(n("Expression"),n("Pattern"))).field("accessibility",s(n("Literal"),null),r.null).field("computed",Boolean,r.false);var u=s(n("MethodDefinition"),n("VariableDeclarator"),n("ClassPropertyDefinition"),n("ClassProperty"),n("ClassPrivateProperty"),n("ClassMethod"),n("ClassPrivateMethod"));n("ClassBody").bases("Declaration").build("body").field("body",[u]),n("ClassMethod").bases("Declaration","Function").build("kind","key","params","body","computed","static").field("key",s(n("Literal"),n("Identifier"),n("Expression"))),n("ClassPrivateMethod").bases("Declaration","Function").build("key","params","body","kind","computed","static").field("key",n("PrivateName")),["ClassMethod","ClassPrivateMethod"].forEach((function(e){n(e).field("kind",s("get","set","method","constructor"),(function(){return"method"})).field("body",n("BlockStatement")).field("computed",Boolean,r.false).field("static",s(Boolean,null),r.null).field("abstract",s(Boolean,null),r.null).field("access",s("public","private","protected",null),r.null).field("accessibility",s("public","private","protected",null),r.null).field("decorators",s([n("Decorator")],null),r.null).field("optional",s(Boolean,null),r.null)})),n("ClassPrivateProperty").bases("ClassProperty").build("key","value").field("key",n("PrivateName")).field("value",s(n("Expression"),null),r.null),n("PrivateName").bases("Expression","Pattern").build("id").field("id",n("Identifier"));var c=s(n("Property"),n("PropertyPattern"),n("SpreadPropertyPattern"),n("SpreadProperty"),n("ObjectProperty"),n("RestProperty"));n("ObjectPattern").bases("Pattern").build("properties").field("properties",[c]).field("decorators",s([n("Decorator")],null),r.null),n("SpreadProperty").bases("Node").build("argument").field("argument",n("Expression")),n("RestProperty").bases("Node").build("argument").field("argument",n("Expression")),n("ForAwaitStatement").bases("Statement").build("left","right","body").field("left",s(n("VariableDeclaration"),n("Expression"))).field("right",n("Expression")).field("body",n("Statement")),n("Import").bases("Expression").build()},e.exports=t.default},function(e,t,r){t.SourceMapGenerator=r(74).SourceMapGenerator,t.SourceMapConsumer=r(139).SourceMapConsumer,t.SourceNode=r(142).SourceNode},function(e,t,r){var n=r(75),i=r(24),a=r(76).ArraySet,o=r(138).MappingList;function s(e){e||(e={}),this._file=i.getArg(e,"file",null),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._skipValidation=i.getArg(e,"skipValidation",!1),this._sources=new a,this._names=new a,this._mappings=new o,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(e){var t=e.sourceRoot,r=new s({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=t&&(n.source=i.relative(t,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),r.addMapping(n)})),e.sources.forEach((function(n){var a=n;null!==t&&(a=i.relative(t,n)),r._sources.has(a)||r._sources.add(a);var o=e.sourceContentFor(n);null!=o&&r.setSourceContent(n,o)})),r},s.prototype.addMapping=function(e){var t=i.getArg(e,"generated"),r=i.getArg(e,"original",null),n=i.getArg(e,"source",null),a=i.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,n,a),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=a&&(a=String(a),this._names.has(a)||this._names.add(a)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:n,name:a})},s.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=i.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(e,t,r){var n=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');n=e.file}var o=this._sourceRoot;null!=o&&(n=i.relative(o,n));var s=new a,l=new a;this._mappings.unsortedForEach((function(t){if(t.source===n&&null!=t.originalLine){var a=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=a.source&&(t.source=a.source,null!=r&&(t.source=i.join(r,t.source)),null!=o&&(t.source=i.relative(o,t.source)),t.originalLine=a.line,t.originalColumn=a.column,null!=a.name&&(t.name=a.name))}var u=t.source;null==u||s.has(u)||s.add(u);var c=t.name;null==c||l.has(c)||l.add(c)}),this),this._sources=s,this._names=l,e.sources.forEach((function(t){var n=e.sourceContentFor(t);null!=n&&(null!=r&&(t=i.join(r,t)),null!=o&&(t=i.relative(o,t)),this.setSourceContent(t,n))}),this)},s.prototype._validateMapping=function(e,t,r,n){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||r||n)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:n}))},s.prototype._serializeMappings=function(){for(var e,t,r,a,o=0,s=1,l=0,u=0,c=0,f=0,d="",h=this._mappings.toArray(),p=0,m=h.length;p<m;p++){if(e="",(t=h[p]).generatedLine!==s)for(o=0;t.generatedLine!==s;)e+=";",s++;else if(p>0){if(!i.compareByGeneratedPositionsInflated(t,h[p-1]))continue;e+=","}e+=n.encode(t.generatedColumn-o),o=t.generatedColumn,null!=t.source&&(a=this._sources.indexOf(t.source),e+=n.encode(a-f),f=a,e+=n.encode(t.originalLine-1-u),u=t.originalLine-1,e+=n.encode(t.originalColumn-l),l=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=n.encode(r-c),c=r)),d+=e}return d},s.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=i.relative(t,e));var r=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=s},function(e,t,r){var n=r(137);t.encode=function(e){var t,r="",i=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&i,(i>>>=5)>0&&(t|=32),r+=n.encode(t)}while(i>0);return r},t.decode=function(e,t,r){var i,a,o,s,l=e.length,u=0,c=0;do{if(t>=l)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(a=n.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));i=!!(32&a),u+=(a&=31)<<c,c+=5}while(i);r.value=(s=(o=u)>>1,1==(1&o)?-s:s),r.rest=t}},function(e,t,r){var n=r(24),i=Object.prototype.hasOwnProperty,a="undefined"!=typeof Map;function o(){this._array=[],this._set=a?new Map:Object.create(null)}o.fromArray=function(e,t){for(var r=new o,n=0,i=e.length;n<i;n++)r.add(e[n],t);return r},o.prototype.size=function(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length},o.prototype.add=function(e,t){var r=a?e:n.toSetString(e),o=a?this.has(e):i.call(this._set,r),s=this._array.length;o&&!t||this._array.push(e),o||(a?this._set.set(e,s):this._set[r]=s)},o.prototype.has=function(e){if(a)return this._set.has(e);var t=n.toSetString(e);return i.call(this._set,t)},o.prototype.indexOf=function(e){if(a){var t=this._set.get(e);if(t>=0)return t}else{var r=n.toSetString(e);if(i.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},o.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},o.prototype.toArray=function(){return this._array.slice()},t.ArraySet=o},function(e,t,r){var n;n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),i=r(3),a=r(8),o=r(15);function s(e,t,r){var o=null,s=function(e,t){r&&r(e,t),o&&o.visit(e,t)},l="function"==typeof r?s:null,u=!1;if(t){u="boolean"==typeof t.comment&&t.comment;var c="boolean"==typeof t.attachComment&&t.attachComment;(u||c)&&((o=new n.CommentHandler).attach=c,t.comment=!0,l=s)}var f,d=!1;t&&"string"==typeof t.sourceType&&(d="module"===t.sourceType),f=t&&"boolean"==typeof t.jsx&&t.jsx?new i.JSXParser(e,t,l):new a.Parser(e,t,l);var h=d?f.parseModule():f.parseScript();return u&&o&&(h.comments=o.comments),f.config.tokens&&(h.tokens=f.tokens),f.config.tolerant&&(h.errors=f.errorHandler.errors),h}t.parse=s,t.parseModule=function(e,t,r){var n=t||{};return n.sourceType="module",s(e,n,r)},t.parseScript=function(e,t,r){var n=t||{};return n.sourceType="script",s(e,n,r)},t.tokenize=function(e,t,r){var n,i=new o.Tokenizer(e,t);n=[];try{for(;;){var a=i.getNextToken();if(!a)break;r&&(a=r(a)),n.push(a)}}catch(e){i.errorHandler.tolerate(e)}return i.errorHandler.tolerant&&(n.errors=i.errors()),n};var l=r(2);t.Syntax=l.Syntax,t.version="4.0.1"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return e.prototype.insertInnerComments=function(e,t){if(e.type===n.Syntax.BlockStatement&&0===e.body.length){for(var r=[],i=this.leading.length-1;i>=0;--i){var a=this.leading[i];t.end.offset>=a.start&&(r.unshift(a.comment),this.leading.splice(i,1),this.trailing.splice(i,1))}r.length&&(e.innerComments=r)}},e.prototype.findTrailingComments=function(e){var t=[];if(this.trailing.length>0){for(var r=this.trailing.length-1;r>=0;--r){var n=this.trailing[r];n.start>=e.end.offset&&t.unshift(n.comment)}return this.trailing.length=0,t}var i=this.stack[this.stack.length-1];if(i&&i.node.trailingComments){var a=i.node.trailingComments[0];a&&a.range[0]>=e.end.offset&&(t=i.node.trailingComments,delete i.node.trailingComments)}return t},e.prototype.findLeadingComments=function(e){for(var t,r=[];this.stack.length>0&&((a=this.stack[this.stack.length-1])&&a.start>=e.start.offset);)t=a.node,this.stack.pop();if(t){for(var n=(t.leadingComments?t.leadingComments.length:0)-1;n>=0;--n){var i=t.leadingComments[n];i.range[1]<=e.start.offset&&(r.unshift(i),t.leadingComments.splice(n,1))}return t.leadingComments&&0===t.leadingComments.length&&delete t.leadingComments,r}for(n=this.leading.length-1;n>=0;--n){var a;(a=this.leading[n]).start<=e.start.offset&&(r.unshift(a.comment),this.leading.splice(n,1))}return r},e.prototype.visitNode=function(e,t){if(!(e.type===n.Syntax.Program&&e.body.length>0)){this.insertInnerComments(e,t);var r=this.findTrailingComments(t),i=this.findLeadingComments(t);i.length>0&&(e.leadingComments=i),r.length>0&&(e.trailingComments=r),this.stack.push({node:e,start:t.start.offset})}},e.prototype.visitComment=function(e,t){var r="L"===e.type[0]?"Line":"Block",n={type:r,value:e.value};if(e.range&&(n.range=e.range),e.loc&&(n.loc=e.loc),this.comments.push(n),this.attach){var i={comment:{type:r,value:e.value,range:[t.start.offset,t.end.offset]},start:t.start.offset};e.loc&&(i.comment.loc=e.loc),e.type=r,this.leading.push(i),this.trailing.push(i)}},e.prototype.visit=function(e,t){"LineComment"===e.type?this.visitComment(e,t):"BlockComment"===e.type?this.visitComment(e,t):this.attach&&this.visitNode(e,t)},e}();t.CommentHandler=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var a=r(4),o=r(5),s=r(6),l=r(7),u=r(8),c=r(13),f=r(14);function d(e){var t;switch(e.type){case s.JSXSyntax.JSXIdentifier:t=e.name;break;case s.JSXSyntax.JSXNamespacedName:var r=e;t=d(r.namespace)+":"+d(r.name);break;case s.JSXSyntax.JSXMemberExpression:var n=e;t=d(n.object)+"."+d(n.property)}return t}c.TokenName[100]="JSXIdentifier",c.TokenName[101]="JSXText";var h=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return i(t,e),t.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():e.prototype.parsePrimaryExpression.call(this)},t.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},t.prototype.finishJSX=function(){this.nextToken()},t.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},t.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.scanXHTMLEntity=function(e){for(var t="&",r=!0,n=!1,i=!1,o=!1;!this.scanner.eof()&&r&&!n;){var s=this.scanner.source[this.scanner.index];if(s===e)break;if(n=";"===s,t+=s,++this.scanner.index,!n)switch(t.length){case 2:i="#"===s;break;case 3:i&&(r=(o="x"===s)||a.Character.isDecimalDigit(s.charCodeAt(0)),i=i&&!o);break;default:r=(r=r&&!(i&&!a.Character.isDecimalDigit(s.charCodeAt(0))))&&!(o&&!a.Character.isHexDigit(s.charCodeAt(0)))}}if(r&&n&&t.length>2){var l=t.substr(1,t.length-2);i&&l.length>1?t=String.fromCharCode(parseInt(l.substr(1),10)):o&&l.length>2?t=String.fromCharCode(parseInt("0"+l.substr(1),16)):i||o||!f.XHTMLEntities[l]||(t=f.XHTMLEntities[l])}return t},t.prototype.lexJSX=function(){var e=this.scanner.source.charCodeAt(this.scanner.index);if(60===e||62===e||47===e||58===e||61===e||123===e||125===e)return{type:7,value:s=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(34===e||39===e){for(var t=this.scanner.index,r=this.scanner.source[this.scanner.index++],n="";!this.scanner.eof()&&(l=this.scanner.source[this.scanner.index++])!==r;)n+="&"===l?this.scanXHTMLEntity(r):l;return{type:8,value:n,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(46===e){var i=this.scanner.source.charCodeAt(this.scanner.index+1),o=this.scanner.source.charCodeAt(this.scanner.index+2),s=46===i&&46===o?"...":".";return t=this.scanner.index,this.scanner.index+=s.length,{type:7,value:s,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(96===e)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(a.Character.isIdentifierStart(e)&&92!==e){for(t=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var l=this.scanner.source.charCodeAt(this.scanner.index);if(a.Character.isIdentifierPart(l)&&92!==l)++this.scanner.index;else{if(45!==l)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(t,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}return this.scanner.lex()},t.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var e=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(e)),e},t.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var e=this.scanner.index,t="";!this.scanner.eof();){var r=this.scanner.source[this.scanner.index];if("{"===r||"<"===r)break;++this.scanner.index,t+=r,a.Character.isLineTerminator(r.charCodeAt(0))&&(++this.scanner.lineNumber,"\r"===r&&"\n"===this.scanner.source[this.scanner.index]&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var n={type:101,value:t,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:e,end:this.scanner.index};return t.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(n)),n},t.prototype.peekJSXToken=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.lexJSX();return this.scanner.restoreState(e),t},t.prototype.expectJSX=function(e){var t=this.nextJSXToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},t.prototype.matchJSX=function(e){var t=this.peekJSXToken();return 7===t.type&&t.value===e},t.prototype.parseJSXIdentifier=function(){var e=this.createJSXNode(),t=this.nextJSXToken();return 100!==t.type&&this.throwUnexpectedToken(t),this.finalize(e,new o.JSXIdentifier(t.value))},t.prototype.parseJSXElementName=function(){var e=this.createJSXNode(),t=this.parseJSXIdentifier();if(this.matchJSX(":")){var r=t;this.expectJSX(":");var n=this.parseJSXIdentifier();t=this.finalize(e,new o.JSXNamespacedName(r,n))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var i=t;this.expectJSX(".");var a=this.parseJSXIdentifier();t=this.finalize(e,new o.JSXMemberExpression(i,a))}return t},t.prototype.parseJSXAttributeName=function(){var e,t=this.createJSXNode(),r=this.parseJSXIdentifier();if(this.matchJSX(":")){var n=r;this.expectJSX(":");var i=this.parseJSXIdentifier();e=this.finalize(t,new o.JSXNamespacedName(n,i))}else e=r;return e},t.prototype.parseJSXStringLiteralAttribute=function(){var e=this.createJSXNode(),t=this.nextJSXToken();8!==t.type&&this.throwUnexpectedToken(t);var r=this.getTokenRaw(t);return this.finalize(e,new l.Literal(t.value,r))},t.prototype.parseJSXExpressionAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new o.JSXExpressionContainer(t))},t.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},t.prototype.parseJSXNameValueAttribute=function(){var e=this.createJSXNode(),t=this.parseJSXAttributeName(),r=null;return this.matchJSX("=")&&(this.expectJSX("="),r=this.parseJSXAttributeValue()),this.finalize(e,new o.JSXAttribute(t,r))},t.prototype.parseJSXSpreadAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new o.JSXSpreadAttribute(t))},t.prototype.parseJSXAttributes=function(){for(var e=[];!this.matchJSX("/")&&!this.matchJSX(">");){var t=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();e.push(t)}return e},t.prototype.parseJSXOpeningElement=function(){var e=this.createJSXNode();this.expectJSX("<");var t=this.parseJSXElementName(),r=this.parseJSXAttributes(),n=this.matchJSX("/");return n&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new o.JSXOpeningElement(t,n,r))},t.prototype.parseJSXBoundaryElement=function(){var e=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var t=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(e,new o.JSXClosingElement(t))}var r=this.parseJSXElementName(),n=this.parseJSXAttributes(),i=this.matchJSX("/");return i&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new o.JSXOpeningElement(r,i,n))},t.prototype.parseJSXEmptyExpression=function(){var e=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(e,new o.JSXEmptyExpression)},t.prototype.parseJSXExpressionContainer=function(){var e,t=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(e=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),e=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(t,new o.JSXExpressionContainer(e))},t.prototype.parseJSXChildren=function(){for(var e=[];!this.scanner.eof();){var t=this.createJSXChildNode(),r=this.nextJSXText();if(r.start<r.end){var n=this.getTokenRaw(r),i=this.finalize(t,new o.JSXText(r.value,n));e.push(i)}if("{"!==this.scanner.source[this.scanner.index])break;var a=this.parseJSXExpressionContainer();e.push(a)}return e},t.prototype.parseComplexJSXElement=function(e){for(var t=[];!this.scanner.eof();){e.children=e.children.concat(this.parseJSXChildren());var r=this.createJSXChildNode(),n=this.parseJSXBoundaryElement();if(n.type===s.JSXSyntax.JSXOpeningElement){var i=n;if(i.selfClosing){var a=this.finalize(r,new o.JSXElement(i,[],null));e.children.push(a)}else t.push(e),e={node:r,opening:i,closing:null,children:[]}}if(n.type===s.JSXSyntax.JSXClosingElement){e.closing=n;var l=d(e.opening.name);if(l!==d(e.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",l),!(t.length>0))break;a=this.finalize(e.node,new o.JSXElement(e.opening,e.children,e.closing)),(e=t[t.length-1]).children.push(a),t.pop()}}return e},t.prototype.parseJSXElement=function(){var e=this.createJSXNode(),t=this.parseJSXOpeningElement(),r=[],n=null;if(!t.selfClosing){var i=this.parseComplexJSXElement({node:e,opening:t,closing:n,children:r});r=i.children,n=i.closing}return this.finalize(e,new o.JSXElement(t,r,n))},t.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var e=this.parseJSXElement();return this.finishJSX(),e},t.prototype.isStartOfExpression=function(){return e.prototype.isStartOfExpression.call(this)||this.match("<")},t}(u.Parser);t.JSXParser=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};t.Character={fromCodePoint:function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10))+String.fromCharCode(56320+(e-65536&1023))},isWhiteSpace:function(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0},isLineTerminator:function(e){return 10===e||13===e||8232===e||8233===e},isIdentifierStart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&r.NonAsciiIdentifierStart.test(t.Character.fromCodePoint(e))},isIdentifierPart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&r.NonAsciiIdentifierPart.test(t.Character.fromCodePoint(e))},isDecimalDigit:function(e){return e>=48&&e<=57},isHexDigit:function(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},isOctalDigit:function(e){return e>=48&&e<=55}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=function(e){this.type=n.JSXSyntax.JSXClosingElement,this.name=e};t.JSXClosingElement=i;var a=function(e,t,r){this.type=n.JSXSyntax.JSXElement,this.openingElement=e,this.children=t,this.closingElement=r};t.JSXElement=a;var o=function(){this.type=n.JSXSyntax.JSXEmptyExpression};t.JSXEmptyExpression=o;var s=function(e){this.type=n.JSXSyntax.JSXExpressionContainer,this.expression=e};t.JSXExpressionContainer=s;var l=function(e){this.type=n.JSXSyntax.JSXIdentifier,this.name=e};t.JSXIdentifier=l;var u=function(e,t){this.type=n.JSXSyntax.JSXMemberExpression,this.object=e,this.property=t};t.JSXMemberExpression=u;var c=function(e,t){this.type=n.JSXSyntax.JSXAttribute,this.name=e,this.value=t};t.JSXAttribute=c;var f=function(e,t){this.type=n.JSXSyntax.JSXNamespacedName,this.namespace=e,this.name=t};t.JSXNamespacedName=f;var d=function(e,t,r){this.type=n.JSXSyntax.JSXOpeningElement,this.name=e,this.selfClosing=t,this.attributes=r};t.JSXOpeningElement=d;var h=function(e){this.type=n.JSXSyntax.JSXSpreadAttribute,this.argument=e};t.JSXSpreadAttribute=h;var p=function(e,t){this.type=n.JSXSyntax.JSXText,this.value=e,this.raw=t};t.JSXText=p},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(e){this.type=n.Syntax.ArrayExpression,this.elements=e};t.ArrayExpression=i;var a=function(e){this.type=n.Syntax.ArrayPattern,this.elements=e};t.ArrayPattern=a;var o=function(e,t,r){this.type=n.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=r,this.async=!1};t.ArrowFunctionExpression=o;var s=function(e,t,r){this.type=n.Syntax.AssignmentExpression,this.operator=e,this.left=t,this.right=r};t.AssignmentExpression=s;var l=function(e,t){this.type=n.Syntax.AssignmentPattern,this.left=e,this.right=t};t.AssignmentPattern=l;var u=function(e,t,r){this.type=n.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=r,this.async=!0};t.AsyncArrowFunctionExpression=u;var c=function(e,t,r){this.type=n.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=r,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionDeclaration=c;var f=function(e,t,r){this.type=n.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=r,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionExpression=f;var d=function(e){this.type=n.Syntax.AwaitExpression,this.argument=e};t.AwaitExpression=d;var h=function(e,t,r){var i="||"===e||"&&"===e;this.type=i?n.Syntax.LogicalExpression:n.Syntax.BinaryExpression,this.operator=e,this.left=t,this.right=r};t.BinaryExpression=h;var p=function(e){this.type=n.Syntax.BlockStatement,this.body=e};t.BlockStatement=p;var m=function(e){this.type=n.Syntax.BreakStatement,this.label=e};t.BreakStatement=m;var v=function(e,t){this.type=n.Syntax.CallExpression,this.callee=e,this.arguments=t};t.CallExpression=v;var y=function(e,t){this.type=n.Syntax.CatchClause,this.param=e,this.body=t};t.CatchClause=y;var g=function(e){this.type=n.Syntax.ClassBody,this.body=e};t.ClassBody=g;var E=function(e,t,r){this.type=n.Syntax.ClassDeclaration,this.id=e,this.superClass=t,this.body=r};t.ClassDeclaration=E;var b=function(e,t,r){this.type=n.Syntax.ClassExpression,this.id=e,this.superClass=t,this.body=r};t.ClassExpression=b;var x=function(e,t){this.type=n.Syntax.MemberExpression,this.computed=!0,this.object=e,this.property=t};t.ComputedMemberExpression=x;var A=function(e,t,r){this.type=n.Syntax.ConditionalExpression,this.test=e,this.consequent=t,this.alternate=r};t.ConditionalExpression=A;var S=function(e){this.type=n.Syntax.ContinueStatement,this.label=e};t.ContinueStatement=S;var w=function(){this.type=n.Syntax.DebuggerStatement};t.DebuggerStatement=w;var R=function(e,t){this.type=n.Syntax.ExpressionStatement,this.expression=e,this.directive=t};t.Directive=R;var C=function(e,t){this.type=n.Syntax.DoWhileStatement,this.body=e,this.test=t};t.DoWhileStatement=C;var T=function(){this.type=n.Syntax.EmptyStatement};t.EmptyStatement=T;var O=function(e){this.type=n.Syntax.ExportAllDeclaration,this.source=e};t.ExportAllDeclaration=O;var _=function(e){this.type=n.Syntax.ExportDefaultDeclaration,this.declaration=e};t.ExportDefaultDeclaration=_;var D=function(e,t,r){this.type=n.Syntax.ExportNamedDeclaration,this.declaration=e,this.specifiers=t,this.source=r};t.ExportNamedDeclaration=D;var N=function(e,t){this.type=n.Syntax.ExportSpecifier,this.exported=t,this.local=e};t.ExportSpecifier=N;var k=function(e){this.type=n.Syntax.ExpressionStatement,this.expression=e};t.ExpressionStatement=k;var M=function(e,t,r){this.type=n.Syntax.ForInStatement,this.left=e,this.right=t,this.body=r,this.each=!1};t.ForInStatement=M;var I=function(e,t,r){this.type=n.Syntax.ForOfStatement,this.left=e,this.right=t,this.body=r};t.ForOfStatement=I;var P=function(e,t,r,i){this.type=n.Syntax.ForStatement,this.init=e,this.test=t,this.update=r,this.body=i};t.ForStatement=P;var F=function(e,t,r,i){this.type=n.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=r,this.generator=i,this.expression=!1,this.async=!1};t.FunctionDeclaration=F;var L=function(e,t,r,i){this.type=n.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=r,this.generator=i,this.expression=!1,this.async=!1};t.FunctionExpression=L;var j=function(e){this.type=n.Syntax.Identifier,this.name=e};t.Identifier=j;var B=function(e,t,r){this.type=n.Syntax.IfStatement,this.test=e,this.consequent=t,this.alternate=r};t.IfStatement=B;var U=function(e,t){this.type=n.Syntax.ImportDeclaration,this.specifiers=e,this.source=t};t.ImportDeclaration=U;var V=function(e){this.type=n.Syntax.ImportDefaultSpecifier,this.local=e};t.ImportDefaultSpecifier=V;var H=function(e){this.type=n.Syntax.ImportNamespaceSpecifier,this.local=e};t.ImportNamespaceSpecifier=H;var z=function(e,t){this.type=n.Syntax.ImportSpecifier,this.local=e,this.imported=t};t.ImportSpecifier=z;var X=function(e,t){this.type=n.Syntax.LabeledStatement,this.label=e,this.body=t};t.LabeledStatement=X;var q=function(e,t){this.type=n.Syntax.Literal,this.value=e,this.raw=t};t.Literal=q;var W=function(e,t){this.type=n.Syntax.MetaProperty,this.meta=e,this.property=t};t.MetaProperty=W;var G=function(e,t,r,i,a){this.type=n.Syntax.MethodDefinition,this.key=e,this.computed=t,this.value=r,this.kind=i,this.static=a};t.MethodDefinition=G;var Y=function(e){this.type=n.Syntax.Program,this.body=e,this.sourceType="module"};t.Module=Y;var J=function(e,t){this.type=n.Syntax.NewExpression,this.callee=e,this.arguments=t};t.NewExpression=J;var $=function(e){this.type=n.Syntax.ObjectExpression,this.properties=e};t.ObjectExpression=$;var K=function(e){this.type=n.Syntax.ObjectPattern,this.properties=e};t.ObjectPattern=K;var Q=function(e,t,r,i,a,o){this.type=n.Syntax.Property,this.key=t,this.computed=r,this.value=i,this.kind=e,this.method=a,this.shorthand=o};t.Property=Q;var Z=function(e,t,r,i){this.type=n.Syntax.Literal,this.value=e,this.raw=t,this.regex={pattern:r,flags:i}};t.RegexLiteral=Z;var ee=function(e){this.type=n.Syntax.RestElement,this.argument=e};t.RestElement=ee;var te=function(e){this.type=n.Syntax.ReturnStatement,this.argument=e};t.ReturnStatement=te;var re=function(e){this.type=n.Syntax.Program,this.body=e,this.sourceType="script"};t.Script=re;var ne=function(e){this.type=n.Syntax.SequenceExpression,this.expressions=e};t.SequenceExpression=ne;var ie=function(e){this.type=n.Syntax.SpreadElement,this.argument=e};t.SpreadElement=ie;var ae=function(e,t){this.type=n.Syntax.MemberExpression,this.computed=!1,this.object=e,this.property=t};t.StaticMemberExpression=ae;var oe=function(){this.type=n.Syntax.Super};t.Super=oe;var se=function(e,t){this.type=n.Syntax.SwitchCase,this.test=e,this.consequent=t};t.SwitchCase=se;var le=function(e,t){this.type=n.Syntax.SwitchStatement,this.discriminant=e,this.cases=t};t.SwitchStatement=le;var ue=function(e,t){this.type=n.Syntax.TaggedTemplateExpression,this.tag=e,this.quasi=t};t.TaggedTemplateExpression=ue;var ce=function(e,t){this.type=n.Syntax.TemplateElement,this.value=e,this.tail=t};t.TemplateElement=ce;var fe=function(e,t){this.type=n.Syntax.TemplateLiteral,this.quasis=e,this.expressions=t};t.TemplateLiteral=fe;var de=function(){this.type=n.Syntax.ThisExpression};t.ThisExpression=de;var he=function(e){this.type=n.Syntax.ThrowStatement,this.argument=e};t.ThrowStatement=he;var pe=function(e,t,r){this.type=n.Syntax.TryStatement,this.block=e,this.handler=t,this.finalizer=r};t.TryStatement=pe;var me=function(e,t){this.type=n.Syntax.UnaryExpression,this.operator=e,this.argument=t,this.prefix=!0};t.UnaryExpression=me;var ve=function(e,t,r){this.type=n.Syntax.UpdateExpression,this.operator=e,this.argument=t,this.prefix=r};t.UpdateExpression=ve;var ye=function(e,t){this.type=n.Syntax.VariableDeclaration,this.declarations=e,this.kind=t};t.VariableDeclaration=ye;var ge=function(e,t){this.type=n.Syntax.VariableDeclarator,this.id=e,this.init=t};t.VariableDeclarator=ge;var Ee=function(e,t){this.type=n.Syntax.WhileStatement,this.test=e,this.body=t};t.WhileStatement=Ee;var be=function(e,t){this.type=n.Syntax.WithStatement,this.object=e,this.body=t};t.WithStatement=be;var xe=function(e,t){this.type=n.Syntax.YieldExpression,this.argument=e,this.delegate=t};t.YieldExpression=xe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),i=r(10),a=r(11),o=r(7),s=r(12),l=r(2),u=r(13),c=function(){function e(e,t,r){void 0===t&&(t={}),this.config={range:"boolean"==typeof t.range&&t.range,loc:"boolean"==typeof t.loc&&t.loc,source:null,tokens:"boolean"==typeof t.tokens&&t.tokens,comment:"boolean"==typeof t.comment&&t.comment,tolerant:"boolean"==typeof t.tolerant&&t.tolerant},this.config.loc&&t.source&&null!==t.source&&(this.config.source=String(t.source)),this.delegate=r,this.errorHandler=new i.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new s.Scanner(e,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return e.prototype.throwError=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=Array.prototype.slice.call(arguments,1),a=e.replace(/%(\d)/g,(function(e,t){return n.assert(t<i.length,"Message reference must be in range"),i[t]})),o=this.lastMarker.index,s=this.lastMarker.line,l=this.lastMarker.column+1;throw this.errorHandler.createError(o,s,l,a)},e.prototype.tolerateError=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=Array.prototype.slice.call(arguments,1),a=e.replace(/%(\d)/g,(function(e,t){return n.assert(t<i.length,"Message reference must be in range"),i[t]})),o=this.lastMarker.index,s=this.scanner.lineNumber,l=this.lastMarker.column+1;this.errorHandler.tolerateError(o,s,l,a)},e.prototype.unexpectedTokenError=function(e,t){var r,n=t||a.Messages.UnexpectedToken;if(e?(t||(n=2===e.type?a.Messages.UnexpectedEOS:3===e.type?a.Messages.UnexpectedIdentifier:6===e.type?a.Messages.UnexpectedNumber:8===e.type?a.Messages.UnexpectedString:10===e.type?a.Messages.UnexpectedTemplate:a.Messages.UnexpectedToken,4===e.type&&(this.scanner.isFutureReservedWord(e.value)?n=a.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(e.value)&&(n=a.Messages.StrictReservedWord))),r=e.value):r="ILLEGAL",n=n.replace("%0",r),e&&"number"==typeof e.lineNumber){var i=e.start,o=e.lineNumber,s=this.lastMarker.index-this.lastMarker.column,l=e.start-s+1;return this.errorHandler.createError(i,o,l,n)}return i=this.lastMarker.index,o=this.lastMarker.line,l=this.lastMarker.column+1,this.errorHandler.createError(i,o,l,n)},e.prototype.throwUnexpectedToken=function(e,t){throw this.unexpectedTokenError(e,t)},e.prototype.tolerateUnexpectedToken=function(e,t){this.errorHandler.tolerate(this.unexpectedTokenError(e,t))},e.prototype.collectComments=function(){if(this.config.comment){var e=this.scanner.scanComments();if(e.length>0&&this.delegate)for(var t=0;t<e.length;++t){var r=e[t],n=void 0;n={type:r.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(r.slice[0],r.slice[1])},this.config.range&&(n.range=r.range),this.config.loc&&(n.loc=r.loc);var i={start:{line:r.loc.start.line,column:r.loc.start.column,offset:r.range[0]},end:{line:r.loc.end.line,column:r.loc.end.column,offset:r.range[1]}};this.delegate(n,i)}}else this.scanner.scanComments()},e.prototype.getTokenRaw=function(e){return this.scanner.source.slice(e.start,e.end)},e.prototype.convertToken=function(e){var t={type:u.TokenName[e.type],value:this.getTokenRaw(e)};if(this.config.range&&(t.range=[e.start,e.end]),this.config.loc&&(t.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),9===e.type){var r=e.pattern,n=e.flags;t.regex={pattern:r,flags:n}}return t},e.prototype.nextToken=function(){var e=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var t=this.scanner.lex();return this.hasLineTerminator=e.lineNumber!==t.lineNumber,t&&this.context.strict&&3===t.type&&this.scanner.isStrictModeReservedWord(t.value)&&(t.type=4),this.lookahead=t,this.config.tokens&&2!==t.type&&this.tokens.push(this.convertToken(t)),e},e.prototype.nextRegexToken=function(){this.collectComments();var e=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(e))),this.lookahead=e,this.nextToken(),e},e.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},e.prototype.startNode=function(e,t){void 0===t&&(t=0);var r=e.start-e.lineStart,n=e.lineNumber;return r<0&&(r+=t,n--),{index:e.start,line:n,column:r}},e.prototype.finalize=function(e,t){if(this.config.range&&(t.range=[e.index,this.lastMarker.index]),this.config.loc&&(t.loc={start:{line:e.line,column:e.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(t.loc.source=this.config.source)),this.delegate){var r={start:{line:e.line,column:e.column,offset:e.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(t,r)}return t},e.prototype.expect=function(e){var t=this.nextToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var e=this.lookahead;7===e.type&&","===e.value?this.nextToken():7===e.type&&";"===e.value?(this.nextToken(),this.tolerateUnexpectedToken(e)):this.tolerateUnexpectedToken(e,a.Messages.UnexpectedToken)}else this.expect(",")},e.prototype.expectKeyword=function(e){var t=this.nextToken();4===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.match=function(e){return 7===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchKeyword=function(e){return 4===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchContextualKeyword=function(e){return 3===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchAssign=function(){if(7!==this.lookahead.type)return!1;var e=this.lookahead.value;return"="===e||"*="===e||"**="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e},e.prototype.isolateCoverGrammar=function(e){var t=this.context.isBindingElement,r=this.context.isAssignmentTarget,n=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var i=e.call(this);return null!==this.context.firstCoverInitializedNameError&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=t,this.context.isAssignmentTarget=r,this.context.firstCoverInitializedNameError=n,i},e.prototype.inheritCoverGrammar=function(e){var t=this.context.isBindingElement,r=this.context.isAssignmentTarget,n=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var i=e.call(this);return this.context.isBindingElement=this.context.isBindingElement&&t,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&r,this.context.firstCoverInitializedNameError=n||this.context.firstCoverInitializedNameError,i},e.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(2===this.lookahead.type||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},e.prototype.parsePrimaryExpression=function(){var e,t,r,n=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&"await"===this.lookahead.value&&this.tolerateUnexpectedToken(this.lookahead),e=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(n,new o.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,a.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new o.Literal(t.value,r));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new o.Literal("true"===t.value,r));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),r=this.getTokenRaw(t),e=this.finalize(n,new o.Literal(null,r));break;case 10:e=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,e=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":e=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":e=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,t=this.nextRegexToken(),r=this.getTokenRaw(t),e=this.finalize(n,new o.RegexLiteral(t.regex,r,t.pattern,t.flags));break;default:e=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?e=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?e=this.finalize(n,new o.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?e=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),e=this.finalize(n,new o.ThisExpression)):e=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:e=this.throwUnexpectedToken(this.nextToken())}return e},e.prototype.parseSpreadElement=function(){var e=this.createNode();this.expect("...");var t=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(e,new o.SpreadElement(t))},e.prototype.parseArrayInitializer=function(){var e=this.createNode(),t=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),t.push(null);else if(this.match("...")){var r=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),t.push(r)}else t.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(e,new o.ArrayExpression(t))},e.prototype.parsePropertyMethod=function(e){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var t=this.context.strict,r=this.context.allowStrictDirective;this.context.allowStrictDirective=e.simple;var n=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&e.firstRestricted&&this.tolerateUnexpectedToken(e.firstRestricted,e.message),this.context.strict&&e.stricted&&this.tolerateUnexpectedToken(e.stricted,e.message),this.context.strict=t,this.context.allowStrictDirective=r,n},e.prototype.parsePropertyMethodFunction=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters(),n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new o.FunctionExpression(null,r.params,n,!1))},e.prototype.parsePropertyMethodAsyncFunction=function(){var e=this.createNode(),t=this.context.allowYield,r=this.context.await;this.context.allowYield=!1,this.context.await=!0;var n=this.parseFormalParameters(),i=this.parsePropertyMethod(n);return this.context.allowYield=t,this.context.await=r,this.finalize(e,new o.AsyncFunctionExpression(null,n.params,i))},e.prototype.parseObjectPropertyKey=function(){var e,t=this.createNode(),r=this.nextToken();switch(r.type){case 8:case 6:this.context.strict&&r.octal&&this.tolerateUnexpectedToken(r,a.Messages.StrictOctalLiteral);var n=this.getTokenRaw(r);e=this.finalize(t,new o.Literal(r.value,n));break;case 3:case 1:case 5:case 4:e=this.finalize(t,new o.Identifier(r.value));break;case 7:"["===r.value?(e=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):e=this.throwUnexpectedToken(r);break;default:e=this.throwUnexpectedToken(r)}return e},e.prototype.isPropertyKey=function(e,t){return e.type===l.Syntax.Identifier&&e.name===t||e.type===l.Syntax.Literal&&e.value===t},e.prototype.parseObjectProperty=function(e){var t,r=this.createNode(),n=this.lookahead,i=null,s=null,l=!1,u=!1,c=!1,f=!1;if(3===n.type){var d=n.value;this.nextToken(),l=this.match("["),i=(f=!(this.hasLineTerminator||"async"!==d||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(r,new o.Identifier(d))}else this.match("*")?this.nextToken():(l=this.match("["),i=this.parseObjectPropertyKey());var h=this.qualifiedPropertyName(this.lookahead);if(3===n.type&&!f&&"get"===n.value&&h)t="get",l=this.match("["),i=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod();else if(3===n.type&&!f&&"set"===n.value&&h)t="set",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseSetterMethod();else if(7===n.type&&"*"===n.value&&h)t="init",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),u=!0;else if(i||this.throwUnexpectedToken(this.lookahead),t="init",this.match(":")&&!f)!l&&this.isPropertyKey(i,"__proto__")&&(e.value&&this.tolerateError(a.Messages.DuplicateProtoProperty),e.value=!0),this.nextToken(),s=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))s=f?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),u=!0;else if(3===n.type)if(d=this.finalize(r,new o.Identifier(n.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),c=!0;var p=this.isolateCoverGrammar(this.parseAssignmentExpression);s=this.finalize(r,new o.AssignmentPattern(d,p))}else c=!0,s=d;else this.throwUnexpectedToken(this.nextToken());return this.finalize(r,new o.Property(t,i,l,s,u,c))},e.prototype.parseObjectInitializer=function(){var e=this.createNode();this.expect("{");for(var t=[],r={value:!1};!this.match("}");)t.push(this.parseObjectProperty(r)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(e,new o.ObjectExpression(t))},e.prototype.parseTemplateHead=function(){n.assert(this.lookahead.head,"Template literal must start with a template head");var e=this.createNode(),t=this.nextToken(),r=t.value,i=t.cooked;return this.finalize(e,new o.TemplateElement({raw:r,cooked:i},t.tail))},e.prototype.parseTemplateElement=function(){10!==this.lookahead.type&&this.throwUnexpectedToken();var e=this.createNode(),t=this.nextToken(),r=t.value,n=t.cooked;return this.finalize(e,new o.TemplateElement({raw:r,cooked:n},t.tail))},e.prototype.parseTemplateLiteral=function(){var e=this.createNode(),t=[],r=[],n=this.parseTemplateHead();for(r.push(n);!n.tail;)t.push(this.parseExpression()),n=this.parseTemplateElement(),r.push(n);return this.finalize(e,new o.TemplateLiteral(r,t))},e.prototype.reinterpretExpressionAsPattern=function(e){switch(e.type){case l.Syntax.Identifier:case l.Syntax.MemberExpression:case l.Syntax.RestElement:case l.Syntax.AssignmentPattern:break;case l.Syntax.SpreadElement:e.type=l.Syntax.RestElement,this.reinterpretExpressionAsPattern(e.argument);break;case l.Syntax.ArrayExpression:e.type=l.Syntax.ArrayPattern;for(var t=0;t<e.elements.length;t++)null!==e.elements[t]&&this.reinterpretExpressionAsPattern(e.elements[t]);break;case l.Syntax.ObjectExpression:for(e.type=l.Syntax.ObjectPattern,t=0;t<e.properties.length;t++)this.reinterpretExpressionAsPattern(e.properties[t].value);break;case l.Syntax.AssignmentExpression:e.type=l.Syntax.AssignmentPattern,delete e.operator,this.reinterpretExpressionAsPattern(e.left)}},e.prototype.parseGroupExpression=function(){var e;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var t=this.lookahead,r=[];if(this.match("..."))e=this.parseRestElement(r),this.expect(")"),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[e],async:!1};else{var n=!1;if(this.context.isBindingElement=!0,e=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var i=[];for(this.context.isAssignmentTarget=!1,i.push(e);2!==this.lookahead.type&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var a=0;a<i.length;a++)this.reinterpretExpressionAsPattern(i[a]);n=!0,e={type:"ArrowParameterPlaceHolder",params:i,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),i.push(this.parseRestElement(r)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,a=0;a<i.length;a++)this.reinterpretExpressionAsPattern(i[a]);n=!0,e={type:"ArrowParameterPlaceHolder",params:i,async:!1}}else i.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(n)break}n||(e=this.finalize(this.startNode(t),new o.SequenceExpression(i)))}if(!n){if(this.expect(")"),this.match("=>")&&(e.type===l.Syntax.Identifier&&"yield"===e.name&&(n=!0,e={type:"ArrowParameterPlaceHolder",params:[e],async:!1}),!n)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),e.type===l.Syntax.SequenceExpression)for(a=0;a<e.expressions.length;a++)this.reinterpretExpressionAsPattern(e.expressions[a]);else this.reinterpretExpressionAsPattern(e);e={type:"ArrowParameterPlaceHolder",params:e.type===l.Syntax.SequenceExpression?e.expressions:[e],async:!1}}this.context.isBindingElement=!1}}}return e},e.prototype.parseArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.isIdentifierName=function(e){return 3===e.type||4===e.type||1===e.type||5===e.type},e.prototype.parseIdentifierName=function(){var e=this.createNode(),t=this.nextToken();return this.isIdentifierName(t)||this.throwUnexpectedToken(t),this.finalize(e,new o.Identifier(t.value))},e.prototype.parseNewExpression=function(){var e,t=this.createNode(),r=this.parseIdentifierName();if(n.assert("new"===r.name,"New expression must start with `new`"),this.match("."))if(this.nextToken(),3===this.lookahead.type&&this.context.inFunctionBody&&"target"===this.lookahead.value){var i=this.parseIdentifierName();e=new o.MetaProperty(r,i)}else this.throwUnexpectedToken(this.lookahead);else{var a=this.isolateCoverGrammar(this.parseLeftHandSideExpression),s=this.match("(")?this.parseArguments():[];e=new o.NewExpression(a,s),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(t,e)},e.prototype.parseAsyncArgument=function(){var e=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,e},e.prototype.parseAsyncArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.parseLeftHandSideExpressionAllowCall=function(){var e,t=this.lookahead,r=this.matchContextualKeyword("async"),n=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(e=this.createNode(),this.nextToken(),e=this.finalize(e,new o.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):e=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var i=this.parseIdentifierName();e=this.finalize(this.startNode(t),new o.StaticMemberExpression(e,i))}else if(this.match("(")){var a=r&&t.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var s=a?this.parseAsyncArguments():this.parseArguments();if(e=this.finalize(this.startNode(t),new o.CallExpression(e,s)),a&&this.match("=>")){for(var l=0;l<s.length;++l)this.reinterpretExpressionAsPattern(s[l]);e={type:"ArrowParameterPlaceHolder",params:s,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),i=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),e=this.finalize(this.startNode(t),new o.ComputedMemberExpression(e,i));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var u=this.parseTemplateLiteral();e=this.finalize(this.startNode(t),new o.TaggedTemplateExpression(e,u))}return this.context.allowIn=n,e},e.prototype.parseSuper=function(){var e=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(e,new o.Super)},e.prototype.parseLeftHandSideExpression=function(){n.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var e=this.startNode(this.lookahead),t=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var r=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),t=this.finalize(e,new o.ComputedMemberExpression(t,r))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),r=this.parseIdentifierName(),t=this.finalize(e,new o.StaticMemberExpression(t,r));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var i=this.parseTemplateLiteral();t=this.finalize(e,new o.TaggedTemplateExpression(t,i))}return t},e.prototype.parseUpdateExpression=function(){var e,t=this.lookahead;if(this.match("++")||this.match("--")){var r=this.startNode(t),n=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&e.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(a.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(a.Messages.InvalidLHSInAssignment);var i=!0;e=this.finalize(r,new o.UpdateExpression(n.value,e,i)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(e=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&7===this.lookahead.type&&(this.match("++")||this.match("--"))){this.context.strict&&e.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(a.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(a.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var s=this.nextToken().value;i=!1,e=this.finalize(this.startNode(t),new o.UpdateExpression(s,e,i))}return e},e.prototype.parseAwaitExpression=function(){var e=this.createNode();this.nextToken();var t=this.parseUnaryExpression();return this.finalize(e,new o.AwaitExpression(t))},e.prototype.parseUnaryExpression=function(){var e;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var t=this.startNode(this.lookahead),r=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),e=this.finalize(t,new o.UnaryExpression(r.value,e)),this.context.strict&&"delete"===e.operator&&e.argument.type===l.Syntax.Identifier&&this.tolerateError(a.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else e=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return e},e.prototype.parseExponentiationExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseUnaryExpression);if(t.type!==l.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var r=t,n=this.isolateCoverGrammar(this.parseExponentiationExpression);t=this.finalize(this.startNode(e),new o.BinaryExpression("**",r,n))}return t},e.prototype.binaryPrecedence=function(e){var t=e.value;return 7===e.type?this.operatorPrecedence[t]||0:4===e.type&&("instanceof"===t||this.context.allowIn&&"in"===t)?7:0},e.prototype.parseBinaryExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseExponentiationExpression),r=this.lookahead,n=this.binaryPrecedence(r);if(n>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var i=[e,this.lookahead],a=t,s=this.isolateCoverGrammar(this.parseExponentiationExpression),l=[a,r.value,s],u=[n];!((n=this.binaryPrecedence(this.lookahead))<=0);){for(;l.length>2&&n<=u[u.length-1];){s=l.pop();var c=l.pop();u.pop(),a=l.pop(),i.pop();var f=this.startNode(i[i.length-1]);l.push(this.finalize(f,new o.BinaryExpression(c,a,s)))}l.push(this.nextToken().value),u.push(n),i.push(this.lookahead),l.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var d=l.length-1;t=l[d];for(var h=i.pop();d>1;){var p=i.pop(),m=h&&h.lineStart;f=this.startNode(p,m),c=l[d-1],t=this.finalize(f,new o.BinaryExpression(c,l[d-2],t)),d-=2,h=p}}return t},e.prototype.parseConditionalExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var r=this.context.allowIn;this.context.allowIn=!0;var n=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=r,this.expect(":");var i=this.isolateCoverGrammar(this.parseAssignmentExpression);t=this.finalize(this.startNode(e),new o.ConditionalExpression(t,n,i)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return t},e.prototype.checkPatternParam=function(e,t){switch(t.type){case l.Syntax.Identifier:this.validateParam(e,t,t.name);break;case l.Syntax.RestElement:this.checkPatternParam(e,t.argument);break;case l.Syntax.AssignmentPattern:this.checkPatternParam(e,t.left);break;case l.Syntax.ArrayPattern:for(var r=0;r<t.elements.length;r++)null!==t.elements[r]&&this.checkPatternParam(e,t.elements[r]);break;case l.Syntax.ObjectPattern:for(r=0;r<t.properties.length;r++)this.checkPatternParam(e,t.properties[r].value)}e.simple=e.simple&&t instanceof o.Identifier},e.prototype.reinterpretAsCoverFormalsList=function(e){var t,r=[e],n=!1;switch(e.type){case l.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":r=e.params,n=e.async;break;default:return null}t={simple:!0,paramSet:{}};for(var i=0;i<r.length;++i)(o=r[i]).type===l.Syntax.AssignmentPattern?o.right.type===l.Syntax.YieldExpression&&(o.right.argument&&this.throwUnexpectedToken(this.lookahead),o.right.type=l.Syntax.Identifier,o.right.name="yield",delete o.right.argument,delete o.right.delegate):n&&o.type===l.Syntax.Identifier&&"await"===o.name&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(t,o),r[i]=o;if(this.context.strict||!this.context.allowYield)for(i=0;i<r.length;++i){var o;(o=r[i]).type===l.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(t.message===a.Messages.StrictParamDupe){var s=this.context.strict?t.stricted:t.firstRestricted;this.throwUnexpectedToken(s,t.message)}return{simple:t.simple,params:r,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.parseAssignmentExpression=function(){var e;if(!this.context.allowYield&&this.matchKeyword("yield"))e=this.parseYieldExpression();else{var t=this.lookahead,r=t;if(e=this.parseConditionalExpression(),3===r.type&&r.lineNumber===this.lookahead.lineNumber&&"async"===r.value&&(3===this.lookahead.type||this.matchKeyword("yield"))){var n=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(n),e={type:"ArrowParameterPlaceHolder",params:[n],async:!0}}if("ArrowParameterPlaceHolder"===e.type||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var i=e.async,s=this.reinterpretAsCoverFormalsList(e);if(s){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var u=this.context.strict,c=this.context.allowStrictDirective;this.context.allowStrictDirective=s.simple;var f=this.context.allowYield,d=this.context.await;this.context.allowYield=!0,this.context.await=i;var h=this.startNode(t);this.expect("=>");var p=void 0;if(this.match("{")){var m=this.context.allowIn;this.context.allowIn=!0,p=this.parseFunctionSourceElements(),this.context.allowIn=m}else p=this.isolateCoverGrammar(this.parseAssignmentExpression);var v=p.type!==l.Syntax.BlockStatement;this.context.strict&&s.firstRestricted&&this.throwUnexpectedToken(s.firstRestricted,s.message),this.context.strict&&s.stricted&&this.tolerateUnexpectedToken(s.stricted,s.message),e=i?this.finalize(h,new o.AsyncArrowFunctionExpression(s.params,p,v)):this.finalize(h,new o.ArrowFunctionExpression(s.params,p,v)),this.context.strict=u,this.context.allowStrictDirective=c,this.context.allowYield=f,this.context.await=d}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(a.Messages.InvalidLHSInAssignment),this.context.strict&&e.type===l.Syntax.Identifier){var y=e;this.scanner.isRestrictedWord(y.name)&&this.tolerateUnexpectedToken(r,a.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(y.name)&&this.tolerateUnexpectedToken(r,a.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(e):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var g=(r=this.nextToken()).value,E=this.isolateCoverGrammar(this.parseAssignmentExpression);e=this.finalize(this.startNode(t),new o.AssignmentExpression(g,e,E)),this.context.firstCoverInitializedNameError=null}}return e},e.prototype.parseExpression=function(){var e=this.lookahead,t=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var r=[];for(r.push(t);2!==this.lookahead.type&&this.match(",");)this.nextToken(),r.push(this.isolateCoverGrammar(this.parseAssignmentExpression));t=this.finalize(this.startNode(e),new o.SequenceExpression(r))}return t},e.prototype.parseStatementListItem=function(){var e;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,4===this.lookahead.type)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,a.Messages.IllegalExportDeclaration),e=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,a.Messages.IllegalImportDeclaration),e=this.parseImportDeclaration();break;case"const":e=this.parseLexicalDeclaration({inFor:!1});break;case"function":e=this.parseFunctionDeclaration();break;case"class":e=this.parseClassDeclaration();break;case"let":e=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:e=this.parseStatement()}else e=this.parseStatement();return e},e.prototype.parseBlock=function(){var e=this.createNode();this.expect("{");for(var t=[];!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.finalize(e,new o.BlockStatement(t))},e.prototype.parseLexicalBinding=function(e,t){var r=this.createNode(),n=this.parsePattern([],e);this.context.strict&&n.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(n.name)&&this.tolerateError(a.Messages.StrictVarName);var i=null;return"const"===e?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),i=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(a.Messages.DeclarationMissingInitializer,"const")):(!t.inFor&&n.type!==l.Syntax.Identifier||this.match("="))&&(this.expect("="),i=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(r,new o.VariableDeclarator(n,i))},e.prototype.parseBindingList=function(e,t){for(var r=[this.parseLexicalBinding(e,t)];this.match(",");)this.nextToken(),r.push(this.parseLexicalBinding(e,t));return r},e.prototype.isLexicalDeclaration=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.scanner.lex();return this.scanner.restoreState(e),3===t.type||7===t.type&&"["===t.value||7===t.type&&"{"===t.value||4===t.type&&"let"===t.value||4===t.type&&"yield"===t.value},e.prototype.parseLexicalDeclaration=function(e){var t=this.createNode(),r=this.nextToken().value;n.assert("let"===r||"const"===r,"Lexical declaration must be either let or const");var i=this.parseBindingList(r,e);return this.consumeSemicolon(),this.finalize(t,new o.VariableDeclaration(i,r))},e.prototype.parseBindingRestElement=function(e,t){var r=this.createNode();this.expect("...");var n=this.parsePattern(e,t);return this.finalize(r,new o.RestElement(n))},e.prototype.parseArrayPattern=function(e,t){var r=this.createNode();this.expect("[");for(var n=[];!this.match("]");)if(this.match(","))this.nextToken(),n.push(null);else{if(this.match("...")){n.push(this.parseBindingRestElement(e,t));break}n.push(this.parsePatternWithDefault(e,t)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(r,new o.ArrayPattern(n))},e.prototype.parsePropertyPattern=function(e,t){var r,n,i=this.createNode(),a=!1,s=!1;if(3===this.lookahead.type){var l=this.lookahead;r=this.parseVariableIdentifier();var u=this.finalize(i,new o.Identifier(l.value));if(this.match("=")){e.push(l),s=!0,this.nextToken();var c=this.parseAssignmentExpression();n=this.finalize(this.startNode(l),new o.AssignmentPattern(u,c))}else this.match(":")?(this.expect(":"),n=this.parsePatternWithDefault(e,t)):(e.push(l),s=!0,n=u)}else a=this.match("["),r=this.parseObjectPropertyKey(),this.expect(":"),n=this.parsePatternWithDefault(e,t);return this.finalize(i,new o.Property("init",r,a,n,!1,s))},e.prototype.parseObjectPattern=function(e,t){var r=this.createNode(),n=[];for(this.expect("{");!this.match("}");)n.push(this.parsePropertyPattern(e,t)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(r,new o.ObjectPattern(n))},e.prototype.parsePattern=function(e,t){var r;return this.match("[")?r=this.parseArrayPattern(e,t):this.match("{")?r=this.parseObjectPattern(e,t):(!this.matchKeyword("let")||"const"!==t&&"let"!==t||this.tolerateUnexpectedToken(this.lookahead,a.Messages.LetInLexicalBinding),e.push(this.lookahead),r=this.parseVariableIdentifier(t)),r},e.prototype.parsePatternWithDefault=function(e,t){var r=this.lookahead,n=this.parsePattern(e,t);if(this.match("=")){this.nextToken();var i=this.context.allowYield;this.context.allowYield=!0;var a=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=i,n=this.finalize(this.startNode(r),new o.AssignmentPattern(n,a))}return n},e.prototype.parseVariableIdentifier=function(e){var t=this.createNode(),r=this.nextToken();return 4===r.type&&"yield"===r.value?this.context.strict?this.tolerateUnexpectedToken(r,a.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(r):3!==r.type?this.context.strict&&4===r.type&&this.scanner.isStrictModeReservedWord(r.value)?this.tolerateUnexpectedToken(r,a.Messages.StrictReservedWord):(this.context.strict||"let"!==r.value||"var"!==e)&&this.throwUnexpectedToken(r):(this.context.isModule||this.context.await)&&3===r.type&&"await"===r.value&&this.tolerateUnexpectedToken(r),this.finalize(t,new o.Identifier(r.value))},e.prototype.parseVariableDeclaration=function(e){var t=this.createNode(),r=this.parsePattern([],"var");this.context.strict&&r.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(a.Messages.StrictVarName);var n=null;return this.match("=")?(this.nextToken(),n=this.isolateCoverGrammar(this.parseAssignmentExpression)):r.type===l.Syntax.Identifier||e.inFor||this.expect("="),this.finalize(t,new o.VariableDeclarator(r,n))},e.prototype.parseVariableDeclarationList=function(e){var t={inFor:e.inFor},r=[];for(r.push(this.parseVariableDeclaration(t));this.match(",");)this.nextToken(),r.push(this.parseVariableDeclaration(t));return r},e.prototype.parseVariableStatement=function(){var e=this.createNode();this.expectKeyword("var");var t=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(e,new o.VariableDeclaration(t,"var"))},e.prototype.parseEmptyStatement=function(){var e=this.createNode();return this.expect(";"),this.finalize(e,new o.EmptyStatement)},e.prototype.parseExpressionStatement=function(){var e=this.createNode(),t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new o.ExpressionStatement(t))},e.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(a.Messages.StrictFunction),this.parseStatement()},e.prototype.parseIfStatement=function(){var e,t=this.createNode(),r=null;this.expectKeyword("if"),this.expect("(");var n=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new o.EmptyStatement)):(this.expect(")"),e=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),r=this.parseIfClause())),this.finalize(t,new o.IfStatement(n,e,r))},e.prototype.parseDoWhileStatement=function(){var e=this.createNode();this.expectKeyword("do");var t=this.context.inIteration;this.context.inIteration=!0;var r=this.parseStatement();this.context.inIteration=t,this.expectKeyword("while"),this.expect("(");var n=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(e,new o.DoWhileStatement(r,n))},e.prototype.parseWhileStatement=function(){var e,t=this.createNode();this.expectKeyword("while"),this.expect("(");var r=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new o.EmptyStatement);else{this.expect(")");var n=this.context.inIteration;this.context.inIteration=!0,e=this.parseStatement(),this.context.inIteration=n}return this.finalize(t,new o.WhileStatement(r,e))},e.prototype.parseForStatement=function(){var e,t,r,n=null,i=null,s=null,u=!0,c=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){n=this.createNode(),this.nextToken();var f=this.context.allowIn;this.context.allowIn=!1;var d=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=f,1===d.length&&this.matchKeyword("in")){var h=d[0];h.init&&(h.id.type===l.Syntax.ArrayPattern||h.id.type===l.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(a.Messages.ForInOfLoopInitializer,"for-in"),n=this.finalize(n,new o.VariableDeclaration(d,"var")),this.nextToken(),e=n,t=this.parseExpression(),n=null}else 1===d.length&&null===d[0].init&&this.matchContextualKeyword("of")?(n=this.finalize(n,new o.VariableDeclaration(d,"var")),this.nextToken(),e=n,t=this.parseAssignmentExpression(),n=null,u=!1):(n=this.finalize(n,new o.VariableDeclaration(d,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){n=this.createNode();var p=this.nextToken().value;this.context.strict||"in"!==this.lookahead.value?(f=this.context.allowIn,this.context.allowIn=!1,d=this.parseBindingList(p,{inFor:!0}),this.context.allowIn=f,1===d.length&&null===d[0].init&&this.matchKeyword("in")?(n=this.finalize(n,new o.VariableDeclaration(d,p)),this.nextToken(),e=n,t=this.parseExpression(),n=null):1===d.length&&null===d[0].init&&this.matchContextualKeyword("of")?(n=this.finalize(n,new o.VariableDeclaration(d,p)),this.nextToken(),e=n,t=this.parseAssignmentExpression(),n=null,u=!1):(this.consumeSemicolon(),n=this.finalize(n,new o.VariableDeclaration(d,p)))):(n=this.finalize(n,new o.Identifier(p)),this.nextToken(),e=n,t=this.parseExpression(),n=null)}else{var m=this.lookahead;if(f=this.context.allowIn,this.context.allowIn=!1,n=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=f,this.matchKeyword("in"))this.context.isAssignmentTarget&&n.type!==l.Syntax.AssignmentExpression||this.tolerateError(a.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(n),e=n,t=this.parseExpression(),n=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&n.type!==l.Syntax.AssignmentExpression||this.tolerateError(a.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(n),e=n,t=this.parseAssignmentExpression(),n=null,u=!1;else{if(this.match(",")){for(var v=[n];this.match(",");)this.nextToken(),v.push(this.isolateCoverGrammar(this.parseAssignmentExpression));n=this.finalize(this.startNode(m),new o.SequenceExpression(v))}this.expect(";")}}if(void 0===e&&(this.match(";")||(i=this.parseExpression()),this.expect(";"),this.match(")")||(s=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),r=this.finalize(this.createNode(),new o.EmptyStatement);else{this.expect(")");var y=this.context.inIteration;this.context.inIteration=!0,r=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=y}return void 0===e?this.finalize(c,new o.ForStatement(n,i,s,r)):u?this.finalize(c,new o.ForInStatement(e,t,r)):this.finalize(c,new o.ForOfStatement(e,t,r))},e.prototype.parseContinueStatement=function(){var e=this.createNode();this.expectKeyword("continue");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var r=this.parseVariableIdentifier();t=r;var n="$"+r.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,n)||this.throwError(a.Messages.UnknownLabel,r.name)}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.throwError(a.Messages.IllegalContinue),this.finalize(e,new o.ContinueStatement(t))},e.prototype.parseBreakStatement=function(){var e=this.createNode();this.expectKeyword("break");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var r=this.parseVariableIdentifier(),n="$"+r.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,n)||this.throwError(a.Messages.UnknownLabel,r.name),t=r}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.context.inSwitch||this.throwError(a.Messages.IllegalBreak),this.finalize(e,new o.BreakStatement(t))},e.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(a.Messages.IllegalReturn);var e=this.createNode();this.expectKeyword("return");var t=(this.match(";")||this.match("}")||this.hasLineTerminator||2===this.lookahead.type)&&8!==this.lookahead.type&&10!==this.lookahead.type?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new o.ReturnStatement(t))},e.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(a.Messages.StrictModeWith);var e,t=this.createNode();this.expectKeyword("with"),this.expect("(");var r=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new o.EmptyStatement)):(this.expect(")"),e=this.parseStatement()),this.finalize(t,new o.WithStatement(r,e))},e.prototype.parseSwitchCase=function(){var e,t=this.createNode();this.matchKeyword("default")?(this.nextToken(),e=null):(this.expectKeyword("case"),e=this.parseExpression()),this.expect(":");for(var r=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)r.push(this.parseStatementListItem());return this.finalize(t,new o.SwitchCase(e,r))},e.prototype.parseSwitchStatement=function(){var e=this.createNode();this.expectKeyword("switch"),this.expect("(");var t=this.parseExpression();this.expect(")");var r=this.context.inSwitch;this.context.inSwitch=!0;var n=[],i=!1;for(this.expect("{");!this.match("}");){var s=this.parseSwitchCase();null===s.test&&(i&&this.throwError(a.Messages.MultipleDefaultsInSwitch),i=!0),n.push(s)}return this.expect("}"),this.context.inSwitch=r,this.finalize(e,new o.SwitchStatement(t,n))},e.prototype.parseLabelledStatement=function(){var e,t=this.createNode(),r=this.parseExpression();if(r.type===l.Syntax.Identifier&&this.match(":")){this.nextToken();var n=r,i="$"+n.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,i)&&this.throwError(a.Messages.Redeclaration,"Label",n.name),this.context.labelSet[i]=!0;var s=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),s=this.parseClassDeclaration();else if(this.matchKeyword("function")){var u=this.lookahead,c=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(u,a.Messages.StrictFunction):c.generator&&this.tolerateUnexpectedToken(u,a.Messages.GeneratorInLegacyContext),s=c}else s=this.parseStatement();delete this.context.labelSet[i],e=new o.LabeledStatement(n,s)}else this.consumeSemicolon(),e=new o.ExpressionStatement(r);return this.finalize(t,e)},e.prototype.parseThrowStatement=function(){var e=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(a.Messages.NewlineAfterThrow);var t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new o.ThrowStatement(t))},e.prototype.parseCatchClause=function(){var e=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var t=[],r=this.parsePattern(t),n={},i=0;i<t.length;i++){var s="$"+t[i].value;Object.prototype.hasOwnProperty.call(n,s)&&this.tolerateError(a.Messages.DuplicateBinding,t[i].value),n[s]=!0}this.context.strict&&r.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(a.Messages.StrictCatchVariable),this.expect(")");var u=this.parseBlock();return this.finalize(e,new o.CatchClause(r,u))},e.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},e.prototype.parseTryStatement=function(){var e=this.createNode();this.expectKeyword("try");var t=this.parseBlock(),r=this.matchKeyword("catch")?this.parseCatchClause():null,n=this.matchKeyword("finally")?this.parseFinallyClause():null;return r||n||this.throwError(a.Messages.NoCatchOrFinally),this.finalize(e,new o.TryStatement(t,r,n))},e.prototype.parseDebuggerStatement=function(){var e=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(e,new o.DebuggerStatement)},e.prototype.parseStatement=function(){var e;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:e=this.parseExpressionStatement();break;case 7:var t=this.lookahead.value;e="{"===t?this.parseBlock():"("===t?this.parseExpressionStatement():";"===t?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:e=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":e=this.parseBreakStatement();break;case"continue":e=this.parseContinueStatement();break;case"debugger":e=this.parseDebuggerStatement();break;case"do":e=this.parseDoWhileStatement();break;case"for":e=this.parseForStatement();break;case"function":e=this.parseFunctionDeclaration();break;case"if":e=this.parseIfStatement();break;case"return":e=this.parseReturnStatement();break;case"switch":e=this.parseSwitchStatement();break;case"throw":e=this.parseThrowStatement();break;case"try":e=this.parseTryStatement();break;case"var":e=this.parseVariableStatement();break;case"while":e=this.parseWhileStatement();break;case"with":e=this.parseWithStatement();break;default:e=this.parseExpressionStatement()}break;default:e=this.throwUnexpectedToken(this.lookahead)}return e},e.prototype.parseFunctionSourceElements=function(){var e=this.createNode();this.expect("{");var t=this.parseDirectivePrologues(),r=this.context.labelSet,n=this.context.inIteration,i=this.context.inSwitch,a=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;2!==this.lookahead.type&&!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=r,this.context.inIteration=n,this.context.inSwitch=i,this.context.inFunctionBody=a,this.finalize(e,new o.BlockStatement(t))},e.prototype.validateParam=function(e,t,r){var n="$"+r;this.context.strict?(this.scanner.isRestrictedWord(r)&&(e.stricted=t,e.message=a.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=a.Messages.StrictParamDupe)):e.firstRestricted||(this.scanner.isRestrictedWord(r)?(e.firstRestricted=t,e.message=a.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(r)?(e.firstRestricted=t,e.message=a.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,n)&&(e.stricted=t,e.message=a.Messages.StrictParamDupe)),"function"==typeof Object.defineProperty?Object.defineProperty(e.paramSet,n,{value:!0,enumerable:!0,writable:!0,configurable:!0}):e.paramSet[n]=!0},e.prototype.parseRestElement=function(e){var t=this.createNode();this.expect("...");var r=this.parsePattern(e);return this.match("=")&&this.throwError(a.Messages.DefaultRestParameter),this.match(")")||this.throwError(a.Messages.ParameterAfterRestParameter),this.finalize(t,new o.RestElement(r))},e.prototype.parseFormalParameter=function(e){for(var t=[],r=this.match("...")?this.parseRestElement(t):this.parsePatternWithDefault(t),n=0;n<t.length;n++)this.validateParam(e,t[n],t[n].value);e.simple=e.simple&&r instanceof o.Identifier,e.params.push(r)},e.prototype.parseFormalParameters=function(e){var t;if(t={simple:!0,params:[],firstRestricted:e},this.expect("("),!this.match(")"))for(t.paramSet={};2!==this.lookahead.type&&(this.parseFormalParameter(t),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:t.simple,params:t.params,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.matchAsyncFunction=function(){var e=this.matchContextualKeyword("async");if(e){var t=this.scanner.saveState();this.scanner.scanComments();var r=this.scanner.lex();this.scanner.restoreState(t),e=t.lineNumber===r.lineNumber&&4===r.type&&"function"===r.value}return e},e.prototype.parseFunctionDeclaration=function(e){var t=this.createNode(),r=this.matchContextualKeyword("async");r&&this.nextToken(),this.expectKeyword("function");var n,i=!r&&this.match("*");i&&this.nextToken();var s=null,l=null;if(!e||!this.match("(")){var u=this.lookahead;s=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(u.value)&&this.tolerateUnexpectedToken(u,a.Messages.StrictFunctionName):this.scanner.isRestrictedWord(u.value)?(l=u,n=a.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(u.value)&&(l=u,n=a.Messages.StrictReservedWord)}var c=this.context.await,f=this.context.allowYield;this.context.await=r,this.context.allowYield=!i;var d=this.parseFormalParameters(l),h=d.params,p=d.stricted;l=d.firstRestricted,d.message&&(n=d.message);var m=this.context.strict,v=this.context.allowStrictDirective;this.context.allowStrictDirective=d.simple;var y=this.parseFunctionSourceElements();return this.context.strict&&l&&this.throwUnexpectedToken(l,n),this.context.strict&&p&&this.tolerateUnexpectedToken(p,n),this.context.strict=m,this.context.allowStrictDirective=v,this.context.await=c,this.context.allowYield=f,r?this.finalize(t,new o.AsyncFunctionDeclaration(s,h,y)):this.finalize(t,new o.FunctionDeclaration(s,h,y,i))},e.prototype.parseFunctionExpression=function(){var e=this.createNode(),t=this.matchContextualKeyword("async");t&&this.nextToken(),this.expectKeyword("function");var r,n=!t&&this.match("*");n&&this.nextToken();var i,s=null,l=this.context.await,u=this.context.allowYield;if(this.context.await=t,this.context.allowYield=!n,!this.match("(")){var c=this.lookahead;s=this.context.strict||n||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(c.value)&&this.tolerateUnexpectedToken(c,a.Messages.StrictFunctionName):this.scanner.isRestrictedWord(c.value)?(i=c,r=a.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(c.value)&&(i=c,r=a.Messages.StrictReservedWord)}var f=this.parseFormalParameters(i),d=f.params,h=f.stricted;i=f.firstRestricted,f.message&&(r=f.message);var p=this.context.strict,m=this.context.allowStrictDirective;this.context.allowStrictDirective=f.simple;var v=this.parseFunctionSourceElements();return this.context.strict&&i&&this.throwUnexpectedToken(i,r),this.context.strict&&h&&this.tolerateUnexpectedToken(h,r),this.context.strict=p,this.context.allowStrictDirective=m,this.context.await=l,this.context.allowYield=u,t?this.finalize(e,new o.AsyncFunctionExpression(s,d,v)):this.finalize(e,new o.FunctionExpression(s,d,v,n))},e.prototype.parseDirective=function(){var e=this.lookahead,t=this.createNode(),r=this.parseExpression(),n=r.type===l.Syntax.Literal?this.getTokenRaw(e).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(t,n?new o.Directive(r,n):new o.ExpressionStatement(r))},e.prototype.parseDirectivePrologues=function(){for(var e=null,t=[];;){var r=this.lookahead;if(8!==r.type)break;var n=this.parseDirective();t.push(n);var i=n.directive;if("string"!=typeof i)break;"use strict"===i?(this.context.strict=!0,e&&this.tolerateUnexpectedToken(e,a.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(r,a.Messages.IllegalLanguageModeDirective)):!e&&r.octal&&(e=r)}return t},e.prototype.qualifiedPropertyName=function(e){switch(e.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return"["===e.value}return!1},e.prototype.parseGetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();r.params.length>0&&this.tolerateError(a.Messages.BadGetterArity);var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new o.FunctionExpression(null,r.params,n,!1))},e.prototype.parseSetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();1!==r.params.length?this.tolerateError(a.Messages.BadSetterArity):r.params[0]instanceof o.RestElement&&this.tolerateError(a.Messages.BadSetterRestParameter);var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new o.FunctionExpression(null,r.params,n,!1))},e.prototype.parseGeneratorMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var r=this.parseFormalParameters();this.context.allowYield=!1;var n=this.parsePropertyMethod(r);return this.context.allowYield=t,this.finalize(e,new o.FunctionExpression(null,r.params,n,!0))},e.prototype.isStartOfExpression=function(){var e=!0,t=this.lookahead.value;switch(this.lookahead.type){case 7:e="["===t||"("===t||"{"===t||"+"===t||"-"===t||"!"===t||"~"===t||"++"===t||"--"===t||"/"===t||"/="===t;break;case 4:e="class"===t||"delete"===t||"function"===t||"let"===t||"new"===t||"super"===t||"this"===t||"typeof"===t||"void"===t||"yield"===t}return e},e.prototype.parseYieldExpression=function(){var e=this.createNode();this.expectKeyword("yield");var t=null,r=!1;if(!this.hasLineTerminator){var n=this.context.allowYield;this.context.allowYield=!1,(r=this.match("*"))?(this.nextToken(),t=this.parseAssignmentExpression()):this.isStartOfExpression()&&(t=this.parseAssignmentExpression()),this.context.allowYield=n}return this.finalize(e,new o.YieldExpression(t,r))},e.prototype.parseClassElement=function(e){var t=this.lookahead,r=this.createNode(),n="",i=null,s=null,l=!1,u=!1,c=!1,f=!1;if(this.match("*"))this.nextToken();else if(l=this.match("["),"static"===(i=this.parseObjectPropertyKey()).name&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(t=this.lookahead,c=!0,l=this.match("["),this.match("*")?this.nextToken():i=this.parseObjectPropertyKey()),3===t.type&&!this.hasLineTerminator&&"async"===t.value){var d=this.lookahead.value;":"!==d&&"("!==d&&"*"!==d&&(f=!0,t=this.lookahead,i=this.parseObjectPropertyKey(),3===t.type&&"constructor"===t.value&&this.tolerateUnexpectedToken(t,a.Messages.ConstructorIsAsync))}var h=this.qualifiedPropertyName(this.lookahead);return 3===t.type?"get"===t.value&&h?(n="get",l=this.match("["),i=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod()):"set"===t.value&&h&&(n="set",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseSetterMethod()):7===t.type&&"*"===t.value&&h&&(n="init",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),u=!0),!n&&i&&this.match("(")&&(n="init",s=f?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),u=!0),n||this.throwUnexpectedToken(this.lookahead),"init"===n&&(n="method"),l||(c&&this.isPropertyKey(i,"prototype")&&this.throwUnexpectedToken(t,a.Messages.StaticPrototype),!c&&this.isPropertyKey(i,"constructor")&&(("method"!==n||!u||s&&s.generator)&&this.throwUnexpectedToken(t,a.Messages.ConstructorSpecialMethod),e.value?this.throwUnexpectedToken(t,a.Messages.DuplicateConstructor):e.value=!0,n="constructor")),this.finalize(r,new o.MethodDefinition(i,l,s,n,c))},e.prototype.parseClassElementList=function(){var e=[],t={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():e.push(this.parseClassElement(t));return this.expect("}"),e},e.prototype.parseClassBody=function(){var e=this.createNode(),t=this.parseClassElementList();return this.finalize(e,new o.ClassBody(t))},e.prototype.parseClassDeclaration=function(e){var t=this.createNode(),r=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var n=e&&3!==this.lookahead.type?null:this.parseVariableIdentifier(),i=null;this.matchKeyword("extends")&&(this.nextToken(),i=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var a=this.parseClassBody();return this.context.strict=r,this.finalize(t,new o.ClassDeclaration(n,i,a))},e.prototype.parseClassExpression=function(){var e=this.createNode(),t=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var r=3===this.lookahead.type?this.parseVariableIdentifier():null,n=null;this.matchKeyword("extends")&&(this.nextToken(),n=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var i=this.parseClassBody();return this.context.strict=t,this.finalize(e,new o.ClassExpression(r,n,i))},e.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new o.Module(t))},e.prototype.parseScript=function(){for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new o.Script(t))},e.prototype.parseModuleSpecifier=function(){var e=this.createNode();8!==this.lookahead.type&&this.throwError(a.Messages.InvalidModuleSpecifier);var t=this.nextToken(),r=this.getTokenRaw(t);return this.finalize(e,new o.Literal(t.value,r))},e.prototype.parseImportSpecifier=function(){var e,t,r=this.createNode();return 3===this.lookahead.type?(t=e=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),t=this.parseVariableIdentifier())):(t=e=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),t=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(r,new o.ImportSpecifier(t,e))},e.prototype.parseNamedImports=function(){this.expect("{");for(var e=[];!this.match("}");)e.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),e},e.prototype.parseImportDefaultSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName();return this.finalize(e,new o.ImportDefaultSpecifier(t))},e.prototype.parseImportNamespaceSpecifier=function(){var e=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(a.Messages.NoAsAfterImportNamespace),this.nextToken();var t=this.parseIdentifierName();return this.finalize(e,new o.ImportNamespaceSpecifier(t))},e.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(a.Messages.IllegalImportDeclaration);var e,t=this.createNode();this.expectKeyword("import");var r=[];if(8===this.lookahead.type)e=this.parseModuleSpecifier();else{if(this.match("{")?r=r.concat(this.parseNamedImports()):this.match("*")?r.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(r.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?r.push(this.parseImportNamespaceSpecifier()):this.match("{")?r=r.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var n=this.lookahead.value?a.Messages.UnexpectedToken:a.Messages.MissingFromClause;this.throwError(n,this.lookahead.value)}this.nextToken(),e=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(t,new o.ImportDeclaration(r,e))},e.prototype.parseExportSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName(),r=t;return this.matchContextualKeyword("as")&&(this.nextToken(),r=this.parseIdentifierName()),this.finalize(e,new o.ExportSpecifier(t,r))},e.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(a.Messages.IllegalExportDeclaration);var e,t=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var r=this.parseFunctionDeclaration(!0);e=this.finalize(t,new o.ExportDefaultDeclaration(r))}else this.matchKeyword("class")?(r=this.parseClassDeclaration(!0),e=this.finalize(t,new o.ExportDefaultDeclaration(r))):this.matchContextualKeyword("async")?(r=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),e=this.finalize(t,new o.ExportDefaultDeclaration(r))):(this.matchContextualKeyword("from")&&this.throwError(a.Messages.UnexpectedToken,this.lookahead.value),r=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),e=this.finalize(t,new o.ExportDefaultDeclaration(r)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var n=this.lookahead.value?a.Messages.UnexpectedToken:a.Messages.MissingFromClause;this.throwError(n,this.lookahead.value)}this.nextToken();var i=this.parseModuleSpecifier();this.consumeSemicolon(),e=this.finalize(t,new o.ExportAllDeclaration(i))}else if(4===this.lookahead.type){switch(r=void 0,this.lookahead.value){case"let":case"const":r=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":r=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}e=this.finalize(t,new o.ExportNamedDeclaration(r,[],null))}else if(this.matchAsyncFunction())r=this.parseFunctionDeclaration(),e=this.finalize(t,new o.ExportNamedDeclaration(r,[],null));else{var s=[],l=null,u=!1;for(this.expect("{");!this.match("}");)u=u||this.matchKeyword("default"),s.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),l=this.parseModuleSpecifier(),this.consumeSemicolon()):u?(n=this.lookahead.value?a.Messages.UnexpectedToken:a.Messages.MissingFromClause,this.throwError(n,this.lookahead.value)):this.consumeSemicolon(),e=this.finalize(t,new o.ExportNamedDeclaration(null,s,l))}return e},e}();t.Parser=c},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error("ASSERT: "+t)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.errors=[],this.tolerant=!1}return e.prototype.recordError=function(e){this.errors.push(e)},e.prototype.tolerate=function(e){if(!this.tolerant)throw e;this.recordError(e)},e.prototype.constructError=function(e,t){var r=new Error(e);try{throw r}catch(e){Object.create&&Object.defineProperty&&(r=Object.create(e),Object.defineProperty(r,"column",{value:t}))}return r},e.prototype.createError=function(e,t,r,n){var i="Line "+t+": "+n,a=this.constructError(i,r);return a.index=e,a.lineNumber=t,a.description=n,a},e.prototype.throwError=function(e,t,r,n){throw this.createError(e,t,r,n)},e.prototype.tolerateError=function(e,t,r,n){var i=this.createError(e,t,r,n);if(!this.tolerant)throw i;this.recordError(i)},e}();t.ErrorHandler=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),i=r(4),a=r(11);function o(e){return"0123456789abcdef".indexOf(e.toLowerCase())}function s(e){return"01234567".indexOf(e)}var l=function(){function e(e,t){this.source=e,this.errorHandler=t,this.trackComment=!1,this.isModule=!1,this.length=e.length,this.index=0,this.lineNumber=e.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return e.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},e.prototype.restoreState=function(e){this.index=e.index,this.lineNumber=e.lineNumber,this.lineStart=e.lineStart},e.prototype.eof=function(){return this.index>=this.length},e.prototype.throwUnexpectedToken=function(e){return void 0===e&&(e=a.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.tolerateUnexpectedToken=function(e){void 0===e&&(e=a.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.skipSingleLineComment=function(e){var t,r,n=[];for(this.trackComment&&(n=[],t=this.index-e,r={start:{line:this.lineNumber,column:this.index-this.lineStart-e},end:{}});!this.eof();){var a=this.source.charCodeAt(this.index);if(++this.index,i.Character.isLineTerminator(a)){if(this.trackComment){r.end={line:this.lineNumber,column:this.index-this.lineStart-1};var o={multiLine:!1,slice:[t+e,this.index-1],range:[t,this.index-1],loc:r};n.push(o)}return 13===a&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,n}}return this.trackComment&&(r.end={line:this.lineNumber,column:this.index-this.lineStart},o={multiLine:!1,slice:[t+e,this.index],range:[t,this.index],loc:r},n.push(o)),n},e.prototype.skipMultiLineComment=function(){var e,t,r=[];for(this.trackComment&&(r=[],e=this.index-2,t={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var n=this.source.charCodeAt(this.index);if(i.Character.isLineTerminator(n))13===n&&10===this.source.charCodeAt(this.index+1)&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(42===n){if(47===this.source.charCodeAt(this.index+1)){if(this.index+=2,this.trackComment){t.end={line:this.lineNumber,column:this.index-this.lineStart};var a={multiLine:!0,slice:[e+2,this.index-2],range:[e,this.index],loc:t};r.push(a)}return r}++this.index}else++this.index}return this.trackComment&&(t.end={line:this.lineNumber,column:this.index-this.lineStart},a={multiLine:!0,slice:[e+2,this.index],range:[e,this.index],loc:t},r.push(a)),this.tolerateUnexpectedToken(),r},e.prototype.scanComments=function(){var e;this.trackComment&&(e=[]);for(var t=0===this.index;!this.eof();){var r=this.source.charCodeAt(this.index);if(i.Character.isWhiteSpace(r))++this.index;else if(i.Character.isLineTerminator(r))++this.index,13===r&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,t=!0;else if(47===r)if(47===(r=this.source.charCodeAt(this.index+1))){this.index+=2;var n=this.skipSingleLineComment(2);this.trackComment&&(e=e.concat(n)),t=!0}else{if(42!==r)break;this.index+=2,n=this.skipMultiLineComment(),this.trackComment&&(e=e.concat(n))}else if(t&&45===r){if(45!==this.source.charCodeAt(this.index+1)||62!==this.source.charCodeAt(this.index+2))break;this.index+=3,n=this.skipSingleLineComment(3),this.trackComment&&(e=e.concat(n))}else{if(60!==r||this.isModule)break;if("!--"!==this.source.slice(this.index+1,this.index+4))break;this.index+=4,n=this.skipSingleLineComment(4),this.trackComment&&(e=e.concat(n))}}return e},e.prototype.isFutureReservedWord=function(e){switch(e){case"enum":case"export":case"import":case"super":return!0;default:return!1}},e.prototype.isStrictModeReservedWord=function(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},e.prototype.isRestrictedWord=function(e){return"eval"===e||"arguments"===e},e.prototype.isKeyword=function(e){switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}},e.prototype.codePointAt=function(e){var t=this.source.charCodeAt(e);if(t>=55296&&t<=56319){var r=this.source.charCodeAt(e+1);r>=56320&&r<=57343&&(t=1024*(t-55296)+r-56320+65536)}return t},e.prototype.scanHexEscape=function(e){for(var t="u"===e?4:2,r=0,n=0;n<t;++n){if(this.eof()||!i.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;r=16*r+o(this.source[this.index++])}return String.fromCharCode(r)},e.prototype.scanUnicodeCodePointEscape=function(){var e=this.source[this.index],t=0;for("}"===e&&this.throwUnexpectedToken();!this.eof()&&(e=this.source[this.index++],i.Character.isHexDigit(e.charCodeAt(0)));)t=16*t+o(e);return(t>1114111||"}"!==e)&&this.throwUnexpectedToken(),i.Character.fromCodePoint(t)},e.prototype.getIdentifier=function(){for(var e=this.index++;!this.eof();){var t=this.source.charCodeAt(this.index);if(92===t)return this.index=e,this.getComplexIdentifier();if(t>=55296&&t<57343)return this.index=e,this.getComplexIdentifier();if(!i.Character.isIdentifierPart(t))break;++this.index}return this.source.slice(e,this.index)},e.prototype.getComplexIdentifier=function(){var e,t=this.codePointAt(this.index),r=i.Character.fromCodePoint(t);for(this.index+=r.length,92===t&&(117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&i.Character.isIdentifierStart(e.charCodeAt(0))||this.throwUnexpectedToken(),r=e);!this.eof()&&(t=this.codePointAt(this.index),i.Character.isIdentifierPart(t));)r+=e=i.Character.fromCodePoint(t),this.index+=e.length,92===t&&(r=r.substr(0,r.length-1),117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&i.Character.isIdentifierPart(e.charCodeAt(0))||this.throwUnexpectedToken(),r+=e);return r},e.prototype.octalToDecimal=function(e){var t="0"!==e,r=s(e);return!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(t=!0,r=8*r+s(this.source[this.index++]),"0123".indexOf(e)>=0&&!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(r=8*r+s(this.source[this.index++]))),{code:r,octal:t}},e.prototype.scanIdentifier=function(){var e,t=this.index,r=92===this.source.charCodeAt(t)?this.getComplexIdentifier():this.getIdentifier();if(3!=(e=1===r.length?3:this.isKeyword(r)?4:"null"===r?5:"true"===r||"false"===r?1:3)&&t+r.length!==this.index){var n=this.index;this.index=t,this.tolerateUnexpectedToken(a.Messages.InvalidEscapedReservedWord),this.index=n}return{type:e,value:r,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.scanPunctuator=function(){var e=this.index,t=this.source[this.index];switch(t){case"(":case"{":"{"===t&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,"."===this.source[this.index]&&"."===this.source[this.index+1]&&(this.index+=2,t="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:">>>="===(t=this.source.substr(this.index,4))?this.index+=4:"==="===(t=t.substr(0,3))||"!=="===t||">>>"===t||"<<="===t||">>="===t||"**="===t?this.index+=3:"&&"===(t=t.substr(0,2))||"||"===t||"=="===t||"!="===t||"+="===t||"-="===t||"*="===t||"/="===t||"++"===t||"--"===t||"<<"===t||">>"===t||"&="===t||"|="===t||"^="===t||"%="===t||"<="===t||">="===t||"=>"===t||"**"===t?this.index+=2:(t=this.source[this.index],"<>=!+-*%&|^/".indexOf(t)>=0&&++this.index)}return this.index===e&&this.throwUnexpectedToken(),{type:7,value:t,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanHexLiteral=function(e){for(var t="";!this.eof()&&i.Character.isHexDigit(this.source.charCodeAt(this.index));)t+=this.source[this.index++];return 0===t.length&&this.throwUnexpectedToken(),i.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+t,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanBinaryLiteral=function(e){for(var t,r="";!this.eof()&&("0"===(t=this.source[this.index])||"1"===t);)r+=this.source[this.index++];return 0===r.length&&this.throwUnexpectedToken(),this.eof()||(t=this.source.charCodeAt(this.index),(i.Character.isIdentifierStart(t)||i.Character.isDecimalDigit(t))&&this.throwUnexpectedToken()),{type:6,value:parseInt(r,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanOctalLiteral=function(e,t){var r="",n=!1;for(i.Character.isOctalDigit(e.charCodeAt(0))?(n=!0,r="0"+this.source[this.index++]):++this.index;!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];return n||0!==r.length||this.throwUnexpectedToken(),(i.Character.isIdentifierStart(this.source.charCodeAt(this.index))||i.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(r,8),octal:n,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.isImplicitOctalLiteral=function(){for(var e=this.index+1;e<this.length;++e){var t=this.source[e];if("8"===t||"9"===t)return!1;if(!i.Character.isOctalDigit(t.charCodeAt(0)))return!0}return!0},e.prototype.scanNumericLiteral=function(){var e=this.index,t=this.source[e];n.assert(i.Character.isDecimalDigit(t.charCodeAt(0))||"."===t,"Numeric literal must start with a decimal digit or a decimal point");var r="";if("."!==t){if(r=this.source[this.index++],t=this.source[this.index],"0"===r){if("x"===t||"X"===t)return++this.index,this.scanHexLiteral(e);if("b"===t||"B"===t)return++this.index,this.scanBinaryLiteral(e);if("o"===t||"O"===t)return this.scanOctalLiteral(t,e);if(t&&i.Character.isOctalDigit(t.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(t,e)}for(;i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];t=this.source[this.index]}if("."===t){for(r+=this.source[this.index++];i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];t=this.source[this.index]}if("e"===t||"E"===t)if(r+=this.source[this.index++],"+"!==(t=this.source[this.index])&&"-"!==t||(r+=this.source[this.index++]),i.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)r+=this.source[this.index++];else this.throwUnexpectedToken();return i.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(r),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanStringLiteral=function(){var e=this.index,t=this.source[e];n.assert("'"===t||'"'===t,"String literal must starts with a quote"),++this.index;for(var r=!1,o="";!this.eof();){var s=this.source[this.index++];if(s===t){t="";break}if("\\"===s)if((s=this.source[this.index++])&&i.Character.isLineTerminator(s.charCodeAt(0)))++this.lineNumber,"\r"===s&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(s){case"u":if("{"===this.source[this.index])++this.index,o+=this.scanUnicodeCodePointEscape();else{var l=this.scanHexEscape(s);null===l&&this.throwUnexpectedToken(),o+=l}break;case"x":var u=this.scanHexEscape(s);null===u&&this.throwUnexpectedToken(a.Messages.InvalidHexEscapeSequence),o+=u;break;case"n":o+="\n";break;case"r":o+="\r";break;case"t":o+="\t";break;case"b":o+="\b";break;case"f":o+="\f";break;case"v":o+="\v";break;case"8":case"9":o+=s,this.tolerateUnexpectedToken();break;default:if(s&&i.Character.isOctalDigit(s.charCodeAt(0))){var c=this.octalToDecimal(s);r=c.octal||r,o+=String.fromCharCode(c.code)}else o+=s}else{if(i.Character.isLineTerminator(s.charCodeAt(0)))break;o+=s}}return""!==t&&(this.index=e,this.throwUnexpectedToken()),{type:8,value:o,octal:r,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanTemplate=function(){var e="",t=!1,r=this.index,n="`"===this.source[r],o=!1,s=2;for(++this.index;!this.eof();){var l=this.source[this.index++];if("`"===l){s=1,o=!0,t=!0;break}if("$"===l){if("{"===this.source[this.index]){this.curlyStack.push("${"),++this.index,t=!0;break}e+=l}else if("\\"===l)if(l=this.source[this.index++],i.Character.isLineTerminator(l.charCodeAt(0)))++this.lineNumber,"\r"===l&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(l){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"u":if("{"===this.source[this.index])++this.index,e+=this.scanUnicodeCodePointEscape();else{var u=this.index,c=this.scanHexEscape(l);null!==c?e+=c:(this.index=u,e+=l)}break;case"x":var f=this.scanHexEscape(l);null===f&&this.throwUnexpectedToken(a.Messages.InvalidHexEscapeSequence),e+=f;break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:"0"===l?(i.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(a.Messages.TemplateOctalLiteral),e+="\0"):i.Character.isOctalDigit(l.charCodeAt(0))?this.throwUnexpectedToken(a.Messages.TemplateOctalLiteral):e+=l}else i.Character.isLineTerminator(l.charCodeAt(0))?(++this.lineNumber,"\r"===l&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index,e+="\n"):e+=l}return t||this.throwUnexpectedToken(),n||this.curlyStack.pop(),{type:10,value:this.source.slice(r+1,this.index-s),cooked:e,head:n,tail:o,lineNumber:this.lineNumber,lineStart:this.lineStart,start:r,end:this.index}},e.prototype.testRegExp=function(e,t){var r=e,n=this;t.indexOf("u")>=0&&(r=r.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(function(e,t,r){var i=parseInt(t||r,16);return i>1114111&&n.throwUnexpectedToken(a.Messages.InvalidRegExp),i<=65535?String.fromCharCode(i):"￿"})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"￿"));try{RegExp(r)}catch(e){this.throwUnexpectedToken(a.Messages.InvalidRegExp)}try{return new RegExp(e,t)}catch(e){return null}},e.prototype.scanRegExpBody=function(){var e=this.source[this.index];n.assert("/"===e,"Regular expression literal must start with a slash");for(var t=this.source[this.index++],r=!1,o=!1;!this.eof();)if(t+=e=this.source[this.index++],"\\"===e)e=this.source[this.index++],i.Character.isLineTerminator(e.charCodeAt(0))&&this.throwUnexpectedToken(a.Messages.UnterminatedRegExp),t+=e;else if(i.Character.isLineTerminator(e.charCodeAt(0)))this.throwUnexpectedToken(a.Messages.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){o=!0;break}"["===e&&(r=!0)}return o||this.throwUnexpectedToken(a.Messages.UnterminatedRegExp),t.substr(1,t.length-2)},e.prototype.scanRegExpFlags=function(){for(var e="";!this.eof();){var t=this.source[this.index];if(!i.Character.isIdentifierPart(t.charCodeAt(0)))break;if(++this.index,"\\"!==t||this.eof())e+=t;else if("u"===(t=this.source[this.index])){++this.index;var r=this.index,n=this.scanHexEscape("u");if(null!==n)for(e+=n;r<this.index;++r)this.source[r];else this.index=r,e+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return e},e.prototype.scanRegExp=function(){var e=this.index,t=this.scanRegExpBody(),r=this.scanRegExpFlags();return{type:9,value:"",pattern:t,flags:r,regex:this.testRegExp(t,r),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var e=this.source.charCodeAt(this.index);return i.Character.isIdentifierStart(e)?this.scanIdentifier():40===e||41===e||59===e?this.scanPunctuator():39===e||34===e?this.scanStringLiteral():46===e?i.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():i.Character.isDecimalDigit(e)?this.scanNumericLiteral():96===e||125===e&&"${"===this.curlyStack[this.curlyStack.length-1]?this.scanTemplate():e>=55296&&e<57343&&i.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},e}();t.Scanner=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenName={},t.TokenName[1]="Boolean",t.TokenName[2]="<end>",t.TokenName[3]="Identifier",t.TokenName[4]="Keyword",t.TokenName[5]="Null",t.TokenName[6]="Numeric",t.TokenName[7]="Punctuator",t.TokenName[8]="String",t.TokenName[9]="RegularExpression",t.TokenName[10]="Template"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",lang:"⟨",rang:"⟩"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),i=r(12),a=r(13),o=function(){function e(){this.values=[],this.curly=this.paren=-1}return e.prototype.beforeFunctionExpression=function(e){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(e)>=0},e.prototype.isRegexStart=function(){var e=this.values[this.values.length-1],t=null!==e;switch(e){case"this":case"]":t=!1;break;case")":var r=this.values[this.paren-1];t="if"===r||"while"===r||"for"===r||"with"===r;break;case"}":if(t=!1,"function"===this.values[this.curly-3])t=!!(n=this.values[this.curly-4])&&!this.beforeFunctionExpression(n);else if("function"===this.values[this.curly-4]){var n;t=!(n=this.values[this.curly-5])||!this.beforeFunctionExpression(n)}}return t},e.prototype.push=function(e){7===e.type||4===e.type?("{"===e.value?this.curly=this.values.length:"("===e.value&&(this.paren=this.values.length),this.values.push(e.value)):this.values.push(null)},e}(),s=function(){function e(e,t){this.errorHandler=new n.ErrorHandler,this.errorHandler.tolerant=!!t&&"boolean"==typeof t.tolerant&&t.tolerant,this.scanner=new i.Scanner(e,this.errorHandler),this.scanner.trackComment=!!t&&"boolean"==typeof t.comment&&t.comment,this.trackRange=!!t&&"boolean"==typeof t.range&&t.range,this.trackLoc=!!t&&"boolean"==typeof t.loc&&t.loc,this.buffer=[],this.reader=new o}return e.prototype.errors=function(){return this.errorHandler.errors},e.prototype.getNextToken=function(){if(0===this.buffer.length){var e=this.scanner.scanComments();if(this.scanner.trackComment)for(var t=0;t<e.length;++t){var r=e[t],n=this.scanner.source.slice(r.slice[0],r.slice[1]),i={type:r.multiLine?"BlockComment":"LineComment",value:n};this.trackRange&&(i.range=r.range),this.trackLoc&&(i.loc=r.loc),this.buffer.push(i)}if(!this.scanner.eof()){var o=void 0;this.trackLoc&&(o={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var s="/"===this.scanner.source[this.scanner.index]&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(s);var l={type:a.TokenName[s.type],value:this.scanner.source.slice(s.start,s.end)};if(this.trackRange&&(l.range=[s.start,s.end]),this.trackLoc&&(o.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},l.loc=o),9===s.type){var u=s.pattern,c=s.flags;l.regex={pattern:u,flags:c}}this.buffer.push(l)}}return this.buffer.shift()},e}();t.Tokenizer=s}])},e.exports=n()},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=i(r(18)),s=o.namedTypes,l=o.builtInTypes.array,u=o.builtInTypes.object,c=r(29),f=r(20),d=r(145).makeUniqueKey();function h(e,t,r){for(var n=function e(t,r,n){if(t){if(f.fixFaultyLocations(t,r),n){if(s.Node.check(t)&&s.SourceLocation.check(t.loc)){for(var i=n.length-1;i>=0&&!(f.comparePos(n[i].loc.end,t.loc.start)<=0);--i);return void n.splice(i+1,0,t)}}else if(t[d])return t[d];var a;if(l.check(t))a=Object.keys(t);else{if(!u.check(t))return;a=o.getFieldNames(t)}n||Object.defineProperty(t,d,{value:n=[],enumerable:!1});i=0;for(var c=a.length;i<c;++i)e(t[a[i]],r,n);return n}}(e,r),i=0,a=n.length;i<a;){var c=i+a>>1,p=n[c];if(f.comparePos(p.loc.start,t.loc.start)<=0&&f.comparePos(t.loc.end,p.loc.end)<=0)return void h(t.enclosingNode=p,t,r);if(f.comparePos(p.loc.end,t.loc.start)<=0){var m=p;i=c+1}else{if(!(f.comparePos(t.loc.end,p.loc.start)<=0))throw new Error("Comment location overlaps with node location");var v=p;a=c}}m&&(t.precedingNode=m),v&&(t.followingNode=v)}function p(e,t){var r=e.length;if(0!==r){for(var n=e[0].precedingNode,i=e[0].followingNode,o=i.loc.start,s=r;s>0;--s){var l=e[s-1];a.default.strictEqual(l.precedingNode,n),a.default.strictEqual(l.followingNode,i);var u=t.sliceString(l.loc.end,o);if(/\S/.test(u))break;o=l.loc.start}for(;s<=r&&(l=e[s])&&("Line"===l.type||"CommentLine"===l.type)&&l.loc.start.column>i.loc.start.column;)++s;e.forEach((function(e,t){t<s?y(n,e):v(i,e)})),e.length=0}}function m(e,t){(e.comments||(e.comments=[])).push(t)}function v(e,t){t.leading=!0,t.trailing=!1,m(e,t)}function y(e,t){t.leading=!1,t.trailing=!0,m(e,t)}t.attach=function(e,t,r){if(l.check(e)){var n=[];e.forEach((function(e){e.loc.lines=r,h(t,e,r);var i=e.precedingNode,o=e.enclosingNode,s=e.followingNode;if(i&&s){var l=n.length;if(l>0){var u=n[l-1];a.default.strictEqual(u.precedingNode===e.precedingNode,u.followingNode===e.followingNode),u.followingNode!==e.followingNode&&p(n,r)}n.push(e)}else if(i)p(n,r),y(i,e);else if(s)p(n,r),v(s,e);else{if(!o)throw new Error("AST contains no nodes at all?");p(n,r),function(e,t){t.leading=!1,t.trailing=!1,m(e,t)}(o,e)}})),p(n,r),e.forEach((function(e){delete e.precedingNode,delete e.enclosingNode,delete e.followingNode}))}},t.printComments=function(e,t){var r=e.getValue(),n=t(e),i=s.Node.check(r)&&o.getFieldValue(r,"comments");if(!i||0===i.length)return n;var a=[],l=[n];return e.each((function(e){var n=e.getValue(),i=o.getFieldValue(n,"leading"),u=o.getFieldValue(n,"trailing");i||u&&!s.Statement.check(r)&&"Block"!==n.type&&"CommentBlock"!==n.type?a.push(function(e,t){var r=e.getValue();s.Comment.assert(r);var n=r.loc,i=n&&n.lines,a=[t(e)];if(r.trailing)a.push("\n");else if(i instanceof c.Lines){var o=i.slice(n.end,i.skipSpaces(n.end)||i.lastPos());1===o.length?a.push(o):a.push(new Array(o.length).join("\n"))}else a.push("\n");return c.concat(a)}(e,t)):u&&l.push(function(e,t){var r=e.getValue(e);s.Comment.assert(r);var n=r.loc,i=n&&n.lines,a=[];if(i instanceof c.Lines){var o=i.skipSpaces(n.start,!0)||i.firstPos(),l=i.slice(o,n.start);1===l.length?a.push(l):a.push(new Array(l.length).join("\n"))}return a.push(t(e)),c.concat(a)}(e,t))}),"comments"),a.push.apply(a,l),c.concat(a)}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=i(r(18)),s=o.namedTypes,l=o.builtInTypes.array,u=o.builtInTypes.number,c=i(r(20)),f=function e(t){a.default.ok(this instanceof e),this.stack=[t]},d=f.prototype;function h(e,t){for(var r=e.stack,n=r.length-1;n>=0;n-=2){var i=r[n];if(s.Node.check(i)&&--t<0)return i}return null}function p(e){return s.BinaryExpression.check(e)||s.LogicalExpression.check(e)}f.from=function(e){if(e instanceof f)return e.copy();if(e instanceof o.NodePath){for(var t,r=Object.create(f.prototype),n=[e.value];t=e.parentPath;e=t)n.push(e.name,t.value);return r.stack=n.reverse(),r}return new f(e)},d.copy=function(){var e=Object.create(f.prototype);return e.stack=this.stack.slice(0),e},d.getName=function(){var e=this.stack,t=e.length;return t>1?e[t-2]:null},d.getValue=function(){var e=this.stack;return e[e.length-1]},d.valueIsDuplicate=function(){var e=this.stack,t=e.length-1;return e.lastIndexOf(e[t],t-1)>=0},d.getNode=function(e){return void 0===e&&(e=0),h(this,~~e)},d.getParentNode=function(e){return void 0===e&&(e=0),h(this,1+~~e)},d.getRootValue=function(){var e=this.stack;return e.length%2==0?e[1]:e[0]},d.call=function(e){for(var t=this.stack,r=t.length,n=t[r-1],i=arguments.length,a=1;a<i;++a){var o=arguments[a];n=n[o],t.push(o,n)}var s=e(this);return t.length=r,s},d.each=function(e){for(var t=this.stack,r=t.length,n=t[r-1],i=arguments.length,a=1;a<i;++a){var o=arguments[a];n=n[o],t.push(o,n)}for(a=0;a<n.length;++a)a in n&&(t.push(a,n[a]),e(this),t.length-=2);t.length=r},d.map=function(e){for(var t=this.stack,r=t.length,n=t[r-1],i=arguments.length,a=1;a<i;++a){var o=arguments[a];n=n[o],t.push(o,n)}var s=new Array(n.length);for(a=0;a<n.length;++a)a in n&&(t.push(a,n[a]),s[a]=e(this,a),t.length-=2);return t.length=r,s},d.hasParens=function(){var e=this.getNode(),t=this.getPrevToken(e);if(!t)return!1;var r=this.getNextToken(e);if(!r)return!1;if("("===t.value){if(")"===r.value)return!0;if(!this.canBeFirstInStatement()&&this.firstInStatement()&&!this.needsParens(!0))return!0}return!1},d.getPrevToken=function(e){var t=(e=e||this.getNode())&&e.loc,r=t&&t.tokens;if(r&&t.start.token>0){var n=r[t.start.token-1];if(n){var i=this.getRootValue().loc;if(c.comparePos(i.start,n.loc.start)<=0)return n}}return null},d.getNextToken=function(e){var t=(e=e||this.getNode())&&e.loc,r=t&&t.tokens;if(r&&t.end.token<r.length){var n=r[t.end.token];if(n){var i=this.getRootValue().loc;if(c.comparePos(n.loc.end,i.end)<=0)return n}}return null},d.needsParens=function(e){var t=this.getNode();if("AssignmentExpression"===t.type&&"ObjectPattern"===t.left.type)return!0;var r=this.getParentNode();if(!r)return!1;var n=this.getName();if(this.getValue()!==t)return!1;if(s.Statement.check(t))return!1;if("Identifier"===t.type)return!1;if("ParenthesizedExpression"===r.type)return!1;switch(t.type){case"UnaryExpression":case"SpreadElement":case"SpreadProperty":return"MemberExpression"===r.type&&"object"===n&&r.object===t;case"BinaryExpression":case"LogicalExpression":switch(r.type){case"CallExpression":return"callee"===n&&r.callee===t;case"UnaryExpression":case"SpreadElement":case"SpreadProperty":return!0;case"MemberExpression":return"object"===n&&r.object===t;case"BinaryExpression":case"LogicalExpression":var i=r.operator,o=m[i],l=t.operator,c=m[l];if(o>c)return!0;if(o===c&&"right"===n)return a.default.strictEqual(r.right,t),!0;default:return!1}case"SequenceExpression":switch(r.type){case"ReturnStatement":case"ForStatement":return!1;case"ExpressionStatement":return"expression"!==n;default:return!0}case"YieldExpression":switch(r.type){case"BinaryExpression":case"LogicalExpression":case"UnaryExpression":case"SpreadElement":case"SpreadProperty":case"CallExpression":case"MemberExpression":case"NewExpression":case"ConditionalExpression":case"YieldExpression":return!0;default:return!1}case"IntersectionTypeAnnotation":case"UnionTypeAnnotation":return"NullableTypeAnnotation"===r.type;case"Literal":return"MemberExpression"===r.type&&u.check(t.value)&&"object"===n&&r.object===t;case"NumericLiteral":return"MemberExpression"===r.type&&"object"===n&&r.object===t;case"AssignmentExpression":case"ConditionalExpression":switch(r.type){case"UnaryExpression":case"SpreadElement":case"SpreadProperty":case"BinaryExpression":case"LogicalExpression":return!0;case"CallExpression":case"NewExpression":return"callee"===n&&r.callee===t;case"ConditionalExpression":return"test"===n&&r.test===t;case"MemberExpression":return"object"===n&&r.object===t;default:return!1}case"ArrowFunctionExpression":return!(!s.CallExpression.check(r)||"callee"!==n)||(!(!s.MemberExpression.check(r)||"object"!==n)||p(r));case"ObjectExpression":if("ArrowFunctionExpression"===r.type&&"body"===n)return!0;break;case"TSAsExpression":if("ArrowFunctionExpression"===r.type&&"body"===n&&"ObjectExpression"===t.expression.type)return!0;break;case"CallExpression":if("declaration"===n&&s.ExportDefaultDeclaration.check(r)&&s.FunctionExpression.check(t.callee))return!0}return"NewExpression"===r.type&&"callee"===n&&r.callee===t?v(t):!(!0===e||this.canBeFirstInStatement()||!this.firstInStatement())};var m={};function v(e){return!!s.CallExpression.check(e)||(l.check(e)?e.some(v):!!s.Node.check(e)&&o.someField(e,(function(e,t){return v(t)})))}[["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%","**"]].forEach((function(e,t){e.forEach((function(e){m[e]=t}))})),d.canBeFirstInStatement=function(){var e=this.getNode();return!s.FunctionExpression.check(e)&&(!s.ObjectExpression.check(e)&&!s.ClassExpression.check(e))},d.firstInStatement=function(){for(var e,t,r,n,i=this.stack,o=i.length-1;o>=0;o-=2)if(s.Node.check(i[o])&&(r=e,n=t,e=i[o-1],t=i[o]),t&&n){if(s.BlockStatement.check(t)&&"body"===e&&0===r)return a.default.strictEqual(t.body[0],n),!0;if(s.ExpressionStatement.check(t)&&"expression"===r)return a.default.strictEqual(t.expression,n),!0;if(s.AssignmentExpression.check(t)&&"left"===r)return a.default.strictEqual(t.left,n),!0;if(s.ArrowFunctionExpression.check(t)&&"body"===r)return a.default.strictEqual(t.body,n),!0;if(s.SequenceExpression.check(t)&&"expressions"===e&&0===r)a.default.strictEqual(t.expressions[0],n);else if(s.CallExpression.check(t)&&"callee"===r)a.default.strictEqual(t.callee,n);else if(s.MemberExpression.check(t)&&"object"===r)a.default.strictEqual(t.object,n);else if(s.ConditionalExpression.check(t)&&"test"===r)a.default.strictEqual(t.test,n);else if(p(t)&&"left"===r)a.default.strictEqual(t.left,n);else{if(!s.UnaryExpression.check(t)||t.prefix||"argument"!==r)return!1;a.default.strictEqual(t.argument,n)}}return!0},t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9),i=r(43),a=r(22);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cell=t}var t,r,s;return t=e,(r=[{key:"renderFormat",value:function(e,t,r,i,a){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(e.format))return{cellText:"",state:!1};var o=this.cell,s="";if(e.format){var l=i.tryParseToNum(o,t,r);return l.state?a?"date"===l.style||"datetime"===l.style?s=l.text:l.state=!1:s=l.text:(!1===(0,n.isHave)(o.text)&&(o.text=""),s=o.text),{cellText:s,state:l.state}}return{cellText:s,state:!1}}},{key:"getCellDataType",value:function(e,t){var r=t.isDate,o=t.isNumber,s=this.cell,l=!0;(0,n.isHave)(s.formulas)||(s.formulas=""),(0,n.isHave)(s.text)||(s.text="");var u=""!==s.formulas?s.formulas+"":s.text+"",c=1*(u=u.replace(/,/g,""));return!c&&0!==c||"number"!=typeof c||isNaN(c)||!0!==/^\d+$/.test(u)?u&&!0===l&&(0,i.isFormula)(u)?(l=!0,o=!1,r=!1,s.type="na"):u&&-1!==u.search((0,a.str2Re)(a.datePattern2),"")?(!0===r?(l=!1,o=!1,r=!0):(l=!1,o=!1,r=!1),s.type="date"):(l=!1,o=!1,r=!1,s.type="other"):(!0===o?(o=!0,l=!1,r=!1):(l=!1,o=!1,r=!1),s.type="number"),s.tmp=u,e.push(s),{nA:l,isDate:r,isNumber:o}}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="move"}var t,r,i;return t=e,(r=[{key:"move",value:function(e){return this.range=e,this.state="move",this}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.selectorHeightBorderWidth=void 0;var n=r(0),i=r(1),a=r(6),o=r(8),s=r(4),l=r(7),u=f(r(156)),c=f(r(30));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e}t.selectorHeightBorderWidth=3;var m=10,v=function(){function e(t,r,a){d(this,e),this.cornerEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-corner")),this.data=t,this.sheet=a,this._selector=r,this.l=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l")),this.r=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-r")),this.t=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-t")),this.b=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-b")),this.cornerEl.on("mousedown",(function(e){2===e.detail&&(a.clickCopyPaste(),e.stopPropagation())})),this.boxinner=(0,n.h)("div","".concat(i.cssPrefix,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.areaEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-area")).children(this.cornerEl,this.boxinner).hide(),this.clipboardEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-clipboard")).hide(),this.autofillEl=(0,n.h)("div","".concat(i.cssPrefix,"-selector-autofill")).hide(),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-selector")).css("z-index","".concat(m)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),m+=1}return p(e,[{key:"border",value:function(e){this.areaEl.css("border",e)}},{key:"longTimeBefore",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.boxinner.hide(),setTimeout((function(){e.boxinner.show()}),t)}},{key:"moveEvent",value:function(e){console.log(60);var t=this.data,r=this._selector,n=this.sheet,i=t.selector,u=r.range,f=u.sri,d=u.sci,h=u.eri,p=u.eci,m=u.w,v=u.h,y=new a.CellRange(f,d,h,p,m,v),g=new a.CellRange(f,d,h,p,m,v),E=n.selectorMoveEl;E.set(-1,-1,!0),E.hide(),(0,o.mouseMoveUp)(window,(function(e){n.container.css("pointer-events","none"),r.setBoxinner("none");var i=t.getCellRectByXY(e.layerX,e.layerY),o=i.ri,s=i.ci;if(-1!==o&&-1!==s){(g=new a.CellRange(f,d,h,p,m,v)).move(o,s);var l=t.getMoveRect(g);E.range=g,E.setMove(l),E.el.show()}}),(function(){var e=t.rows,a=[],o=[],u=[];y.each((function(t,r){console.log(e.getCell(t,r),t,r);var n=e.getCell(t,r),i=new c.default(t,r,(0,l.deepCopy)(n||{}),"".concat((0,s.xy2expr)(r,t),":").concat((0,s.xy2expr)(r,t))),o=new c.default(t,r,(0,l.deepCopy)(n||{}),"".concat((0,s.xy2expr)(r,t)));a.push(i),u.push(o)})),g.each((function(t,r){var n=new c.default(t,r,(0,l.deepCopy)(e.getCell(t,r)||{}),(0,s.xy2expr)(r,t));o.push(n)})),t.cutPaste(y,g,!1),n.container.css("pointer-events","auto"),r.setBoxinner("auto"),E.hide();var f=t.getMoveRect(g);i.range=g,i.ci=g.sci,i.ri=g.sri,r.indexes=[i.ri,i.ci],r.moveIndexes=[g.sri,g.sci],r.range=g,r.setMove(f),n.selector.selectCell.setData(g.sri,g.sci),console.time("move"),e.moveChange(a,o,u),console.timeEnd("move"),n.selectorMoveReset()}))}},{key:"setCss",value:function(e){this.areaEl.css("border","2px dashed ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.cornerEl.css("pointer-events",e)}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-3+.8,height:i-3+.8,left:t,top:r}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-3,height:i-3,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function y(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,s=e.l,l=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>s&&(f-=o.x);var d=n-c;return c>l&&(d-=o.y),{left:f,top:d,width:i,height:a}}function g(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalWidth(),u=r-l;return l>a&&(u-=s.x),{left:u,top:o,width:n,height:i}}function E(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalHeight(),u=r-l;return l>o&&(u-=s.y),{left:a,top:u,width:n,height:i}}function b(e){this.br.setAreaOffset(y.call(this,e))}function x(e){this.tl.setAreaOffset(e)}function A(e){this.t.setAreaOffset(g.call(this,e))}function S(e){this.l.setAreaOffset(E.call(this,e))}function w(e){this.l.setClipboardOffset(E.call(this,e))}function R(e){this.br.setClipboardOffset(y.call(this,e))}function C(e){this.tl.setClipboardOffset(e)}function T(e){this.t.setClipboardOffset(g.call(this,e))}function O(e){b.call(this,e),x.call(this,e),A.call(this,e),S.call(this,e)}function _(e){R.call(this,e),C.call(this,e),T.call(this,e),w.call(this,e)}var D=function(){function e(t,r){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];d(this,e),this.data=t,this.br=new v(t,this,r),this.t=new v(t,this,r),this.l=new v(t,this,r),this.tl=new v(t,this,r),this.sheet=r,this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,n.h)("div","".concat(i.cssPrefix,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),a?(this.selectCell=new u.default(t,a),this.el.child(this.selectCell.el)):this.selectCell=new u.default(t,a),this.lastri=-1,this.lastci=-1,m+=1}return p(e,[{key:"longTimeBefore",value:function(){this.tl.longTimeBefore(),this.br.longTimeBefore(),this.t.longTimeBefore(),this.l.longTimeBefore()}},{key:"setCss",value:function(e){this.br.setCss(e),this.t.setCss(e),this.l.setCss(e),this.tl.setCss(e)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br;this.selectCell.resetSelectOffset();var a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();O.call(this,e),_.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();b.call(this,e),A.call(this,e),R.call(this,t),T.call(this,t),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();b.call(this,e),S.call(this,e),R.call(this,t),w.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();b.call(this,t),S.call(this,t),R.call(this,r),w.call(this,r),this.resetOffset()}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var s=e,l=t;e<0&&(s=0),t<0&&(l=0),n.selector.setIndexes(s,l),this.indexes=[s,l]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"autoFilterRef",value:function(){console.log(this.range)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this.data);r&&(this.lastri=e,this.lastci=t),this.range=n.calSelectedRangeByEnd(e,t),O.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"reset",value:function(){var e=this.data.selector.range,t=e.eri,r=e.eci,n=e.sci,i=e.sri;this.set(i,n),this.setEnd(t,r,!0,!0)}},{key:"setMove",value:function(e){O.call(this,e)}},{key:"showAutofill",value:function(e,t,r){if(-1!==e||-1!==t){var n=this.range,i=n.sri,o=n.sci,s=n.eri,l=n.eci,u=0,c=e,f=t;if(2===r)u=11,this.arange=new a.CellRange(i,f,s,o-1);else if(4===r)u=22,this.arange=new a.CellRange(c,o,i-1,l);else if(3===r)u=33,this.arange=new a.CellRange(i,l+1,s,f);else{if(1!==r)return this.arange=null,u;u=44,this.arange=new a.CellRange(s+1,o,c,l)}if(null!==this.arange){var d=this.data.getRect(this.arange);d.width+=2,d.height+=2;var h=this.br,p=this.l,m=this.t,v=this.tl;h.showAutofill(y.call(this,d)),p.showAutofill(E.call(this,d)),m.showAutofill(g.call(this,d)),v.showAutofill(d)}return u}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();_.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();t.default=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=r(8),o=r(1),s=(n=r(6))&&n.__esModule?n:{default:n};function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){e.preventDefault(),e.stopPropagation();var t=this.filterItems;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1,this.el.el.scrollTop=this.el.el.scrollHeight),this.el.el.scrollTop=33*(this.itemIndex-9),t[this.itemIndex].toggle())}function f(e){e.stopPropagation();var t=this.filterItems;t.length<=0||t.length<this.itemIndex||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0,this.el.el.scrollTop=0),this.el.el.scrollTop=33*(this.itemIndex-9),console.log(t.length),t[this.itemIndex].toggle())}function d(e){e.preventDefault();var t=this.filterItems;if(!(t.length<=0)){if(e.stopPropagation(),this.itemIndex<0)return this.itemIndex=0,this.hide(),void a.createEvent.call(this,13,!1);t[this.itemIndex].el.click(),this.hide()}}function h(e){var t=e.keyCode;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:e.stopPropagation();break;case 38:c.call(this,e),e.stopPropagation();break;case 39:e.stopPropagation();break;case 40:f.call(this,e),e.stopPropagation();break;case 13:case 9:d.call(this,e);break;default:e.stopPropagation()}}var p=function(){function e(t,r,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"200px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterItems=[],this.items=t,this.data=n,this.editor=a,this.el=(0,i.h)("div","".concat(o.cssPrefix,"-suggest")).css("width",s).css("overflow-y","auto").css("max-height","306px").hide(),this.el.attr("tabindex",0),this.itemClick=r,this.itemIndex=-1,this.show=!1}var t,r,n;return t=e,(r=[{key:"setOffset",value:function(e){this.el.cssRemoveKeys("top","bottom").offset(e)}},{key:"hide",value:function(){var e=this.el;this.filterItems=[],this.itemIndex=-1,e.hide(),this.show=!1,(0,a.unbindClickoutside)(this.el.parent())}},{key:"setItems",value:function(e){this.items=e}},{key:"search",value:function(e){var t,r=this,n=this.items,u=this.data,c=this.editor;if(/^\s*$/.test(e)||(n=n.filter((function(t){return(t.key.toUpperCase()||t.toUpperCase()).startsWith(e.toUpperCase())}))),n=n.map((function(e){var t=e.title;t?"function"==typeof t&&(t=t()):t=e;var n=(0,i.h)("div","".concat(o.cssPrefix,"-item")).child(t).on("click.stop",(function(){r.itemClick(e)}));return e.label&&n.child((0,i.h)("div","label").html(e.label)),n})),this.filterItems=n,n.length<=0)return this.hide(),void(this.show=!1);var f=this.el,d=u.getRect(new s.default(c.ri,c.ci,c.ri,c.ci)),h=d.left+55,p=d.top+50;n.length>=9&&d.top-306>=50&&(p-=306,p-=d.height),f.css("left","".concat(h,"px")),f.css("top","".concat(p,"px")),(t=f.html("")).children.apply(t,l(n)).show(),this.show=!0,(0,a.bindClickoutside)(f.parent(),(function(){r.hide(),r.show=!1}))}},{key:"bindInputEvents",value:function(e){var t=this;e.on("keydown",(function(e){return h.call(t,e)}))}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectorColor=function(e){return e%=l.length,{color:l[e],index:e}},t.default=void 0;var n=r(0),i=r(1);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],s=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],l=["#EE0000","#8A2BE2","#FF3E96","#8B4500","#3A5FCD","#FF7F24"];var u=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function c(e){var t=this,r=(0,n.h)("div","".concat(i.cssPrefix,"-color-palette-cell")).on("click.stop",(function(){return t.change(e)})).css("background-color",e);return this.items.push(r),(0,n.h)("td","").child(r)}t.default=function e(){var t,r,l,f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-color-palette")),this.change=function(){},this.items=[];var d=(0,n.h)("table","").children((t=(0,n.h)("tbody","")).children.apply(t,[(r=(0,n.h)("tr","".concat(i.cssPrefix,"-theme-color-placeholders"))).children.apply(r,a(o.map((function(e){return c.call(f,e)}))))].concat(a(s.map((function(e){var t;return(t=(0,n.h)("tr","".concat(i.cssPrefix,"-theme-colors"))).children.apply(t,a(e.map((function(e){return c.call(f,e)}))))}))),[(l=(0,n.h)("tr","".concat(i.cssPrefix,"-standard-colors"))).children.apply(l,a(u.map((function(e){return c.call(f,e)}))))])));this.el.child(d)}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._=[]}var t,r,i;return t=e,(r=[{key:"setData",value:function(e){this._=e}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(14)),i=o(r(12)),a=o(r(84));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e,r){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=new i.default(e).css("height","16px").css("border-bottom","3px solid ".concat(r)),s=new a.default;return s.change=function(e){n.setTitle(e),n.change(e)},(n=u(this,c(t).call(this,o,"auto",!1,"bottom-left",{type:!1},s.el))).colorPalette=s,n}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.css("border-color",e),this.hide()}}])&&l(r.prototype,n),o&&l(r,o),t}(n.default);t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=(n=r(12))&&n.__esModule?n:{default:n},o=r(1),s=r(8);function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r){var n,s=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title=t,this.el=(0,i.h)("div","".concat(o.cssPrefix,"-modal")).css("width",u).children((0,i.h)("div","".concat(o.cssPrefix,"-modal-header")).children(new a.default("close").on("click.stop",(function(){return s.hide()})),this.title),(n=(0,i.h)("div","".concat(o.cssPrefix,"-modal-content"))).children.apply(n,l(r))).hide(),this.open=!1}var t,r,n;return t=e,(r=[{key:"show",value:function(){var e=this;this.dimmer=(0,i.h)("div","".concat(o.cssPrefix,"-dimmer active")),document.body.appendChild(this.dimmer.el);var t=this.el.show().box(),r=t.width,n=t.height,a=document.documentElement,l=a.clientHeight,u=a.clientWidth;this.el.offset({left:(u-r)/2,top:(l-n)/3}),window.xkeydownEsc=function(t){27===t.keyCode&&e.hide()},this.open=!0,(0,s.bind)(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),this.open=!1,document.body.removeChild(this.dimmer.el),(0,s.unbind)(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountCopy=function(e){e.preventDefault();var t=a.call(this);if(t)return void(e.clipboardData&&(e.clipboardData.setData("text/html",s(t.img2)),e.clipboardData.setData("text/plain","")));var r=o.call(this);e.clipboardData&&(e.clipboardData.setData("text/html",s(r.html.el)),e.clipboardData.setData("text/plain",r.plain))},t.getChooseImg=a,t.sheetCopy=o;var n=r(0),i=r(7);function a(){var e=this.data.pasteDirectionsArr;if(this.direction=!1,e.length>0)for(var t=0;t<e.length;t++)if(!0===e[t].state)return this.container.css("pointer-events","auto"),e[t];return null}function o(){for(var e={plain:"",html:(0,n.h)("table","")},t=this.data,r=t.selector,a=t.rows,o=t.styles,s=r.range,l=s.sri,u=s.eri,c=s.sci,f=s.eci,d=(0,n.h)("tbody",""),h=l;h<=u;h+=1){for(var p=(0,n.h)("tr",""),m=c;m<=f;m+=1){var v=(0,n.h)("td","");if(a._[h]&&a._[h].cells&&a._[h].cells[m]){if(a._[h].cells[m]&&o[a._[h].cells[m].style]){if(v.css("color",o[a._[h].cells[m].style].color),o[a._[h].cells[m].style]&&o[a._[h].cells[m].style].font&&o[a._[h].cells[m].style].font.bold){var y=o[a._[h].cells[m].style].font.bold?"900":"";v.css("font-weight",y)}v.css("background",o[a._[h].cells[m].style].bgcolor)}a._[h].cells[m].text||(a._[h].cells[m].text=""),a._[h].cells[m].formulas||(a._[h].cells[m].formulas="");var g=""!==a._[h].cells[m].formulas?a._[h].cells[m].formulas:a._[h].cells[m].text;if(a._[h].cells[m].formulas&&(0,i.cutStr)(a._[h].cells[m].formulas,!1,!0).length>0){var E=(0,n.h)("reference","");E.html(g),E.attr("ri",h),E.attr("ci",m),v.child(E.el)}else v.html(g);e.plain+=g,e.plain+="\t"}else e.plain+="\t";p.child(v)}d.child(p),e.plain+="\n"}return e.html.child(d),e}function s(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(7),i=r(9),a=r(4);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e){for(var t=[],r=0;r<e.length;r++)(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].expr)&&t.push(e[r].expr),(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].cell)&&(0,i.isHave)(e[r].cell.depend)&&t.push.apply(t,s(e[r].cell.depend)),(0,i.isHave)(e[r])&&(0,i.isHave)(e[r].cell)&&(0,i.isHave)(e[r].cell.multivalueRefsCell)&&t.push(e[r].cell.multivalueRefsCell);return t}var u=function(){function e(t,r){var n=t.type,i=void 0===n?-1:n,a=t.action,o=void 0===a?"":a,s=t.ri,l=void 0===s?-1:s,u=t.ci,c=void 0===u?-1:u,f=t.oldData,d=void 0===f?"":f,h=t.newData,p=void 0===h?"":h,m=t.expr,v=void 0===m?"":m,y=t.oldStep,g=void 0===y?"":y,E=t.cellRange,b=void 0===E?"":E,x=t.cells,A=void 0===x?{}:x,S=t.height,w=void 0===S?-1:S,R=t.width,C=void 0===R?-1:R,T=t.oldCell,O=void 0===T?{}:T,_=t.newCell,D=void 0===_?{}:_,N=t.newMergesData,k=void 0===N?"":N,M=t.oldMergesData,I=void 0===M?"":M,P=t.property,F=void 0===P?"":P,L=t.value,j=void 0===L?"":L;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=i,this.action=o,this.ri=l,this.ci=c,this.expr=v,this.cellRange=b,this.cells=A,this.height=w,this.width=C,this.oldCell=O,this.newCell=D,this.oldMergesData=I,this.newMergesData=k,this.property=F,this.value=j,this.oldStep=g,this.oldData=d,this.newData=p,this.data=r}var t,r,i;return t=e,(r=[{key:"isRefresh",value:function(){return 999===this.type}},{key:"isDelete",value:function(){return 2===this.type}},{key:"findAllNeedCalcCell",value:function(){var e,t,r=[],i=this.oldCell,o=this.newCell,u=this.ri,c=this.ci;return(e=r).push.apply(e,s(l(i))),(t=r).push.apply(t,s(l(o))),-1!==u&&-1!==c&&r.push((0,a.xy2expr)(c,u)),r=(0,n.distinct)(r)}},{key:"restore",value:function(e,t,r){var i=this.type;if(1===i){var a=this.oldCell,o=this.newCell,s="";s=1===r?(0,n.deepCopy)(a):(0,n.deepCopy)(o);for(var l=0;l<s.length;l++){var u=s[l],c=u.cell,f=u.ri,d=u.ci;e.rows.setCellText(f,d,c,"cell")}}else if(13===i){var h=this.oldData,p=this.newData,m="";m=1===r?(0,n.deepCopy)(p):(0,n.deepCopy)(h),e.setData(m)}else if(2===i||5===i||6===i||11===i||12===i){var v=this.newCell,y=this.oldCell,g=this.oldMergesData,E=this.newMergesData,b=(this.cellRange,this.property),x=(this.value,"");x=1===r?(0,n.deepCopy)(y):(0,n.deepCopy)(v),"merge"===b&&(1===r?this.data.merges.setData(g):this.data.merges.setData(E));for(var A=0;A<x.length;A++){var S=x[A],w=S.cell,R=S.ri,C=S.ci;e.rows.setCellText(R,C,w,"cell")}}else if(3===i){var T=this.ri,O=this.height,_=this.oldStep;1===r?e.rows.setHeight(T,_.height):e.rows.setHeight(T,O)}else if(4===i){var D=this.ci,N=this.width,k=this.oldStep;1===r?e.cols.setWidth(D,k.width):e.cols.setWidth(D,N)}}}])&&o(t.prototype,r),i&&o(t,i),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){this.register=function(r){r.addEventListener("mousedown",(function(n){if(0===n.button){var i=n.clientX,a=n.clientY,o=r.offsetLeft,s=r.offsetTop;e&&e.onBegin&&e.onBegin.call(r,{left:i-o,top:a-s});var l=!0;r.style.cursor="move";var u=i,c=a;window.onmousemove=function(t){if(l){var n=t.clientX,f=t.clientY;return u=n-(i-o),c=f-(a-s),r.style.left=u>0?u+"px":"0px",r.style.top=c>0?c+"px":"0px",e&&e.onDrag&&e.onDrag.call(r,{left:u,top:c,x:n-i,y:f-a,isDown:l}),!1}},window.onmouseup=function(){return l=!1,r.style.cursor="default",e&&e.onEnd&&e.onEnd.call(r,{left:parseInt(r.style.left),top:parseInt(r.style.top)},t),!1},n.stopPropagation?n.stopPropagation():n.preventDefault&&n.preventDefault()}}))}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.spreadsheet=void 0;var n=r(0),i=f(r(92)),a=f(r(47)),o=r(1),s=r(10);r(199);var l=f(r(200)),u=r(201),c=f(r(90));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sheet1";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var c=t;"string"==typeof t&&(c=document.querySelector(t)),this.locale("zh-cn",l.default),this.data=new i.default(u,r,s);var f=(0,n.h)("div","".concat(o.cssPrefix)).on("contextmenu",(function(e){return e.preventDefault()}));c.appendChild(f.el),this.sheet=new a.default(f,this.data),this.data.belongSheet=this.sheet}var t,r,u;return t=e,u=[{key:"locale",value:function(e,t){(0,s.locale)(e,t)}}],(r=[{key:"setDataSettings",value:function(e){this.data.settings.showEditor=e}},{key:"loadData",value:function(e){return this.sheet.loadData(e),this}},{key:"getData",value:function(){return this.data.getData()}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(e){return this.data.change=e,this}},{key:"locale",value:function(e,t){(0,s.locale)(e,t)}},{key:"insertRows",value:function(e){this.sheet.insertRows(e)}},{key:"initFinancialCellFooter",value:function(){var e=Vue.extend({template:'<div id="foot-container" @click.stop @mousedown.stop @mouseup.stop @keydown.stop @keyup.stop @copy.stop @paste.stop\n             style="height: 1000px; display: none; width: 100%; position: absolute; ">\n                  <div style="color: #222; float: left; padding: 6px 0 0 45px; direction: ltr;">\n                      <div @click.stop="textInputClick"\n                           class="foot-container-btn"\n                           style="display: inline-block; -webkit-box-shadow: none;-moz-box-shadow: none;box-shadow: none; font-family: \'Google Sans\',Roboto,RobotoDraft,Helvetica,Arial,sans-serif;font-weight: 500; background-color: #f5f5f5;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;cursor: default;font-size: 11px;font-weight: bold;text-align: center;white-space: nowrap;margin-right: 16px;height: 27px;line-height: 27px;min-width: 54px;outline: 0px;padding: 0 8px;background-image: -webkit-linear-gradient(top,#f5f5f5,#f1f1f1);background-image: -moz-linear-gradient(top,#f5f5f5,#f1f1f1);background-image: -ms-linear-gradient(top,#f5f5f5,#f1f1f1);background-image: -o-linear-gradient(top,#f5f5f5,#f1f1f1);background-image: linear-gradient(top,#f5f5f5,#f1f1f1);color: #333;border: 1px solid #dcdcdc;border: 1px solid rgba(0,0,0,0.1);">\n                          添加\n                      </div>\n                      <input class="textinput addRowsInput" type="text" v-model="inputValue"\n                             style="-webkit-border-radius: 1px; width: 60px; width: 60px; -moz-border-radius: 1px; border-radius: 1px; border: 1px solid #d9d9d9; border-top: 1px solid #c0c0c0; font-size: 13px; height: 25px; padding: 1px 8px;"\n                             aria-label="要添加的行数">\n                      <div class="addRowsText goog-inline-block"\n                           style="display: inline-block; color: #000000; padding-top: 5px; vertical-align: middle; font-weight: normal; font-size: 13px;">\n                          行（在底部添加）。\n                      </div>\n                      <div v-if="msg !== \'\'" class="addRowsText goog-inline-block"\n                           style="display: inline-block; color: red; font-weight: 500; padding-top: 5px; vertical-align: middle; font-weight: normal; font-size: 13px;">\n                          {{msg}}\n                      </div>\n                  </div>\n              </div>',data:function(){return{inputValue:10,msg:"",maxRows:0,total:5e3}},methods:{textInputClick:function(){isNaN(this.inputValue)?this.msg="请输入数字":(console.log(xs.data.settings.row.len),this.maxRows=this.total-xs.data.rows.len,this.maxRows<=0?this.msg="超出最大单元格数量":1*this.inputValue>this.maxRows?this.msg="请输入"+this.maxRows+"行内的数值":(xs.insertRows(this.inputValue),this.msg=""))}}}),t=this.sheet.overlayerEl.el,r=(new e).$mount();this.sheet.footEl=r.$el,t.appendChild(r.$el)}},{key:"getText",value:function(e,t,r){for(var n=this.sheet,i=n.selectors,a=n.data,o=n.table,s="",l=0;l<i.length;l++)s+=i[l].erpx;return a.getCellByExpr(s,o,e,t,r)}},{key:"removeEvent",value:function(){this.sheet.removeEvent()}}])&&d(t.prototype,r),u&&d(t,u),e}(),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new h(e,t)};t.spreadsheet=p,window&&(window.drag=c.default,window.x=window.x||{},window.bugout=u.bugout,window.x.spreadsheet=p,window.x.spreadsheet.locale=function(e,t){return(0,s.locale)(e,t)})},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(34),a=N(r(114)),o=N(r(115)),s=N(r(116)),l=N(r(117)),u=r(118),c=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=D();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}r.default=e,t&&t.set(e,r);return r}(r(16)),f=r(9),d=r(43),h=r(150),p=r(151),m=r(6),v=r(4),y=r(10),g=N(r(81)),E=r(0),b=r(46),x=(r(48),r(7)),A=N(r(65)),S=r(196),w=r(49),R=N(r(197)),C=N(r(80)),T=N(r(30)),O=N(r(198)),_=N(r(85));function D(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return D=function(){return e},e}function N(e){return e&&e.__esModule?e:{default:e}}function k(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var P={view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},formula:{},showGrid:!0,showToolbar:!0,showContextmenu:!0,showEditor:!0,autoLoad:!0,ignore:[],cellWidth:0,ignoreRi:0,minus:!1,footerContainerHeight:0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:10},rowsInit:!1,style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,flexible:!1,underline:!1,autoAdapt:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1}}};function F(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!t)return!1;var n=this.merges,i=t.clone(),a=I(e.size(),2),o=a[0],s=a[1],l=I(t.size(),2),u=l[0],c=l[1];return o>u&&(i.eri=t.sri+o-1),s>c&&(i.eci=t.sci+s-1),!n.intersects(i)||(r((0,y.t)("error.pasteForMergedCell")),!1)}function L(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,a=this.merges;"all"!==r&&"format"!==r||(i.deleteCells(t,r),a.deleteWithin(t)),i.copyPaste(e,t,r,n,(function(e,t,r){if(r&&r.merge){var n=I(r.merge,2),i=n[0],o=n[1];if(i<=0&&o<=0)return;a.add(new m.CellRange(e,t,e+i,t+o))}}))}function j(e,t,r){var n=this.clipboard,i=this.rows,a=this.merges;i.cutPaste(e,t),a.move(e,t.sri-e.sri,t.sci-e.sci),r&&n.clear()}function B(e,t,r){var n=this.styles,i=this.rows.getCellOrNew(e,t),a={};(0,f.isHave)(i.style)&&(a=c.cloneDeep(n[i.style])),Object.assign(a,{border:r}),i.style=this.addStyle(a)}function U(e,t,r,n){if(-1===e||-1===t)return{state:!0,msg:"单元格坐标有误"};if("style"!==n&&(!r||"="!==r[0]))return{state:!1,msg:"正确"};var i=V.call(this,r);return"style"!==n&&!0===i.state?{msg:i.msg,state:!0}:{msg:i.msg,state:!1}}function V(e){var t=!1,r="";try{new A.default(e).parse()}catch(e){r="您输入的公式存在问题，请更正, 错误原因: "+e.description,t=!0}return!0===t&&!1===(0,x.isLegal)(e)&&(r="缺少左括号或右括号",t=!0),t?{state:!0,msg:r}:{state:!1,msg:r}}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"to",r=arguments.length>2?arguments[2]:void 0;if("to"===t){for(var n=[],i=0;i<e.length;i++){var a=e[i];console.log(a);var o={src:a.img2.src,ri:a.ri,ci:a.ci,top:a.top,left:a.left,range:a.range,offsetLeft:a.offsetLeft,offsetTop:a.offsetTop,nextLeft:a.nextLeft,nextTop:a.nextTop,img:a.img,arr:a.arr,img2:a.img2};n.push(o)}return n}if("from"===t){if("string"==typeof r)return;for(var s=0;s<e.length;s++){var l=e[s],u=(0,E.h)("img","");u.el.src=l.src,b.mountImg.call(r,u.el,!0,l.ri,l.ci,l.range)}}}function z(e,t){for(var r=this.rows,n=e+1,i=!0;i;){var a=r.getCellOrNew(n,t);a&&a.text?n+=1:i=!1}return n}function X(e){var t=this,r=e.mode,n=e.style,i=e.color,a=this.styles,o=this.selector,s=this.rows,l=o.range,u=l.sri,f=l.sci,d=l.eri,h=l.eci,p=!this.isSignleSelected();if(p||"inside"!==r&&"horizontal"!==r&&"vertical"!==r){for(var m=u;m<=d;m+=1)for(var v=f;v<=h;v+=1)B.call(this,m,v,{});if("outside"!==r||p){if("none"===r)o.range.each((function(e,r){var n=s.getCell(e,r);if(n&&void 0!==n.style){var i=c.cloneDeep(a[n.style]);delete i.border,n.style=t.addStyle(i)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)!function(){for(var e=[],a=u;a<=d;a+=1)for(var o=f;o<=h;o+=1){for(var l=[],c=0;c<e.length;c+=1){var m=I(e[c],4),v=m[0],y=m[1],g=m[2],E=m[3];if(a===v+g+1&&l.push(c),v<=a&&a<=v+g&&o===y){o+=E+1;break}}if(l.forEach((function(t){return e.splice(t,1)})),o>h)break;var b=s.getCell(a,o),x=0,A=0;if(b&&b.merge){var S=I(b.merge,2);x=S[0],A=S[1],e.push([a,o,x,A])}var w=x>0&&a+x===d,R=A>0&&o+A===h,C={};"all"===r?C={bottom:[n,i],top:[n,i],left:[n,i],right:[n,i]}:"inside"===r?(!R&&o<h&&(C.right=[n,i]),!w&&a<d&&(C.bottom=[n,i])):"horizontal"===r?!w&&a<d&&(C.bottom=[n,i]):"vertical"===r?!R&&o<=h&&(C.right=[n,i]):"outside"===r&&p&&(u===a&&(C.top=[n,i]),(w||d===a)&&(C.bottom=[n,i]),f===o&&(C.left=[n,i]),(R||h===o)&&(C.right=[n,i])),Object.keys(C).length>0&&B.call(t,a,o,C),o+=A}}();else if("top"===r||"bottom"===r)for(var y=f;y<=h;y+=1)"top"===r&&(B.call(this,u,y,{top:[n,i]}),y+=s.getCellMerge(u,y)[1]),"bottom"===r&&(B.call(this,d,y,{bottom:[n,i]}),y+=s.getCellMerge(d,y)[1]);else if("left"===r||"right"===r)for(var g=u;g<=d;g+=1)"left"===r&&(B.call(this,g,f,{left:[n,i]}),g+=s.getCellMerge(g,f)[0]),"right"===r&&(B.call(this,g,h,{right:[n,i]}),g+=s.getCellMerge(g,h)[0])}else B.call(this,u,f,{top:[n,i],bottom:[n,i],left:[n,i],right:[n,i]})}}function q(e,t){var r=this.rows,n=this.freezeTotalHeight(),i=r.height;n+r.height<e&&(i-=t);for(var a=this.exceptRowSet,o=0,s=i,l=r.height;o<r.len&&!(s>e);o+=1)a.has(o)||(s+=l=r.getHeight(o));return(s-=l)<=0?{ri:-1,top:0,height:l}:{ri:o-1,top:s,height:l}}function W(e,t){var r=this.cols,n=this.freezeTotalWidth(),i=r.indexWidth;n+r.indexWidth<=e&&(i-=t);var a=I(c.rangeReduceIf(0,r.len,i,r.indexWidth,e,(function(e){return r.getWidth(e)})),3),o=a[0],s=a[1],l=a[2];return s<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:o-1,left:s,width:l}}function G(e,t,r){var n=e.text,i=e.formula,a=t.symbol,o=t.position;if(!(0,f.isHave)(n)||!(0,c.isNumber)(n))return null;var s=r((0,w.formatNumberRender)(n,-1));return i=(0,d.isFormula)(i)?i:s,isNaN(s)?null:{text:"begin"===o?a+s:s+a,value:n,formulas:i}}function Y(e,t,r){return J.call(this,t,r,e)}function J(e,t,r){var n=this.rows,i=this.getCellStyle(e,t),a=(0,S.dateDiff)(r.text),o=a.isValid,s=a.diff,l=n.getCellStyleConvert(i,o);if("number"===l){var u=r.text,h=r.formulas,p={};return p=o?{text:s.toFixed(2),formulas:h}:{text:u=(0,w.formatNumberRender)(u,2),value:r.text,formulas:h},(0,f.isHave)(p.text)&&(0,c.isNumber)(p.text)?{state:!0,style:l,text:p.text,cell:p}:{state:!1,style:l,text:p.text,cell:p}}if("date"===l||"datetime"===l){var m=r.text;if(!o){var v=(0,S.formatDate)(m),y=v.state,g=v.date;o=y,s=r.text,m=g}return o&&"datetime"===l&&(m=(0,S.changeFormat)((0,S.formatDate)((0,S.dateDiff)(m).diff).date)),{state:o,style:l,text:(0,f.isHave)(i)?m:s}}if("normal"===l){if(o){var E=s,b=r.formulas,x={formulas:n.toString(b),text:n.toString(E)};return{state:!0,text:x.text,style:l,cell:x}}var A=r.text,R={formulas:r.formulas,text:A};return{state:!0,style:l,text:R.text,cell:R}}if("rmb"===l){var C="",T="";o?(C=s,T=(0,d.isFormula)(r.formulas)?r.formulas:s):(C=(0,w.formatNumberRender)(r.text,0),T=r.formulas);var O=G({text:C,formula:T},{symbol:"￥",position:"begin"},(function(e){return e}));if(O)return{state:!0,style:l,text:O.text,cell:O}}else if("percent"===l){var _="",D="";o?(_=s,D=(0,d.isFormula)(r.formulas)?r.formulas:s):(_=n.useOne(r.value,r.text),D=r.formulas);var N=G({text:_,formula:D},{symbol:"%",position:"end"},(function(e){return Number(100*e).toFixed(2)}));if(N)return{state:!0,style:l,text:N.text,cell:N}}return{state:!1,style:l,text:r.text,cell:{}}}var $=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=c.merge(P,r||{}),this.name=t||"belongSheet",this.methods=n,this.freeze=[0,0],this.styles=[],this.merges=new u.Merges,this.rows=new d.Rows(this.settings.row,this),this.cols=new h.Cols(this.settings.col),this.validations=new p.Validations,this.hyperlinks={},this.comments={},this.showEquation=!1,this.calc=new i.calc.Calc,this.pasteDirectionsArr=[],this.changeDataForCalc=null,this.chart=new _.default,this.multiPreAction=new R.default(this),this.selector=new a.default,this.scroll=new o.default,this.clipboard=new s.default,this.moved=new g.default,this.autoFilter=new l.default,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var t,r,n;return t=e,(r=[{key:"addValidation",value:function(e,t,r){var n=this;this.changeData((function(){n.validations.add(e,t,r)}))}},{key:"removeValidation",value:function(){var e=this,t=this.selector.range;this.changeData((function(){e.validations.remove(t)}))}},{key:"tryParseToNum",value:function(e,t,r){return Y.call(this,e,t,r)}},{key:"clickCopyPaste",value:function(){var e=this.selector.range.eri,t=this.selector.range.eci,r=this.rows,n=r.getCellOrNew(e,t),i=r.getCellOrNew(e+1,t);if(!n||!n.text||i&&i.text)return{enter:!1};for(var a=z.call(this,e,t-1),o=z.call(this,e,t+1),s=a<o?o:a,l=!1,u=1;u<s&&!1===l;u++){var c=r.getCellOrNew(e+u,t);c&&c.text&&(s=e+u,l=!0)}return{enter:!0,dstCellRange:new m.CellRange(e+1,t,s-1,t),srcCellRange:new m.CellRange(e,t,e,t)}}},{key:"getSelectedValidation",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=e.range,i=this.validations.get(t,r),a={ref:n.toString()};return null!==i&&(a.mode=i.mode,a.validator=i.validator),a}},{key:"canUndo",value:function(){return this.multiPreAction.getItems(1).length>0}},{key:"canRedo",value:function(){return this.multiPreAction.getItems(2).length>0}},{key:"undo",value:function(){this.multiPreAction.undo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"historyList",value:function(e){return this.multiPreAction.getItems(e)}},{key:"redo",value:function(){this.multiPreAction.redo(),this.changeDataForCalc=this.getChangeDataToCalc()}},{key:"copy",value:function(){document.execCommand("copy",!0),this.clipboard.copy(this.selector.range)}},{key:"makeCellPropArr",value:function(e,t,r){for(var n=[],i=this.rows.eachRange(e),a=0;a<i.length;a++){var o=i[a],s=o.ri,l=o.ci,u=o.cell;if((0,f.isHave)(u)&&!1===(0,f.isHave)(u.style)){var c=this.defaultStyle();u.style=this.addStyle(c)}var d=new T.default(s+t,l+r,u,(0,v.xy2expr)(s+t,l+r));n.push(d)}return n}},{key:"setCellByCellProp",value:function(e,t){for(var r=this.rows,n=0;n<e.length;n++){var i=e[n],a=i.ri,o=i.ci,s=i.cell;(0,f.isHave)(s)&&(0,f.isHave)(s.style)&&r.setCell(a,o,s,"style"),t(a,o)}}},{key:"paintFormatChange",value:function(e){var t=this;this.changeData((function(){var r=t.clipboard,n=t.selector,i=r.range,a=n.ri,o=n.ci,s=a-i.sri,l=o-i.sci,u=t.makeCellPropArr(i,s,l);if(n.range.eri-n.range.sri==0&&n.range.eci-n.range.sci==0)t.setCellByCellProp(u,e);else{var c=new O.default(i,n.range),f=c.getPaintType(),d=c.makePaintArr(f,u);t.setCellByCellProp(d,e)}}),{type:12,cellRange:this.selector.range})}},{key:"move",value:function(){this.moved.move()}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(e){this.changeData((function(){}),{type:6,cellRange:e})}},{key:"autofill",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!F.call(this,i,e,n)&&(this.changeData((function(){L.call(r,i,e,t,!0)}),{type:5,cellRange:e}),!0)}},{key:"clickAutofill",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return!!F.call(this,e,t,i)&&(this.changeData((function(){L.call(n,e,t,r,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges,o=r.range,s=o.sri,l=o.sci,u=o.eri,c=o.eci,f=r.ri,d=r.ci,h=e,p=t;return e<0&&(h=n.len-1),t<0&&(p=i.len-1),h<=f?(s=h,u=f):u=h,p<=d?(l=p,c=d):c=p,r.range=a.union(new m.CellRange(s,l,u,c)),r.range}},{key:"calSelectedRangeByStart",value:function(e,t){var r=this.selector,n=this.rows,i=this.cols,a=this.merges.getFirstIncludes(e,t);return null===a&&(a=new m.CellRange(e,t,e,t),-1===e&&(a.sri=0,a.eri=n.len-1),-1===t&&(a.sci=0,a.eci=i.len-1)),r.range=a,a}},{key:"setSelectedCellAttr",value:function(e,t){var r=this;this.changeData((function(){var n=r.selector,i=r.styles,a=r.rows;if("merge"===e)t?r.merge():r.unmerge();else if("border"===e)X.call(r,t);else if("cellFormulaProxy"===e){var o=a.getCellOrNew(n.ri,n.ci);o.text="=".concat(t,"()"),o.formulas="=".concat(t,"()")}else n.range.each((function(n,o){var s=a.getCellOrNew(n,o),l={};if((0,f.isHave)(s.style)&&(l=c.cloneDeep(i[s.style])),"format"===e)l.format=t,a.setCellText(n,o,{text:s.text,style:r.addStyle(l)},"format");else if("font-bold"===e||"font-italic"===e||"font-name"===e||"font-size"===e){var u={};u[e.split("-")[1]]=t,l.font=Object.assign(l.font||{},u),s.style=r.addStyle(l)}else"flexible"===e?(r.exceptRowSet.has(n+1)&&r.exceptRowSet.has(n+2)&&!r.exceptRowSet.has(n+3)?(r.exceptRowSet.delete(n),r.exceptRowSet.delete(n+1),r.exceptRowSet.delete(n+2)):(r.exceptRowSet.add(n),r.exceptRowSet.add(n+1),r.exceptRowSet.add(n+2)),l[e]=t,s.style=r.addStyle(l)):"strike"!==e&&"textwrap"!==e&&"underline"!==e&&"align"!==e&&"valign"!==e&&"color"!==e&&"bgcolor"!==e||(l[e]=t,s.style=r.addStyle(l))}))}),{type:11,cellRange:this.selector.range,property:e,value:t})}},{key:"setSelectedCellText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.selector,n=r.ri,i=r.ci,a=n;this.unsortedRowMap.has(n)&&(a=this.unsortedRowMap.get(n)),this.setCellText(a,i,{text:e},t),this.resetAutoFilter()}},{key:"setSelectedCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.setCellAll(n,i,e,r,t),this.resetAutoFilter()}},{key:"getSelectedCell",value:function(){var e=this.selector,t=e.ri,r=e.ci,n=t;return this.unsortedRowMap.has(t)&&(n=this.unsortedRowMap.get(t)),this.rows.getCell(n,r)}},{key:"editorChangeToHistory",value:function(e,t,r){var n=t.ri,i=t.ci;if(-1===n||-1===i)return{state:!1};var a=this.rows.getCell(n,i),o=this.multiPreAction,s=(0,v.xy2expr)(i,n),l=o.getStepType(r,{ri:n,ci:i,expr:s,text:a.text}),u=new T.default(n,i,e,s),c=new T.default(n,i,a,s);return o.addStep(l,{oldCell:[u],newCell:[c]}),this.changeDataForCalc=this.getChangeDataToCalc(),{state:!0}}},{key:"changeToHistory",value:function(e,t){var r=e.ri,n=e.type,i=e.ci,a=e.cellRange,o=e.property,s=e.value,l=e.oldCell,u=e.oldMergesData;if(-1===n)return{state:!1};var c=this.multiPreAction,f=this.selector,d=c.getStepType(n,{expr:"",property:o,value:s,oldCell:l,range:f.range,ri:r,ci:i,cellRange:a});return c.addStep(d,{oldCell:l,oldMergesData:u,newMergesData:this.merges.getData(),oldStep:t}),{state:!0}}},{key:"getSelectedCellRiCi",value:function(e,t){var r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,t)}},{key:"xyInSelectedRect",value:function(e,t){var r=this.getSelectedRect(),n=r.left,i=r.top,a=r.width,o=r.height,s=e-this.cols.indexWidth,l=t-this.rows.height;return s>n&&s<n+a&&l>i&&l<i+o}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var e=this.clipboard;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}},{key:"getMoveRect",value:function(e){return this.getRect(e)}},{key:"getRect",value:function(e){var t=this.scroll,r=this.rows,n=this.cols,i=this.exceptRowSet,a=e.sri,o=e.sci,s=e.eri,l=e.eci;if(a<0&&o<0)return{left:0,l:0,top:0,t:0,scroll:t};var u=n.sumWidth(0,o),c=r.sumHeight(0,a,i),f=r.sumHeight(a,s+1,i),d=n.sumWidth(o,l+1),h=u-t.x,p=c-t.y,m=this.freezeTotalHeight(),v=this.freezeTotalWidth();return v>0&&v>u&&(h=u),m>0&&m>c&&(p=c),{l:u,t:c,left:h,top:p,height:f,width:d,scroll:t}}},{key:"getCellRectByXY",value:function(e,t){var r=this.scroll,n=this.merges,i=this.rows,a=this.cols,o=q.call(this,t,r.y),s=o.ri,l=o.top,u=o.height,c=W.call(this,e,r.x),f=c.ci,d=c.left,h=c.width;if(-1===f&&(h=a.totalWidth()),-1===s&&(u=i.totalHeight()),s>=0||f>=0){var p=n.getFirstIncludes(s,f);if(p){s=p.sri,f=p.sci;var m=this.cellRect(s,f);d=m.left,l=m.top,h=m.width,u=m.height}}return{ri:s,ci:f,left:d,top:l,width:h,height:u}}},{key:"getCellRectByXYWithNotTotalResult",value:function(e,t){var r=this.scroll,n=this.merges,i=q.call(this,t,r.y),a=i.ri,o=i.top,s=i.height,l=W.call(this,e,r.x),u=l.ci,c=l.left,f=l.width;if(a>=0||u>=0){var d=n.getFirstIncludes(a,u);if(d){a=d.sri,u=d.sci;var h=this.cellRect(a,u);c=h.left,o=h.top,f=h.width,s=h.height}}return{ri:a,ci:u,left:c,top:o,width:f,height:s}}},{key:"isSignleSelected",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=I(a.merge,2),s=o[0],l=o[1];if(t+s===n&&r+l===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var e=this.selector.range,t=e.sri,r=e.sci,n=e.eri,i=e.eci,a=this.getCell(t,r);if(a&&a.merge){var o=I(a.merge,2),s=o[0],l=o[1];if(t+s===n&&r+l===i)return!0}return!1}},{key:"merge",value:function(){var e=this.selector,t=this.rows;if(!this.isSignleSelected()){var r=I(e.size(),2),n=r[0],i=r[1];if(n>1||i>1){var a=e.range,o=a.sri,s=a.sci,l=t.getCellOrNew(o,s);l.merge=[n-1,i-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(o,s,l)}}}},{key:"unmerge",value:function(){var e=this,t=this.selector;if(this.isSignleSelected()){var r=t.range,n=r.sri,i=r.sci;this.changeData((function(){e.rows.deleteCell(n,i,"merge"),e.merges.deleteWithin(t.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var e=this,t=this.autoFilter,r=this.selector;this.changeData((function(){if(t.active())t.clear(),e.exceptRowSet=new Set,e.sortedRowMap=new Map,e.unsortedRowMap=new Map;else{for(var n=r.range.toString(),i=r.range.eri,a=e.rows,o=r.range.sci;o<=r.range.eci;o++){var s=new m.CellRange(r.range.sri,o,r.range.sri,o);i<(s=a.autoFilterRef(n,s)).eri&&(i=s.eri)}var l=new m.CellRange(r.range.sri,r.range.sci,i,r.range.eci);t.ref=l.toString()}}))}},{key:"throwFormula",value:function(){var e=this.selector,t=this.rows;this.changeData((function(){e.range.each((function(e,r){var n=t.getCellOrNew(e,r);n&&n.text&&n.formulas&&t.setCellAll(e,r,n.text,n.text)}))}))}},{key:"setAutoFilter",value:function(e,t,r,n){var i=this.autoFilter;i.addFilter(e,r,n),i.setSort(e,t),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var e=this,t=this.autoFilter,r=this.rows;if(t.active()){var n=t.sort,i=t.filteredRows((function(e,t){return r.getCell(e,t)})),a=i.rset,o=i.fset,s=Array.from(o),l=Array.from(o);n&&s.sort((function(e,t){return"asc"===n.order?e-t:"desc"===n.order?t-e:0})),this.exceptRowSet=a,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,s.forEach((function(t,r){e.sortedRowMap.set(l[r],t),e.unsortedRowMap.set(t,l[r])}))}}},{key:"deleteCell",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){e.rows.deleteCells(r.range,t),"all"!==t&&"format"!==t||e.merges.deleteWithin(r.range)}),{type:2})}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=this.selector.range,i=n.sri,a=n.sci,o=this.rows,s=this.merges,l=this.cols;r="row"===e?-1!==r?r:i:-1!==r?r:a,this.changeData((function(){var n=r;"row"===e?o.insert(r,t):"column"===e&&(o.insertColumn(r,t),n=r,l.len+=t),s.shift(e,n,t,(function(e,t,r,n){var i=o.getCell(e,t);i.merge[0]+=r,i.merge[1]+=n}))}),{type:13,data:this.getData(),property:"insert"})}},{key:"delete",value:function(e){var t=this;this.changeData((function(){var r=t.rows,n=t.merges,i=t.selector,a=t.cols,o=i.range,s=i.range,l=s.sri,u=s.sci,c=s.eri,f=s.eci,d=I(i.range.size(),2),h=d[0],p=d[1],m=l,v=h;"row"===e?r.delete(l,c):"column"===e&&(r.deleteColumn(u,f),m=o.sci,v=p,a.len-=1),n.shift(e,m,-v,(function(e,t,n,i){var a=r.getCell(e,t);a.merge[0]+=n,a.merge[1]+=i,0===a.merge[0]&&0===a.merge[1]&&delete a.merge}))}))}},{key:"scrollx",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.cols,a=I(n,2)[1],o=I(c.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getWidth(e)})),3),s=o[0],l=o[1],u=o[2],f=l;e>0&&(f+=u),r.x!==f&&(r.ci=e>0?s:0,r.x=f,t())}},{key:"scrolly",value:function(e,t){var r=this.scroll,n=this.freeze,i=this.rows,a=I(n,1)[0],o=I(c.rangeReduceIf(a,i.len,0,0,e,(function(e){return i.getHeight(e)})),3),s=o[0],l=o[1],u=o[2],f=l;e>0&&(f+=u),r.y!==f&&(r.ri=e>0?s:0,r.y=f,t())}},{key:"cellRect",value:function(e,t){var r=this.rows,n=this.cols,i=n.sumWidth(0,t),a=r.sumHeight(0,e),o=r.getCell(e,t),s=n.getWidth(t),l=r.getHeight(e);if(null!==o&&o.merge){var u=I(o.merge,2),c=u[0],f=u[1];if(c>0)for(var d=1;d<=c;d+=1)l+=r.getHeight(e+d);if(f>0)for(var h=1;h<=f;h+=1)s+=n.getWidth(t+h)}return{left:i,top:a,width:s,height:l,cell:o}}},{key:"getCell",value:function(e,t){return this.rows.getCell(e,t)}},{key:"getMax",value:function(){var e=this.cols.len;return{mri:this.rows.len,mci:e}}},{key:"renderFormat",value:function(e,t,r,n,i){return new C.default(t).renderFormat(e,r,n,this,i)}},{key:"isFormula",value:function(e){return this.rows.isFormula(e)}},{key:"toString",value:function(e){return this.rows.toString(e)}},{key:"getCellTextOrDefault",value:function(e,t){var r=this.getCell(e,t);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(e,t){var r=this.getCell(e,t);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(e,t){var r=this.styles,n=this.rows.getCell(e,t),i=n&&void 0!==n.style?r[n.style]:{};return c.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var e=this.selector,t=e.ri,r=e.ci;return this.getCellStyleOrDefault(t,r)}},{key:"getCellByExpr",value:function(e,t,r,n,i){}},{key:"setCellText",value:function(e,t,r,n){var i=r.text,a=r.style,o=this.rows,s=this.history,l=this.validations;"finished"===n?(o.setCellText(e,t,{text:""}),s.add(this.getData()),o.setCellText(e,t,{text:i})):("end"===n?o.setCellAll(e,t,i):"formulas"===n?o.setCellAll(e,t,i,"-"):"style"===n?o.setCellText(e,t,{text:i,style:a},"style"):o.setCellText(e,t,{text:i}),this.change(this.getData())),l.validate(e,t,i)}},{key:"setCellAll",value:function(e,t,r,n,i){var a=this.rows,o=this.history,s=this.validations;"finished"===i?(a.setCellAll(e,t,"",""),o.add(this.getData()),a.setCellAll(e,t,r,n)):a.setCellAll(e,t,r,n),s.validate(e,t,r,n)}},{key:"equationIsActive",value:function(){return this.showEquation}},{key:"freezeIsActive",value:function(){var e=I(this.freeze,2),t=e[0],r=e[1];return t>0||r>0}},{key:"setFreeze",value:function(e,t){var r=this;this.changeData((function(){r.freeze=[e,t]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(e,t){var r=this;this.changeData((function(){r.rows.setHeight(e,t)}),{type:3,ri:e})}},{key:"setColWidth",value:function(e,t){var r=this;this.changeData((function(){r.cols.setWidth(e,t)}),{type:4,ci:e})}},{key:"viewHeight",value:function(){var e=this.settings,t=e.view,r=e.showToolbar,n=t.height();return r&&(n-=41),n}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var e=I(this.freeze,2),t=e[0],r=e[1];return new m.CellRange(0,0,t-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"viewRange",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=I(n,1)[0]),a<=0&&(a=I(n,2)[1]);for(var o=0,s=0,l=[t.len,r.len],u=l[0],c=l[1],f=i;f<t.len&&(u=f,!((s+=t.getHeight(f))>this.viewHeight()));f+=1);for(var d=a;d<r.len&&(c=d,!((o+=r.getWidth(d))>this.viewWidth()));d+=1);return new m.CellRange(i,a,u,c,o,s)}},{key:"viewRange2",value:function(){var e=this.scroll,t=this.rows,r=this.cols,n=this.freeze,i=e.ri,a=e.ci;i<=0&&(i=I(n,1)[0]),a<=0&&(a=I(n,2)[1]);for(var o=0,s=0,l=[t.len,r.len],u=l[0],c=l[1],f=i;f<t.len&&(u=f,!((s+=t.getHeight(f))>this.viewHeight()));f+=1);for(var d=a;d<r.len;d+=1)o+=r.getWidth(d),c=d;return new m.CellRange(i,a,u,c,o,s)}},{key:"eachMergesInView",value:function(e,t){this.merges.filterIntersects(e).forEach((function(e){return t(e)}))}},{key:"rowEach",value:function(e,t,r){for(var n=0,i=this.rows,a=this.exceptRowSet,o=k(a),s=0,l=0;l<o.length;l+=1)o[l]<e&&(s+=1);for(var u=e+s;u<=t+s;u+=1)if(a.has(u))s+=1;else{var c=i.getHeight(u);if(r(u,n,c),(n+=c)>this.viewHeight())break}}},{key:"colEach",value:function(e,t,r){for(var n=0,i=this.cols,a=e;a<=t;a+=1){var o=i.getWidth(a);if(r(a,n,o),(n+=o)>this.viewWidth())break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(e){for(var t=this.styles,r=0;r<t.length;r+=1){var n=t[r];if(c.equals(n,e))return r}return t.push(e),t.length-1}},{key:"getChangeDataToCalc",value:function(){var e=this.multiPreAction;if(e.undoItems.length<=0)return null;var t=e.undoItems[e.undoItems.length-1];return(0,f.isHave)(t)?t:null}},{key:"changeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.type,n=void 0===r?-1:r,i=t.ri,a=void 0===i?-1:i,o=t.ci,s=void 0===o?-1:o,l=t.cellRange,u=void 0===l?"":l,c=t.property,f=void 0===c?"":c,d=t.value,h=void 0===d?"":d;if(!1!==this.settings.showEditor){var p={},m=this.merges.getData(),v=this.multiPreAction,y=this.selector,g=v.getStepType(n,{expr:"",property:f,value:h,oldCell:p,range:y.range,ri:a,ci:s,cellRange:u});if(""!==u){var E=this.multiPreAction;p=E.eachRange(u)}e(),this.changeToHistory({type:n,ri:a,ci:s,cellRange:u,property:f,value:h,oldCell:p,oldMergesData:m,newData:this.getData()},g),this.changeDataForCalc=this.getChangeDataToCalc(),this.change(this.getData())}}},{key:"cutPaste",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];j.call(this,e,t,r)}},{key:"setData",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.autoFilter;return Object.keys(e).forEach((function(a){if("merges"===a||"cols"===a||"validations"===a||"chart"===a)t[a].setData(e[a]);else if("flex"===a)i.addFiexRows(e[a]);else if("rows"===a)t[a].setData(e[a],r,n,t.settings.rowsInit);else if("freeze"===a){var o=I((0,v.expr2xy)(e[a]),2),s=o[0],l=o[1];t.freeze=[l,s]}else"pictures"===a?e[a]&&H.call(t,e[a],"from",r):"autofilter"===a?e[a]&&e[a].ref&&(i.ref=e[a].ref,i.filters=e[a].filters,i.sort=e[a].sort):void 0!==e[a]&&(t[a]=e[a])})),this}},{key:"selectorCellText",value:function(e,t,r,n){return U.call(this,e,t,r,n)}},{key:"getData",value:function(){var e=this.name,t=this.freeze,r=this.styles,n=this.merges,i=this.rows,a=this.cols,o=this.validations,s=this.autoFilter,l=this.pasteDirectionsArr;return{editor:this.settings.showEditor,name:e,freeze:(0,v.xy2expr)(t[1],t[0]),styles:r,pictures:H(l,"to"),merges:n.getData(),rows:i.getData(),cols:a.getData(),validations:o.getData(),autofilter:s.getData()}}}])&&M(t.prototype,r),n&&M(t,n),e}();t.default=$},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.easyCalcWorkbook=function(e){(new o).calculateWorkbook(e)},t.Calc=void 0;r(16);var n=r(94),i=r(51);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.calcWorkbookProxy=new i.CalcWorkbookProxy({}),this.calcRowsProxy=null}var t,r,o;return t=e,(r=[{key:"calculateRows",value:function(e,t){if(this.calcRowsProxy instanceof n.CalcRowsProxy==0){this.calcRowsProxy=new n.CalcRowsProxy(e,t);var r=this.calcRowsProxy.rows2workbook();this.calculateWorkbook(r),this.calcRowsProxy.calcDoneToSetCells(r,e)}else{var i=this.calcWorkbookProxy.updateByPreAction(t);this.calcRowsProxy.updateRowsByCalcCellArray(i,e)}}},{key:"calculateWorkbook",value:function(e){this.calcWorkbookProxy.updateByWorkbookObj(e);var t=this.calcWorkbookProxy.find_all_cells_with_formulas();return this.calcWorkbookProxy.calculateFormulas(t),t}},{key:"updateByMultiSheetObj",value:function(e){var t=this.calcWorkbookProxy.updateByMultiSheetObj(e);return this.calcWorkbookProxy.getMultiSheetObjFromSheet2CalcArray(t)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.Calc=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcRowsProxy=void 0;var n,i=(n=r(4))&&n.__esModule?n:{default:n},a=r(9);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rows=t,this.preAction=r}var t,r,n;return t=e,(r=[{key:"updateWorkbook",value:function(e){for(var t=this.rows.data.name,r=this.preAction.findAllNeedCalcCell(),n=0;n<r.length;n++){var o=r[n],s=i.default.expr2xy(o),l=this.rows.getCell(s[1],s[0]);(0,a.isHave)(l)&&(e.Sheets[t][o]={v:l.text,f:l.formulas})}return e}},{key:"rows2workbook",value:function(){var e=this.rows,t=e._,r=null,n=e.data.name;return(0,a.isHave)(e.name2SheetProxy)?r=e.name2SheetProxy:(r={Sheets:{}}).Sheets[n]={},Object.keys(t).forEach((function(o){Object.keys(t[o].cells).forEach((function(t){var s=e.getCell(o,t),l=i.default.xy2expr(t,o);(0,a.isHave)(s)&&(r.Sheets[n][l]={f:s.formulas})}))})),r}},{key:"updateRowsByCalcCellArray",value:function(e,t){e.map((function(e){t.setCell.apply(t,o(e.getRiCi()).concat([e.getCellObjForRendering(),"assign"]))}))}},{key:"calcDoneToSetCells",value:function(e,t){var r=t.data.name,n=e.Sheets[r];Object.keys(n).forEach((function(e){var r=i.default.expr2xy(e);if((0,a.isHave)(n[e])&&(0,a.isHave)(n[e].v)&&(0,a.isHave)(n[e].f)){var o=t.getCell(r[1],r[0]);(0,a.isHave)(o)||(o={}),o.v=n[e].v,o.text=n[e].v.toString(),o.formulas=n[e].f,t.setCell(r[1],r[0],o)}})),t.workbook=e}}])&&s(t.prototype,r),n&&s(t,n),e}();t.CalcRowsProxy=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRefactorProxy=void 0;var n=r(53);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dealBhv=t}var t,r,a;return t=e,(r=[{key:"getTheFunc",value:function(){var e=this;return function(t){return e.dealSyntaxUnit(t)}}},{key:"dealSyntaxUnit",value:function(e){var t=e.syntaxParser;return t instanceof n.AARangeRefer?this.dealBhv.dealAA(e):t instanceof n.SingleCellRefer?this.dealBhv.dealA1(e):t instanceof n.RangeRefer?this.dealBhv.dealA1B2(e):void 0}}])&&i(t.prototype,r),a&&i(t,a),e}();t.BaseRefactorProxy=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiCollExpFn=t.FnCollection=void 0;var n=r(97),i=r(54),a=r(15);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var c=function(){function e(){s(this,e),this.fnObj={}}return u(e,[{key:"addFnObj",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=!0,s=!1,l=void 0;try{for(var u,c=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var f=n+(t=u.value);if(f in this.fnObj){if(!0===r)continue;throw new Error("define fn again:",t)}var d=e[t];"function"==typeof d||d instanceof a.BaseExpFunction?this.fnObj[this.convertFnName(f)]=e[t]:"object"===o(d)&&this.addFnObj(e[t],r,t+".")}}catch(e){s=!0,l=e}finally{try{i||null==c.return||c.return()}finally{if(s)throw l}}}},{key:"convertFnName",value:function(e){return e.replace("__",".")}},{key:"updateFnObj",value:function(e){var t,r=!0,n=!1,i=void 0;try{for(var a,o=Object.getOwnPropertyNames(e)[Symbol.iterator]();!(r=(a=o.next()).done);r=!0)t=a.value,this.fnObj[t]=e[t]}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"addFnObjArray",value:function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addFnObj(o)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}},{key:"getExpFunction",value:function(e){return e in this.fnObj==!1?{isEmpty:!0}:this.fnObj[e]}}]),e}();t.FnCollection=c;var f=function(){function e(t,r){s(this,e),this.normal_fn_coll=t,this.raw_fn_coll=r,this.rawFnExecutor=n.UserRawFnExecutor,this.normalFnExecutor=i.UserFnExecutor}return u(e,[{key:"isValidExpFn",value:function(e){return"function"==typeof e||e instanceof a.BaseExpFunction}},{key:"getFnExecutorByName",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=t?e.toUpperCase():e;var r=this.raw_fn_coll.getExpFunction(e);return this.isValidExpFn(r)?new this.rawFnExecutor(r):(r=this.normal_fn_coll.getExpFunction(e),this.isValidExpFn(r)?new this.normalFnExecutor(r):new Error(" expression function "+e+" not found"))}},{key:"getAllFnObj",value:function(){var e={};return Object.assign(e,this.raw_fn_coll.fnObj),Object.assign(e,this.normal_fn_coll.fnObj),e}}]),e}();t.MultiCollExpFn=f},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserRawFnExecutor=void 0;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.name="UserRawFn",this.args=[],this.user_function=t}var t,r,i;return t=e,(r=[{key:"solveExpression",value:function(){return this.user_function.apply(this,this.args)}},{key:"push",value:function(e){this.args.push(e)}}])&&n(t.prototype,r),i&&n(t,i),e}();t.UserRawFnExecutor=i},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}Object.defineProperty(t,"__esModule",{value:!0}),t.fnObjArray=void 0;var o=[a(r(99)),a(r(103)),a(r(61)),a(r(104)),a(r(26)),a(r(36)),a(r(39)),a(r(105)),a(r(28)),a(r(106)),a(r(27)),a(r(58)),a(r(107))];t.fnObjArray=o},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=u(r(26)),a=u(r(27)),o=u(r(61)),s=u(r(39));function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function c(e,t){if(t)for(var r in t)e[r]=t[r];return e}t.BETADIST=a.BETA.DIST,t.BETAINV=a.BETA.INV,t.BINOMDIST=a.BINOM.DIST,t.CEILING=t.ISOCEILING=c(i.CEILING.MATH,i.CEILING),t.CEILINGMATH=i.CEILING.MATH,t.CEILINGPRECISE=i.CEILING.PRECISE,t.CHIDIST=a.CHISQ__DIST,t.CHIDISTRT=a.CHISQ__DIST.RT,t.CHIINV=a.CHISQ__INV,t.CHIINVRT=a.CHISQ__INV__RT,t.CHITEST=a.CHISQ__TEST,t.CONFIDENCE=c(a.CONFIDENCE.NORM,a.CONFIDENCE),t.COVAR=a.COVARIANCE.P,t.COVARIANCEP=a.COVARIANCE.P,t.COVARIANCES=a.COVARIANCE.S,t.CRITBINOM=a.BINOM.INV,t.EXPONDIST=a.EXPON.DIST,t.ERFCPRECISE=o.ERFC.PRECISE,t.ERFPRECISE=o.ERF.PRECISE,t.FDIST=a.F.DIST,t.FDISTRT=a.F.DIST.RT,t.FINVRT=a.F.INV.RT,t.FINV=a.F.INV,t.FLOORMATH=i.FLOORMATH,t.FLOORPRECISE=i.FLOORPRACE,t.FTEST=a.F.TEST,t.GAMMADIST=a.GAMMA.DIST,t.GAMMAINV=a.GAMMA.INV,t.GAMMALNPRECISE=a.GAMMALN.PRECISE,t.HYPGEOMDIST=a.HYPGEOM.DIST,t.LOGINV=a.LOGNORM.INV,t.LOGNORMINV=a.LOGNORM.INV,t.LOGNORMDIST=a.LOGNORM.DIST,t.MODE=c(a.MODE.SNGL,a.MODE),t.MODEMULT=a.MODE.MULT,t.MODESNGL=a.MODE.SNGL,t.NEGBINOMDIST=a.NEGBINOM.DIST,t.NETWORKDAYSINTL=s.NETWORKDAYSINTL,t.NORMDIST=a.NORM.DIST,t.NORMINV=a.NORM.INV,t.NORMSDIST=a.NORM.S.DIST,t.NORMSINV=a.NORM.S.INV,t.PERCENTILE=c(a.PERCENTILE.EXC,a.PERCENTILE),t.PERCENTILEEXC=a.PERCENTILE.EXC,t.PERCENTILEINC=a.PERCENTILE.INC,t.PERCENTRANK=c(a.PERCENTRANK.INC,a.PERCENTRANK),t.PERCENTRANKEXC=a.PERCENTRANK.EXC,t.PERCENTRANKINC=a.PERCENTRANK.INC,t.POISSON=c(a.POISSON.DIST,a.POISSON),t.POISSONDIST=a.POISSON.DIST,t.QUARTILE=c(a.QUARTILE.INC,a.QUARTILE),t.QUARTILEEXC=a.QUARTILE.EXC,t.QUARTILEINC=a.QUARTILE.INC,t.RANK=c(a.RANK.EQ,a.RANK),t.RANKAVG=a.RANK.AVG,t.RANKEQ=a.RANK.EQ,t.SKEWP=a.SKEW.P,t.STDEV=c(a.STDEV.S,a.STDEV),t.STDEVP=a.STDEV.P,t.STDEVS=a.STDEV.S,t.TDIST=a.T.DIST,t.TDISTRT=a.T.DIST.RT,t.TINV=a.T.INV,t.TTEST=a.T.TEST,t.VARP=a.VAR.P,t.VARS=a.VAR.S,t.WEIBULL=c(a.WEIBULL.DIST,a.WEIBULL),t.WEIBULLDIST=a.WEIBULL.DIST,t.WORKDAYINTL=s.WORKDAYINTL,t.ZTEST=a.Z.TEST,t._XLFN=c(i.FLOOR.MATH,a.COVARIANCE.P,a.NORM.INV,a.VAR.P)},function(e,t,r){"use strict";var n="=",i=[">",">=","<","<=","=","<>"],a="operator_single_func.js",o="literal",s=[a,o];function l(e,t){if(-1===s.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function u(e){for(var t,r="",s=[],u=0;u<e.length;u++){var c=e[u];0===u&&i.indexOf(c)>=0?s.push(l(c,a)):r+=c}return r.length>0&&s.push(l("string"!=typeof(t=r)?t:(/^\d+(\.\d+)?$/.test(t)&&(t=-1===t.indexOf(".")?parseInt(t,10):parseFloat(t)),t),o)),s.length>0&&s[0].type!==a&&s.unshift(l(n,a)),s}t.TOKEN_TYPE_OPERATOR=a,t.TOKEN_TYPE_LITERAL=o,t.parse=function(e){return u(function(e){for(var t=e.length,r=[],n=0,i="",a="";n<t;){var o=e.charAt(n);switch(o){case">":case"<":case"=":a+=o,i.length>0&&(r.push(i),i="");break;default:a.length>0&&(r.push(a),a=""),i+=o}n++}return i.length>0&&r.push(i),a.length>0&&r.push(a),r}(e))},t.createToken=l,t.compute=function(e){for(var t,r=[],n=0;n<e.length;n++){var i=e[n];switch(i.type){case a:t=i.value;break;case o:r.push(i.value)}}return function(e,t){var r=!1;switch(t){case">":r=e[0]>e[1];break;case">=":r=e[0]>=e[1];break;case"<":r=e[0]<e[1];break;case"<=":r=e[0]<=e[1];break;case"=":r=e[0]===e[1];break;case"<>":r=e[0]!==e[1]}return r}(r,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.opIsLessThan=function(e,t){return e<t},t.opIsGreaterThan=function(e,t){return e>t},t.opIsGreaterOrEqual=function(e,t){return e>=t},t.opIsLessOrEqual=function(e,t){return e<=t},t.opIsNotEqual=function(e,t){return!1===o(e,t)},t.opAdd=function(e,t){return e+t},t.opSubtract=function(e,t){return e-t},t.opMultiply=function(e,t){return e*t},t.opDivide=function(e,t){if(0===t)return new Error(n.ERROR_DIV0);return e/t},t.opPower=function(e,t){return Math.pow(e,t)},t.OPERATOR_OBJ=t.opJoinString=t.opIsEqual=void 0;var n=r(2),i=r(15),a=r(3);var o=new i.NotConvertEmptyExpFunction((function(e,t){return"number"==typeof e&&"number"==typeof t?Math.abs(e-t)<.001:e.cellVTypeName===t.cellVTypeName===a.CellVTypeObj.CellVEmpty||e===t}));t.opIsEqual=o;var s=new i.StringExpFunction((function(e,t){return String(e)+String(t)}));t.opJoinString=s;t.OPERATOR_OBJ={plus:"+",dash:"-",star:"*",slash:"/",caret:"^",ampersand:"&",lessThen:"<",greaterThen:">",equal:"=",notEqual:"<>",greaterEqual:">=",lessEqual:"<="}},function(e,t,r){var n;n=function(e){e.version="1.0.2";var t=Math;function r(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function n(e,t,r,n,i){if(0===t)return r;if(1===t)return n;for(var a=2/e,o=n,s=1;s<t;++s)o=n*s*a+i*r,r=n,n=o;return o}function i(e,t,r,i,a){return function(r,o){if(i){if(0===r)return 1==i?-1/0:1/0;if(r<0)return NaN}return 0===o?e(r):1===o?t(r):o<0?NaN:n(r,o|=0,e(r),t(r),a)}}var a,o,s,l,u,c,f,d,h,p,m,v,y,g=function(){var e=.636619772,i=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),a=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),o=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(n){var l=0,u=0,c=0,f=n*n;if(n<8)l=(u=r(i,f))/(c=r(a,f));else{var d=n-.785398164;u=r(o,f=64/f),c=r(s,f),l=t.sqrt(e/n)*(t.cos(d)*u-t.sin(d)*c*8/n)}return l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function h(n){var i=0,a=0,o=0,s=n*n,l=t.abs(n)-2.356194491;return Math.abs(n)<8?i=(a=n*r(u,s))/(o=r(c,s)):(a=r(f,s=64/s),o=r(d,s),i=t.sqrt(e/t.abs(n))*(t.cos(l)*a-t.sin(l)*o*8/t.abs(n)),n<0&&(i=-i)),i}return function e(r,i){if(i=Math.round(i),!isFinite(r))return isNaN(r)?r:0;if(i<0)return(i%2?-1:1)*e(r,-i);if(r<0)return(i%2?-1:1)*e(-r,i);if(0===i)return l(r);if(1===i)return h(r);if(0===r)return 0;var a=0;if(r>i)a=n(r,i,l(r),h(r),-1);else{for(var o=!1,s=0,u=0,c=1,f=0,d=2/r,p=2*t.floor((i+t.floor(t.sqrt(40*i)))/2);p>0;p--)f=p*d*c-s,s=c,c=f,t.abs(c)>1e10&&(c*=1e-10,s*=1e-10,a*=1e-10,u*=1e-10),o&&(u+=c),o=!o,p==i&&(a=s);a/=u=2*u-c}return a}}(),E=(a=.636619772,o=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),i((function(e){var n=0,i=0,c=0,f=e*e,d=e-.785398164;return e<8?n=(i=r(o,f))/(c=r(s,f))+a*g(e,0)*t.log(e):(i=r(l,f=64/f),c=r(u,f),n=t.sqrt(a/e)*(t.sin(d)*i+t.cos(d)*c*8/e)),n}),(function(e){var n=0,i=0,o=0,s=e*e,l=e-2.356194491;return e<8?n=(i=e*r(c,s))/(o=r(f,s))+a*(g(e,1)*t.log(e)-1/e):(i=r(d,s=64/s),o=r(h,s),n=t.sqrt(a/e)*(t.sin(l)*i+t.cos(l)*o*8/e)),n}),0,1,-1)),b=(p=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),v=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),y=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(n,i){if(0===(i=Math.round(i)))return function(e){return e<=3.75?r(p,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*r(m,3.75/t.abs(e))}(n);if(1===i)return function(e){return e<3.75?e*r(v,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*r(y,3.75/t.abs(e))}(n);if(i<0)return NaN;if(0===t.abs(n))return 0;if(n==1/0)return 1/0;var a,o=0,s=2/t.abs(n),l=0,u=1,c=0;for(a=2*t.round((i+t.round(t.sqrt(40*i)))/2);a>0;a--)c=a*s*u+l,l=u,u=c,t.abs(u)>1e10&&(u*=1e-10,l*=1e-10,o*=1e-10),a==i&&(o=l);return o*=e(n,0)/u,n<0&&i%2?-o:o}),x=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),n=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),a=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),o=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i((function(i){return i<=2?-t.log(i/2)*b(i,0)+r(e,i*i/4):t.exp(-i)/t.sqrt(i)*r(n,2/i)}),(function(e){return e<=2?t.log(e/2)*b(e,1)+1/e*r(a,e*e/4):t.exp(-e)/t.sqrt(e)*r(o,2/e)}),0,2,1)}();e.besselj=g,e.bessely=E,e.besseli=b,e.besselk=x},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},function(module,exports,__webpack_require__){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.DAVERAGE=DAVERAGE,exports.DCOUNT=DCOUNT,exports.DCOUNTA=DCOUNTA,exports.DMAX=DMAX,exports.DMIN=DMIN,exports.DPRODUCT=DPRODUCT,exports.DSTDEV=DSTDEV,exports.DSTDEVP=DSTDEVP,exports.DSUM=DSUM,exports.DVAR=DVAR,exports.DVARP=DVARP;var _error_config=_interopRequireWildcard(__webpack_require__(2)),stats=_interopRequireWildcard(__webpack_require__(27)),maths=_interopRequireWildcard(__webpack_require__(26)),utils=_interopRequireWildcard(__webpack_require__(11));function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=n?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function compact(e){if(!e)return e;for(var t=[],r=0;r<e.length;++r)e[r]&&t.push(e[r]);return t}function find_result_idx(database,criteria){for(var valid_arr=[],filter_arr=[],i=0;i<criteria[0].length;i++)filter_arr.push(criteria[0][i]);for(var _i=1;_i<criteria.length;_i++){for(var arr=criteria[_i],valid_str=[],j=0;j<filter_arr.length;j++)null!==arr[j]&&valid_str.push(database[0].indexOf(criteria[0][j])+"-"+arr[j]);valid_arr.push(valid_str)}for(var result_idx=[],_i2=1;_i2<database.length;_i2++)for(var data=database[_i2],_j=0;_j<valid_arr.length;_j++){for(var is_valid=!0,k=0;k<valid_arr[_j].length;k++){var a=data[parseInt(valid_arr[_j][k].split("-")[0])],b=valid_arr[_j][k].split("-")[1];b.indexOf("=")>=0?is_valid=a===b.replace("=",""):eval(a+b)||(is_valid=!1)}is_valid&&result_idx.push(_i2)}return result_idx}function get_values(e,t,r){var n;n="number"==typeof r?r-1:t[0].indexOf(r);for(var i=[],a=0;a<e.length;a++)i.push(t[e[a]][n]);return i}function DAVERAGE(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n;if("number"==typeof t)for(var i=[],a=1;a<e.length;a++)i.push(a);else n=find_result_idx(e,r);for(var o=get_values(n,e,t),s=0,l=0;l<o.length;l++)s+=o[l];return 0===n.length?Error(_error_config.ERROR_DIV0):s/o.length}function DCOUNT(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return stats.COUNT(n)}function DCOUNTA(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return stats.COUNTA(n)}function DMAX(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]>i&&(i=n[a]);return i}function DMIN(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);for(var n=get_values(find_result_idx(e,r),e,t),i=n[0],a=0;a<n.length;a++)n[a]<i&&(i=n[a]);return i}function DPRODUCT(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);for(var n=get_values(find_result_idx(e,r),e,t),i=1,a=0;a<n.length;a++)i*=n[a];return i}function DSTDEV(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.S(n)}function DSTDEVP(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return n=compact(n),stats.STDEV.P(n)}function DSUM(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return maths.SUM(n)}function DVAR(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.S(n)}function DVARP(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=get_values(find_result_idx(e,r),e,t);return stats.VAR.P(n)}exports.FINDFIELD=function(e,t){for(var r=null,n=0;n<e.length;n++)if(e[n][0]===t){r=n;break}return null==r?Error(_error_config.ERROR_VALUE):r},exports.DGET=function(e,t,r){if(isNaN(t)&&"string"!=typeof t)return Error(_error_config.ERROR_VALUE);var n=find_result_idx(e,r);return n.length>1?_error_config.default.ERROR_NUM:get_values(n,e,t)[0]}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AND=function(){for(var e=a.flatten(arguments),t="true",r=0;r<e.length;r++)e[r]||(t=!1);return t},t.IF=function(e,t,r){return e?t:r},t.IFERROR=function(e,t){if(o.ISERROR_(e))return t;return e},t.CHOOSE=void 0;var i=r(2),a=l(r(11)),o=l(r(28));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var u=new(r(15).OnlyNumberExpFunction)((function(){if(arguments.length<2)return Error(i.ERROR_NA);var e=arguments[0];return e<1||e>254?Error(i.ERROR_VALUE):arguments.length<e+1?Error(i.ERROR_VALUE):arguments[e]}));t.CHOOSE=u,t.FALSE=function(){return!1},t.IFNA=function(e,t){return e===i.errorObj.ERROR_NA?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=a.flatten(arguments),t=!1,r=0;r<e.length;r++)e[r]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=a.flatten(arguments),t=0,r=0;r<e.length;r++)e[r]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],r=arguments.length-1,n=Math.floor(r/2),a=!1,o=r%2==0?null:arguments[arguments.length-1];if(n)for(var s=0;s<n;s++)if(t===arguments[2*s+1]){e=arguments[2*s+2],a=!0;break}!a&&o&&(e=o)}return null==e?i.errorObj.ERROR_NA:e}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ACCRINT=function(e,t,r,n,o,l,u,c){if(n<=0||o<=0)return Error(i.ERROR_NUM);if(-1===[1,2,4].indexOf(l))return Error(i.ERROR_NUM);if(-1===[0,1,2,3,4].indexOf(u))return Error(i.ERROR_NUM);if(r<=e)return Error(i.ERROR_NUM);(0,s.parseBool)(c);return u=u||0,(o=o||1e4)*n*a.YEARFRAC(e,r,u)},t.ACCRINTM=function(e,t,r,n,o){if(r<=0||n<=0)return Error(i.ERROR_NUM);if(o<0||o>4)return Error(i.ERROR_NUM);if(t<=e)return Error(i.ERROR_NUM);return o=o||0,(n=n||1e4)*r*a.YEARFRAC(e,t,o)},t.COUPDAYBS=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);var a=(0,s.days_str2date)(e),o=v(e,t,r).startDay;return g(a,o,n)},t.COUPDAYS=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);if(3===n)return h/r;return 1===n?(v(e,t,r).endDay-v(e,t,r).startDay)/f:p/r},t.COUPDAYSNC=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);var a=(0,s.days_str2date)(e);return g(v(e,t,r).endDay,a,n)},t.COUPNUM=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);return v(e,t,r).N},t.COUPPCD=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);return v(e,t,r).startDay},t.COUPNCD=function(e,t,r,n){if(0===y(e,t,r,n))return Error(i.ERROR_NUM);return v(e,t,r).endDay},t.CUMIPMT=function(e,r,n,a,l,u){if(e=(0,s.parseNumber)(e),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),(0,o.anyIsError)(e,r,n))return Error(i.ERROR_VALUE);if(e<=0||r<=0||n<=0)return Error(i.ERROR_NUM);if(a<1||l<1||a>l)return Error(i.ERROR_NUM);if(0!==u&&1!==u)return Error(i.ERROR_NUM);var c=t.PMT(e,r,n,0,u),f=0;1===a&&0===u&&(f=-n,a++);for(var d=a;d<=l;d++)f+=1===u?t.FV(e,d-2,c,n,1)-c:t.FV(e,d-1,c,n,0);return f*=e},t.CUMPRINC=function(e,r,n,a,l,u){if(e=(0,s.parseNumber)(e),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),(0,o.anyIsError)(e,r,n))return Error(i.ERROR_VALUE);if(e<=0||r<=0||n<=0)return Error(i.ERROR_NUM);if(a<1||l<1||a>l)return Error(i.ERROR_NUM);if(0!==u&&1!==u)return Error(i.ERROR_NUM);var c=t.PMT(e,r,n,0,u),f=0;1===a&&(f=0===u?c+n*e:c,a++);for(var d=a;d<=l;d++)f+=u>0?c-(t.FV(e,d-2,c,n,1)-c)*e:c-t.FV(e,d-1,c,n,0)*e;return f},t.DISC=function(e,t,r,n,a){var o=(0,s.days_str2date)(e),l=(0,s.days_str2date)(t);if(r<=0||n<=0)return Error(i.ERROR_NUM);if(a<0||a>4)return Error(i.ERROR_NUM);if(e>=t)return Error(i.ERROR_NUM);var u,c=g(l,o,a);u=1===a||3===a?365:360;return(n-r)/n*u/c},t.DOLLARDE=function(e,t){if(e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);if(t<0)return Error(i.ERROR_NUM);if(t>=0&&t<1)return Error(i.ERROR_DIV0);t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var n=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*n)/n},t.DOLLARFR=function(e,t){if(e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);if(t<0)return Error(i.ERROR_NUM);if(t>=0&&t<1)return Error(i.ERROR_DIV0);t=parseInt(t,10);var r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.EFFECT=function(e,t){if(e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);if(e<=0||t<1)return Error(i.ERROR_NUM);return t=parseInt(t,10),Math.pow(1+e/t,t)-1},t.FV=function(e,t,r,n,a){if(n=n||0,a=a||0,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a))return Error(i.ERROR_VALUE);var l;if(0===e)l=n+r*t;else{var u=Math.pow(1+e,t);l=1===a?n*u+r*(1+e)*(u-1)/e:n*u+r*(u-1)/e}return-l},t.FVSCHEDULE=function(e,t){e=(0,s.parseNumber)(e),"string"==typeof t&&(t=(0,o.strToMatrix)(t));if(t=(0,s.parseNumberArray)((0,o.flatten)(t)),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);for(var r=t.length,n=e,a=0;a<r;a++)n*=1+t[a];return n},t.INTRATE=function(e,t,r,n,a){if(r<=0||n<=0)return Error(i.ERROR_VALUE);if(a<0||a>4)return Error(i.ERROR_NUM);if(e>=t)return Error(i.ERROR_NUM);var o,l=(0,s.days_str2date)(t),u=(0,s.days_str2date)(e);3===a&&(o=365);if(1===a){var c=u.getFullYear();o=0!=c%4||c%100==0&&c%400!=0?365:366}3!==a&1!==a&&(o=360);var f=g(l,u,a);return(n-r)/r*(o/f)},t.ISPMT=function(e,t,r,n){if(e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),(0,o.anyIsError)(e,t,r,n))return Error(i.ERROR_VALUE);return n*e*(t/r-1)};var i=r(2),a=u(r(39)),o=u(r(11)),s=(u(r(37)),r(17));function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function c(e){return e&&e.getTime&&!isNaN(e.getTime())}var f=864e5,d=12,h=365,p=360,m=30;function v(e,t,r){var n=(0,s.days_str2date)(e),i=(0,s.days_str2date)(t),a=parseInt((12*i.getFullYear()+i.getMonth()-12*n.getFullYear()-n.getMonth())/(12/r)),l=o.Copy(i);l.setMonth(l.getMonth()-12*a/r),l>n&&(a+=1);var u=o.Copy(i);u.setMonth(u.getMonth()-12*(a-1)/r);var c=o.Copy(u);return c.setMonth(u.getMonth()-12/r),{startDay:c,endDay:u,N:a}}function y(e,t,r,n){return-1===[0,1,2,3,4].indexOf(n)&void 0!==n?0:-1===[1,2,4].indexOf(r)?0:"number"!=typeof e||"number"!=typeof t?0:e>=t?0:void 0}function g(e,t,r){return[1,2,3].indexOf(r)>=0?(e-t)/f:(e.getFullYear()*d+e.getMonth()-t.getFullYear()*d-t.getMonth()-1)*m+m-t.getDate()+e.getDate()}function E(e,t,r,n,i){for(var a=0,o=1;o<=r;o++)a+=Math.min(i/n*(e-a),e-t-a);return a+(r-o+1)*Math.min(i/n*(e-a),e-t-a)}t.AMORDEGRC=function(e,t,r,n,a,o,s){return c(issue)&&c(settlement)?o<=0||par<=0?Error(i.ERROR_NUM):s<0||s>4?Error(i.ERROR_NUM):settlement<=issue?Error(i.ERROR_NUM):void 0:Error(i.ERROR_VALUE)},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.DB=function(e,t,r,n,a){if(a=void 0===a?12:a,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a))return Error(i.ERROR_VALUE);if(e<0||t<0||r<0||n<0)return Error(i.ERROR_NUM);if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return Error(i.ERROR_NUM);if(n>r)return Error(i.ERROR_NUM);if(t>=e)return 0;for(var l=(1-Math.pow(t/e,1/r)).toFixed(3),u=e*l*a/12,c=u,f=0,d=n===r?r-1:n,h=2;h<=d;h++)c+=f=(e-c)*l;return 1===n?u:n===r?(e-c)*l:f},t.DDB=function(e,t,r,n,a){if(a=void 0===a?2:a,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a))return Error(i.ERROR_VALUE);if(e<0||t<0||r<0||n<0||a<=0)return Error(i.ERROR_NUM);if(n>r)return Error(i.ERROR_NUM);if(t>=e)return 0;for(var l=0,u=0,c=1;c<=n;c++)l+=u=Math.min(a/r*(e-l),e-t-l);return u},t.DURATION=function(e,t,r,n,a,o){return e=(0,s.dayNum2Date)(e),c(t=(0,s.dayNum2Date)(t))&&c(e)?o<0||o>4?Error(i.ERROR_NUM):e>=t?Error(i.ERROR_NUM):void 0:Error(i.ERROR_VALUE)},t.IPMT=function(e,r,n,a,l,u){if(l=l||0,u=u||0,e=(0,s.parseNumber)(e),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),l=(0,s.parseNumber)(l),u=(0,s.parseNumber)(u),(0,o.anyIsError)(e,r,n,a,l,u))return Error(i.ERROR_VALUE);var c=t.PMT(e,n,a,l,u);return(1===r?1===u?0:-a:1===u?t.FV(e,r-2,c,a,1)-c:t.FV(e,r-1,c,a,0))*e},t.IRR=function(e,t){if(t=t||0,e=(0,s.parseNumberArray)(o.flatten(e)),t=(0,s.parseNumber)(t),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);for(var r=function(e,t,r){for(var n=r+1,i=e[0],a=1;a<e.length;a++)i+=e[a]/Math.pow(n,(t[a]-t[0])/365);return i},n=function(e,t,r){for(var n=r+1,i=0,a=1;a<e.length;a++){var o=(t[a]-t[0])/365;i-=o*e[a]/Math.pow(n,o+1)}return i},a=[],l=!1,u=!1,c=0;c<e.length;c++)a[c]=0===c?0:a[c-1]+365,e[c]>0&&(l=!0),e[c]<0&&(u=!0);if(!l||!u)return Error(i.ERROR_NUM);var f,d,h,p=t=void 0===t?.1:t,m=!0;do{f=p-(h=r(e,a,p))/n(e,a,p),d=Math.abs(f-p),p=f,m=d>1e-10&&Math.abs(h)>1e-10}while(m);return p},t.MDURATION=function(e,t,r,n,a,o){return r<0||n<0?Error(i.ERROR_NUM):o<0||o>4?Error(i.ERROR_NUM):-1===[1,2,4].indexOf(a)?Error(i.ERROR_NUM):void 0},t.MIRR=function(e,r,n){if(e=(0,s.parseNumberArray)(o.flatten(e)),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),(0,o.anyIsError)(e,r,n))return Error(i.ERROR_VALUE);for(var a=e.length,l=[],u=[],c=0;c<a;c++)e[c]<0?l.push(e[c]):u.push(e[c]);var f=-t.NPV(n,u)*Math.pow(1+n,a-1),d=t.NPV(r,l)*(1+r);return Math.pow(f/d,1/(a-1))-1},t.NOMINAL=function(e,t){return e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),(0,o.anyIsError)(e,t)?Error(i.ERROR_VALUE):e<=0||t<1?Error(i.ERROR_NUM):(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,r,n,a){if(a=void 0===a?0:a,n=void 0===n?0:n,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a))return Error(i.ERROR_VALUE);var l=t*(1+e*a)-n*e,u=r*e+t*(1+e*a);return Math.log(l/u)/Math.log(1+e)},t.NPV=function(){var e=(0,s.parseNumberArray)(o.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],r=0,n=1;n<e.length;n++)r+=e[n]/Math.pow(1+t,n);return r},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,r){return e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):e<=0?Error(i.ERROR_NUM):(Math.log(r)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,r,n,a){if(n=n||0,a=a||0,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a))return Error(i.ERROR_VALUE);var l;if(0===e)l=(r+n)/t;else{var u=Math.pow(1+e,t);l=1===a?(n*e/(u-1)+r*e/(1-1/u))/(1+e):n*e/(u-1)+r*e/(1-1/u)}return-l},t.PPMT=function(e,r,n,a,l,u){return l=l||0,u=u||0,e=(0,s.parseNumber)(e),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),l=(0,s.parseNumber)(l),u=(0,s.parseNumber)(u),(0,o.anyIsError)(e,n,a,l,u)?Error(i.ERROR_VALUE):t.PMT(e,n,a,l,u)-t.IPMT(e,r,n,a,l,u)},t.PRICE=function(e,t,r,n,a,l,u){var c=(0,s.dayNum2Date)(e),f=(0,s.dayNum2Date)(t);if((0,o.anyIsError)(c,f))return Error(i.ERROR_VALUE);if(u<0||u>4)return i.errorObj.ERROR_NA;if(c>=f)return i.errorObj.ERROR_NA;var d=12*f.getFullYear()+f.getMonth()-12*c.getFullYear()-c.getMonth(),h=parseInt(d/(12/l)),p=o.Copy(f);p.setMonth(p.getMonth()-12*h/l);var m=o.Copy(p);m.setMonth(m.getMonth()-12/l);var v=(p-c)/864e5,y=(p-m)/864e5,g=(c-m)/864e5;if(h>1){for(var E=a/(1+n/l^h-1+v/y)-100*r*g/(l*y),b=100*r/(l*(1+n/l^v/y)),x=2;x<=h;x++)b+=100*r/(l*(1+n/l^x-1+v/y));return E+b}return 1==h?(100*r/l+a)/(n*(y-g)/l/y+1)-100*r*g/l/y:void 0},t.PRICEDISC=function(e,t,r,n,l){return e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),(0,o.anyIsError)(e,t)?Error(i.ERROR_VALUE):l<0||l>4?i.errorObj.ERROR_NA:e>=t?i.errorObj.ERROR_NA:n-r*n*Math.abs(a.DAYS(e,t,!1))/360},t.PRICEMAT=function(e,t,r,n,l,u){if(e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),r=(0,s.dayNum2Date)(r),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);if(u<0||u>4)return i.errorObj.ERROR_NA;if(e>=t)return i.errorObj.ERROR_NA;var c=Math.abs(a.DAYS(e,t,!1));return(100+Math.abs(a.DAYS(t,r,!1))/360*n*100)/(1+c/360*l)-Math.abs(a.DAYS(r,e,!1))/360*n*100},t.PV=function(e,t,r,n,a){return n=n||0,a=a||0,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),(0,o.anyIsError)(e,t,r,n,a)?Error(i.ERROR_VALUE):0===e?-r*t-n:((1-Math.pow(1+e,t))/e*r*(1+e*a)-n)/Math.pow(1+e,t)},t.RATE=function(e,t,r,n,a,l){if(l=void 0===l?.01:l,n=void 0===n?0:n,a=void 0===a?0:a,e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),a=(0,s.parseNumber)(a),l=(0,s.parseNumber)(l),(0,o.anyIsError)(e,t,r,n,a,l))return Error(i.ERROR_VALUE);for(var u=0,c=!1,f=l;u<100&&!c;){var d=Math.pow(f+1,e),h=Math.pow(f+1,e-1),p=f-(n+d*r+t*(d-1)*(f*a+1)/f)/(e*h*r-t*(d-1)*(f*a+1)/Math.pow(f,2)+(e*t*h*(f*a+1)/f+t*(d-1)*a/f));Math.abs(p-f)<1e-6&&(c=!0),u++,f=p}return c?f:Number.NaN+f},t.RECEIVED=function(e,t,r,n,l){return e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),(0,o.anyIsError)(e,t)?Error(i.ERROR_VALUE):r<=0||n<=0?i.errorObj.ERROR_NA:l<0||l>4?i.errorObj.ERROR_NA:e>=t?i.errorObj.ERROR_NA:r/(1-n*Math.abs(a.DAYS(e,t,!1))/360)},t.RRI=function(e,t,r){return e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):0===e||0===t?Error(i.ERROR_NUM):Math.pow(r/t,1/e)-1},t.SLN=function(e,t,r){return e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):0===r?Error(i.ERROR_NUM):(e-t)/r},t.SYD=function(e,t,r,n){return e=(0,s.parseNumber)(e),t=(0,s.parseNumber)(t),r=(0,s.parseNumber)(r),n=(0,s.parseNumber)(n),(0,o.anyIsError)(e,t,r,n)?Error(i.ERROR_VALUE):0===r?Error(i.ERROR_NUM):n<1||n>r?Error(i.ERROR_NUM):(e-t)*(r-(n=parseInt(n,10))+1)*2/(r*(r+1))},t.TBILLEQ=function(e,t,r){return e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):r<=0?Error(i.ERROR_NUM):e>t?Error(i.ERROR_NUM):t-e>31536e6?Error(i.ERROR_NUM):365*r/(360-r*a.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,r){return e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):r<=0?Error(i.ERROR_NUM):e>t?Error(i.ERROR_NUM):t-e>31536e6?Error(i.ERROR_NUM):100*(1-r*a.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,r){return e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r)?Error(i.ERROR_VALUE):r<=0?Error(i.ERROR_NUM):e>t?Error(i.ERROR_NUM):t-e>31536e6?Error(i.ERROR_NUM):360*(100-r)/(r*a.DAYS360(e,t,!1))},t.get_total=E,t.VDB=function(e,t,r,n,a,s,l){var u=void 0===s?2:s,c=e,f=t,d=r,h=n,p=a;return(0,o.anyIsError)(c,f,d,h,p,u)?Error(i.ERROR_VALUE):c<0||f<0||d<0||h<0||u<=0?Error(i.ERROR_NUM):h>d?Error(i.ERROR_NUM):f>=c?0:E(c,f,p,d,u)-E(c,f,h,d,u)},t.XIRR=function(e,t,r){if(e=(0,s.parseNumberArray)(o.flatten(e)),t=o.parseDateArray(o.flatten(t)),r=(0,s.parseNumber)(r),(0,o.anyIsError)(e,t,r))return Error(i.ERROR_VALUE);for(var n=function(e,t,r){for(var n=r+1,i=e[0],o=1;o<e.length;o++)i+=e[o]/Math.pow(n,a.DAYS(t[o],t[0])/365);return i},l=function(e,t,r){for(var n=r+1,i=0,o=1;o<e.length;o++){var s=a.DAYS(t[o],t[0])/365;i-=s*e[o]/Math.pow(n,s+1)}return i},u=!1,c=!1,f=0;f<e.length;f++)e[f]>0&&(u=!0),e[f]<0&&(c=!0);if(!u||!c)return Error(i.ERROR_NUM);var d,h,p,m=r=r||.1,v=!0;do{d=m-(p=n(e,t,m))/l(e,t,m),h=Math.abs(d-m),m=d,v=h>1e-10&&Math.abs(p)>1e-10}while(v);return m},t.XNPV=function(e,t,r){if(e=(0,s.parseNumber)(e),t=(0,s.parseNumberArray)(o.flatten(t)),r=o.parseDateArray(o.flatten(r)),(0,o.anyIsError)(e,t,r))return Error(i.ERROR_VALUE);for(var n=0,l=0;l<t.length;l++)n+=t[l]/Math.pow(1+e,a.DAYS(r[l],r[0])/365);return n},t.YIELD=function(e,t,r,n,l,u,c){if(e=(0,s.dayNum2Date)(e),t=(0,s.dayNum2Date)(t),(0,o.anyIsError)(e,t))return Error(i.ERROR_VALUE);if(r<=0)return Error(i.ERROR_NUM);if(n<=0)return Error(i.ERROR_NUM);if(l<=0)return Error(i.ERROR_NUM);if(e>=t)return Error(i.ERROR_NUM);Math.abs(a.DAYS(e,t,!1))},t.YIELDDISC=function(e,t,r,n,a){var l=(0,s.dayNum2Date)(e),u=(0,s.dayNum2Date)(t);if((0,o.anyIsError)(l,u))return Error(i.ERROR_VALUE);if(r<=0)return Error(i.ERROR_NUM);if(n<=0)return Error(i.ERROR_NUM);if(l>=u)return Error(i.ERROR_NUM);if(-1===[0,1,2,3,4].indexOf(a))return Error(i.ERROR_NUM);if(1===a){var c=l.getFullYear();return 0!=c%4||c%100==0&&c%400!=0?(n-r)/r/(u-l)*365*864e5:(n-r)/r/(u-l)*366*864e5}return 2===a?(n-r)/r/(u-l)*360*864e5:3===a?(n-r)/r/(u-l)*365*864e5:0===a||4===a?(n-r)/r/(30*(12*u.getFullYear()+u.getMonth()-12*l.getFullYear()-l.getMonth()-1)+30-l.getDay()+u.getDay())*360:void 0},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.FACTORIAL=function(e){for(var t=1,r=e;r>=1;r--)t*=r;return t}},function(e,t,r){"use strict";var n,i=r(2),a=(n=r(11))&&n.__esModule?n:{default:n};function o(e,t){for(var r,n,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]<t&&(n?e[a]>n&&(r=a+1,n=e[a]):(r=a+1,n=e[a]))}return r||i.errorObj.ERROR_NA}function s(e,t){for(var r=0;r<e.length;r++)if(t=t.replace(/\?/g,"."),Array.isArray(e[r])){if(1===e[r].length&&"string"==typeof e[r][0]&&e[r][0].toLowerCase()===t.toLowerCase())return r+1}else if("string"==typeof e[r]&&e[r].toLowerCase()===t.toLowerCase())return r+1;return i.errorObj.ERROR_NA}function l(e,t){for(var r=0;r<e.length;r++)if(Array.isArray(e[r])){if(1===e[r].length&&e[r][0]===t)return r+1}else if(e[r]===t)return r+1;return i.errorObj.ERROR_NA}function u(e,t){for(var r,n,a=0;a<e.length;a++){if(e[a]===t)return a+1;e[a]>t&&(n?e[a]<n&&(r=a+1,n=e[a]):(r=a+1,n=e[a]))}return r||i.errorObj.ERROR_NA}t.MATCH=function(e,t,r){if(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),!e&&!t)return i.errorObj.ERROR_NA;if(2===arguments.length&&(r=1),!(t instanceof Array))return i.errorObj.ERROR_NA;if(0===r)return"string"==typeof e?s(t,e):l(t,e);if(1===r)return o(t,e);if(-1===r){for(var n=t[0][0],a=1;a<t.length;a++)if(t[a][0]>n)return i.errorObj.ERROR_NA;return u(t,e)}return i.errorObj.ERROR_NA},t.VLOOKUP=function(e,t,r,n){if("string"==typeof n&&"FALSE"!=n&&"TRUE"!=n)return i.errorObj.ERROR_VALUE;n="FALSE"!=n;for(var a=0;a<t.length;a++)if(t[a][0]==e)return t[a][r-1];return i.errorObj.ERROR_NA},t.HLOOKUP=function(e,t,r,n){if("TRUE"==n&&(n=!0),"FALSE"==n&&(n=!1),"string"==typeof t&&t.indexOf("{")>=0&&(t=a.default.strToMatrix(t)),void 0===e||t[0].indexOf(e)<0)return i.errorObj.ERROR_NA;r=r||0;for(var o=t[0],s=0;s<o.length;s++)if(n&&o[s]===e||-1!==o[s].toString().toLowerCase().indexOf(e.toString().toLowerCase()))return r<t.length+1?t[r-1][s]:t[0][s];return i.errorObj.ERROR_NA}},function(e,t,r){"use strict";var n=r(2);function i(e,t,r){this.name=e,this.type=t,this.url=r}t.PQUERY=function(){if(5!==arguments.length)return n.errorObj.ERROR_ERROR;if(arguments[0].length!==arguments[1].length)return n.errorObj.ERROR_ERROR;if(arguments[1].length!==arguments[3].length)return n.errorObj.ERROR_ERROR;for(var e=[],t=arguments[4],r=0;r<arguments[3].length;r++)arguments[3][r]=parseFloat(arguments[3][r]),isNaN(arguments[3][r])||e.push({number:r,value:Math.abs(arguments[3][r]-t)});e=e.sort((function(e,t){var r=e.value,n=t.value;return r<n?-1:r>n?1:0}));for(var i=[],a=1,o=0;o<e.length;o++){var s=e[o],l=s.number,u=s.value,c=arguments[0][l][0],f=arguments[1][l][0],d=arguments[3][l];f===arguments[2]&&(i.push({number:a,name:c,city:f,area:d,value:u}),a+=1)}return"*悬浮查看*!"+JSON.stringify(i)},t.HYPERLINK=function(){if(console.log(arguments),!arguments||!arguments[0]||!arguments[1])return n.errorObj.ERROR_NA;var e=arguments[0];e="http://"==e.substr(0,7).toLowerCase()||"https://"==e.substr(0,8).toLowerCase()?e:"http://"+e;var t={text:arguments[1],url:e};return"*HYPERLINK*!"+JSON.stringify(t)+" "};!function(e){e.push(new i("合肥",0,"https://hf.lianjia.com/ditu")),e.push(new i("安庆",0,"https://aq.lianjia.com/ditu")),e.push(new i("滁州",0,"https://cz.fang.lianjia.com/ditu/")),e.push(new i("马鞍山",0,"https://mas.lianjia.com/ditu")),e.push(new i("北京",0,"https://bj.lianjia.com/ditu")),e.push(new i("重庆",0,"https://cq.lianjia.com/ditu")),e.push(new i("福州",0,"https://fz.lianjia.com/ditu")),e.push(new i("泉州",0,"https://quanzhou.lianjia.com/ditu")),e.push(new i("厦门",0,"https://xm.lianjia.com/ditu")),e.push(new i("漳州",0,"https://zhangzhou.lianjia.com/ditu")),e.push(new i("东莞",0,"https://dg.lianjia.com/ditu")),e.push(new i("佛山",0,"https://fs.lianjia.com/ditu")),e.push(new i("广州",0,"https://gz.lianjia.com/ditu")),e.push(new i("惠州",0,"https://hui.lianjia.com/ditu")),e.push(new i("江门",0,"https://jiangmen.lianjia.com/ditu")),e.push(new i("清远",0,"https://qy.lianjia.com/ditu")),e.push(new i("深圳",0,"https://sz.lianjia.com/ditu")),e.push(new i("珠海",0,"https://zh.lianjia.com/ditu")),e.push(new i("湛江",0,"https://zhanjiang.lianjia.com/ditu")),e.push(new i("中山",0,"https://zs.lianjia.com/ditu")),e.push(new i("贵阳",0,"https://gy.lianjia.com/ditu")),e.push(new i("北海",0,"https://bh.lianjia.com/ditu")),e.push(new i("防城港",0,"https://fcg.lianjia.com/ditu")),e.push(new i("桂林",0,"https://gl.lianjia.com/ditu")),e.push(new i("柳州",0,"https://liuzhou.lianjia.com/ditu")),e.push(new i("南宁",0,"https://nn.lianjia.com/ditu")),e.push(new i("兰州",0,"https://lz.lianjia.com/ditu")),e.push(new i("鄂州",0,"https://ez.lianjia.com/ditu")),e.push(new i("黄石",0,"https://huangshi.lianjia.com/ditu")),e.push(new i("武汉",0,"https://wh.lianjia.com/ditu")),e.push(new i("襄阳",0,"https://xy.lianjia.com/ditu")),e.push(new i("宜昌",0,"https://yichang.lianjia.com/ditu")),e.push(new i("长沙",0,"https://cs.lianjia.com/ditu")),e.push(new i("常德",0,"https://changde.lianjia.com/ditu")),e.push(new i("岳阳",0,"https://yy.lianjia.com/ditu")),e.push(new i("株洲",0,"https://zhuzhou.lianjia.com/ditu")),e.push(new i("保定",0,"https://bd.lianjia.com/ditu")),e.push(new i("廊坊",0,"https://lf.lianjia.com/ditu")),e.push(new i("秦皇岛",0,"https://qhd.fang.lianjia.com/ditu")),e.push(new i("石家庄",0,"https://sjz.lianjia.com/ditu")),e.push(new i("唐山",0,"https://ts.lianjia.com/ditu")),e.push(new i("张家口",0,"https://zjk.lianjia.com/ditu")),e.push(new i("保亭",0,"https://bt.fang.lianjia.com/ditu")),e.push(new i("澄迈",0,"https://cm.fang.lianjia.com/ditu")),e.push(new i("儋州",0,"https://dz.fang.lianjia.com/ditu")),e.push(new i("海口",0,"https://hk.lianjia.com/ditu")),e.push(new i("临高",0,"https://lg.fang.lianjia.com/ditu")),e.push(new i("乐东",0,"https://ld.fang.lianjia.com/ditu")),e.push(new i("陵水",0,"https://ls.fang.lianjia.com/ditu")),e.push(new i("琼海",0,"https://qh.fang.lianjia.com/ditu")),e.push(new i("三亚",0,"https://san.lianjia.com/ditu")),e.push(new i("五指山",0,"https://wzs.fang.lianjia.com/ditu")),e.push(new i("文昌",0,"https://wc.fang.lianjia.com/ditu")),e.push(new i("万宁",0,"https://wn.fang.lianjia.com/ditu")),e.push(new i("开封",0,"https://kf.lianjia.com/ditu")),e.push(new i("洛阳",0,"https://luoyang.lianjia.com/ditu")),e.push(new i("新乡",0,"https://xinxiang.lianjia.com/ditu")),e.push(new i("许昌",0,"https://xc.lianjia.com/ditu")),e.push(new i("郑州",0,"https://zz.lianjia.com/ditu")),e.push(new i("哈尔滨",0,"https://kf.lianjia.com/ditu")),e.push(new i("常州",0,"https://changzhou.lianjia.com/ditu")),e.push(new i("淮安",0,"https://ha.lianjia.com/ditu")),e.push(new i("昆山",0,"https://ks.lianjia.com/ditu")),e.push(new i("南京",0,"https://nj.lianjia.com/ditu/")),e.push(new i("南通",0,"https://nt.lianjia.com/ditu")),e.push(new i("苏州",0,"https://su.lianjia.com/ditu")),e.push(new i("无锡",0,"https://wx.lianjia.com/ditu")),e.push(new i("徐州",0,"https://xz.lianjia.com/ditu")),e.push(new i("盐城",0,"https://yc.lianjia.com/ditu")),e.push(new i("镇江",0,"https://zj.lianjia.com/ditu")),e.push(new i("长春",0,"https://cc.lianjia.com/ditu/")),e.push(new i("吉林",0,"https://jl.lianjia.com/ditu")),e.push(new i("赣州",0,"https://ganzhou.lianjia.com/ditu")),e.push(new i("九江",0,"https://jiujiang.lianjia.com/ditu")),e.push(new i("吉安",0,"https://jian.lianjia.com/ditu")),e.push(new i("南昌",0,"https://nc.lianjia.com/ditu")),e.push(new i("上饶",0,"https://sr.lianjia.com/ditu")),e.push(new i("大连",0,"https://dl.lianjia.com/ditu")),e.push(new i("丹东",0,"https://dd.lianjia.com/ditu")),e.push(new i("沈阳",0,"https://sy.lianjia.com/ditu")),e.push(new i("呼和浩特",0,"https://hhht.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("银川",0,"https://yinchuan.lianjia.com/ditu")),e.push(new i("上海",0,"https://sh.lianjia.com/ditu")),e.push(new i("成都",0,"https://cd.lianjia.com/ditu")),e.push(new i("德阳",0,"https://dy.fang.lianjia.com/ditu")),e.push(new i("达州",0,"https://dazhou.lianjia.com/ditu")),e.push(new i("乐山",0,"https://leshan.fang.lianjia.com/ditu")),e.push(new i("凉山",0,"https://liangshan.lianjia.com/ditu")),e.push(new i("绵阳",0,"https://mianyang.lianjia.com/ditu")),e.push(new i("眉山",0,"https://ms.fang.lianjia.com/ditu")),e.push(new i("南充",0,"https://nanchong.lianjia.com/ditu")),e.push(new i("济南",0,"https://jn.lianjia.com/ditu")),e.push(new i("临沂",0,"https://linyi.lianjia.com/ditu")),e.push(new i("青岛",0,"https://qd.lianjia.com/ditu")),e.push(new i("潍坊",0,"https://wf.lianjia.com/ditu")),e.push(new i("威海",0,"https://weihai.lianjia.com/ditu")),e.push(new i("烟台",0,"https://yt.lianjia.com/ditu")),e.push(new i("淄博",0,"https://zb.lianjia.com/ditu")),e.push(new i("宝鸡",0,"https://baoji.lianjia.com/ditu")),e.push(new i("汉中",0,"https://hanzhong.lianjia.com/ditu")),e.push(new i("西安",0,"https://xa.lianjia.com/ditu")),e.push(new i("咸阳",0,"https://xianyang.lianjia.com/ditu")),e.push(new i("晋中",0,"https://jz.fang.lianjia.com/ditu")),e.push(new i("太原",0,"https://ty.lianjia.com/ditu")),e.push(new i("天津",0,"https://tj.lianjia.com/ditu")),e.push(new i("大理",0,"https://dali.lianjia.com/ditu")),e.push(new i("昆明",0,"https://km.lianjia.com/ditu")),e.push(new i("西双版纳",0,"https://xsbn.fang.lianjia.com/ditu")),e.push(new i("杭州",0,"https://hz.lianjia.com/ditu")),e.push(new i("湖州",0,"https://huzhou.lianjia.com/ditu")),e.push(new i("嘉兴",0,"https://jx.lianjia.com/ditu")),e.push(new i("金华",0,"https://jh.lianjia.com/ditu")),e.push(new i("宁波",0,"https://nb.lianjia.com/ditu")),e.push(new i("绍兴",0,"https://sx.lianjia.com/ditu")),e.push(new i("台州",0,"https://taizhou.lianjia.com/ditu")),e.push(new i("温州",0,"https://wz.lianjia.comditu"))}([]);!function(e){e.push(new i("北京",0,"https://bj.5i5j.com/map")),e.push(new i("杭州",0,"https://hz.5i5j.com/map")),e.push(new i("青岛",0,"https://qd.5i5j.com/map")),e.push(new i("天津",0,"https://tj.5i5j.com/map")),e.push(new i("太原",0,"https://zz.5i5j.com/map")),e.push(new i("郑州",0,"https://zz.5i5j.com/map")),e.push(new i("成都",0,"https://cd.5i5j.com/map")),e.push(new i("长沙",0,"https://cs.5i5j.com/map")),e.push(new i("南昌",0,"https://nc.5i5j.com/map")),e.push(new i("南京",0,"https://nj.5i5j.com/map")),e.push(new i("南宁",0,"https://nn.5i5j.com/map")),e.push(new i("上海",0,"https://sh.5i5j.com/map")),e.push(new i("苏州",0,"https://sz.5i5j.com/map")),e.push(new i("武汉",0,"https://wh.5i5j.com/map")),e.push(new i("无锡",0,"https://wx.5i5j.com/map"))}([]);!function(e){e.push(new i("全国",0,"https://www1.fang.com"))}([])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.raw_offset=function(e,t,r,s,l){if(s=(s||new n.RawValue(1)).solveExpression(),l=(l||new n.RawValue(1)).solveExpression(),1===e.args.length&&e.args[0]instanceof a.SUnitRefValue){var u=e.args[0],c=u.getRefCalcCell(),f=new o.ColIndexProxy(c.cell_name).colNum+r.solveExpression(),d=new o.ColIndexProxy(f).colStr,h=+c.cell_name.replace(/^[A-Z]+/g,"")+t.solveExpression(),p=d+h;if(1===s&&1===l)return new a.SUnitRefValue(p,u.cellFormulaProxy).solveExpression();var m=new o.ColIndexProxy(f+l-1).colStr+(h+s-1),v=c.sheet_name+"!"+p+":"+m;return new i.SUnitRangeRef(v,u.cellFormulaProxy).solveExpression()}},t.iferror=function(e,t){try{var r=e.solveExpression();return"number"!=typeof r||!isNaN(r)&&r!==1/0&&r!==-1/0?r:t.solveExpression()}catch(e){return t.solveExpression()}},t._if=function(e,t,r){return e.solveExpression()?t.solveExpression():r.solveExpression()},t.and=function(){for(var e=0;e<arguments.length;e++)if(!arguments[e].solveExpression())return!1;return!0};var n=r(40),i=r(41),a=r(42),o=r(35)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleExpressionBuilder=void 0;var n=r(3),i=r(2),a=r(21),o=(r(52),r(63));function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var c=function(){function e(t){s(this,e),this.parseArray=[o.ForceString,o.BoolParser,o.DateTimeParser,o.MoneyParser,o.NumberParser],this.rootExp=new f(this.calcCell),this.calcCell=t}return u(e,[{key:"parseFormula",value:function(){return this.rootExp=new f(this.calcCell,this.calcCell.formulaString,this.parseArray),this.rootExp.parseExpression(),this.rootExp}}]),e}();t.SimpleExpressionBuilder=c;var f=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;s(this,e),this.expStatus=n.FORMULA_STATUS.created,this.calcCell=t,this.strToParse=r,this.parserArray=a,this.parseRes="",this.expSolution=i.ERROR_NON_SOLVED}return u(e,[{key:"parseExpression",value:function(){var e,t=!0,r=!1,n=void 0;try{for(var a,o=this.parserArray[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){if((e=new(0,a.value)(this.calcCell,this.strToParse).parseString()).msg!==i.PARSE_FAIL)return this.parseRes=e,e}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}return this.parseRes=this.strToParse,this.strToParse}},{key:"isEmpty",value:function(){return""===this.strToParse}},{key:"solveExpression",value:function(){return this.isEmpty()?this.expSolution=new a.CellVEmpty:this.expSolution=(0,a.convertToCellV)(this.parseRes),this.expStatus=n.FORMULA_STATUS.solved,this.expSolution}},{key:"update_cell_value",value:function(){return this.calcCell.cellObj.v=this.solveExpression(),this.calcCell.cellObj.v}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StructuralExpressionBuilder=void 0;var n=r(111),i=r(40),a=r(3),o=r(41),s=r(42),l=r(63),u=r(2),c=r(21),f=r(38),d=r(25),h=r(112);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),e}var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];m(this,e),this.stackArray=t}return y(e,[{key:"addStack",value:function(e){this.stackArray.push(e)}},{key:"popStack",value:function(){return this.stackArray.pop()}},{key:"isFnExecutorValid",value:function(e){var t=p(e);return!1===["number","undefined"].includes(t)}},{key:"getLastStack",value:function(){return this.stackArray[this.stackArray.length-1]}},{key:"getLastExpression",value:function(){return this.getLastStack()}},{key:"getLastFnExecutor",value:function(){return this.getLastStack()}},{key:"isLastFnExecutorValid",value:function(){return this.isFnExecutorValid(this.getLastFnExecutor())}}]),e}(),E=function(){function e(t,r){m(this,e),this.multiCollFn=r,this.calcCell=t,this.root_exp=new n.StructuralExp(t),this.curExpression=this.root_exp,this.buffer="",this.stackProxy=new g,this.stackProxy.addStack(this.curExpression),this.position_i=0,this.state=this.normalState,this.last_arg="",this.trimmedStrDetailObj={},this.lastUnitTypeArray=[],this.synUnitBuilder=new d.SyntaxStructureBuilder(h.ExpSyntaxUnitProxy),this.char=""}return y(e,[{key:"addUseLessStringIfNotEmpty",value:function(e){""!==e&&this.synUnitBuilder.addUseLessUnit(e)}},{key:"addInitContainer",value:function(e){this.synUnitBuilder.addUseLessUnit(this.buffer),this.synUnitBuilder.addContainerUnit(e,[a.CONTAINER],!1)}},{key:"returnToNormalState",value:function(e){this.state=this.normalState,this.normalState(e)}},{key:"isLastArgOperator",value:function(){return""!==this.last_arg&&"string"==typeof this.last_arg}},{key:"isBufferEmpty",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?""===this.buffer.trim():""===this.buffer}},{key:"pushOperator2ExpArgs",value:function(e){this.curExpression.args.push(e),this.last_arg=e}},{key:"initDoubleQuo",value:function(){this.state=this.stringState,this.addInitContainer(this.char),this.buffer=""}},{key:"stringState",value:function(e){e===a.MARK_OBJ.doubleQue?this.state=this.stringMayEndState:this.buffer+=e}},{key:"dealStringEnd",value:function(){var e=new i.RawValue(this.buffer);this.push2ExpArgs(this.curExpression,e),this.synUnitBuilder.addValueToCurUnit(e,this.buffer,[a.RAW_VALUE]),this.synUnitBuilder.addContainerUnit('"',[a.CONTAINER],!0),this.buffer=""}},{key:"stringMayEndState",value:function(e){e===a.MARK_OBJ.doubleQue?(this.buffer+=a.MARK_OBJ.doubleQue,this.state=this.stringState):(this.dealStringEnd(),this.returnToNormalState(e))}},{key:"initSingleQuo",value:function(e){this.buffer+=e,this.state=this.sheetNameState}},{key:"sheetNameState",value:function(e){"'"===e&&(this.state=this.sheetNameMayEndState),this.buffer+=e}},{key:"sheetNameMayEndState",value:function(e){this.buffer+="'","'"===e?this.state=this.sheetNameState:this.returnToNormalState(e)}},{key:"addStartSpace",value:function(){this.addUseLessStringIfNotEmpty(this.trimmedStrDetailObj.startSpace)}},{key:"addEndSpace",value:function(){this.addUseLessStringIfNotEmpty(this.trimmedStrDetailObj.endSpace)}},{key:"getTrimmedStr",value:function(){return this.trimmedStrDetailObj.trimmedStr}},{key:"initOperator",value:function(e){!1===this.isBufferEmpty()&&(this.push2ExpArgs(this.curExpression,this.buffer,this.position_i),this.addStartSpace(),this.synUnitBuilder.addValueToCurUnit(this.last_arg,this.getTrimmedStr(),this.lastUnitTypeArray),this.addEndSpace()),this.buffer=e,this.state=this.endOperator}},{key:"endOperator",value:function(e){if(this.buffer+e in[">=","<=","<>"]){var t=this.buffer+e;this.pushOperator2ExpArgs(t),this.synUnitBuilder.addStringToCurUnit(t,[a.OPERATOR]),this.buffer=""}else this.pushOperator2ExpArgs(this.buffer),this.synUnitBuilder.addStringToCurUnit(this.buffer,[a.OPERATOR]),this.buffer="",this.returnToNormalState(e)}},{key:"initParentheses",value:function(){var e;this.isBufferEmpty()?e=NaN:(this.trimmedStrDetailObj=this.getTrimmedStrDetailObj(this.buffer),e=this.multiCollFn.getFnExecutorByName(this.getTrimmedStr()),this.addStartSpace(),this.synUnitBuilder.addValueToCurUnit(e,this.buffer,[a.EXP_FN]),this.addEndSpace()),this.synUnitBuilder.addContainerUnit(this.char,[a.CONTAINER]),this.stackProxy.addStack(e),this.curExpression=new n.StructuralExp(this.calcCell),this.stackProxy.addStack(this.curExpression),this.synUnitBuilder.createNewChild(),this.buffer=""}},{key:"endFnArg",value:function(){this.push2ExpArgs(this.curExpression,this.buffer,this.position_i),this.addStartSpace(),this.synUnitBuilder.addValueToCurUnit(this.last_arg,this.getTrimmedStr(),this.lastUnitTypeArray),this.addEndSpace(),this.stackProxy.popStack(),this.stackProxy.getLastFnExecutor().push(this.curExpression),this.curExpression=new n.StructuralExp(this.calcCell),this.stackProxy.addStack(this.curExpression),this.synUnitBuilder.returnToPreStack(),this.synUnitBuilder.addStringToCurUnit(this.char,[a.SPLIT_MARK]),this.synUnitBuilder.createNewChild(),this.buffer=""}},{key:"endParentheses",value:function(){var e=this.stackProxy.popStack();this.push2ExpArgs(this.curExpression,this.buffer),this.addStartSpace(),this.synUnitBuilder.addValueToCurUnit(this.last_arg,this.getTrimmedStr(),this.lastUnitTypeArray),this.addEndSpace();var t=this.stackProxy.popStack();this.curExpression=this.stackProxy.getLastStack(),this.stackProxy.isFnExecutorValid(t)?(t.push(e),this.push2ExpArgs(this.curExpression,t,this.position_i)):this.push2ExpArgs(this.curExpression,e,this.position_i),this.synUnitBuilder.returnToPreStack(),this.synUnitBuilder.addContainerUnit(this.char,[a.CONTAINER],!0),this.buffer=""}},{key:"initBrace",value:function(){""!==this.buffer.trim()&&this.push2ExpArgs(this.curExpression,this.buffer),this.addInitContainer(this.char),this.state=this.insideBrace,this.buffer=""}},{key:"insideBrace",value:function(e){if("}"===e){var t=new f.RawArray(this.buffer);this.push2ExpArgs(this.curExpression,t),this.synUnitBuilder.addValueToCurUnit(this.last_arg,this.buffer,this.lastUnitTypeArray),this.synUnitBuilder.addContainerUnit(e,[a.CONTAINER],!0),this.buffer="",this.state=this.normalState}else this.buffer+=e}},{key:"endWholeFormula",value:function(){this.state.name===this.stringMayEndState.name?this.dealStringEnd():""!==this.buffer&&(this.push2ExpArgs(this.curExpression,this.buffer,this.position_i),this.addStartSpace(),this.synUnitBuilder.addValueToCurUnit(this.last_arg,this.getTrimmedStr(),this.lastUnitTypeArray),this.addEndSpace())}},{key:"normalState",value:function(e){'"'===e?this.initDoubleQuo():"'"===e?this.initSingleQuo(e):"{"===e?this.initBrace():"("===e?this.initParentheses():")"===e?this.endParentheses():"%"!==e&&Object.values(a.SINGLE_CHAR_OPERATOR).includes(e)?this.initOperator(e):","===e&&this.stackProxy.isLastFnExecutorValid()?this.endFnArg():this.buffer+=e}},{key:"getTrimmedStrDetailObj",value:function(e){var t="",r="";return e.startsWith(" ")&&(t=e.match(/^ /)[0]),e.endsWith(" ")&&(r=e.match(/ $/)[0]),{startSpace:t,endSpace:r,trimmedStr:e.slice(t.length,e.length-r.length)}}},{key:"str2Value",value:function(e,t,r){var n;console.assert("string"==typeof e);var f=this.trimmedStrDetailObj=this.getTrimmedStrDetailObj(e),d=new l.BoolParser(t,e).parseString();return d.msg!==u.PARSE_FAIL?(n=new i.RawValue(new c.CellVBool(d)),this.lastUnitTypeArray=[a.RAW_VALUE,a.BOOL]):f.trimmedStr.replace(/\$/g,"").match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?(this.lastUnitTypeArray=[a.RANG_REF,a.A1A2],n=new o.SUnitRangeRef(f.trimmedStr.replace(/\$/g,""),t,r)):f.trimmedStr.replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/)?(this.lastUnitTypeArray=[a.RANG_REF,a.SHEET1A1A2],n=new o.SUnitRangeRef(f.trimmedStr.replace(/\$/g,""),t,r)):f.trimmedStr.replace(/\$/g,"").match(/^[A-Z]+:[A-Z]+$/)?(this.lastUnitTypeArray=[a.RANG_REF,a.AA],n=new o.SUnitRangeRef(f.trimmedStr.replace(/\$/g,""),t,r)):f.trimmedStr.replace(/\$/g,"").match(/^[^!]+![A-Z]+:[A-Z]+$/)?(this.lastUnitTypeArray=[a.RANG_REF,a.SHEET1AA],n=new o.SUnitRangeRef(f.trimmedStr.replace(/\$/g,""),t,r)):f.trimmedStr.replace(/\$/g,"").match(/^[A-Z]+[0-9]+$/)?(this.lastUnitTypeArray=[a.SINGLE_REF,a.A1],n=new s.SUnitRefValue(f.trimmedStr.replace(/\$/g,""),t)):f.trimmedStr.replace(/\$/g,"").match(/^[^!]+![A-Z]+[0-9]+$/)?(this.lastUnitTypeArray=[a.SINGLE_REF,a.SHEET1A1],n=new s.SUnitRefValue(f.trimmedStr.replace(/\$/g,""),t)):n=isNaN(f.trimmedStr.replace(/%$/,""))?new Error(u.ERROR_SYNTAX):new i.RawValue(+f.trimmedStr.replace(/%$/,"")/100),n}},{key:"push2ExpArgs",value:function(e,t,r){var n=e;if(""!==t){var a=t;a=isNaN(t)?"string"==typeof t?this.str2Value(t,n.calcCell,r):t:new i.RawValue(+t),n.args.push(a),n.last_arg=a}}},{key:"parseFormula",value:function(){var e=this.calcCell.formulaString.slice(1);if("{"===e[0]&&"}"===e[e.length-1])return this.push2ExpArgs(this.root_exp,new i.RawValue(new Error(u.ERROR_SYNTAX))),this.root_exp;for(;this.position_i<e.length;this.position_i++)this.char=e[this.position_i],this.state(this.char);return this.endWholeFormula(),this.calcCell.rootSyntaxUnit=this.synUnitBuilder.rootUnit,this.root_exp}}]),e}();t.StructuralExpressionBuilder=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StructuralExp=void 0;var n=r(3),i=r(40),a=r(42),o=r(41),s=r(2),l=r(21),u=r(60),c=r(38),f=r(54);function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=0,p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=++h,this.args=[],this.name="Expression",this.calcCell=t,this.last_arg="",this.twoArgOperator=new u.TwoArgOperatorColl}var t,r,p;return t=e,(r=[{key:"isEmpty",value:function(e){return null==e||""===e}},{key:"hasCalcMethod",value:function(e){return"function"==typeof e.solveExpression}},{key:"execCalcMethod",value:function(e){if(this.hasCalcMethod(e))return e.solveExpression();throw s.errorObj.ERROR_SYNTAX}},{key:"exeOperatorForArrayAndSingle",value:function(e,t,r){for(var n,i=!1,a=0,o=[e,t];a<o.length;a++)if((n=o[a])instanceof Array||n instanceof c.MatrixValue||n instanceof l.CellVArray){i=!0;break}if(i)return new l.CellVArray(e).exeElementOperator(new l.CellVArray(t),r);var s=this.twoArgOperator.getFunc(r);return new f.UserFnExecutor(s,[e,t]).solveExpression()}},{key:"execOperatorsWith2Args",value:function(e,t){for(var r=0;r<t.length;r++)if(e.includes(t[r]))try{var n=this.execCalcMethod(t[r-1]),a=this.execCalcMethod(t[r+1]),o=this.exeOperatorForArrayAndSingle(n,a,t[r]);t.splice(r-1,3,new i.RawValue(o)),r--}catch(e){throw console.log(e),e}}},{key:"exec_minus",value:function(e){for(var t=e.length;t--;)if("-"===e[t]&&(0===t||t>0&&"string"==typeof e[t-1])){var r=this.execCalcMethod(e[t+1]);e.splice(t,2,new i.RawValue(-r))}}},{key:"exec_plus",value:function(e){if("+"===e[0]){var t=this.execCalcMethod(e[1]);e.splice(0,2,new i.RawValue(t))}}},{key:"dealAllRefValue",value:function(){var e,t=this.args.concat();try{for(var r=0;r<t.length;r++)if(t[r]instanceof a.SUnitRefValue){e=t[r].calcCell.calcSheet;var i=t[r].str_expression;if(void 0===e.getCellByName(i)&&e.addCalcCell(i,{v:new l.CellVEmpty},n.FORMULA_STATUS.solved),"0"===t[r].str_expression.slice(1,t[r].str_expression.length))return s.errorObj.ERROR_NAME}}catch(e){}}},{key:"exeAllTwoArgOperator",value:function(e){this.execOperatorsWith2Args(["^"],e),this.execOperatorsWith2Args(["/","*"],e),this.execOperatorsWith2Args(["+","-"],e),this.execOperatorsWith2Args(["&"],e),this.execOperatorsWith2Args(["<",">",">=","<=","<>","="],e)}},{key:"calcLastArg",value:function(e){if("string"==typeof e)return new Error(s.ERROR_SYNTAX);if("function"!=typeof e.solveExpression||e.cellStatus===n.FORMULA_STATUS.solved)return e.cellObj.v;var t=e.solveExpression();return(0,l.convertToCellV)(t)}},{key:"solveExpression",value:function(){var e=this.args.concat();if(this.dealAllRefValue(),this.exec_minus(e),this.exec_plus(e),this.exeAllTwoArgOperator(e),1===e.length)return this.calcLastArg(e[0])}},{key:"update_cell_value",value:function(){var e=this.calcCell.cellObj;try{if(Array.isArray(this.args)&&1===this.args.length&&this.args[0]instanceof o.SUnitRangeRef)throw s.errorObj.ERROR_VALUE;e.v=this.solveExpression(),"string"==typeof e.v?e.t="s":"number"==typeof e.v&&(e.t="n")}catch(t){if(-1===s.errorMsgArr.indexOf(t.message))throw t;e.t="e",e.w=t.message,e.v=t.message}}}])&&d(t.prototype,r),p&&d(t,p),e}();t.StructuralExp=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpSyntaxUnitProxy=void 0;var n=r(3),i=r(53);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,l(t).apply(this,arguments))}var r,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(a=[{key:"getParser",value:function(){var e;if(this.typeArray.isIncludeType(n.SINGLE_REF))e=new i.SingleCellRefer(this.wholeStr,this.typeArray);else if(this.typeArray.isMarchTypeArray([n.RANG_REF,n.AA]))e=new i.AARangeRefer(this.wholeStr,this.typeArray);else{if(!this.typeArray.isIncludeType(n.RANG_REF))return null;e=new i.RangeRefer(this.wholeStr,this.typeArray)}return e.parseRefString(),e}},{key:"isReferUnit",value:function(){return this.typeArray.isIncludeType(n.SINGLE_REF)||this.typeArray.isIncludeType(n.RANG_REF)}}])&&o(r.prototype,a),c&&o(r,c),t}(r(25).BaseSyntaxUnitProxy);t.ExpSyntaxUnitProxy=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnNameArrayWithKey=t.emptyWorkbook=t.allFnObj=void 0;var n=(0,r(51).createDefaultFnCollection)().getAllFnObj();t.allFnObj=n;t.emptyWorkbook={sheets:{sheet1:{A1:{}}}};var i=Object.getOwnPropertyNames(n).map((function(e){return{key:e,title:e}}));t.fnNameArrayWithKey=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=new n.CellRange(0,0,0,0),this.ri=0,this.ci=0}var t,r,a;return t=e,(r=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(e,t){this.ri=e,this.ci=t}},{key:"size",value:function(){return this.range.size()}}])&&i(t.prototype,r),a&&i(t,a),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=0,this.y=0,this.ri=0,this.ci=0}},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=null,this.state="clear"}var t,r,i;return t=e,(r=[{key:"copy",value:function(e){return this.range=e,this.state="copy",this}},{key:"cut",value:function(e){return this.range=e,this.state="cut",this}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}var s=function(){function e(t,r,n){i(this,e),this.ci=t,this.operator=r,this.value=n}return o(e,[{key:"set",value:function(e,t){this.operator=e,this.value=t}},{key:"includes",value:function(e){var t=this.operator,r=this.value;return"all"===t||"in"===t&&r.includes(e)}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),e}(),l=function(){function e(t,r){i(this,e),this.ci=t,this.order=r}return o(e,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),e}(),u=function(){function e(){i(this,e),this.ref=null,this.filters=[],this.sort=null,this.flex=[]}return o(e,[{key:"setData",value:function(e){var t=e.ref,r=e.filters,n=e.sort;null!==t&&(this.ref=t,this.fitlers=r.map((function(e){return new s(e.ci,e.operator_single_func,e.value)})),n&&(this.sort=new l(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var e=this.ref,t=this.filters,r=this.sort;return{ref:e,filters:t.map((function(e){return e.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(e,t,r){var n=this.getFilter(e);null==n?this.filters.push(new s(e,t,r)):n.set(t,r)}},{key:"addFiexRows",value:function(e){this.flex=e}},{key:"setSort",value:function(e,t){this.sort=t?new l(e,t):null}},{key:"includes",value:function(e,t){return!!this.active()&&this.hrange().includes(e,t)}},{key:"getSet",value:function(e,t){for(var r=0;r<this.flex.length;r++)for(var n=this.flex[r],i=n.ri,a=n.set_total,o=n.state,s=i;s<a+i;s++)console.log(o,"114",t,i,o),!1===o&&t===i?(e.add(s+1),this.flex[r].state=!0):!0===o&&t===i&&(e.delete(s+1),this.flex[r].state=!1);return e}},{key:"includes2",value:function(e,t){for(var r=!1,n=0;n<this.flex.length;n++){var i=this.flex[n],a=i.ri,o=i.ci;e===a&&t===o&&(r=!0)}return r}},{key:"getSort",value:function(e){var t=this.sort;return t&&t.ci===e?t:null}},{key:"getFilter",value:function(e){for(var t=this.filters,r=0;r<t.length;r+=1)if(t[r].ci===e)return t[r];return null}},{key:"filteredRows",value:function(e){var t=new Set,r=new Set;if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=this.filters,s=i+1;s<=a;s+=1)for(var l=0;l<o.length;l+=1){var u=o[l],c=e(s,u.ci),f=c?c.text:"";if(!u.includes(f)){t.add(s);break}r.add(s)}return{rset:t,fset:r}}},{key:"items",value:function(e,t){var r={};if(this.active())for(var n=this.range(),i=n.sri,a=n.eri,o=i+1;o<=a;o+=1){var s=t(o,e);if(null===s||/^\s*$/.test(s.text))r[""]=(r[""]||0)+1;else{var l=s.text;r[l]=(r[l]||0)+1}}return r}},{key:"range",value:function(){return n.CellRange.valueOf(this.ref)}},{key:"hrange",value:function(){var e=this.range();return e.eri=e.sri,e}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Merges=void 0;var n=r(6);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._=t}var t,r,a;return t=e,(r=[{key:"forEach",value:function(e){this._.forEach(e)}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"deleteWithin",value:function(e){this._=this._.filter((function(t){return!t.within(e)}))}},{key:"getFirstIncludes",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"filterIntersects",value:function(t){return new e(this._.filter((function(e){return e.intersects(t)})))}},{key:"intersects",value:function(e){for(var t=0;t<this._.length;t+=1)if(this._[t].intersects(e))return!0;return!1}},{key:"union",value:function(e){var t=e;return this._.forEach((function(e){e.intersects(t)&&(t=e.union(t))})),t}},{key:"add",value:function(e){this.deleteWithin(e),this._.push(e)}},{key:"shift",value:function(e,t,r,n){this._.forEach((function(i){var a=i.sri,o=i.sci,s=i.eri,l=i.eci,u=i;"row"===e?a>=t?(u.sri+=r,u.eri+=r):a<t&&t<=s&&(u.eri+=r,n(a,o,r,0)):"column"===e&&(o>=t?(u.sci+=r,u.eci+=r):o<t&&t<=l&&(u.eci+=r,n(a,o,0,r)))}))}},{key:"move",value:function(e,t,r){this._.forEach((function(n){var i=n;i.within(e)&&(i.eri+=t,i.sri+=t,i.sci+=r,i.eci+=r)}))}},{key:"setData",value:function(e){return this._=e.map((function(e){return n.CellRange.valueOf(e)})),this}},{key:"getData",value:function(){return this._.map((function(e){return e.toString()}))}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Merges=a},function(e,t,r){"use strict";(function(e){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(120)),o=i(r(18));t.types=o;var s=r(131);t.parse=s.parse;var l=r(146),u=r(18);function c(e,t){return new l.Printer(t).print(e)}function f(t){e.stdout.write(t)}t.visit=u.visit,t.print=c,t.prettyPrint=function(e,t){return new l.Printer(t).printGenerically(e)},t.run=function(t,r){return function(e,t,r){a.default.readFile(e,"utf-8",(function(e,n){e?console.error(e):function(e,t,r){var n=r&&r.writeback||f;t(s.parse(e,r),(function(e){n(c(e,r).code)}))}(n,t,r)}))}(e.argv[2],t,r)}}).call(this,r(66))},function(e,t){},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(122)),o=n(r(124)),s=n(r(68)),l=n(r(67));t.default=function(e){var t=function(){var e=[],t=[];var r={use:function(n){var i=e.indexOf(n);return-1===i&&(i=e.length,e.push(n),t[i]=n(r)),t[i]}};return r}(),r=t.use(i.default);e.forEach(t.use),r.finalize();var n=t.use(a.default);return{Type:r.Type,builtInTypes:r.builtInTypes,namedTypes:r.namedTypes,builders:r.builders,defineMethod:r.defineMethod,getFieldNames:r.getFieldNames,getFieldValue:r.getFieldValue,eachField:r.eachField,someField:r.someField,getSupertypeNames:r.getSupertypeNames,getBuilderName:r.getBuilderName,astNodesAreEquivalent:t.use(o.default),finalize:r.finalize,Path:t.use(s.default),NodePath:t.use(l.default),PathVisitor:n,use:t.use,visit:n.visit}},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(67)),o=Object.prototype.hasOwnProperty;t.default=function(e){var t=e.use(i.default),r=e.use(a.default),n=t.builtInTypes.array,s=t.builtInTypes.object,l=t.builtInTypes.function,u=function e(){if(!(this instanceof e))throw new Error("PathVisitor constructor cannot be invoked without 'new'");this._reusableContextStack=[],this._methodNameTable=function(e){var r=Object.create(null);for(var n in e)/^visit[A-Z]/.test(n)&&(r[n.slice("visit".length)]=!0);for(var i=t.computeSupertypeLookupTable(r),a=Object.create(null),o=Object.keys(i),s=o.length,u=0;u<s;++u){var c=o[u];n="visit"+i[c],l.check(e[n])&&(a[c]=n)}return a}(this),this._shouldVisitComments=o.call(this._methodNameTable,"Block")||o.call(this._methodNameTable,"Line"),this.Context=h(this),this._visiting=!1,this._changeReported=!1};function c(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);return e}u.fromMethodsObject=function(e){if(e instanceof u)return e;if(!s.check(e))return new u;var t=function e(){if(!(this instanceof e))throw new Error("Visitor constructor cannot be invoked without 'new'");u.call(this)},r=t.prototype=Object.create(f);return r.constructor=t,c(r,e),c(t,u),l.assert(t.fromMethodsObject),l.assert(t.visit),new t},u.visit=function(e,t){return u.fromMethodsObject(t).visit(e)};var f=u.prototype;function d(e,i){if(!(e instanceof r))throw new Error("");if(!(i instanceof u))throw new Error("");var a=e.value;if(n.check(a))e.each(i.visitWithoutReset,i);else if(s.check(a)){var l=t.getFieldNames(a);i._shouldVisitComments&&a.comments&&l.indexOf("comments")<0&&l.push("comments");for(var c=l.length,f=[],d=0;d<c;++d){var h=l[d];o.call(a,h)||(a[h]=t.getFieldValue(a,h)),f.push(e.get(h))}for(d=0;d<c;++d)i.visitWithoutReset(f[d])}else;return e.value}function h(e){function t(n){if(!(this instanceof t))throw new Error("");if(!(this instanceof u))throw new Error("");if(!(n instanceof r))throw new Error("");Object.defineProperty(this,"visitor",{value:e,writable:!1,enumerable:!0,configurable:!1}),this.currentPath=n,this.needToCallTraverse=!0,Object.seal(this)}if(!(e instanceof u))throw new Error("");var n=t.prototype=Object.create(e);return n.constructor=t,c(n,p),t}f.visit=function(){if(this._visiting)throw new Error("Recursively calling visitor.visit(path) resets visitor state. Try this.visit(path) or this.traverse(path) instead.");this._visiting=!0,this._changeReported=!1,this._abortRequested=!1;for(var e,t=arguments.length,n=new Array(t),i=0;i<t;++i)n[i]=arguments[i];n[0]instanceof r||(n[0]=new r({root:n[0]}).get("root")),this.reset.apply(this,n);try{var a=this.visitWithoutReset(n[0]);e=!0}finally{if(this._visiting=!1,!e&&this._abortRequested)return n[0].value}return a},f.AbortRequest=function(){},f.abort=function(){var e=this;e._abortRequested=!0;var t=new e.AbortRequest;throw t.cancel=function(){e._abortRequested=!1},t},f.reset=function(e){},f.visitWithoutReset=function(e){if(this instanceof this.Context)return this.visitor.visitWithoutReset(e);if(!(e instanceof r))throw new Error("");var t=e.value,n=t&&"object"==typeof t&&"string"==typeof t.type&&this._methodNameTable[t.type];if(!n)return d(e,this);var i=this.acquireContext(e);try{return i.invokeVisitorMethod(n)}finally{this.releaseContext(i)}},f.acquireContext=function(e){return 0===this._reusableContextStack.length?new this.Context(e):this._reusableContextStack.pop().reset(e)},f.releaseContext=function(e){if(!(e instanceof this.Context))throw new Error("");this._reusableContextStack.push(e),e.currentPath=null},f.reportChanged=function(){this._changeReported=!0},f.wasChangeReported=function(){return this._changeReported};var p=Object.create(null);return p.reset=function(e){if(!(this instanceof this.Context))throw new Error("");if(!(e instanceof r))throw new Error("");return this.currentPath=e,this.needToCallTraverse=!0,this},p.invokeVisitorMethod=function(e){if(!(this instanceof this.Context))throw new Error("");if(!(this.currentPath instanceof r))throw new Error("");var t=this.visitor[e].call(this,this.currentPath);if(!1===t?this.needToCallTraverse=!1:void 0!==t&&(this.currentPath=this.currentPath.replace(t)[0],this.needToCallTraverse&&this.traverse(this.currentPath)),!1!==this.needToCallTraverse)throw new Error("Must either call this.traverse or return false in "+e);var n=this.currentPath;return n&&n.value},p.traverse=function(e,t){if(!(this instanceof this.Context))throw new Error("");if(!(e instanceof r))throw new Error("");if(!(this.currentPath instanceof r))throw new Error("");return this.needToCallTraverse=!1,d(e,u.fromMethodsObject(t||this.visitor))},p.visit=function(e,t){if(!(this instanceof this.Context))throw new Error("");if(!(e instanceof r))throw new Error("");if(!(this.currentPath instanceof r))throw new Error("");return this.needToCallTraverse=!1,u.fromMethodsObject(t||this.visitor).visitWithoutReset(e)},p.reportChanged=function(){this.visitor.reportChanged()},p.abort=function(){this.needToCallTraverse=!1,this.visitor.abort()},u},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=Object.prototype.hasOwnProperty;t.default=function(e){var t=e.use(i.default),r=t.Type,n=t.namedTypes,o=n.Node,s=n.Expression,l=t.builtInTypes.array,u=t.builders,c=function e(t,r){if(!(this instanceof e))throw new Error("Scope constructor cannot be invoked without 'new'");var n;if(d.assert(t.value),r){if(!(r instanceof e))throw new Error("");n=r.depth+1}else r=null,n=0;Object.defineProperties(this,{path:{value:t},node:{value:t.value},isGlobal:{value:!r,enumerable:!0},depth:{value:n},parent:{value:r},bindings:{value:{}},types:{value:{}}})},f=[n.Program,n.Function,n.CatchClause],d=r.or.apply(r,f);c.isEstablishedBy=function(e){return d.check(e)};var h=c.prototype;function p(e,r,i){var u=e.value;e.parent&&n.FunctionExpression.check(e.parent.node)&&e.parent.node.id&&v(e.parent.get("id"),r),u&&(l.check(u)?e.each((function(e){m(e,r,i)})):n.Function.check(u)?(e.get("params").each((function(e){v(e,r)})),m(e.get("body"),r,i)):n.TypeAlias&&n.TypeAlias.check(u)||n.InterfaceDeclaration&&n.InterfaceDeclaration.check(u)||n.TSTypeAliasDeclaration&&n.TSTypeAliasDeclaration.check(u)||n.TSInterfaceDeclaration&&n.TSInterfaceDeclaration.check(u)?function(e,t){var r=e.value;n.Pattern.assert(r),n.Identifier.check(r)&&(a.call(t,r.name)?t[r.name].push(e):t[r.name]=[e])}(e.get("id"),i):n.VariableDeclarator.check(u)?(v(e.get("id"),r),m(e.get("init"),r,i)):"ImportSpecifier"===u.type||"ImportNamespaceSpecifier"===u.type||"ImportDefaultSpecifier"===u.type?v(e.get(u.local?"local":u.name?"name":"id"),r):o.check(u)&&!s.check(u)&&t.eachField(u,(function(t,n){var a=e.get(t);if(!function(e,t){if(e.value===t)return!0;if(Array.isArray(e.value)&&0===e.value.length&&Array.isArray(t)&&0===t.length)return!0;return!1}(a,n))throw new Error("");m(a,r,i)})))}function m(e,t,r){var i=e.value;if(!i||s.check(i));else if(n.FunctionDeclaration.check(i)&&null!==i.id)v(e.get("id"),t);else if(n.ClassDeclaration&&n.ClassDeclaration.check(i))v(e.get("id"),t);else if(d.check(i)){if(n.CatchClause.check(i)&&n.Identifier.check(i.param)){var o=i.param.name,l=a.call(t,o);p(e.get("body"),t,r),l||delete t[o]}}else p(e,t,r)}function v(e,t){var r=e.value;n.Pattern.assert(r),n.Identifier.check(r)?a.call(t,r.name)?t[r.name].push(e):t[r.name]=[e]:n.AssignmentPattern&&n.AssignmentPattern.check(r)?v(e.get("left"),t):n.ObjectPattern&&n.ObjectPattern.check(r)?e.get("properties").each((function(e){var r=e.value;n.Pattern.check(r)?v(e,t):n.Property.check(r)?v(e.get("value"),t):n.SpreadProperty&&n.SpreadProperty.check(r)&&v(e.get("argument"),t)})):n.ArrayPattern&&n.ArrayPattern.check(r)?e.get("elements").each((function(e){var r=e.value;n.Pattern.check(r)?v(e,t):n.SpreadElement&&n.SpreadElement.check(r)&&v(e.get("argument"),t)})):n.PropertyPattern&&n.PropertyPattern.check(r)?v(e.get("pattern"),t):(n.SpreadElementPattern&&n.SpreadElementPattern.check(r)||n.SpreadPropertyPattern&&n.SpreadPropertyPattern.check(r))&&v(e.get("argument"),t)}return h.didScan=!1,h.declares=function(e){return this.scan(),a.call(this.bindings,e)},h.declaresType=function(e){return this.scan(),a.call(this.types,e)},h.declareTemporary=function(e){if(e){if(!/^[a-z$_]/i.test(e))throw new Error("")}else e="t$";e+=this.depth.toString(36)+"$",this.scan();for(var r=0;this.declares(e+r);)++r;var n=e+r;return this.bindings[n]=t.builders.identifier(n)},h.injectTemporary=function(e,t){e||(e=this.declareTemporary());var r=this.path.get("body");return n.BlockStatement.check(r.value)&&(r=r.get("body")),r.unshift(u.variableDeclaration("var",[u.variableDeclarator(e,t||null)])),e},h.scan=function(e){if(e||!this.didScan){for(var t in this.bindings)delete this.bindings[t];!function(e,t,r){var i=e.value;d.assert(i),n.CatchClause.check(i)?v(e.get("param"),t):p(e,t,r)}(this.path,this.bindings,this.types),this.didScan=!0}},h.getBindings=function(){return this.scan(),this.bindings},h.getTypes=function(){return this.scan(),this.types},h.lookup=function(e){for(var t=this;t&&!t.declares(e);t=t.parent);return t},h.lookupType=function(e){for(var t=this;t&&!t.declaresType(e);t=t.parent);return t},h.getGlobalScope=function(){for(var e=this;!e.isGlobal;)e=e.parent;return e},c},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5));t.default=function(e){var t=e.use(i.default),r=t.getFieldNames,n=t.getFieldValue,a=t.builtInTypes.array,o=t.builtInTypes.object,s=t.builtInTypes.Date,l=t.builtInTypes.RegExp,u=Object.prototype.hasOwnProperty;function c(e,t,r){return a.check(r)?r.length=0:r=null,d(e,t,r)}function f(e){return/[_$a-z][_$a-z0-9]*/i.test(e)?"."+e:"["+JSON.stringify(e)+"]"}function d(e,t,i){return e===t||(a.check(e)?function(e,t,r){a.assert(e);var n=e.length;if(!a.check(t)||t.length!==n)return r&&r.push("length"),!1;for(var i=0;i<n;++i){if(r&&r.push(i),i in e!=i in t)return!1;if(!d(e[i],t[i],r))return!1;if(r){var o=r.pop();if(o!==i)throw new Error(""+o)}}return!0}(e,t,i):o.check(e)?function(e,t,i){if(o.assert(e),!o.check(t))return!1;if(e.type!==t.type)return i&&i.push("type"),!1;var a=r(e),s=a.length,l=r(t),c=l.length;if(s===c){for(var f=0;f<s;++f){var h=a[f],p=n(e,h),m=n(t,h);if(i&&i.push(h),!d(p,m,i))return!1;if(i){var v=i.pop();if(v!==h)throw new Error(""+v)}}return!0}if(!i)return!1;var y=Object.create(null);for(f=0;f<s;++f)y[a[f]]=!0;for(f=0;f<c;++f){if(h=l[f],!u.call(y,h))return i.push(h),!1;delete y[h]}for(h in y){i.push(h);break}return!1}(e,t,i):s.check(e)?s.check(t)&&+e==+t:l.check(e)?l.check(t)&&e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.ignoreCase===t.ignoreCase:e==t)}return c.assert=function(e,t){var r=[];if(!c(e,t,r)){if(0!==r.length)throw new Error("Nodes differ in the following path: "+r.map(f).join(""));if(e!==t)throw new Error("Nodes must be equal")}},c},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(23)),a=n(r(5)),o=n(r(13));t.default=function(e){e.use(i.default);var t=e.use(a.default),r=t.Type.def,n=t.Type.or,s=e.use(o.default).defaults;r("JSXAttribute").bases("Node").build("name","value").field("name",n(r("JSXIdentifier"),r("JSXNamespacedName"))).field("value",n(r("Literal"),r("JSXExpressionContainer"),null),s.null),r("JSXIdentifier").bases("Identifier").build("name").field("name",String),r("JSXNamespacedName").bases("Node").build("namespace","name").field("namespace",r("JSXIdentifier")).field("name",r("JSXIdentifier")),r("JSXMemberExpression").bases("MemberExpression").build("object","property").field("object",n(r("JSXIdentifier"),r("JSXMemberExpression"))).field("property",r("JSXIdentifier")).field("computed",Boolean,s.false);var l=n(r("JSXIdentifier"),r("JSXNamespacedName"),r("JSXMemberExpression"));r("JSXSpreadAttribute").bases("Node").build("argument").field("argument",r("Expression"));var u=[n(r("JSXAttribute"),r("JSXSpreadAttribute"))];r("JSXExpressionContainer").bases("Expression").build("expression").field("expression",r("Expression")),r("JSXElement").bases("Expression").build("openingElement","closingElement","children").field("openingElement",r("JSXOpeningElement")).field("closingElement",n(r("JSXClosingElement"),null),s.null).field("children",[n(r("JSXElement"),r("JSXExpressionContainer"),r("JSXFragment"),r("JSXText"),r("Literal"))],s.emptyArray).field("name",l,(function(){return this.openingElement.name}),!0).field("selfClosing",Boolean,(function(){return this.openingElement.selfClosing}),!0).field("attributes",u,(function(){return this.openingElement.attributes}),!0),r("JSXOpeningElement").bases("Node").build("name","attributes","selfClosing").field("name",l).field("attributes",u,s.emptyArray).field("selfClosing",Boolean,s.false),r("JSXClosingElement").bases("Node").build("name").field("name",l),r("JSXFragment").bases("Expression").build("openingElement","closingElement","children").field("openingElement",r("JSXOpeningFragment")).field("closingElement",r("JSXClosingFragment")).field("children",[n(r("JSXElement"),r("JSXExpressionContainer"),r("JSXFragment"),r("JSXText"),r("Literal"))],s.emptyArray),r("JSXOpeningFragment").bases("Node").build(),r("JSXClosingFragment").bases("Node").build(),r("JSXText").bases("Literal").build("value").field("value",String),r("JSXEmptyExpression").bases("Expression").build(),r("JSXSpreadChild").bases("Expression").build("expression").field("expression",r("Expression"))},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(23)),a=n(r(5)),o=n(r(13));t.default=function(e){e.use(i.default);var t=e.use(a.default),r=e.use(o.default).defaults,n=t.Type.def,s=t.Type.or;n("VariableDeclaration").field("declarations",[s(n("VariableDeclarator"),n("Identifier"))]),n("Property").field("value",s(n("Expression"),n("Pattern"))),n("ArrayPattern").field("elements",[s(n("Pattern"),n("SpreadElement"),null)]),n("ObjectPattern").field("properties",[s(n("Property"),n("PropertyPattern"),n("SpreadPropertyPattern"),n("SpreadProperty"))]),n("ExportSpecifier").bases("ModuleSpecifier").build("id","name"),n("ExportBatchSpecifier").bases("Specifier").build(),n("ExportDeclaration").bases("Declaration").build("default","declaration","specifiers","source").field("default",Boolean).field("declaration",s(n("Declaration"),n("Expression"),null)).field("specifiers",[s(n("ExportSpecifier"),n("ExportBatchSpecifier"))],r.emptyArray).field("source",s(n("Literal"),null),r.null),n("Block").bases("Comment").build("value","leading","trailing"),n("Line").bases("Comment").build("value","leading","trailing")},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(72)),a=n(r(70));t.default=function(e){e.use(i.default),e.use(a.default)},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(72)),a=n(r(71)),o=n(r(5)),s=n(r(13));t.default=function(e){e.use(i.default),e.use(a.default);var t=e.use(o.default),r=t.namedTypes,n=t.Type.def,l=t.Type.or,u=e.use(s.default).defaults,c=t.Type.from((function(e,t){return!(!r.StringLiteral||!r.StringLiteral.check(e,t))||!(!r.Literal||!r.Literal.check(e,t)||"string"!=typeof e.value)}),"StringLiteral");n("TSType").bases("Node");var f=l(n("Identifier"),n("TSQualifiedName"));n("TSTypeReference").bases("TSType","TSHasOptionalTypeParameterInstantiation").build("typeName","typeParameters").field("typeName",f),n("TSHasOptionalTypeParameterInstantiation").field("typeParameters",l(n("TSTypeParameterInstantiation"),null),u.null),n("TSHasOptionalTypeParameters").field("typeParameters",l(n("TSTypeParameterDeclaration"),null,void 0),u.null),n("TSHasOptionalTypeAnnotation").field("typeAnnotation",l(n("TSTypeAnnotation"),null),u.null),n("TSQualifiedName").bases("Node").build("left","right").field("left",f).field("right",f),n("TSAsExpression").bases("Expression","Pattern").build("expression","typeAnnotation").field("expression",n("Expression")).field("typeAnnotation",n("TSType")).field("extra",l({parenthesized:Boolean},null),u.null),n("TSNonNullExpression").bases("Expression","Pattern").build("expression").field("expression",n("Expression")),["TSAnyKeyword","TSBigIntKeyword","TSBooleanKeyword","TSNeverKeyword","TSNullKeyword","TSNumberKeyword","TSObjectKeyword","TSStringKeyword","TSSymbolKeyword","TSUndefinedKeyword","TSUnknownKeyword","TSVoidKeyword","TSThisType"].forEach((function(e){n(e).bases("TSType").build()})),n("TSArrayType").bases("TSType").build("elementType").field("elementType",n("TSType")),n("TSLiteralType").bases("TSType").build("literal").field("literal",l(n("NumericLiteral"),n("StringLiteral"),n("BooleanLiteral"),n("TemplateLiteral"),n("UnaryExpression"))),["TSUnionType","TSIntersectionType"].forEach((function(e){n(e).bases("TSType").build("types").field("types",[n("TSType")])})),n("TSConditionalType").bases("TSType").build("checkType","extendsType","trueType","falseType").field("checkType",n("TSType")).field("extendsType",n("TSType")).field("trueType",n("TSType")).field("falseType",n("TSType")),n("TSInferType").bases("TSType").build("typeParameter").field("typeParameter",n("TSTypeParameter")),n("TSParenthesizedType").bases("TSType").build("typeAnnotation").field("typeAnnotation",n("TSType"));var d=[l(n("Identifier"),n("RestElement"),n("ArrayPattern"),n("ObjectPattern"))];["TSFunctionType","TSConstructorType"].forEach((function(e){n(e).bases("TSType","TSHasOptionalTypeParameters","TSHasOptionalTypeAnnotation").build("parameters").field("parameters",d)})),n("TSDeclareFunction").bases("Declaration","TSHasOptionalTypeParameters").build("id","params","returnType").field("declare",Boolean,u.false).field("async",Boolean,u.false).field("generator",Boolean,u.false).field("id",l(n("Identifier"),null),u.null).field("params",[n("Pattern")]).field("returnType",l(n("TSTypeAnnotation"),n("Noop"),null),u.null),n("TSDeclareMethod").bases("Declaration","TSHasOptionalTypeParameters").build("key","params","returnType").field("async",Boolean,u.false).field("generator",Boolean,u.false).field("params",[n("Pattern")]).field("abstract",Boolean,u.false).field("accessibility",l("public","private","protected",void 0),u[void 0]).field("static",Boolean,u.false).field("computed",Boolean,u.false).field("optional",Boolean,u.false).field("key",l(n("Identifier"),n("StringLiteral"),n("NumericLiteral"),n("Expression"))).field("kind",l("get","set","method","constructor"),(function(){return"method"})).field("access",l("public","private","protected",void 0),u[void 0]).field("decorators",l([n("Decorator")],null),u.null).field("returnType",l(n("TSTypeAnnotation"),n("Noop"),null),u.null),n("TSMappedType").bases("TSType").build("typeParameter","typeAnnotation").field("readonly",l(Boolean,"+","-"),u.false).field("typeParameter",n("TSTypeParameter")).field("optional",l(Boolean,"+","-"),u.false).field("typeAnnotation",l(n("TSType"),null),u.null),n("TSTupleType").bases("TSType").build("elementTypes").field("elementTypes",[n("TSType")]),n("TSRestType").bases("TSType").build("typeAnnotation").field("typeAnnotation",n("TSType")),n("TSOptionalType").bases("TSType").build("typeAnnotation").field("typeAnnotation",n("TSType")),n("TSIndexedAccessType").bases("TSType").build("objectType","indexType").field("objectType",n("TSType")).field("indexType",n("TSType")),n("TSTypeOperator").bases("TSType").build("operator").field("operator",String).field("typeAnnotation",n("TSType")),n("TSTypeAnnotation").bases("Node").build("typeAnnotation").field("typeAnnotation",l(n("TSType"),n("TSTypeAnnotation"))),n("TSIndexSignature").bases("Declaration","TSHasOptionalTypeAnnotation").build("parameters","typeAnnotation").field("parameters",[n("Identifier")]).field("readonly",Boolean,u.false),n("TSPropertySignature").bases("Declaration","TSHasOptionalTypeAnnotation").build("key","typeAnnotation","optional").field("key",n("Expression")).field("computed",Boolean,u.false).field("readonly",Boolean,u.false).field("optional",Boolean,u.false).field("initializer",l(n("Expression"),null),u.null),n("TSMethodSignature").bases("Declaration","TSHasOptionalTypeParameters","TSHasOptionalTypeAnnotation").build("key","parameters","typeAnnotation").field("key",n("Expression")).field("computed",Boolean,u.false).field("optional",Boolean,u.false).field("parameters",d),n("TSTypePredicate").bases("TSTypeAnnotation").build("parameterName","typeAnnotation").field("parameterName",l(n("Identifier"),n("TSThisType"))).field("typeAnnotation",n("TSTypeAnnotation")),["TSCallSignatureDeclaration","TSConstructSignatureDeclaration"].forEach((function(e){n(e).bases("Declaration","TSHasOptionalTypeParameters","TSHasOptionalTypeAnnotation").build("parameters","typeAnnotation").field("parameters",d)})),n("TSEnumMember").bases("Node").build("id","initializer").field("id",l(n("Identifier"),c)).field("initializer",l(n("Expression"),null),u.null),n("TSTypeQuery").bases("TSType").build("exprName").field("exprName",l(f,n("TSImportType")));var h=l(n("TSCallSignatureDeclaration"),n("TSConstructSignatureDeclaration"),n("TSIndexSignature"),n("TSMethodSignature"),n("TSPropertySignature"));n("TSTypeLiteral").bases("TSType").build("members").field("members",[h]),n("TSTypeParameter").bases("Identifier").build("name","constraint","default").field("name",String).field("constraint",l(n("TSType"),void 0),u[void 0]).field("default",l(n("TSType"),void 0),u[void 0]),n("TSTypeAssertion").bases("Expression","Pattern").build("typeAnnotation","expression").field("typeAnnotation",n("TSType")).field("expression",n("Expression")).field("extra",l({parenthesized:Boolean},null),u.null),n("TSTypeParameterDeclaration").bases("Declaration").build("params").field("params",[n("TSTypeParameter")]),n("TSTypeParameterInstantiation").bases("Node").build("params").field("params",[n("TSType")]),n("TSEnumDeclaration").bases("Declaration").build("id","members").field("id",n("Identifier")).field("const",Boolean,u.false).field("declare",Boolean,u.false).field("members",[n("TSEnumMember")]).field("initializer",l(n("Expression"),null),u.null),n("TSTypeAliasDeclaration").bases("Declaration","TSHasOptionalTypeParameters").build("id","typeAnnotation").field("id",n("Identifier")).field("declare",Boolean,u.false).field("typeAnnotation",n("TSType")),n("TSModuleBlock").bases("Node").build("body").field("body",[n("Statement")]),n("TSModuleDeclaration").bases("Declaration").build("id","body").field("id",l(c,f)).field("declare",Boolean,u.false).field("global",Boolean,u.false).field("body",l(n("TSModuleBlock"),n("TSModuleDeclaration"),null),u.null),n("TSImportType").bases("TSType","TSHasOptionalTypeParameterInstantiation").build("argument","qualifier","typeParameters").field("argument",c).field("qualifier",l(f,void 0),u[void 0]),n("TSImportEqualsDeclaration").bases("Declaration").build("id","moduleReference").field("id",n("Identifier")).field("isExport",Boolean,u.false).field("moduleReference",l(f,n("TSExternalModuleReference"))),n("TSExternalModuleReference").bases("Declaration").build("expression").field("expression",c),n("TSExportAssignment").bases("Statement").build("expression").field("expression",n("Expression")),n("TSNamespaceExportDeclaration").bases("Declaration").build("id").field("id",n("Identifier")),n("TSInterfaceBody").bases("Node").build("body").field("body",[h]),n("TSExpressionWithTypeArguments").bases("TSType","TSHasOptionalTypeParameterInstantiation").build("expression","typeParameters").field("expression",f),n("TSInterfaceDeclaration").bases("Declaration","TSHasOptionalTypeParameters").build("id","body").field("id",f).field("declare",Boolean,u.false).field("extends",l([n("TSExpressionWithTypeArguments")],null),u.null).field("body",n("TSInterfaceBody")),n("TSParameterProperty").bases("Pattern").build("parameter").field("accessibility",l("public","private","protected",void 0),u[void 0]).field("readonly",Boolean,u.false).field("parameter",l(n("Identifier"),n("AssignmentPattern"))),n("ClassProperty").field("access",l("public","private","protected",void 0),u[void 0]),n("ClassBody").field("body",[l(n("MethodDefinition"),n("VariableDeclarator"),n("ClassPropertyDefinition"),n("ClassProperty"),n("ClassPrivateProperty"),n("ClassMethod"),n("ClassPrivateMethod"),n("TSDeclareMethod"),h)])},e.exports=t.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(5)),a=n(r(13)),o=n(r(44));t.default=function(e){e.use(o.default);var t=e.use(i.default),r=t.Type,n=t.Type.def,s=r.or,l=e.use(a.default).defaults;n("OptionalMemberExpression").bases("MemberExpression").build("object","property","computed","optional").field("optional",Boolean,l.true),n("OptionalCallExpression").bases("CallExpression").build("callee","arguments","optional").field("optional",Boolean,l.true);var u=s("||","&&","??");n("LogicalExpression").field("operator",u)},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.namedTypes||(t.namedTypes={})},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=i(r(18)),s=o.builders,l=o.builtInTypes.object,u=o.builtInTypes.array,c=r(45),f=r(29),d=r(78),h=i(r(20));t.parse=function(e,t){t=c.normalize(t);var n,i,a=f.fromString(e,t),o=a.toString({tabWidth:t.tabWidth,reuseWhitespace:!1,useTabs:!1}),l=[],u=t.parser.parse(o,{jsx:!0,loc:!0,locations:!0,range:t.range,comment:!0,onComment:l,tolerant:h.getOption(t,"tolerant",!0),ecmaVersion:6,sourceType:h.getOption(t,"sourceType","module")}),m=Array.isArray(u.tokens)?u.tokens:r(77).tokenize(o,{loc:!0});delete u.tokens,m.forEach((function(e){"string"!=typeof e.value&&(e.value=a.sliceString(e.loc.start,e.loc.end))})),Array.isArray(u.comments)&&(l=u.comments,delete u.comments),u.loc?h.fixFaultyLocations(u,a):u.loc={start:a.firstPos(),end:a.lastPos()},u.loc.lines=a,u.loc.indent=0,"Program"===u.type?(i=u,(n=s.file(u,t.sourceFileName||null)).loc={start:a.firstPos(),end:a.lastPos(),lines:a,indent:0}):"File"===u.type&&(i=(n=u).program),t.tokens&&(n.tokens=m);var v=h.getTrueLoc({type:i.type,loc:i.loc,body:[],comments:l},a);return i.loc.start=v.start,i.loc.end=v.end,d.attach(l,i.body.length?n.program:n,a),new p(a,m).copy(n)};var p=function e(t,r){a.default.ok(this instanceof e),this.lines=t,this.tokens=r,this.startTokenIndex=0,this.endTokenIndex=r.length,this.indent=0,this.seen=new Map},m=p.prototype;m.copy=function(e){if(this.seen.has(e))return this.seen.get(e);if(u.check(e)){var t=new Array(e.length);return this.seen.set(e,t),e.forEach((function(e,r){t[r]=this.copy(e)}),this),t}if(!l.check(e))return e;h.fixFaultyLocations(e,this.lines);t=Object.create(Object.getPrototypeOf(e),{original:{value:e,configurable:!1,enumerable:!1,writable:!0}});this.seen.set(e,t);var r=e.loc,n=this.indent,i=n,a=this.startTokenIndex,o=this.endTokenIndex;r&&(("Block"===e.type||"Line"===e.type||"CommentBlock"===e.type||"CommentLine"===e.type||this.lines.isPrecededOnlyByWhitespace(r.start))&&(i=this.indent=r.start.column),r.lines=this.lines,r.tokens=this.tokens,r.indent=i,this.findTokenRange(r));for(var s=Object.keys(e),c=s.length,f=0;f<c;++f){var d=s[f];"loc"===d?t[d]=e[d]:"tokens"===d&&"File"===e.type?t[d]=e[d]:t[d]=this.copy(e[d])}return this.indent=n,this.startTokenIndex=a,this.endTokenIndex=o,t},m.findTokenRange=function(e){for(;this.startTokenIndex>0;){var t=e.tokens[this.startTokenIndex];if(!(h.comparePos(e.start,t.loc.start)<0))break;--this.startTokenIndex}for(;this.endTokenIndex<e.tokens.length;){t=e.tokens[this.endTokenIndex];if(!(h.comparePos(t.loc.end,e.end)<0))break;++this.endTokenIndex}for(;this.startTokenIndex<this.endTokenIndex;){t=e.tokens[this.startTokenIndex];if(!(h.comparePos(t.loc.start,e.start)<0))break;++this.startTokenIndex}for(e.start.token=this.startTokenIndex;this.endTokenIndex>this.startTokenIndex;){t=e.tokens[this.endTokenIndex-1];if(!(h.comparePos(e.end,t.loc.end)<0))break;--this.endTokenIndex}e.end.token=this.endTokenIndex}},function(e,t,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,l=o(e),u=1;u<arguments.length;u++){for(var c in r=Object(arguments[u]))i.call(r,c)&&(l[c]=r[c]);if(n){s=n(r);for(var f=0;f<s.length;f++)a.call(r,s[f])&&(l[s[f]]=r[s[f]])}}return l}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,a=n.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=a)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),l=n[r];r<a;l=n[++r])m(l)||!b(l)?o+=" "+l:o+=" "+s(l);return o},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var a,o={};function s(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&t._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),c(n,e,n.depth)}function l(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function u(e,t){return e}function c(e,r,n){if(e.customInspect&&r&&S(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return y(i)||(i=c(e,i,n)),i}var a=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(v(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(a)return a;var o=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),A(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return f(r);if(0===o.length){if(S(r)){var l=r.name?": "+r.name:"";return e.stylize("[Function"+l+"]","special")}if(E(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return e.stylize(Date.prototype.toString.call(r),"date");if(A(r))return f(r)}var u,b="",w=!1,R=["{","}"];(h(r)&&(w=!0,R=["[","]"]),S(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return E(r)&&(b=" "+RegExp.prototype.toString.call(r)),x(r)&&(b=" "+Date.prototype.toUTCString.call(r)),A(r)&&(b=" "+f(r)),0!==o.length||w&&0!=r.length?n<0?E(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=w?function(e,t,r,n,i){for(var a=[],o=0,s=t.length;o<s;++o)O(t,String(o))?a.push(d(e,t,r,n,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(d(e,t,r,n,i,!0))})),a}(e,r,n,s,o):o.map((function(t){return d(e,r,n,s,t,w)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,b,R)):R[0]+b+R[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,a){var o,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),O(n,i)||(o="["+i+"]"),s||(e.seen.indexOf(l.value)<0?(s=m(r)?c(e,l.value,null):c(e,l.value,r-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function h(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function E(e){return b(e)&&"[object RegExp]"===w(e)}function b(e){return"object"==typeof e&&null!==e}function x(e){return b(e)&&"[object Date]"===w(e)}function A(e){return b(e)&&("[object Error]"===w(e)||e instanceof Error)}function S(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(g(a)&&(a=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!o[r])if(new RegExp("\\b"+r+"\\b","i").test(a)){var n=e.pid;o[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else o[r]=function(){};return o[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=E,t.isObject=b,t.isDate=x,t.isError=A,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(134);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",T(),t.format.apply(t,arguments))},t.inherits=r(135),t._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var _="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(_&&e[_]){var t;if("function"!=typeof(t=e[_]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),_&&Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=_,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,r).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(D,t,o)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(66))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20);t.parse=function(e,t){var i=[],a=r(77).parse(e,{loc:!0,locations:!0,comment:!0,onComment:i,range:n.getOption(t,"range",!1),tolerant:n.getOption(t,"tolerant",!0),tokens:!0});return Array.isArray(a.comments)||(a.comments=i),a}},function(e,t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},function(e,t,r){var n=r(24);function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},i.prototype.add=function(e){var t,r,i,a,o,s;t=this._last,r=e,i=t.generatedLine,a=r.generatedLine,o=t.generatedColumn,s=r.generatedColumn,a>i||a==i&&s>=o||n.compareByGeneratedPositionsInflated(t,r)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},i.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.MappingList=i},function(e,t,r){var n=r(24),i=r(140),a=r(76).ArraySet,o=r(75),s=r(141).quickSort;function l(e,t){var r=e;return"string"==typeof e&&(r=n.parseSourceMapInput(e)),null!=r.sections?new f(r,t):new u(r,t)}function u(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var i=n.getArg(r,"version"),o=n.getArg(r,"sources"),s=n.getArg(r,"names",[]),l=n.getArg(r,"sourceRoot",null),u=n.getArg(r,"sourcesContent",null),c=n.getArg(r,"mappings"),f=n.getArg(r,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);l&&(l=n.normalize(l)),o=o.map(String).map(n.normalize).map((function(e){return l&&n.isAbsolute(l)&&n.isAbsolute(e)?n.relative(l,e):e})),this._names=a.fromArray(s.map(String),!0),this._sources=a.fromArray(o,!0),this._absoluteSources=this._sources.toArray().map((function(e){return n.computeSourceURL(l,e,t)})),this.sourceRoot=l,this.sourcesContent=u,this._mappings=c,this._sourceMapURL=t,this.file=f}function c(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function f(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var i=n.getArg(r,"version"),o=n.getArg(r,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new a,this._names=new a;var s={line:-1,column:0};this._sections=o.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var r=n.getArg(e,"offset"),i=n.getArg(r,"line"),a=n.getArg(r,"column");if(i<s.line||i===s.line&&a<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=r,{generatedOffset:{generatedLine:i+1,generatedColumn:a+1},consumer:new l(n.getArg(e,"map"),t)}}))}l.fromSourceMap=function(e,t){return u.fromSourceMap(e,t)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},l.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(e,t,r){var i,a=t||null;switch(r||l.GENERATED_ORDER){case l.GENERATED_ORDER:i=this._generatedMappings;break;case l.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var o=this.sourceRoot;i.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=n.computeSourceURL(o,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,a)},l.prototype.allGeneratedPositionsFor=function(e){var t=n.getArg(e,"line"),r={source:n.getArg(e,"source"),originalLine:t,originalColumn:n.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];var a=[],o=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(o>=0){var s=this._originalMappings[o];if(void 0===e.column)for(var l=s.originalLine;s&&s.originalLine===l;)a.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++o];else for(var u=s.originalColumn;s&&s.originalLine===t&&s.originalColumn==u;)a.push({line:n.getArg(s,"generatedLine",null),column:n.getArg(s,"generatedColumn",null),lastColumn:n.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++o]}return a},t.SourceMapConsumer=l,u.prototype=Object.create(l.prototype),u.prototype.consumer=l,u.prototype._findSourceIndex=function(e){var t,r=e;if(null!=this.sourceRoot&&(r=n.relative(this.sourceRoot,r)),this._sources.has(r))return this._sources.indexOf(r);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},u.fromSourceMap=function(e,t){var r=Object.create(u.prototype),i=r._names=a.fromArray(e._names.toArray(),!0),o=r._sources=a.fromArray(e._sources.toArray(),!0);r.sourceRoot=e._sourceRoot,r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot),r.file=e._file,r._sourceMapURL=t,r._absoluteSources=r._sources.toArray().map((function(e){return n.computeSourceURL(r.sourceRoot,e,t)}));for(var l=e._mappings.toArray().slice(),f=r.__generatedMappings=[],d=r.__originalMappings=[],h=0,p=l.length;h<p;h++){var m=l[h],v=new c;v.generatedLine=m.generatedLine,v.generatedColumn=m.generatedColumn,m.source&&(v.source=o.indexOf(m.source),v.originalLine=m.originalLine,v.originalColumn=m.originalColumn,m.name&&(v.name=i.indexOf(m.name)),d.push(v)),f.push(v)}return s(r.__originalMappings,n.compareByOriginalPositions),r},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),u.prototype._parseMappings=function(e,t){for(var r,i,a,l,u,f=1,d=0,h=0,p=0,m=0,v=0,y=e.length,g=0,E={},b={},x=[],A=[];g<y;)if(";"===e.charAt(g))f++,g++,d=0;else if(","===e.charAt(g))g++;else{for((r=new c).generatedLine=f,l=g;l<y&&!this._charIsMappingSeparator(e,l);l++);if(a=E[i=e.slice(g,l)])g+=i.length;else{for(a=[];g<l;)o.decode(e,g,b),u=b.value,g=b.rest,a.push(u);if(2===a.length)throw new Error("Found a source, but no line and column");if(3===a.length)throw new Error("Found a source and line, but no column");E[i]=a}r.generatedColumn=d+a[0],d=r.generatedColumn,a.length>1&&(r.source=m+a[1],m+=a[1],r.originalLine=h+a[2],h=r.originalLine,r.originalLine+=1,r.originalColumn=p+a[3],p=r.originalColumn,a.length>4&&(r.name=v+a[4],v+=a[4])),A.push(r),"number"==typeof r.originalLine&&x.push(r)}s(A,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=A,s(x,n.compareByOriginalPositions),this.__originalMappings=x},u.prototype._findMapping=function(e,t,r,n,a,o){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return i.search(e,t,a,o)},u.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(r>=0){var i=this._generatedMappings[r];if(i.generatedLine===t.generatedLine){var a=n.getArg(i,"source",null);null!==a&&(a=this._sources.at(a),a=n.computeSourceURL(this.sourceRoot,a,this._sourceMapURL));var o=n.getArg(i,"name",null);return null!==o&&(o=this._names.at(o)),{source:a,line:n.getArg(i,"originalLine",null),column:n.getArg(i,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))},u.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];var i,a=e;if(null!=this.sourceRoot&&(a=n.relative(this.sourceRoot,a)),null!=this.sourceRoot&&(i=n.urlParse(this.sourceRoot))){var o=a.replace(/^file:\/\//,"");if("file"==i.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!i.path||"/"==i.path)&&this._sources.has("/"+a))return this.sourcesContent[this._sources.indexOf("/"+a)]}if(t)return null;throw new Error('"'+a+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){var t=n.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var r={source:t,originalLine:n.getArg(e,"line"),originalColumn:n.getArg(e,"column")},i=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(i>=0){var a=this._originalMappings[i];if(a.source===r.source)return{line:n.getArg(a,"generatedLine",null),column:n.getArg(a,"generatedColumn",null),lastColumn:n.getArg(a,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},t.BasicSourceMapConsumer=u,f.prototype=Object.create(l.prototype),f.prototype.constructor=l,f.prototype._version=3,Object.defineProperty(f.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),f.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=i.search(t,this._sections,(function(e,t){var r=e.generatedLine-t.generatedOffset.generatedLine;return r||e.generatedColumn-t.generatedOffset.generatedColumn})),a=this._sections[r];return a?a.consumer.originalPositionFor({line:t.generatedLine-(a.generatedOffset.generatedLine-1),column:t.generatedColumn-(a.generatedOffset.generatedLine===t.generatedLine?a.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},f.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},f.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var n=this._sections[r].consumer.sourceContentFor(e,!0);if(n)return n}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},f.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer._findSourceIndex(n.getArg(e,"source"))){var i=r.consumer.generatedPositionFor(e);if(i)return{line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},f.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var i=this._sections[r],a=i.consumer._generatedMappings,o=0;o<a.length;o++){var l=a[o],u=i.consumer._sources.at(l.source);u=n.computeSourceURL(i.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var c=null;l.name&&(c=i.consumer._names.at(l.name),this._names.add(c),c=this._names.indexOf(c));var f={source:u,generatedLine:l.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(i.generatedOffset.generatedLine===l.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:c};this.__generatedMappings.push(f),"number"==typeof f.originalLine&&this.__originalMappings.push(f)}s(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),s(this.__originalMappings,n.compareByOriginalPositions)},t.IndexedSourceMapConsumer=f},function(e,t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,r,n,i){if(0===r.length)return-1;var a=function e(r,n,i,a,o,s){var l=Math.floor((n-r)/2)+r,u=o(i,a[l],!0);return 0===u?l:u>0?n-l>1?e(l,n,i,a,o,s):s==t.LEAST_UPPER_BOUND?n<a.length?n:-1:l:l-r>1?e(r,l,i,a,o,s):s==t.LEAST_UPPER_BOUND?l:r<0?-1:r}(-1,r.length,e,r,n,i||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&0===n(r[a],r[a-1],!0);)--a;return a}},function(e,t){function r(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function n(e,t,i,a){if(i<a){var o=i-1;r(e,(c=i,f=a,Math.round(c+Math.random()*(f-c))),a);for(var s=e[a],l=i;l<a;l++)t(e[l],s)<=0&&r(e,o+=1,l);r(e,o+1,l);var u=o+1;n(e,t,i,u-1),n(e,t,u+1,a)}var c,f}t.quickSort=function(e,t){n(e,t,0,e.length-1)}},function(e,t,r){var n=r(74).SourceMapGenerator,i=r(24),a=/(\r?\n)/,o="$$$isSourceNode$$$";function s(e,t,r,n,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==i?null:i,this[o]=!0,null!=n&&this.add(n)}s.fromStringWithSourceMap=function(e,t,r){var n=new s,o=e.split(a),l=0,u=function(){return e()+(e()||"");function e(){return l<o.length?o[l++]:void 0}},c=1,f=0,d=null;return t.eachMapping((function(e){if(null!==d){if(!(c<e.generatedLine)){var t=(r=o[l]||"").substr(0,e.generatedColumn-f);return o[l]=r.substr(e.generatedColumn-f),f=e.generatedColumn,h(d,t),void(d=e)}h(d,u()),c++,f=0}for(;c<e.generatedLine;)n.add(u()),c++;if(f<e.generatedColumn){var r=o[l]||"";n.add(r.substr(0,e.generatedColumn)),o[l]=r.substr(e.generatedColumn),f=e.generatedColumn}d=e}),this),l<o.length&&(d&&h(d,u()),n.add(o.splice(l).join(""))),t.sources.forEach((function(e){var a=t.sourceContentFor(e);null!=a&&(null!=r&&(e=i.join(r,e)),n.setSourceContent(e,a))})),n;function h(e,t){if(null===e||void 0===e.source)n.add(t);else{var a=r?i.join(r,e.source):e.source;n.add(new s(e.originalLine,e.originalColumn,a,t,e.name))}}},s.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},s.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},s.prototype.walk=function(e){for(var t,r=0,n=this.children.length;r<n;r++)(t=this.children[r])[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(e){var t,r,n=this.children.length;if(n>0){for(t=[],r=0;r<n-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},s.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[o]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},s.prototype.setSourceContent=function(e,t){this.sourceContents[i.toSetString(e)]=t},s.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);var n=Object.keys(this.sourceContents);for(t=0,r=n.length;t<r;t++)e(i.fromSetString(n[t]),this.sourceContents[n[t]])},s.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},s.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new n(e),i=!1,a=null,o=null,s=null,l=null;return this.walk((function(e,n){t.code+=e,null!==n.source&&null!==n.line&&null!==n.column?(a===n.source&&o===n.line&&s===n.column&&l===n.name||r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name}),a=n.source,o=n.line,s=n.column,l=n.name,i=!0):i&&(r.addMapping({generated:{line:t.line,column:t.column}}),a=null,i=!1);for(var u=0,c=e.length;u<c;u++)10===e.charCodeAt(u)?(t.line++,t.column=0,u+1===c?(a=null,i=!1):i&&r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}},t.SourceNode=s},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(19)),a=r(20),o=function(){function e(e,t,r){void 0===r&&(r=t),this.sourceLines=e,this.sourceLoc=t,this.targetLoc=r}return e.prototype.slice=function(t,r,n){void 0===n&&(n=t.lastPos());var o=this.sourceLines,s=this.sourceLoc,u=this.targetLoc;function c(e){var l=s[e],c=u[e],f=r;return"end"===e?f=n:i.default.strictEqual(e,"start"),function(e,t,r,n,o){var s=a.comparePos(n,o);if(0===s)return t;if(s<0){var l=e.skipSpaces(t)||e.lastPos(),u=r.skipSpaces(n)||r.lastPos(),c=o.line-u.line;for(l.line+=c,u.line+=c,c>0?(l.column=0,u.column=0):i.default.strictEqual(c,0);a.comparePos(u,o)<0&&r.nextPos(u,!0);)i.default.ok(e.nextPos(l,!0)),i.default.strictEqual(e.charAt(l),r.charAt(u))}else{l=e.skipSpaces(t,!0)||e.firstPos(),u=r.skipSpaces(n,!0)||r.firstPos(),c=o.line-u.line;for(l.line+=c,u.line+=c,c<0?(l.column=e.getLineLength(l.line),u.column=r.getLineLength(u.line)):i.default.strictEqual(c,0);a.comparePos(o,u)<0&&r.prevPos(u,!0);)i.default.ok(e.prevPos(l,!0)),i.default.strictEqual(e.charAt(l),r.charAt(u))}return l}(o,l,t,c,f)}if(a.comparePos(r,u.start)<=0)if(a.comparePos(u.end,n)<=0)u={start:l(u.start,r.line,r.column),end:l(u.end,r.line,r.column)};else{if(a.comparePos(n,u.start)<=0)return null;s={start:s.start,end:c("end")},u={start:l(u.start,r.line,r.column),end:l(n,r.line,r.column)}}else{if(a.comparePos(u.end,r)<=0)return null;a.comparePos(u.end,n)<=0?(s={start:c("start"),end:s.end},u={start:{line:1,column:0},end:l(u.end,r.line,r.column)}):(s={start:c("start"),end:c("end")},u={start:{line:1,column:0},end:l(n,r.line,r.column)})}return new e(this.sourceLines,s,u)},e.prototype.add=function(t,r){return new e(this.sourceLines,this.sourceLoc,{start:s(this.targetLoc.start,t,r),end:s(this.targetLoc.end,t,r)})},e.prototype.subtract=function(t,r){return new e(this.sourceLines,this.sourceLoc,{start:l(this.targetLoc.start,t,r),end:l(this.targetLoc.end,t,r)})},e.prototype.indent=function(t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),0===t)return this;var i=this.targetLoc,a=i.start.line,o=i.end.line;if(r&&1===a&&1===o)return this;if(i={start:i.start,end:i.end},!r||a>1){var s=i.start.column+t;i.start={line:a,column:n?Math.max(0,s):s}}if(!r||o>1){var l=i.end.column+t;i.end={line:o,column:n?Math.max(0,l):l}}return new e(this.sourceLines,this.sourceLoc,i)},e}();function s(e,t,r){return{line:e.line+t-1,column:1===e.line?e.column+r:e.column}}function l(e,t,r){return{line:e.line-t+1,column:e.line===t?e.column-r:e.column}}t.default=o},function(e,t,r){"use strict";var n=Object,i=Object.defineProperty,a=Object.create;function o(e,t,r){if(i)try{i.call(n,e,t,{value:r})}catch(n){e[t]=r}else e[t]=r}function s(e){return e&&(o(e,"call",e.call),o(e,"apply",e.apply)),e}s(i),s(a);var l=s(Object.prototype.hasOwnProperty),u=s(Number.prototype.toString),c=s(String.prototype.slice),f=function(){};function d(e){return a?a.call(n,e):(f.prototype=e||null,new f)}var h=Math.random,p=d(null);function m(){do{var e=v(c.call(u.call(h(),36),2))}while(l.call(p,e));return p[e]=e}function v(e){var t={};return t[e]=!0,Object.keys(t)[0]}t.makeUniqueKey=m;var y=Object.getOwnPropertyNames;function g(e){return d(null)}Object.getOwnPropertyNames=function(e){for(var t=y(e),r=0,n=0,i=t.length;r<i;++r)l.call(p,t[r])||(r>n&&(t[n]=t[r]),++n);return t.length=n,t},t.makeAccessor=function(e){var t=m(),r=d(null);function n(n){return l.call(n,t)||function(n){var i;o(n,t,(function(t,a){if(t===r)return a?i=null:i||(i=e(n))}))}(n),n[t](r)}return e=e||g,n.forget=function(e){l.call(e,t)&&e[t](r,!0)},n}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=r(78),s=r(29),l=r(45),u=r(147),c=i(r(18)),f=c.namedTypes,d=c.builtInTypes.string,h=c.builtInTypes.object,p=n(r(79)),m=i(r(20)),v=function e(t,r){a.default.ok(this instanceof e),d.assert(t),this.code=t,r&&(h.assert(r),this.map=r)},y=!1;v.prototype.toString=function(){return y||(console.warn("Deprecation warning: recast.print now returns an object with a .code property. You appear to be treating the object as a string, which might still work but is strongly discouraged."),y=!0),this.code};var g=new v("");function E(e,t,r,n){a.default.ok(e instanceof p.default);var i=e.getValue(),o=[],l=function(e,t,r){var n=e.getValue();if(!n)return s.fromString("");if("string"==typeof n)return s.fromString(n,t);f.Printable.assert(n);var i=[];switch(n.type){case"File":return e.call(r,"program");case"Program":return n.directives&&e.each((function(e){i.push(r(e),";\n")}),"directives"),n.interpreter&&i.push(e.call(r,"interpreter")),i.push(e.call((function(e){return b(e,t,r)}),"body")),s.concat(i);case"Noop":case"EmptyStatement":return s.fromString("");case"ExpressionStatement":return s.concat([e.call(r,"expression"),";"]);case"ParenthesizedExpression":return s.concat(["(",e.call(r,"expression"),")"]);case"BinaryExpression":case"LogicalExpression":case"AssignmentExpression":return s.fromString(" ").join([e.call(r,"left"),n.operator,e.call(r,"right")]);case"AssignmentPattern":return s.concat([e.call(r,"left")," = ",e.call(r,"right")]);case"MemberExpression":case"OptionalMemberExpression":i.push(e.call(r,"object"));var o=e.call(r,"property"),l="OptionalMemberExpression"===n.type&&n.optional;return n.computed?i.push(l?"?.[":"[",o,"]"):i.push(l?"?.":".",o),s.concat(i);case"MetaProperty":return s.concat([e.call(r,"meta"),".",e.call(r,"property")]);case"BindExpression":return n.object&&i.push(e.call(r,"object")),i.push("::",e.call(r,"callee")),s.concat(i);case"Path":return s.fromString(".").join(n.body);case"Identifier":return s.concat([s.fromString(n.name,t),n.optional?"?":"",e.call(r,"typeAnnotation")]);case"SpreadElement":case"SpreadElementPattern":case"RestProperty":case"SpreadProperty":case"SpreadPropertyPattern":case"ObjectTypeSpreadProperty":case"RestElement":return s.concat(["...",e.call(r,"argument"),e.call(r,"typeAnnotation")]);case"FunctionDeclaration":case"FunctionExpression":case"TSDeclareFunction":return n.declare&&i.push("declare "),n.async&&i.push("async "),i.push("function"),n.generator&&i.push("*"),n.id?i.push(" ",e.call(r,"id"),e.call(r,"typeParameters")):n.typeParameters&&i.push(e.call(r,"typeParameters")),i.push("(",S(e,t,r),")",e.call(r,"returnType")),n.body&&i.push(" ",e.call(r,"body")),s.concat(i);case"ArrowFunctionExpression":return n.async&&i.push("async "),n.typeParameters&&i.push(e.call(r,"typeParameters")),t.arrowParensAlways||1!==n.params.length||n.rest||"Identifier"!==n.params[0].type||n.params[0].typeAnnotation||n.returnType?i.push("(",S(e,t,r),")",e.call(r,"returnType")):i.push(e.call(r,"params",0)),i.push(" => ",e.call(r,"body")),s.concat(i);case"MethodDefinition":return x(e,t,r);case"YieldExpression":return i.push("yield"),n.delegate&&i.push("*"),n.argument&&i.push(" ",e.call(r,"argument")),s.concat(i);case"AwaitExpression":return i.push("await"),n.all&&i.push("*"),n.argument&&i.push(" ",e.call(r,"argument")),s.concat(i);case"ModuleDeclaration":return i.push("module",e.call(r,"id")),n.source?(a.default.ok(!n.body),i.push("from",e.call(r,"source"))):i.push(e.call(r,"body")),s.fromString(" ").join(i);case"ImportSpecifier":return n.importKind&&"value"!==n.importKind&&i.push(n.importKind+" "),n.imported?(i.push(e.call(r,"imported")),n.local&&n.local.name!==n.imported.name&&i.push(" as ",e.call(r,"local"))):n.id&&(i.push(e.call(r,"id")),n.name&&i.push(" as ",e.call(r,"name"))),s.concat(i);case"ExportSpecifier":return n.local?(i.push(e.call(r,"local")),n.exported&&n.exported.name!==n.local.name&&i.push(" as ",e.call(r,"exported"))):n.id&&(i.push(e.call(r,"id")),n.name&&i.push(" as ",e.call(r,"name"))),s.concat(i);case"ExportBatchSpecifier":return s.fromString("*");case"ImportNamespaceSpecifier":return i.push("* as "),n.local?i.push(e.call(r,"local")):n.id&&i.push(e.call(r,"id")),s.concat(i);case"ImportDefaultSpecifier":return n.local?e.call(r,"local"):e.call(r,"id");case"TSExportAssignment":return s.concat(["export = ",e.call(r,"expression")]);case"ExportDeclaration":case"ExportDefaultDeclaration":case"ExportNamedDeclaration":return w(e,t,r);case"ExportAllDeclaration":return i.push("export *"),n.exported&&i.push(" as ",e.call(r,"exported")),i.push(" from ",e.call(r,"source"),";"),s.concat(i);case"TSNamespaceExportDeclaration":return i.push("export as namespace ",e.call(r,"id")),k(s.concat(i));case"ExportNamespaceSpecifier":return s.concat(["* as ",e.call(r,"exported")]);case"ExportDefaultSpecifier":return e.call(r,"exported");case"Import":return s.fromString("import",t);case"ImportDeclaration":if(i.push("import "),n.importKind&&"value"!==n.importKind&&i.push(n.importKind+" "),n.specifiers&&n.specifiers.length>0){var u=[],c=[];if(e.each((function(e){var t=e.getValue();"ImportSpecifier"===t.type?c.push(r(e)):"ImportDefaultSpecifier"!==t.type&&"ImportNamespaceSpecifier"!==t.type||u.push(r(e))}),"specifiers"),u.forEach((function(e,t){t>0&&i.push(", "),i.push(e)})),c.length>0){var d=s.fromString(", ").join(c);d.getLineLength(1)>t.wrapColumn&&(d=s.concat([s.fromString(",\n").join(c).indent(t.tabWidth),","])),u.length>0&&i.push(", "),d.length>1?i.push("{\n",d,"\n}"):t.objectCurlySpacing?i.push("{ ",d," }"):i.push("{",d,"}")}i.push(" from ")}return i.push(e.call(r,"source"),";"),s.concat(i);case"BlockStatement":var h=e.call((function(e){return b(e,t,r)}),"body");return!h.isEmpty()||n.directives&&0!==n.directives.length?(i.push("{\n"),n.directives&&e.each((function(e){i.push(k(r(e).indent(t.tabWidth)),n.directives.length>1||!h.isEmpty()?"\n":"")}),"directives"),i.push(h.indent(t.tabWidth)),i.push("\n}"),s.concat(i)):s.fromString("{}");case"ReturnStatement":if(i.push("return"),n.argument){var p=e.call(r,"argument");p.startsWithComment()||p.length>1&&f.JSXElement&&f.JSXElement.check(n.argument)?i.push(" (\n",p.indent(t.tabWidth),"\n)"):i.push(" ",p)}return i.push(";"),s.concat(i);case"CallExpression":case"OptionalCallExpression":return i.push(e.call(r,"callee")),n.typeParameters&&i.push(e.call(r,"typeParameters")),n.typeArguments&&i.push(e.call(r,"typeArguments")),"OptionalCallExpression"===n.type&&"OptionalMemberExpression"!==n.callee.type&&i.push("?."),i.push(A(e,t,r)),s.concat(i);case"ObjectExpression":case"ObjectPattern":case"ObjectTypeAnnotation":var v=!1,y="ObjectTypeAnnotation"===n.type,g=t.flowObjectCommas?",":y?";":",",E=[];y&&(E.push("indexers","callProperties"),null!=n.internalSlots&&E.push("internalSlots")),E.push("properties");var O=0;E.forEach((function(e){O+=n[e].length}));var D=y&&1===O||0===O,M=n.exact?"{|":"{",I=n.exact?"|}":"}";i.push(D?M:M+"\n");var P=i.length-1,F=0;if(E.forEach((function(n){e.each((function(e){var n=r(e);D||(n=n.indent(t.tabWidth));var a=!y&&n.length>1;a&&v&&i.push("\n"),i.push(n),F<O-1?(i.push(g+(a?"\n\n":"\n")),v=!a):1!==O&&y?i.push(g):!D&&m.isTrailingCommaEnabled(t,"objects")&&i.push(g),F++}),n)})),n.inexact){var L=s.fromString("...",t);D?(O>0&&i.push(g," "),i.push(L)):i.push("\n",L.indent(t.tabWidth))}return i.push(D?I:"\n"+I),0!==F&&D&&t.objectCurlySpacing&&(i[P]=M+" ",i[i.length-1]=" "+I),n.typeAnnotation&&i.push(e.call(r,"typeAnnotation")),s.concat(i);case"PropertyPattern":return s.concat([e.call(r,"key"),": ",e.call(r,"pattern")]);case"ObjectProperty":case"Property":if(n.method||"get"===n.kind||"set"===n.kind)return x(e,t,r);if(n.shorthand&&"AssignmentPattern"===n.value.type)return e.call(r,"value");var j=e.call(r,"key");return n.computed?i.push("[",j,"]"):i.push(j),n.shorthand||i.push(": ",e.call(r,"value")),s.concat(i);case"ClassMethod":case"ObjectMethod":case"ClassPrivateMethod":case"TSDeclareMethod":return x(e,t,r);case"PrivateName":return s.concat(["#",e.call(r,"id")]);case"Decorator":return s.concat(["@",e.call(r,"expression")]);case"ArrayExpression":case"ArrayPattern":O=n.elements.length;var B=e.map(r,"elements"),U=s.fromString(", ").join(B);return(D=U.getLineLength(1)<=t.wrapColumn)?t.arrayBracketSpacing?i.push("[ "):i.push("["):i.push("[\n"),e.each((function(e){var r=e.getName();if(e.getValue()){var n=B[r];D?r>0&&i.push(" "):n=n.indent(t.tabWidth),i.push(n),(r<O-1||!D&&m.isTrailingCommaEnabled(t,"arrays"))&&i.push(","),D||i.push("\n")}else i.push(",")}),"elements"),D&&t.arrayBracketSpacing?i.push(" ]"):i.push("]"),n.typeAnnotation&&i.push(e.call(r,"typeAnnotation")),s.concat(i);case"SequenceExpression":return s.fromString(", ").join(e.map(r,"expressions"));case"ThisExpression":return s.fromString("this");case"Super":return s.fromString("super");case"NullLiteral":return s.fromString("null");case"RegExpLiteral":return s.fromString(n.extra.raw);case"BigIntLiteral":return s.fromString(n.value+"n");case"NumericLiteral":return n.extra&&"string"==typeof n.extra.raw&&Number(n.extra.raw)===n.value?s.fromString(n.extra.raw,t):s.fromString(n.value,t);case"BooleanLiteral":case"StringLiteral":case"Literal":return"number"==typeof n.value&&"string"==typeof n.raw&&Number(n.raw)===n.value?s.fromString(n.raw,t):"string"!=typeof n.value?s.fromString(n.value,t):s.fromString(N(n.value,t),t);case"Directive":return e.call(r,"value");case"DirectiveLiteral":return s.fromString(N(n.value,t));case"InterpreterDirective":return s.fromString("#!"+n.value+"\n",t);case"ModuleSpecifier":if(n.local)throw new Error("The ESTree ModuleSpecifier type should be abstract");return s.fromString(N(n.value,t),t);case"UnaryExpression":return i.push(n.operator),/[a-z]$/.test(n.operator)&&i.push(" "),i.push(e.call(r,"argument")),s.concat(i);case"UpdateExpression":return i.push(e.call(r,"argument"),n.operator),n.prefix&&i.reverse(),s.concat(i);case"ConditionalExpression":return s.concat([e.call(r,"test")," ? ",e.call(r,"consequent")," : ",e.call(r,"alternate")]);case"NewExpression":return i.push("new ",e.call(r,"callee")),n.typeParameters&&i.push(e.call(r,"typeParameters")),n.typeArguments&&i.push(e.call(r,"typeArguments")),n.arguments&&i.push(A(e,t,r)),s.concat(i);case"VariableDeclaration":n.declare&&i.push("declare "),i.push(n.kind," ");var V=0;B=e.map((function(e){var t=r(e);return V=Math.max(t.length,V),t}),"declarations");1===V?i.push(s.fromString(", ").join(B)):B.length>1?i.push(s.fromString(",\n").join(B).indentTail(n.kind.length+1)):i.push(B[0]);var H=e.getParentNode();return f.ForStatement.check(H)||f.ForInStatement.check(H)||f.ForOfStatement&&f.ForOfStatement.check(H)||f.ForAwaitStatement&&f.ForAwaitStatement.check(H)||i.push(";"),s.concat(i);case"VariableDeclarator":return n.init?s.fromString(" = ").join([e.call(r,"id"),e.call(r,"init")]):e.call(r,"id");case"WithStatement":return s.concat(["with (",e.call(r,"object"),") ",e.call(r,"body")]);case"IfStatement":var z=T(e.call(r,"consequent"),t);return i.push("if (",e.call(r,"test"),")",z),n.alternate&&i.push(_(z)?" else":"\nelse",T(e.call(r,"alternate"),t)),s.concat(i);case"ForStatement":var X=e.call(r,"init"),q=X.length>1?";\n":"; ",W=s.fromString(q).join([X,e.call(r,"test"),e.call(r,"update")]).indentTail("for (".length),G=s.concat(["for (",W,")"]),Y=T(e.call(r,"body"),t);return i.push(G),G.length>1&&(i.push("\n"),Y=Y.trimLeft()),i.push(Y),s.concat(i);case"WhileStatement":return s.concat(["while (",e.call(r,"test"),")",T(e.call(r,"body"),t)]);case"ForInStatement":return s.concat([n.each?"for each (":"for (",e.call(r,"left")," in ",e.call(r,"right"),")",T(e.call(r,"body"),t)]);case"ForOfStatement":case"ForAwaitStatement":return i.push("for "),(n.await||"ForAwaitStatement"===n.type)&&i.push("await "),i.push("(",e.call(r,"left")," of ",e.call(r,"right"),")",T(e.call(r,"body"),t)),s.concat(i);case"DoWhileStatement":var J=s.concat(["do",T(e.call(r,"body"),t)]);return i.push(J),_(J)?i.push(" while"):i.push("\nwhile"),i.push(" (",e.call(r,"test"),");"),s.concat(i);case"DoExpression":var $=e.call((function(e){return b(e,t,r)}),"body");return s.concat(["do {\n",$.indent(t.tabWidth),"\n}"]);case"BreakStatement":return i.push("break"),n.label&&i.push(" ",e.call(r,"label")),i.push(";"),s.concat(i);case"ContinueStatement":return i.push("continue"),n.label&&i.push(" ",e.call(r,"label")),i.push(";"),s.concat(i);case"LabeledStatement":return s.concat([e.call(r,"label"),":\n",e.call(r,"body")]);case"TryStatement":return i.push("try ",e.call(r,"block")),n.handler?i.push(" ",e.call(r,"handler")):n.handlers&&e.each((function(e){i.push(" ",r(e))}),"handlers"),n.finalizer&&i.push(" finally ",e.call(r,"finalizer")),s.concat(i);case"CatchClause":return i.push("catch "),n.param&&i.push("(",e.call(r,"param")),n.guard&&i.push(" if ",e.call(r,"guard")),n.param&&i.push(") "),i.push(e.call(r,"body")),s.concat(i);case"ThrowStatement":return s.concat(["throw ",e.call(r,"argument"),";"]);case"SwitchStatement":return s.concat(["switch (",e.call(r,"discriminant"),") {\n",s.fromString("\n").join(e.map(r,"cases")),"\n}"]);case"SwitchCase":return n.test?i.push("case ",e.call(r,"test"),":"):i.push("default:"),n.consequent.length>0&&i.push("\n",e.call((function(e){return b(e,t,r)}),"consequent").indent(t.tabWidth)),s.concat(i);case"DebuggerStatement":return s.fromString("debugger;");case"JSXAttribute":return i.push(e.call(r,"name")),n.value&&i.push("=",e.call(r,"value")),s.concat(i);case"JSXIdentifier":return s.fromString(n.name,t);case"JSXNamespacedName":return s.fromString(":").join([e.call(r,"namespace"),e.call(r,"name")]);case"JSXMemberExpression":return s.fromString(".").join([e.call(r,"object"),e.call(r,"property")]);case"JSXSpreadAttribute":return s.concat(["{...",e.call(r,"argument"),"}"]);case"JSXSpreadChild":return s.concat(["{...",e.call(r,"expression"),"}"]);case"JSXExpressionContainer":return s.concat(["{",e.call(r,"expression"),"}"]);case"JSXElement":case"JSXFragment":var K="opening"+("JSXElement"===n.type?"Element":"Fragment"),Q="closing"+("JSXElement"===n.type?"Element":"Fragment"),Z=e.call(r,K);if(n[K].selfClosing)return a.default.ok(!n[Q],"unexpected "+Q+" element in self-closing "+n.type),Z;var ee=s.concat(e.map((function(e){var t=e.getValue();if(f.Literal.check(t)&&"string"==typeof t.value){if(/\S/.test(t.value))return t.value.replace(/^\s+|\s+$/g,"");if(/\n/.test(t.value))return"\n"}return r(e)}),"children")).indentTail(t.tabWidth),te=e.call(r,Q);return s.concat([Z,ee,te]);case"JSXOpeningElement":i.push("<",e.call(r,"name"));var re=[];e.each((function(e){re.push(" ",r(e))}),"attributes");var ne=s.concat(re);return(ne.length>1||ne.getLineLength(1)>t.wrapColumn)&&(re.forEach((function(e,t){" "===e&&(a.default.strictEqual(t%2,0),re[t]="\n")})),ne=s.concat(re).indentTail(t.tabWidth)),i.push(ne,n.selfClosing?" />":">"),s.concat(i);case"JSXClosingElement":return s.concat(["</",e.call(r,"name"),">"]);case"JSXOpeningFragment":return s.fromString("<>");case"JSXClosingFragment":return s.fromString("</>");case"JSXText":return s.fromString(n.value,t);case"JSXEmptyExpression":return s.fromString("");case"TypeAnnotatedIdentifier":return s.concat([e.call(r,"annotation")," ",e.call(r,"identifier")]);case"ClassBody":return 0===n.body.length?s.fromString("{}"):s.concat(["{\n",e.call((function(e){return b(e,t,r)}),"body").indent(t.tabWidth),"\n}"]);case"ClassPropertyDefinition":return i.push("static ",e.call(r,"definition")),f.MethodDefinition.check(n.definition)||i.push(";"),s.concat(i);case"ClassProperty":var ie=n.accessibility||n.access;"string"==typeof ie&&i.push(ie," "),n.static&&i.push("static "),n.abstract&&i.push("abstract "),n.readonly&&i.push("readonly ");j=e.call(r,"key");return n.computed&&(j=s.concat(["[",j,"]"])),n.variance&&(j=s.concat([C(e,r),j])),i.push(j),n.optional&&i.push("?"),n.typeAnnotation&&i.push(e.call(r,"typeAnnotation")),n.value&&i.push(" = ",e.call(r,"value")),i.push(";"),s.concat(i);case"ClassPrivateProperty":return n.static&&i.push("static "),i.push(e.call(r,"key")),n.typeAnnotation&&i.push(e.call(r,"typeAnnotation")),n.value&&i.push(" = ",e.call(r,"value")),i.push(";"),s.concat(i);case"ClassDeclaration":case"ClassExpression":return n.declare&&i.push("declare "),n.abstract&&i.push("abstract "),i.push("class"),n.id&&i.push(" ",e.call(r,"id")),n.typeParameters&&i.push(e.call(r,"typeParameters")),n.superClass&&i.push(" extends ",e.call(r,"superClass"),e.call(r,"superTypeParameters")),n.implements&&n.implements.length>0&&i.push(" implements ",s.fromString(", ").join(e.map(r,"implements"))),i.push(" ",e.call(r,"body")),s.concat(i);case"TemplateElement":return s.fromString(n.value.raw,t).lockIndentTail();case"TemplateLiteral":var ae=e.map(r,"expressions");return i.push("`"),e.each((function(e){var t=e.getName();i.push(r(e)),t<ae.length&&i.push("${",ae[t],"}")}),"quasis"),i.push("`"),s.concat(i).lockIndentTail();case"TaggedTemplateExpression":return s.concat([e.call(r,"tag"),e.call(r,"quasi")]);case"Node":case"Printable":case"SourceLocation":case"Position":case"Statement":case"Function":case"Pattern":case"Expression":case"Declaration":case"Specifier":case"NamedSpecifier":case"Comment":case"Flow":case"FlowType":case"FlowPredicate":case"MemberTypeAnnotation":case"Type":case"TSHasOptionalTypeParameterInstantiation":case"TSHasOptionalTypeParameters":case"TSHasOptionalTypeAnnotation":throw new Error("unprintable type: "+JSON.stringify(n.type));case"CommentBlock":case"Block":return s.concat(["/*",s.fromString(n.value,t),"*/"]);case"CommentLine":case"Line":return s.concat(["//",s.fromString(n.value,t)]);case"TypeAnnotation":return n.typeAnnotation?("FunctionTypeAnnotation"!==n.typeAnnotation.type&&i.push(": "),i.push(e.call(r,"typeAnnotation")),s.concat(i)):s.fromString("");case"ExistentialTypeParam":case"ExistsTypeAnnotation":return s.fromString("*",t);case"EmptyTypeAnnotation":return s.fromString("empty",t);case"AnyTypeAnnotation":return s.fromString("any",t);case"MixedTypeAnnotation":return s.fromString("mixed",t);case"ArrayTypeAnnotation":return s.concat([e.call(r,"elementType"),"[]"]);case"TupleTypeAnnotation":B=e.map(r,"types"),U=s.fromString(", ").join(B);return(D=U.getLineLength(1)<=t.wrapColumn)?t.arrayBracketSpacing?i.push("[ "):i.push("["):i.push("[\n"),e.each((function(e){var r=e.getName();if(e.getValue()){var a=B[r];D?r>0&&i.push(" "):a=a.indent(t.tabWidth),i.push(a),(r<n.types.length-1||!D&&m.isTrailingCommaEnabled(t,"arrays"))&&i.push(","),D||i.push("\n")}else i.push(",")}),"types"),D&&t.arrayBracketSpacing?i.push(" ]"):i.push("]"),s.concat(i);case"BooleanTypeAnnotation":return s.fromString("boolean",t);case"BooleanLiteralTypeAnnotation":return a.default.strictEqual(typeof n.value,"boolean"),s.fromString(""+n.value,t);case"InterfaceTypeAnnotation":return i.push("interface"),n.extends&&n.extends.length>0&&i.push(" extends ",s.fromString(", ").join(e.map(r,"extends"))),i.push(" ",e.call(r,"body")),s.concat(i);case"DeclareClass":return R(e,["class ",e.call(r,"id")," ",e.call(r,"body")]);case"DeclareFunction":return R(e,["function ",e.call(r,"id"),";"]);case"DeclareModule":return R(e,["module ",e.call(r,"id")," ",e.call(r,"body")]);case"DeclareModuleExports":return R(e,["module.exports",e.call(r,"typeAnnotation")]);case"DeclareVariable":return R(e,["var ",e.call(r,"id"),";"]);case"DeclareExportDeclaration":case"DeclareExportAllDeclaration":return s.concat(["declare ",w(e,t,r)]);case"InferredPredicate":return s.fromString("%checks",t);case"DeclaredPredicate":return s.concat(["%checks(",e.call(r,"value"),")"]);case"FunctionTypeAnnotation":var oe=e.getParentNode(0),se=!(f.ObjectTypeCallProperty.check(oe)||f.ObjectTypeInternalSlot.check(oe)&&oe.method||f.DeclareFunction.check(e.getParentNode(2)));return se&&!f.FunctionTypeParam.check(oe)&&i.push(": "),i.push("(",S(e,t,r),")"),n.returnType&&i.push(se?" => ":": ",e.call(r,"returnType")),s.concat(i);case"FunctionTypeParam":return s.concat([e.call(r,"name"),n.optional?"?":"",": ",e.call(r,"typeAnnotation")]);case"GenericTypeAnnotation":return s.concat([e.call(r,"id"),e.call(r,"typeParameters")]);case"DeclareInterface":i.push("declare ");case"InterfaceDeclaration":case"TSInterfaceDeclaration":return n.declare&&i.push("declare "),i.push("interface ",e.call(r,"id"),e.call(r,"typeParameters")," "),n.extends&&n.extends.length>0&&i.push("extends ",s.fromString(", ").join(e.map(r,"extends"))," "),n.body&&i.push(e.call(r,"body")),s.concat(i);case"ClassImplements":case"InterfaceExtends":return s.concat([e.call(r,"id"),e.call(r,"typeParameters")]);case"IntersectionTypeAnnotation":return s.fromString(" & ").join(e.map(r,"types"));case"NullableTypeAnnotation":return s.concat(["?",e.call(r,"typeAnnotation")]);case"NullLiteralTypeAnnotation":return s.fromString("null",t);case"ThisTypeAnnotation":return s.fromString("this",t);case"NumberTypeAnnotation":return s.fromString("number",t);case"ObjectTypeCallProperty":return e.call(r,"value");case"ObjectTypeIndexer":return s.concat([C(e,r),"[",e.call(r,"id"),": ",e.call(r,"key"),"]: ",e.call(r,"value")]);case"ObjectTypeProperty":return s.concat([C(e,r),e.call(r,"key"),n.optional?"?":"",": ",e.call(r,"value")]);case"ObjectTypeInternalSlot":return s.concat([n.static?"static ":"","[[",e.call(r,"id"),"]]",n.optional?"?":"","FunctionTypeAnnotation"!==n.value.type?": ":"",e.call(r,"value")]);case"QualifiedTypeIdentifier":return s.concat([e.call(r,"qualification"),".",e.call(r,"id")]);case"StringLiteralTypeAnnotation":return s.fromString(N(n.value,t),t);case"NumberLiteralTypeAnnotation":case"NumericLiteralTypeAnnotation":return a.default.strictEqual(typeof n.value,"number"),s.fromString(JSON.stringify(n.value),t);case"StringTypeAnnotation":return s.fromString("string",t);case"DeclareTypeAlias":i.push("declare ");case"TypeAlias":return s.concat(["type ",e.call(r,"id"),e.call(r,"typeParameters")," = ",e.call(r,"right"),";"]);case"DeclareOpaqueType":i.push("declare ");case"OpaqueType":return i.push("opaque type ",e.call(r,"id"),e.call(r,"typeParameters")),n.supertype&&i.push(": ",e.call(r,"supertype")),n.impltype&&i.push(" = ",e.call(r,"impltype")),i.push(";"),s.concat(i);case"TypeCastExpression":return s.concat(["(",e.call(r,"expression"),e.call(r,"typeAnnotation"),")"]);case"TypeParameterDeclaration":case"TypeParameterInstantiation":return s.concat(["<",s.fromString(", ").join(e.map(r,"params")),">"]);case"Variance":return"plus"===n.kind?s.fromString("+"):"minus"===n.kind?s.fromString("-"):s.fromString("");case"TypeParameter":return n.variance&&i.push(C(e,r)),i.push(e.call(r,"name")),n.bound&&i.push(e.call(r,"bound")),n.default&&i.push("=",e.call(r,"default")),s.concat(i);case"TypeofTypeAnnotation":return s.concat([s.fromString("typeof ",t),e.call(r,"argument")]);case"UnionTypeAnnotation":return s.fromString(" | ").join(e.map(r,"types"));case"VoidTypeAnnotation":return s.fromString("void",t);case"NullTypeAnnotation":return s.fromString("null",t);case"TSType":throw new Error("unprintable type: "+JSON.stringify(n.type));case"TSNumberKeyword":return s.fromString("number",t);case"TSBigIntKeyword":return s.fromString("bigint",t);case"TSObjectKeyword":return s.fromString("object",t);case"TSBooleanKeyword":return s.fromString("boolean",t);case"TSStringKeyword":return s.fromString("string",t);case"TSSymbolKeyword":return s.fromString("symbol",t);case"TSAnyKeyword":return s.fromString("any",t);case"TSVoidKeyword":return s.fromString("void",t);case"TSThisType":return s.fromString("this",t);case"TSNullKeyword":return s.fromString("null",t);case"TSUndefinedKeyword":return s.fromString("undefined",t);case"TSUnknownKeyword":return s.fromString("unknown",t);case"TSNeverKeyword":return s.fromString("never",t);case"TSArrayType":return s.concat([e.call(r,"elementType"),"[]"]);case"TSLiteralType":return e.call(r,"literal");case"TSUnionType":return s.fromString(" | ").join(e.map(r,"types"));case"TSIntersectionType":return s.fromString(" & ").join(e.map(r,"types"));case"TSConditionalType":return i.push(e.call(r,"checkType")," extends ",e.call(r,"extendsType")," ? ",e.call(r,"trueType")," : ",e.call(r,"falseType")),s.concat(i);case"TSInferType":return i.push("infer ",e.call(r,"typeParameter")),s.concat(i);case"TSParenthesizedType":return s.concat(["(",e.call(r,"typeAnnotation"),")"]);case"TSFunctionType":return s.concat([e.call(r,"typeParameters"),"(",S(e,t,r),")",e.call(r,"typeAnnotation")]);case"TSConstructorType":return s.concat(["new ",e.call(r,"typeParameters"),"(",S(e,t,r),")",e.call(r,"typeAnnotation")]);case"TSMappedType":return i.push(n.readonly?"readonly ":"","[",e.call(r,"typeParameter"),"]",n.optional?"?":""),n.typeAnnotation&&i.push(": ",e.call(r,"typeAnnotation"),";"),s.concat(["{\n",s.concat(i).indent(t.tabWidth),"\n}"]);case"TSTupleType":return s.concat(["[",s.fromString(", ").join(e.map(r,"elementTypes")),"]"]);case"TSRestType":return s.concat(["...",e.call(r,"typeAnnotation"),"[]"]);case"TSOptionalType":return s.concat([e.call(r,"typeAnnotation"),"?"]);case"TSIndexedAccessType":return s.concat([e.call(r,"objectType"),"[",e.call(r,"indexType"),"]"]);case"TSTypeOperator":return s.concat([e.call(r,"operator")," ",e.call(r,"typeAnnotation")]);case"TSTypeLiteral":var le=s.fromString(",\n").join(e.map(r,"members"));return le.isEmpty()?s.fromString("{}",t):(i.push("{\n",le.indent(t.tabWidth),"\n}"),s.concat(i));case"TSEnumMember":return i.push(e.call(r,"id")),n.initializer&&i.push(" = ",e.call(r,"initializer")),s.concat(i);case"TSTypeQuery":return s.concat(["typeof ",e.call(r,"exprName")]);case"TSParameterProperty":return n.accessibility&&i.push(n.accessibility," "),n.export&&i.push("export "),n.static&&i.push("static "),n.readonly&&i.push("readonly "),i.push(e.call(r,"parameter")),s.concat(i);case"TSTypeReference":return s.concat([e.call(r,"typeName"),e.call(r,"typeParameters")]);case"TSQualifiedName":return s.concat([e.call(r,"left"),".",e.call(r,"right")]);case"TSAsExpression":return(fe=n.extra&&!0===n.extra.parenthesized)&&i.push("("),i.push(e.call(r,"expression"),s.fromString(" as "),e.call(r,"typeAnnotation")),fe&&i.push(")"),s.concat(i);case"TSNonNullExpression":return s.concat([e.call(r,"expression"),"!"]);case"TSTypeAnnotation":oe=e.getParentNode(0);var ue=": ";return(f.TSFunctionType.check(oe)||f.TSConstructorType.check(oe))&&(ue=" => "),f.TSTypePredicate.check(oe)&&(ue=" is "),s.concat([ue,e.call(r,"typeAnnotation")]);case"TSIndexSignature":return s.concat([n.readonly?"readonly ":"","[",e.map(r,"parameters"),"]",e.call(r,"typeAnnotation")]);case"TSPropertySignature":return i.push(C(e,r),n.readonly?"readonly ":""),n.computed?i.push("[",e.call(r,"key"),"]"):i.push(e.call(r,"key")),i.push(n.optional?"?":"",e.call(r,"typeAnnotation")),s.concat(i);case"TSMethodSignature":return n.computed?i.push("[",e.call(r,"key"),"]"):i.push(e.call(r,"key")),n.optional&&i.push("?"),i.push(e.call(r,"typeParameters"),"(",S(e,t,r),")",e.call(r,"typeAnnotation")),s.concat(i);case"TSTypePredicate":return s.concat([e.call(r,"parameterName"),e.call(r,"typeAnnotation")]);case"TSCallSignatureDeclaration":return s.concat([e.call(r,"typeParameters"),"(",S(e,t,r),")",e.call(r,"typeAnnotation")]);case"TSConstructSignatureDeclaration":return n.typeParameters?i.push("new",e.call(r,"typeParameters")):i.push("new "),i.push("(",S(e,t,r),")",e.call(r,"typeAnnotation")),s.concat(i);case"TSTypeAliasDeclaration":return s.concat([n.declare?"declare ":"","type ",e.call(r,"id"),e.call(r,"typeParameters")," = ",e.call(r,"typeAnnotation"),";"]);case"TSTypeParameter":i.push(e.call(r,"name"));oe=e.getParentNode(0);var ce=f.TSMappedType.check(oe);return n.constraint&&i.push(ce?" in ":" extends ",e.call(r,"constraint")),n.default&&i.push(" = ",e.call(r,"default")),s.concat(i);case"TSTypeAssertion":var fe;return(fe=n.extra&&!0===n.extra.parenthesized)&&i.push("("),i.push("<",e.call(r,"typeAnnotation"),"> ",e.call(r,"expression")),fe&&i.push(")"),s.concat(i);case"TSTypeParameterDeclaration":case"TSTypeParameterInstantiation":return s.concat(["<",s.fromString(", ").join(e.map(r,"params")),">"]);case"TSEnumDeclaration":i.push(n.declare?"declare ":"",n.const?"const ":"","enum ",e.call(r,"id"));var de=s.fromString(",\n").join(e.map(r,"members"));return de.isEmpty()?i.push(" {}"):i.push(" {\n",de.indent(t.tabWidth),"\n}"),s.concat(i);case"TSExpressionWithTypeArguments":return s.concat([e.call(r,"expression"),e.call(r,"typeParameters")]);case"TSInterfaceBody":var he=s.fromString(";\n").join(e.map(r,"body"));return he.isEmpty()?s.fromString("{}",t):s.concat(["{\n",he.indent(t.tabWidth),";","\n}"]);case"TSImportType":return i.push("import(",e.call(r,"argument"),")"),n.qualifier&&i.push(".",e.call(r,"qualifier")),n.typeParameters&&i.push(e.call(r,"typeParameters")),s.concat(i);case"TSImportEqualsDeclaration":return n.isExport&&i.push("export "),i.push("import ",e.call(r,"id")," = ",e.call(r,"moduleReference")),k(s.concat(i));case"TSExternalModuleReference":return s.concat(["require(",e.call(r,"expression"),")"]);case"TSModuleDeclaration":if("TSModuleDeclaration"===e.getParentNode().type)i.push(".");else if(n.declare&&i.push("declare "),!n.global)if("StringLiteral"===n.id.type||"Literal"===n.id.type&&"string"==typeof n.id.value)i.push("module ");else if(n.loc&&n.loc.lines&&n.id.loc){n.loc.lines.sliceString(n.loc.start,n.id.loc.start).indexOf("module")>=0?i.push("module "):i.push("namespace ")}else i.push("namespace ");if(i.push(e.call(r,"id")),n.body&&"TSModuleDeclaration"===n.body.type)i.push(e.call(r,"body"));else if(n.body){var pe=e.call(r,"body");pe.isEmpty()?i.push(" {}"):i.push(" {\n",pe.indent(t.tabWidth),"\n}")}return s.concat(i);case"TSModuleBlock":return e.call((function(e){return b(e,t,r)}),"body");case"ClassHeritage":case"ComprehensionBlock":case"ComprehensionExpression":case"Glob":case"GeneratorExpression":case"LetStatement":case"LetExpression":case"GraphExpression":case"GraphIndexExpression":case"XMLDefaultDeclaration":case"XMLAnyName":case"XMLQualifiedIdentifier":case"XMLFunctionQualifiedIdentifier":case"XMLAttributeSelector":case"XMLFilterExpression":case"XML":case"XMLElement":case"XMLList":case"XMLEscape":case"XMLText":case"XMLStartTag":case"XMLEndTag":case"XMLPointTag":case"XMLName":case"XMLAttribute":case"XMLCdata":case"XMLComment":case"XMLProcessingInstruction":default:throw new Error("unknown type: "+JSON.stringify(n.type))}}(e,t,n);if(!i||l.isEmpty())return l;var u=!1,c=function(e,t){var r=[],n=e.getValue();n.decorators&&n.decorators.length>0&&!m.getParentExportDeclaration(e)?e.each((function(e){r.push(t(e),"\n")}),"decorators"):m.isExportDeclaration(n)&&n.declaration&&n.declaration.decorators&&e.each((function(e){r.push(t(e),"\n")}),"declaration","decorators");return s.concat(r)}(e,n);return c.isEmpty()?r.avoidRootParens||(u=e.needsParens()):o.push(c),u&&o.unshift("("),o.push(l),u&&o.push(")"),s.concat(o)}function b(e,t,r){var n=[],i=!1,o=!1;e.each((function(e){var t=e.getValue();t&&("EmptyStatement"!==t.type||t.comments&&t.comments.length>0)&&(f.Comment.check(t)?i=!0:f.Statement.check(t)?o=!0:d.assert(t),n.push({node:t,printed:r(e)}))})),i&&a.default.strictEqual(o,!1,"Comments may appear as statements in otherwise empty statement lists, but may not coexist with non-Comment nodes.");var l=null,u=n.length,c=[];return n.forEach((function(e,r){var n,i,a=e.printed,o=e.node,f=a.length>1,d=r>0,h=r<u-1,p=o&&o.loc&&o.loc.lines,v=p&&t.reuseWhitespace&&m.getTrueLoc(o,p);if(d)if(v){var y=p.skipSpaces(v.start,!0),g=y?y.line:1,E=v.start.line-g;n=Array(E+1).join("\n")}else n=f?"\n\n":"\n";else n="";if(h)if(v){var b=p.skipSpaces(v.end),x=(b?b.line:p.length)-v.end.line;i=Array(x+1).join("\n")}else i=f?"\n\n":"\n";else i="";c.push(function(e,t){if(!e&&!t)return s.fromString("");if(!e)return s.fromString(t);if(!t)return s.fromString(e);var r=s.fromString(e),n=s.fromString(t);if(n.length>r.length)return n;return r}(l,n),a),h?l=i:i&&c.push(i)})),s.concat(c)}function x(e,t,r){var n=e.getNode(),i=n.kind,a=[],o=n.value;f.FunctionExpression.check(o)||(o=n);var l=n.accessibility||n.access;"string"==typeof l&&a.push(l," "),n.static&&a.push("static "),n.abstract&&a.push("abstract "),n.readonly&&a.push("readonly "),o.async&&a.push("async "),o.generator&&a.push("*"),"get"!==i&&"set"!==i||a.push(i," ");var u=e.call(r,"key");return n.computed&&(u=s.concat(["[",u,"]"])),a.push(u),n.optional&&a.push("?"),n===o?(a.push(e.call(r,"typeParameters"),"(",S(e,t,r),")",e.call(r,"returnType")),n.body?a.push(" ",e.call(r,"body")):a.push(";")):(a.push(e.call(r,"value","typeParameters"),"(",e.call((function(e){return S(e,t,r)}),"value"),")",e.call(r,"value","returnType")),o.body?a.push(" ",e.call(r,"value","body")):a.push(";")),s.concat(a)}function A(e,t,r){var n=e.map(r,"arguments"),i=m.isTrailingCommaEnabled(t,"parameters"),a=s.fromString(", ").join(n);return a.getLineLength(1)>t.wrapColumn?(a=s.fromString(",\n").join(n),s.concat(["(\n",a.indent(t.tabWidth),i?",\n)":"\n)"])):s.concat(["(",a,")"])}function S(e,t,r){var n=e.getValue();if(n.params)var i=n.params,a=e.map(r,"params");else n.parameters&&(i=n.parameters,a=e.map(r,"parameters"));n.defaults&&e.each((function(e){var t=e.getName(),n=a[t];n&&e.getValue()&&(a[t]=s.concat([n," = ",r(e)]))}),"defaults"),n.rest&&a.push(s.concat(["...",e.call(r,"rest")]));var o=s.fromString(", ").join(a);return o.length>1||o.getLineLength(1)>t.wrapColumn?(o=s.fromString(",\n").join(a),o=m.isTrailingCommaEnabled(t,"parameters")&&!n.rest&&"RestElement"!==i[i.length-1].type?s.concat([o,",\n"]):s.concat([o,"\n"]),s.concat(["\n",o.indent(t.tabWidth)])):o}function w(e,t,r){var n=e.getValue(),i=["export "];n.exportKind&&"value"!==n.exportKind&&i.push(n.exportKind+" ");var a=t.objectCurlySpacing;if(f.Declaration.assert(n),(n.default||"ExportDefaultDeclaration"===n.type)&&i.push("default "),n.declaration)i.push(e.call(r,"declaration"));else if(n.specifiers){if(1===n.specifiers.length&&"ExportBatchSpecifier"===n.specifiers[0].type)i.push("*");else if(0===n.specifiers.length)i.push("{}");else if("ExportDefaultSpecifier"===n.specifiers[0].type){var o=[],l=[];if(e.each((function(e){"ExportDefaultSpecifier"===e.getValue().type?o.push(r(e)):l.push(r(e))}),"specifiers"),o.forEach((function(e,t){t>0&&i.push(", "),i.push(e)})),l.length>0){var u=s.fromString(", ").join(l);u.getLineLength(1)>t.wrapColumn&&(u=s.concat([s.fromString(",\n").join(l).indent(t.tabWidth),","])),o.length>0&&i.push(", "),u.length>1?i.push("{\n",u,"\n}"):t.objectCurlySpacing?i.push("{ ",u," }"):i.push("{",u,"}")}}else i.push(a?"{ ":"{",s.fromString(", ").join(e.map(r,"specifiers")),a?" }":"}");n.source&&i.push(" from ",e.call(r,"source"))}var c=s.concat(i);return";"===O(c)||n.declaration&&("FunctionDeclaration"===n.declaration.type||"ClassDeclaration"===n.declaration.type||"TSModuleDeclaration"===n.declaration.type||"TSInterfaceDeclaration"===n.declaration.type||"TSEnumDeclaration"===n.declaration.type)||(c=s.concat([c,";"])),c}function R(e,t){var r=m.getParentExportDeclaration(e);return r?a.default.strictEqual(r.type,"DeclareExportDeclaration"):t.unshift("declare "),s.concat(t)}function C(e,t){return e.call((function(e){var r=e.getValue();return r?"plus"===r?s.fromString("+"):"minus"===r?s.fromString("-"):t(e):s.fromString("")}),"variance")}function T(e,t){return e.length>1?s.concat([" ",e]):s.concat(["\n",k(e).indent(t.tabWidth)])}function O(e){var t=e.lastPos();do{var r=e.charAt(t);if(/\S/.test(r))return r}while(e.prevPos(t))}function _(e){return"}"===O(e)}function D(e){return e.replace(/['"]/g,(function(e){return'"'===e?"'":'"'}))}function N(e,t){switch(d.assert(e),t.quote){case"auto":var r=JSON.stringify(e),n=D(JSON.stringify(D(e)));return r.length>n.length?n:r;case"single":return D(JSON.stringify(D(e)));case"double":default:return JSON.stringify(e)}}function k(e){var t=O(e);return!t||"\n};".indexOf(t)<0?s.concat([e,";"]):e}t.Printer=function e(t){a.default.ok(this instanceof e);var r=t&&t.tabWidth;function n(e,t){return e=Object.assign({},e,t),function(t){return i(t,e)}}function i(e,s){if(a.default.ok(e instanceof p.default),(s=s||{}).includeComments)return o.printComments(e,n(s,{includeComments:!1}));var l=t.tabWidth;if(!r){var c=e.getNode().loc;c&&c.lines&&c.lines.guessTabWidth&&(t.tabWidth=c.lines.guessTabWidth())}var f=u.getReprinter(e),d=f?f(i):E(e,t,s,n(s,{includeComments:!0,avoidRootParens:!1}));return t.tabWidth=l,d}(t=l.normalize(t)).sourceFileName=null,this.print=function(e){if(!e)return g;var r=i(p.default.from(e),{includeComments:!0,avoidRootParens:!1});return new v(r.toString(t),m.composeSourceMaps(t.inputSourceMap,r.getSourceMap(t.sourceMapName,t.sourceRoot)))},this.printGenerically=function(e){if(!e)return g;var r=p.default.from(e),n=t.reuseWhitespace;t.reuseWhitespace=!1;var i=new v(function e(r){return o.printComments(r,(function(r){return E(r,t,{includeComments:!0,avoidRootParens:!1},e)}))}(r).toString(t));return t.reuseWhitespace=n,i}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(r(19)),o=i(r(29)),s=i(r(18)),l=s.namedTypes.Printable,u=s.namedTypes.Expression,c=s.namedTypes.ReturnStatement,f=s.namedTypes.SourceLocation,d=r(20),h=n(r(79)),p=s.builtInTypes.object,m=s.builtInTypes.array,v=s.builtInTypes.string,y=/[0-9a-z_$]/i,g=function e(t){a.default.ok(this instanceof e),a.default.ok(t instanceof o.Lines);var r=[];this.replace=function(e,t){v.check(t)&&(t=o.fromString(t)),r.push({lines:t,start:e.start,end:e.end})},this.get=function(e){var n=(e=e||{start:{line:1,column:0},end:{line:t.length,column:t.getLineLength(t.length)}}).start,i=[];function s(e,r){a.default.ok(d.comparePos(e,r)<=0),i.push(t.slice(e,r))}return r.sort((function(e,t){return d.comparePos(e.start,t.start)})).forEach((function(e){d.comparePos(n,e.start)>0||(s(n,e.start),i.push(e.lines),n=e.end)})),s(n,e.end),o.concat(i)}};t.Patcher=g;var E=g.prototype;function b(e){var t=[];return e.comments&&e.comments.length>0&&e.comments.forEach((function(e){(e.leading||e.trailing)&&t.push(e)})),t}function x(e,t,r){var n=e.getValue();return n===t.getValue()||(m.check(n)?A(e,t,r):!!p.check(n)&&function(e,t,r){var n=e.getValue();if(p.assert(n),null===n.original)return!1;var i=t.getValue();if(!p.check(i))return!1;if(n===i||e.valueIsDuplicate()||t.valueIsDuplicate())return!0;if(l.check(n)){if(!l.check(i))return!1;if(n.type===i.type){var a=[];if(S(e,t,a))r.push.apply(r,a);else{if(!i.loc)return!1;r.push({oldPath:t.copy(),newPath:e.copy()})}return!0}return!!(u.check(n)&&u.check(i)&&i.loc)&&(r.push({oldPath:t.copy(),newPath:e.copy()}),!0)}return S(e,t,r)}(e,t,r))}function A(e,t,r){var n=e.getValue(),i=t.getValue();if(n===i||e.valueIsDuplicate()||t.valueIsDuplicate())return!0;m.assert(n);var a=n.length;if(!m.check(i)||i.length!==a)return!1;for(var o=0;o<a;++o){e.stack.push(o,n[o]),t.stack.push(o,i[o]);var s=x(e,t,r);if(e.stack.length-=2,t.stack.length-=2,!s)return!1}return!0}function S(e,t,r){var n=e.getValue(),i=t.getValue();if(p.assert(n),p.assert(i),null===n.original)return!1;if(e.needsParens()&&!t.hasParens())return!1;var a=d.getUnionOfKeys(i,n);"File"!==i.type&&"File"!==n.type||delete a.tokens,delete a.loc;var o=r.length;for(var l in a)if("_"!==l.charAt(0)){e.stack.push(l,s.getFieldValue(n,l)),t.stack.push(l,s.getFieldValue(i,l));var u=x(e,t,r);if(e.stack.length-=2,t.stack.length-=2,!u)return!1}return!(c.check(e.getNode())&&r.length>o)}E.tryToReprintComments=function(e,t,r){var n=this;if(!e.comments&&!t.comments)return!0;var i=h.default.from(e),o=h.default.from(t);i.stack.push("comments",b(e)),o.stack.push("comments",b(t));var s=[],l=A(i,o,s);return l&&s.length>0&&s.forEach((function(e){var t=e.oldPath.getValue();a.default.ok(t.leading||t.trailing),n.replace(t.loc,r(e.newPath).indentTail(t.loc.indent))})),l},E.deleteComments=function(e){if(e.comments){var t=this;e.comments.forEach((function(r){r.leading?t.replace({start:r.loc.start,end:e.loc.lines.skipSpaces(r.loc.end,!1,!1)},""):r.trailing&&t.replace({start:e.loc.lines.skipSpaces(r.loc.start,!0,!1),end:r.loc.end},"")}))}},t.getReprinter=function(e){a.default.ok(e instanceof h.default);var t=e.getValue();if(l.check(t)){var r=t.original,n=r&&r.loc,i=n&&n.lines,s=[];if(i&&function(e,t){var r=e.getValue();l.assert(r);var n=r.original;if(l.assert(n),a.default.deepEqual(t,[]),r.type!==n.type)return!1;var i=new h.default(n),o=S(e,i,t);o||(t.length=0);return o}(e,s))return function(t){var a=new g(i);s.forEach((function(e){var r=e.newPath.getValue(),n=e.oldPath.getValue();f.assert(n.loc,!0);var s=!a.tryToReprintComments(r,n,t);s&&a.deleteComments(n);var l=t(e.newPath,{includeComments:s,avoidRootParens:n.type===r.type&&e.oldPath.hasParens()}).indentTail(n.loc.indent),u=function(e,t,r){var n=d.copyPos(t.start),i=e.prevPos(n)&&e.charAt(n),a=r.charAt(r.firstPos());return i&&y.test(i)&&a&&y.test(a)}(i,n.loc,l),c=function(e,t,r){var n=e.charAt(t.end),i=r.lastPos(),a=r.prevPos(i)&&r.charAt(i);return a&&y.test(a)&&n&&y.test(n)}(i,n.loc,l);if(u||c){var h=[];u&&h.push(" "),h.push(l),c&&h.push(" "),l=o.concat(h)}a.replace(n.loc,l)}));var l=a.get(n).indentTail(-r.loc.indent);return e.needsParens()?o.concat(["(",l,")"]):l}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6))&&n.__esModule?n:{default:n};function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.srcCellRange="",this.dstCellRange="",this.srcOneDRange="",this.dstOneDRange=""}var t,r,n;return t=e,(r=[{key:"setSrcAndDstCellRange",value:function(e,t){this.srcCellRange=e,this.dstCellRange=t}},{key:"use",value:function(){var e=this.srcCellRange,t=this.dstCellRange,r=e.sri,n=e.sci,i=e.eri,o=e.eci,s=t.sri,l=t.sci,u=t.eri,c=t.eci,f=a(e.size(),2),d=f[0],h=f[1],p=a(t.size(),2);return{sri:r,sci:n,eri:i,eci:o,dsri:s,dsci:l,deri:u,deci:c,rn:d,cn:h,drn:p[0],dcn:p[1]}}},{key:"autoFilterDirection",value:function(){var e=this.use(),t=e.sri,r=e.dsri,n=e.deri,i=e.eri,a=!1;return t===r&&n===i&&(a=!0),a}},{key:"upOrDown",value:function(){var e=this.use(),t=e.deri,r=e.sri,n=e.deci,i=e.sci,a=!0;return(t<r||n<i)&&(a=!1),a}},{key:"leftOrRight",value:function(){var e=this.getRangeByWay(),t=e.srcOneDRange,r=e.dstOneDRange,n=1;return t.sri===t.eri&&r.eci>t.eci?n=2:t.sri===t.eri&&r.eci<t.eci&&(n=3),n}},{key:"getOneDRangeObj",value:function(e,t){var r=this.use(),n=r.sri,a=r.sci,o=r.eri,s=r.eci,l=r.dsri,u=r.dsci,c=r.deri,f=r.deci;return e?(this.srcOneDRange=new i.default(n+t,a,n+t,s),this.dstOneDRange=new i.default(l+t,u,l+t,f)):(this.srcOneDRange=new i.default(n,a+t,o,a+t),this.dstOneDRange=new i.default(l,u+t,c,u+t)),this.getRangeByWay()}},{key:"getRangeByWay",value:function(){return{srcOneDRange:this.srcOneDRange,dstOneDRange:this.dstOneDRange}}},{key:"calcDiff",value:function(e,t){var r=1;if(t||(r=1),t&&e.length>1){var n=e[e.length-2];r=1*e[e.length-1].text-1*n.text}else if(e.length>1){var i=e[1];r=1*e[0].text-1*i.text}return isNaN(r)&&(r=1),r}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(9);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text="",this.depend=[],this.formulas="",this.style=null,this.merge=null,this.formatText=null,this.multivalueRefsCell=null,this.source_v=null}var t,r,a;return t=e,(r=[{key:"setCell",value:function(e){(0,n.isHave)(e)&&((0,n.isHave)(e.text)&&(this.text=e.text),(0,n.isHave)(e.formulas)&&(this.formulas=e.formulas),(0,n.isHave)(e.formatText)&&(this.formatText=e.formatText),(0,n.isHave)(e.depend)&&(this.depend=e.depend),(0,n.isHave)(e.style)&&(this.style=e.style),(0,n.isHave)(e.multivalueRefsCell)&&(this.multivalueRefsCell=e.multivalueRefsCell),(0,n.isHave)(e.merge)&&(this.merge=e.merge),(0,n.isHave)(e.source_v)&&(this.source_v=e.source_v))}},{key:"setFormatText",value:function(e){e.state&&(this.formatText=e.text)}}])&&i(t.prototype,r),a&&i(t,a),e}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cols=void 0;var n=r(16);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t){var r=t.len,n=t.width,i=t.indexWidth,a=t.minWidth;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._={},this.len=r,this.width=n,this.indexWidth=i,this.minWidth=a}var t,r,a;return t=e,(r=[{key:"setData",value:function(e){e.len&&(this.len=e.len,delete e.len),this._=e}},{key:"getData",value:function(){var e=this.len;return Object.assign({len:e},this._)}},{key:"getWidth",value:function(e){var t=this._[e];return t&&t.width?t.width:this.width}},{key:"getOrNew",value:function(e){return this._[e]=this._[e]||{},this._[e]}},{key:"setWidth",value:function(e,t){this.getOrNew(e).width=t}},{key:"sumWidth",value:function(e,t){var r=this;return(0,n.rangeSum)(e,t,(function(e){return r.getWidth(e)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&i(t.prototype,r),a&&i(t,a),e}();t.Cols=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Validations=void 0;var n,i=(n=r(152))&&n.__esModule?n:{default:n},a=r(6);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}var c=function(){function e(t,r,n){s(this,e),this.refs=r,this.mode=t,this.validator=n}return u(e,[{key:"includes",value:function(e,t){for(var r=this.refs,n=0;n<r.length;n+=1){if(a.CellRange.valueOf(r[n]).includes(e,t))return!0}return!1}},{key:"addRef",value:function(e){this.remove(a.CellRange.valueOf(e)),this.refs.push(e)}},{key:"remove",value:function(e){var t=[];this.refs.forEach((function(r){var n=a.CellRange.valueOf(r);n.intersects(e)?n.difference(e).forEach((function(e){return t.push(e.toString())})):t.push(r)})),this.refs=t}},{key:"getData",value:function(){var e=this.refs,t=this.mode,r=this.validator;return{refs:e,mode:t,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(t){var r=t.refs,n=t.mode,a=t.type,o=t.required,s=t.operator,l=t.value;return new e(n,r,new i.default(a,o,l,s))}}]),e}(),f=function(){function e(){s(this,e),this._=[],this.errors=new Map}return u(e,[{key:"getError",value:function(e,t){return this.errors.get("".concat(e,"_").concat(t))}},{key:"validate",value:function(e,t,r){var n=this.get(e,t),i="".concat(e,"_").concat(t),a=this.errors;if(null!==n){var s=o(n.validator.validate(r),2),l=s[0],u=s[1];l?a.delete(i):a.set(i,u)}else a.delete(i);return!0}},{key:"add",value:function(e,t,r){var n=r.type,a=r.required,o=r.value,s=r.operator,l=new i.default(n,a,o,s),u=this.getByValidator(l);null!==u?u.addRef(t):this._.push(new c(e,[t],l))}},{key:"getByValidator",value:function(e){for(var t=0;t<this._.length;t+=1){var r=this._[t];if(r.validator.equals(e))return r}return null}},{key:"get",value:function(e,t){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(e,t))return n}return null}},{key:"remove",value:function(e){this.each((function(t){t.remove(e)}))}},{key:"each",value:function(e){this._.forEach((function(t){return e(t)}))}},{key:"getData",value:function(){return this._.filter((function(e){return e.refs.length>0})).map((function(e){return e.getData()}))}},{key:"setData",value:function(e){this._=e.map((function(e){return c.valueOf(e)}))}}]),e}();t.Validations=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(10),i=r(16);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function l(e,t){var r="";if(!e){for(var i=arguments.length,a=new Array(i>2?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];r=n.t.apply(void 0,["validation.".concat(t)].concat(a))}return[e,r]}var u=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.required=r,this.value=n,this.type=t,this.operator=i,this.message=""}var t,r,n;return t=e,(r=[{key:"parseValue",value:function(e){var t=this.type;return"date"===t?new Date(e):"number"===t?Number(e):e}},{key:"equals",value:function(e){var t=this.type===e.type&&this.required===e.required&&this.operator===e.operator_single_func;return t&&(t=Array.isArray(this.value)?(0,i.arrayEquals)(this.value,e.value):this.value===e.value),t}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(e){var t=this.required,r=this.operator,n=this.value,i=this.type;if(t&&/^\s*$/.test(e))return l(!1,"required");if(/^\s*$/.test(e))return[!0];if(s[i]&&!s[i].test(e))return l(!1,"notMatch");if("list"===i)return l(this.values().includes(e),"notIn");if(r){var o=this.parseValue(e);if("be"===r){var u=a(n,2),c=u[0],f=u[1];return l(o>=this.parseValue(c)&&o<=this.parseValue(f),"between",c,f)}if("nbe"===r){var d=a(n,2),h=d[0],p=d[1];return l(o<this.parseValue(h)||o>this.parseValue(p),"notBetween",h,p)}if("eq"===r)return l(o===this.parseValue(n),"equal",n);if("neq"===r)return l(o!==this.parseValue(n),"notEqual",n);if("lt"===r)return l(o<this.parseValue(n),"lessThan",n);if("lte"===r)return l(o<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return l(o>this.parseValue(n),"greaterThan",n);if("gte"===r)return l(o>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={toolbar:{undo:"Undo",redo:"Redo",paintformat:"Paint format",clearformat:"Clear format",format:"Format",font:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",textColor:"Text color",fillColor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",add:"display equation",autofilter:"Filter",formula:"Functions",more:"More",flexible:"Flexible",throwFormula:"Throw formulas",comeBack:"come back"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",insertRow:"Insert row",insertColumn:"Insert column",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",recover:"recover"},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},date_formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",concat:"Concat",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell SUnitRangeRef",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(8),a=r(1);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.moving=!1,this.vertical=r,this.el=(0,n.h)("div","".concat(a.cssPrefix,"-resizer ").concat(r?"vertical":"horizontal")).children(this.hoverEl=(0,n.h)("div","".concat(a.cssPrefix,"-resizer-hover")).on("mousedown.stop",(function(e){return t.mousedownHandler(e)})),this.lineEl=(0,n.h)("div","".concat(a.cssPrefix,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=i}var t,r,s;return t=e,(r=[{key:"show",value:function(e,t){var r=this.moving,n=this.vertical,i=this.hoverEl,a=this.lineEl,o=this.el;if(!r){this.cRect=e;var s=e.left,l=e.top,u=e.width,c=e.height;o.offset({left:n?s+u-5:s,top:n?l:l+c-5}).show(),i.offset({width:n?5:u,height:n?c:5}),a.offset({width:n?0:t.width,height:n?t.height:0})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide()}},{key:"mousedownHandler",value:function(e){var t=this,r=e,n=this.el,a=this.lineEl,o=this.cRect,s=this.vertical,l=this.minDistance,u=s?o.width:o.height;a.show(),(0,i.mouseMoveUp)(window,(function(e){t.moving=!0,null!==r&&1===e.buttons&&(s?(u+=e.movementX)>l&&n.css("left","".concat(o.left+u,"px")):(u+=e.movementY)>l&&n.css("top","".concat(o.top+u,"px")),r=e)}),(function(){r=null,a.hide(),t.moving=!1,t.hide(),t.finishedFn&&(u<l&&(u=l),t.finishedFn(o,u))}))}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vertical=t,this.moveFn=null,this.el=(0,n.h)("div","".concat(i.cssPrefix,"-scrollbar ").concat(t?"vertical":"horizontal")).child(this.contentEl=(0,n.h)("div","")).on("scroll.stop",(function(e){var t=e.target,n=t.scrollTop,i=t.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:i,e)}))}var t,r,o;return t=e,(r=[{key:"move",value:function(e){return this.el.scroll(e),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(e,t){var r=e-1;if(t>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(t,"px"))}else this.el.hide();return this}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(6),i=r(1),a=r(0),o=r(82);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,a.h)("div","".concat(i.cssPrefix,"-selector-cell")),this.data=t,this._=new n.CellRange(0,0,0,0)}var t,r,l;return t=e,(r=[{key:"resetSelectOffset",value:function(){var e=this.data.getRect(this._);this.setOffset(e)}},{key:"setData",value:function(e,t){var r=this;e=-1===e?0:e,t=-1===t?0:t;var i=this.data.merges,a=!1;i.each((function(n){n.includeByRiCi(e,t)&&(r._=n,a=!0)})),a||(this._=new n.CellRange(e,t,e,t))}},{key:"toolbarChangeSelectorCell",value:function(){var e=this._.sri,t=this._.sci;this.setData(e,t)}},{key:"setOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.el.offset({width:n-o.selectorHeightBorderWidth+.8,height:i-o.selectorHeightBorderWidth+.8,left:t-.8,top:r-.8}).show()}}])&&s(t.prototype,r),l&&s(t,l),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=p(r(83)),a=p(r(158)),o=r(1),s=r(7),l=p(r(160)),u=r(31),c=r(8),f=p(r(164)),d=r(33),h=r(9);function p(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(){var e=this.textlineEl,t=this.textEl,r=this.areaOffset;if(r){var n=e.offset().width+9+15,i=this.viewFn().width-r.left-9;if(n>r.width&&0!==r.width){var a=n;if(n>i){a=i-15;var o=parseInt(n/(i-15),10);o+=n%i>0?1:0,(o*=this.rowHeight)>r.height&&t.css("height","".concat(o,"px"))}t.css("width","".concat(a,"px"))}}}var g=function(){var e=this;if(window.getSelection().rangeCount<=0)return 0;var t=window.getSelection().getRangeAt(0),r=t.cloneRange();r.selectNodeContents(this.textEl.el),r.setEnd(t.startContainer,t.startOffset);var n=r.toString().length,i=this.editorText.getText(),a=(0,u.findBracket)(n-1,(0,s.cutting)(i),i),o=a.exist,l=a.left,c=a.right;Object.keys(this.spanArr).forEach((function(t){e.spanArr[t].css("background-color","rgba(255,255,255,0.1)")}));var f=this.spanArr[l],d=this.spanArr[c];if(this.suggestContent.hide(),o&&f&&d)f.css("background-color","rgb(229, 229, 229)"),d.css("background-color","rgb(229, 229, 229)");else{var h=this.suggest.show,p=u.suggestContent.call(this,n,(0,s.cutting)(i),i);p.suggestContent&&!h&&this.suggestContent.content(p.cut,p.pos)}return n};function E(e){if(this){var t=this.pos,r=this.pos,n=0,i=document.createRange();i.setStart(e,0),i.collapse(!0);for(var a,o=[e],s=!1,l=!1;!l&&(a=o.pop());)if(3===a.nodeType){var u=n+a.length;!s&&t>=n&&t<=u&&(i.setStart(a,t-n),s=!0),s&&r>=n&&r<=u&&(i.setEnd(a,r-n),l=!0),n=u}else for(var c=a.childNodes.length;c--;)o.push(a.childNodes[c]);var f=window.getSelection();f.removeAllRanges(),f.addRange(i)}}function b(){var e=this.editorText.getText();this.pos=g.call(this),R.call(this,e,this.pos)}function x(){if(!1===N.call(this)){var e=this.data.getCell(this.ri,this.ci);this.editorText.setOldCell((0,s.deepCopy)(e),{ri:this.ri,ci:this.ci})}}function A(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";if(x.call(this),e){var a=e.inputType;if("insertFromPaste"===a&&"black"!==this.textEl.el.style["caret-color"])return void(this.copy=!0);if("historyUndo"===a)return}var o=this.editorText;setTimeout((function(){if(!1!==t.chinese){var a="";if(t.data.settings.showEditor){if(t.sheet.selector.hide(),""===r&&e&&e.target&&e.target.childNodes){for(var l="",u=0,c=e.target.childNodes.length;u<c;u++)1===e.target.childNodes[u].nodeType?a+=e.target.childNodes[u].innerText:3===e.target.childNodes[u].nodeType&&(l+=e.target.childNodes[u].nodeValue);a=""!==l?l:a}else a=""===r&&e&&(0,h.isHave)(e.data)?""!==e.data?e.data:a:r;t.copy&&(t.copy=!1,a=e&&e.data?e.data:"",t.textEl.html(a),t.pos=a.length,E.call(t,t.textEl.el,-1)),t.changed=!0;var f=t.suggest,d=t.textlineEl,p=t.validator,m=t.textEl;if(o.setText("".concat(a)),o.changeText(1),t.pos=g.call(t),p)"list"===p.type?f.search(a):f.hide();else{var v=(a+="").lastIndexOf("=");-1!==t.pos?R.call(t,a,t.pos):w.call(t,a);var b=!1,x=(0,s.cuttingByPos2)(a,t.pos,!0);if(a.length>=t.pos){var A="".concat(a[t.pos]);-1!==A.search(/^[0-9]+.?[0-9]*$/)?b=!0:A&&(x+=(0,s.cuttingByPosEnd)(a,t.pos+1))}0===v&&a.length>1&&""!==x&&!b&&x.trim().length>0?f.search(x):f.hide()}d.html(n||a),o.setText(n||a),t.suggest.itemIndex=-1,y.call(t),a&&"="!==a[0]&&E.call(t,m.el,-1),n&&"="===n[0]&&(a=n),t.change(i,a),setTimeout((function(){t.show()}))}}}))}function S(e){this.pos=g.call(this),"ArrowRight"===e.code?this.pos=this.pos+1:"ArrowLeft"===e.code&&(this.pos=this.pos-1);var t=e.keyCode||e.which;27===t&&"black"===this.textEl.el.style["caret-color"]&&"1"===this.textEl.el.style.opacity&&this.change("input","@~esc")}function w(e){var t=e.lastIndexOf("=");0===t&&e.length>=1&&(0,s.operation)(e[e.length-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==t?this.setLock(!1):0===t&&1===e.length&&this.setLock(!0),(0,s.isAbsoluteValue)((0,s.cuttingByPos)(e,this.pos),2)&&this.setLock(!0),0!==t&&this.setLock(!1)}function R(e,t){var r=(e+="").lastIndexOf("=");0===r&&e.length>=1&&(0,s.operation)(e[t-1])?this.setLock(!0):(this.setLock(!1),this.state=2),0!==r?this.setLock(!1):0===r&&1===e.length&&this.setLock(!0),(0,s.isAbsoluteValue)((0,s.cuttingByPos)(e,t),2)&&this.setLock(!0),0!==r&&this.setLock(!1)}function C(){var e=this,t=this.textEl.el;setTimeout((function(){E.call(e,t)}),0)}function T(e){var t=this.textEl,r=this.textlineEl,n=this.tmp;t.el.blur(),n.html(e),r.html(e),C.call(this)}function O(e){var t=this.validator,r=this.editorText,n=r.getText();if(t&&"list"===t.type)n=r.setText(e);else{this.pos=g.call(this);for(var i=this.pos-(0,s.cuttingByPos)(n,this.pos).length,a=(0,s.cuttingByPosEnd)(n,this.pos+1),o=["",""],l=this.pos+a.length,u=0;u<n.length;u++)u<i&&(o[0]+=n[u]),u>l-1&&(o[1]+=n[u]);n=r.setText("".concat(o[0]+e.key,"(")),this.pos=r.getText().length,n=r.setText(n+")".concat(o[1]))}this.textEl.html(n),this.textlineEl.html(n),this.suggest.hide(),R.call(this,n,this.pos),this.change("input",n),E.call(this,this.textEl.el,-1),y.call(this)}function _(){this.suggestContent.hide()}function D(){this.suggest.setItems(this.formulas)}function N(){return"black"===this.textEl.el.style["caret-color"]&&"1"===this.textEl.el.style.opacity}var k=function(){function e(t,r,s,u,d,h){var p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewFn=r,this.rowHeight=s,this.formulas=t,this.sheet=h,this.display=!0,this.suggest=new i.default(t,(function(e){O.call(p,e)}),d,this),this.suggestContent=new l.default,this.lock=!1,this.state=1,this.data=d,this.datepicker=new a.default,this.isCors=!1,this.datepicker.change((function(e){p.setText(function(e){var t=e.getMonth()+1,r=e.getDate();return t<10&&(t="0".concat(t)),r<10&&(r="0".concat(r)),"".concat(e.getFullYear(),"-").concat(t,"-").concat(r)}(e)),p.clear()})),this.ri=-1,this.ci=-1,this.spanArr=[],this.mousedownIndex=[],this.changed=!1,this.chinese=!0,this.editorText=new f.default(""),this.areaEl=(0,n.h)("div","".concat(o.cssPrefix,"-editor-area")).children(this.textEl=(0,n.h)("div","".concat(o.cssPrefix,"-editor-textEl")).on("input",(function(e){return A.call(p,e)})).on("click",(function(){return b.call(p)})).on("keyup",(function(e){return S.call(p,e)})).on("mousedown",(function(e){if(2===e.detail){if(N.call(p))return;p.show(),setTimeout((function(){var e=p.ri,t=p.ci;console.log(e,t),p.setCellEnd(d.getSelectedCellRiCi(e,t))}))}})).on("compositionstart",(function(){p.chinese=!1})).on("compositionend",(function(){p.chinese=!0})).on("paste",(function(e){"black"===p.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("copy",(function(e){"black"===p.textEl.el.style["caret-color"]&&e.stopPropagation()})).on("keydown",(function(e){y.call(p),p.textlineEl.html(e.currentTarget.innerText);var t=e.keyCode;if(38!==t&&40!==t||e.preventDefault(),115===t){var r=p.editorText.f4ShortcutKey(g.call(p)),n=r.inputText,i=r.pos;return A.call(p,null,n,n),void setTimeout((function(){p.pos=i,E.call(p,p.textEl.el,-1)}))}if("black"!==p.textEl.el.style["caret-color"]){var a=e.ctrlKey,o=e.metaKey;8===t||46===t?c.createEvent.call(p,8,!1):40===t?(p.clear(),c.createEvent.call(p,40,!1)):39===t?(p.clear(),c.createEvent.call(p,39,!1)):37===t?(p.clear(),c.createEvent.call(p,37,!1)):38===t?(p.clear(),c.createEvent.call(p,38,!1)):(a||o)&&(67===t?c.createEvent.call(p,67,!0):86===t?c.createEvent.call(p,86,!0):88===t?c.createEvent.call(p,88,!0):90===t?c.createEvent.call(p,90,!0):66===t&&c.createEvent.call(p,66,!0))}})),this.textlineEl=(0,n.h)("div","textline"),this.suggestContent.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),h.el.child(this.suggest.el),this.el=(0,n.h)("div","".concat(o.cssPrefix,"-editor")).children(this.areaEl),this.suggest.bindInputEvents(this.textEl),this.textEl.on("paste",(function(e){!1!==N.call(p)&&function(e){e.preventDefault();var t="",r=(e.originalEvent||e).clipboardData;if(null==r){if(""!==(t=window.clipboardData.getData("text")||""))if(window.getSelection){var n=document.createElement("span");n.innerHTML=t,window.getSelection().getRangeAt(0).insertNode(n)}else document.selection.createRange().pasteHTML(t)}else""!==(t=r.getData("text/plain")||"")&&document.execCommand("insertText",!1,t)}(e)})),this.tmp=(0,n.h)("span","span_tmp").hide(),this.textEl.attr("contenteditable","true"),this.textEl.css("width","".concat(u-3,"px")),this.textEl.css("height","".concat(s-2,"px")),this.textEl.child(this.tmp),this.pos=0,this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,setTimeout((function(){p.show(!1)})),this.change=function(){}}var t,r,s;return t=e,(r=[{key:"setFreezeLengths",value:function(e,t){this.freeze.w=e,this.freeze.h=t}},{key:"setMouseDownIndex",value:function(e){this.mousedownIndex=e}},{key:"setRiCi",value:function(e,t){this.ri=e,this.ci=t}},{key:"setLock",value:function(e){this.lock=e}},{key:"getLock",value:function(){return this.lock}},{key:"show",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.data.settings.showEditor?(this.textEl.css("caret-color","black"),this.textEl.css("cursor","text"),this.textEl.css("opacity","1"),this.textEl.el.focus(),this.areaEl.css("pointer-events","auto"),this.areaEl.css("border","2px solid #4b89ff"),this.areaEl.css("background","white")):(this.textEl.css("caret-color","white"),this.textEl.css("cursor","default"),this.textEl.css("opacity","0"),this.textEl.el.blur(),this.areaEl.css("pointer-events","none"),this.areaEl.css("background","rgba(75, 137, 255, 0)"),this.areaEl.css("border","none"))}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=this.editorText,r=t.getText();-1!==e?(this.pos=g.call(this),R.call(this,r,this.pos)):w.call(this,r)}},{key:"clear",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.editorText,n=r.getText();return this.display=N.call(this),""!==n&&isNaN(n)&&0===n.replace(/\s/g,"").lastIndexOf("¥")?this.change("format",n):this.changed&&this.change("finish",n),this.changed=!1,this.cell=null,this.areaOffset=null,r.setText(""),this.show(!1),this.copy=!1,E.call(this,this.textEl.el,-1),this.pos=0,this.tmp.hide(),this.textEl.html(""),this.textlineEl.html(""),_.call(this),D.call(this),this.datepicker.hide(),!t&&(setTimeout((function(){var t=e.data.selector,r=t.ri,n=t.ci;e.setRiCi(r,n)})),this.display)}},{key:"mount2span",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{suggestContent:!1,cut:"",pos:-1};if(this.spanArr!==e){var a,o=this.suggest.show;i.suggestContent&&!o?this.suggestContent.content(i.cut,i.pos):this.suggestContent.hide(),Object.keys(e).forEach((function(t){e[t].css("background-color","rgba(255,255,255,0.1)")})),"-1"!==t&&-1!==r&&e[t]&&(e[t].css("background-color","#e5e5e5"),e[r].css("background-color","#e5e5e5")),e.length>0&&(this.textEl.html(""),this.tmp=(a=(0,n.h)("span","span_tmp")).children.apply(a,m(e)).css("top","0px").css("color","black").css("font-size","14px").css("font-family","m-inconsolata,monospace,arial,sans,sans-serif"),this.textEl.el.insertBefore(this.tmp.el,this.textEl.el.childNodes[0]),E.call(this,this.textEl.el,-1)),this.spanArr=e}}},{key:"handler",value:function(e){var t=this.editorText.getText(),r=this.pos;if(r>=t)this.setMouseDownIndex([]);else{var n=e.substring(0,r),i=e.substring(r,e.length);w.call(this,n),""!==i?this.setMouseDownIndex([n,i]):this.setMouseDownIndex([])}}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.textEl,i=this.areaEl,a=this.suggest,o=this.freeze,s=this.el;if(e){this.areaOffset=e;var l=e.left,u=e.top,c=e.width,f=e.height,d=e.l,h=e.t,p={left:0,top:0};o.w>d&&o.h>h||(o.w<d&&o.h<h?(p.left=o.w,p.top=o.h):o.w>d?p.top=o.h:o.h>h&&(p.left=o.w)),s.offset(p),i.offset({left:l-p.left-.8,top:u-p.top-.8}),n.offset({width:c-2+.8,height:f-3+.8});var m={left:0};m[t]=f,a.hide(),y.call(this),r&&this.show(!1)}}},{key:"setCellEnd",value:function(e){var t=this,r="",n=e&&e.formulas||"";(0,h.isHave)(e)&&(0,h.isHave)(e.text)&&(r=e.text),(0,h.isHave)(e)&&(0,h.isHave)(e.formulas)&&(r=e.formulas);var i=this.data,a=i.rows,o=i.getCellStyleOrDefault(this.ri,this.ci),s=i.renderFormat(o,e,this.ri,this.ci,!0);s.state&&(r=s.cellText,n=s.cellText),this.textEl.child(r+""),this.pos=r.length,E.call(this,this.textEl.el,-1),this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci}),d.testValid.call(this),A.call(this,null,r,n,"end"),setTimeout((function(){t.pos=a.toString(r).length,E.call(t,t.textEl.el,-1)}),20)}},{key:"setCell",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.cell=e,this.show();var i=e&&e.formulas||"";i=""===i?e&&e.text||"":i,this.editorText.setOldCell({text:e&&e.text||"",formulas:e&&e.formulas||""},{ri:this.ri,ci:this.ci});var a=this.el,o=this.datepicker,s=this.suggest;if(a.show(),this.textEl.show(),E.call(this,this.textEl.el,-1),setTimeout((function(){r.pos=i.length,E.call(r,r.textEl.el)}),10),this.validator=t,t){var l=t.type;"date"===l&&(o.show(),/^\s*$/.test(i)||o.setValue(i)),"list"===l&&(s.setItems(t.values()),s.search(""))}2===n&&""!==i&&"="===i[0]?(A.call(this,null,i),this.pos=i.length,E.call(this,this.textEl.el,i.length)):2===n&&"="!==i[0]&&this.textEl.child(i),setTimeout((function(){r.textlineEl.html(i),y.call(r)}))}},{key:"isDisplay2",value:function(){return N.call(this)}},{key:"setCursorPos",value:function(e){this.pos=e,E.call(this,this.textEl.el)}},{key:"setText",value:function(e){this.editorText.setText(e),T.call(this,e),y.call(this),this.textEl.child(this.tmp)}}])&&v(t.prototype,r),s&&v(t,s),e}();t.default=k},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(159))&&n.__esModule?n:{default:n},a=r(0),o=r(1),s=r(22);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.calendar=new i.default(new Date),this.el=(0,a.h)("div","".concat(o.cssPrefix,"-datepicker")).child(this.calendar.el).hide()}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){var t=this.calendar;return"string"==typeof e?(0,s.str2Re)(s.calendarPattern).test(e)&&t.setValue(new Date(e.replace(new RegExp("-","g"),"/"))):e instanceof Date&&t.setValue(e),this}},{key:"change",value:function(e){var t=this;this.calendar.selectChange=function(r){e(r),t.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=(n=r(12))&&n.__esModule?n:{default:n},o=r(10);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){e.setMonth(e.getMonth()+t)}function c(e,t){var r=new Date(e);return r.setDate(t-e.getDay()+1),r}var f=function(){function e(t){var r,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.cvalue=new Date(t),this.headerLeftEl=(0,i.h)("div","calendar-header-left"),this.bodyEl=(0,i.h)("tbody",""),this.buildAll(),this.el=(0,i.h)("div","fin-cell-calendar").children((0,i.h)("div","calendar-header").children(this.headerLeftEl,(0,i.h)("div","calendar-header-right").children((0,i.h)("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new a.default("chevron-left")),(0,i.h)("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new a.default("chevron-right")))),(0,i.h)("table","calendar-body").children((0,i.h)("thead","").child((r=(0,i.h)("tr","")).children.apply(r,s((0,o.t)("calendar.weeks").map((function(e){return(0,i.h)("th","cell").child(e)}))))),this.bodyEl)),this.selectChange=function(){}}var t,r,n;return t=e,(r=[{key:"setValue",value:function(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}},{key:"prev",value:function(){u(this.value,-1),this.buildAll()}},{key:"next",value:function(){u(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var e=this.value;this.headerLeftEl.html("".concat((0,o.t)("calendar.months")[e.getMonth()]," ").concat(e.getFullYear()))}},{key:"buildBody",value:function(){var e,t=this,r=this.value,n=this.cvalue,a=this.bodyEl,o=function(e,t,r){for(var n=new Date(e,t,1,23,59,59),i=[[],[],[],[],[],[]],a=0;a<6;a+=1)for(var o=0;o<7;o+=1){var s=c(n,7*a+o),l=s.getMonth()!==t,u=s.getMonth()===r.getMonth()&&s.getDate()===r.getDate();i[a][o]={d:s,disabled:l,active:u}}return i}(r.getFullYear(),r.getMonth(),n).map((function(e){var r,n=e.map((function(e){var r="cell";return e.disabled&&(r+=" disabled"),e.active&&(r+=" active"),(0,i.h)("td","").child((0,i.h)("div",r).on("click.stop",(function(){t.selectChange(e.d)})).child(e.d.getDate().toString()))}));return(r=(0,i.h)("tr","")).children.apply(r,s(n))}));(e=a.html("")).children.apply(e,s(o))}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(0),a=r(161),o=r(8);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r,n){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=(0,i.h)("div",n),l=0;l<e[t].length;l++){var u=e[t][l],c=u.name,f=u.editor,d=u.index;r===l?s.child((0,i.h)("span",a).child(c)):!0===f&&r>=d?s.child((0,i.h)("span",a).child(c)):s.child((0,i.h)("span",o).child(c))}return s}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"300px";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,i.h)("div","".concat(n.cssPrefix,"-suggest-content")).css("width",t).css("z-index","10000").css("position","absolute").hide(),this.el.attr("tabindex",0),(0,o.bind)(this.el.el,"paste",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"copy",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"keydown",(function(e){e.stopPropagation()})),(0,o.bind)(this.el.el,"keyup",(function(e){e.stopPropagation()}))}var t,r,u;return t=e,(r=[{key:"hide",value:function(){this.el.hide()}},{key:"content",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=this.el;t=t.toUpperCase();var s={};if(Object.keys(a.helpFormula).forEach((function(e){e===t&&(s=a.helpFormula[e])})),s&&"{}"!==JSON.stringify(s)){var u=[],c=l.call(this,s,"title",r,"".concat(n.cssPrefix,"-help-title"),"".concat(n.cssPrefix,"-help-span-title"),"".concat(n.cssPrefix,"-help-span2-title")),f=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-title")).child("示例"),d=l.call(this,s,"example",r,"".concat(n.cssPrefix,"-help-section-content"),"".concat(n.cssPrefix,"-help-span3-title"));u.push.apply(u,[c,f,d]),Object.keys(s.content).forEach((function(e){var t=s.content[e],r=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-title")).child(e),a=(0,i.h)("div","".concat(n.cssPrefix,"-help-section-content")).child(t);u.push.apply(u,[r,a])})),(e=o.html("")).children.apply(e,u).show()}}}])&&s(t.prototype,r),u&&s(t,u),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.helpFormula=void 0;t.helpFormula={ADD:{title:[{name:"ADD(",editor:!1},{name:"value1",editor:!1},{name:"，",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"ADD(",editor:!1},{name:"2",editor:!1},{name:"，",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数值之和。相当于 + 运算符。",value1:"第一个加数。",value2:"第二个加数。"}},IRR:{title:[{name:"IRR(",editor:!1},{name:"values",editor:!1},{name:",",editor:!1},{name:"guess",editor:!1},{name:")",editor:!1}],example:[{name:"IRR(",editor:!1},{name:"A1:A10",editor:!1},{name:",",editor:!1},{name:"0.1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回由数值代表的一组现金流的内部收益率。这些现金流不必为均衡的，但作为年金，它们必须按固定的间隔产生，如按月或按年。内部收益率为投资的回收利率，其中包含定期支付（负值）和定期收入（正值）。",values:"为数组或单元格的引用，包含用来计算返回的内部收益率的数字。至少各含一个正值和一个负值",guess:"对函数 IRR 计算结果的估计值，默认为0.1"}},SUM:{title:[{name:"SUM(",editor:!1},{name:"value1",editor:!1},{name:"，",editor:!1},{name:"[value2, ...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"SUM(",editor:!1},{name:"A2:A100",editor:!1},{name:",",editor:!1},{name:"101",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回一组数值和/或单元格的总和。",value1:"要相加的第一个数值或范围。",value2:"要与“value1”相加的其他数值或范围。"}},ABS:{title:[{name:"ABS(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ABS(",editor:!1},{name:"-2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的绝对值。绝对值没有符号。",value:"需要计算其绝对值的实数。"}},SQRT:{title:[{name:"SQRT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SQRT(",editor:!1},{name:"4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回正平方根。",value:"要计算平方根的数。"}},CEILING:{title:[{name:"CEILING(",editor:!1},{name:"number",editor:!1},{name:",",editor:!1},{name:"significance",editor:!1},{name:")",editor:!1}],example:[{name:"CEILING(",editor:!1},{name:"10.4",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"将参数 Number 向上舍入（沿绝对值增大的方向）为最接近的 significance 的倍数。",number:"所要四舍五入的数值。",significance:"用以进行舍入计算的倍数。"}},CONCATENATE:{title:[{name:"CONCATENATE(",editor:!1},{name:"text1",editor:!1},{name:"，",editor:!1},{name:"[text2, ...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"CONCATENATE(",editor:!1},{name:"文本1",editor:!1},{name:"，",editor:!1},{name:"文本2",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将两个或多个文本字符串合并为一个文本字符串。",text1:"待合并文本字符串",text2:"要与“text1”合并的其他待合并文本字符串。"}},PMT:{title:[{name:"PMT(",editor:!1},{name:"rate",editor:!1},{name:",",editor:!1},{name:"nper",editor:!1},{name:",",editor:!1},{name:"pv",editor:!1},{name:",",editor:!1},{name:"fv",editor:!1},{name:",",editor:!1},{name:"type",editor:!1},{name:")",editor:!1}],example:[{name:"PMT(",editor:!1},{name:"0.1",editor:!1},{name:",",editor:!1},{name:"120",editor:!1},{name:",",editor:!1},{name:"1000",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:")",editor:!1}],content:{abstract:"基于固定利率及等额分期付款方式，返回贷款的每期付款额。",rate:"贷款利率。",nper:"该项贷款的付款期数。",pv:"现值，或一系列未来付款的当前值的累积和，也称为本金。",fv:"为未来值，或在最后一次付款后希望得到的现金余额，如果省略 fv，则假设其值为零，也就是一笔贷款的未来值为零。",type:"指定各期的付款时间是在期初还是期末。0或者省略为期初，1为期末"}},COUNTA:{title:[{name:"COUNTA(",editor:!1},{name:"value1",editor:!1},{name:"，",editor:!1},{name:"[value2, ...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"COUNTA(",editor:!1},{name:"A1",editor:!1},{name:"，",editor:!1},{name:"A5",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回参数列表中非空值的单元格个数。",value1:"要计数的单元格",value2:"要计数的单元格"}},STDEV:{title:[{name:"STDEV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"STDEV(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"估算基于样本的标准偏差",value1:"对应于总体样本的第一个数值参数",value2:"对应于总体样本的 2 到 255 个数值参数。也可以用单一数组或对某个数组的引用来代替用逗号分隔的参数"}},AVERAGE:{title:[{name:"AVERAGE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3}],example:[{name:"AVERAGE(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"5",editor:!0,index:3}],content:{abstract:"返回参数的平均值 (算术平均值)",value1:"要计算平均值的第一个数字、单元格引用或单元格区域",value2:"要计算平均值的其他数字、单元格引用或单元格区域，最多可包含 255 个"}},EXP:{title:[{name:"Exp(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"Exp(",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 e 的 n 次幂",value1:"底数 e 的指数"}},LN:{title:[{name:"LN(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"LN(",editor:!1},{name:"86",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一个数的自然对数",value1:"想要计算其自然对数的正实数"}},TRIM:{title:[{name:"TRIM(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"TRIM(",editor:!1},{name:"(' First Quarter Earnings  ')",editor:!1},{name:")",editor:!1}],content:{abstract:"除了单词之间的单个空格外，清除文本中所有的空格",text:"需要删除其中空格的文本"}},HYPERLINK:{title:[{name:"HYPERLINK(",editor:!1},{name:"网址",editor:!1},{name:",",editor:!1},{name:"[链接标签]",editor:!1},{name:")",editor:!1}],example:[{name:"HYPERLINK(",editor:!1},{name:'"http://www.google.com/"',editor:!1},{name:",",editor:!1},{name:'"Google"',editor:!1},{name:")",editor:!1}],content:{abstract:"在单元格内创建一个超链接。",url:"以引号括住的链接位置的完整网址，或对包含这种网址的单元格的引用。",linktag:"用引号括住的要在单元格中作为链接显示的文字，或对包含此类标签的单元格的引用。"}},LEN:{title:[{name:"LEN(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"LEN(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回文本字符串中的字符数",text:"要查找其长度的文本,也可为单元格引用。空格将作为字符进行计数"}},ISBLANK:{title:[{name:"ISBLANK(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"ISBLANK(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"检验指定值并根据参数取值返回 TRUE 或 FALSE",value1:"要检验的值。参数 value 可以是空白（空单元格）、错误值、逻辑值、文本、数字、引用值，或者引用要检验的以上任意值的名称"}},ACCRINT:{title:[{name:"ACCRINT(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"利率",editor:!1},{name:",",editor:!1},{name:"票面值",editor:!1},{name:",",editor:!1},{name:"年付息次数",editor:!1},{name:")",editor:!1}],example:[{name:"ACCRINT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回定期付息证券的应计利息",date1:"证券的发行日",date2:"证券的首次计息日",date3:"证券的结算日。证券结算日是在发行日期之后，证券卖给购买者的日期",rate:"证券的年息票利率",price:"证券的票面值。如果省略此参数，则 ACCRINT 使用 ￥1,000",frequency:"年付息次数。如果按年支付，frequency = 1；按半年期支付，frequency = 2；按季支付，frequency = 4"}},ACCRINTM:{title:[{name:"ACCRINTM(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"利率",editor:!1},{name:"'",editor:!1},{name:"票面值",editor:!1},{name:")",editor:!1}],example:[{name:"ACCRINTM(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:"'",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回到期一次性付息有价证券的应计利息",date1:"证券的发行日",date2:"证券的到期日",rate:"证券的年息票利率",price:"证券的票面值。如果省略此参数，则 ACCRINTM 使用 ￥1,000"}},ACOS:{title:[{name:"ACOS(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"ACOS(",editor:!1},{name:"-0.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的反余弦值",value1:"所需的角度余弦值，必须介于 -1 到 1 之间"}},ACOSH:{title:[{name:"ACOSH(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"ACOSH(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 value1 参数的反双曲余弦值",value1:"大于等于 1 的任意实数"}},ACOT:{title:[{name:"ACOT(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"ACOT(",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的反余切值的主值",value1:"value1 为所需角度的余切值。 此值必须是实数"}},ACOTH:{title:[{name:"ACOTH(",editor:!1},{name:"value1",editor:!1},{name:")",editor:!1}],example:[{name:"ACOTH(",editor:!1},{name:"6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的反双曲余切值",value1:"value1 的绝对值必须大于 1"}},AMORDEGRC:{title:[{name:"AMORDEGRC(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"折旧率",editor:!1},{name:")",editor:!1}],example:[{name:"AMORDEGRC(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回每个结算期间的折旧值",value1:"资产原值",date1:"购入资产的日期",date2:"第一个期间结束时的日期",value2:"资产在使用寿命结束时的残值",value3:"期间",depreciationrate:"折旧率"}},AMORLINC:{title:[{name:"AMORLINC(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"期间",editor:!1},{name:",",editor:!1},{name:"折旧率",editor:!1},{name:")",editor:!1}],example:[{name:"AMORLINC(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"期间",editor:!1},{name:",",editor:!1},{name:"折旧率",editor:!1},{name:")",editor:!1}],content:{abstract:"返回每个结算期间的折旧值，该函数为法国会计系统提供。如果某项资产是在结算期间的中期购入的，则按线性折旧法计算",value1:"资产原值",date1:"购入资产的日期",date2:"第一个期间结束时的日期",value2:"资产在使用寿命结束时的残值",period:"期间",depreciationrate:"折旧率"}},AND:{title:[{name:"AND(",editor:!1},{name:"逻辑值1",editor:!1},{name:",",editor:!1},{name:"[逻辑值2,...]",editor:!0,index:3}],example:[{name:"AND(",editor:!1},{name:"A2>1",editor:!1},{name:",",editor:!1},{name:"A2<100",editor:!0,index:3}],content:{abstract:"所有参数的计算结果为 TRUE 时，AND 函数返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE",logic1:"第一个想要测试且计算结果可为 TRUE 或 FALSE 的条件",logic2:"其他想要测试且计算结果可为 TRUE 或 FALSE 的条件（最多 255 个条件）"}},ARABIC:{title:[{name:"ARABIC(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"ARABIC(",editor:!1},{name:"'LVII'",editor:!1},{name:")",editor:!1}],content:{abstract:"将罗马数字转换为阿拉伯数字",text:"用引号引起的字符串、空字符串 ('') 或对包含文本的单元格的引用"}},ASC:{title:[{name:"ASC(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"ASC(",editor:!1},{name:"'EXCEL' ",editor:!1},{name:")",editor:!1}],content:{abstract:"对于双字节字符集 (DBCS) 语言，将全角（双字节）字符更改为半角（单字节）字符",text:"文本或对包含要更改的文本的单元格的引用。如果文本中不包含任何全角字母，则文本不会更改"}},ASIN:{title:[{name:"ASIN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ASIN(",editor:!1},{name:"-0.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回参数的反正弦值",value:"所需的角度正弦值，必须介于 -1 到 1 之间"}},ASINH:{title:[{name:"ASINH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ASINH(",editor:!1},{name:"-2.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回参数的反双曲正弦值",value:"任意实数"}},ATAN:{title:[{name:"ATAN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ATAN(",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回反正切值",value:"所需的角度正切值"}},ATAN2:{title:[{name:"ATAN2(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"ATAN2(",editor:!1},{name:"-1",editor:!1},{name:",",editor:!1},{name:"-1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回给定的 X 及 Y 坐标值的反正切值",value1:"点的 x 坐标",value2:"点的 y 坐标"}},ATANH:{title:[{name:"ATANH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ATANH(",editor:!1},{name:"-0.1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回参数的反双曲正切值，参数必须介于 -1 到 1 之间（除去 -1 和 1）",value:"-1 到 1 之间的任意实数"}},AVEDEV:{title:[{name:"AVEDEV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"AVEDEV(",editor:!1},{name:"A2:A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据与其均值的绝对偏差的平均值，AVEDEV 用于评测这组数据的离散度",value1:"任意实数",value2:"用于计算绝对偏差平均值的一组参数，参数的个数可以为 1 到 255 个"}},AVERAGEA:{title:[{name:"AVERAGEA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"AVERAGEA(",editor:!1},{name:"A2:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"计算参数列表中数值的平均值",value1:"任意实数",value2:"需要计算平均值的 1 到 255 个单元格、单元格区域或值"}},AVERAGEIF:{title:[{name:"AVERAGEIF(",editor:!1},{name:"引用范围",editor:!1},{name:",",editor:!1},{name:"标准条件",editor:!1},{name:")",editor:!1}],example:[{name:"AVERAGEIF(",editor:!1},{name:"B2:B5",editor:!1},{name:",",editor:!1},{name:"'<23000'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回某个区域内满足给定条件的所有单元格的平均值（算术平均值）",referencearea:"要计算平均值的一个或多个单元格，其中包括数字或包含数字的名称、数组或引用",standardcondition:"数字、表达式、单元格引用或文本形式的条件，用于定义要对哪些单元格计算平均值"}},AVERAGEIFS:{title:[{name:"AVERAGEIFS(",editor:!1},{name:"引用范围",editor:!1},{name:",",editor:!1},{name:"标准条件_适用范围1",editor:!1},{name:",",editor:!1},{name:"标准条件1",editor:!1},{name:",",editor:!1},{name:"[标准条件_适用范围2,标准条件2,...]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"AVERAGEIFS(",editor:!1},{name:"B2:B7",editor:!1},{name:",",editor:!1},{name:"C2:C7",editor:!1},{name:",",editor:!1},{name:"毕尔褔",editor:!1},{name:",",editor:!1},{name:"D2:D7",editor:!1},{name:",",editor:!1},{name:"'>2'",editor:!1},{name:",",editor:!1},{name:"E2:E7",editor:!1},{name:",",editor:!1},{name:"'是'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回满足多重条件的所有单元格的平均值（算术平均值）",referencearea:"要计算平均值的一个或多个单元格，其中包括数字或包含数字的名称、数组或引用",standardcondition_area1:"要计算平均值的实际单元格集",standardcondition1:"定义要对适用范围1中的哪些单元格计算平均值",standardcondition_area2:"适用范围及其对应的标准条件"}},BAHTTEXT:{title:[{name:"BAHTTEXT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"BAHTTEXT(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"将数字转换为泰语文本并添加后缀“泰铢”",value:"要转换成文本的数字、对包含数字的单元格的引用或结果为数字的公式"}},BASE:{title:[{name:"BASE(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"基",editor:!1},{name:",",editor:!1},{name:"[最小长度]",editor:!0,index:6},{name:")",editor:!1}],example:[{name:"BASE(",editor:!1},{name:"15",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"10",editor:!0,index:6},{name:")",editor:!1}],content:{abstract:"将数字转换为具备给定基数的文本表示",value:"要转换的数字。 必须是大于或等于0且小于 2 ^ 53 的整数",basic:"要将数字转换为的基础基数。 必须是大于或等于2且小于或等于36的整数",minlength:"返回的字符串的最小长度。 必须是大于或等于0的整数"}},BESSELI:{title:[{name:"BESSELI(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BESSELI(",editor:!1},{name:"1.5",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回修正 Bessel 函数值，它与用纯虚数参数运算时的 Bessel 函数值相等",value1:"用来进行函数计算的数值",value2:"Bessel 函数的阶数。如果 n 不是整数，则截尾取整"}},BESSELJ:{title:[{name:"BESSELJ(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BESSELJ(",editor:!1},{name:"1.9",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 Bessel 函数值",value1:"用来进行函数计算的数值",value2:"Bessel 函数的阶数。如果 n 不是整数，则截尾取整"}},BESSELK:{title:[{name:"BESSELK(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BESSELK(",editor:!1},{name:"1.5",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回修正 Bessel 函数值，它与用纯虚数参数运算时的 Bessel 函数值相等",value1:"用来进行函数计算的数值",value2:"Bessel 函数的阶数。如果 n 不是整数，则截尾取整"}},BESSELY:{title:[{name:"BESSELY(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BESSELY(",editor:!1},{name:"2.5",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 Bessel 函数值，也称为 Weber 函数或 Neumann 函数",value1:"用来进行函数计算的数值",value2:"Bessel 函数的阶数。如果 n 不是整数，则截尾取整"}},"BETA.DIST":{title:[{name:"BETA.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"逻辑值",editor:!1},{name:",",editor:!1},{name:"[下界]",editor:!0,index:10},{name:",",editor:!1},{name:"[上界]",editor:!0,index:12},{name:")",editor:!1}],example:[{name:"BETA.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"True",editor:!1},{name:",",editor:!1},{name:"A5",editor:!0,index:10},{name:",",editor:!1},{name:"A6",editor:!0,index:12},{name:")",editor:!1}],content:{abstract:"返回 Beta 分布",value1:"介于 A 和 B 之间用来进行函数计算的值",value2:"分布参数",value3:"分布参数",logic:"决定函数形式的逻辑值。如果 cumulative 为 TRUE，BETA.DIST 返回累积分布函数；如果为 FALSE，则返回概率密度函数",lowbound:"value1所属区间的下界",upbound:"value1所属区间的上界"}},"BETA.INV":{title:[{name:"BETA.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"[下界]",editor:!0,index:8},{name:",",editor:!1},{name:"[上界]",editor:!0,index:10},{name:")",editor:!1}],example:[{name:"BETA.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!0,index:8},{name:",",editor:!1},{name:"A6",editor:!0,index:10},{name:")",editor:!1}],content:{abstract:"返回 Beta 累积概率密度函数 (BETA.DIST) 的反函数",value1:"与 beta 分布相关的概率",value2:"分布参数",value3:"分布参数",lowbound:"value1所属区域的下界",upbound:"value1所属区域的上界"}},BIN2DEC:{title:[{name:"BIN2DEC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"BIN2DEC(",editor:!1},{name:"1100100",editor:!1},{name:")",editor:!1}],content:{abstract:"将二进制数转换为十进制数",value:"希望转换的二进制数"}},BIN2HEX:{title:[{name:"BIN2HEX(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!1},{name:")",editor:!1}],example:[{name:"BIN2HEX(",editor:!1},{name:"11111011",editor:!1},{name:",",editor:!1},{name:"4",editor:!1},{name:")",editor:!1}],content:{abstract:"将二进制数转换为十六进制数",value1:"希望转换的二进制数",value2:"要使用的字符数"}},BIN2OCT:{title:[{name:"BIN2OCT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!1},{name:")",editor:!1}],example:[{name:"BIN2OCT(",editor:!1},{name:"1001",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"将二进制数转换为八进制数",value1:"希望转换的二进制数",value2:"要使用的字符数"}},"BINOM.DIST":{title:[{name:"BINOM.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"BINOM.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"FALSE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回二项式分布的概率",value1:"试验成功的次数",value2:"独立试验的次数",value3:"每次试验中成功的概率",value4:"决定函数形式的逻辑值"}},"BINOM.INV":{title:[{name:"BINOM.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"BINOM.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回使累积二项式分布大于等于临界值的最小值",value1:"伯努利试验次数",value2:"每次试验中成功的概率",value3:"临界值"}},BITAND:{title:[{name:"BITAND(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BITAND(",editor:!1},{name:"13",editor:!1},{name:",",editor:!1},{name:"25",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数的按位“与”",value1:"必须为十进制格式且大于等于 0",value2:"必须为十进制格式且大于等于 0"}},BITLSHIFT:{title:[{name:"BITLSHIFT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BITLSHIFT(",editor:!1},{name:"4",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回向左移动指定位数后的数值",value1:"必须是大于或等于0的整数",value2:"必须是整数"}},BITOR:{title:[{name:"BITOR(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BITOR(",editor:!1},{name:"23",editor:!1},{name:",",editor:!1},{name:"10",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数的按位“或”",value1:"必须为十进制格式且大于等于 0",value2:"必须为十进制格式且大于等于 0"}},BITRSHIFT:{title:[{name:"BITRSHIFT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BITRSHIFT(",editor:!1},{name:"13",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回向右移动指定位数后的数值",value1:"必须是大于或等于0的整数",value2:"必须是整数"}},BITXOR:{title:[{name:"BITXOR(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"BITXOR(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数值的按位“异或”结果",value1:"必须大于或等于 0",value2:"必须大于或等于 0"}},"CEILING.MATH":{title:[{name:"CEILING.MATH(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value3]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"CEILING.MATH(",editor:!1},{name:"-5.5",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:3},{name:",",editor:!1},{name:"-1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"将数字向上舍入为最接近的整数或最接近的指定基数的倍数",value1:"必须小于 9.99 E + 307 且大于-2.229 E-308",value2:"要将数字舍入到的倍数",value3:"对于负数, 控制数字是舍入还是远离零"}},"CEILING.PRECISE":{title:[{name:"CEILING.PRECISE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"CEILING.PRECISE(",editor:!1},{name:"4.3",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回一个数字，该数字向上舍入为最接近的整数或最接近的有效位的倍数",value1:"要进行舍入的值",value2:"要将数字舍入的倍数,如果省略，则其默认值为 1"}},CELL:{title:[{name:"CELL(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!1},{name:")",editor:!1}],example:[{name:"CELL(",editor:!1},{name:"“row”",editor:!1},{name:",",editor:!1},{name:"A20",editor:!1},{name:")",editor:!1}],content:{abstract:"返回有关单元格的格式、位置或内容的信息",value1:"一个文本值，指定要返回的单元格信息的类型",value2:"需要其相关信息的单元格。如果省略，则将 value1 参数中指定的信息返回给最后更改的单元格。如果参数 value2 是某一单元格区域，则函数只将该信息返回给该区域左上角的单元格"}},CHAR:{title:[{name:"CHAR(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"CHAR(",editor:!1},{name:"65",editor:!1},{name:")",editor:!1}],content:{abstract:"返回对应于数字代码的字符",value:"介于 1 到 255 之间用于指定所需字符的数字"}},CHIDIST:{title:[{name:"CHIDIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"CHIDIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 χ2 分布的右尾概率",value1:"用来计算分布的值",value2:"自由度的数值"}},CHIINV:{title:[{name:"CHIINV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"CHIINV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 χ2 分布的右尾概率的反函数",value1:"与 χ2 分布相关的概率",value2:"自由度的数值"}},"CHISQ.DIST":{title:[{name:"CHISQ.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"CHISQ.DIST(",editor:!1},{name:"0.5",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 χ2 分布",value1:"用来计算分布的值",value2:"自由度数",value3:"决定函数形式的逻辑值。如果为 TRUE，则返回累积分布函数；如果为 FALSE，则返回概率密度函数"}},"CHISQ.INV":{title:[{name:"CHISQ.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"CHISQ.INV(",editor:!1},{name:"0.93",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 χ2 分布的左尾概率的反函数",value1:"与 χ2 分布相关联的概率",value2:"自由度数"}},"CHISQ.TEST":{title:[{name:"CHISQ.TEST(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"CHISQ.TEST(",editor:!1},{name:"A2:B4",editor:!1},{name:",",editor:!1},{name:"A6:B8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回独立性检验值",area1:"包含观察值的数据区域，用于检验预期值",area2:"包含行列汇总的乘积与总计值之比率的数据区域"}},CHOOSE:{title:[{name:"CHOOSE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[value3,...]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"CHOOSE(",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"使用 value1 返回数值参数列表中的数值",value1:"指定所选定的值参数。value1 必须为 1 到 254 之间的数字，或者为公式或对包含 1 到 254 之间某个数字的单元格的引用",value2:"value2 是必需的，后续值是可选的。可以为数字、单元格引用、已定义名称、公式、函数或文本",value3:"可以为数字、单元格引用、已定义名称、公式、函数或文本"}},CLEAN:{title:[{name:"CLEAN(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"CLEAN(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"删除文本中不能打印的字符",text:"要从中删除非打印字符的任何工作表信息"}},CODE:{title:[{name:"CODE(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"CODE(",editor:!1},{name:"“A”",editor:!1},{name:")",editor:!1}],content:{abstract:"返回文本字符串中第一个字符的数字代码",text:"需要得到其第一个字符代码的文本"}},COLUMN:{title:[{name:"COLUMN(",editor:!1},{name:"[数值]",editor:!0,index:1},{name:")",editor:!1}],example:[{name:"COLUMN(",editor:!1},{name:"C10",editor:!0,index:1},{name:")",editor:!1}],content:{abstract:"返回指定单元格引用的列号",value:"要返回其列号的单元格或单元格区域"}},COLUMNS:{title:[{name:"COLUMNS(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"COLUMNS(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数组或引用的列数",array:"需要得到其列数的数组、数组公式或对单元格区域的引用"}},COMBIN:{title:[{name:"COMBIN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"COMBIN(",editor:!1},{name:"8",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"计算从给定数目的对象集合中提取若干对象的组合数",value1:"项目的数量",value2:"每一组合中项目的数量"}},COMBINA:{title:[{name:"COMBINA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"COMBINA(",editor:!1},{name:"4",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回给定数目的项的组合数（包含重复）",value1:"必须大于或等于 0 并大于或等于 Number_chosen。 非整数值将被截尾取整",value2:"必须大于或等于 0。 非整数值将被截尾取整"}},COMPLEX:{title:[{name:"COMPLEX(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[后缀]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"COMPLEX(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"4",editor:!1},{name:",",editor:!1},{name:"“j”",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数",value1:"复数的实部",value2:"复数的虚部",suffix:"复数中虚部的后缀，如果省略，则认为它为 i"}},CONFIDENCE:{title:[{name:"CONFIDENCE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"CONFIDENCE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"使用正态分布返回总体平均值的置信区间",value1:"用于计算置信度的显著水平参数",value2:"数据区域的总体标准偏差,假设为已知",value3:"样本容量"}},CONVERT:{title:[{name:"CONVERT(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"单位1",editor:!1},{name:",",editor:!1},{name:"单位2",editor:!1},{name:")",editor:!1}],example:[{name:"CONVERT(",editor:!1},{name:"1.0",editor:!1},{name:",",editor:!1},{name:"'lbm'",editor:!1},{name:",",editor:!1},{name:"'kg'",editor:!1},{name:")",editor:!1}],content:{abstract:"将数字从一个度量系统转换到另一个度量系统中",value:"以单位1为单位的需要进行转换的数值",unit1:"数值的单位",unit2:"结果的单位"}},CORREL:{title:[{name:"CORREL(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"CORREL(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回单元格区域 array1 和 array2 之间的相关系数",array1:"第一组数值单元格区域",array2:"第二组数值单元格区域"}},COS:{title:[{name:"COS(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COS(",editor:!1},{name:"1.047",editor:!1},{name:")",editor:!1}],content:{abstract:"返回给定角度的余弦值",value:"想要求余弦的角度，以弧度表示"}},COTH:{title:[{name:"COTH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COTH(",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一个双曲角度的双曲余切值",value:"想要求双曲余弦值的角度值"}},COUNT:{title:[{name:"COUNT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"COUNT(",editor:!1},{name:"A2:A8",editor:!1},{name:")",editor:!1}],content:{abstract:"计算包含数字的单元格以及参数列表中数字的个数",value1:"要计算其中数字的个数的第一个项、单元格引用或区域",value2:"要计算其中数字的个数的其他项、单元格引用或区域，最多可包含 255 个"}},COUNTBLANK:{title:[{name:"COUNTBLANK(",editor:!1},{name:"区域",editor:!1},{name:")",editor:!1}],example:[{name:"COUNTBLANK(",editor:!1},{name:"A2:B5",editor:!1},{name:")",editor:!1}],content:{abstract:"计算指定单元格区域中空白单元格的个数",area:"需要计算其中空白单元格个数的区域"}},COUNTIF:{title:[{name:"COUNTIF(",editor:!1},{name:"区域",editor:!1},{name:",",editor:!1},{name:"标准条件",editor:!1},{name:")",editor:!1}],example:[{name:"COUNTIF(",editor:!1},{name:"A2:A7",editor:!1},{name:",",editor:!1},{name:"'?果'",editor:!1},{name:")",editor:!1}],content:{abstract:"对区域中满足单个指定条件的单元格进行计数",area:"要对其进行计数的一个或多个单元格，其中包括数字或名称、数组或包含数字的引用。空值和文本值将被忽略",standardcondition:"用于定义将对哪些单元格进行计数的数字、表达式、单元格引用或文本字符串"}},COUNTIFS:{title:[{name:"COUNTIFS(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"标准条件1",editor:!1},{name:",",editor:!1},{name:"[区域2,标准条件2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"COUNTIFS(",editor:!1},{name:"B2:D2",editor:!1},{name:",",editor:!1},{name:"'=是'",editor:!1},{name:")",editor:!1}],content:{abstract:"将条件应用于跨多个区域的单元格，并计算符合所有条件的次数",area1:"在其中计算关联条件的第一个区域",standardcondition1:"条件的形式为数字、表达式、单元格引用或文本，可用来定义将对哪些单元格进行计数",standardcondition2:"附加的区域及其关联条件。最多允许 127 个区域/条件对"}},COUPDAYBS:{title:[{name:"COUPDAYBS(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPDAYBS(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回从付息期开始到结算日的天数",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COUPDAYS:{title:[{name:"COUPDAYS(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPDAYS(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回结算日所在的付息期的天数",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COUPDAYSNC:{title:[{name:"COUPDAYSNC(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPDAYSNC(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回从结算日到下一付息日之间的天数",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COUPNCD:{title:[{name:"COUPNCD",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPNCD",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一个表示在结算日之后下一个付息日的数字",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COUPNUM:{title:[{name:"COUPNUM(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPNUM(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COUPPCD:{title:[{name:"COUPPCD(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"COUPPCD(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回表示结算日之前的上一个付息日的数字",date1:"证券的结算日",date2:"证券的到期日",value:"年付息次数。如果按年支付，数值 = 1；按半年期支付，数值 = 2；按季支付，数值 = 4"}},COVAR:{title:[{name:"COVAR(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"COVAR(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回协方差，即两个数据集中每对数据点的偏差乘积的平均数",array1:"第一个所含数据为整数的单元格区域",array2:"第二个所含数据为整数的单元格区域"}},"COVARIANCE.P":{title:[{name:"COVARIANCE.P(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"COVARIANCE.P(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回总体协方差，即两个数据集中每对数据点的偏差乘积的平均数",array1:"第一个所含数据为整数的单元格区域",array2:"第二个所含数据为整数的单元格区域"}},"COVARIANCE.S":{title:[{name:"COVARIANCE.S(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"COVARIANCE.S(",editor:!1},{name:"A3:A5",editor:!1},{name:",",editor:!1},{name:"B3:B5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回样本协方差，即两个数据集中每对数据点的偏差乘积的平均值",array1:"整数的第一个单元格区域",array2:"整数的第二个单元格区域"}},CSC:{title:[{name:"CSC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"CSC(",editor:!1},{name:"15",editor:!1},{name:")",editor:!1}],content:{abstract:"返回角度的余割值，以弧度表示",value:"要求余割值的角度值"}},CSCH:{title:[{name:"CSCH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"CSCH(",editor:!1},{name:"1.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回角度的双曲余割值，以弧度表示",value:"要求双曲余割值的角度值"}},CUMIPMT:{title:[{name:"CUMIPMT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"value5",editor:!1},{name:",",editor:!1},{name:"value6",editor:!1},{name:")",editor:!1}],example:[{name:"CUMIPMT(",editor:!1},{name:"A2/12",editor:!1},{name:",",editor:!1},{name:"A3*12",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"13",editor:!1},{name:",",editor:!1},{name:"24",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一笔贷款在给定的 value4 到 value5 期间累计偿还的利息数额",value1:"利率",value2:"总付款期数",value3:"现值",value4:"计算中的首期。 付款期数从 1 开始计数",value5:"计算中的末期",value6:"付款时间类型"}},CUMPRINC:{title:[{name:"CUMPRINC(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"value5",editor:!1},{name:",",editor:!1},{name:"value6",editor:!1},{name:")",editor:!1}],example:[{name:"CUMPRINC(",editor:!1},{name:"A2/12",editor:!1},{name:",",editor:!1},{name:"A3*12",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"13",editor:!1},{name:",",editor:!1},{name:"24",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一笔贷款在给定的 start_period 到 end_period 期间累计偿还的本金数额",value1:"利率",value2:"总付款期数",value3:"现值",value4:"计算中的首期。 付款期数从 1 开始计数",value5:"计算中的末期",value6:"付款时间类型"}},DATE:{title:[{name:"DATE(",editor:!1},{name:"年",editor:!1},{name:",",editor:!1},{name:"月",editor:!1},{name:",",editor:!1},{name:"日",editor:!1},{name:")",editor:!1}],example:[{name:"DATE(",editor:!1},{name:"2008",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回表示特定日期的连续序列号",year:"年",month:"月",day:"日"}},DATEVALUE:{title:[{name:"DATEVALUE(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"DATEVALUE(",editor:!1},{name:"'8/22/2008'",editor:!1},{name:")",editor:!1}],content:{abstract:"可将存储为文本的日期转换为 Excel 识别为日期的序列号",text:"表示 Excel 日期格式的日期的文本，或者是对表示 Excel 日期格式的日期的文本所在单元格的单元格引用"}},DAVERAGE:{title:[{name:"DAVERAGE(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DAVERAGE(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"A4:E10",editor:!1},{name:")",editor:!1}],content:{abstract:"对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"是包含所指定条件的单元格区域"}},DAY:{title:[{name:"DAY(",editor:!1},{name:"日期",editor:!1},{name:")",editor:!1}],example:[{name:"DAY(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以序列号表示的某日期的天数，用整数 1 到 31 表示",date:"要查找的那一天的日期"}},DAYS:{title:[{name:"DAYS(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:")",editor:!1}],example:[{name:"DAYS(",editor:!1},{name:"'2011-3-15'",editor:!1},{name:",",editor:!1},{name:"'2011-2-1'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个日期之间的天数",date1:"用于计算期间天数的起始日期",date2:"用于计算期间天数的终止日期"}},DAYS360:{title:[{name:"DAYS360(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:")",editor:!1}],example:[{name:"DAYS360(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"按照一年 360 天的算法（每个月以 30 天计，一年共计 12 个月），返回两日期间相差的天数，这在一些会计计算中将会用到",date1:"要计算期间天数的起始日期",date2:"要计算期间天数的终止日期"}},DB:{title:[{name:"DB(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"[value5]",editor:!0,index:10},{name:")",editor:!1}],example:[{name:"DB(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"7",editor:!0,index:10},{name:")",editor:!1}],content:{abstract:"使用固定余额递减法，计算一笔资产在给定期间内的折旧值",value1:"资产原值",value2:"资产在折旧期末的价值",value3:"资产的折旧期数",value4:"需要计算折旧值的期间",value5:"第一年的月份数，如省略，则假设为 12"}},DBCS:{title:[{name:"DBCS(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"DBCS(",editor:!1},{name:"EXCEL",editor:!1},{name:")",editor:!1}],content:{abstract:"将字符串中的半角（单字节）字母转换为全角（双字节）字符",text:"文本或包含要转换的文本的单元格的引用"}},DCOUNT:{title:[{name:"DCOUNT(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DCOUNT(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'Age'",editor:!1},{name:",",editor:!1},{name:"A1:F2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DCOUNTA:{title:[{name:"DCOUNTA(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DCOUNTA(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'Profit'",editor:!1},{name:",",editor:!1},{name:"A1:F2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DDB:{title:[{name:"DDB(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"DDB(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"1.5",editor:!0,index:9},{name:")",editor:!1}],content:{abstract:"使用双倍余额递减法或其他指定方法，计算一笔资产在给定期间内的折旧值",value1:"资产原值",value2:"资产在折旧期末的价值（有时也称为资产残值）。此值可以是 0",value3:"资产的折旧期数",value4:"需要计算折旧值的期间",value5:"余额递减速率"}},DEC2BIN:{title:[{name:"DEC2BIN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DEC2BIN(",editor:!1},{name:"9",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将十进制数转换为二进制数",value1:"待转换的十进制整数",value2:"要使用的字符数"}},DEC2HEX:{title:[{name:"DEC2HEX(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DEC2HEX(",editor:!1},{name:"100",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将十进制数转换为十六进制数",value1:"待转换的十进制整数",value2:"要使用的字符数"}},DEC2OCT:{title:[{name:"DEC2OCT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DEC2OCT(",editor:!1},{name:"58",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将十进制数转换为八进制数",value1:"待转换的十进制整数",value2:"要使用的字符数"}},DECIMAL:{title:[{name:"DECIMAL(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"数制",editor:!1},{name:")",editor:!1}],example:[{name:"DECIMAL(",editor:!1},{name:"'FF'",editor:!1},{name:",",editor:!1},{name:"16",editor:!1},{name:")",editor:!1}],content:{abstract:"按给定基数将数字的文本表示形式转换成十进制数",text:"所要转换的文本",numtype:"转换所用的数制,必须是整数"}},DEGREES:{title:[{name:"DEGREES(",editor:!1},{name:"弧度角",editor:!1},{name:")",editor:!1}],example:[{name:"DEGREES(",editor:!1},{name:"PI()",editor:!1},{name:")",editor:!1}],content:{abstract:"将弧度转换为度",arctangle:"待转换的弧度角"}},DELTA:{title:[{name:"DELTA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DELTA(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"测试两个数值是否相等",value1:"第一个数字",value2:"第二个数字。如果省略，假设 Number2 的值为零"}},DEVSQ:{title:[{name:"DEVSQ(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DEVSQ(",editor:!1},{name:"A2:A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数据点与各自样本平均值偏差的平方和",value1:"必需",value2:"参数的个数可以为 1 到 255 个"}},DGET:{title:[{name:"DGET(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DGET(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'Yield'",editor:!1},{name:",",editor:!1},{name:"A1:A3",editor:!1},{name:")",editor:!1}],content:{abstract:"从列表或数据库的列中提取符合指定条件的单个值",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DISC:{title:[{name:"DISC(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"DISC(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回有价证券的贴现率",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的价格（按面值为 ￥100 计算）",value2:"有价证券的兑换值（按面值为 ￥100 计算）"}},DMAX:{title:[{name:"DMAX(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DMAX(",editor:!1},{name:"A5:E11",editor:!1},{name:",",editor:!1},{name:"'利润'",editor:!1},{name:",",editor:!1},{name:"A1:F3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中的最大数字",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DMIN:{title:[{name:"DMIN(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DMIN(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'Profit'",editor:!1},{name:",",editor:!1},{name:"A1:B2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中的最小数字",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DOLLAR:{title:[{name:"DOLLAR(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"DOLLAR(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"将数字转换为货币格式使用小数位数舍入到您指定的位数的文本",value1:"数字、对包含数字的单元格的引用或是计算结果为数字的公式",value2:"数值小数点右边的位数"}},DOLLARDE:{title:[{name:"DOLLARDE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"DOLLARDE(",editor:!1},{name:"1.02",editor:!1},{name:",",editor:!1},{name:"16",editor:!1},{name:")",editor:!1}],content:{abstract:"将以整数部分和分数部分表示的价格（例如 1.02）转换为以小数部分表示的价格",value1:"以整数部份和分数部分表示的数字，用小数点隔开",value2:"用作分数中的分母的整数"}},DPRODUCT:{title:[{name:"DPRODUCT(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DPRODUCT(",editor:!1},{name:"A5:E11",editor:!1},{name:",",editor:!1},{name:"'产量'",editor:!1},{name:",",editor:!1},{name:"A1:F3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DSTDEV:{title:[{name:"DSTDEV(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DSTDEV(",editor:!1},{name:"A5:E11",editor:!1},{name:",",editor:!1},{name:"'产量'",editor:!1},{name:",",editor:!1},{name:"A1:A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DSTDEVP:{title:[{name:"DSTDEVP(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DSTDEVP(",editor:!1},{name:"A5:E11",editor:!1},{name:",",editor:!1},{name:"'产量'",editor:!1},{name:",",editor:!1},{name:"A1:A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DSUM:{title:[{name:"DSUM(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DSUM(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'利润'",editor:!1},{name:",",editor:!1},{name:"A1:F3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中满足指定条件的记录字段（列）中的数字之和",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DURATION:{title:[{name:"DURATION(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"DURATION(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回假设面值为 ￥ 100 的 Macauley 工期",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的年息票利率",returnrate:"有价证券的年收益率",frequency:"年付息次数"}},DVAR:{title:[{name:"DVAR(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DVAR(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'产量",editor:!1},{name:",",editor:!1},{name:"A1:A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},DVARP:{title:[{name:"DVARP(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"函数适用列",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"DVARP(",editor:!1},{name:"A4:E10",editor:!1},{name:",",editor:!1},{name:"'产量",editor:!1},{name:",",editor:!1},{name:"A1:A3",editor:!1},{name:")",editor:!1}],content:{abstract:"通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差",area1:"构成列表或数据库的单元格区域",funccolumn:"指定函数所使用的列",area2:"包含所指定条件的单元格区域"}},EDATE:{title:[{name:"EDATE(",editor:!1},{name:"日期",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"EDATE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回表示某个日期的序列号，该日期与指定日期 (start_date) 相隔（之前或之后）指示的月份数",date:"一个代表开始日期的日期",value:"日期之前或之后的月份数"}},EFFECT:{title:[{name:"EFFECT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"EFFECT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"利用给定的名义年利率和每年的复利期数，计算有效的年利率",value1:"名义利率",value2:"每年的复利期数"}},EOMONTH:{title:[{name:"EOMONTH(",editor:!1},{name:"日期",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"EOMONTH(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回某个月份最后一天的序列号，该月份与 日期 相隔（之后或之后）指示的月份数",date:"表示开始日期的日期",value:"日期 之前或之后的月份数"}},ERF:{title:[{name:"ERF(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"ERF(",editor:!1},{name:"0.745",editor:!1},{name:")",editor:!1}],content:{abstract:"返回误差函数在上下限之间的积分",value1:"函数的积分下限",value2:"函数的积分上限。 如果省略，ERF 积分将在零到 lower_limit 之间"}},ERFCPRECISE:{title:[{name:"ERFCPRECISE(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ERFCPRECISE(",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回从 数值 到无穷大积分的互补 ERF 函数",value:"函数的积分下限"}},"ERROR.TYPE":{title:[{name:"ERROR.TYPE(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ERROR.TYPE(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回对应于 Microsoft Excel 中的错误值之一的数字或返回“#N/A”错误（如果不存在错误）",value:"要查找其标识号的错误值"}},EVEN:{title:[{name:"EVEN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"EVEN(",editor:!1},{name:"1.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字向上舍入到的最接近的偶数",value:"要舍入的值"}},EXACT:{title:[{name:"EXACT(",editor:!1},{name:"文本1",editor:!1},{name:",",editor:!1},{name:"文本2",editor:!1},{name:")",editor:!1}],example:[{name:"EXACT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"B2",editor:!1},{name:")",editor:!1}],content:{abstract:"比较两个文本字符串，如果它们完全相同，则返回 TRUE，否则返回 FALSE",text1:"第一个文本字符串",text2:"第二个文本字符串"}},"EXPON.DIST":{title:[{name:"EXPON.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"EXPON.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回指数分布",value1:"函数值",value2:"参数值",value3:"逻辑值，用于指定指数函数的形式"}},"F.DIST":{title:[{name:"F.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"F.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 F 概率分布函数的函数值",value1:"用来计算函数的值",value2:"分子自由度",value3:"分母自由度",value4:"决定函数形式的逻辑值"}},"F.INV":{title:[{name:"F.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"F.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 F 概率分布函数的反函数值",value1:"F 累积分布的概率值",value2:"分子自由度",value3:"分母自由度"}},"F.TEST":{title:[{name:"F.TEST(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"F.TEST(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"判断两个样本的方差是否不同",array1:"第一个数组或数据区域",array2:"第二个数组或数据区域"}},FACT:{title:[{name:"FACT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"FACT(",editor:!1},{name:"5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回某数的阶乘",value:"要计算其阶乘的非负数"}},FACTDOUBLE:{title:[{name:"FACTDOUBLE(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"FACTDOUBLE(",editor:!1},{name:"6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的双倍阶乘",value:"要计算其双倍阶乘的数值"}},FALSE:{title:[{name:"FALSE(",editor:!1},{name:")",editor:!1}],example:[{name:"FALSE(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回逻辑值 FALSE"}},"F.DIST.RT":{title:[{name:"F.DIST.RT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"F.DIST.RT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数据集的（右尾）F 概率分布（变化程度）",value1:"用来计算函数的值",value2:"分子自由度",value3:"分母自由度"}},FIND:{title:[{name:"FIND(",editor:!1},{name:"文本1",editor:!1},{name:",",editor:!1},{name:"文本2",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"FIND(",editor:!1},{name:"'M'",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"用于在文本2中定位文本1，并返回文本1的起始位置的值，该值从文本2的第一个字符算起",text1:"要查找的文本",text2:"包含要查找文本的文本"}},"F.INV.RT":{title:[{name:"F.INV.RT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"F.INV.RT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回（右尾）F 概率分布函数的反函数值",value1:"F 累积分布的概率值",value2:"分子自由度",value3:"分母自由度"}},FISHER:{title:[{name:"FISHER(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"FISHER(",editor:!1},{name:"0.75",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 x 的 Fisher 变换值",value:"要对其进行变换的数值"}},FISHERINV:{title:[{name:"FISHERINV(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"FISHERINV(",editor:!1},{name:"0.972955",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 Fisher 逆变换值",value:"要对其进行逆变换的数值"}},FIXED:{title:[{name:"FIXED(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[value3]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"FIXED(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"-1",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"将数字舍入到指定的小数位数，使用句点和逗号，以十进制数格式对该数进行格式设置，并以文本形式返回结果",value1:"要进行舍入并转换为文本的数字",value2:"小数点右边的位数",value3:"一个逻辑值，如果为 TRUE，则会禁止 FIXED 在返回的文本中包含逗号"}},FLOOR:{title:[{name:"FLOOR(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"FLOOR(",editor:!1},{name:"3.7",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"将参数 value1 向下舍入（沿绝对值减小的方向）为最接近的 value2 的倍数",value1:"要舍入的数值",value2:"要舍入到的倍数"}},"FLOOR.MATH":{title:[{name:"FLOOR.MATH(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value3]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"FLOOR.MATH(",editor:!1},{name:"-5.5",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"-1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"将数字向下舍入为最接近的整数或最接近的指定基数的倍数",value1:"要向下舍入的数字",value2:"要舍入到的倍数",value3:"舍入负数的方向（接近或远离 0）"}},"FLOOR.PRECISE":{title:[{name:"FLOOR.PRECISE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"FLOOR.PRECISE(",editor:!1},{name:"-3.2",editor:!1},{name:",",editor:!1},{name:"-1",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回一个数字，该数字向下舍入为最接近的整数或最接近的 value2 的倍数",value1:"要进行舍入的值",value2:"要将数字舍入的倍数。如果省略,则其默认值为 1"}},FORECAST:{title:[{name:"FORECAST(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"FORECAST(",editor:!1},{name:"30",editor:!1},{name:",",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"根据现有值计算或预测未来值",value:"需要进行值预测的数据点",area1:"相关数组或数据区域",area2:"独立数组或数据区域"}},FREQUENCY:{title:[{name:"FREQUENCY(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"FREQUENCY(",editor:!1},{name:"A2:A10",editor:!1},{name:",",editor:!1},{name:"B2:B4",editor:!1},{name:")",editor:!1}],content:{abstract:"函数计算值在某个范围内出现的频率, 然后返回一个垂直的数字数组",array1:" 要对其频率进行计数的一组数值或对这组数值的引用",array2:" 要将 array1 中的值插入到的间隔数组或对间隔的引用"}},FV:{title:[{name:"FV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"[value4]",editor:!0,index:7},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"FV(",editor:!1},{name:"A2/12",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!0,index:7},{name:",",editor:!1},{name:"A6",editor:!0,index:9},{name:")",editor:!1}],content:{abstract:"用于根据固定利率计算投资的未来值",value1:"各期利率",value2:"年金的付款总期数",value3:"各期所应支付的金额，在整个年金期间保持不变",value4:" 现值，或一系列未来付款的当前值的累积和。 如果省略 value4，则假定其值为 0",value5:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末。如果省略 value5，则假定其值为 0"}},FVSCHEDULE:{title:[{name:"FVSCHEDULE(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"FVSCHEDULE(",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"{0.09,0.11,0.1}",editor:!1},{name:")",editor:!1}],content:{abstract:"返回应用一系列复利率计算的初始本金的未来值",value:"现值",array:"要应用的利率数组"}},GAMMA:{title:[{name:"GAMMA(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"GAMMA(",editor:!1},{name:"2.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 gamma 函数值",value:"返回一个数字"}},"GAMMA.DIST":{title:[{name:"GAMMA.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"GAMMA.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"FALSE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回伽玛分布函数的函数值",value1:"用来计算分布的数值",value2:"分布参数",value3:"分布参数",value4:"决定函数形式的逻辑值"}},"GAMMA.INV":{title:[{name:"GAMMA.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"GAMMA.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回伽玛累积分布函数的反函数值",value1:"伽玛分布相关的概率",value2:"分布参数",value3:"分布参数"}},GAMMALN:{title:[{name:"GAMMALN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"GAMMALN(",editor:!1},{name:"4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回伽玛函数的自然对数",value:"要计算其 GAMMALN 的数值"}},"GAMMALN.PRECISE":{title:[{name:"GAMMALN.PRECISE(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"GAMMALN.PRECISE(",editor:!1},{name:"4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回伽玛函数的自然对数",value:"要计算其 GAMMALN.PRECISE 的数值"}},GAUSS:{title:[{name:"GAUSS(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"GAUSS(",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"计算标准正态总体的成员处于平均值与平均值的 z 倍标准偏差之间的概率",value:"返回一个数字"}},GCD:{title:[{name:"GCD(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"GCD(",editor:!1},{name:"24",editor:!1},{name:",",editor:!1},{name:"36",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回两个或多个整数的最大公约数",value1:"任意实数",value2:"任意实数,个数介于 1 和 255 之间"}},GEOMEAN:{title:[{name:"GEOMEAN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"GEOMEAN(",editor:!1},{name:"A2:A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组正数数据或正数数据区域的几何平均值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},GESTEP:{title:[{name:"GESTEP(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"GESTEP(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"5",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"可以使用此函数来筛选一组值",value1:"要针对步骤进行测试的值",value2:"如果省略，则 GESTEP 使用零"}},GROWTH:{title:[{name:"GROWTH(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"[集合2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value1]",editor:!0,index:5},{name:",",editor:!1},{name:"[value2]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"GROWTH(",editor:!1},{name:"B2:B7",editor:!1},{name:",",editor:!1},{name:"A2:A7",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"使用现有数据计算预测的指数等比",set1:"关系表达式 y = b*m^x 中已知的 y 值集合",set2:"关系表达式 y=b*m^x 中已知的 x 值集合",value1:" 需要 GROWTH 返回对应 y 值的新 x 值",value2:" 一个逻辑值，用于指定是否将常量 b 强制设为 1"}},HARMEAN:{title:[{name:"HARMEAN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"HARMEAN(",editor:!1},{name:"A2:A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据的调和平均值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},HEX2BIN:{title:[{name:"HEX2BIN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"HEX2BIN(",editor:!1},{name:"'F'",editor:!1},{name:",",editor:!1},{name:"8",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将十六进制数转换为二进制数",value1:"要转换的十六进制数",value2:"要使用的字符数"}},HEX2DEC:{title:[{name:"HEX2DEC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"HEX2DEC(",editor:!1},{name:"'FFFFFFFF5B'",editor:!1},{name:")",editor:!1}],content:{abstract:"将十六进制数转换为十进制数",value:"要转换的十六进制数"}},HEX2OCT:{title:[{name:"HEX2OCT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"HEX2OCT(",editor:!1},{name:"'F'",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将十六进制数转换为八进制数",value1:"要转换的十六进制数",value2:"要使用的字符数"}},HLOOKUP:{title:[{name:"HLOOKUP(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[value3]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"HLOOKUP(",editor:!1},{name:"'B'",editor:!1},{name:",",editor:!1},{name:"A1:C1",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!0,index:7},{name:")",editor:!1}],content:{abstract:"在表格的首行或数值数组中搜索值，然后返回表格或数组中指定行的所在列中的值",value1:"要在表格的第一行中查找的值",array1:"在其中查找数据的信息表",value2:"array1 中将返回匹配值的行号",value3:"一个逻辑值，指定希望 HLOOKUP 查找精确匹配值还是近似匹配值"}},HOUR:{title:[{name:"HOUR(",editor:!1},{name:"时间",editor:!1},{name:")",editor:!1}],example:[{name:"HOUR(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回时间值的小时数",time:"时间值，其中包含要查找的小时数"}},"HYPGEOM.DIST":{title:[{name:"HYPGEOM.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:".",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"value5",editor:!1},{name:")",editor:!1}],example:[{name:"HYPGEOM.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:".",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回超几何分布",value1:"样本中成功的次数",value2:"样本量",value3:"总体中成功的次数",value4:"总体大小",value5:"决定函数形式的逻辑值"}},IF:{title:[{name:"IF(",editor:!1},{name:"条件",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"IF(",editor:!1},{name:"A2>B2",editor:!1},{name:",",editor:!1},{name:"'超出预算'",editor:!1},{name:",",editor:!1},{name:"'正常'",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"如果条件为真，该函数将返回一个值；如果条件为假，函数将返回另一个值",conditon:"要测试的条件",value1:"条件的结果为 TRUE 时，您希望返回的值",value2:"条件的结果为 FALSE 时，您希望返回的值"}},IFERROR:{title:[{name:"IFERROR(",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"值2",editor:!1},{name:")",editor:!1}],example:[{name:"IFERROR(",editor:!1},{name:"A2/B2",editor:!1},{name:",",editor:!1},{name:"'计算中有错误'",editor:!1},{name:")",editor:!1}],content:{abstract:"可以使用 IFERROR 函数捕获和处理公式中的错误",value1:"检查是否存在错误的参数",value2:"公式计算错误时返回的值"}},IFNA:{title:[{name:"IFNA(",editor:!1},{name:"参数",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IFNA(",editor:!1},{name:'VLOOKUP("Seattle",$A$5:$B$10,0)',editor:!1},{name:",",editor:!1},{name:"'Not found'",editor:!1},{name:")",editor:!1}],content:{abstract:"如果公式返回错误值 #N/A，则结果返回您指定的值；否则返回公式的结果",param:"用于检查错误值 #N/A 的参数",value:"公式计算结果为错误值 #N/A 时要返回的值"}},IFS:{title:[{name:"IFS(",editor:!1},{name:"条件1",editor:!1},{name:",",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"[条件2,值2,...]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"IFS(",editor:!1},{name:"A2>89",editor:!1},{name:",",editor:!1},{name:"'A'",editor:!1},{name:")",editor:!1}],content:{abstract:"函数检查是否满足一个或多个条件，且返回符合第一个 TRUE 条件的值",condition1:"计算结果为 TRUE 或 FALSE 的条件",value:"当 条件1 的计算结果为 TRUE 时要返回结果。 可以为空。",condition2:"其他参数对"}},IMABS:{title:[{name:"IMABS(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMABS(",editor:!1},{name:"'5+12i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值",value:"需要计算其绝对值的复数"}},IMAGINARY:{title:[{name:"IMAGINARY(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMAGINARY(",editor:!1},{name:"'3+4i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数",value:"需要计算其虚系数的复数"}},IMARGUMENT:{title:[{name:"IMARGUMENT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMARGUMENT(",editor:!1},{name:"'3+4i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回参数  θ (theta)，即以弧度表示的角",value:"需要计算其参数  θ 的复数"}},IMCONJUGATE:{title:[{name:"IMCONJUGATE(",editor:!1},{name:"value",editor:!1},{name:"",editor:!1}],example:[{name:"IMCONJUGATE(",editor:!1},{name:"'3+4i'",editor:!1},{name:"",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数",value:"需要计算其共轭数的复数"}},IMCOS:{title:[{name:"IMCOS(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMCOS(",editor:!1},{name:"'1+i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的余弦",value:"需要计算其余弦的复数"}},IMCOSH:{title:[{name:"IMCOSH",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMCOSH",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的双曲余弦值",value:"需要计算其双曲余弦值的复数"}},IMCOT:{title:[{name:"IMCOT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMCOT(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的余切值",value:"要对其余切值的复数"}},IMCSC:{title:[{name:"IMCSC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMCSC(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的余割值",value:"要对其余割值的复数"}},IMCSCH:{title:[{name:"IMCSCH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMCSCH(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的双曲余割值",value:"需要计算其双曲余割值的复数"}},IMDIV:{title:[{name:"IMDIV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"IMDIV(",editor:!1},{name:"'-238+240i'",editor:!1},{name:",",editor:!1},{name:"'10+24i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商",value1:"复数分子或被除数",value2:"复数分母或除数"}},IMEXP:{title:[{name:"IMEXP(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMEXP(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的指数",value:"需要计算其指数的复数"}},IMLN:{title:[{name:"IMLN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMLN(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的自然对数",value:"需要计算其自然对数的复数"}},IMLOG2:{title:[{name:"IMLOG2(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMLOG2(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返返回以 x+yi 或 x+yj 文本格式表示的复数的以 2 为底数的对数",value:"需要计算以 2 为底数的对数的复数"}},IMLOG10:{title:[{name:"IMLOG10(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMLOG10(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x + yi 或 x + yj 文本格式表示的复数的常用对数（以 10 为底数）",value:"需要计算其常用对数的复数"}},IMPOWER:{title:[{name:"IMPOWER(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"IMPOWER(",editor:!1},{name:"'4+3i'",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的 n 次幂",value1:"需要计算其幂值的复数",value2:"需要对复数应用的幂次"}},IMPRODUCT:{title:[{name:"IMPRODUCT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"IMPRODUCT(",editor:!1},{name:"'1+2i'",editor:!1},{name:",",editor:!1},{name:"30",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积",value1:"任意复数",value2:"任意复数,个数介于1到255之间"}},IMREAL:{title:[{name:"IMREAL(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMREAL(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数",value:"需要计算其实系数的复数"}},IMSEC:{title:[{name:"IMSEC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMSEC(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的正割值",value:"需要计算其正割值的复数"}},IMSECH:{title:[{name:"IMSECH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMSECH(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的双曲正割值",value:"需要计算其双曲正割值的复数"}},IMSIN:{title:[{name:"IMSIN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMSIN(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的正弦值",value:"需要计算其正弦的复数"}},IMSINH:{title:[{name:"IMSINH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMSINH(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x + yi 或 x + yj 文本格式的复数的双曲正弦值",value:"要对其双曲正弦值的复数"}},IMSQRT:{title:[{name:"IMSQRT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMSQRT(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的平方根",value:"需要计算其平方根的复数"}},IMSUB:{title:[{name:"IMSUB(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"IMSUB(",editor:!1},{name:"'13+4i'",editor:!1},{name:",",editor:!1},{name:"'5+3i",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差",value1:"从（复）数中减去 value2",value2:"从 value1 中减（复）数"}},IMSUM:{title:[{name:"IMSUM(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"IMSUM(",editor:!1},{name:"'3+4i'",editor:!1},{name:",",editor:!1},{name:"'5-3i'",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的两个或多个复数的和",value1:"任意复数",value2:"任意复数,个数介于1到255之间"}},IMTAN:{title:[{name:"IMTAN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"IMTAN(",editor:!1},{name:"'4+3i'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回以 x+yi 或 x+yj 文本格式表示的复数的正切值",value:"要对其进行切线的复数"}},INDEX:{title:[{name:"INDEX(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"函数适用行",editor:!1},{name:",",editor:!1},{name:"[函数适用列]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"INDEX(",editor:!1},{name:"A2:B3",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"函数返回表格或区域中的值或值的引用",array:"单元格区域或数组常量",funcrow:"选择数组中的某行，函数从该行返回数值",funccolum:"选择数组中的某列，函数从该列返回数值"}},INFO:{title:[{name:"INFO(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"INFO(",editor:!1},{name:"'numfile'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回有关当前操作环境的信息",text:"用于指定要返回的信息类型的文本"}},INT:{title:[{name:"INT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"INT(",editor:!1},{name:"8.9",editor:!1},{name:")",editor:!1}],content:{abstract:"将数字向下舍入到最接近的整数",value:"需要进行向下舍入取整的实数"}},INTERCEPT:{title:[{name:"INTERCEPT(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"集合2",editor:!1},{name:")",editor:!1}],example:[{name:"INTERCEPT(",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"B2:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"利用已知的 x 值与 y 值计算直线与 y 轴交叉点",set1:"因变的观察值或数据的集合",set2:"自变的观察值或数据的集合"}},INTRATE:{title:[{name:"INTRATE(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"INTRATE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回完全投资型证券的利率",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的投资额",value2:"有价证券到期时的兑换值"}},IPMT:{title:[{name:"IPMT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:",",editor:!1},{name:"[value6]",editor:!0,index:11},{name:")",editor:!1}],example:[{name:"IPMT(",editor:!1},{name:"A2/12",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4*12",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额",value1:"各期利率",value2:"用于计算其利息数额的期数，必须在 1 到 value3 之间",value3:"年金的付款总期数",value4:"现值，或一系列未来付款的当前值的累积和",value5:"未来值，或在最后一次付款后希望得到的现金余额",value6:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末。 如果省略 value6，则假定其值为 0"}},ISERR:{title:[{name:"ISERR(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISERR(",editor:!1},{name:"A6",editor:!1},{name:")",editor:!1}],content:{abstract:"检验是否存在错误情形",value:"值为任意错误值（除去 #N/A）,则返回TRUE"}},ISERROR:{title:[{name:"ISERROR(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISERROR(",editor:!1},{name:"A6",editor:!1},{name:")",editor:!1}],content:{abstract:"检验是否存在错误情形",value:"值为任意错误值,则返回TRUE"}},ISEVEN:{title:[{name:"ISEVEN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ISEVEN(",editor:!1},{name:"A6",editor:!1},{name:")",editor:!1}],content:{abstract:"如果参数 数值 为偶数，返回 TRUE，否则返回 FALSE",value:"要测试的值"}},ISFORMULA:{title:[{name:"ISFORMULA(",editor:!1},{name:"引用",editor:!1},{name:")",editor:!1}],example:[{name:"ISFORMULA(",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"检查是否存在包含公式的单元格引用，然后返回 TRUE 或 FALSE",reference:"引用是对要测试单元格的引用"}},ISLOGICAL:{title:[{name:"ISLOGICAL(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISLOGICAL(",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为逻辑值",value:"如果为逻辑值返回TRUE,否则返回FALSE"}},ISNA:{title:[{name:"ISNA(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISNA(",editor:!1},{name:"#N/A",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为#N/A",value:"如果为#N/A返回TRUE,否则返回FALSE"}},ISNONTEXT:{title:[{name:"ISNONTEXT(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISNONTEXT(",editor:!1},{name:"#N/A",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为非文本的任意项",value:"如果为非文本的任意项返回TRUE,否则返回FALSE"}},ISNUMBER:{title:[{name:"ISNUMBER(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISNUMBER(",editor:!1},{name:"6",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为数字",value:"如果为数字返回TRUE,否则返回FALSE"}},"ISO.CEILING":{title:[{name:"ISO.CEILING(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"ISO.CEILING(",editor:!1},{name:"4.3",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回一个数字，该数字向上舍入为最接近的整数或最接近的有效位的倍数",value1:"要进行舍入的值",value2:"要将数字舍入的可选倍数。如果省略，则其默认值为 1"}},ISODD:{title:[{name:"ISODD(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISODD(",editor:!1},{name:"6",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为奇数",value:"如果为奇数返回TRUE,否则返回FALSE"}},ISOWEEKNUM:{title:[{name:"ISOWEEKNUM(",editor:!1},{name:"日期",editor:!1},{name:")",editor:!1}],example:[{name:"ISOWEEKNUM(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回给定日期在全年中的 ISO 周数",date:"日期是 Excel 用于日期和时间计算的日期-时间代码"}},ISPMT:{title:[{name:"ISPMT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"ISPMT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"计算付薪 (或投资) 指定期间内 (甚至本金付款) 支付的利息 (或接收)",value1:"投资的利率",value2:"要查找其利息的期间, 并且必须介于1和 value3 之间",value3:"投资的总支付期数",value4:"投资的现值"}},ISREF:{title:[{name:"ISREF(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"ISREF(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"判断是否为引用",value:"如果为引用返回TRUE,否则返回FALSE"}},KURT:{title:[{name:"KURT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"KURT(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据的峰值",value1:"任意值",value2:"任意值,个数介于1到255之间"}},LARGE:{title:[{name:"LARGE(",editor:!1},{name:"区域",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"LARGE(",editor:!1},{name:"A2:B6",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数据集中第 k 个最大值",area:"需要确定第 数值 个最大值的数组或数据区域",value:"返回值在数组或数据单元格区域中的位置（从大到小排）"}},LCM:{title:[{name:"KURT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"LCM(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"返回整数的最小公倍数",value1:"任意整数",value2:"任意整数,个数介于1到255之间"}},LEFT:{title:[{name:"LEFT(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"[value1]",editor:!0,index:3},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"LEFT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"从文本字符串的第一个字符开始返回指定个数的字符",text:"包含要提取的字符的文本字符串",value1:"指定要由 LEFT 提取的字符的数量",value2:"按字节指定要由 LEFTB 提取的字符的数量"}},LINEST:{title:[{name:"LINEST(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"[集合2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value1]",editor:!0,index:5},{name:",",editor:!1},{name:"[value2]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"LINEST(",editor:!1},{name:"A2:A5",editor:!1},{name:",",editor:!1},{name:"B2:B5",editor:!0,index:3},{name:",",editor:!1},{name:"FALSE",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组",set1:"关系表达式 y = mx + b 中已知的 y 值集合",set2:"关系表达式 y = mx + b 中已知的 x 值集合",value1:"一个逻辑值，用于指定是否将常量 b 强制设为 0",value2:"一个逻辑值，用于指定是否返回附加回归统计值"}},LOG:{title:[{name:"LOG(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"LOG(",editor:!1},{name:"8",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"根据指定底数返回数字的对数",value1:"想要计算其对数的正实数",value2:"对数的底数。 如果省略，则假定其值为 10"}},LOG10:{title:[{name:"LOG10(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"LOG10(",editor:!1},{name:"86",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字以 10 为底的对数",value:"想要计算其以 10 为底的对数的正实数"}},LOGEST:{title:[{name:"LOGEST(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"[集合2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value1]",editor:!0,index:5},{name:",",editor:!1},{name:"[value2]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"LOGEST(",editor:!1},{name:"B2:B7",editor:!1},{name:",",editor:!1},{name:"A2:A7",editor:!0,index:3},{name:",",editor:!1},{name:"TRUE",editor:!0,index:5},{name:",",editor:!1},{name:"FALSE",editor:!0,index:7},{name:")",editor:!1}],content:{abstract:"计算适合您的数据的指数曲线, 并返回描述该曲线的值数组",set1:"关系表达式 y = b*m^x 中已知的 y 值集合",set2:"关系表达式 y=b*m^x 中已知的 x 值集合",value1:"一个逻辑值，用于指定是否将常量 b 强制设为 1",value2:"一个逻辑值，用于指定是否返回附加回归统计值"}},LOGINV:{title:[{name:"LOGINV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"LOGINV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 x 的对数累积分布函数的反函数值，此处的 ln(x) 是服从 value2 和 value3 的正态分布",value1:"与对数分布相关的概率",value2:"ln(x) 的平均值",value3:"ln(x) 的标准偏差"}},"LOGNORM.DIST":{title:[{name:"LOGNORM.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"LOGNORM.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 x 的对数分布函数，此处的 ln(x) 是含有 value2 与 value3 参数的正态分布",value1:"用来计算函数的值",value2:"ln(x) 的平均值",value3:"ln(x) 的标准偏差",value4:"决定函数形式的逻辑值"}},"LOGNORM.INV":{title:[{name:"LOGNORM.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"LOGNORM.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 x 的对数累积分布函数的反函数值，此处的 ln(x) 是服从参数 value2 和 value3 的正态分布",value1:"与对数分布相关的概率",value2:"ln(x) 的平均值",value3:"ln(x) 的标准偏差"}},LOWER:{title:[{name:"LOWER(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"LOWER(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"将一个文本字符串中的所有大写字母转换为小写字母",text:"要转换为小写字母的文本"}},MATCH:{title:[{name:"MATCH(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"区域",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"MATCH(",editor:!1},{name:"39",editor:!1},{name:",",editor:!1},{name:"B2:B5",editor:!1},{name:",",editor:!1},{name:"1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"在 范围 单元格中搜索特定的项，然后返回该项在此区域中的相对位置",value1:"要在 区域 中匹配的值",area:"要搜索的单元格区域",value2:"数字 -1、0 或 1"}},MAX:{title:[{name:"MAX(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MAX(",editor:!1},{name:"A2:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组值中的最大值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},MDETERM:{title:[{name:"MDETERM(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"MDETERM(",editor:!1},{name:"A2:D5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一个数组的矩阵行列式的值",array:"行数和列数相等的数值数组"}},MDURATION:{title:[{name:"MDURATION(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"MDURATION(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的年息票利率",value2:"有价证券的年收益率",value3:"年付息次数"}},MEDIAN:{title:[{name:"MEDIAN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MEDIAN(",editor:!1},{name:"A2:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组已知数字的中值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},MID:{title:[{name:"MID(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"MID(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回文本字符串中从指定位置开始的特定数目的字符，该数目由用户指定",text:"包含要提取字符的文本字符串",value1:"文本中要提取的第一个字符的位置",value2:"指定希望 MID 从文本中返回字符的个数"}},MIN:{title:[{name:"MIN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MIN(",editor:!1},{name:"A2:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组值中的最小值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},MINA:{title:[{name:"MINA(",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"[值2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MINA(",editor:!1},{name:"A2:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回参数列表中的最小值",value1:"任意值",value2:"任意值,个数介于1到255之间"}},MINUTE:{title:[{name:"MINUTE(",editor:!1},{name:"时间",editor:!1},{name:")",editor:!1}],example:[{name:"MINUTE(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回时间值中的分钟。 分钟是一个介于 0 到 59 之间的整数",time:"一个时间值，其中包含要查找的分钟"}},MINVERSE:{title:[{name:"MINVERSE(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"MINVERSE(",editor:!1},{name:"A2:B3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数组中存储的矩阵的逆矩阵",array:"行数和列数相等的数值数组"}},MIRR:{title:[{name:"MIRR(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"MIRR(",editor:!1},{name:"A2:A7",editor:!1},{name:",",editor:!1},{name:"A8",editor:!1},{name:",",editor:!1},{name:"A9",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一系列定期现金流的已修改内部收益率",array:"数组或对包含数字的单元格的引用",value1:"现金流中使用的资金支付的利率",value2:"将现金流再投资的收益率"}},MMULT:{title:[{name:"MMULT(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"MMULT(",editor:!1},{name:"A2:B3",editor:!1},{name:",",editor:!1},{name:"A5:B6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两个数组的矩阵乘积",array1:"要进行矩阵乘法运算的第一个数组",array2:"要进行矩阵乘法运算的第二个数组"}},MOD:{title:[{name:"MOD(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"MOD(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两数相除的余数",value1:"要计算余数的被除数",value2:"除数"}},MODE:{title:[{name:"MODE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MODE(",editor:!1},{name:"A2:A7",editor:!1},{name:")",editor:!1}],content:{abstract:"回的数组或数据区域中出现频率最高或重复出现",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},"MODE.MULT":{title:[{name:"MODE.MULT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MODE.MULT(",editor:!1},{name:"A2:A13",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据或数据区域中出现频率最高或重复出现的数值的垂直数组",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},"MODE.SNGL":{title:[{name:"MODE.SNGL(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MODE.SNGL(",editor:!1},{name:"A2:A13",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据或数据区域中出现频率最高或重复出现的数值的垂直数组",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},MONTH:{title:[{name:"MONTH(",editor:!1},{name:"日期",editor:!1},{name:")",editor:!1}],example:[{name:"MONTH(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数",date:"您尝试查找的月份的日期"}},MROUND:{title:[{name:"MROUND(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"MROUND(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"-2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回舍入到所需倍数的数字",value1:"要舍入的值",value2:"要舍入到的倍数"}},MULTINOMIAL:{title:[{name:"MULTINOMIAL(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"MULTINOMIAL(",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回参数和的阶乘与各参数阶乘乘积的比值",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},MUNIT:{title:[{name:"MUNIT(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"MUNIT(",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回指定维度的单位矩阵",value:"指定要返回的单位矩阵的维度"}},N:{title:[{name:"N(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"N(",editor:!1},{name:"7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回转化为数值后的值",value:"要转换的值"}},NA:{title:[{name:"NA(",editor:!1},{name:")",editor:!1}],example:[{name:"NA(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 #N/A. 的错误值"}},"NEGBINOM.DIST":{title:[{name:"NEGBINOM.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"NEGBINOM.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回负二项式分布",value1:"失败的次数",value2:"成功次数的阈值",value3:"成功的概率",value4:"决定函数形式的逻辑值"}},NETWORKDAYS:{title:[{name:"NETWORKDAYS(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[value3]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"NETWORKDAYS(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回参数 value1 和 value2 之间完整的工作日数值",value1:" 一个代表开始日期的日期",value2:" 一个代表终止日期的日期",value3:"不在工作日历中的一个或多个日期所构成的可选区域"}},"NETWORKDAYS.INTL":{title:[{name:"NETWORKDAYS.INTL(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"NETWORKDAYS.INTL(",editor:!1},{name:"DATE(2006,1,1)",editor:!1},{name:",",editor:!1},{name:"DATE(2006,1,31)",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回两个日期之间的所有工作日数，使用参数指示哪些天是周末，以及有多少天是周末",date1:"一个代表开始日期的日期",date2:"一个代表终止日期的日期",value:"表示介于 日期1 和 日期2 之间但又不包括在所有工作日数中的周末日"}},NOMINAL:{title:[{name:"NOMINAL(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"NOMINAL(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"基于给定的实际利率和年复利期数，返回名义年利率",value1:"实际利率",value2:"每年的复利期数"}},"NORM.DIST":{title:[{name:"NORM.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"NORM.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回指定平均值和标准偏差的正态分布函数",value1:"需要计算其分布的数值",value2:"分布的算术平均值",value3:"分布的标准偏差",value4:"确定函数形式的逻辑值"}},"NORM.INV":{title:[{name:"NORM.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"NORM.INV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回指定平均值和标准偏差的正态累积分布函数的反函数值",value1:"对应于正态分布的概率",value2:"分布的算术平均值",value3:"分布的标准偏差"}},"NORM.S.DIST":{title:[{name:"NORM.S.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"NORM.S.DIST(",editor:!1},{name:"1.333333",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回标准正态分布函数",value1:"需要计算其分布的数值",value2:"决定函数形式的逻辑值"}},NOT:{title:[{name:"NOT(",editor:!1},{name:"逻辑函数",editor:!1},{name:")",editor:!1}],example:[{name:"NOT(",editor:!1},{name:"A2>100",editor:!1},{name:")",editor:!1}],content:{abstract:"函数会对其参数的值进行求反",logicfunc:"计算结果为 TRUE 或 FALSE 的任何值或表达式"}},NOW:{title:[{name:"NOW(",editor:!1},{name:")",editor:!1}],example:[{name:"NOW(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回当前日期和时间的序列号"}},NPER:{title:[{name:"NPER(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"[value4]",editor:!0,index:7},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"NPER(",editor:!1},{name:"A2/12",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!0,index:7},{name:",",editor:!1},{name:"TRUE",editor:!0,index:9},{name:")",editor:!1}],content:{abstract:"基于固定利率及等额分期付款方式，返回某项投资的总期数",value1:"各期利率",value2:"各期所应支付的金额，在整个年金期间保持不变",value3:"现值，或一系列未来付款的当前值的累积和",value4:"未来值，或在最后一次付款后希望得到的现金余额",value5:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末"}},NPV:{title:[{name:"NPV(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"[值2,...]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"NPV(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值",value:"某一期间的贴现率",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},NUMBERVALUE:{title:[{name:"NUMBERVALUE(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"[字符1]",editor:!0,index:3},{name:",",editor:!1},{name:"[字符2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"NUMBERVALUE(",editor:!1},{name:"'2.500,27'",editor:!1},{name:",",editor:!1},{name:"','",editor:!0,index:3},{name:",",editor:!1},{name:"'.'",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"以与区域设置无关的方式将文本转换为数字",text:"要转换为数字的文本",character1:"用于分隔结果的整数和小数部分的字符",character2:" 用于分隔数字分组的字符"}},OCT2DEC:{title:[{name:"OCT2DEC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"OCT2DEC(",editor:!1},{name:"54",editor:!1},{name:")",editor:!1}],content:{abstract:"将八进制数转换为十进制数",value:"要转换的八进制数"}},OCT2BIN:{title:[{name:"OCT2BIN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"OCT2BIN(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将八进制数转换为二进制数",value1:"要转换的八进制数",value2:"要使用的字符数"}},OCT2HEX:{title:[{name:"OCT2HEX(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"OCT2HEX(",editor:!1},{name:"100",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将八进制数转换为十六进制数",value1:"要转换的八进制数",value2:"要使用的字符数"}},ODD:{title:[{name:"ODD(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"ODD(",editor:!1},{name:"1.5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字向上舍入到的最接近的奇数",value:"要舍入的值"}},ODDFPRICE:{title:[{name:"ODDFPRICE(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"日期4",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"ODDFPRICE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:",",editor:!1},{name:"A8",editor:!1},{name:",",editor:!1},{name:"A9",editor:!1},{name:")",editor:!1}],content:{abstract:"返回首期付息日不固定（长期或短期）的面值 ￥100 的有价证券价格",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的发行日",date4:"有价证券的首期付息日",value1:"有价证券的利率",value2:"有价证券的年收益率",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},ODDFYIELD:{title:[{name:"ODDFYIELD(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"日期4",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"ODDFYIELD(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:",",editor:!1},{name:"A8",editor:!1},{name:",",editor:!1},{name:"A9",editor:!1},{name:")",editor:!1}],content:{abstract:"返回首期付息日不固定（长期或短期）的面值 ￥100 的有价证券价格",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的发行日",date4:"有价证券的首期付息日",value1:"有价证券的利率",value2:"有价证券的价格",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},ODDLPRICE:{title:[{name:"ODDLPRICE(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"ODDLPRICE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:",",editor:!1},{name:"A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回末期付息日不固定的面值 ￥100 的有价证券（长期或短期）的价格",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的末期付息日",value1:"有价证券的利率",value2:"有价证券的年收益率",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},ODDLYIELD:{title:[{name:"ODDLYIELD(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"ODDLYIELD(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:",",editor:!1},{name:"A8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回末期付息日不固定的面值 ￥100 的有价证券（长期或短期）的价格",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的末期付息日",value1:"有价证券的利率",value2:"有价证券的价格",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},OR:{title:[{name:"OR(",editor:!1},{name:"条件1",editor:!1},{name:",",editor:!1},{name:"[条件2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"OR(",editor:!1},{name:"A2>1",editor:!1},{name:",",editor:!1},{name:"A2<100",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"函数的任意参数计算为 TRUE，则其返回 TRUE；如果其所有参数均计算机为 FALSE，则返回 FALSE",condition1:"第一个想要测试且计算结果可为 TRUE 或 FALSE 的条件",condition2:"其他想要测试且计算结果可为 TRUE 或 FALSE 的条件（最多 255 个条件）"}},PDURATION:{title:[{name:"PDURATION(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"PDURATION(",editor:!1},{name:"2.5%",editor:!1},{name:",",editor:!1},{name:"2000",editor:!1},{name:",",editor:!1},{name:"2200",editor:!1},{name:")",editor:!1}],content:{abstract:"返回投资到达指定值所需的期数",value1:"费率是指每期的利率",value2:"投资的现值",value3:"所需投资的未来值"}},PEARSON:{title:[{name:"PEARSON(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"PEARSON(",editor:!1},{name:"A3:A7",editor:!1},{name:",",editor:!1},{name:"B3:B7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回皮尔生(Pearson)乘积矩相关系数 r，这是一个范围在 -1.0 到 1.0 之间（包括 -1.0 和 1.0 在内）的无量纲指数，反映了两个数据集合之间的线性相关程度",array:"自变量集合",array2:"因变量集合"}},PERCENTILE:{title:[{name:"PERCENTILE(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"PERCENTILE(",editor:!1},{name:"E2:E5",editor:!1},{name:",",editor:!1},{name:"0.3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回区域中数值的第 k 个百分点的值",array:"定义相对位置的数组或数据区域",value:"0 到 1 之间的百分点值，包含 0 和 1"}},"PERCENTILE.EXC":{title:[{name:"PERCENTILE.EXC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"PERCENTILE.EXC(",editor:!1},{name:"E2:E5",editor:!1},{name:",",editor:!1},{name:"0.3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回区域中数值的第 K 个百分点的值，其中 k 为 0 到 1 之间的值，不包含 0 和 1",array:"定义相对位置的数组或数据区域",value:"0 到 1 之间的百分点值，包含 0 和 1"}},"PERCENTILE.INC":{title:[{name:"PERCENTILE.INC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"PERCENTILE.INC(",editor:!1},{name:"E2:E5",editor:!1},{name:",",editor:!1},{name:"0.3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回区域中数值的第 K 个百分点的值，K 为 0 到 1 之间的百分点值，包含 0 和 1",array:"定义相对位置的数组或数据区域",value:"0 到 1 之间的百分点值，包含 0 和 1"}},PERCENTRANK:{title:[{name:"PERCENTRANK(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"PERCENTRANK(",editor:!1},{name:"A2:A11",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"将某个数值在数据集中的排位作为数据集的百分比值返回，此处的百分比值的范围为 0 到 1",array:"定义相对位置的数值数组或数值数据区域",value1:"需要得到其排位的值",value2:"用于标识返回的百分比值的有效位数的值"}},"PERCENTRANK.EXC":{title:[{name:"PERCENTRANK.EXC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"PERCENTRANK.EXC(",editor:!1},{name:"A2:A11",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回某个数值在一个数据集中的百分比（0 到 1，不包括 0 和 1）排位",array:"定义相对位置的数值数组或数值数据区域",value1:"需要得到其排位的值",value2:"用于标识返回的百分比值的有效位数的值"}},"PERCENTRANK.INC":{title:[{name:"PERCENTRANK.INC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"PERCENTRANK.INC(",editor:!1},{name:"A2:A11",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"将某个数值在数据集中的排位作为数据集的百分比值返回，此处的百分比值的范围为 0 到 1（含 0 和 1）",array:"定义相对位置的数值数组或数值数据区域",value1:"需要得到其排位的值",value2:"用于标识返回的百分比值的有效位数的值"}},PERMUT:{title:[{name:"PERMUT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"PERMUT(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回可从数字对象中选择的给定数目对象的排列数",value1:"表示对象个数的整数",value2:"表示每个排列中对象个数的整数"}},PERMUTATIONA:{title:[{name:"PERMUTATIONA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"PERMUTATIONA(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回可从对象总数中选择的给定数目对象（含重复）的排列数",value1:"表示对象总数的整数",value2:"表示每个排列中对象数目的整数"}},PHI:{title:[{name:"PHI(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"PHI(",editor:!1},{name:"0.75",editor:!1},{name:")",editor:!1}],content:{abstract:"返回标准正态分布的密度函数值",value:"所需的标准正态分布密度值"}},PI:{title:[{name:"PI(",editor:!1},{name:")",editor:!1}],example:[{name:"PI(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字 3.14159265358979（数学常量 pi），精确到 15 个数字"}},POISSON:{title:[{name:"POISSON(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"POISSON(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回泊松分布",value1:"事件数",value2:"期望值",value3:"一逻辑值，确定所返回的概率分布的形式"}},"POISSON.DIST":{title:[{name:"POISSON.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"POISSON.DIST(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回泊松分布",value1:"事件数",value2:"期望值",value3:"一逻辑值，确定所返回的概率分布的形式"}},POWER:{title:[{name:"POWER(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"POWER(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字乘幂的结果",value1:"基数。 可为任意实数",value2:"基数乘幂运算的指数"}},PPMT:{title:[{name:"PPMT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"PPMT(",editor:!1},{name:"A11",editor:!1},{name:",",editor:!1},{name:"A12",editor:!1},{name:",",editor:!1},{name:"10",editor:!1},{name:",",editor:!1},{name:"A13",editor:!1},{name:")",editor:!1}],content:{abstract:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额",value1:"各期利率",value2:"指定期数，该值必须在 1 到 value3 范围内",value3:"年金的付款总期数",value4:"现值即一系列未来付款当前值的总和",value5:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末"}},PRICE:{title:[{name:"PRICE(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"PRICE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回定期付息的面值 ￥100 的有价证券的价格",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的年息票利率",value2:"有价证券的年收益率",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},PRICEDISC:{title:[{name:"PRICEDISC(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"PRICEDISC(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回折价发行的面值 ￥100 的有价证券的价格",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的贴现率",value2:"面值 ￥100 的有价证券的清偿价值"}},PRICEMAT:{title:[{name:"PRICEMAT(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"PRICEMAT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回到期付息的面值 ￥100 的有价证券的价格",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的发行日，以时间序列号表示",value1:"有价证券在发行日的利率",value2:"有价证券的年收益率"}},PROB:{title:[{name:"PROB(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"[value1]",editor:!0,index:5},{name:",",editor:!1},{name:"[value2]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"PROB(",editor:!1},{name:"A3:A6",editor:!1},{name:",",editor:!1},{name:"B3:B6",editor:!1},{name:",",editor:!1},{name:"2",editor:!0,index:5},{name:",",editor:!1},{name:"[value3]",editor:!0,index:7},{name:")",editor:!1}],content:{abstract:"返回区域中的数值落在指定区间内的概率",area:"具有各自相应概率值的 x 数值区域",array:"与 区域 中的值相关联的一组概率值",value1:"要计算其概率的数值下界",value2:"要计算其概率的可选数值上界"}},PRODUCT:{title:[{name:"PRODUCT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"PRODUCT(",editor:!1},{name:"A2:A4",editor:!1},{name:")",editor:!1}],content:{abstract:"函数将以参数形式给出的所有数字相乘, 并返回该产品",value1:"要相乘的第一个数字或范围",value2:"要相乘的其他数字或单元格区域，最多可以使用 255 个参数"}},PROPER:{title:[{name:"PROPER(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"PROPER(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"将文本字符串的首字母以及文字中任何非字母字符之后的任何其他字母转换成大写",text:"用引号括起来的文本、返回文本值的公式，或者对包含要进行部分大写转换文本的单元格的引用"}},PV:{title:[{name:"PV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"[value4]",editor:!0,index:7},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"PV(",editor:!1},{name:"A3/12",editor:!1},{name:",",editor:!1},{name:"12*A4",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:",",editor:!1},{name:"0",editor:!0,index:9},{name:")",editor:!1}],content:{abstract:"用于根据固定利率计算贷款或投资的现值",value1:"各期利率",value2:"年金的付款总期数",value3:"每期的付款金额，在年金周期内不能更改",value4:"未来值，或在最后一次付款后希望得到的现金余额",value5:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末"}},QUARTILE:{title:[{name:"QUARTILE(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"QUARTILE(",editor:!1},{name:"A2:A9",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一组数据的四分位点",array:"要求得四分位数值的数组或数字型单元格区域",value:"指定返回哪一个值"}},"QUARTILE.EXC":{title:[{name:"QUARTILE.EXC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"QUARTILE.EXC(",editor:!1},{name:"A2:A9",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数",array:"要求得四分位数值的数组或数字型单元格区域",value:"指定返回哪一个值"}},"QUARTILE.INC":{title:[{name:"QUARTILE.INC(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"QUARTILE.INC(",editor:!1},{name:"A2:A9",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数",array:"要求得四分位数值的数组或数字型单元格区域",value:"指定返回哪一个值"}},QUOTIENT:{title:[{name:"QUOTIENT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"QUOTIENT(",editor:!1},{name:"5",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回除法的整数部分",value1:"被除数",value2:"除数"}},RADIANS:{title:[{name:"RADIANS(",editor:!1},{name:"角度",editor:!1},{name:")",editor:!1}],example:[{name:"RADIANS(",editor:!1},{name:"270",editor:!1},{name:")",editor:!1}],content:{abstract:"将度数转换为弧度",tangle:"要转换的以度数表示的角度"}},RAND:{title:[{name:"RAND(",editor:!1},{name:")",editor:!1}],example:[{name:"RAND(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回了一个大于等于 0 且小于 1 的平均分布的随机实数"}},RANDBETWEEN:{title:[{name:"RANDBETWEEN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"RANDBETWEEN(",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"100",editor:!1},{name:")",editor:!1}],content:{abstract:"返回位于两个指定数之间的一个随机整数。 每次计算工作表时都将返回一个新的随机整数",value1:"将返回的最小整数",value2:"将返回的最大整数"}},RANK:{title:[{name:"RANK(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"RANK(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回一列数字的数字排位。 数字的排位是其相对于列表中其他值的大小",value1:"要找到其排位的数字",array:"数字列表的数组，对数字列表的引用",value2:"一个指定数字排位方式的数字"}},"RANK.AVG":{title:[{name:"RANK.AVG(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"RANK.AVG(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回一列数字的数字排位：数字的排位是其大小与列表中其他值的比值；如果多个值具有相同的排位，则将返回平均排位",value1:"要找到其排位的数字",array:"数字列表的数组，对数字列表的引用",value2:"一个指定数字排位方式的数字"}},"RANK.EQ":{title:[{name:"RANK.EQ(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"RANK.EQ(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A2:A6",editor:!1},{name:",",editor:!1},{name:"1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回一列数字的数字排位。 其大小与列表中其他值相关；如果多个值具有相同的排位，则返回该组值的最高排位",value1:"要找到其排位的数字",array:"数字列表的数组，对数字列表的引用",value2:"一个指定数字排位方式的数字"}},RATE:{title:[{name:"RATE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"[value4]",editor:!0,index:7},{name:",",editor:!1},{name:"[value5]",editor:!0,index:9},{name:")",editor:!1}],example:[{name:"RATE(",editor:!1},{name:"A2*12",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回每期年金的利率",value1:"年金的付款总期数",value2:"每期的付款金额，在年金周期内不能更改",value3:"现值即一系列未来付款当前值的总和",value4:"未来值，或在最后一次付款后希望得到的现金余额",value5:"数字 0 或 1，用以指定各期的付款时间是在期初还是期末"}},RECEIVED:{title:[{name:"RECEIVED(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"RECEIVED(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一次性付息的有价证券到期收回的金额",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的投资额",value2:"有价证券的贴现率"}},REPLACE:{title:[{name:"REPLACE(",editor:!1},{name:"文本1",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"文本2",editor:!1},{name:")",editor:!1}],example:[{name:"REPLACE(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"'*'",editor:!1},{name:")",editor:!1}],content:{abstract:"根据指定的字符数，REPLACE 将部分文本字符串替换为不同的文本字符串",text1:"要替换其部分字符的文本",value1:"文本1中要替换为 文本2 的字符位置",value2:"文本1 中希望 REPLACE 使用 文本2 来进行替换的字符数",text2:"将替换 文本1 中字符的文本"}},REPT:{title:[{name:"REPT(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"REPT(",editor:!1},{name:"'*_'",editor:!1},{name:",",editor:!1},{name:"3",editor:!1},{name:")",editor:!1}],content:{abstract:"将文本重复一定次数",text:"需要重复显示的文本",value:"用于指定文本重复次数的正数"}},RIGHT:{title:[{name:"RIGHT(",editor:!1},{name:"text",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"RIGHT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"5",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"根据所指定的字符数返回文本字符串中最后一个或多个字符",text:"包含要提取字符的文本字符串",value:"指定希望 RIGHT 提取的字符数"}},ROMAN:{title:[{name:"ROMAN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"ROMAN(",editor:!1},{name:"499",editor:!1},{name:",",editor:!1},{name:"0",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"将阿拉伯数字转换为文字形式的罗马数字",value1:"需要转换的阿拉伯数字",value2:"一个数字, 指定所需的罗马数字类型"}},ROUND:{title:[{name:"ROUND(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"ROUND(",editor:!1},{name:"2.15",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"函数将数字四舍五入到指定的位数",value1:"要四舍五入的数字",value2:"要进行四舍五入运算的位数"}},ROUNDDOWN:{title:[{name:"ROUNDDOWN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"ROUND(",editor:!1},{name:"3.2",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:")",editor:!1}],content:{abstract:"朝着零的方向将数字进行向下舍入",value1:"要四舍五入的数字",value2:"要进行四舍五入运算的位数"}},ROUNDUP:{title:[{name:"ROUNDUP(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"ROUNDUP(",editor:!1},{name:"2.15",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"朝着远离 0（零）的方向将数字进行向上舍入",value1:"要四舍五入的数字",value2:"要进行四舍五入运算的位数"}},ROW:{title:[{name:"ROW(",editor:!1},{name:"区域",editor:!1},{name:")",editor:!1}],example:[{name:"ROW(",editor:!1},{name:"C10",editor:!1},{name:")",editor:!1}],content:{abstract:"返回引用的行号",area:"需要得到其行号的单元格或单元格区域"}},ROWS:{title:[{name:"ROWS(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"ROW(",editor:!1},{name:"C1:E4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回引用或数组的行数",area:"需要得到其行数的数组、数组公式或对单元格区域的引用"}},RRI:{title:[{name:"RRI(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"RRI(",editor:!1},{name:"96",editor:!1},{name:",",editor:!1},{name:"10000",editor:!1},{name:",",editor:!1},{name:"11000",editor:!1},{name:")",editor:!1}],content:{abstract:"返回投资增长的等效利率",value1:"投资的总期数",value2:"投资的现值",value3:"投资的未来值"}},RSQ:{title:[{name:"RSQ(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"RSQ(",editor:!1},{name:"A3:A9",editor:!1},{name:",",editor:!1},{name:"B3:B9",editor:!1},{name:")",editor:!1}],content:{abstract:"通过 known_y's 和 known_x's 中的数据点返回皮尔生乘积矩相关系数的平方",area1:"数组或数据点区域",area2:"数组或数据点区域"}},SEARCH:{title:[{name:"SEARCH(",editor:!1},{name:"文本1",editor:!1},{name:",",editor:!1},{name:"文本2",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"SEARCH(",editor:!1},{name:"'e'",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"6",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"可在第二个文本字符串中查找第一个文本字符串，并返回第一个文本字符串的起始位置的编号，该编号从第二个文本字符串的第一个字符算起",text1:"要查找的文本",text2:"要在其中搜索 文本1 参数的值的文本",value:"文本2 参数中从之开始搜索的字符编号"}},SEC:{title:[{name:"SEC(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SEC(",editor:!1},{name:"45",editor:!1},{name:")",editor:!1}],content:{abstract:"返回角度的正割值",value:"需要对其进行正割的角度 "}},SECH:{title:[{name:"SECH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SECH(",editor:!1},{name:"45",editor:!1},{name:")",editor:!1}],content:{abstract:"返回角度的双曲正割值",value:"对应所需双曲正割值的角度，以弧度表示"}},SECOND:{title:[{name:"SECOND(",editor:!1},{name:"时间",editor:!1},{name:")",editor:!1}],example:[{name:"SECOND(",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数",time:"一个时间值，其中包含要查找的秒数"}},SERIESSUM:{title:[{name:"SERIESSUM(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"SERIESSUM(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"A4:A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回基于SERIES公式的幂级数之和",value1:"幂级数的输入值",value2:"value1 的首项乘幂",value3:"级数中每一项的乘幂 n 的步长增加值",array:"与 value1 的每个连续乘幂相乘的一组系数"}},SHEET:{title:[{name:"SHEET(",editor:!1},{name:"[值]",editor:!0,index:1},{name:")",editor:!1}],example:[{name:"SHEET(",editor:!1},{name:"Table1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回引用工作表的工作表编号",value:"需要工作表编号的工作表或引用的名称"}},SHEETS:{title:[{name:"SHEETS(",editor:!1},{name:"[引用]",editor:!0,index:1},{name:")",editor:!1}],example:[{name:"SHEETS(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回引用中的工作表数",reference:"引用是要了解其包含的工作表数的引用"}},SIGN:{title:[{name:"SIGN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SIGN(",editor:!1},{name:"10",editor:!1},{name:")",editor:!1}],content:{abstract:"确定数字的符号",value:"任意实数"}},SIN:{title:[{name:"SIN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SIN(",editor:!1},{name:"PI()",editor:!1},{name:")",editor:!1}],content:{abstract:"返回已知角度的正弦",value:"需要求正弦的角度，以弧度表示"}},SINH:{title:[{name:"SINH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SINH(",editor:!1},{name:"0.0342*1.03",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的双曲正弦",value:"任意实数"}},SKEW:{title:[{name:"SKEW(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"SKEW(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"返回分布的偏斜度",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},"SKEW.P":{title:[{name:"SKEW.P(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"SKEW(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},SLN:{title:[{name:"SLN(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"SLN(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回一个期间内的资产的直线折旧",value1:"资产原值",value2:"折旧末尾时的值",value3:"资产的折旧期数"}},SLOPE:{title:[{name:"SLOPE(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"集合2",editor:!1},{name:")",editor:!1}],example:[{name:"SLOPE(",editor:!1},{name:"A3:A9",editor:!1},{name:",",editor:!1},{name:"B3:B9",editor:!1},{name:")",editor:!1}],content:{abstract:"返回通过 集合1 和 集合2 中数据点的线性回归线的斜率",set1:"数字型因变量数据点数组或单元格区域",set2:"自变量数据点集合"}},SMALL:{title:[{name:"SMALL(",editor:!1},{name:"区域",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SMALL(",editor:!1},{name:"A2:A10",editor:!1},{name:",",editor:!1},{name:"4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数据集中的第 k 个最小值",area:"需要找到第 k 个最小值的数组或数值数据区域",value:"要返回的数据在数组或数据区域里的位置"}},SQRTPI:{title:[{name:"SQRTPI(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"SQRTPI(",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回某数与 pi 的乘积的平方根",value:"与 pi 相乘的数"}},STANDARDIZE:{title:[{name:"STANDARDIZE(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"STANDARDIZE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回由 value2 和 value3 表示的分布的规范化值",value1:"需要进行正态化的数值",value2:"分布的算术平均值",value3:"分布的标准偏差"}},STDEVA:{title:[{name:"STDEVA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"STDEVA(",editor:!1},{name:"A3:A12",editor:!1},{name:")",editor:!1}],content:{abstract:"根据样本估计标准偏差",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},STDEVP:{title:[{name:"STDEVP(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"STDEVP(",editor:!1},{name:"A3:A12",editor:!1},{name:")",editor:!1}],content:{abstract:"根据作为参数给定的整个总体计算标准偏差",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},STDEVPA:{title:[{name:"STDEVPA(",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"[值2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"STDEVPA(",editor:!1},{name:"A3:A12",editor:!1},{name:")",editor:!1}],content:{abstract:"根据作为参数（包括文字和逻辑值）给定的整个总体计算标准偏差",value1:"任意值",value2:"任意值,个数介于1到255之间"}},STEYX:{title:[{name:"STEYX(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"STEYX(",editor:!1},{name:"A3:A9",editor:!1},{name:",",editor:!1},{name:"B3:B9",editor:!1},{name:")",editor:!1}],content:{abstract:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差",area1:"因变量数据点数组或区域",area2:"自变量数据点数组或区域"}},SUBSTITUTE:{title:[{name:"SUBSTITUTE(",editor:!1},{name:"文本1",editor:!1},{name:",",editor:!1},{name:"文本2",editor:!1},{name:",",editor:!1},{name:"文本3",editor:!1},{name:",",editor:!1},{name:"[事件]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"SUBSTITUTE(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"'销售额'",editor:!1},{name:",",editor:!1},{name:"'成本'",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:7},{name:")",editor:!1}],content:{abstract:"在文本字符串中用 文本3 替换 文本2",text1:"需要替换其中字符的文本，或对含有文本（需要替换其中字符）的单元格的引用",text2:"需要替换的文本",text3:"用于替换 文本2 的文本",event:"指定要用 文本3 替换 文本2 的事件"}},SUBTOTAL:{title:[{name:"SUBTOTAL(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"[区域2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"SUBTOTAL(",editor:!1},{name:"9",editor:!1},{name:",",editor:!1},{name:"A2:A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回列表或数据库中的分类汇总",value:"数字 1-11 或 101-111，用于指定要为分类汇总使用的函数",area1:"要对其进行分类汇总计算的第一个命名区域或引用",area2:"要对其进行分类汇总计算的第 2 个至第 254 个命名区域或引用"}},SUMIF:{title:[{name:"SUMIF(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"条件",editor:!1},{name:",",editor:!1},{name:"[区域2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"SUMIF(",editor:!1},{name:"A2:A5",editor:!1},{name:",",editor:!1},{name:"'>160000'",editor:!1},{name:",",editor:!1},{name:"B2:B5",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"对 范围 中符合指定条件的值求和",area1:"要按条件计算的单元格区域",condition:"定义哪些单元格将被添加的数字、表达式、单元格引用、文本或函数形式的条件",area2:"要添加的实际单元格 (如果要添加的单元格不在range参数中指定的单元格)"}},SUMIFS:{title:[{name:"SUMIFS(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"条件1",editor:!1},{name:",",editor:!1},{name:"[区域2,条件2,...]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"SUMIFS(",editor:!1},{name:"A2:A5",editor:!1},{name:",",editor:!1},{name:"'>160000'",editor:!1},{name:",",editor:!1},{name:"B2:B5",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"对 范围 中符合指定条件的值求和",area1:"要按条件计算的单元格区域",condition1:"定义哪些单元格将被添加的数字、表达式、单元格引用、文本或函数形式的条件",condition2:"其他的区域,条件对"}},SUMPRODUCT:{title:[{name:"SUMPRODUCT(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"[array2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"SUMPRODUCT(",editor:!1},{name:"A1:D1",editor:!1},{name:",",editor:!1},{name:"A2:D2",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"对给定数组中的相应组件执行简单的算术运算, 并返回这些计算的和",array1:"其相应元素需要进行相乘并求和的第一个数组参数",array2:" 2 到 255 个数组参数，其相应元素需要进行相乘并求和"}},SUMSQ:{title:[{name:"SUMSQ(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"SUMSQ(",editor:!1},{name:"3",editor:!1},{name:",",editor:!1},{name:"4",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回参数的平方和",value1:"任意实数",value2:"任意实数,个数介于1到255之间"}},SUMX2MY2:{title:[{name:"SUMX2MY2(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"SUMX2MY2(",editor:!1},{name:"A2:A8",editor:!1},{name:",",editor:!1},{name:"B2:B8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两数组中对应数值的平方差之和",area1:" 第一个数组或数值区域",area2:" 第而个数组或数值区域"}},SUMX2PY2:{title:[{name:"SUMX2PY2(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"SUMX2PY2(",editor:!1},{name:"A2:A8",editor:!1},{name:",",editor:!1},{name:"B2:B8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两数组中对应值的平方和之和",area1:" 第一个数组或数值区域",area2:" 第而个数组或数值区域"}},SUMXMY2:{title:[{name:"SUMXMY2(",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"区域2",editor:!1},{name:")",editor:!1}],example:[{name:"SUMXMY2(",editor:!1},{name:"A2:A8",editor:!1},{name:",",editor:!1},{name:"B2:B8",editor:!1},{name:")",editor:!1}],content:{abstract:"返回两数组中对应数值之差的平方和",area1:" 第一个数组或数值区域",area2:" 第而个数组或数值区域"}},SWITCH:{title:[{name:"SWITCH(",editor:!1},{name:"表达式",editor:!1},{name:",",editor:!1},{name:"值1",editor:!1},{name:",",editor:!1},{name:"结果1",editor:!1},{name:",",editor:!1},{name:"[值2,结果2,...]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"SWITCH(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"'星期天'",editor:!1},{name:")",editor:!1}],content:{abstract:"函数根据值列表计算一个值（称为表达式），并返回与第一个匹配值对应的结果",formula:"用来比较的值",value1:"任意值",result1:"值1 与 表达式 匹配后返回的值",result2:"其他值与结果对,最多125个"}},SYD:{title:[{name:"SYD(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"SYD(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回在指定期间内资产按年限总和折旧法计算的折旧",value1:"资产原值",value2:"折旧末尾时的值",value3:"资产的折旧期数",value4:"期间，必须与 value3 使用相同的单位"}},T:{title:[{name:"T(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"T(",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"返回值引用的文字",value:"要测试的值"}},TAN:{title:[{name:"TAN(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TAN(",editor:!1},{name:"0.785",editor:!1},{name:")",editor:!1}],content:{abstract:"返回已知角度的正切",value:"要求正切的角度，以弧度表示"}},TANH:{title:[{name:"TANH(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TAN(",editor:!1},{name:"-2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数字的双曲正切",value:"任意实数"}},TBILLEQ:{title:[{name:"TBILLEQ(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TBILLEQ(",editor:!1},{name:"A1",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回国库券的等效收益率",date1:"国库券的结算日",date2:"国库券的到期日",value:"国库券的贴现率"}},TBILLPRICE:{title:[{name:"TBILLPRICE(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TBILLPRICE(",editor:!1},{name:"A1",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回面值 ￥100 的国库券的价格",date1:"国库券的结算日",date2:"国库券的到期日",value:"国库券的贴现率"}},TBILLYIELD:{title:[{name:"TBILLYIELD(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TBILLYIELD(",editor:!1},{name:"A1",editor:!1},{name:",",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回国库券的收益率",date1:"国库券的结算日",date2:"国库券的到期日",value:"面值 ￥100 的国库券的价格"}},"T.DIST":{title:[{name:"T.DIST(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:")",editor:!1}],example:[{name:"T.DIST(",editor:!1},{name:"60",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回学生的左尾 t 分布。 t 分布用于小型样本数据集的假设检验",value1:"需要计算分布的数值",value2:"一个表示自由度数的整数",value3:"决定函数形式的逻辑值"}},"T.DIST.RT":{title:[{name:"T.DIST.RT(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"T.DIST.RT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"t 分布用于小型样本数据集的假设检验",value1:"需要计算分布的数值",value2:"一个表示自由度数的整数"}},TEXT:{title:[{name:"TEXT(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"TEXT(",editor:!1},{name:"1234.567",editor:!1},{name:",",editor:!1},{name:"'$#,##0.00'",editor:!1},{name:")",editor:!1}],content:{abstract:"函数可通过格式代码向数字应用格式，进而更改数字的显示方式",value:"要转换为文本的数值",text:"一个文本字符串，定义要应用于所提供值的格式"}},TIME:{title:[{name:"TIME(",editor:!1},{name:"时",editor:!1},{name:",",editor:!1},{name:"分",editor:!1},{name:",",editor:!1},{name:"秒",editor:!1},{name:")",editor:!1}],example:[{name:"TIME(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"B2",editor:!1},{name:",",editor:!1},{name:"C2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回特定时间的十进制数字",hour:"0（零）到 32767 之间的数字，代表小时",minute:" 0 到 32767 之间的数字，代表分钟",second:"0 到 32767 之间的数字，代表秒"}},TIMEVALUE:{title:[{name:"TIMEVALUE(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"TIMEVALUE(",editor:!1},{name:"'2:24 AM'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回由文本字符串表示的时间的十进制数字",text:"一个文本字符串，代表以任一 Microsoft Excel 时间格式表示的时间"}},"T.INV":{title:[{name:"T.INV(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"T.INV(",editor:!1},{name:"0.75",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回学生的 t 分布的左尾反函数",value1:"与学生的 t 分布相关的概率",value2:"与学生的 t 分布相关的概率"}},TODAY:{title:[{name:"TODAY(",editor:!1},{name:")",editor:!1}],example:[{name:"TODAY(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回当前日期的序列号"}},TRANSPOSE:{title:[{name:"TRANSPOSE(",editor:!1},{name:"array",editor:!1},{name:")",editor:!1}],example:[{name:"TRANSPOSE(",editor:!1},{name:"A1:F6",editor:!1},{name:")",editor:!1}],content:{abstract:"可返回转置单元格区域，即将行单元格区域转置成列单元格区域，反之亦然",array:"要转置的工作表上的数组或单元格区域"}},TREND:{title:[{name:"TREND(",editor:!1},{name:"集合1",editor:!1},{name:",",editor:!1},{name:"[集合2]",editor:!0,index:3},{name:",",editor:!1},{name:"[value1]",editor:!0,index:5},{name:",",editor:!1},{name:"[value2]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"TREND(",editor:!1},{name:"E2:E13",editor:!1},{name:",",editor:!1},{name:"D2:D13",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"函数返回沿线性趋势的值",set1:"关系 y = mx + b 中已知道的 y 值集",set2:"在关系 y = mx + b 中可能已经知道的一组可选 x 值",value1:"要返回其趋势的新 x 值返回对应的 y 值",value2:"一个逻辑值, 指定是否强制常量 b 等于0"}},TRIMMEAN:{title:[{name:"TRIMMEAN(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"TRIMMEAN(",editor:!1},{name:"A2:A12",editor:!1},{name:",",editor:!1},{name:"0.2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数据集的内部平均值",array:"需要进行整理并求平均值的数组或数值区域",value:"从计算中排除数据点的分数"}},TRUE:{title:[{name:"TRUE(",editor:!1},{name:")",editor:!1}],example:[{name:"TRUE(",editor:!1},{name:")",editor:!1}],content:{abstract:"返回逻辑值 TRUE"}},TRUNC:{title:[{name:"TRUNC(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"TRUNC(",editor:!1},{name:"8.9",editor:!1},{name:")",editor:!1}],content:{abstract:"将数字的小数部分截去，返回整数",value1:"需要截尾取整的数字",value2:"用于指定取整精度的数字,默认为零"}},"T.TEST":{title:[{name:"T.TEST(",editor:!1},{name:"数据集1",editor:!1},{name:",",editor:!1},{name:"数据集2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"T.TEST(",editor:!1},{name:"A2:A10",editor:!1},{name:",",editor:!1},{name:"B2:B10",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"1",editor:!1},{name:")",editor:!1}],content:{abstract:"返回与学生 t-检验相关的概率",dataset1:"第一个数据集",dataset2:"第二个数据集",value1:"指定分布尾数",value2:"要执行的 t 检验的类型"}},TYPE:{title:[{name:"TYPE(",editor:!1},{name:"值",editor:!1},{name:")",editor:!1}],example:[{name:"TYPE(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"返回数值的类型",value:"需要返回值类型的值"}},UNICHAR:{title:[{name:"UNICHAR(",editor:!1},{name:"value",editor:!1},{name:")",editor:!1}],example:[{name:"UNICHAR(",editor:!1},{name:"32",editor:!1},{name:")",editor:!1}],content:{abstract:"返回给定数值引用的 Unicode 字符",value:"代表字符的 Unicode 数字"}},UNICODE:{title:[{name:"UNICODE(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"UNICODE(",editor:!1},{name:"'B'",editor:!1},{name:")",editor:!1}],content:{abstract:"返回对应于文本的第一个字符的数字（代码点）",text:"要获得其 Unicode 值的字符"}},UNIQUE:{title:[{name:"UNIQUE(",editor:!1},{name:"array",editor:!1},{name:",",editor:!1},{name:"[value1]",editor:!0,index:3},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"UNIQUE(",editor:!1},{name:"D2:D11",editor:!1},{name:")",editor:!1}],content:{abstract:"函数返回列表或范围中的一系列唯一值",array:"要从其中返回唯一值的范围或数组",value1:"为逻辑值，用于指示比较方式；By row = FALSE 或省略；By column = TRUE",value2:"为逻辑值：仅返回出现一次的唯一值 = TRUE；包含所有唯一值 = FALSE 或省略"}},UPPER:{title:[{name:"UPPER(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"UPPER(",editor:!1},{name:"A2",editor:!1},{name:")",editor:!1}],content:{abstract:"将文本转换为大写字母",text:"要转换为大写字母的文本。 文本可以是引用或文本字符串"}},VALUE:{title:[{name:"VALUE(",editor:!1},{name:"text",editor:!1},{name:")",editor:!1}],example:[{name:"VALUE(",editor:!1},{name:"'$1,000'",editor:!1},{name:")",editor:!1}],content:{abstract:"将表示数字的文本字符串转换为数字",text:"用引号括起来的文本或包含要转换文本的单元格的引用"}},VAR:{title:[{name:"VAR(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"VAR(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"计算基于给定样本的方差",value1:"对应于总体样本的第一个数值参数",value2:"对应于总体样本的 2 到 255 个数值参数"}},"VAR.P":{title:[{name:"VAR.P(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"VAR.P(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"计算基于整个样本总体的方差（忽略样本总体中的逻辑值和文本）",value1:"对应于总体样本的第一个数值参数",value2:"对应于总体样本的 2 到 255 个数值参数"}},VARA:{title:[{name:"VARA(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"VARA(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"计算基于给定样本的方差",value1:"对应于总体样本的第一个数值参数",value2:"对应于总体样本的 2 到 255 个数值参数"}},"VAR.S":{title:[{name:"VAR.S(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"VAR.S(",editor:!1},{name:"A2:A11",editor:!1},{name:")",editor:!1}],content:{abstract:"估算基于样本的方差",value1:"对应于总体样本的第一个数值参数",value2:"对应于总体样本的 2 到 255 个数值参数"}},VDB:{title:[{name:"VDB(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"[value4]",editor:!0,index:11},{name:",",editor:!1},{name:"[value5]",editor:!0,index:13},{name:")",editor:!1}],example:[{name:"VDB(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"0",editor:!1},{name:",",editor:!1},{name:"0.875",editor:!1},{name:",",editor:!1},{name:"1.5",editor:!0,index:11},{name:")",editor:!1}],content:{abstract:"使用双倍余额递减法或其他指定方法，返回一笔资产在给定期间（包括部分期间）内的折旧值",value1:"资产原值",value2:"折旧末尾时的值",value3:"资产的折旧期数",date1:"您要计算折旧的起始时期",date2:"您要计算折旧的终止时期",value4:"余额递减速率",value5:"逻辑值，指定当折旧值大于余额递减计算值时，是否转用直线折旧法"}},VLOOKUP:{title:[{name:"VLOOKUP(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"区域1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"[value3]",editor:!0,index:7},{name:")",editor:!1}],example:[{name:"VLOOKUP(",editor:!1},{name:"B3",editor:!1},{name:",",editor:!1},{name:"B2:E7",editor:!1},{name:",",editor:!1},{name:"2",editor:!1},{name:",",editor:!1},{name:"FALSE",editor:!0,index:7},{name:")",editor:!1}],content:{abstract:"在表格或区域中按行查找项目",value1:"要查找的值",area1:"搜索 value1 和返回值的单元格区域",value2:"包含返回值的列号",value3:"一个逻辑值，该值指定希望 VLOOKUP 查找近似匹配还是精确匹配"}},WEEKDAY:{title:[{name:"WEEKDAY(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"WEEKDAY(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回对应于某个日期的一周中的第几天",value1:"一个序列号，代表尝试查找的那一天的日期",value2:"用于确定返回值类型的数字"}},WEEKNUM:{title:[{name:"WEEKNUM(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"WEEKNUM(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"3",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回特定日期的周数",value1:"代表一周中的日期",value2:"一数字，确定星期从哪一天开始"}},WEIBULL:{title:[{name:"WEIBULL(",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"WEIBULL(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"TRUE",editor:!1},{name:")",editor:!1}],content:{abstract:"返回 Weibull 分布",value1:"用来计算函数的值",value2:"分布参数",value3:"分布参数",value4:"确定函数的形式"}},WORKDAY:{title:[{name:"WORKDAY(",editor:!1},{name:"日期",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"[数组]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"WORKDAY(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回在某日期（起始日期）之前或之后、与该日期相隔指定工作日的某一日期的日期值",date:"一个代表开始日期的日期",value:"日期 之前或之后不含周末及节假日的天数",array:"一个可选列表，其中包含需要从工作日历中排除的一个或多个日期，例如各种省/市/自治区和国家/地区的法定假日及非法定假日"}},"WORKDAY.INTL":{title:[{name:"WORKDAY.INTL(",editor:!1},{name:"日期",editor:!1},{name:",",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"[数组]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"WORKDAY.INTL(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4:A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）",date:"开始日期",value:"日期 之前或之后不含周末及节假日的天数",array:"指示一周中属于周末的日子和不作为工作日的日子"}},XIRR:{title:[{name:"XIRR(",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:",",editor:!1},{name:"[数值]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"XIRR(",editor:!1},{name:"A3:A7",editor:!1},{name:",",editor:!1},{name:"B3:B7",editor:!1},{name:",",editor:!1},{name:"0.1",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回一组不一定定期发生的现金流的内部收益率",array1:"与 array2 中的支付时间相对应的一系列现金流",array2:"与现金流支付相对应的支付日期表",value:"对函数 XIRR 计算结果的估计值"}},XNPV:{title:[{name:"XNPV(",editor:!1},{name:"value",editor:!1},{name:",",editor:!1},{name:"array1",editor:!1},{name:",",editor:!1},{name:"array2",editor:!1},{name:")",editor:!1}],example:[{name:"XNPV(",editor:!1},{name:".09",editor:!1},{name:",",editor:!1},{name:"B3:B7",editor:!1},{name:",",editor:!1},{name:"A2:A6",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回一组现金流的净现值，这些现金流不一定定期发生",value:"对函数 XIRR 计算结果的估计值",array1:"与 array2 中的支付时间相对应的一系列现金流",array2:"与现金流支付相对应的支付日期表"}},XOR:{title:[{name:"XOR(",editor:!1},{name:"条件1",editor:!1},{name:",",editor:!1},{name:"[条件2,...]",editor:!0,index:3},{name:")",editor:!1}],example:[{name:"XOR(",editor:!1},{name:"(3>0",editor:!1},{name:",",editor:!1},{name:"2<9",editor:!0,index:3},{name:")",editor:!1}],content:{abstract:"返回所有参数的逻辑异或",condition1:"计算值为TRUE或FALSE",condition2:"要检验的 1 至 254 个条件，可为 TRUE 或 FALSE，且可为逻辑值、数组或引用"}},YEAR:{title:[{name:"YEAR(",editor:!1},{name:"日期",editor:!1},{name:")",editor:!1}],example:[{name:"YEAR(",editor:!1},{name:"A3",editor:!1},{name:")",editor:!1}],content:{abstract:"返回对应于某个日期的年份",date:"要查找的年份的日期"}},YEARFRAC:{title:[{name:"YEARFRAC(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:")",editor:!1}],example:[{name:"YEARFRAC(",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:")",editor:!1}],content:{abstract:"可计算两个日期（日期1 和 日期2）之间的天数",date1:"一个代表开始日期的日期",date2:"一个代表终止日期的日期"}},YIELD:{title:[{name:"YIELD(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:",",editor:!1},{name:"value3",editor:!1},{name:",",editor:!1},{name:"value4",editor:!1},{name:")",editor:!1}],example:[{name:"YIELD(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:",",editor:!1},{name:"A7",editor:!1},{name:")",editor:!1}],content:{abstract:"返回定期支付利息的债券的收益",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的年息票利率",value2:"有价证券的价格",value3:"面值 ￥100 的有价证券的清偿价值",value4:"年付息次数"}},YIELDDISC:{title:[{name:"YIELDDISC(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"YIELDDISC(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:")",editor:!1}],content:{abstract:"返回折价发行的有价证券的年收益率",date1:"有价证券的结算日",date2:"有价证券的到期日",value1:"有价证券的价格（按面值为 ￥100 计算）",value2:"面值 ￥100 的有价证券的清偿价值"}},YIELDMAT:{title:[{name:"YIELDMAT(",editor:!1},{name:"日期1",editor:!1},{name:",",editor:!1},{name:"日期2",editor:!1},{name:",",editor:!1},{name:"日期3",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"value2",editor:!1},{name:")",editor:!1}],example:[{name:"YIELDMAT(",editor:!1},{name:"A2",editor:!1},{name:",",editor:!1},{name:"A3",editor:!1},{name:",",editor:!1},{name:"A4",editor:!1},{name:",",editor:!1},{name:"A5",editor:!1},{name:",",editor:!1},{name:"A6",editor:!1},{name:")",editor:!1}],content:{abstract:"返回到期付息的有价证券的年收益率",date1:"有价证券的结算日",date2:"有价证券的到期日",date3:"有价证券的发行日，以时间序列号表示",value1:"有价证券在发行日的利率",value2:"有价证券的价格"}},"Z.TEST":{title:[{name:"Z.TEST(",editor:!1},{name:"区域",editor:!1},{name:",",editor:!1},{name:"value1",editor:!1},{name:",",editor:!1},{name:"[value2]",editor:!0,index:5},{name:")",editor:!1}],example:[{name:"Z.TEST(",editor:!1},{name:"A2:A11",editor:!1},{name:",",editor:!1},{name:"4",editor:!1},{name:",",editor:!1},{name:"6",editor:!0,index:5},{name:")",editor:!1}],content:{abstract:"返回 z 检验的单尾 P 值",area:"用来检验 x 的数组或数据区域",value1:"要测试的值",value2:"总体（已知）标准偏差。 如果省略，则使用样本标准偏差"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=r(1),o=r(6),s=r(8),l=r(31),u=r(7),c=r(4),f=(n=r(163))&&n.__esModule?n:{default:n};function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),e}var m=10;function v(e,t){return e.lastIndexOf(t)}var y=function(){function e(t,r,n){var o=this;d(this,e),this.data=t,this._selector=r,this.sheet=n,this.l=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-l")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.r=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-r")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.t=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-t")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.b=(0,i.h)("div","".concat(a.cssPrefix,"-selector-box-b")).on("mousedown.stop",(function(e){o.moveEvent(e)})),this.boxinner=(0,i.h)("div","".concat(a.cssPrefix,"-selector-boxinner")).children(this.b,this.t,this.r,this.l),this.selectorMove=new f.default(this.boxinner,t,n,r),this.areaEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-area")).child(this.boxinner).hide(),this.clipboardEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-clipboard")).hide(),this.autofillEl=(0,i.h)("div","".concat(a.cssPrefix,"-selector-autofill")).hide(),this.el=(0,i.h)("div","".concat(a.cssPrefix,"-selector")).css("z-index","".concat(m)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),m+=1}return p(e,[{key:"moveEvent",value:function(e){var t=this,r=this.data,n=this._selector,i=this.sheet,a=null,f=r.selector.range,d=f.sri,h=f.sci,p=f.eri,m=f.eci,y=f.w,g=f.h,E=new o.CellRange(d,h,p,m,y,g),b=-1;(0,s.mouseMoveUp)(window,(function(s){var f=t.sheet.selectors;i.container.css("pointer-events","none");for(var d=0;d<f.length;d++){f[d].selector.setBoxinner("none")}var h=r.getCellRectByXY(s.layerX,s.layerY),p=h.ri,m=h.ci;if(-1!==p&&-1!==m){var x=t.sheet.editor.pos,A=t.sheet.editor.editorText.getText(),S=(0,u.cuttingByPos)(A,x-1,!0);A.length>x-1&&(S+=(0,u.cuttingByPosEnd)(A,x-1));for(var w=0;w<f.length;w++){var R=f[w],C=R.className,T=R.erpx;if(T===S&&C===n.className+" clear_selector"){if(a=a||R,-1!==T.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var O=T.split(":"),_=(0,c.expr2xy)(O[0]),D=(0,c.expr2xy)(O[1]);(E=new o.CellRange(_[1],_[0],D[1],D[0],y,g)).move(p,m);var N=r.getMoveRect(E);a.selector.range=E,a.selector.setMove(N)}else a.selector.set(p,m,!0);break}if(T!==S&&C===n.className+" clear_selector"){if(b=-1!==b?b:v(A,R.erpx),t.sheet.editor.setCursorPos(b+R.erpx.length),a=a||R,-1!==R.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var k=T.split(":"),M=(0,c.expr2xy)(k[0]),I=(0,c.expr2xy)(k[1]);(E=new o.CellRange(M[1],M[0],I[1],I[0],y,g)).move(p,m);var P=r.getMoveRect(E);a.selector.range=E,a.selector.setMove(P)}else a.selector.set(p,m,!0);break}}a&&(a.selector.setCss(a.color,!1),l.lockCells.call(t.sheet,e,a,(0,u.isAbsoluteValue)(a.erpx),b))}}),(function(){var e=t.sheet.selectors;i.container.css("pointer-events","auto");for(var r=0;r<e.length;r++){e[r].selector.setBoxinner("all")}b=-1,a&&a.selector&&a.selector.setCss(a.color,!0),a=null}))}},{key:"setBoxinner",value:function(e){this.l.css("pointer-events",e),this.r.css("pointer-events",e),this.t.css("pointer-events",e),this.b.css("pointer-events",e),this.selectorMove.l.css("pointer-events",e),this.selectorMove.r.css("pointer-events",e),this.selectorMove.t.css("pointer-events",e),this.selectorMove.b.css("pointer-events",e)}},{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.areaEl.css("border","2px dashed ".concat(e)):this.areaEl.css("border","2px solid ".concat(e)),this.el.css("z-index","-1")}},{key:"setOffset",value:function(e){return this.el.offset(e).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.areaEl.offset({width:n-3+.8,height:i-3+.8,left:t-.8,top:r-.8}).show()}},{key:"setClipboardOffset",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.clipboardEl.offset({left:t,top:r,width:n-5,height:i-5})}},{key:"showAutofill",value:function(e){var t=e.left,r=e.top,n=e.width,i=e.height;this.autofillEl.offset({width:n-3,height:i-3,left:t,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),e}();function g(e){var t=this.data,r=e.left,n=e.top,i=e.width,a=e.height,o=e.scroll,s=e.l,l=e.t,u=t.freezeTotalWidth(),c=t.freezeTotalHeight(),f=r-u;u>s&&(f-=o.x);var d=n-c;return c>l&&(d-=o.y),{left:f,top:d,width:i,height:a}}function E(e){var t=this.data,r=e.left,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalWidth(),u=r-l;return l>a&&(u-=s.x),{left:u,top:o,width:n,height:i}}function b(e){var t=this.data,r=e.top,n=e.width,i=e.height,a=e.l,o=e.t,s=e.scroll,l=t.freezeTotalHeight(),u=r-l;return l>o&&(u-=s.y),{left:a,top:u,width:n,height:i}}function x(e){this.br.setAreaOffset(g.call(this,e))}function A(e){this.tl.setAreaOffset(e)}function S(e){this.t.setAreaOffset(E.call(this,e))}function w(e){this.l.setAreaOffset(b.call(this,e))}function R(e){this.l.setClipboardOffset(b.call(this,e))}function C(e){this.br.setClipboardOffset(g.call(this,e))}function T(e){this.tl.setClipboardOffset(e)}function O(e){this.t.setClipboardOffset(E.call(this,e))}function _(e){x.call(this,e),A.call(this,e),S.call(this,e),w.call(this,e)}function D(e){C.call(this,e),T.call(this,e),O.call(this,e),R.call(this,e)}var N=function(){function e(t,r,n){d(this,e),this.data=t,this.className=n,this.br=new y(t,this,r),this.t=new y(t,this,r),this.l=new y(t,this,r),this.tl=new y(t,this,r),this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,i.h)("div","".concat(a.cssPrefix,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,m+=1}return p(e,[{key:"setCss",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.br.setCss(e,t),this.t.setCss(e,t),this.l.setCss(e,t),this.tl.setCss(e,t)}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var e=this.data,t=this.tl,r=this.t,n=this.l,i=this.br,a=e.freezeTotalHeight(),o=e.freezeTotalWidth();a>0||o>0?(t.setOffset({width:o,height:a}),r.setOffset({left:o,height:a}),n.setOffset({top:a,width:o}),i.setOffset({left:o,top:a})):(t.hide(),r.hide(),n.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();_.call(this,e),D.call(this,t),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();x.call(this,e),S.call(this,e),C.call(this,t),O.call(this,t),this.resetOffset()}},{key:"resetSelectorBRLAreaOffset",value:function(e){var t=this.data.getMoveRect(e),r=this.data.getClipboardRect();x.call(this,t),w.call(this,t),C.call(this,r),R.call(this,r),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var e=this.data.getSelectedRect(),t=this.data.getClipboardRect();x.call(this,e),w.call(this,e),C.call(this,t),R.call(this,t),this.resetOffset()}},{key:"set",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=n.calSelectedRangeByStart(e,t),a=i.sri,o=i.sci;if(r){var s=e,l=t;e<0&&(s=0),t<0&&(l=0),n.selector.setIndexes(s,l),this.indexes=[s,l]}this.moveIndexes=[a,o],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setMove",value:function(e){_.call(this,e)}},{key:"setEnd",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,i=this.lastri,a=this.lastci;if(r){if(e===i&&t===a)return;this.lastri=e,this.lastci=t}this.range=n.calSelectedRangeByEnd(e,t),_.call(this,this.data.getSelectedRect())}},{key:"setBoxinner",value:function(e){this.br.setBoxinner(e),this.t.setBoxinner(e),this.l.setBoxinner(e),this.tl.setBoxinner(e)}},{key:"showAutofill",value:function(e,t){if(-1!==e||-1!==t){var r=this.range,n=r.sri,i=r.sci,a=r.eri,s=r.eci,l=e,u=t,c=n-e,f=a-e,d=s-t;if(i-t>0)this.arange=new o.CellRange(n,u,a,i-1);else if(c>0)this.arange=new o.CellRange(l,i,n-1,s);else if(d<0)this.arange=new o.CellRange(n,s+1,a,u);else{if(!(f<0))return void(this.arange=null);this.arange=new o.CellRange(a+1,i,l,s)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,m=this.l,v=this.t,y=this.tl;p.showAutofill(g.call(this,h)),m.showAutofill(b.call(this,h)),v.showAutofill(E.call(this,h)),y.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideAutofill()}))}},{key:"showClipboard",value:function(){var e=this,t=this.data.getClipboardRect();D.call(this,t),["br","l","t","tl"].forEach((function(t){e[t].showClipboard()}))}},{key:"hideClipboard",value:function(){var e=this;["br","l","t","tl"].forEach((function(t){e[t].hideClipboard()}))}}]),e}();t.default=N},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1),a=r(7),o=r(4),s=r(31),l=r(6),u=r(8);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return e.lastIndexOf(t)}var d=function(){function e(t,r,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.l=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-l")),this.r=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-r")),this.t=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-t")),this.b=(0,n.h)("div","".concat(i.cssPrefix,"-selector-box-l-move-b")),this.data=r,this.sheet=a,this._selector=o,this.event(this.l,1),this.event(this.r,2),this.event(this.t,3),this.event(this.b,4),this.boxinner=t,this.boxinner.children(this.l,this.r,this.t,this.b)}var t,r,d;return t=e,(r=[{key:"event",value:function(e,t){var r=this,n=null;e.on("mousedown.stop",(function(e){var i=r.data,c=r.sheet,d=r._selector,h=-1,p=i.selector,m=null,v=p.range,y=v.sri,g=v.sci,E=v.eri,b=v.eci,x=v.w,A=v.h,S=new l.CellRange(y,g,E,b,x,A),w=null,R=c.selectors,C=-1,T=-1,O=-1,_=-1;(0,u.mouseMoveUp)(window,(function(u){clearTimeout(n),n=setTimeout((function(){c.container.css("pointer-events","none");for(var n=0;n<R.length;n++)R[n].selector.setBoxinner("none");var p=i.getCellRectByXY(u.layerX,u.layerY),v=p.ri,y=p.ci;if(-1!==v&&-1!==y){var g=r.sheet.editor.pos,E=r.sheet.editor.editorText.getText(),b=(0,a.cuttingByPos)(E,g-1,!0);E.length>g-1&&(b+=(0,a.cuttingByPosEnd)(E,g-1));for(var D=0;D<R.length;D++){var N=R[D],k=N.className,M=N.erpx;if(M===b&&k===d.className+" clear_selector"){if(m=m||N,-1!==M.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var I=M.split(":"),P=(0,o.expr2xy)(I[0]),F=(0,o.expr2xy)(I[1]);(S=new l.CellRange(P[1],P[0],F[1],F[0],x,A)).move(v,y);var L=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(L)}else m.selector.set(v,y,!0);break}if(M!==b&&k===d.className+" clear_selector"){if(h=-1!==h?h:f(E,N.erpx),r.sheet.editor.setCursorPos(h+N.erpx.length),m=m||N,-1!==N.erpx.search(/^[A-Za-z]+\d+:[A-Za-z]+\d+$/)){var j=M.split(":"),B=(0,o.expr2xy)(j[0]),U=(0,o.expr2xy)(j[1]);if(S=new l.CellRange(B[1],B[0],U[1],U[0],x,A),null===w&&(w=S),4===t){var V=i.getCellRectByXY(u.layerX,u.layerY);S.move2(B[1],B[0],V.ri,V.ci);var H=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(H)}else if(1===t){var z=i.getCellRectByXY(u.layerX,u.layerY);S.move2(B[1],z.ci,z.ri,U[0]);var X=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(X)}else if(3===t){var q=i.getCellRectByXY(u.layerX,u.layerY);S.move2(q.ri,q.ci,U[1],U[0]);var W=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(W)}else if(2===t){var G=i.getCellRectByXY(u.layerX,u.layerY);S.move2(G.ri,B[0],U[1],G.ci);var Y=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(Y)}}else{var J=(0,o.expr2xy)(N.erpx),$=(0,o.expr2xy)(N.erpx),K=i.getCellRectByXY(u.layerX,u.layerY);if(4===t){S.move2(J[1],J[0],K.ri,K.ci);var Q=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(Q)}else if(1===t){S.move2(J[1],K.ci,K.ri,$[0]);var Z=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(Z)}else if(3===t){S.move2(K.ri,K.ci,$[1],$[0]);var ee=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(ee)}else if(2===t){S.move2(K.ri,J[0],$[1],K.ci);var te=i.getMoveRect(S);m.selector.range=S,m.selector.setMove(te)}}break}}!m||C===S.sri&&T===S.sci&&O===S.eri&&_===S.eci||(m.selector.setCss(m.color,!1),s.lockCells.call(r.sheet,e,m,(0,a.isAbsoluteValue)(m.erpx),h)),C=S.sri,T=S.sci,O=S.eri,_=S.eci}}),6)}),(function(){clearTimeout(n);var e=r.sheet.selectors;c.container.css("pointer-events","auto");for(var t=0;t<e.length;t++)e[t].selector.setBoxinner("all");h=-1,m&&m.selector&&m.selector.setCss(m.color,!0),m=null}))}))}}])&&c(t.prototype,r),d&&c(t,d),e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(7),i=r(48);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputText="",this.oldCell="",this.ri=-1,this.ci=-1}var t,r,o;return t=e,(r=[{key:"setText",value:function(e){return this.inputText=e,this.getText()}},{key:"getText",value:function(){return this.inputText}},{key:"setOldCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=t.ri,n=void 0===r?-1:r,i=t.ci,a=void 0===i?-1:i;return this.oldCell=e,this.ri=n,this.ci=a,this.getOldCell()}},{key:"getOldCell",value:function(){return this.oldCell}},{key:"getRICI",value:function(){return{ri:this.ri,ci:this.ci}}},{key:"changeText",value:function(e){1===e&&this.setText(this.getText().replace(/，/g,","))}},{key:"isFormula",value:function(){return 0===this.getText().lastIndexOf("=")}},{key:"f4ShortcutKey",value:function(e){var t=this.setText((0,i.toUpperCase)(this.inputText)),r=(0,n.cuttingByPos)(t,e,!0),a=(0,n.cuttingByPosEnd2)(t,e+1);console.log(a);var o=(0,n.isAbsoluteValue)(r,5),s="",l=r.split(":")[1];if(l&&(o=2===(o=1===(o=12===(o=3===(o=(0,n.isAbsoluteValue)(l,5))?6:o)?9:o)?7:o)?8:o,console.log(o)),!1!==o)switch(o){case 13:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s1;var u=t.substring(0,t.lastIndexOf(l));t=this.setText(u+s);break;case 12:l=r,s=(0,n.value2absolute)(l.replace(/\$/g,"")).s3,console.log((0,n.value2absolute)(r)),t=this.setText(t.substring(0,t.lastIndexOf(l))+s),console.log(this.getText());break;case 11:case 10:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s3,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 9:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 8:s=(l=r.split(":")[1]).replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 7:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 6:l=r.split(":")[1],s=(0,n.value2absolute)(l.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(l))+s);break;case 5:s=(0,n.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 4:s=(0,n.value2absolute)(r.split(":")[1].replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 3:s=(0,n.value2absolute)(r.replace(/\$/g,"")).s2,t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 2:s=r.replace(/\$/g,""),t=this.setText(t.substring(0,t.lastIndexOf(r))+s);break;case 1:s=(0,n.value2absolute)(r.replace(/\$/g,"")).s1,t=this.setText(t.substring(0,t.lastIndexOf(r))+s)}return{pos:t.length,inputText:t=this.setText(t+a)}}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRender=s,t.infixExprToSuffixExpr=t.render=void 0;var n=r(4),i=r(1);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.infixExprToSuffixExpr=function(e){for(var t=[],r=[],i=[],o=0,s=1,l=0;l<e.length;l+=1){var u=e.charAt(l);if(" "!==u)if(u>="a"&&u<="z")i.push(u.toUpperCase());else if(u>="0"&&u<="9"||u>="A"&&u<="Z"||"."===u)i.push(u);else if('"'===u){for(l+=1;'"'!==e.charAt(l);)i.push(e.charAt(l)),l+=1;r.push('"'.concat(i.join(""))),i=[]}else{if("("!==u&&i.length>0&&r.push(i.join("")),")"===u){var c=t.pop();if(2===o)try{for(var f=a((0,n.expr2xy)(r.pop()),2),d=f[0],h=f[1],p=a((0,n.expr2xy)(r.pop()),2),m=p[0],v=p[1],y=0,g=m;g<=d;g+=1)for(var E=v;E<=h;E+=1)r.push((0,n.xy2expr)(g,E)),y+=1;r.push([c,y])}catch(e){}else if(1===o)r.push([c,s]),s=1;else for(;"("!==c&&(r.push(c),!(t.length<=0));)c=t.pop();o=0}else if(":"===u)o=2;else if(","===u)o=1,s+=1;else if("("===u&&i.length>0)t.push(i.join(""));else{if(t.length>0&&("+"===u||"-"===u)){var b=t[t.length-1];if("("!==b&&r.push(t.pop()),"*"===b||"/"===b)for(;t.length>0&&"("!==(b=t[t.length-1]);)r.push(t.pop())}t.push(u)}i=[]}}for(i.length>0&&r.push(i.join(""));t.length>0;)r.push(t.pop());return r};function o(e,t){return"string"==typeof e&&-1!==e.toUpperCase().indexOf(t.toUpperCase())}function s(e,t,r,a,s,l,u){arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(void 0===s)return"";if("string"==typeof s&&-1!==i.look.indexOf(s.split("!")[0])){var c=s.length;s.split(" ")[0]&&(c=s.split(" ")[0].length);var f=JSON.parse(s.substring(s.indexOf("!")+1,c)),d=i.look.indexOf(s.split("!")[0]);if(1===d)return f.text;if(0===d&&f&&f[0]){var h=f[0],p=h.name,m=h.value;if(0===m&&f[1]&&0!==f[1].value)return p;if(0===m&&!f[1])return p}return i.look2}return"="===s[0]&&"="!==s[1]?o(s.substring(1),"wland")||o(s.substring(1),"wfr")||o(s.substring(1),"rtd")||o(s.substring(1),"city")?s.toUpperCase():s.substring(1)&&t&&t.Sheets&&t.Sheets[e.name]&&t.Sheets[e.name][(0,n.xy2expr)(a,r)]?t.Sheets[e.name][(0,n.xy2expr)(a,r)].f&&-1!==t.Sheets[e.name][(0,n.xy2expr)(a,r)].f.search(/\((\+|\-|\*|\/)/)||void 0===t.Sheets[e.name][(0,n.xy2expr)(a,r)].v||""===t.Sheets[e.name][(0,n.xy2expr)(a,r)].v?"#ERROR!":(t.Sheets[e.name][(0,n.xy2expr)(a,r)].v=t.Sheets[e.name][(0,n.xy2expr)(a,r)].v+"",t.Sheets[e.name][(0,n.xy2expr)(a,r)].w?t.Sheets[e.name][(0,n.xy2expr)(a,r)].w:t.Sheets[e.name][(0,n.xy2expr)(a,r)].v.replace(/'/g,'"')):s:s}var l=s;t.render=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMinus=void 0;t.isMinus=function(e){return!isNaN(e)&&(""!==e&&parseInt(e)<0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.thinLineWidth=c,t.npx=f,t.DrawBox=t.Draw=void 0;var n=r(9);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function u(){return window.devicePixelRatio||1}function c(){return u()-.5}function f(e){var t=e*u()+"";return parseInt(t,10)}function d(e){var t=f(e);return t>0?t-.5:.5}function h(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}function p(e,t,r){e.save(),e.beginPath(),e.fillStyle="#707070",e.moveTo(t+6,r),e.lineTo(t+6,r+12),e.moveTo(t,r+6),e.lineTo(t+12,r+6),e.stroke(),e.strokeRect(t,r,12,12),e.clip(),e.fill(),e.restore()}var m=function(){function e(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o(this,e),this.x=t,this.y=r,this.width=n,this.height=i,this.padding=a,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return l(e,[{key:"setBorders",value:function(e){var t=e.top,r=e.bottom,n=e.left,i=e.right;t&&(this.borderTop=t),i&&(this.borderRight=i),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding}},{key:"innerHeight",value:function(){return this.height-2*this.padding}},{key:"textx",value:function(e){var t=this.width,r=this.padding,n=this.x;return"left"===e?n+=r:"center"===e?n+=t/2:"right"===e&&(n+=t-r),n}},{key:"texty",value:function(e,t,r){var n=this.height,i=this.padding,a=this.y;return"top"===e?a+=i:"middle"===e?a=a+n/2-r:"bottom"===e&&(a+=n-2*r-i),a}},{key:"topxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e+this.width,t]]}},{key:"rightxys",value:function(){var e=this.x,t=this.y,r=this.width;return[[e+r,t],[e+r,t+this.height]]}},{key:"bottomxys",value:function(){var e=this.x,t=this.y,r=this.width,n=this.height;return[[e,t+n],[e+r,t+n]]}},{key:"leftxys",value:function(){var e=this.x,t=this.y;return[[e,t],[e,t+this.height]]}}]),e}();function v(e,t,r,n,i,a,o){var s={x:0,y:0};"underline"===e?s.y="bottom"===i?0:"top"===i?-(a+2):-a/2:"strike"===e&&("bottom"===i?s.y=a/2:"top"===i&&(s.y=-(a/2+2))),"center"===n?s.x=o/2:"right"===n&&(s.x=o),this.line([t-s.x,r-s.y],[t-s.x+o,r-s.y])}t.DrawBox=m;var y=function(){function e(t,r,n){o(this,e),this.el=t,this.ctx=t.getContext("2d"),this.resize(r,n),this.ctx.scale(1*u(),1*u()),this.cxc={indent:250,vIndent:200,canvasContext:this.ctx},this.el.style["background-color"]="rgb(248, 248, 248)"}return l(e,[{key:"resize",value:function(e,t){this.el.style.width="".concat(e,"px"),this.el.style.height="".concat(t,"px"),this.el.width=f(e),this.el.height=f(t)}},{key:"clear",value:function(){var e=this.el,t=e.width,r=e.height;return this.ctx.clearRect(0,0,t,r),this}},{key:"attr",value:function(e){return Object.assign(this.ctx,e),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(e,t){return this.ctx.translate(f(e),f(t)),this}},{key:"clearRect",value:function(e,t,r,n){return this.ctx.clearRect(e,t,r,n),this}},{key:"fillRect",value:function(e,t,r,n){return this.ctx.fillRect(f(e)-.5,f(t)-.5,f(r),f(n)),this}},{key:"fillText",value:function(e,t,r){return this.ctx.fillText(e,f(t),f(r)),this}},{key:"selfAdaptionHeight",value:function(e,t,r){if(void 0!==r&&void 0!==t){for(var n=1,i={len:0,start:0},a=e.width-2*e.padding,o=0;o<t.length;o+=1)i.len+e.padding>=a&&(n+=1,i.len=0,i.start=o),i.len+=this.selfAdaptionOneTxtWidth(t[o],r);return n}}},{key:"selfAdaptionTxtWidth",value:function(e,t,r){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(t)||e.length<=0)return 0;var i=this.ctx;return i.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(f(t.size),"px ").concat(t.name),i.measureText(e).width*t.size/f(t.size)}},{key:"selfAdaptionOneTxtWidth",value:function(e,t){if(!1===(0,n.isHave)(e)||!1===(0,n.isHave)(t)||e.length<=0)return 0;var r=this.ctx;return r.font="".concat(t.italic?"italic":""," ").concat(t.bold?"bold":""," ").concat(f(t.size),"px ").concat(t.name),r.measureText(e).width}},{key:"text",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.ctx,a=r.align,o=r.valign,s=r.font,l=r.color,u=r.strike,c=r.underline,d=(r.ignore,t.textx(a));i.save(),i.beginPath(),this.attr({textAlign:a,textBaseline:o,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(f(s.size),"px ").concat(s.name),fillStyle:l,strokeStyle:l});var h=this.selfAdaptionTxtWidth(e,s,t),p=0,m=t.innerWidth();if(n){m=t.width-2*t.padding;var y=this.selfAdaptionHeight(t,e,s);p=(y-1)*s.size/2}var g=t.texty(o,s.size,p);if(n&&h>m){for(var E={len:0,start:0},b=0;b<e.length;b+=1)E.len+t.padding>=m&&(this.fillText(e.substring(E.start,b),d,g),u&&v.call(this,"strike",d,g,a,o,s.size,E.len),c&&v.call(this,"underline",d,g,a,o,s.size,E.len),g+=s.size+2,E.len=0,E.start=b),E.len+=this.selfAdaptionOneTxtWidth(e[b],s);E.len>0&&(this.fillText(e.substring(E.start),d,g),u&&v.call(this,"strike",d,g,a,o,s.size,E.len),c&&v.call(this,"underline",d,g,a,o,s.size,E.len))}else this.fillText(e,d,g),u&&v.call(this,"strike",d,g,a,o,s.size,h),c&&v.call(this,"underline",d,g,a,o,s.size,h);return i.restore(),this}},{key:"border",value:function(e,t){var r=this.ctx;return r.lineWidth=c,r.strokeStyle=t,"medium"===e?r.lineWidth=f(2)-.5:"thick"===e?r.lineWidth=f(3):"dashed"===e?r.setLineDash([f(3),f(2)]):"dotted"===e?r.setLineDash([f(1),f(1)]):"double"===e&&r.setLineDash([f(2),0]),this}},{key:"line",value:function(){var e=this.ctx;if(arguments.length>1){var t=arguments.length<=0?void 0:arguments[0],r=a(t,2),n=r[0],i=r[1];e.moveTo(d(n),d(i));for(var o=1;o<arguments.length;o+=1){var s=o<0||arguments.length<=o?void 0:arguments[o],l=a(s,2),u=l[0],c=l[1];e.lineTo(d(u),d(c))}e.stroke()}return this}},{key:"strokeBorders",value:function(e){var t=this.ctx;t.save(),t.beginPath();var r=e.borderTop,n=e.borderRight,a=e.borderBottom,o=e.borderLeft;r&&(this.border.apply(this,i(r)),this.line.apply(this,i(e.topxys()))),n&&(this.border.apply(this,i(n)),this.line.apply(this,i(e.rightxys()))),a&&(this.border.apply(this,i(a)),this.line.apply(this,i(e.bottomxys()))),o&&(this.border.apply(this,i(o)),this.line.apply(this,i(e.leftxys()))),t.restore()}},{key:"dropUp",value:function(e,t,r){var n=this.ctx,i=e.x+10,a=e.y+e.height-18-r;t?p.call(this,n,f(i),f(a)):h.call(this,n,f(i),f(a))}},{key:"lineTo",value:function(e,t){this.cxc.canvasContext.lineTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"moveTo",value:function(e,t){this.cxc.canvasContext.moveTo(e+this.cxc.indent,t+this.cxc.vIndent)}},{key:"dropdown",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-15,a=n+e.height-15;t.save(),t.beginPath(),t.moveTo(f(i),f(a)),t.lineTo(f(i+8),f(a)),t.lineTo(f(i+4),f(a+6)),t.closePath(),t.fillStyle="rgba(0, 0, 0, .45)",t.fill(),t.restore()}},{key:"error",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=r+e.width-1;t.save(),t.beginPath(),t.moveTo(f(i-8),f(n-1)),t.lineTo(f(i),f(n-1)),t.lineTo(f(i),f(n+8)),t.closePath(),t.fillStyle="rgba(255, 0, 0, .65)",t.fill(),t.restore()}},{key:"rect",value:function(e,t){var r=this.ctx,n=e.x,i=e.y,a=e.width,o=e.height,s=e.bgcolor;r.save(),r.beginPath(),r.fillStyle=s||"#fff",r.rect(d(n+1),d(i+1),f(a-2),f(o-2)),r.clip(),r.fill(),t(),r.restore()}},{key:"rectWhite",value:function(e){var t=this.ctx,r=e.x,n=e.y,i=e.width,a=e.height;t.save(),t.beginPath(),t.fillStyle="#fff",t.rect(d(r+1),d(n+1),f(i-2),f(a-2)),t.clip(),t.fill(),t.restore()}},{key:"rect2",value:function(e,t){var r=this.ctx,n=e.x,i=e.y,a=e.width,o=e.bgcolor,s=e.height;r.save(),r.beginPath(),r.fillStyle="rgba(0, 0, 0, 0)"===o?"#fff":o||"#fff",r.rect(d(n+1),d(i+1),f(a-2),f(s-2)),r.clip(),r.fill(),t(),r.restore()}}]),e}();t.Draw=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(8),a=r(1),o=r(10);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=[{key:"copy",title:(0,o.tf)("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:(0,o.tf)("contextmenu.cut"),label:"Ctrl+X"},{key:"divider"},{key:"insert-row",title:(0,o.tf)("contextmenu.insertRow")},{key:"insert-column",title:(0,o.tf)("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:(0,o.tf)("contextmenu.deleteRow")},{key:"delete-column",title:(0,o.tf)("contextmenu.deleteColumn")},{key:"delete-cell-text",title:(0,o.tf)("contextmenu.deleteCellText")},{key:"divider"},{key:"validation",title:(0,o.tf)("contextmenu.validation")}];function c(e){var t=this;return"divider"===e.key?(0,n.h)("div","".concat(a.cssPrefix,"-item divider")):(0,n.h)("div","".concat(a.cssPrefix,"-item")).on("click",(function(r){t.itemClick(e.key,r),t.hide()})).children(e.title(),(0,n.h)("div","label").child(e.label||""))}function f(){var e=this;return u.map((function(t){return c.call(e,t)}))}var d=function(){function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.menus=f.call(this),this.el=(r=(0,n.h)("div","".concat(a.cssPrefix,"-contextmenu"))).children.apply(r,s(this.menus)).hide(),this.viewFn=t,this.itemClick=function(){},this.isHide=i}var t,r,o;return t=e,(r=[{key:"hide",value:function(){var e=this.el;e.hide(),(0,i.unbindClickoutside)(e)}},{key:"setPosition",value:function(e,t){if(!this.isHide){var r=this.el,n=r.show().offset(),a=n.height,o=n.width,s=this.viewFn(),l=t,u=e;s.height-t<=a&&(l-=a),s.width-e<=o&&(u-=o),r.offset({left:u,top:l}),(0,i.bindClickoutside)(r)}}}])&&l(t.prototype,r),o&&l(t,o),e}();t.default=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildButton=C,t.buildButtonWithIcon=O,t.default=void 0;var n=r(0),i=r(8),a=y(r(170)),o=y(r(171)),s=y(r(172)),l=y(r(173)),u=(y(r(174)),y(r(86))),c=y(r(175)),f=y(r(176)),d=y(r(14)),h=y(r(12)),p=r(1),m=r(10),v=y(r(179));function y(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){return(0,n.h)("div","".concat(p.cssPrefix,"-toolbar-btn")).on("mouseenter",(function(t){(0,a.default)(e,t.target)})).attr("data-tooltip",e)}function T(){return(0,n.h)("div","".concat(p.cssPrefix,"-toolbar-divider"))}function O(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return C(e).child((r=t,new h.default(r))).on("click",(function(){return n()}))}function _(){var e=this;this.ddFormat.change=function(t){return e.change("format",t.key)},this.ddFont.change=function(t){return e.change("font-name",t.key)},this.ddFontSize.change=function(t){return e.change("font-size",t.pt)},this.ddTextColor.change=function(t){return e.change("color",t)},this.ddFillColor.change=function(t){return e.change("bgcolor",t)},this.ddAlign.change=function(t){return e.change("align",t)},this.ddVAlign.change=function(t){return e.change("valign",t)},this.ddBorder.change=function(t){return e.change("border",t)},this.undoEl.change=function(t){return e.change("undo",t)}}function D(e){var t=e,r=e.split("-");r.length>1&&r.forEach((function(e,r){0===r?t=e:t+=e[0].toUpperCase()+e.substring(1)}));var n=this["".concat(t,"El")];n.toggle(),this.change(e,n.hasClass("active"))}var N=function(e){function t(){var e;A(this,t);var r=new h.default("ellipsis"),i=(0,n.h)("div","".concat(p.cssPrefix,"-toolbar-more"));return(e=S(this,w(t).call(this,r,"auto",!1,"bottom-right",!1,i))).moreBtns=i,e.contentEl.css("max-width","420px"),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,e),t}(d.default);function k(){this.btns2=this.btnChildren.map((function(e){var t=e.box(),r=e.computedStyle(),n=r.marginLeft,i=r.marginRight;return[e,t.width+parseInt(n,10)+parseInt(i,10)]}))}function M(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.widthFn,n=this.el,i=this.btns,a=this.moreEl,o=this.ddMore,s=this.btns2,l=o.moreBtns,u=o.contentEl;n.css("width","".concat(r()-60,"px"));var c=n.box();console.log("92: ",c);var f=160,d=12,h=[],p=[];s.forEach((function(e,t){var r=b(e,2),n=r[0],i=r[1];f+=i,t===s.length-1||f<c.width?h.push(n):(d+=i,p.push(n))})),(e=i.html("")).children.apply(e,h),(t=l.html("")).children.apply(t,p),u.css("width","".concat(d,"px")),p.length>0?a.show():a.hide()}var I=function(){function e(t,r){var a,d=this,h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];A(this,e),this.data=t,this.change=function(){},this.widthFn=r;var y=t.defaultStyle();this.ddFormat=new l.default,this.ddFont=new o.default,this.ddFontSize=new s.default,this.ddTextColor=new u.default("text-color",y.color),this.ddFillColor=new u.default("fill-color",y.bgcolor),this.ddAlign=new c.default(["left","center","right"],y.align),this.ddVAlign=new c.default(["top","middle","bottom"],y.valign),this.ddBorder=new f.default,this.ddMore=new N,this.undoEl=new v.default("undo",(function(){return d.change("undo")}),(function(e){return d.change("undoList",e)})),this.redoEl=new v.default("redo",(function(){return d.change("redo")}),(function(e){return d.change("redoList",e)})),this.btnChildren=[C("".concat((0,m.t)("toolbar.undo"))).child(this.undoEl.el),C("".concat((0,m.t)("toolbar.redo"))).child(this.redoEl.el),this.paintformatEl=O("".concat((0,m.t)("toolbar.paintformat")),"paintformat",(function(){return D.call(d,"paintformat")})),T(),C("".concat((0,m.t)("toolbar.format"))).child(this.ddFormat.el),T(),C("".concat((0,m.t)("toolbar.font"))).child(this.ddFont.el),C("".concat((0,m.t)("toolbar.fontSize"))).child(this.ddFontSize.el),T(),this.fontBoldEl=O("".concat((0,m.t)("toolbar.fontBold")," (Ctrl+B)"),"bold",(function(){return D.call(d,"font-bold")})),this.fontItalicEl=O("".concat((0,m.t)("toolbar.fontItalic")," (Ctrl+I)"),"italic",(function(){return D.call(d,"font-italic")})),this.underlineEl=O("".concat((0,m.t)("toolbar.underline")," (Ctrl+U)"),"underline",(function(){return D.call(d,"underline")})),this.strikeEl=O("".concat((0,m.t)("toolbar.strike")),"strike",(function(){return D.call(d,"strike")})),C("".concat((0,m.t)("toolbar.textColor"))).child(this.ddTextColor.el),T(),C("".concat((0,m.t)("toolbar.fillColor"))).child(this.ddFillColor.el),C("".concat((0,m.t)("toolbar.border"))).child(this.ddBorder.el),this.mergeEl=O("".concat((0,m.t)("toolbar.merge")),"merge",(function(){return D.call(d,"merge")})),T(),C("".concat((0,m.t)("toolbar.align"))).child(this.ddAlign.el),C("".concat((0,m.t)("toolbar.valign"))).child(this.ddVAlign.el),this.textwrapEl=O("".concat((0,m.t)("toolbar.textwrap")),"textwrap",(function(){return D.call(d,"textwrap")})),T(),this.freezeEl=O("".concat((0,m.t)("toolbar.freeze")),"freeze",(function(){return D.call(d,"freeze")})),this.addEl=O("".concat((0,m.t)("toolbar.add")),"add",(function(){return D.call(d,"add")})),this.closeEl=O("".concat((0,m.t)("toolbar.calc")),"close",(function(){return D.call(d,"close")})),this.autofilterEl=O("".concat((0,m.t)("toolbar.autofilter")),"autofilter",(function(){return D.call(d,"autofilter")})),this.chartEl=O("".concat((0,m.t)("toolbar.chart")),"chart",(function(){return D.call(d,"chart")})),this.moreEl=C("".concat((0,m.t)("toolbar.more"))).child(this.ddMore.el).hide()],this.el=(0,n.h)("div","".concat(p.cssPrefix,"-toolbar")),this.btns=(a=(0,n.h)("div","".concat(p.cssPrefix,"-toolbar-btns"))).children.apply(a,g(this.btnChildren)),this.el.child(this.btns),h&&this.el.hide(),_.call(this),this.reset(),setTimeout((function(){k.call(d),M.call(d)}),0),(0,i.bind)(window,"resize",(function(){M.call(d,t.settings.view.width)}))}var t,r,a;return t=e,(r=[{key:"moreResize",value:function(){var e=this.data;M.call(this,e.settings.view.width)}},{key:"paintformatActive",value:function(){return this.paintformatEl.hasClass("active")}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(e){D.call(this,e)}},{key:"reset",value:function(){var e=this.data,t=e.getSelectedCellStyle(),r=e.getSelectedCell();this.undoEl.disabled(!e.canUndo()),this.redoEl.disabled(!e.canRedo()),this.mergeEl.active(e.canUnmerge()).disabled(!e.selector.multiple()),this.autofilterEl.active(!e.canAutofilter());var n=t.font;this.ddFont.setTitle(n.name),this.ddFontSize.setTitle(n.size),this.fontBoldEl.active(n.bold),this.fontItalicEl.active(n.italic),this.underlineEl.active(t.underline),this.strikeEl.active(t.strike),this.ddTextColor.setTitle(t.color),this.ddFillColor.setTitle(t.bgcolor),this.ddAlign.setTitle(t.align),this.ddVAlign.setTitle(t.valign),this.textwrapEl.active(t.textwrap),this.addEl.active(e.equationIsActive()),this.closeEl.active(!1),this.chartEl.active(!1),this.freezeEl.active(e.freezeIsActive()),r&&r.format&&this.ddFormat.setTitle(r.format)}}])&&E(t.prototype,r),a&&E(t,a),e}();t.default=I},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t.classList.contains("active"))return;var r=t.getBoundingClientRect(),o=r.left,s=r.top,l=r.width,u=r.height,c=(0,n.h)("div","".concat(a.cssPrefix,"-tooltip")).html(e).show();document.body.appendChild(c.el);var f=c.box();c.css("left","".concat(o+l/2-f.width/2,"px")).css("top","".concat(s+u+2,"px")),(0,i.bind)(t,"mouseleave",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)})),(0,i.bind)(t,"click",(function(){document.body.contains(c.el)&&document.body.removeChild(c.el)}))};var n=r(0),i=r(8),a=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(14))&&n.__esModule?n:{default:n},a=r(0),o=r(32),s=r(1);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.baseFonts.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.setTitle(e.title),r.change(e)})).child(e.title)}));return r=c(this,(e=f(t)).call.apply(e,[this,o.baseFonts[0].title,"160px",!0,"bottom-left",{type:!1}].concat(u(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),t}(i.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(14))&&n.__esModule?n:{default:n},a=r(0),o=r(32),s=r(1);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.fontSizes.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.setTitle("".concat(e.pt)),r.change(e)})).child("".concat(e.pt))}));return r=c(this,(e=f(t)).call.apply(e,[this,"10","60px",!0,"bottom-left",{type:!1}].concat(u(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),t}(i.default);t.default=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(14))&&n.__esModule?n:{default:n},a=r(0),o=r(49),s=r(1);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.baseFormats.slice(0);return n.splice(1,0,{key:"divider"}),n.splice(5,0,{key:"divider"}),n=n.map((function(e){var t=(0,a.h)("div","".concat(s.cssPrefix,"-item"));return"divider"===e.key?t.addClass("divider"):(t.child(e.title()).on("click",(function(){r.setTitle(e.title()),r.change(e)})),e.label&&t.child((0,a.h)("div","label").html(e.label))),t})),r=f(this,(e=d(t)).call.apply(e,[this,"Normal","220px",!0,"bottom-left",{type:!1}].concat(u(n))))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){for(var t=0;t<o.baseFormats.length;t+=1)o.baseFormats[t].key===e&&this.title.html(o.baseFormats[t].title);this.hide()}}])&&c(r.prototype,n),i&&c(r,i),t}(i.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(14)),i=l(r(12)),a=r(0),o=r(34),s=r(1);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=o.calc.allFnObj.map((function(e){return(0,a.h)("div","".concat(s.cssPrefix,"-item")).on("click",(function(){r.hide(),r.change(e)})).child(e.key)}));return r=f(this,(e=d(t)).call.apply(e,[this,new i.default("cellFormulaProxy"),"180px",!0,"bottom-left",{type:!1}].concat(c(n))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(14)),i=r(0),a=s(r(12)),o=r(1);function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e,r){var n,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var l=new a.default("align-".concat(r)),c=e.map((function(e){return(t="align-".concat(e),(0,i.h)("div","".concat(o.cssPrefix,"-item")).child(new a.default(t))).on("click",(function(){s.setTitle(e),s.change(e)}));var t}));return s=f(this,(n=d(t)).call.apply(n,[this,l,"auto",!0,"bottom-left",{type:!1}].concat(u(c))))}var r,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),r=t,(n=[{key:"setTitle",value:function(e){this.title.setName("align-".concat(e)),this.hide()}}])&&c(r.prototype,n),s&&c(r,s),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(14)),i=o(r(12)),a=o(r(177));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new i.default("border-all"),n=new a.default;return n.change=function(t){e.change(t),e.hide()},(e=l(this,u(t).call(this,r,"auto",!1,"bottom-left",{type:!1},n.el))).borderPalette=n,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),t}(n.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=l(r(12)),a=l(r(86)),o=l(r(178)),s=r(1);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(){var e;return(0,n.h)("table","").child((e=(0,n.h)("tbody","")).children.apply(e,arguments))}function d(e){var t=this,r=(0,n.h)("div","".concat(s.cssPrefix,"-border-palette-cell"));return this.items.push(r),(0,n.h)("td","").child(r.child(new i.default("border-".concat(e))).on("click",(function(){t.mode=e;var r=t.mode,n=t.style,i=t.color;t.change({mode:r,style:n,color:i})})))}t.default=function e(){var t,r,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new a.default("line-color",this.color),this.ddColor.change=function(e){i.color=e},this.ddType=new o.default(this.style),this.ddType.change=function(e){var t=c(e,1)[0];i.style=t},this.el=(0,n.h)("div","".concat(s.cssPrefix,"-border-palette")),this.items=[];var l=f((0,n.h)("tr","").children((0,n.h)("td","".concat(s.cssPrefix,"-border-palette-left")).child(f((t=(0,n.h)("tr","")).children.apply(t,u(["all","inside","horizontal","vertical","outside"].map((function(e){return d.call(i,e)})))),(r=(0,n.h)("tr","")).children.apply(r,u(["left","top","right","bottom","none"].map((function(e){return d.call(i,e)})))))),(0,n.h)("td","".concat(s.cssPrefix,"-border-palette-right")).children((0,n.h)("div","".concat(s.cssPrefix,"-toolbar-btn")).child(this.ddColor.el),(0,n.h)("div","".concat(s.cssPrefix,"-toolbar-btn")).child(this.ddType.el))));this.el.child(l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(14)),i=r(0),a=s(r(12)),o=r(1);function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],p=function(e){function t(e){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=new a.default("line-type"),l=0,d=h.map((function(t,r){return(0,i.h)("div","".concat(o.cssPrefix,"-item state ").concat(e===t[0]?"checked":"")).on("click",(function(){d[l].toggle("checked"),d[r].toggle("checked"),l=r,n.hide(),n.change(t)})).child((0,i.h)("div","".concat(o.cssPrefix,"-line-type")).html(t[1]))}));return n=c(this,(r=f(t)).call.apply(r,[this,s,"auto",!1,"bottom-left",{type:!1}].concat(u(d))))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),t}(n.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(14)),i=o(r(12)),a=o(r(180));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=new i.default(e).css("height","18px"),s=new a.default;return l(this,u(t).call(this,o,"auto",!0,"bottom-left",{type:!0,change:r,arrowChange:n,historyBorder:s},s.el))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),t}(n.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-history-border")),this.history=(0,n.h)("div","".concat(i.cssPrefix,"-history-content")).html("暂无内容"),this.el.child(this.history)}var t,r,o;return t=e,(r=[{key:"setContent",value:function(e){var t;e=e.slice(e.length-100<0?0:e.length,e.length),this.el.html("");for(var r=[],i=e.length-1;i>=0;i--){var a=(0,n.h)("div",""),o=e[i].action;a.html(o),r.push(a)}console.log(this,this.el),(t=this.el).children.apply(t,r)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=f(r(87)),i=f(r(182)),a=f(r(183)),o=f(r(184)),s=f(r(50)),l=r(10),u=r(0),c=r(1);function f(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=100,g=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=new o.default(new a.default("cell",["cell"],"100%",(function(e){return(0,l.t)("dataValidation.modeType.".concat(e))})),{required:!0},"".concat((0,l.t)("dataValidation.range"),":"),y),n=new o.default(new i.default("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),f=new o.default(new a.default("list",["list","number","date","phone","email"],"100%",(function(e){return(0,l.t)("dataValidation.type.".concat(e))}),(function(t){return e.criteriaSelected(t)})),{required:!0},"".concat((0,l.t)("dataValidation.criteria"),":"),y),d=new o.default(new a.default("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(e){return(0,l.t)("dataValidation.operator.".concat(e))}),(function(t){return e.criteriaOperatorSelected(t)})),{required:!0}).hide(),h=new o.default(new i.default("70px","10"),{required:!0}).hide(),v=new o.default(new i.default("70px","100"),{required:!0,type:"number"}).hide(),g=new o.default(new i.default("120px","a,b,c"),{required:!0}),E=new o.default(new i.default("70px","10"),{required:!0,type:"number"}).hide();return(e=p(this,m(t).call(this,(0,l.t)("contextmenu.validation"),[(0,u.h)("div","".concat(c.cssPrefix,"-form-fields")).children(r.el,n.el),(0,u.h)("div","".concat(c.cssPrefix,"-form-fields")).children(f.el,d.el,h.el,v.el,E.el,g.el),(0,u.h)("div","".concat(c.cssPrefix,"-buttons")).children(new s.default("cancel").on("click",(function(){return e.btnClick("cancel")})),new s.default("remove").on("click",(function(){return e.btnClick("remove")})),new s.default("save","primary").on("click",(function(){return e.btnClick("save")})))]))).mf=r,e.rf=n,e.cf=f,e.of=d,e.minvf=h,e.maxvf=v,e.vf=E,e.svf=g,e.change=function(){},e}var r,n,f;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),r=t,(n=[{key:"criteriaSelected",value:function(e){var t=this.of,r=this.minvf,n=this.maxvf,i=this.vf,a=this.svf;"date"===e||"number"===e?(t.show(),r.rule.type=e,n.rule.type=e,"date"===e?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),i.hide(),a.hide()):("list"===e?a.show():a.hide(),i.hide(),t.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(e){if(e){var t=this.minvf,r=this.maxvf,n=this.vf;if("be"===e||"nbe"===e)t.show(),r.show(),n.hide();else{var i=this.cf.val();n.rule.type=i,"date"===i?n.hint("2018-11-12"):n.hint("10"),n.show(),t.hide(),r.hide()}}}},{key:"btnClick",value:function(e){if("cancel"===e)this.hide();else if("remove"===e)this.change("remove"),this.hide();else if("save"===e){for(var t=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<t.length;r+=1){var n=this[t[r]];if(n.isShow()&&!n.validate())return}var i=this.mf.val(),a=this.rf.val(),o=this.cf.val(),s=this.of.val(),l=this.svf.val();"number"!==o&&"date"!==o||(l="be"===s||"nbe"===s?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,a,{type:o,operator:s,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(e){if(e){var t=this.mf,r=this.rf,n=this.cf,i=this.of,a=this.svf,o=this.vf,s=this.minvf,l=this.maxvf,u=e.mode,c=e.ref,f=e.validator||{type:"list"},d=f.type,h=f.operator,p=f.value;t.val(u||"cell"),r.val(c),n.val(d),i.val(h),Array.isArray(p)?(s.val(p[0]),l.val(p[1])):(a.val(p||""),o.val(p||"")),this.criteriaSelected(d),this.criteriaOperatorSelected(h)}this.show()}}])&&h(r.prototype,n),f&&h(r,f),t}(n.default);t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.vchange=function(){},this.el=(0,n.h)("div","".concat(i.cssPrefix,"-form-input")),this.input=(0,n.h)("input","").css("width",t).on("input",(function(e){return a.vchange(e)})).attr("placeholder",r),this.el.child(this.input)}var t,r,o;return t=e,(r=[{key:"hint",value:function(e){this.input.attr("placeholder",e)}},{key:"val",value:function(e){return this.input.val(e)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=(n=r(83))&&n.__esModule?n:{default:n},o=r(1);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r,n){var s=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t,this.getTitle=l,this.vchange=function(){},this.el=(0,i.h)("div","".concat(o.cssPrefix,"-form-select")),this.suggest=new a.default(r.map((function(e){return{key:e,title:s.getTitle(e)}})),(function(e){s.itemClick(e.key),u(e.key),s.vchange(e.key)}),n,this.el),this.el.children(this.itemEl=(0,i.h)("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",(function(){return s.show()}))}var t,r,n;return t=e,(r=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(e){this.key=e,this.itemEl.html(this.getTitle(e))}},{key:"val",value:function(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1),a=r(10);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},l=function(){function e(t,r,a,o){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label="",this.rule=r,a&&(this.label=(0,n.h)("label","label").css("width","".concat(o,"px")).html(a)),this.tip=(0,n.h)("div","tip").child("tip").hide(),this.input=t,this.input.vchange=function(){return s.validate()},this.el=(0,n.h)("div","".concat(i.cssPrefix,"-form-field")).children(this.label,t.el,this.tip)}var t,r,l;return t=e,(r=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(e){return this.input.val(e)}},{key:"hint",value:function(e){this.input.hint(e)}},{key:"validate",value:function(){var e=this.input,t=this.rule,r=this.tip,n=this.el,i=e.val();return t.required&&/^\s*$/.test(i)?(r.html((0,a.t)("validation.required")),n.addClass("error"),!1):!t.type&&!t.pattern||(t.pattern||s[t.type]).test(i)?(n.removeClass("error"),!0):(r.html((0,a.t)("validation.notMatch")),n.addClass("error"),!1)}}])&&o(t.prototype,r),l&&o(t,l),e}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=(n=r(50))&&n.__esModule?n:{default:n},o=r(8),s=r(1),l=r(10);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e){return(0,i.h)("div","".concat(s.cssPrefix,"-item ").concat(e))}function f(e){var t=this;return c("state").child((0,l.t)("sort.".concat(e))).on("click.stop",(function(){return t.itemClick(e)}))}function d(e){var t=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(e).forEach((function(a,o){var u=e[a],c=n.includes(a)?"checked":"";r.child((0,i.h)("div","".concat(s.cssPrefix,"-item state ").concat(c)).on("click.stop",(function(){return t.filterClick(o,a)})).children(""===a?(0,l.t)("filter.empty"):a,(0,i.h)("div","label").html("(".concat(u,")"))))}))}function h(){var e=this.filterhEl,t=this.filterValues,r=this.values;e.html("".concat(t.length," / ").concat(r.length)),e.checked(t.length===r.length)}var p=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filterbEl=(0,i.h)("div","".concat(s.cssPrefix,"-body")),this.filterhEl=(0,i.h)("div","".concat(s.cssPrefix,"-header state")).on("click.stop",(function(){return t.filterClick(0,"all")})),this.tindex=1,this.el=(0,i.h)("div","".concat(s.cssPrefix,"-sort-filter")).children(this.sortAscEl=f.call(this,"asc"),this.sortDescEl=f.call(this,"desc"),c("divider"),(0,i.h)("div","".concat(s.cssPrefix,"-filter")).children(this.filterhEl,this.filterbEl),(0,i.h)("div","".concat(s.cssPrefix,"-buttons")).children(new a.default("cancel").on("click",(function(){return t.btnClick("cancel")})),new a.default("ok","primary").on("click",(function(){return t.btnClick("ok")})))).hide(),this.el.on("mousedown.stop",(function(e){t.tindex=1})),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var t,r,n;return t=e,(r=[{key:"btnClick",value:function(e){if("ok"===e){var t=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(t,r,"in",n)}this.hide()}},{key:"itemClick",value:function(e){this.sort=e;var t=this.sortAscEl,r=this.sortDescEl;t.checked("asc"===e),r.checked("desc"===e)}},{key:"filterClick",value:function(e,t){var r=this.filterbEl,n=this.filterValues,a=this.values,o=r.children();"all"===t?o.length===n.length?(this.filterValues=[],o.forEach((function(e){return(0,i.h)(e).checked(!1)}))):(this.filterValues=Array.from(a),o.forEach((function(e){return(0,i.h)(e).checked(!0)}))):(0,i.h)(o[e]).toggle("checked")?n.push(t):n.splice(n.findIndex((function(e){return e===t})),1),h.call(this)}},{key:"set",value:function(e,t,r,n){this.ci=e;var i=this.sortAscEl,a=this.sortDescEl;null!==n?(this.sort=n.order,i.checked(n.asc()),a.checked(n.desc())):(this.sortDesc=null,i.checked(!1),a.checked(!1)),this.values=Object.keys(t),this.filterValues=r?Array.from(r.value):Object.keys(t),d.call(this,t,r),h.call(this)}},{key:"setOffset",value:function(e){var t=this;if(this.el.isShow())this.hide();else{this.el.offset(e).show();var r=1;console.log(this.el),(0,o.bindClickoutside)(this.el,(function(){0===r&&t.hide(),r=0}))}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),(0,o.unbindClickoutside)(this.el)}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xtoast=function(e,t){var r=(0,i.h)("div","".concat(o.cssPrefix,"-toast")),n=(0,i.h)("div","".concat(o.cssPrefix,"-dimmer active"));r.children((0,i.h)("div","".concat(o.cssPrefix,"-toast-header")).children(new a.default("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),e),(0,i.h)("div","".concat(o.cssPrefix,"-toast-content")).html(t)),document.body.appendChild(r.el),document.body.appendChild(n.el);var s=r.box(),l=s.width,u=s.height,c=document.documentElement,f=c.clientHeight,d=c.clientWidth;r.offset({left:(d-l)/2,top:(f-u)/3})};var n,i=r(0),a=(n=r(12))&&n.__esModule?n:{default:n},o=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1),a=r(47);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-advice")).children(this.save=(0,n.h)("div","".concat(i.cssPrefix,"-advice-style")).css("border-bottom","1px solid"),this.text=(0,n.h)("div","".concat(i.cssPrefix,"-advice-style"))).hide(),this.save.children(this.saveCheck=(0,n.h)("span","check").hide("visibility","hidden"),(0,n.h)("span","").html("保留样式")),this.text.children(this.textCheck=(0,n.h)("span","check").hide("visibility","hidden"),(0,n.h)("span","").html("仅文本")),this.data=t,this.sheet=r,this.left=0,this.top=0,this.save.on("mousedown.stop",(function(){o.saveCheck.show("visibility","initial"),o.textCheck.hide("visibility","hidden"),o.sheet.setCellRange(o.reference,o.tableProxy,!0),a.sheetReset.call(o.sheet)})),this.text.on("mousedown.stop",(function(){o.sheet.setCellRange(o.reference,o.tableProxy,!1),o.saveCheck.show("visibility","hidden"),o.textCheck.hide("visibility","initial"),a.sheetReset.call(o.sheet)}))}var t,r,s;return t=e,(r=[{key:"show",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;this.el.css("left","".concat(e,"px")),this.el.css("top","".concat(t,"px")),1===r&&(this.saveCheck.show("visibility","initial"),this.textCheck.hide("visibility","hidden")),this.left=parseInt(e),this.top=parseInt(t),this.tableProxy=i,this.reference=n,this.el.show()}}])&&o(t.prototype,r),s&&o(t,s),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(0),a=r(1),o=(n=r(6))&&n.__esModule?n:{default:n},s=r(189);function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.el=(0,i.h)("div","".concat(a.cssPrefix,"-hyperlink-tooltip")).hide(),this.tableEl=(0,i.h)("div","".concat(a.cssPrefix,"-hyperlink-tooltip")).hide(),this.editor=r,this.tableEl.attr("tabindex",0),this.tableEl.css("overflow-y","auto"),this.tableEl.css("max-height","400px"),this.timer=null,this.timer2=null}var t,r,n;return t=e,(r=[{key:"show",value:function(e,t){var r=this;if(this.editor.isDisplay2())return this.el.hide(),void this.tableEl.hide();var n=this.data,l=n.getCellTextOrDefault(e,t)+"";if(clearTimeout(this.timer),clearTimeout(this.timer2),0===a.look.indexOf(l.split("!")[0])){var u=n.getRect(new o.default(e,t,e,t)),c=u.left+55,f=u.top+50,d=JSON.parse(l.substring(l.indexOf("!")+1,l.length));this.tableEl.css("left","".concat(c,"px")),this.tableEl.css("top","".concat(f,"px")),this.tableEl.css("user-select","text"),this.tableEl.html("");var h=(0,i.h)("table","");h.css("border-spacing","0px");var p=(0,i.h)("tr","");p.children((0,i.h)("td","").css("border","1px solid black").html("序号"),(0,i.h)("td","").css("border","1px solid black").html("项目名称"),(0,i.h)("td","").css("border","1px solid black").html("城市"),(0,i.h)("td","").css("border","1px solid black").html("占地面积"),(0,i.h)("td","").css("border","1px solid black").html("差额")),h.children(p);for(var m=0;m<d.length;m++){var v=d[m],y=v.number,g=v.name,E=v.city,b=v.area,x=v.value,A=(0,i.h)("tr",""),S=(0,i.h)("td","");S.html(y),S.css("border","1px solid black");var w=(0,i.h)("td","");w.html(g),w.css("border","1px solid black");var R=(0,i.h)("td","");R.html(E),R.css("border","1px solid black");var C=(0,i.h)("td","");C.html(b),C.css("border","1px solid black");var T=(0,i.h)("td","");T.html(x),T.css("border","1px solid black"),A.children(S,w,R,C,T),h.children(A)}this.tableEl.children(h),this.timer=setTimeout((function(){r.tableEl.show(),r.el.hide()}),150)}else{var O=(0,s.isSpecialWebsite)(l);if(O.state&&(l=O.text),"http://"!==(l="www"===l.substr(0,3).toLowerCase()?"http://"+l:l).substr(0,7).toLowerCase()&&"https://"!==l.substr(0,8).toLowerCase())return this.el.hide(),void this.tableEl.hide();var _=n.getRect(new o.default(e,t,e,t)),D=_.left+55,N=_.top+5;this.el.html(""),this.el.css("color","blue"),this.el.children((0,i.h)("div","aaa").css("border-bottom","1px solid blue").on("click",(function(e){console.log(e);var t=e.screenX,r=e.screenY;window.open(l,"","width=".concat(650,",height=").concat(500,",left=").concat(t+_.width,",top=").concat(r))})).html(l)),this.el.css("left","".concat(D,"px")),this.el.css("top","".concat(N,"px")),this.timer2=setTimeout((function(){r.el.show(),r.tableEl.hide()}),150)}}}])&&l(t.prototype,r),n&&l(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSpecialWebsite=function(e){if(1===n.look.indexOf(e.split("!")[0]))return{state:!0,text:JSON.parse(e.split("!")[1]).url};return{state:!1,text:""}},t.specialWebsiteValue=function(e,t){var r=function(e,t){if(1===n.look.indexOf(e.split("!")[0])&&-1===t.toUpperCase().indexOf(i))return 2;return 0}(e,t);if(2===r){var a=e.split(" "),o="";if(a.length>=1){e=a[0];for(var s=1;s<a.length;s++)o+=a[s]}return{state:!0,type:r,text:JSON.parse(e.split("!")[1]).text+o}}return{state:!1,type:r,text:""}},t.multipleCellsRender=function(e,t){var r=[];return Object.keys(t).forEach((function(n){e[n]=t[n],r.push(n)})),r};var n=r(1),i="HYPERLINK"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(87)),i=r(0),a=l(r(50)),o=r(10),s=r(1);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t,r){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=(0,i.h)("span","").html("您输入的公式好像至少缺少一个左括号");return(e=f(this,h(t).call(this,(0,o.t)("contextmenu.errorPop"),[(0,i.h)("div","".concat(s.cssPrefix,"-form-fields")).children(r),(0,i.h)("div","".concat(s.cssPrefix,"-form-fields")),(0,i.h)("div","".concat(s.cssPrefix,"-buttons")).children(new a.default("ok","primary").on("click",(function(){return e.btnClick("ok")})))]))).tip=r,e}var r,n,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),r=t,(n=[{key:"show",value:function(e){this.tip.html(e),d(h(t.prototype),"show",this).call(this)}},{key:"btnClick",value:function(e){"ok"===e&&this.hide()}}])&&c(r.prototype,n),l&&c(r,l),t}(n.default);t.default=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(1),i=r(7);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rect=t}var t,r,o;return t=e,(r=[{key:"isLocInside",value:function(e,t){var r=this.rect;return e<r.width+r.left&&e>r.left&&t-n.offsetTop>r.top&&t-n.offsetTop<r.top+r.height}},{key:"getUpDownLeftRight",value:function(e,t,r,a){var o=this.rect,s=0;return e<o.width+o.left&&e>o.left?t>o.top+o.height+n.offsetTop?s=1:t-n.offsetTop<o.top&&(s=4):t-(o.top-o.height+n.offsetTop)>0&&o.height+o.top+n.offsetTop>t&&(e>o.width+o.left?s=3:e<o.left&&(s=2)),0===s&&(s=(0,i.positionAngle)(r,e,a,t)),1===s&&t<0?s=4:document.body.clientHeight<t&&4===s&&(s=1),3===s&&e<0?s=2:document.body.clientWidth<e&&2===s&&(s=3),s}}])&&a(t.prototype,r),o&&a(t,o),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timer=[]}var t,r,i;return t=e,(r=[{key:"push",value:function(e){this.timer.push(e)}},{key:"clear",value:function(){for(var e=0;e<this.timer.length;e++){var t=this.timer[e];clearTimeout(t),clearInterval(t)}}}])&&n(t.prototype,r),i&&n(t,i),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=r(1);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=(0,n.h)("div","".concat(i.cssPrefix,"-chart"))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){this.register=function(r){var n=[],i=["nw","w","ws","s","se","e","ne","n"];i.forEach((function(e){var t=document.createElement("div");t.style.display="block",t.className="direction "+e,n.push(t),r.appendChild(t)}));for(var a=0;a<4;a++){var o=document.createElement("div");o.style.display="block",o.className="line".concat(a+1),r.appendChild(o),n.push(o)}var s=document.createElement("div");function l(n){n<20&&(n=20),e.onResize({width:n},t),r.style.width=n+"px"}function u(n){n<20&&(n=20),e.onResize({height:n},t),r.style.height=n+"px"}s.className="border",r.appendChild(s),i.forEach((function(t){var n=r.querySelector("."+t);n.onmousedown=function(i){if(0===i.button){var a={ox:i.clientX,oy:i.clientY,ow:r.offsetWidth,oh:r.offsetHeight,ol:r.offsetLeft,ot:r.offsetTop};e&&e.onBegin&&e.onBegin.call(r,a);var o=!0;window.onmousemove=function(e){if(o){var r=e.clientX,i=e.clientY,s=r-a.ox,l=i-a.oy;a.width=s,a.height=l;var u=c[t];u&&u.call(n,a,e),e.stopPropagation()}},window.onmouseup=function(t){o=!1,t.stopPropagation(),e&&e.onEnd&&e.onEnd.call(r)},i.stopPropagation()}}})),e?e.onResize||(e.onResize=function(){}):e={onResize:function(){}};var c={s:function(e){u(e.oh+e.height)},e:function(e){l(e.ow+e.width)},w:function(n){var i=n.width,a=n.ol+i,o=n.ow+Math.abs(i);i>0&&(o=n.ow-i),o>20&&(!function(n){e.onResize({left:n},t),r.style.left=n+"px"}(a),l(o))},n:function(n){var i=n.height,a=n.ot+i,o=n.oh+Math.abs(i);i>0&&(o=n.oh-i),o>20&&(u(o),function(n){e.onResize({top:n},t),r.style.top=n+"px"}(a))},se:function(e){c.s(e),c.e(e)},nw:function(e){c.n(e),c.w(e)},ws:function(e){c.w(e),c.s(e)},ne:function(e){c.n(e),c.e(e)}};return n}};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(46),a=r(43),o=r(7),s=(n=r(6))&&n.__esModule?n:{default:n},l=r(9);function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.rows=new a.Rows({len:0,height:0},t)}var t,r,n;return t=e,(r=[{key:"getComputedStyle",value:function(e){var t=!1;return e.fontWeight>400&&(t=!0),{color:e.color,bgcolor:e.background.substring(0,e.background.indexOf(")")+1),font:{bold:t}}}},{key:"extend",value:function(e,t){var r=t.ri,n=t.ci,i=this.data;if(e.rows.length>=i.rows.len-r){var a=e.rows.length-(i.rows.len-r);a>0&&i.insert("row",a)}if(!1!==(0,l.isHave)(e.rows[0])&&!1!==(0,l.isHave)(e.rows[0].cells)){var o=e.rows[0].cells.length;if(o>=i.cols.len){var s=o-(i.cols.len-n);s>0&&i.insert("column",s,i.cols.len)}}}},{key:"each",value:function(e,t){for(var r=0;r<e.rows.length;r++)for(var n=0;n<e.rows[r].cells.length;n++)t(r,n,e.rows[r].cells[n])}},{key:"dealColSpan",value:function(e){this.each(e,(function(t,r,n){var i=n.getAttribute("colspan");if(i&&i>1)for(var a=0;a<i-1;a++)e.rows[t].insertBefore(document.createElement("td"),e.rows[t].cells[r+1])}))}},{key:"dealStyle",value:function(e,t){var r=this,n=t.ri,a=t.ci,o=this.data,s=this.rows,l=o.styles;this.each(e,(function(e,t,o){var u=document.defaultView.getComputedStyle(o,null),c=r.getComputedStyle(u),f=(0,i.isHaveStyle)(l,c);-1===f&&l.push(c),s.setCell(n+e,a+t,{style:-1===f?l.length-1:f},"all")}))}},{key:"parseTableCellRange",value:function(e,t){var r=t.ri,n=t.ci,i=r,a=n;return this.each(e,(function(e,t){var o=r+e,s=n+t;i<o&&(i=o),a<s&&(a=s)})),new s.default(r,n,i,a)}},{key:"dealReference",value:function(e,t){var r=t.ri,n=t.ci,i=this.rows,a=[];return this.each(e,(function(e,t,s){var l=s.querySelector("reference"),u=s.innerText||"";if(l){var c=l.getAttribute("ri"),f=l.getAttribute("ci"),d=(0,o.splitStr)(u),h=e+r-c,p=t+n-f,m=i.getCellTextByShift(d,p,h),v=m.bad,y=m.result;i.updateCellReferenceByShift(v,y,r+e,n+t)}else{var g=i.getCell(r+e,n+t)||{};g.text=u,g.formulas=u,i.setCell(r+e,n+t,g,"all")}a.push({ri:r+e,ci:n+t})})),{reference:a}}}])&&u(t.prototype,r),n&&u(t,n),e}();t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatDate=function(e){if(!(0,s.isHave)(e)||!(0,s.isNumber)(e))return{state:!1,date_formula:"",minute:!1};var t=l(e,(function(e){return 24*e*60}));t=(0,o.formatNumberRender)(t,5);var r=(0,i.default)("1900-01-01"),n=(0,i.default)("1900-01-01"),a=!1;if((0,s.isHave)(t)&&1*t>0){var u=l(t,(function(e){return 60*e}));a=!0,u=(0,o.formatNumberRender)(u,5),n=(0,i.default)("1900-01-01  00:00:00").set("minute",t).set("second",u)}var c="";if(a){c=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD");var f=n.add(e,"day").subtract(2,"day").format("YYYY-MM-DD  h:mm:ss");return{state:"Invalid Date"!==c,date:c,date_formula:f,minute:!0}}return{state:"Invalid Date"!==(c=r.add(e,"day").subtract(2,"day").format("YYYY-MM-DD")),date:c,date_formula:"",minute:!1}},t.changeFormat=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY年MM月DD日";return(0,i.default)(e).format(t)},t.calcDecimals=l,t.dateDiff=function(e){for(var t=!1,r=0;!1===t&&r<a.datePattern.length;r++)t=(0,a.str2Re)(a.datePattern[r]).test(e);return!1===t?{isValid:!1}:(e=(e=e.replace(/[年|月]/g,"-")).replace(/[日]/g,""),{diff:(0,i.default)(e).diff((0,i.default)("1900-01-01"),"day")+2,isValid:!0})};var n,i=(n=r(64))&&n.__esModule?n:{default:n},a=r(22),o=r(49),s=r(16);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=e.toString().split(".");if(r.length>2)return e;for(var n=r[1]+"",i=n,a=0;a<n.length;a++)i*=.1;return t(i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(4),a=(n=r(89))&&n.__esModule?n:{default:n},o=r(33);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e){this.undoItems.push(e),this.redoItems=[]}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.undoItems=[],this.redoItems=[],this.data=t}var t,r,n;return t=e,(r=[{key:"addStep",value:function(e,t){var r=e.type,n=e.action,i=e.ri,s=e.ci,u=e.expr,c=e.cellRange,f=e.cells,d=e.height,h=e.width,p=e.property,m=e.value,v=e.oldData,y=t.oldCell,g=t.newCell,E=t.oldMergesData,b=t.newMergesData,x=t.oldStep,A="";1===r?(A=new a.default({type:r,action:n,ri:i,ci:s,expr:u,oldCell:y,newCell:g},this.data),l.call(this,A)):2===r||5===r||11===r||12===r||6===r?(A=new a.default({type:r,oldMergesData:E,property:p,value:m,newMergesData:b,action:n,cellRange:c,oldCell:y,newCell:f},this.data),l.call(this,A)):13===r?(A=new a.default({type:r,oldData:v,newData:x.oldData,action:n},this.data),l.call(this,A)):3===r?(A=new a.default({type:r,action:n,height:d,ri:i,oldStep:x},this.data),l.call(this,A)):4===r&&(A=new a.default({type:r,action:n,width:h,ci:s,oldStep:x},this.data),l.call(this,A)),o.testValid.call(this)}},{key:"getStepType",value:function(e,t){var r=t.ri,n=t.ci,a=t.expr,o=t.text,s=t.range,l=t.cellRange,u=t.property,c=t.value,f="",d=this.data,h=d.rows,p=d.cols;if(1===e)return{action:f="在".concat(a,'中键入"').concat(o,'"'),type:e,ri:r,ci:n,expr:a};if(2===e){var m=(0,i.xy2expr)(s.sci,s.sri),v=(0,i.xy2expr)(s.eci,s.eri);return a=m===v?m:"".concat(m,":").concat(v),{action:f="删除".concat(a,"的单元格内容"),type:e,cellRange:s,cells:this.eachRange(s)}}return 3===e?{action:f="行宽",type:e,height:h.getHeight(r),ri:r}:4===e?{action:f="列宽",type:e,width:p.getWidth(n),ci:n}:5===e?{action:f="自动填充",type:e,cellRange:s,cells:this.eachRange(l)}:12===e?{action:f="选择性粘贴",type:e,cellRange:s,property:u,value:c,cells:this.eachRange(l)}:13===e?{action:f="插入单元格",type:e,oldData:this.data.getData()}:11===e?("font-bold"===u||"font-italic"===u||"font-name"===u||"font-size"===u||"color"===u?f="字体":"underline"===u?f="下划线":"bgcolor"===u||"format"===u?f="单元格格式":"align"===u?"left"===c?f="左对齐":"center"===c?f="居中":"right"===c&&(f="右对齐"):"valign"===u?"top"===c?f="顶端对齐":"center"===c?f="居中":"bottom"===c&&(f="底端对齐"):"border"===u?f="边框":"strike"===u?f="删除线":"merge"===u&&(f="合并单元格"),{action:f,type:e,cellRange:s,property:u,value:c,cells:this.eachRange(l)}):6===e?{action:f="粘贴",type:e,cellRange:s,cells:this.eachRange(l)}:void 0}},{key:"undo",value:function(){var e=this.does(this.getItems(1),1);this.redoItems.push(e)}},{key:"redo",value:function(){var e=this.does(this.getItems(2),2);this.undoItems.push(e)}},{key:"eachRange",value:function(e){return this.data.rows.eachRange(e)}},{key:"does",value:function(e,t){if(this.data.settings.showEditor&&!(e.length<=0)){var r=this.data,n=r.sheet,i=e.pop();return i.restore(r,n,t),i}}},{key:"getItems",value:function(e){return 1===e?this.undoItems:this.redoItems}}])&&s(t.prototype,r),n&&s(t,n),e}();t.default=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(30))&&n.__esModule?n:{default:n},a=r(4);function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectorRange=t,this.dstRange=r}var t,r,n;return t=e,(r=[{key:"getPaintType",value:function(){var e=this.dstRange,t=this.selectorRange;return function(e,t){return 1===e&&1===t?1:1===e&&2===t?2:1===e&&3===t?3:2===e&&1===t?4:3===e&&1===t?5:2===e&&2===t?6:2===e&&3===t?7:3===e&&2===t?8:3===e&&3===t?9:void 0}(e.getType(),t.getType())}},{key:"makePaintArr",value:function(e,t){var r=this.dstRange,n=this.selectorRange,o=[],s=n.eci-n.sci,l=0,u=r.sri,c=0,f=function(e,t){var r=t.sri,n=[],i=[],a=0;return t.each((function(t,o){r!==t&&(r=t,n.push(i),i=[]),i.push(e[a]),a+=1})),n.push(i),n}(t,n);return r.each((function(e,t){u!==e&&(l=0,(c+=1)===f.length&&(c=0));var r=f[c][l].cell,n=new i.default(e,t,r,(0,a.xy2expr)(e,t));o.push(n),l===s?l=0:l+=1,u=e})),o}}])&&o(t.prototype,r),n&&o(t,n),e}();t.default=s},function(e,t,r){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={toolbar:{undo:"撤销",redo:"恢复",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",font:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",textColor:"字体颜色",fillColor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",add:"显示公式",calc:"开始计算",formula:"函数",more:"更多",comeBack:"返回",chart:"插入图表"},revision:{comeBack:"退出"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",insertRow:"插入行",insertColumn:"插入列",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",errorPop:"出现问题",recover:"恢复此版本"},format:{normal:"常规",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},date_formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",wland:"MD.WLAND",wfr:"MD.WFR",rtd:"MD.RTD"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bugout=void 0;var n=r(202),i="";t.bugout=i;try{t.bugout=i=new n.debugout}catch(e){console.error(e)}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.debugout=function(){var e=this;if(e.realTimeLoggingOn=!0,e.useTimestamps=!1,e.useLocalStorage=!0,e.recordLogs=!0,e.autoTrim=!0,e.maxLines=2500,e.tailNumLines=100,e.logFilename="debugout.txt",e.depth=0,e.parentSizes=[0],e.currentResult="",e.startTime=new Date,e.output="",this.version=function(){return"0.5.0"},this.getLog=function(){var t=new Date;if(e.recordLogs||e.log("[debugout.js] log recording is off."),e.useLocalStorage){var r=window.localStorage.getItem("debugout.js");r&&(r=JSON.parse(r),e.startTime=new Date(r.startTime),e.output=r.log,t=new Date(r.lastLog))}return e.output+"\n---- Log retrieved: "+t+" ----\n"+e.formatSessionDuration(e.startTime,t)},this.tail=function(t){t=t||e.tailLines;return e.trimLog(e.getLog(),t)},this.search=function(t){for(var r=e.output.split("\n"),n=new RegExp(t),i=[],a=0;a<r.length;a++){var o="["+a+"] ";r[a].match(n)&&i.push(o+r[a])}var s=i.join("\n");return 0===s.length&&(s='Nothing found for "'+t+'".'),s},this.getSlice=function(t,r){return e.output.split("\n").slice(t,t+r).join("\n")},this.downloadLog=function(){var t="data:text/plain;charset=utf-8,",r=e.getLog();t+=encodeURIComponent(r);var n=document.createElement("a");n.href=t,n.target="_blank",n.download=e.logFilename,document.body.appendChild(n),n.click(),n.remove()},this.clear=function(){var t=new Date;if(e.output="---- Log cleared: "+t+" ----\n",e.useLocalStorage){var r={startTime:e.startTime,log:e.output,lastLog:t};r=JSON.stringify(r),window.localStorage.setItem("debugout.js",r)}e.realTimeLoggingOn&&console.log("[debugout.js] clear()")},this.log=function(t){if(e.realTimeLoggingOn&&console.log(t),null!==e.determineType(t)&&e.recordLogs){var r=t;if(e.useTimestamps){var n=new Date;e.output+=e.formatTimestamp(n)}if(e.output+=r+"\n",e.autoTrim&&(e.output=e.trimLog(e.output,e.maxLines)),e.useLocalStorage){var i=new Date,a={startTime:e.startTime,log:e.output,lastLog:i};a=JSON.stringify(a),window.localStorage.setItem("debugout.js",a)}}e.depth=0,e.parentSizes=[0],e.currentResult=""},this.determineType=function(e){if(null!==e){var t,r=n(e);if("object"===r)t=null===e.length?"function"==typeof e.getTime?"Date":"function"==typeof e.test?"RegExp":"Object":"Array";else t=r;return t}return null},this.formatType=function(t,r){switch(t){case"Object":e.currentResult+="{\n",e.depth++,e.parentSizes.push(e.objectSize(r));var n=0;for(var i in r){e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+=i+": ";var a=e.determineType(r[i]);(o=e.formatType(a,r[i]))?(e.currentResult+=o,n!==e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"):(n!==e.parentSizes[e.depth]-1&&(e.currentResult+=","),e.currentResult+="\n"),n++}if(e.depth--,e.parentSizes.pop(),e.currentResult+=e.indentsForDepth(e.depth),e.currentResult+="}",0===e.depth)return e.currentResult;break;case"Array":e.currentResult+="[",e.depth++,e.parentSizes.push(r.length);for(n=0;n<r.length;n++){var o;"Object"!==(a=e.determineType(r[n]))&&"Array"!==a||(e.currentResult+="\n"+e.indentsForDepth(e.depth)),(o=e.formatType(a,r[n]))?(e.currentResult+=o,n!==e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Array"===a&&(e.currentResult+="\n")):(n!==e.parentSizes[e.depth]-1&&(e.currentResult+=", "),"Object"!==a?e.currentResult+="\n":n===e.parentSizes[e.depth]-1&&(e.currentResult+="\n"))}if(e.depth--,e.parentSizes.pop(),e.currentResult+="]",0===e.depth)return e.currentResult;break;case"function":var s=(r+="").split("\n");for(n=0;n<s.length;n++)s[n].match(/\}/)&&e.depth--,e.currentResult+=e.indentsForDepth(e.depth),s[n].match(/\{/)&&e.depth++,e.currentResult+=s[n]+"\n";return e.currentResult;case"RegExp":return"/"+r.source+"/";case"Date":case"string":return e.depth>0||0===r.length?'"'+r+'"':r;case"boolean":return r?"true":"false";case"number":return r+""}},this.indentsForDepth=function(e){for(var t="",r=0;r<e;r++)t+="\t";return t},this.trimLog=function(e,t){var r=e.split("\n");return r.length>t&&(r=r.slice(r.length-t)),r.join("\n")},this.lines=function(){return e.output.split("\n").length},this.formatSessionDuration=function(e,t){var r=t-e,n=Math.floor(r/1e3/60/60),i=("0"+n).slice(-2);r-=1e3*n*60*60;var a=Math.floor(r/1e3/60),o=("0"+a).slice(-2);r-=1e3*a*60;var s=Math.floor(r/1e3);return r-=1e3*s,"---- Session duration: "+i+":"+o+":"+("0"+s).slice(-2)+" ----"},this.formatTimestamp=function(e){var t=e.getFullYear(),r=e.getDate();return"["+t+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+r+" "+Number(e.getHours())+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)+"]: "},this.objectSize=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},e.useLocalStorage){var t=window.localStorage.getItem("debugout.js");if(t){t=JSON.parse(t),e.output=t.log;var r=new Date(t.startTime),i=new Date(t.lastLog);e.output+="\n---- Session end: "+t.lastLog+" ----\n",e.output+=e.formatSessionDuration(r,i),e.output+="\n\n"}}e.output+="---- Session started: "+e.startTime+" ----\n\n"}}]);
//# sourceMappingURL=xspreadsheet.js.map